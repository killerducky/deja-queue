/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/ansi-html-community/index.js":
/*!***************************************************!*\
  !*** ./node_modules/ansi-html-community/index.js ***!
  \***************************************************/
/***/ ((module) => {

"use strict";
eval("{\n\nmodule.exports = ansiHTML\n\n// Reference to https://github.com/sindresorhus/ansi-regex\nvar _regANSI = /(?:(?:\\u001b\\[)|\\u009b)(?:(?:[0-9]{1,3})?(?:(?:;[0-9]{0,3})*)?[A-M|f-m])|\\u001b[A-M]/\n\nvar _defColors = {\n  reset: ['fff', '000'], // [FOREGROUD_COLOR, BACKGROUND_COLOR]\n  black: '000',\n  red: 'ff0000',\n  green: '209805',\n  yellow: 'e8bf03',\n  blue: '0000ff',\n  magenta: 'ff00ff',\n  cyan: '00ffee',\n  lightgrey: 'f0f0f0',\n  darkgrey: '888'\n}\nvar _styles = {\n  30: 'black',\n  31: 'red',\n  32: 'green',\n  33: 'yellow',\n  34: 'blue',\n  35: 'magenta',\n  36: 'cyan',\n  37: 'lightgrey'\n}\nvar _openTags = {\n  '1': 'font-weight:bold', // bold\n  '2': 'opacity:0.5', // dim\n  '3': '<i>', // italic\n  '4': '<u>', // underscore\n  '8': 'display:none', // hidden\n  '9': '<del>' // delete\n}\nvar _closeTags = {\n  '23': '</i>', // reset italic\n  '24': '</u>', // reset underscore\n  '29': '</del>' // reset delete\n}\n\n;[0, 21, 22, 27, 28, 39, 49].forEach(function (n) {\n  _closeTags[n] = '</span>'\n})\n\n/**\n * Converts text with ANSI color codes to HTML markup.\n * @param {String} text\n * @returns {*}\n */\nfunction ansiHTML (text) {\n  // Returns the text if the string has no ANSI escape code.\n  if (!_regANSI.test(text)) {\n    return text\n  }\n\n  // Cache opened sequence.\n  var ansiCodes = []\n  // Replace with markup.\n  var ret = text.replace(/\\033\\[(\\d+)m/g, function (match, seq) {\n    var ot = _openTags[seq]\n    if (ot) {\n      // If current sequence has been opened, close it.\n      if (!!~ansiCodes.indexOf(seq)) { // eslint-disable-line no-extra-boolean-cast\n        ansiCodes.pop()\n        return '</span>'\n      }\n      // Open tag.\n      ansiCodes.push(seq)\n      return ot[0] === '<' ? ot : '<span style=\"' + ot + ';\">'\n    }\n\n    var ct = _closeTags[seq]\n    if (ct) {\n      // Pop sequence\n      ansiCodes.pop()\n      return ct\n    }\n    return ''\n  })\n\n  // Make sure tags are closed.\n  var l = ansiCodes.length\n  ;(l > 0) && (ret += Array(l + 1).join('</span>'))\n\n  return ret\n}\n\n/**\n * Customize colors.\n * @param {Object} colors reference to _defColors\n */\nansiHTML.setColors = function (colors) {\n  if (typeof colors !== 'object') {\n    throw new Error('`colors` parameter must be an Object.')\n  }\n\n  var _finalColors = {}\n  for (var key in _defColors) {\n    var hex = colors.hasOwnProperty(key) ? colors[key] : null\n    if (!hex) {\n      _finalColors[key] = _defColors[key]\n      continue\n    }\n    if ('reset' === key) {\n      if (typeof hex === 'string') {\n        hex = [hex]\n      }\n      if (!Array.isArray(hex) || hex.length === 0 || hex.some(function (h) {\n        return typeof h !== 'string'\n      })) {\n        throw new Error('The value of `' + key + '` property must be an Array and each item could only be a hex string, e.g.: FF0000')\n      }\n      var defHexColor = _defColors[key]\n      if (!hex[0]) {\n        hex[0] = defHexColor[0]\n      }\n      if (hex.length === 1 || !hex[1]) {\n        hex = [hex[0]]\n        hex.push(defHexColor[1])\n      }\n\n      hex = hex.slice(0, 2)\n    } else if (typeof hex !== 'string') {\n      throw new Error('The value of `' + key + '` property must be a hex string, e.g.: FF0000')\n    }\n    _finalColors[key] = hex\n  }\n  _setTags(_finalColors)\n}\n\n/**\n * Reset colors.\n */\nansiHTML.reset = function () {\n  _setTags(_defColors)\n}\n\n/**\n * Expose tags, including open and close.\n * @type {Object}\n */\nansiHTML.tags = {}\n\nif (Object.defineProperty) {\n  Object.defineProperty(ansiHTML.tags, 'open', {\n    get: function () { return _openTags }\n  })\n  Object.defineProperty(ansiHTML.tags, 'close', {\n    get: function () { return _closeTags }\n  })\n} else {\n  ansiHTML.tags.open = _openTags\n  ansiHTML.tags.close = _closeTags\n}\n\nfunction _setTags (colors) {\n  // reset all\n  _openTags['0'] = 'font-weight:normal;opacity:1;color:#' + colors.reset[0] + ';background:#' + colors.reset[1]\n  // inverse\n  _openTags['7'] = 'color:#' + colors.reset[1] + ';background:#' + colors.reset[0]\n  // dark grey\n  _openTags['90'] = 'color:#' + colors.darkgrey\n\n  for (var code in _styles) {\n    var color = _styles[code]\n    var oriColor = colors[color] || '000'\n    _openTags[code] = 'color:#' + oriColor\n    code = parseInt(code)\n    _openTags[(code + 10).toString()] = 'background:#' + oriColor\n  }\n}\n\nansiHTML.reset()\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYW5zaS1odG1sLWNvbW11bml0eS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBWTs7QUFFWjs7QUFFQTtBQUNBLG1EQUFtRCxJQUFJLFNBQVMsTUFBTSxJQUFJOztBQUUxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLENBQUM7QUFDRDtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBOztBQUVBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkIsR0FBRztBQUNIO0FBQ0EsdUJBQXVCO0FBQ3ZCLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx1Q0FBdUMsVUFBVSwrQkFBK0I7QUFDaEY7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy9hbnNpLWh0bWwtY29tbXVuaXR5L2luZGV4LmpzP2RmMDYiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5cbm1vZHVsZS5leHBvcnRzID0gYW5zaUhUTUxcblxuLy8gUmVmZXJlbmNlIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9zaW5kcmVzb3JodXMvYW5zaS1yZWdleFxudmFyIF9yZWdBTlNJID0gLyg/Oig/OlxcdTAwMWJcXFspfFxcdTAwOWIpKD86KD86WzAtOV17MSwzfSk/KD86KD86O1swLTldezAsM30pKik/W0EtTXxmLW1dKXxcXHUwMDFiW0EtTV0vXG5cbnZhciBfZGVmQ29sb3JzID0ge1xuICByZXNldDogWydmZmYnLCAnMDAwJ10sIC8vIFtGT1JFR1JPVURfQ09MT1IsIEJBQ0tHUk9VTkRfQ09MT1JdXG4gIGJsYWNrOiAnMDAwJyxcbiAgcmVkOiAnZmYwMDAwJyxcbiAgZ3JlZW46ICcyMDk4MDUnLFxuICB5ZWxsb3c6ICdlOGJmMDMnLFxuICBibHVlOiAnMDAwMGZmJyxcbiAgbWFnZW50YTogJ2ZmMDBmZicsXG4gIGN5YW46ICcwMGZmZWUnLFxuICBsaWdodGdyZXk6ICdmMGYwZjAnLFxuICBkYXJrZ3JleTogJzg4OCdcbn1cbnZhciBfc3R5bGVzID0ge1xuICAzMDogJ2JsYWNrJyxcbiAgMzE6ICdyZWQnLFxuICAzMjogJ2dyZWVuJyxcbiAgMzM6ICd5ZWxsb3cnLFxuICAzNDogJ2JsdWUnLFxuICAzNTogJ21hZ2VudGEnLFxuICAzNjogJ2N5YW4nLFxuICAzNzogJ2xpZ2h0Z3JleSdcbn1cbnZhciBfb3BlblRhZ3MgPSB7XG4gICcxJzogJ2ZvbnQtd2VpZ2h0OmJvbGQnLCAvLyBib2xkXG4gICcyJzogJ29wYWNpdHk6MC41JywgLy8gZGltXG4gICczJzogJzxpPicsIC8vIGl0YWxpY1xuICAnNCc6ICc8dT4nLCAvLyB1bmRlcnNjb3JlXG4gICc4JzogJ2Rpc3BsYXk6bm9uZScsIC8vIGhpZGRlblxuICAnOSc6ICc8ZGVsPicgLy8gZGVsZXRlXG59XG52YXIgX2Nsb3NlVGFncyA9IHtcbiAgJzIzJzogJzwvaT4nLCAvLyByZXNldCBpdGFsaWNcbiAgJzI0JzogJzwvdT4nLCAvLyByZXNldCB1bmRlcnNjb3JlXG4gICcyOSc6ICc8L2RlbD4nIC8vIHJlc2V0IGRlbGV0ZVxufVxuXG47WzAsIDIxLCAyMiwgMjcsIDI4LCAzOSwgNDldLmZvckVhY2goZnVuY3Rpb24gKG4pIHtcbiAgX2Nsb3NlVGFnc1tuXSA9ICc8L3NwYW4+J1xufSlcblxuLyoqXG4gKiBDb252ZXJ0cyB0ZXh0IHdpdGggQU5TSSBjb2xvciBjb2RlcyB0byBIVE1MIG1hcmt1cC5cbiAqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0XG4gKiBAcmV0dXJucyB7Kn1cbiAqL1xuZnVuY3Rpb24gYW5zaUhUTUwgKHRleHQpIHtcbiAgLy8gUmV0dXJucyB0aGUgdGV4dCBpZiB0aGUgc3RyaW5nIGhhcyBubyBBTlNJIGVzY2FwZSBjb2RlLlxuICBpZiAoIV9yZWdBTlNJLnRlc3QodGV4dCkpIHtcbiAgICByZXR1cm4gdGV4dFxuICB9XG5cbiAgLy8gQ2FjaGUgb3BlbmVkIHNlcXVlbmNlLlxuICB2YXIgYW5zaUNvZGVzID0gW11cbiAgLy8gUmVwbGFjZSB3aXRoIG1hcmt1cC5cbiAgdmFyIHJldCA9IHRleHQucmVwbGFjZSgvXFwwMzNcXFsoXFxkKyltL2csIGZ1bmN0aW9uIChtYXRjaCwgc2VxKSB7XG4gICAgdmFyIG90ID0gX29wZW5UYWdzW3NlcV1cbiAgICBpZiAob3QpIHtcbiAgICAgIC8vIElmIGN1cnJlbnQgc2VxdWVuY2UgaGFzIGJlZW4gb3BlbmVkLCBjbG9zZSBpdC5cbiAgICAgIGlmICghIX5hbnNpQ29kZXMuaW5kZXhPZihzZXEpKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZXh0cmEtYm9vbGVhbi1jYXN0XG4gICAgICAgIGFuc2lDb2Rlcy5wb3AoKVxuICAgICAgICByZXR1cm4gJzwvc3Bhbj4nXG4gICAgICB9XG4gICAgICAvLyBPcGVuIHRhZy5cbiAgICAgIGFuc2lDb2Rlcy5wdXNoKHNlcSlcbiAgICAgIHJldHVybiBvdFswXSA9PT0gJzwnID8gb3QgOiAnPHNwYW4gc3R5bGU9XCInICsgb3QgKyAnO1wiPidcbiAgICB9XG5cbiAgICB2YXIgY3QgPSBfY2xvc2VUYWdzW3NlcV1cbiAgICBpZiAoY3QpIHtcbiAgICAgIC8vIFBvcCBzZXF1ZW5jZVxuICAgICAgYW5zaUNvZGVzLnBvcCgpXG4gICAgICByZXR1cm4gY3RcbiAgICB9XG4gICAgcmV0dXJuICcnXG4gIH0pXG5cbiAgLy8gTWFrZSBzdXJlIHRhZ3MgYXJlIGNsb3NlZC5cbiAgdmFyIGwgPSBhbnNpQ29kZXMubGVuZ3RoXG4gIDsobCA+IDApICYmIChyZXQgKz0gQXJyYXkobCArIDEpLmpvaW4oJzwvc3Bhbj4nKSlcblxuICByZXR1cm4gcmV0XG59XG5cbi8qKlxuICogQ3VzdG9taXplIGNvbG9ycy5cbiAqIEBwYXJhbSB7T2JqZWN0fSBjb2xvcnMgcmVmZXJlbmNlIHRvIF9kZWZDb2xvcnNcbiAqL1xuYW5zaUhUTUwuc2V0Q29sb3JzID0gZnVuY3Rpb24gKGNvbG9ycykge1xuICBpZiAodHlwZW9mIGNvbG9ycyAhPT0gJ29iamVjdCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2Bjb2xvcnNgIHBhcmFtZXRlciBtdXN0IGJlIGFuIE9iamVjdC4nKVxuICB9XG5cbiAgdmFyIF9maW5hbENvbG9ycyA9IHt9XG4gIGZvciAodmFyIGtleSBpbiBfZGVmQ29sb3JzKSB7XG4gICAgdmFyIGhleCA9IGNvbG9ycy5oYXNPd25Qcm9wZXJ0eShrZXkpID8gY29sb3JzW2tleV0gOiBudWxsXG4gICAgaWYgKCFoZXgpIHtcbiAgICAgIF9maW5hbENvbG9yc1trZXldID0gX2RlZkNvbG9yc1trZXldXG4gICAgICBjb250aW51ZVxuICAgIH1cbiAgICBpZiAoJ3Jlc2V0JyA9PT0ga2V5KSB7XG4gICAgICBpZiAodHlwZW9mIGhleCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaGV4ID0gW2hleF1cbiAgICAgIH1cbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShoZXgpIHx8IGhleC5sZW5ndGggPT09IDAgfHwgaGV4LnNvbWUoZnVuY3Rpb24gKGgpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBoICE9PSAnc3RyaW5nJ1xuICAgICAgfSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgdmFsdWUgb2YgYCcgKyBrZXkgKyAnYCBwcm9wZXJ0eSBtdXN0IGJlIGFuIEFycmF5IGFuZCBlYWNoIGl0ZW0gY291bGQgb25seSBiZSBhIGhleCBzdHJpbmcsIGUuZy46IEZGMDAwMCcpXG4gICAgICB9XG4gICAgICB2YXIgZGVmSGV4Q29sb3IgPSBfZGVmQ29sb3JzW2tleV1cbiAgICAgIGlmICghaGV4WzBdKSB7XG4gICAgICAgIGhleFswXSA9IGRlZkhleENvbG9yWzBdXG4gICAgICB9XG4gICAgICBpZiAoaGV4Lmxlbmd0aCA9PT0gMSB8fCAhaGV4WzFdKSB7XG4gICAgICAgIGhleCA9IFtoZXhbMF1dXG4gICAgICAgIGhleC5wdXNoKGRlZkhleENvbG9yWzFdKVxuICAgICAgfVxuXG4gICAgICBoZXggPSBoZXguc2xpY2UoMCwgMilcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBoZXggIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSB2YWx1ZSBvZiBgJyArIGtleSArICdgIHByb3BlcnR5IG11c3QgYmUgYSBoZXggc3RyaW5nLCBlLmcuOiBGRjAwMDAnKVxuICAgIH1cbiAgICBfZmluYWxDb2xvcnNba2V5XSA9IGhleFxuICB9XG4gIF9zZXRUYWdzKF9maW5hbENvbG9ycylcbn1cblxuLyoqXG4gKiBSZXNldCBjb2xvcnMuXG4gKi9cbmFuc2lIVE1MLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICBfc2V0VGFncyhfZGVmQ29sb3JzKVxufVxuXG4vKipcbiAqIEV4cG9zZSB0YWdzLCBpbmNsdWRpbmcgb3BlbiBhbmQgY2xvc2UuXG4gKiBAdHlwZSB7T2JqZWN0fVxuICovXG5hbnNpSFRNTC50YWdzID0ge31cblxuaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYW5zaUhUTUwudGFncywgJ29wZW4nLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBfb3BlblRhZ3MgfVxuICB9KVxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYW5zaUhUTUwudGFncywgJ2Nsb3NlJywge1xuICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gX2Nsb3NlVGFncyB9XG4gIH0pXG59IGVsc2Uge1xuICBhbnNpSFRNTC50YWdzLm9wZW4gPSBfb3BlblRhZ3NcbiAgYW5zaUhUTUwudGFncy5jbG9zZSA9IF9jbG9zZVRhZ3Ncbn1cblxuZnVuY3Rpb24gX3NldFRhZ3MgKGNvbG9ycykge1xuICAvLyByZXNldCBhbGxcbiAgX29wZW5UYWdzWycwJ10gPSAnZm9udC13ZWlnaHQ6bm9ybWFsO29wYWNpdHk6MTtjb2xvcjojJyArIGNvbG9ycy5yZXNldFswXSArICc7YmFja2dyb3VuZDojJyArIGNvbG9ycy5yZXNldFsxXVxuICAvLyBpbnZlcnNlXG4gIF9vcGVuVGFnc1snNyddID0gJ2NvbG9yOiMnICsgY29sb3JzLnJlc2V0WzFdICsgJztiYWNrZ3JvdW5kOiMnICsgY29sb3JzLnJlc2V0WzBdXG4gIC8vIGRhcmsgZ3JleVxuICBfb3BlblRhZ3NbJzkwJ10gPSAnY29sb3I6IycgKyBjb2xvcnMuZGFya2dyZXlcblxuICBmb3IgKHZhciBjb2RlIGluIF9zdHlsZXMpIHtcbiAgICB2YXIgY29sb3IgPSBfc3R5bGVzW2NvZGVdXG4gICAgdmFyIG9yaUNvbG9yID0gY29sb3JzW2NvbG9yXSB8fCAnMDAwJ1xuICAgIF9vcGVuVGFnc1tjb2RlXSA9ICdjb2xvcjojJyArIG9yaUNvbG9yXG4gICAgY29kZSA9IHBhcnNlSW50KGNvZGUpXG4gICAgX29wZW5UYWdzWyhjb2RlICsgMTApLnRvU3RyaW5nKCldID0gJ2JhY2tncm91bmQ6IycgKyBvcmlDb2xvclxuICB9XG59XG5cbmFuc2lIVE1MLnJlc2V0KClcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/ansi-html-community/index.js\n\n}");

/***/ }),

/***/ "./node_modules/events/events.js":
/*!***************************************!*\
  !*** ./node_modules/events/events.js ***!
  \***************************************/
/***/ ((module) => {

"use strict";
eval("{// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZXZlbnRzL2V2ZW50cy5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjs7QUFFbkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0Isc0JBQXNCO0FBQ3hDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7O0FBRUEsa0NBQWtDLFFBQVE7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSx1Q0FBdUMsUUFBUTtBQUMvQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLE9BQU87QUFDekI7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUyx5QkFBeUI7QUFDbEM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0IsZ0JBQWdCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsOERBQThELFlBQVk7QUFDMUU7QUFDQSw4REFBOEQsWUFBWTtBQUMxRTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLFlBQVk7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy9ldmVudHMvZXZlbnRzLmpzP2ZhYTEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIFIgPSB0eXBlb2YgUmVmbGVjdCA9PT0gJ29iamVjdCcgPyBSZWZsZWN0IDogbnVsbFxudmFyIFJlZmxlY3RBcHBseSA9IFIgJiYgdHlwZW9mIFIuYXBwbHkgPT09ICdmdW5jdGlvbidcbiAgPyBSLmFwcGx5XG4gIDogZnVuY3Rpb24gUmVmbGVjdEFwcGx5KHRhcmdldCwgcmVjZWl2ZXIsIGFyZ3MpIHtcbiAgICByZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmNhbGwodGFyZ2V0LCByZWNlaXZlciwgYXJncyk7XG4gIH1cblxudmFyIFJlZmxlY3RPd25LZXlzXG5pZiAoUiAmJiB0eXBlb2YgUi5vd25LZXlzID09PSAnZnVuY3Rpb24nKSB7XG4gIFJlZmxlY3RPd25LZXlzID0gUi5vd25LZXlzXG59IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgUmVmbGVjdE93bktleXMgPSBmdW5jdGlvbiBSZWZsZWN0T3duS2V5cyh0YXJnZXQpIHtcbiAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGFyZ2V0KVxuICAgICAgLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHRhcmdldCkpO1xuICB9O1xufSBlbHNlIHtcbiAgUmVmbGVjdE93bktleXMgPSBmdW5jdGlvbiBSZWZsZWN0T3duS2V5cyh0YXJnZXQpIHtcbiAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGFyZ2V0KTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gUHJvY2Vzc0VtaXRXYXJuaW5nKHdhcm5pbmcpIHtcbiAgaWYgKGNvbnNvbGUgJiYgY29uc29sZS53YXJuKSBjb25zb2xlLndhcm4od2FybmluZyk7XG59XG5cbnZhciBOdW1iZXJJc05hTiA9IE51bWJlci5pc05hTiB8fCBmdW5jdGlvbiBOdW1iZXJJc05hTih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgIT09IHZhbHVlO1xufVxuXG5mdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gIEV2ZW50RW1pdHRlci5pbml0LmNhbGwodGhpcyk7XG59XG5tb2R1bGUuZXhwb3J0cyA9IEV2ZW50RW1pdHRlcjtcbm1vZHVsZS5leHBvcnRzLm9uY2UgPSBvbmNlO1xuXG4vLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLnhcbkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50c0NvdW50ID0gMDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDtcblxuLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlXG4vLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLlxudmFyIGRlZmF1bHRNYXhMaXN0ZW5lcnMgPSAxMDtcblxuZnVuY3Rpb24gY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcikge1xuICBpZiAodHlwZW9mIGxpc3RlbmVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIFwibGlzdGVuZXJcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgRnVuY3Rpb24uIFJlY2VpdmVkIHR5cGUgJyArIHR5cGVvZiBsaXN0ZW5lcik7XG4gIH1cbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KEV2ZW50RW1pdHRlciwgJ2RlZmF1bHRNYXhMaXN0ZW5lcnMnLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGRlZmF1bHRNYXhMaXN0ZW5lcnM7XG4gIH0sXG4gIHNldDogZnVuY3Rpb24oYXJnKSB7XG4gICAgaWYgKHR5cGVvZiBhcmcgIT09ICdudW1iZXInIHx8IGFyZyA8IDAgfHwgTnVtYmVySXNOYU4oYXJnKSkge1xuICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBvZiBcImRlZmF1bHRNYXhMaXN0ZW5lcnNcIiBpcyBvdXQgb2YgcmFuZ2UuIEl0IG11c3QgYmUgYSBub24tbmVnYXRpdmUgbnVtYmVyLiBSZWNlaXZlZCAnICsgYXJnICsgJy4nKTtcbiAgICB9XG4gICAgZGVmYXVsdE1heExpc3RlbmVycyA9IGFyZztcbiAgfVxufSk7XG5cbkV2ZW50RW1pdHRlci5pbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKHRoaXMuX2V2ZW50cyA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICB0aGlzLl9ldmVudHMgPT09IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKS5fZXZlbnRzKSB7XG4gICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG4gIH1cblxuICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkO1xufTtcblxuLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzXG4vLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24gc2V0TWF4TGlzdGVuZXJzKG4pIHtcbiAgaWYgKHR5cGVvZiBuICE9PSAnbnVtYmVyJyB8fCBuIDwgMCB8fCBOdW1iZXJJc05hTihuKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdUaGUgdmFsdWUgb2YgXCJuXCIgaXMgb3V0IG9mIHJhbmdlLiBJdCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4gUmVjZWl2ZWQgJyArIG4gKyAnLicpO1xuICB9XG4gIHRoaXMuX21heExpc3RlbmVycyA9IG47XG4gIHJldHVybiB0aGlzO1xufTtcblxuZnVuY3Rpb24gX2dldE1heExpc3RlbmVycyh0aGF0KSB7XG4gIGlmICh0aGF0Ll9tYXhMaXN0ZW5lcnMgPT09IHVuZGVmaW5lZClcbiAgICByZXR1cm4gRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnM7XG4gIHJldHVybiB0aGF0Ll9tYXhMaXN0ZW5lcnM7XG59XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZ2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24gZ2V0TWF4TGlzdGVuZXJzKCkge1xuICByZXR1cm4gX2dldE1heExpc3RlbmVycyh0aGlzKTtcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIGVtaXQodHlwZSkge1xuICB2YXIgYXJncyA9IFtdO1xuICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7XG4gIHZhciBkb0Vycm9yID0gKHR5cGUgPT09ICdlcnJvcicpO1xuXG4gIHZhciBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gIGlmIChldmVudHMgIT09IHVuZGVmaW5lZClcbiAgICBkb0Vycm9yID0gKGRvRXJyb3IgJiYgZXZlbnRzLmVycm9yID09PSB1bmRlZmluZWQpO1xuICBlbHNlIGlmICghZG9FcnJvcilcbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LlxuICBpZiAoZG9FcnJvcikge1xuICAgIHZhciBlcjtcbiAgICBpZiAoYXJncy5sZW5ndGggPiAwKVxuICAgICAgZXIgPSBhcmdzWzBdO1xuICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAvLyBOb3RlOiBUaGUgY29tbWVudHMgb24gdGhlIGB0aHJvd2AgbGluZXMgYXJlIGludGVudGlvbmFsLCB0aGV5IHNob3dcbiAgICAgIC8vIHVwIGluIE5vZGUncyBvdXRwdXQgaWYgdGhpcyByZXN1bHRzIGluIGFuIHVuaGFuZGxlZCBleGNlcHRpb24uXG4gICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICB9XG4gICAgLy8gQXQgbGVhc3QgZ2l2ZSBzb21lIGtpbmQgb2YgY29udGV4dCB0byB0aGUgdXNlclxuICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuaGFuZGxlZCBlcnJvci4nICsgKGVyID8gJyAoJyArIGVyLm1lc3NhZ2UgKyAnKScgOiAnJykpO1xuICAgIGVyci5jb250ZXh0ID0gZXI7XG4gICAgdGhyb3cgZXJyOyAvLyBVbmhhbmRsZWQgJ2Vycm9yJyBldmVudFxuICB9XG5cbiAgdmFyIGhhbmRsZXIgPSBldmVudHNbdHlwZV07XG5cbiAgaWYgKGhhbmRsZXIgPT09IHVuZGVmaW5lZClcbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgUmVmbGVjdEFwcGx5KGhhbmRsZXIsIHRoaXMsIGFyZ3MpO1xuICB9IGVsc2Uge1xuICAgIHZhciBsZW4gPSBoYW5kbGVyLmxlbmd0aDtcbiAgICB2YXIgbGlzdGVuZXJzID0gYXJyYXlDbG9uZShoYW5kbGVyLCBsZW4pO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpXG4gICAgICBSZWZsZWN0QXBwbHkobGlzdGVuZXJzW2ldLCB0aGlzLCBhcmdzKTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufTtcblxuZnVuY3Rpb24gX2FkZExpc3RlbmVyKHRhcmdldCwgdHlwZSwgbGlzdGVuZXIsIHByZXBlbmQpIHtcbiAgdmFyIG07XG4gIHZhciBldmVudHM7XG4gIHZhciBleGlzdGluZztcblxuICBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKTtcblxuICBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcbiAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZXZlbnRzID0gdGFyZ2V0Ll9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRhcmdldC5fZXZlbnRzQ291bnQgPSAwO1xuICB9IGVsc2Uge1xuICAgIC8vIFRvIGF2b2lkIHJlY3Vyc2lvbiBpbiB0aGUgY2FzZSB0aGF0IHR5cGUgPT09IFwibmV3TGlzdGVuZXJcIiEgQmVmb3JlXG4gICAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgXCJuZXdMaXN0ZW5lclwiLlxuICAgIGlmIChldmVudHMubmV3TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGFyZ2V0LmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSxcbiAgICAgICAgICAgICAgICAgIGxpc3RlbmVyLmxpc3RlbmVyID8gbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7XG5cbiAgICAgIC8vIFJlLWFzc2lnbiBgZXZlbnRzYCBiZWNhdXNlIGEgbmV3TGlzdGVuZXIgaGFuZGxlciBjb3VsZCBoYXZlIGNhdXNlZCB0aGVcbiAgICAgIC8vIHRoaXMuX2V2ZW50cyB0byBiZSBhc3NpZ25lZCB0byBhIG5ldyBvYmplY3RcbiAgICAgIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzO1xuICAgIH1cbiAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXTtcbiAgfVxuXG4gIGlmIChleGlzdGluZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuXG4gICAgZXhpc3RpbmcgPSBldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjtcbiAgICArK3RhcmdldC5fZXZlbnRzQ291bnQ7XG4gIH0gZWxzZSB7XG4gICAgaWYgKHR5cGVvZiBleGlzdGluZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuXG4gICAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXSA9XG4gICAgICAgIHByZXBlbmQgPyBbbGlzdGVuZXIsIGV4aXN0aW5nXSA6IFtleGlzdGluZywgbGlzdGVuZXJdO1xuICAgICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLlxuICAgIH0gZWxzZSBpZiAocHJlcGVuZCkge1xuICAgICAgZXhpc3RpbmcudW5zaGlmdChsaXN0ZW5lcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4aXN0aW5nLnB1c2gobGlzdGVuZXIpO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBsaXN0ZW5lciBsZWFrXG4gICAgbSA9IF9nZXRNYXhMaXN0ZW5lcnModGFyZ2V0KTtcbiAgICBpZiAobSA+IDAgJiYgZXhpc3RpbmcubGVuZ3RoID4gbSAmJiAhZXhpc3Rpbmcud2FybmVkKSB7XG4gICAgICBleGlzdGluZy53YXJuZWQgPSB0cnVlO1xuICAgICAgLy8gTm8gZXJyb3IgY29kZSBmb3IgdGhpcyBzaW5jZSBpdCBpcyBhIFdhcm5pbmdcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuICAgICAgdmFyIHcgPSBuZXcgRXJyb3IoJ1Bvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgbGVhayBkZXRlY3RlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nLmxlbmd0aCArICcgJyArIFN0cmluZyh0eXBlKSArICcgbGlzdGVuZXJzICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnYWRkZWQuIFVzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnaW5jcmVhc2UgbGltaXQnKTtcbiAgICAgIHcubmFtZSA9ICdNYXhMaXN0ZW5lcnNFeGNlZWRlZFdhcm5pbmcnO1xuICAgICAgdy5lbWl0dGVyID0gdGFyZ2V0O1xuICAgICAgdy50eXBlID0gdHlwZTtcbiAgICAgIHcuY291bnQgPSBleGlzdGluZy5sZW5ndGg7XG4gICAgICBQcm9jZXNzRW1pdFdhcm5pbmcodyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uIGFkZExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gIHJldHVybiBfYWRkTGlzdGVuZXIodGhpcywgdHlwZSwgbGlzdGVuZXIsIGZhbHNlKTtcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyO1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnByZXBlbmRMaXN0ZW5lciA9XG4gICAgZnVuY3Rpb24gcHJlcGVuZExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICByZXR1cm4gX2FkZExpc3RlbmVyKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCB0cnVlKTtcbiAgICB9O1xuXG5mdW5jdGlvbiBvbmNlV3JhcHBlcigpIHtcbiAgaWYgKCF0aGlzLmZpcmVkKSB7XG4gICAgdGhpcy50YXJnZXQucmVtb3ZlTGlzdGVuZXIodGhpcy50eXBlLCB0aGlzLndyYXBGbik7XG4gICAgdGhpcy5maXJlZCA9IHRydWU7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApXG4gICAgICByZXR1cm4gdGhpcy5saXN0ZW5lci5jYWxsKHRoaXMudGFyZ2V0KTtcbiAgICByZXR1cm4gdGhpcy5saXN0ZW5lci5hcHBseSh0aGlzLnRhcmdldCwgYXJndW1lbnRzKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBfb25jZVdyYXAodGFyZ2V0LCB0eXBlLCBsaXN0ZW5lcikge1xuICB2YXIgc3RhdGUgPSB7IGZpcmVkOiBmYWxzZSwgd3JhcEZuOiB1bmRlZmluZWQsIHRhcmdldDogdGFyZ2V0LCB0eXBlOiB0eXBlLCBsaXN0ZW5lcjogbGlzdGVuZXIgfTtcbiAgdmFyIHdyYXBwZWQgPSBvbmNlV3JhcHBlci5iaW5kKHN0YXRlKTtcbiAgd3JhcHBlZC5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICBzdGF0ZS53cmFwRm4gPSB3cmFwcGVkO1xuICByZXR1cm4gd3JhcHBlZDtcbn1cblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gb25jZSh0eXBlLCBsaXN0ZW5lcikge1xuICBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKTtcbiAgdGhpcy5vbih0eXBlLCBfb25jZVdyYXAodGhpcywgdHlwZSwgbGlzdGVuZXIpKTtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnByZXBlbmRPbmNlTGlzdGVuZXIgPVxuICAgIGZ1bmN0aW9uIHByZXBlbmRPbmNlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgICAgdGhpcy5wcmVwZW5kTGlzdGVuZXIodHlwZSwgX29uY2VXcmFwKHRoaXMsIHR5cGUsIGxpc3RlbmVyKSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4vLyBFbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWYgYW5kIG9ubHkgaWYgdGhlIGxpc3RlbmVyIHdhcyByZW1vdmVkLlxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9XG4gICAgZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgIHZhciBsaXN0LCBldmVudHMsIHBvc2l0aW9uLCBpLCBvcmlnaW5hbExpc3RlbmVyO1xuXG4gICAgICBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKTtcblxuICAgICAgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKVxuICAgICAgICByZXR1cm4gdGhpcztcblxuICAgICAgbGlzdCA9IGV2ZW50c1t0eXBlXTtcbiAgICAgIGlmIChsaXN0ID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHwgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKC0tdGhpcy5fZXZlbnRzQ291bnQgPT09IDApXG4gICAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZGVsZXRlIGV2ZW50c1t0eXBlXTtcbiAgICAgICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyKVxuICAgICAgICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3QubGlzdGVuZXIgfHwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBsaXN0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHBvc2l0aW9uID0gLTE7XG5cbiAgICAgICAgZm9yIChpID0gbGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgIGlmIChsaXN0W2ldID09PSBsaXN0ZW5lciB8fCBsaXN0W2ldLmxpc3RlbmVyID09PSBsaXN0ZW5lcikge1xuICAgICAgICAgICAgb3JpZ2luYWxMaXN0ZW5lciA9IGxpc3RbaV0ubGlzdGVuZXI7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocG9zaXRpb24gPCAwKVxuICAgICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gMClcbiAgICAgICAgICBsaXN0LnNoaWZ0KCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHNwbGljZU9uZShsaXN0LCBwb3NpdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobGlzdC5sZW5ndGggPT09IDEpXG4gICAgICAgICAgZXZlbnRzW3R5cGVdID0gbGlzdFswXTtcblxuICAgICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIG9yaWdpbmFsTGlzdGVuZXIgfHwgbGlzdGVuZXIpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9mZiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID1cbiAgICBmdW5jdGlvbiByZW1vdmVBbGxMaXN0ZW5lcnModHlwZSkge1xuICAgICAgdmFyIGxpc3RlbmVycywgZXZlbnRzLCBpO1xuXG4gICAgICBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0XG4gICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudHNbdHlwZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGlmICgtLXRoaXMuX2V2ZW50c0NvdW50ID09PSAwKVxuICAgICAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICBkZWxldGUgZXZlbnRzW3R5cGVdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICAvLyBlbWl0IHJlbW92ZUxpc3RlbmVyIGZvciBhbGwgbGlzdGVuZXJzIG9uIGFsbCBldmVudHNcbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZXZlbnRzKTtcbiAgICAgICAgdmFyIGtleTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgIGlmIChrZXkgPT09ICdyZW1vdmVMaXN0ZW5lcicpIGNvbnRpbnVlO1xuICAgICAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7XG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGxpc3RlbmVycyA9IGV2ZW50c1t0eXBlXTtcblxuICAgICAgaWYgKHR5cGVvZiBsaXN0ZW5lcnMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpO1xuICAgICAgfSBlbHNlIGlmIChsaXN0ZW5lcnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBMSUZPIG9yZGVyXG4gICAgICAgIGZvciAoaSA9IGxpc3RlbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG5mdW5jdGlvbiBfbGlzdGVuZXJzKHRhcmdldCwgdHlwZSwgdW53cmFwKSB7XG4gIHZhciBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcblxuICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpXG4gICAgcmV0dXJuIFtdO1xuXG4gIHZhciBldmxpc3RlbmVyID0gZXZlbnRzW3R5cGVdO1xuICBpZiAoZXZsaXN0ZW5lciA9PT0gdW5kZWZpbmVkKVxuICAgIHJldHVybiBbXTtcblxuICBpZiAodHlwZW9mIGV2bGlzdGVuZXIgPT09ICdmdW5jdGlvbicpXG4gICAgcmV0dXJuIHVud3JhcCA/IFtldmxpc3RlbmVyLmxpc3RlbmVyIHx8IGV2bGlzdGVuZXJdIDogW2V2bGlzdGVuZXJdO1xuXG4gIHJldHVybiB1bndyYXAgP1xuICAgIHVud3JhcExpc3RlbmVycyhldmxpc3RlbmVyKSA6IGFycmF5Q2xvbmUoZXZsaXN0ZW5lciwgZXZsaXN0ZW5lci5sZW5ndGgpO1xufVxuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIGxpc3RlbmVycyh0eXBlKSB7XG4gIHJldHVybiBfbGlzdGVuZXJzKHRoaXMsIHR5cGUsIHRydWUpO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yYXdMaXN0ZW5lcnMgPSBmdW5jdGlvbiByYXdMaXN0ZW5lcnModHlwZSkge1xuICByZXR1cm4gX2xpc3RlbmVycyh0aGlzLCB0eXBlLCBmYWxzZSk7XG59O1xuXG5FdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHtcbiAgaWYgKHR5cGVvZiBlbWl0dGVyLmxpc3RlbmVyQ291bnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBsaXN0ZW5lckNvdW50LmNhbGwoZW1pdHRlciwgdHlwZSk7XG4gIH1cbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGxpc3RlbmVyQ291bnQ7XG5mdW5jdGlvbiBsaXN0ZW5lckNvdW50KHR5cGUpIHtcbiAgdmFyIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcblxuICBpZiAoZXZlbnRzICE9PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgZXZsaXN0ZW5lciA9IGV2ZW50c1t0eXBlXTtcblxuICAgIGlmICh0eXBlb2YgZXZsaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmIChldmxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gMDtcbn1cblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5ldmVudE5hbWVzID0gZnVuY3Rpb24gZXZlbnROYW1lcygpIHtcbiAgcmV0dXJuIHRoaXMuX2V2ZW50c0NvdW50ID4gMCA/IFJlZmxlY3RPd25LZXlzKHRoaXMuX2V2ZW50cykgOiBbXTtcbn07XG5cbmZ1bmN0aW9uIGFycmF5Q2xvbmUoYXJyLCBuKSB7XG4gIHZhciBjb3B5ID0gbmV3IEFycmF5KG4pO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG47ICsraSlcbiAgICBjb3B5W2ldID0gYXJyW2ldO1xuICByZXR1cm4gY29weTtcbn1cblxuZnVuY3Rpb24gc3BsaWNlT25lKGxpc3QsIGluZGV4KSB7XG4gIGZvciAoOyBpbmRleCArIDEgPCBsaXN0Lmxlbmd0aDsgaW5kZXgrKylcbiAgICBsaXN0W2luZGV4XSA9IGxpc3RbaW5kZXggKyAxXTtcbiAgbGlzdC5wb3AoKTtcbn1cblxuZnVuY3Rpb24gdW53cmFwTGlzdGVuZXJzKGFycikge1xuICB2YXIgcmV0ID0gbmV3IEFycmF5KGFyci5sZW5ndGgpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7ICsraSkge1xuICAgIHJldFtpXSA9IGFycltpXS5saXN0ZW5lciB8fCBhcnJbaV07XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gb25jZShlbWl0dGVyLCBuYW1lKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgZnVuY3Rpb24gZXJyb3JMaXN0ZW5lcihlcnIpIHtcbiAgICAgIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIobmFtZSwgcmVzb2x2ZXIpO1xuICAgICAgcmVqZWN0KGVycik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVzb2x2ZXIoKSB7XG4gICAgICBpZiAodHlwZW9mIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZW1pdHRlci5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBlcnJvckxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICAgIHJlc29sdmUoW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKTtcbiAgICB9O1xuXG4gICAgZXZlbnRUYXJnZXRBZ25vc3RpY0FkZExpc3RlbmVyKGVtaXR0ZXIsIG5hbWUsIHJlc29sdmVyLCB7IG9uY2U6IHRydWUgfSk7XG4gICAgaWYgKG5hbWUgIT09ICdlcnJvcicpIHtcbiAgICAgIGFkZEVycm9ySGFuZGxlcklmRXZlbnRFbWl0dGVyKGVtaXR0ZXIsIGVycm9yTGlzdGVuZXIsIHsgb25jZTogdHJ1ZSB9KTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBhZGRFcnJvckhhbmRsZXJJZkV2ZW50RW1pdHRlcihlbWl0dGVyLCBoYW5kbGVyLCBmbGFncykge1xuICBpZiAodHlwZW9mIGVtaXR0ZXIub24gPT09ICdmdW5jdGlvbicpIHtcbiAgICBldmVudFRhcmdldEFnbm9zdGljQWRkTGlzdGVuZXIoZW1pdHRlciwgJ2Vycm9yJywgaGFuZGxlciwgZmxhZ3MpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGV2ZW50VGFyZ2V0QWdub3N0aWNBZGRMaXN0ZW5lcihlbWl0dGVyLCBuYW1lLCBsaXN0ZW5lciwgZmxhZ3MpIHtcbiAgaWYgKHR5cGVvZiBlbWl0dGVyLm9uID09PSAnZnVuY3Rpb24nKSB7XG4gICAgaWYgKGZsYWdzLm9uY2UpIHtcbiAgICAgIGVtaXR0ZXIub25jZShuYW1lLCBsaXN0ZW5lcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVtaXR0ZXIub24obmFtZSwgbGlzdGVuZXIpO1xuICAgIH1cbiAgfSBlbHNlIGlmICh0eXBlb2YgZW1pdHRlci5hZGRFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgLy8gRXZlbnRUYXJnZXQgZG9lcyBub3QgaGF2ZSBgZXJyb3JgIGV2ZW50IHNlbWFudGljcyBsaWtlIE5vZGVcbiAgICAvLyBFdmVudEVtaXR0ZXJzLCB3ZSBkbyBub3QgbGlzdGVuIGZvciBgZXJyb3JgIGV2ZW50cyBoZXJlLlxuICAgIGVtaXR0ZXIuYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmdW5jdGlvbiB3cmFwTGlzdGVuZXIoYXJnKSB7XG4gICAgICAvLyBJRSBkb2VzIG5vdCBoYXZlIGJ1aWx0aW4gYHsgb25jZTogdHJ1ZSB9YCBzdXBwb3J0IHNvIHdlXG4gICAgICAvLyBoYXZlIHRvIGRvIGl0IG1hbnVhbGx5LlxuICAgICAgaWYgKGZsYWdzLm9uY2UpIHtcbiAgICAgICAgZW1pdHRlci5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIHdyYXBMaXN0ZW5lcik7XG4gICAgICB9XG4gICAgICBsaXN0ZW5lcihhcmcpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBcImVtaXR0ZXJcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgRXZlbnRFbWl0dGVyLiBSZWNlaXZlZCB0eXBlICcgKyB0eXBlb2YgZW1pdHRlcik7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/events/events.js\n\n}");

/***/ }),

/***/ "./node_modules/html-entities/dist/esm/index.js":
/*!******************************************************!*\
  !*** ./node_modules/html-entities/dist/esm/index.js ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   decodeEntity: () => (/* binding */ decodeEntity),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n/* harmony import */ var _named_references_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./named-references.js */ \"./node_modules/html-entities/dist/esm/named-references.js\");\n/* harmony import */ var _numeric_unicode_map_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./numeric-unicode-map.js */ \"./node_modules/html-entities/dist/esm/numeric-unicode-map.js\");\n/* harmony import */ var _surrogate_pairs_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./surrogate-pairs.js */ \"./node_modules/html-entities/dist/esm/surrogate-pairs.js\");\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\n\n\nvar allNamedReferences = __assign(__assign({}, _named_references_js__WEBPACK_IMPORTED_MODULE_0__.namedReferences), { all: _named_references_js__WEBPACK_IMPORTED_MODULE_0__.namedReferences.html5 });\nvar encodeRegExps = {\n    specialChars: /[<>'\"&]/g,\n    nonAscii: /[<>'\"&\\u0080-\\uD7FF\\uE000-\\uFFFF\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]?/g,\n    nonAsciiPrintable: /[<>'\"&\\x01-\\x08\\x11-\\x15\\x17-\\x1F\\x7f-\\uD7FF\\uE000-\\uFFFF\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]?/g,\n    nonAsciiPrintableOnly: /[\\x01-\\x08\\x11-\\x15\\x17-\\x1F\\x7f-\\uD7FF\\uE000-\\uFFFF\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]?/g,\n    extensive: /[\\x01-\\x0c\\x0e-\\x1f\\x21-\\x2c\\x2e-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7d\\x7f-\\uD7FF\\uE000-\\uFFFF\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]?/g\n};\nvar defaultEncodeOptions = {\n    mode: 'specialChars',\n    level: 'all',\n    numeric: 'decimal'\n};\n/** Encodes all the necessary (specified by `level`) characters in the text */\nfunction encode(text, _a) {\n    var _b = _a === void 0 ? defaultEncodeOptions : _a, _c = _b.mode, mode = _c === void 0 ? 'specialChars' : _c, _d = _b.numeric, numeric = _d === void 0 ? 'decimal' : _d, _e = _b.level, level = _e === void 0 ? 'all' : _e;\n    if (!text) {\n        return '';\n    }\n    var encodeRegExp = encodeRegExps[mode];\n    var references = allNamedReferences[level].characters;\n    var isHex = numeric === 'hexadecimal';\n    return String.prototype.replace.call(text, encodeRegExp, function (input) {\n        var result = references[input];\n        if (!result) {\n            var code = input.length > 1 ? (0,_surrogate_pairs_js__WEBPACK_IMPORTED_MODULE_2__.getCodePoint)(input, 0) : input.charCodeAt(0);\n            result = (isHex ? '&#x' + code.toString(16) : '&#' + code) + ';';\n        }\n        return result;\n    });\n}\nvar defaultDecodeOptions = {\n    scope: 'body',\n    level: 'all'\n};\nvar strict = /&(?:#\\d+|#[xX][\\da-fA-F]+|[0-9a-zA-Z]+);/g;\nvar attribute = /&(?:#\\d+|#[xX][\\da-fA-F]+|[0-9a-zA-Z]+)[;=]?/g;\nvar baseDecodeRegExps = {\n    xml: {\n        strict: strict,\n        attribute: attribute,\n        body: _named_references_js__WEBPACK_IMPORTED_MODULE_0__.bodyRegExps.xml\n    },\n    html4: {\n        strict: strict,\n        attribute: attribute,\n        body: _named_references_js__WEBPACK_IMPORTED_MODULE_0__.bodyRegExps.html4\n    },\n    html5: {\n        strict: strict,\n        attribute: attribute,\n        body: _named_references_js__WEBPACK_IMPORTED_MODULE_0__.bodyRegExps.html5\n    }\n};\nvar decodeRegExps = __assign(__assign({}, baseDecodeRegExps), { all: baseDecodeRegExps.html5 });\nvar fromCharCode = String.fromCharCode;\nvar outOfBoundsChar = fromCharCode(65533);\nvar defaultDecodeEntityOptions = {\n    level: 'all'\n};\nfunction getDecodedEntity(entity, references, isAttribute, isStrict) {\n    var decodeResult = entity;\n    var decodeEntityLastChar = entity[entity.length - 1];\n    if (isAttribute && decodeEntityLastChar === '=') {\n        decodeResult = entity;\n    }\n    else if (isStrict && decodeEntityLastChar !== ';') {\n        decodeResult = entity;\n    }\n    else {\n        var decodeResultByReference = references[entity];\n        if (decodeResultByReference) {\n            decodeResult = decodeResultByReference;\n        }\n        else if (entity[0] === '&' && entity[1] === '#') {\n            var decodeSecondChar = entity[2];\n            var decodeCode = decodeSecondChar == 'x' || decodeSecondChar == 'X'\n                ? parseInt(entity.substr(3), 16)\n                : parseInt(entity.substr(2));\n            decodeResult =\n                decodeCode >= 0x10ffff\n                    ? outOfBoundsChar\n                    : decodeCode > 65535\n                        ? (0,_surrogate_pairs_js__WEBPACK_IMPORTED_MODULE_2__.fromCodePoint)(decodeCode)\n                        : fromCharCode(_numeric_unicode_map_js__WEBPACK_IMPORTED_MODULE_1__.numericUnicodeMap[decodeCode] || decodeCode);\n        }\n    }\n    return decodeResult;\n}\n/** Decodes a single entity */\nfunction decodeEntity(entity, _a) {\n    var _b = _a === void 0 ? defaultDecodeEntityOptions : _a, _c = _b.level, level = _c === void 0 ? 'all' : _c;\n    if (!entity) {\n        return '';\n    }\n    return getDecodedEntity(entity, allNamedReferences[level].entities, false, false);\n}\n/** Decodes all entities in the text */\nfunction decode(text, _a) {\n    var _b = _a === void 0 ? defaultDecodeOptions : _a, _c = _b.level, level = _c === void 0 ? 'all' : _c, _d = _b.scope, scope = _d === void 0 ? level === 'xml' ? 'strict' : 'body' : _d;\n    if (!text) {\n        return '';\n    }\n    var decodeRegExp = decodeRegExps[level][scope];\n    var references = allNamedReferences[level].entities;\n    var isAttribute = scope === 'attribute';\n    var isStrict = scope === 'strict';\n    return text.replace(decodeRegExp, function (entity) { return getDecodedEntity(entity, references, isAttribute, isStrict); });\n}\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvaHRtbC1lbnRpdGllcy9kaXN0L2VzbS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxnQkFBZ0IsU0FBSSxJQUFJLFNBQUk7QUFDNUI7QUFDQSxpREFBaUQsT0FBTztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ3FFO0FBQ1I7QUFDTTtBQUNuRSw2Q0FBNkMsRUFBRSxpRUFBZSxLQUFLLEtBQUssaUVBQWUsUUFBUTtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsaUVBQVk7QUFDdEQsMkVBQTJFO0FBQzNFO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RCwwREFBMEQ7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDZEQUFXO0FBQ3pCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxjQUFjLDZEQUFXO0FBQ3pCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxjQUFjLDZEQUFXO0FBQ3pCO0FBQ0E7QUFDQSx3Q0FBd0Msd0JBQXdCLDhCQUE4QjtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGtFQUFhO0FBQ3ZDLHVDQUF1QyxzRUFBaUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQscUVBQXFFO0FBQy9IO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vbm9kZV9tb2R1bGVzL2h0bWwtZW50aXRpZXMvZGlzdC9lc20vaW5kZXguanM/Y2U4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19hc3NpZ24gPSAodGhpcyAmJiB0aGlzLl9fYXNzaWduKSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKVxuICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH07XG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xuaW1wb3J0IHsgYm9keVJlZ0V4cHMsIG5hbWVkUmVmZXJlbmNlcyB9IGZyb20gJy4vbmFtZWQtcmVmZXJlbmNlcy5qcyc7XG5pbXBvcnQgeyBudW1lcmljVW5pY29kZU1hcCB9IGZyb20gJy4vbnVtZXJpYy11bmljb2RlLW1hcC5qcyc7XG5pbXBvcnQgeyBmcm9tQ29kZVBvaW50LCBnZXRDb2RlUG9pbnQgfSBmcm9tICcuL3N1cnJvZ2F0ZS1wYWlycy5qcyc7XG52YXIgYWxsTmFtZWRSZWZlcmVuY2VzID0gX19hc3NpZ24oX19hc3NpZ24oe30sIG5hbWVkUmVmZXJlbmNlcyksIHsgYWxsOiBuYW1lZFJlZmVyZW5jZXMuaHRtbDUgfSk7XG52YXIgZW5jb2RlUmVnRXhwcyA9IHtcbiAgICBzcGVjaWFsQ2hhcnM6IC9bPD4nXCImXS9nLFxuICAgIG5vbkFzY2lpOiAvWzw+J1wiJlxcdTAwODAtXFx1RDdGRlxcdUUwMDAtXFx1RkZGRlxcdURDMDAtXFx1REZGRl18W1xcdUQ4MDAtXFx1REJGRl1bXFx1REMwMC1cXHVERkZGXT8vZyxcbiAgICBub25Bc2NpaVByaW50YWJsZTogL1s8PidcIiZcXHgwMS1cXHgwOFxceDExLVxceDE1XFx4MTctXFx4MUZcXHg3Zi1cXHVEN0ZGXFx1RTAwMC1cXHVGRkZGXFx1REMwMC1cXHVERkZGXXxbXFx1RDgwMC1cXHVEQkZGXVtcXHVEQzAwLVxcdURGRkZdPy9nLFxuICAgIG5vbkFzY2lpUHJpbnRhYmxlT25seTogL1tcXHgwMS1cXHgwOFxceDExLVxceDE1XFx4MTctXFx4MUZcXHg3Zi1cXHVEN0ZGXFx1RTAwMC1cXHVGRkZGXFx1REMwMC1cXHVERkZGXXxbXFx1RDgwMC1cXHVEQkZGXVtcXHVEQzAwLVxcdURGRkZdPy9nLFxuICAgIGV4dGVuc2l2ZTogL1tcXHgwMS1cXHgwY1xceDBlLVxceDFmXFx4MjEtXFx4MmNcXHgyZS1cXHgyZlxceDNhLVxceDQwXFx4NWItXFx4NjBcXHg3Yi1cXHg3ZFxceDdmLVxcdUQ3RkZcXHVFMDAwLVxcdUZGRkZcXHVEQzAwLVxcdURGRkZdfFtcXHVEODAwLVxcdURCRkZdW1xcdURDMDAtXFx1REZGRl0/L2dcbn07XG52YXIgZGVmYXVsdEVuY29kZU9wdGlvbnMgPSB7XG4gICAgbW9kZTogJ3NwZWNpYWxDaGFycycsXG4gICAgbGV2ZWw6ICdhbGwnLFxuICAgIG51bWVyaWM6ICdkZWNpbWFsJ1xufTtcbi8qKiBFbmNvZGVzIGFsbCB0aGUgbmVjZXNzYXJ5IChzcGVjaWZpZWQgYnkgYGxldmVsYCkgY2hhcmFjdGVycyBpbiB0aGUgdGV4dCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZSh0ZXh0LCBfYSkge1xuICAgIHZhciBfYiA9IF9hID09PSB2b2lkIDAgPyBkZWZhdWx0RW5jb2RlT3B0aW9ucyA6IF9hLCBfYyA9IF9iLm1vZGUsIG1vZGUgPSBfYyA9PT0gdm9pZCAwID8gJ3NwZWNpYWxDaGFycycgOiBfYywgX2QgPSBfYi5udW1lcmljLCBudW1lcmljID0gX2QgPT09IHZvaWQgMCA/ICdkZWNpbWFsJyA6IF9kLCBfZSA9IF9iLmxldmVsLCBsZXZlbCA9IF9lID09PSB2b2lkIDAgPyAnYWxsJyA6IF9lO1xuICAgIGlmICghdGV4dCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHZhciBlbmNvZGVSZWdFeHAgPSBlbmNvZGVSZWdFeHBzW21vZGVdO1xuICAgIHZhciByZWZlcmVuY2VzID0gYWxsTmFtZWRSZWZlcmVuY2VzW2xldmVsXS5jaGFyYWN0ZXJzO1xuICAgIHZhciBpc0hleCA9IG51bWVyaWMgPT09ICdoZXhhZGVjaW1hbCc7XG4gICAgcmV0dXJuIFN0cmluZy5wcm90b3R5cGUucmVwbGFjZS5jYWxsKHRleHQsIGVuY29kZVJlZ0V4cCwgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSByZWZlcmVuY2VzW2lucHV0XTtcbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIHZhciBjb2RlID0gaW5wdXQubGVuZ3RoID4gMSA/IGdldENvZGVQb2ludChpbnB1dCwgMCkgOiBpbnB1dC5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgcmVzdWx0ID0gKGlzSGV4ID8gJyYjeCcgKyBjb2RlLnRvU3RyaW5nKDE2KSA6ICcmIycgKyBjb2RlKSArICc7JztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xufVxudmFyIGRlZmF1bHREZWNvZGVPcHRpb25zID0ge1xuICAgIHNjb3BlOiAnYm9keScsXG4gICAgbGV2ZWw6ICdhbGwnXG59O1xudmFyIHN0cmljdCA9IC8mKD86I1xcZCt8I1t4WF1bXFxkYS1mQS1GXSt8WzAtOWEtekEtWl0rKTsvZztcbnZhciBhdHRyaWJ1dGUgPSAvJig/OiNcXGQrfCNbeFhdW1xcZGEtZkEtRl0rfFswLTlhLXpBLVpdKylbOz1dPy9nO1xudmFyIGJhc2VEZWNvZGVSZWdFeHBzID0ge1xuICAgIHhtbDoge1xuICAgICAgICBzdHJpY3Q6IHN0cmljdCxcbiAgICAgICAgYXR0cmlidXRlOiBhdHRyaWJ1dGUsXG4gICAgICAgIGJvZHk6IGJvZHlSZWdFeHBzLnhtbFxuICAgIH0sXG4gICAgaHRtbDQ6IHtcbiAgICAgICAgc3RyaWN0OiBzdHJpY3QsXG4gICAgICAgIGF0dHJpYnV0ZTogYXR0cmlidXRlLFxuICAgICAgICBib2R5OiBib2R5UmVnRXhwcy5odG1sNFxuICAgIH0sXG4gICAgaHRtbDU6IHtcbiAgICAgICAgc3RyaWN0OiBzdHJpY3QsXG4gICAgICAgIGF0dHJpYnV0ZTogYXR0cmlidXRlLFxuICAgICAgICBib2R5OiBib2R5UmVnRXhwcy5odG1sNVxuICAgIH1cbn07XG52YXIgZGVjb2RlUmVnRXhwcyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBiYXNlRGVjb2RlUmVnRXhwcyksIHsgYWxsOiBiYXNlRGVjb2RlUmVnRXhwcy5odG1sNSB9KTtcbnZhciBmcm9tQ2hhckNvZGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlO1xudmFyIG91dE9mQm91bmRzQ2hhciA9IGZyb21DaGFyQ29kZSg2NTUzMyk7XG52YXIgZGVmYXVsdERlY29kZUVudGl0eU9wdGlvbnMgPSB7XG4gICAgbGV2ZWw6ICdhbGwnXG59O1xuZnVuY3Rpb24gZ2V0RGVjb2RlZEVudGl0eShlbnRpdHksIHJlZmVyZW5jZXMsIGlzQXR0cmlidXRlLCBpc1N0cmljdCkge1xuICAgIHZhciBkZWNvZGVSZXN1bHQgPSBlbnRpdHk7XG4gICAgdmFyIGRlY29kZUVudGl0eUxhc3RDaGFyID0gZW50aXR5W2VudGl0eS5sZW5ndGggLSAxXTtcbiAgICBpZiAoaXNBdHRyaWJ1dGUgJiYgZGVjb2RlRW50aXR5TGFzdENoYXIgPT09ICc9Jykge1xuICAgICAgICBkZWNvZGVSZXN1bHQgPSBlbnRpdHk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzU3RyaWN0ICYmIGRlY29kZUVudGl0eUxhc3RDaGFyICE9PSAnOycpIHtcbiAgICAgICAgZGVjb2RlUmVzdWx0ID0gZW50aXR5O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGRlY29kZVJlc3VsdEJ5UmVmZXJlbmNlID0gcmVmZXJlbmNlc1tlbnRpdHldO1xuICAgICAgICBpZiAoZGVjb2RlUmVzdWx0QnlSZWZlcmVuY2UpIHtcbiAgICAgICAgICAgIGRlY29kZVJlc3VsdCA9IGRlY29kZVJlc3VsdEJ5UmVmZXJlbmNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGVudGl0eVswXSA9PT0gJyYnICYmIGVudGl0eVsxXSA9PT0gJyMnKSB7XG4gICAgICAgICAgICB2YXIgZGVjb2RlU2Vjb25kQ2hhciA9IGVudGl0eVsyXTtcbiAgICAgICAgICAgIHZhciBkZWNvZGVDb2RlID0gZGVjb2RlU2Vjb25kQ2hhciA9PSAneCcgfHwgZGVjb2RlU2Vjb25kQ2hhciA9PSAnWCdcbiAgICAgICAgICAgICAgICA/IHBhcnNlSW50KGVudGl0eS5zdWJzdHIoMyksIDE2KVxuICAgICAgICAgICAgICAgIDogcGFyc2VJbnQoZW50aXR5LnN1YnN0cigyKSk7XG4gICAgICAgICAgICBkZWNvZGVSZXN1bHQgPVxuICAgICAgICAgICAgICAgIGRlY29kZUNvZGUgPj0gMHgxMGZmZmZcbiAgICAgICAgICAgICAgICAgICAgPyBvdXRPZkJvdW5kc0NoYXJcbiAgICAgICAgICAgICAgICAgICAgOiBkZWNvZGVDb2RlID4gNjU1MzVcbiAgICAgICAgICAgICAgICAgICAgICAgID8gZnJvbUNvZGVQb2ludChkZWNvZGVDb2RlKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBmcm9tQ2hhckNvZGUobnVtZXJpY1VuaWNvZGVNYXBbZGVjb2RlQ29kZV0gfHwgZGVjb2RlQ29kZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRlY29kZVJlc3VsdDtcbn1cbi8qKiBEZWNvZGVzIGEgc2luZ2xlIGVudGl0eSAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZUVudGl0eShlbnRpdHksIF9hKSB7XG4gICAgdmFyIF9iID0gX2EgPT09IHZvaWQgMCA/IGRlZmF1bHREZWNvZGVFbnRpdHlPcHRpb25zIDogX2EsIF9jID0gX2IubGV2ZWwsIGxldmVsID0gX2MgPT09IHZvaWQgMCA/ICdhbGwnIDogX2M7XG4gICAgaWYgKCFlbnRpdHkpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gZ2V0RGVjb2RlZEVudGl0eShlbnRpdHksIGFsbE5hbWVkUmVmZXJlbmNlc1tsZXZlbF0uZW50aXRpZXMsIGZhbHNlLCBmYWxzZSk7XG59XG4vKiogRGVjb2RlcyBhbGwgZW50aXRpZXMgaW4gdGhlIHRleHQgKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGUodGV4dCwgX2EpIHtcbiAgICB2YXIgX2IgPSBfYSA9PT0gdm9pZCAwID8gZGVmYXVsdERlY29kZU9wdGlvbnMgOiBfYSwgX2MgPSBfYi5sZXZlbCwgbGV2ZWwgPSBfYyA9PT0gdm9pZCAwID8gJ2FsbCcgOiBfYywgX2QgPSBfYi5zY29wZSwgc2NvcGUgPSBfZCA9PT0gdm9pZCAwID8gbGV2ZWwgPT09ICd4bWwnID8gJ3N0cmljdCcgOiAnYm9keScgOiBfZDtcbiAgICBpZiAoIXRleHQpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICB2YXIgZGVjb2RlUmVnRXhwID0gZGVjb2RlUmVnRXhwc1tsZXZlbF1bc2NvcGVdO1xuICAgIHZhciByZWZlcmVuY2VzID0gYWxsTmFtZWRSZWZlcmVuY2VzW2xldmVsXS5lbnRpdGllcztcbiAgICB2YXIgaXNBdHRyaWJ1dGUgPSBzY29wZSA9PT0gJ2F0dHJpYnV0ZSc7XG4gICAgdmFyIGlzU3RyaWN0ID0gc2NvcGUgPT09ICdzdHJpY3QnO1xuICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoZGVjb2RlUmVnRXhwLCBmdW5jdGlvbiAoZW50aXR5KSB7IHJldHVybiBnZXREZWNvZGVkRW50aXR5KGVudGl0eSwgcmVmZXJlbmNlcywgaXNBdHRyaWJ1dGUsIGlzU3RyaWN0KTsgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/html-entities/dist/esm/index.js\n\n}");

/***/ }),

/***/ "./node_modules/html-entities/dist/esm/named-references.js":
/*!*****************************************************************!*\
  !*** ./node_modules/html-entities/dist/esm/named-references.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bodyRegExps: () => (/* binding */ bodyRegExps),\n/* harmony export */   namedReferences: () => (/* binding */ namedReferences)\n/* harmony export */ });\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n// This file is autogenerated by tools/process-named-references.ts\nvar pairDivider = \"~\";\nvar blockDivider = \"~~\";\nfunction generateNamedReferences(input, prev) {\n    var entities = {};\n    var characters = {};\n    var blocks = input.split(blockDivider);\n    var isOptionalBlock = false;\n    for (var i = 0; blocks.length > i; i++) {\n        var entries = blocks[i].split(pairDivider);\n        for (var j = 0; j < entries.length; j += 2) {\n            var entity = entries[j];\n            var character = entries[j + 1];\n            var fullEntity = '&' + entity + ';';\n            entities[fullEntity] = character;\n            if (isOptionalBlock) {\n                entities['&' + entity] = character;\n            }\n            characters[character] = fullEntity;\n        }\n        isOptionalBlock = true;\n    }\n    return prev ?\n        { entities: __assign(__assign({}, entities), prev.entities), characters: __assign(__assign({}, characters), prev.characters) } :\n        { entities: entities, characters: characters };\n}\nvar bodyRegExps = {\n    xml: /&(?:#\\d+|#[xX][\\da-fA-F]+|[0-9a-zA-Z]+);?/g,\n    html4: /&notin;|&(?:nbsp|iexcl|cent|pound|curren|yen|brvbar|sect|uml|copy|ordf|laquo|not|shy|reg|macr|deg|plusmn|sup2|sup3|acute|micro|para|middot|cedil|sup1|ordm|raquo|frac14|frac12|frac34|iquest|Agrave|Aacute|Acirc|Atilde|Auml|Aring|AElig|Ccedil|Egrave|Eacute|Ecirc|Euml|Igrave|Iacute|Icirc|Iuml|ETH|Ntilde|Ograve|Oacute|Ocirc|Otilde|Ouml|times|Oslash|Ugrave|Uacute|Ucirc|Uuml|Yacute|THORN|szlig|agrave|aacute|acirc|atilde|auml|aring|aelig|ccedil|egrave|eacute|ecirc|euml|igrave|iacute|icirc|iuml|eth|ntilde|ograve|oacute|ocirc|otilde|ouml|divide|oslash|ugrave|uacute|ucirc|uuml|yacute|thorn|yuml|quot|amp|lt|gt|#\\d+|#[xX][\\da-fA-F]+|[0-9a-zA-Z]+);?/g,\n    html5: /&centerdot;|&copysr;|&divideontimes;|&gtcc;|&gtcir;|&gtdot;|&gtlPar;|&gtquest;|&gtrapprox;|&gtrarr;|&gtrdot;|&gtreqless;|&gtreqqless;|&gtrless;|&gtrsim;|&ltcc;|&ltcir;|&ltdot;|&lthree;|&ltimes;|&ltlarr;|&ltquest;|&ltrPar;|&ltri;|&ltrie;|&ltrif;|&notin;|&notinE;|&notindot;|&notinva;|&notinvb;|&notinvc;|&notni;|&notniva;|&notnivb;|&notnivc;|&parallel;|&timesb;|&timesbar;|&timesd;|&(?:AElig|AMP|Aacute|Acirc|Agrave|Aring|Atilde|Auml|COPY|Ccedil|ETH|Eacute|Ecirc|Egrave|Euml|GT|Iacute|Icirc|Igrave|Iuml|LT|Ntilde|Oacute|Ocirc|Ograve|Oslash|Otilde|Ouml|QUOT|REG|THORN|Uacute|Ucirc|Ugrave|Uuml|Yacute|aacute|acirc|acute|aelig|agrave|amp|aring|atilde|auml|brvbar|ccedil|cedil|cent|copy|curren|deg|divide|eacute|ecirc|egrave|eth|euml|frac12|frac14|frac34|gt|iacute|icirc|iexcl|igrave|iquest|iuml|laquo|lt|macr|micro|middot|nbsp|not|ntilde|oacute|ocirc|ograve|ordf|ordm|oslash|otilde|ouml|para|plusmn|pound|quot|raquo|reg|sect|shy|sup1|sup2|sup3|szlig|thorn|times|uacute|ucirc|ugrave|uml|uuml|yacute|yen|yuml|#\\d+|#[xX][\\da-fA-F]+|[0-9a-zA-Z]+);?/g\n};\nvar namedReferences = {};\nnamedReferences['xml'] = generateNamedReferences(\"lt~<~gt~>~quot~\\\"~apos~'~amp~&\");\nnamedReferences['html4'] = generateNamedReferences(\"apos~'~OElig~~oelig~~Scaron~~scaron~~Yuml~~circ~~tilde~~ensp~~emsp~~thinsp~~zwnj~~zwj~~lrm~~rlm~~ndash~~mdash~~lsquo~~rsquo~~sbquo~~ldquo~~rdquo~~bdquo~~dagger~~Dagger~~permil~~lsaquo~~rsaquo~~euro~~fnof~~Alpha~~Beta~~Gamma~~Delta~~Epsilon~~Zeta~~Eta~~Theta~~Iota~~Kappa~~Lambda~~Mu~~Nu~~Xi~~Omicron~~Pi~~Rho~~Sigma~~Tau~~Upsilon~~Phi~~Chi~~Psi~~Omega~~alpha~~beta~~gamma~~delta~~epsilon~~zeta~~eta~~theta~~iota~~kappa~~lambda~~mu~~nu~~xi~~omicron~~pi~~rho~~sigmaf~~sigma~~tau~~upsilon~~phi~~chi~~psi~~omega~~thetasym~~upsih~~piv~~bull~~hellip~~prime~~Prime~~oline~~frasl~~weierp~~image~~real~~trade~~alefsym~~larr~~uarr~~rarr~~darr~~harr~~crarr~~lArr~~uArr~~rArr~~dArr~~hArr~~forall~~part~~exist~~empty~~nabla~~isin~~notin~~ni~~prod~~sum~~minus~~lowast~~radic~~prop~~infin~~ang~~and~~or~~cap~~cup~~int~~there4~~sim~~cong~~asymp~~ne~~equiv~~le~~ge~~sub~~sup~~nsub~~sube~~supe~~oplus~~otimes~~perp~~sdot~~lceil~~rceil~~lfloor~~rfloor~~lang~~rang~~loz~~spades~~clubs~~hearts~~diams~~~nbsp~~iexcl~~cent~~pound~~curren~~yen~~brvbar~~sect~~uml~~copy~~ordf~~laquo~~not~~shy~~reg~~macr~~deg~~plusmn~~sup2~~sup3~~acute~~micro~~para~~middot~~cedil~~sup1~~ordm~~raquo~~frac14~~frac12~~frac34~~iquest~~Agrave~~Aacute~~Acirc~~Atilde~~Auml~~Aring~~AElig~~Ccedil~~Egrave~~Eacute~~Ecirc~~Euml~~Igrave~~Iacute~~Icirc~~Iuml~~ETH~~Ntilde~~Ograve~~Oacute~~Ocirc~~Otilde~~Ouml~~times~~Oslash~~Ugrave~~Uacute~~Ucirc~~Uuml~~Yacute~~THORN~~szlig~~agrave~~aacute~~acirc~~atilde~~auml~~aring~~aelig~~ccedil~~egrave~~eacute~~ecirc~~euml~~igrave~~iacute~~icirc~~iuml~~eth~~ntilde~~ograve~~oacute~~ocirc~~otilde~~ouml~~divide~~oslash~~ugrave~~uacute~~ucirc~~uuml~~yacute~~thorn~~yuml~~quot~\\\"~amp~&~lt~<~gt~>\");\nnamedReferences['html5'] = generateNamedReferences(\"Abreve~~Acy~~Afr~~Amacr~~And~~Aogon~~Aopf~~ApplyFunction~~Ascr~~Assign~~Backslash~~Barv~~Barwed~~Bcy~~Because~~Bernoullis~~Bfr~~Bopf~~Breve~~Bscr~~Bumpeq~~CHcy~~Cacute~~Cap~~CapitalDifferentialD~~Cayleys~~Ccaron~~Ccirc~~Cconint~~Cdot~~Cedilla~~CenterDot~~Cfr~~CircleDot~~CircleMinus~~CirclePlus~~CircleTimes~~ClockwiseContourIntegral~~CloseCurlyDoubleQuote~~CloseCurlyQuote~~Colon~~Colone~~Congruent~~Conint~~ContourIntegral~~Copf~~Coproduct~~CounterClockwiseContourIntegral~~Cross~~Cscr~~Cup~~CupCap~~DD~~DDotrahd~~DJcy~~DScy~~DZcy~~Darr~~Dashv~~Dcaron~~Dcy~~Del~~Dfr~~DiacriticalAcute~~DiacriticalDot~~DiacriticalDoubleAcute~~DiacriticalGrave~`~DiacriticalTilde~~Diamond~~DifferentialD~~Dopf~~Dot~~DotDot~~DotEqual~~DoubleContourIntegral~~DoubleDot~~DoubleDownArrow~~DoubleLeftArrow~~DoubleLeftRightArrow~~DoubleLeftTee~~DoubleLongLeftArrow~~DoubleLongLeftRightArrow~~DoubleLongRightArrow~~DoubleRightArrow~~DoubleRightTee~~DoubleUpArrow~~DoubleUpDownArrow~~DoubleVerticalBar~~DownArrow~~DownArrowBar~~DownArrowUpArrow~~DownBreve~~DownLeftRightVector~~DownLeftTeeVector~~DownLeftVector~~DownLeftVectorBar~~DownRightTeeVector~~DownRightVector~~DownRightVectorBar~~DownTee~~DownTeeArrow~~Downarrow~~Dscr~~Dstrok~~ENG~~Ecaron~~Ecy~~Edot~~Efr~~Element~~Emacr~~EmptySmallSquare~~EmptyVerySmallSquare~~Eogon~~Eopf~~Equal~~EqualTilde~~Equilibrium~~Escr~~Esim~~Exists~~ExponentialE~~Fcy~~Ffr~~FilledSmallSquare~~FilledVerySmallSquare~~Fopf~~ForAll~~Fouriertrf~~Fscr~~GJcy~~Gammad~~Gbreve~~Gcedil~~Gcirc~~Gcy~~Gdot~~Gfr~~Gg~~Gopf~~GreaterEqual~~GreaterEqualLess~~GreaterFullEqual~~GreaterGreater~~GreaterLess~~GreaterSlantEqual~~GreaterTilde~~Gscr~~Gt~~HARDcy~~Hacek~~Hat~^~Hcirc~~Hfr~~HilbertSpace~~Hopf~~HorizontalLine~~Hscr~~Hstrok~~HumpDownHump~~HumpEqual~~IEcy~~IJlig~~IOcy~~Icy~~Idot~~Ifr~~Im~~Imacr~~ImaginaryI~~Implies~~Int~~Integral~~Intersection~~InvisibleComma~~InvisibleTimes~~Iogon~~Iopf~~Iscr~~Itilde~~Iukcy~~Jcirc~~Jcy~~Jfr~~Jopf~~Jscr~~Jsercy~~Jukcy~~KHcy~~KJcy~~Kcedil~~Kcy~~Kfr~~Kopf~~Kscr~~LJcy~~Lacute~~Lang~~Laplacetrf~~Larr~~Lcaron~~Lcedil~~Lcy~~LeftAngleBracket~~LeftArrow~~LeftArrowBar~~LeftArrowRightArrow~~LeftCeiling~~LeftDoubleBracket~~LeftDownTeeVector~~LeftDownVector~~LeftDownVectorBar~~LeftFloor~~LeftRightArrow~~LeftRightVector~~LeftTee~~LeftTeeArrow~~LeftTeeVector~~LeftTriangle~~LeftTriangleBar~~LeftTriangleEqual~~LeftUpDownVector~~LeftUpTeeVector~~LeftUpVector~~LeftUpVectorBar~~LeftVector~~LeftVectorBar~~Leftarrow~~Leftrightarrow~~LessEqualGreater~~LessFullEqual~~LessGreater~~LessLess~~LessSlantEqual~~LessTilde~~Lfr~~Ll~~Lleftarrow~~Lmidot~~LongLeftArrow~~LongLeftRightArrow~~LongRightArrow~~Longleftarrow~~Longleftrightarrow~~Longrightarrow~~Lopf~~LowerLeftArrow~~LowerRightArrow~~Lscr~~Lsh~~Lstrok~~Lt~~Map~~Mcy~~MediumSpace~~Mellintrf~~Mfr~~MinusPlus~~Mopf~~Mscr~~NJcy~~Nacute~~Ncaron~~Ncedil~~Ncy~~NegativeMediumSpace~~NegativeThickSpace~~NegativeThinSpace~~NegativeVeryThinSpace~~NestedGreaterGreater~~NestedLessLess~~NewLine~\\n~Nfr~~NoBreak~~NonBreakingSpace~~Nopf~~Not~~NotCongruent~~NotCupCap~~NotDoubleVerticalBar~~NotElement~~NotEqual~~NotEqualTilde~~NotExists~~NotGreater~~NotGreaterEqual~~NotGreaterFullEqual~~NotGreaterGreater~~NotGreaterLess~~NotGreaterSlantEqual~~NotGreaterTilde~~NotHumpDownHump~~NotHumpEqual~~NotLeftTriangle~~NotLeftTriangleBar~~NotLeftTriangleEqual~~NotLess~~NotLessEqual~~NotLessGreater~~NotLessLess~~NotLessSlantEqual~~NotLessTilde~~NotNestedGreaterGreater~~NotNestedLessLess~~NotPrecedes~~NotPrecedesEqual~~NotPrecedesSlantEqual~~NotReverseElement~~NotRightTriangle~~NotRightTriangleBar~~NotRightTriangleEqual~~NotSquareSubset~~NotSquareSubsetEqual~~NotSquareSuperset~~NotSquareSupersetEqual~~NotSubset~~NotSubsetEqual~~NotSucceeds~~NotSucceedsEqual~~NotSucceedsSlantEqual~~NotSucceedsTilde~~NotSuperset~~NotSupersetEqual~~NotTilde~~NotTildeEqual~~NotTildeFullEqual~~NotTildeTilde~~NotVerticalBar~~Nscr~~Ocy~~Odblac~~Ofr~~Omacr~~Oopf~~OpenCurlyDoubleQuote~~OpenCurlyQuote~~Or~~Oscr~~Otimes~~OverBar~~OverBrace~~OverBracket~~OverParenthesis~~PartialD~~Pcy~~Pfr~~PlusMinus~~Poincareplane~~Popf~~Pr~~Precedes~~PrecedesEqual~~PrecedesSlantEqual~~PrecedesTilde~~Product~~Proportion~~Proportional~~Pscr~~Qfr~~Qopf~~Qscr~~RBarr~~Racute~~Rang~~Rarr~~Rarrtl~~Rcaron~~Rcedil~~Rcy~~Re~~ReverseElement~~ReverseEquilibrium~~ReverseUpEquilibrium~~Rfr~~RightAngleBracket~~RightArrow~~RightArrowBar~~RightArrowLeftArrow~~RightCeiling~~RightDoubleBracket~~RightDownTeeVector~~RightDownVector~~RightDownVectorBar~~RightFloor~~RightTee~~RightTeeArrow~~RightTeeVector~~RightTriangle~~RightTriangleBar~~RightTriangleEqual~~RightUpDownVector~~RightUpTeeVector~~RightUpVector~~RightUpVectorBar~~RightVector~~RightVectorBar~~Rightarrow~~Ropf~~RoundImplies~~Rrightarrow~~Rscr~~Rsh~~RuleDelayed~~SHCHcy~~SHcy~~SOFTcy~~Sacute~~Sc~~Scedil~~Scirc~~Scy~~Sfr~~ShortDownArrow~~ShortLeftArrow~~ShortRightArrow~~ShortUpArrow~~SmallCircle~~Sopf~~Sqrt~~Square~~SquareIntersection~~SquareSubset~~SquareSubsetEqual~~SquareSuperset~~SquareSupersetEqual~~SquareUnion~~Sscr~~Star~~Sub~~Subset~~SubsetEqual~~Succeeds~~SucceedsEqual~~SucceedsSlantEqual~~SucceedsTilde~~SuchThat~~Sum~~Sup~~Superset~~SupersetEqual~~Supset~~TRADE~~TSHcy~~TScy~~Tab~\\t~Tcaron~~Tcedil~~Tcy~~Tfr~~Therefore~~ThickSpace~~ThinSpace~~Tilde~~TildeEqual~~TildeFullEqual~~TildeTilde~~Topf~~TripleDot~~Tscr~~Tstrok~~Uarr~~Uarrocir~~Ubrcy~~Ubreve~~Ucy~~Udblac~~Ufr~~Umacr~~UnderBar~_~UnderBrace~~UnderBracket~~UnderParenthesis~~Union~~UnionPlus~~Uogon~~Uopf~~UpArrow~~UpArrowBar~~UpArrowDownArrow~~UpDownArrow~~UpEquilibrium~~UpTee~~UpTeeArrow~~Uparrow~~Updownarrow~~UpperLeftArrow~~UpperRightArrow~~Upsi~~Uring~~Uscr~~Utilde~~VDash~~Vbar~~Vcy~~Vdash~~Vdashl~~Vee~~Verbar~~Vert~~VerticalBar~~VerticalLine~|~VerticalSeparator~~VerticalTilde~~VeryThinSpace~~Vfr~~Vopf~~Vscr~~Vvdash~~Wcirc~~Wedge~~Wfr~~Wopf~~Wscr~~Xfr~~Xopf~~Xscr~~YAcy~~YIcy~~YUcy~~Ycirc~~Ycy~~Yfr~~Yopf~~Yscr~~ZHcy~~Zacute~~Zcaron~~Zcy~~Zdot~~ZeroWidthSpace~~Zfr~~Zopf~~Zscr~~abreve~~ac~~acE~~acd~~acy~~af~~afr~~aleph~~amacr~~amalg~~andand~~andd~~andslope~~andv~~ange~~angle~~angmsd~~angmsdaa~~angmsdab~~angmsdac~~angmsdad~~angmsdae~~angmsdaf~~angmsdag~~angmsdah~~angrt~~angrtvb~~angrtvbd~~angsph~~angst~~angzarr~~aogon~~aopf~~ap~~apE~~apacir~~ape~~apid~~approx~~approxeq~~ascr~~ast~*~asympeq~~awconint~~awint~~bNot~~backcong~~backepsilon~~backprime~~backsim~~backsimeq~~barvee~~barwed~~barwedge~~bbrk~~bbrktbrk~~bcong~~bcy~~becaus~~because~~bemptyv~~bepsi~~bernou~~beth~~between~~bfr~~bigcap~~bigcirc~~bigcup~~bigodot~~bigoplus~~bigotimes~~bigsqcup~~bigstar~~bigtriangledown~~bigtriangleup~~biguplus~~bigvee~~bigwedge~~bkarow~~blacklozenge~~blacksquare~~blacktriangle~~blacktriangledown~~blacktriangleleft~~blacktriangleright~~blank~~blk12~~blk14~~blk34~~block~~bne~=~bnequiv~~bnot~~bopf~~bot~~bottom~~bowtie~~boxDL~~boxDR~~boxDl~~boxDr~~boxH~~boxHD~~boxHU~~boxHd~~boxHu~~boxUL~~boxUR~~boxUl~~boxUr~~boxV~~boxVH~~boxVL~~boxVR~~boxVh~~boxVl~~boxVr~~boxbox~~boxdL~~boxdR~~boxdl~~boxdr~~boxh~~boxhD~~boxhU~~boxhd~~boxhu~~boxminus~~boxplus~~boxtimes~~boxuL~~boxuR~~boxul~~boxur~~boxv~~boxvH~~boxvL~~boxvR~~boxvh~~boxvl~~boxvr~~bprime~~breve~~bscr~~bsemi~~bsim~~bsime~~bsol~\\\\~bsolb~~bsolhsub~~bullet~~bump~~bumpE~~bumpe~~bumpeq~~cacute~~capand~~capbrcup~~capcap~~capcup~~capdot~~caps~~caret~~caron~~ccaps~~ccaron~~ccirc~~ccups~~ccupssm~~cdot~~cemptyv~~centerdot~~cfr~~chcy~~check~~checkmark~~cir~~cirE~~circeq~~circlearrowleft~~circlearrowright~~circledR~~circledS~~circledast~~circledcirc~~circleddash~~cire~~cirfnint~~cirmid~~cirscir~~clubsuit~~colon~:~colone~~coloneq~~comma~,~commat~@~comp~~compfn~~complement~~complexes~~congdot~~conint~~copf~~coprod~~copysr~~cross~~cscr~~csub~~csube~~csup~~csupe~~ctdot~~cudarrl~~cudarrr~~cuepr~~cuesc~~cularr~~cularrp~~cupbrcap~~cupcap~~cupcup~~cupdot~~cupor~~cups~~curarr~~curarrm~~curlyeqprec~~curlyeqsucc~~curlyvee~~curlywedge~~curvearrowleft~~curvearrowright~~cuvee~~cuwed~~cwconint~~cwint~~cylcty~~dHar~~daleth~~dash~~dashv~~dbkarow~~dblac~~dcaron~~dcy~~dd~~ddagger~~ddarr~~ddotseq~~demptyv~~dfisht~~dfr~~dharl~~dharr~~diam~~diamond~~diamondsuit~~die~~digamma~~disin~~div~~divideontimes~~divonx~~djcy~~dlcorn~~dlcrop~~dollar~$~dopf~~dot~~doteq~~doteqdot~~dotminus~~dotplus~~dotsquare~~doublebarwedge~~downarrow~~downdownarrows~~downharpoonleft~~downharpoonright~~drbkarow~~drcorn~~drcrop~~dscr~~dscy~~dsol~~dstrok~~dtdot~~dtri~~dtrif~~duarr~~duhar~~dwangle~~dzcy~~dzigrarr~~eDDot~~eDot~~easter~~ecaron~~ecir~~ecolon~~ecy~~edot~~ee~~efDot~~efr~~eg~~egs~~egsdot~~el~~elinters~~ell~~els~~elsdot~~emacr~~emptyset~~emptyv~~emsp13~~emsp14~~eng~~eogon~~eopf~~epar~~eparsl~~eplus~~epsi~~epsiv~~eqcirc~~eqcolon~~eqsim~~eqslantgtr~~eqslantless~~equals~=~equest~~equivDD~~eqvparsl~~erDot~~erarr~~escr~~esdot~~esim~~excl~!~expectation~~exponentiale~~fallingdotseq~~fcy~~female~~ffilig~~fflig~~ffllig~~ffr~~filig~~fjlig~fj~flat~~fllig~~fltns~~fopf~~fork~~forkv~~fpartint~~frac13~~frac15~~frac16~~frac18~~frac23~~frac25~~frac35~~frac38~~frac45~~frac56~~frac58~~frac78~~frown~~fscr~~gE~~gEl~~gacute~~gammad~~gap~~gbreve~~gcirc~~gcy~~gdot~~gel~~geq~~geqq~~geqslant~~ges~~gescc~~gesdot~~gesdoto~~gesdotol~~gesl~~gesles~~gfr~~gg~~ggg~~gimel~~gjcy~~gl~~glE~~gla~~glj~~gnE~~gnap~~gnapprox~~gne~~gneq~~gneqq~~gnsim~~gopf~~grave~`~gscr~~gsim~~gsime~~gsiml~~gtcc~~gtcir~~gtdot~~gtlPar~~gtquest~~gtrapprox~~gtrarr~~gtrdot~~gtreqless~~gtreqqless~~gtrless~~gtrsim~~gvertneqq~~gvnE~~hairsp~~half~~hamilt~~hardcy~~harrcir~~harrw~~hbar~~hcirc~~heartsuit~~hercon~~hfr~~hksearow~~hkswarow~~hoarr~~homtht~~hookleftarrow~~hookrightarrow~~hopf~~horbar~~hscr~~hslash~~hstrok~~hybull~~hyphen~~ic~~icy~~iecy~~iff~~ifr~~ii~~iiiint~~iiint~~iinfin~~iiota~~ijlig~~imacr~~imagline~~imagpart~~imath~~imof~~imped~~in~~incare~~infintie~~inodot~~intcal~~integers~~intercal~~intlarhk~~intprod~~iocy~~iogon~~iopf~~iprod~~iscr~~isinE~~isindot~~isins~~isinsv~~isinv~~it~~itilde~~iukcy~~jcirc~~jcy~~jfr~~jmath~~jopf~~jscr~~jsercy~~jukcy~~kappav~~kcedil~~kcy~~kfr~~kgreen~~khcy~~kjcy~~kopf~~kscr~~lAarr~~lAtail~~lBarr~~lE~~lEg~~lHar~~lacute~~laemptyv~~lagran~~langd~~langle~~lap~~larrb~~larrbfs~~larrfs~~larrhk~~larrlp~~larrpl~~larrsim~~larrtl~~lat~~latail~~late~~lates~~lbarr~~lbbrk~~lbrace~{~lbrack~[~lbrke~~lbrksld~~lbrkslu~~lcaron~~lcedil~~lcub~{~lcy~~ldca~~ldquor~~ldrdhar~~ldrushar~~ldsh~~leftarrow~~leftarrowtail~~leftharpoondown~~leftharpoonup~~leftleftarrows~~leftrightarrow~~leftrightarrows~~leftrightharpoons~~leftrightsquigarrow~~leftthreetimes~~leg~~leq~~leqq~~leqslant~~les~~lescc~~lesdot~~lesdoto~~lesdotor~~lesg~~lesges~~lessapprox~~lessdot~~lesseqgtr~~lesseqqgtr~~lessgtr~~lesssim~~lfisht~~lfr~~lg~~lgE~~lhard~~lharu~~lharul~~lhblk~~ljcy~~ll~~llarr~~llcorner~~llhard~~lltri~~lmidot~~lmoust~~lmoustache~~lnE~~lnap~~lnapprox~~lne~~lneq~~lneqq~~lnsim~~loang~~loarr~~lobrk~~longleftarrow~~longleftrightarrow~~longmapsto~~longrightarrow~~looparrowleft~~looparrowright~~lopar~~lopf~~loplus~~lotimes~~lowbar~_~lozenge~~lozf~~lpar~(~lparlt~~lrarr~~lrcorner~~lrhar~~lrhard~~lrtri~~lscr~~lsh~~lsim~~lsime~~lsimg~~lsqb~[~lsquor~~lstrok~~ltcc~~ltcir~~ltdot~~lthree~~ltimes~~ltlarr~~ltquest~~ltrPar~~ltri~~ltrie~~ltrif~~lurdshar~~luruhar~~lvertneqq~~lvnE~~mDDot~~male~~malt~~maltese~~map~~mapsto~~mapstodown~~mapstoleft~~mapstoup~~marker~~mcomma~~mcy~~measuredangle~~mfr~~mho~~mid~~midast~*~midcir~~minusb~~minusd~~minusdu~~mlcp~~mldr~~mnplus~~models~~mopf~~mp~~mscr~~mstpos~~multimap~~mumap~~nGg~~nGt~~nGtv~~nLeftarrow~~nLeftrightarrow~~nLl~~nLt~~nLtv~~nRightarrow~~nVDash~~nVdash~~nacute~~nang~~nap~~napE~~napid~~napos~~napprox~~natur~~natural~~naturals~~nbump~~nbumpe~~ncap~~ncaron~~ncedil~~ncong~~ncongdot~~ncup~~ncy~~neArr~~nearhk~~nearr~~nearrow~~nedot~~nequiv~~nesear~~nesim~~nexist~~nexists~~nfr~~ngE~~nge~~ngeq~~ngeqq~~ngeqslant~~nges~~ngsim~~ngt~~ngtr~~nhArr~~nharr~~nhpar~~nis~~nisd~~niv~~njcy~~nlArr~~nlE~~nlarr~~nldr~~nle~~nleftarrow~~nleftrightarrow~~nleq~~nleqq~~nleqslant~~nles~~nless~~nlsim~~nlt~~nltri~~nltrie~~nmid~~nopf~~notinE~~notindot~~notinva~~notinvb~~notinvc~~notni~~notniva~~notnivb~~notnivc~~npar~~nparallel~~nparsl~~npart~~npolint~~npr~~nprcue~~npre~~nprec~~npreceq~~nrArr~~nrarr~~nrarrc~~nrarrw~~nrightarrow~~nrtri~~nrtrie~~nsc~~nsccue~~nsce~~nscr~~nshortmid~~nshortparallel~~nsim~~nsime~~nsimeq~~nsmid~~nspar~~nsqsube~~nsqsupe~~nsubE~~nsube~~nsubset~~nsubseteq~~nsubseteqq~~nsucc~~nsucceq~~nsup~~nsupE~~nsupe~~nsupset~~nsupseteq~~nsupseteqq~~ntgl~~ntlg~~ntriangleleft~~ntrianglelefteq~~ntriangleright~~ntrianglerighteq~~num~#~numero~~numsp~~nvDash~~nvHarr~~nvap~~nvdash~~nvge~~nvgt~>~nvinfin~~nvlArr~~nvle~~nvlt~<~nvltrie~~nvrArr~~nvrtrie~~nvsim~~nwArr~~nwarhk~~nwarr~~nwarrow~~nwnear~~oS~~oast~~ocir~~ocy~~odash~~odblac~~odiv~~odot~~odsold~~ofcir~~ofr~~ogon~~ogt~~ohbar~~ohm~~oint~~olarr~~olcir~~olcross~~olt~~omacr~~omid~~ominus~~oopf~~opar~~operp~~orarr~~ord~~order~~orderof~~origof~~oror~~orslope~~orv~~oscr~~osol~~otimesas~~ovbar~~par~~parallel~~parsim~~parsl~~pcy~~percnt~%~period~.~pertenk~~pfr~~phiv~~phmmat~~phone~~pitchfork~~planck~~planckh~~plankv~~plus~+~plusacir~~plusb~~pluscir~~plusdo~~plusdu~~pluse~~plussim~~plustwo~~pm~~pointint~~popf~~pr~~prE~~prap~~prcue~~pre~~prec~~precapprox~~preccurlyeq~~preceq~~precnapprox~~precneqq~~precnsim~~precsim~~primes~~prnE~~prnap~~prnsim~~profalar~~profline~~profsurf~~propto~~prsim~~prurel~~pscr~~puncsp~~qfr~~qint~~qopf~~qprime~~qscr~~quaternions~~quatint~~quest~?~questeq~~rAarr~~rAtail~~rBarr~~rHar~~race~~racute~~raemptyv~~rangd~~range~~rangle~~rarrap~~rarrb~~rarrbfs~~rarrc~~rarrfs~~rarrhk~~rarrlp~~rarrpl~~rarrsim~~rarrtl~~rarrw~~ratail~~ratio~~rationals~~rbarr~~rbbrk~~rbrace~}~rbrack~]~rbrke~~rbrksld~~rbrkslu~~rcaron~~rcedil~~rcub~}~rcy~~rdca~~rdldhar~~rdquor~~rdsh~~realine~~realpart~~reals~~rect~~rfisht~~rfr~~rhard~~rharu~~rharul~~rhov~~rightarrow~~rightarrowtail~~rightharpoondown~~rightharpoonup~~rightleftarrows~~rightleftharpoons~~rightrightarrows~~rightsquigarrow~~rightthreetimes~~ring~~risingdotseq~~rlarr~~rlhar~~rmoust~~rmoustache~~rnmid~~roang~~roarr~~robrk~~ropar~~ropf~~roplus~~rotimes~~rpar~)~rpargt~~rppolint~~rrarr~~rscr~~rsh~~rsqb~]~rsquor~~rthree~~rtimes~~rtri~~rtrie~~rtrif~~rtriltri~~ruluhar~~rx~~sacute~~sc~~scE~~scap~~sccue~~sce~~scedil~~scirc~~scnE~~scnap~~scnsim~~scpolint~~scsim~~scy~~sdotb~~sdote~~seArr~~searhk~~searr~~searrow~~semi~;~seswar~~setminus~~setmn~~sext~~sfr~~sfrown~~sharp~~shchcy~~shcy~~shortmid~~shortparallel~~sigmav~~simdot~~sime~~simeq~~simg~~simgE~~siml~~simlE~~simne~~simplus~~simrarr~~slarr~~smallsetminus~~smashp~~smeparsl~~smid~~smile~~smt~~smte~~smtes~~softcy~~sol~/~solb~~solbar~~sopf~~spadesuit~~spar~~sqcap~~sqcaps~~sqcup~~sqcups~~sqsub~~sqsube~~sqsubset~~sqsubseteq~~sqsup~~sqsupe~~sqsupset~~sqsupseteq~~squ~~square~~squarf~~squf~~srarr~~sscr~~ssetmn~~ssmile~~sstarf~~star~~starf~~straightepsilon~~straightphi~~strns~~subE~~subdot~~subedot~~submult~~subnE~~subne~~subplus~~subrarr~~subset~~subseteq~~subseteqq~~subsetneq~~subsetneqq~~subsim~~subsub~~subsup~~succ~~succapprox~~succcurlyeq~~succeq~~succnapprox~~succneqq~~succnsim~~succsim~~sung~~supE~~supdot~~supdsub~~supedot~~suphsol~~suphsub~~suplarr~~supmult~~supnE~~supne~~supplus~~supset~~supseteq~~supseteqq~~supsetneq~~supsetneqq~~supsim~~supsub~~supsup~~swArr~~swarhk~~swarr~~swarrow~~swnwar~~target~~tbrk~~tcaron~~tcedil~~tcy~~tdot~~telrec~~tfr~~therefore~~thetav~~thickapprox~~thicksim~~thkap~~thksim~~timesb~~timesbar~~timesd~~tint~~toea~~top~~topbot~~topcir~~topf~~topfork~~tosa~~tprime~~triangle~~triangledown~~triangleleft~~trianglelefteq~~triangleq~~triangleright~~trianglerighteq~~tridot~~trie~~triminus~~triplus~~trisb~~tritime~~trpezium~~tscr~~tscy~~tshcy~~tstrok~~twixt~~twoheadleftarrow~~twoheadrightarrow~~uHar~~ubrcy~~ubreve~~ucy~~udarr~~udblac~~udhar~~ufisht~~ufr~~uharl~~uharr~~uhblk~~ulcorn~~ulcorner~~ulcrop~~ultri~~umacr~~uogon~~uopf~~uparrow~~updownarrow~~upharpoonleft~~upharpoonright~~uplus~~upsi~~upuparrows~~urcorn~~urcorner~~urcrop~~uring~~urtri~~uscr~~utdot~~utilde~~utri~~utrif~~uuarr~~uwangle~~vArr~~vBar~~vBarv~~vDash~~vangrt~~varepsilon~~varkappa~~varnothing~~varphi~~varpi~~varpropto~~varr~~varrho~~varsigma~~varsubsetneq~~varsubsetneqq~~varsupsetneq~~varsupsetneqq~~vartheta~~vartriangleleft~~vartriangleright~~vcy~~vdash~~vee~~veebar~~veeeq~~vellip~~verbar~|~vert~|~vfr~~vltri~~vnsub~~vnsup~~vopf~~vprop~~vrtri~~vscr~~vsubnE~~vsubne~~vsupnE~~vsupne~~vzigzag~~wcirc~~wedbar~~wedge~~wedgeq~~wfr~~wopf~~wp~~wr~~wreath~~wscr~~xcap~~xcirc~~xcup~~xdtri~~xfr~~xhArr~~xharr~~xlArr~~xlarr~~xmap~~xnis~~xodot~~xopf~~xoplus~~xotime~~xrArr~~xrarr~~xscr~~xsqcup~~xuplus~~xutri~~xvee~~xwedge~~yacy~~ycirc~~ycy~~yfr~~yicy~~yopf~~yscr~~yucy~~zacute~~zcaron~~zcy~~zdot~~zeetrf~~zfr~~zhcy~~zigrarr~~zopf~~zscr~~~AMP~&~COPY~~GT~>~LT~<~QUOT~\\\"~REG~\", namedReferences['html4']);\n//# sourceMappingURL=named-references.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvaHRtbC1lbnRpdGllcy9kaXN0L2VzbS9uYW1lZC1yZWZlcmVuY2VzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsZ0JBQWdCLFNBQUksSUFBSSxTQUFJO0FBQzVCO0FBQ0EsaURBQWlELE9BQU87QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsbUJBQW1CO0FBQ3ZDO0FBQ0Esd0JBQXdCLG9CQUFvQjtBQUM1QztBQUNBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsOEJBQThCLDZEQUE2RCxrQ0FBa0M7QUFDdkksVUFBVTtBQUNWO0FBQ087QUFDUCxrREFBa0Q7QUFDbEQsbUJBQW1CLDJuQkFBMm5CO0FBQzlvQix1QkFBdUIsU0FBUyxnQkFBZ0IsT0FBTyxRQUFRLFFBQVEsU0FBUyxVQUFVLFlBQVksU0FBUyxTQUFTLFlBQVksYUFBYSxVQUFVLFNBQVMsT0FBTyxRQUFRLFFBQVEsU0FBUyxTQUFTLFNBQVMsVUFBVSxTQUFTLE9BQU8sUUFBUSxRQUFRLFFBQVEsU0FBUyxXQUFXLFVBQVUsVUFBVSxVQUFVLFFBQVEsVUFBVSxVQUFVLFVBQVUsV0FBVyxTQUFTLFdBQVcsU0FBUyxtcEJBQW1wQjtBQUMzaEM7QUFDTztBQUNQO0FBQ0E7QUFDQSw0bVdBQTRtVyw4REFBOEQsaXRIQUFpdEgsOERBQThELGtzQkFBa3NCO0FBQzNuZiIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvaHRtbC1lbnRpdGllcy9kaXN0L2VzbS9uYW1lZC1yZWZlcmVuY2VzLmpzP2NhNzgiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7XG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcbiAgICAgICAgICAgICAgICB0W3BdID0gc1twXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbi8vIFRoaXMgZmlsZSBpcyBhdXRvZ2VuZXJhdGVkIGJ5IHRvb2xzL3Byb2Nlc3MtbmFtZWQtcmVmZXJlbmNlcy50c1xudmFyIHBhaXJEaXZpZGVyID0gXCJ+XCI7XG52YXIgYmxvY2tEaXZpZGVyID0gXCJ+flwiO1xuZnVuY3Rpb24gZ2VuZXJhdGVOYW1lZFJlZmVyZW5jZXMoaW5wdXQsIHByZXYpIHtcbiAgICB2YXIgZW50aXRpZXMgPSB7fTtcbiAgICB2YXIgY2hhcmFjdGVycyA9IHt9O1xuICAgIHZhciBibG9ja3MgPSBpbnB1dC5zcGxpdChibG9ja0RpdmlkZXIpO1xuICAgIHZhciBpc09wdGlvbmFsQmxvY2sgPSBmYWxzZTtcbiAgICBmb3IgKHZhciBpID0gMDsgYmxvY2tzLmxlbmd0aCA+IGk7IGkrKykge1xuICAgICAgICB2YXIgZW50cmllcyA9IGJsb2Nrc1tpXS5zcGxpdChwYWlyRGl2aWRlcik7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZW50cmllcy5sZW5ndGg7IGogKz0gMikge1xuICAgICAgICAgICAgdmFyIGVudGl0eSA9IGVudHJpZXNbal07XG4gICAgICAgICAgICB2YXIgY2hhcmFjdGVyID0gZW50cmllc1tqICsgMV07XG4gICAgICAgICAgICB2YXIgZnVsbEVudGl0eSA9ICcmJyArIGVudGl0eSArICc7JztcbiAgICAgICAgICAgIGVudGl0aWVzW2Z1bGxFbnRpdHldID0gY2hhcmFjdGVyO1xuICAgICAgICAgICAgaWYgKGlzT3B0aW9uYWxCbG9jaykge1xuICAgICAgICAgICAgICAgIGVudGl0aWVzWycmJyArIGVudGl0eV0gPSBjaGFyYWN0ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGFyYWN0ZXJzW2NoYXJhY3Rlcl0gPSBmdWxsRW50aXR5O1xuICAgICAgICB9XG4gICAgICAgIGlzT3B0aW9uYWxCbG9jayA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBwcmV2ID9cbiAgICAgICAgeyBlbnRpdGllczogX19hc3NpZ24oX19hc3NpZ24oe30sIGVudGl0aWVzKSwgcHJldi5lbnRpdGllcyksIGNoYXJhY3RlcnM6IF9fYXNzaWduKF9fYXNzaWduKHt9LCBjaGFyYWN0ZXJzKSwgcHJldi5jaGFyYWN0ZXJzKSB9IDpcbiAgICAgICAgeyBlbnRpdGllczogZW50aXRpZXMsIGNoYXJhY3RlcnM6IGNoYXJhY3RlcnMgfTtcbn1cbmV4cG9ydCB2YXIgYm9keVJlZ0V4cHMgPSB7XG4gICAgeG1sOiAvJig/OiNcXGQrfCNbeFhdW1xcZGEtZkEtRl0rfFswLTlhLXpBLVpdKyk7Py9nLFxuICAgIGh0bWw0OiAvJm5vdGluO3wmKD86bmJzcHxpZXhjbHxjZW50fHBvdW5kfGN1cnJlbnx5ZW58YnJ2YmFyfHNlY3R8dW1sfGNvcHl8b3JkZnxsYXF1b3xub3R8c2h5fHJlZ3xtYWNyfGRlZ3xwbHVzbW58c3VwMnxzdXAzfGFjdXRlfG1pY3JvfHBhcmF8bWlkZG90fGNlZGlsfHN1cDF8b3JkbXxyYXF1b3xmcmFjMTR8ZnJhYzEyfGZyYWMzNHxpcXVlc3R8QWdyYXZlfEFhY3V0ZXxBY2lyY3xBdGlsZGV8QXVtbHxBcmluZ3xBRWxpZ3xDY2VkaWx8RWdyYXZlfEVhY3V0ZXxFY2lyY3xFdW1sfElncmF2ZXxJYWN1dGV8SWNpcmN8SXVtbHxFVEh8TnRpbGRlfE9ncmF2ZXxPYWN1dGV8T2NpcmN8T3RpbGRlfE91bWx8dGltZXN8T3NsYXNofFVncmF2ZXxVYWN1dGV8VWNpcmN8VXVtbHxZYWN1dGV8VEhPUk58c3psaWd8YWdyYXZlfGFhY3V0ZXxhY2lyY3xhdGlsZGV8YXVtbHxhcmluZ3xhZWxpZ3xjY2VkaWx8ZWdyYXZlfGVhY3V0ZXxlY2lyY3xldW1sfGlncmF2ZXxpYWN1dGV8aWNpcmN8aXVtbHxldGh8bnRpbGRlfG9ncmF2ZXxvYWN1dGV8b2NpcmN8b3RpbGRlfG91bWx8ZGl2aWRlfG9zbGFzaHx1Z3JhdmV8dWFjdXRlfHVjaXJjfHV1bWx8eWFjdXRlfHRob3JufHl1bWx8cXVvdHxhbXB8bHR8Z3R8I1xcZCt8I1t4WF1bXFxkYS1mQS1GXSt8WzAtOWEtekEtWl0rKTs/L2csXG4gICAgaHRtbDU6IC8mY2VudGVyZG90O3wmY29weXNyO3wmZGl2aWRlb250aW1lczt8Jmd0Y2M7fCZndGNpcjt8Jmd0ZG90O3wmZ3RsUGFyO3wmZ3RxdWVzdDt8Jmd0cmFwcHJveDt8Jmd0cmFycjt8Jmd0cmRvdDt8Jmd0cmVxbGVzczt8Jmd0cmVxcWxlc3M7fCZndHJsZXNzO3wmZ3Ryc2ltO3wmbHRjYzt8Jmx0Y2lyO3wmbHRkb3Q7fCZsdGhyZWU7fCZsdGltZXM7fCZsdGxhcnI7fCZsdHF1ZXN0O3wmbHRyUGFyO3wmbHRyaTt8Jmx0cmllO3wmbHRyaWY7fCZub3Rpbjt8Jm5vdGluRTt8Jm5vdGluZG90O3wmbm90aW52YTt8Jm5vdGludmI7fCZub3RpbnZjO3wmbm90bmk7fCZub3RuaXZhO3wmbm90bml2Yjt8Jm5vdG5pdmM7fCZwYXJhbGxlbDt8JnRpbWVzYjt8JnRpbWVzYmFyO3wmdGltZXNkO3wmKD86QUVsaWd8QU1QfEFhY3V0ZXxBY2lyY3xBZ3JhdmV8QXJpbmd8QXRpbGRlfEF1bWx8Q09QWXxDY2VkaWx8RVRIfEVhY3V0ZXxFY2lyY3xFZ3JhdmV8RXVtbHxHVHxJYWN1dGV8SWNpcmN8SWdyYXZlfEl1bWx8TFR8TnRpbGRlfE9hY3V0ZXxPY2lyY3xPZ3JhdmV8T3NsYXNofE90aWxkZXxPdW1sfFFVT1R8UkVHfFRIT1JOfFVhY3V0ZXxVY2lyY3xVZ3JhdmV8VXVtbHxZYWN1dGV8YWFjdXRlfGFjaXJjfGFjdXRlfGFlbGlnfGFncmF2ZXxhbXB8YXJpbmd8YXRpbGRlfGF1bWx8YnJ2YmFyfGNjZWRpbHxjZWRpbHxjZW50fGNvcHl8Y3VycmVufGRlZ3xkaXZpZGV8ZWFjdXRlfGVjaXJjfGVncmF2ZXxldGh8ZXVtbHxmcmFjMTJ8ZnJhYzE0fGZyYWMzNHxndHxpYWN1dGV8aWNpcmN8aWV4Y2x8aWdyYXZlfGlxdWVzdHxpdW1sfGxhcXVvfGx0fG1hY3J8bWljcm98bWlkZG90fG5ic3B8bm90fG50aWxkZXxvYWN1dGV8b2NpcmN8b2dyYXZlfG9yZGZ8b3JkbXxvc2xhc2h8b3RpbGRlfG91bWx8cGFyYXxwbHVzbW58cG91bmR8cXVvdHxyYXF1b3xyZWd8c2VjdHxzaHl8c3VwMXxzdXAyfHN1cDN8c3psaWd8dGhvcm58dGltZXN8dWFjdXRlfHVjaXJjfHVncmF2ZXx1bWx8dXVtbHx5YWN1dGV8eWVufHl1bWx8I1xcZCt8I1t4WF1bXFxkYS1mQS1GXSt8WzAtOWEtekEtWl0rKTs/L2dcbn07XG5leHBvcnQgdmFyIG5hbWVkUmVmZXJlbmNlcyA9IHt9O1xubmFtZWRSZWZlcmVuY2VzWyd4bWwnXSA9IGdlbmVyYXRlTmFtZWRSZWZlcmVuY2VzKFwibHR+PH5ndH4+fnF1b3R+XFxcIn5hcG9zfid+YW1wfiZcIik7XG5uYW1lZFJlZmVyZW5jZXNbJ2h0bWw0J10gPSBnZW5lcmF0ZU5hbWVkUmVmZXJlbmNlcyhcImFwb3N+J35PRWxpZ37Fkn5vZWxpZ37Fk35TY2Fyb25+xaB+c2Nhcm9ufsWhfll1bWx+xbh+Y2lyY37Lhn50aWxkZX7LnH5lbnNwfuKAgn5lbXNwfuKAg350aGluc3B+4oCJfnp3bmp+4oCMfnp3an7igI1+bHJtfuKAjn5ybG1+4oCPfm5kYXNofuKAk35tZGFzaH7igJR+bHNxdW9+4oCYfnJzcXVvfuKAmX5zYnF1b37igJp+bGRxdW9+4oCcfnJkcXVvfuKAnX5iZHF1b37igJ5+ZGFnZ2VyfuKAoH5EYWdnZXJ+4oChfnBlcm1pbH7igLB+bHNhcXVvfuKAuX5yc2FxdW9+4oC6fmV1cm9+4oKsfmZub2Z+xpJ+QWxwaGF+zpF+QmV0YX7Okn5HYW1tYX7Ok35EZWx0YX7OlH5FcHNpbG9ufs6VflpldGF+zpZ+RXRhfs6XflRoZXRhfs6YfklvdGF+zpl+S2FwcGF+zpp+TGFtYmRhfs6bfk11fs6cfk51fs6dflhpfs6efk9taWNyb25+zp9+UGl+zqB+Umhvfs6hflNpZ21hfs6jflRhdX7OpH5VcHNpbG9ufs6lflBoaX7Opn5DaGl+zqd+UHNpfs6ofk9tZWdhfs6pfmFscGhhfs6xfmJldGF+zrJ+Z2FtbWF+zrN+ZGVsdGF+zrR+ZXBzaWxvbn7OtX56ZXRhfs62fmV0YX7Ot350aGV0YX7OuH5pb3Rhfs65fmthcHBhfs66fmxhbWJkYX7Ou35tdX7OvH5udX7OvX54aX7Ovn5vbWljcm9ufs6/fnBpfs+AfnJob37PgX5zaWdtYWZ+z4J+c2lnbWF+z4N+dGF1fs+EfnVwc2lsb25+z4V+cGhpfs+GfmNoaX7Ph35wc2l+z4h+b21lZ2F+z4l+dGhldGFzeW1+z5F+dXBzaWh+z5J+cGl2fs+WfmJ1bGx+4oCifmhlbGxpcH7igKZ+cHJpbWV+4oCyflByaW1lfuKAs35vbGluZX7igL5+ZnJhc2x+4oGEfndlaWVycH7ihJh+aW1hZ2V+4oSRfnJlYWx+4oScfnRyYWRlfuKEon5hbGVmc3ltfuKEtX5sYXJyfuKGkH51YXJyfuKGkX5yYXJyfuKGkn5kYXJyfuKGk35oYXJyfuKGlH5jcmFycn7ihrV+bEFycn7ih5B+dUFycn7ih5F+ckFycn7ih5J+ZEFycn7ih5N+aEFycn7ih5R+Zm9yYWxsfuKIgH5wYXJ0fuKIgn5leGlzdH7iiIN+ZW1wdHl+4oiFfm5hYmxhfuKIh35pc2lufuKIiH5ub3Rpbn7iiIl+bml+4oiLfnByb2R+4oiPfnN1bX7iiJF+bWludXN+4oiSfmxvd2FzdH7iiJd+cmFkaWN+4oiafnByb3B+4oidfmluZmlufuKInn5hbmd+4oigfmFuZH7iiKd+b3J+4oiofmNhcH7iiKl+Y3VwfuKIqn5pbnR+4oirfnRoZXJlNH7iiLR+c2ltfuKIvH5jb25nfuKJhX5hc3ltcH7iiYh+bmV+4omgfmVxdWl2fuKJoX5sZX7iiaR+Z2V+4omlfnN1Yn7iioJ+c3VwfuKKg35uc3VifuKKhH5zdWJlfuKKhn5zdXBlfuKKh35vcGx1c37iipV+b3RpbWVzfuKKl35wZXJwfuKKpX5zZG90fuKLhX5sY2VpbH7ijIh+cmNlaWx+4oyJfmxmbG9vcn7ijIp+cmZsb29yfuKMi35sYW5nfuKMqX5yYW5nfuKMqn5sb3p+4peKfnNwYWRlc37imaB+Y2x1YnN+4pmjfmhlYXJ0c37imaV+ZGlhbXN+4pmmfn5uYnNwfsKgfmlleGNsfsKhfmNlbnR+wqJ+cG91bmR+wqN+Y3VycmVufsKkfnllbn7CpX5icnZiYXJ+wqZ+c2VjdH7Cp351bWx+wqh+Y29weX7CqX5vcmRmfsKqfmxhcXVvfsKrfm5vdH7CrH5zaHl+wq1+cmVnfsKufm1hY3J+wq9+ZGVnfsKwfnBsdXNtbn7CsX5zdXAyfsKyfnN1cDN+wrN+YWN1dGV+wrR+bWljcm9+wrV+cGFyYX7Ctn5taWRkb3R+wrd+Y2VkaWx+wrh+c3VwMX7CuX5vcmRtfsK6fnJhcXVvfsK7fmZyYWMxNH7CvH5mcmFjMTJ+wr1+ZnJhYzM0fsK+fmlxdWVzdH7Cv35BZ3JhdmV+w4B+QWFjdXRlfsOBfkFjaXJjfsOCfkF0aWxkZX7Dg35BdW1sfsOEfkFyaW5nfsOFfkFFbGlnfsOGfkNjZWRpbH7Dh35FZ3JhdmV+w4h+RWFjdXRlfsOJfkVjaXJjfsOKfkV1bWx+w4t+SWdyYXZlfsOMfklhY3V0ZX7DjX5JY2lyY37Djn5JdW1sfsOPfkVUSH7DkH5OdGlsZGV+w5F+T2dyYXZlfsOSfk9hY3V0ZX7Dk35PY2lyY37DlH5PdGlsZGV+w5V+T3VtbH7Dln50aW1lc37Dl35Pc2xhc2h+w5h+VWdyYXZlfsOZflVhY3V0ZX7Dmn5VY2lyY37Dm35VdW1sfsOcfllhY3V0ZX7DnX5USE9STn7Dnn5zemxpZ37Dn35hZ3JhdmV+w6B+YWFjdXRlfsOhfmFjaXJjfsOifmF0aWxkZX7Do35hdW1sfsOkfmFyaW5nfsOlfmFlbGlnfsOmfmNjZWRpbH7Dp35lZ3JhdmV+w6h+ZWFjdXRlfsOpfmVjaXJjfsOqfmV1bWx+w6t+aWdyYXZlfsOsfmlhY3V0ZX7DrX5pY2lyY37Drn5pdW1sfsOvfmV0aH7DsH5udGlsZGV+w7F+b2dyYXZlfsOyfm9hY3V0ZX7Ds35vY2lyY37DtH5vdGlsZGV+w7V+b3VtbH7Dtn5kaXZpZGV+w7d+b3NsYXNofsO4fnVncmF2ZX7DuX51YWN1dGV+w7p+dWNpcmN+w7t+dXVtbH7DvH55YWN1dGV+w71+dGhvcm5+w75+eXVtbH7Dv35xdW90flxcXCJ+YW1wfiZ+bHR+PH5ndH4+XCIpO1xubmFtZWRSZWZlcmVuY2VzWydodG1sNSddID0gZ2VuZXJhdGVOYW1lZFJlZmVyZW5jZXMoXCJBYnJldmV+xIJ+QWN5ftCQfkFmcn7wnZSEfkFtYWNyfsSAfkFuZH7iqZN+QW9nb25+xIR+QW9wZn7wnZS4fkFwcGx5RnVuY3Rpb25+4oGhfkFzY3J+8J2SnH5Bc3NpZ25+4omUfkJhY2tzbGFzaH7iiJZ+QmFydn7iq6d+QmFyd2VkfuKMhn5CY3l+0JF+QmVjYXVzZX7iiLV+QmVybm91bGxpc37ihKx+QmZyfvCdlIV+Qm9wZn7wnZS5fkJyZXZlfsuYfkJzY3J+4oSsfkJ1bXBlcX7iiY5+Q0hjeX7Qp35DYWN1dGV+xIZ+Q2FwfuKLkn5DYXBpdGFsRGlmZmVyZW50aWFsRH7ihYV+Q2F5bGV5c37ihK1+Q2Nhcm9ufsSMfkNjaXJjfsSIfkNjb25pbnR+4oiwfkNkb3R+xIp+Q2VkaWxsYX7CuH5DZW50ZXJEb3R+wrd+Q2ZyfuKErX5DaXJjbGVEb3R+4oqZfkNpcmNsZU1pbnVzfuKKln5DaXJjbGVQbHVzfuKKlX5DaXJjbGVUaW1lc37iipd+Q2xvY2t3aXNlQ29udG91ckludGVncmFsfuKIsn5DbG9zZUN1cmx5RG91YmxlUXVvdGV+4oCdfkNsb3NlQ3VybHlRdW90ZX7igJl+Q29sb25+4oi3fkNvbG9uZX7iqbR+Q29uZ3J1ZW50fuKJoX5Db25pbnR+4oivfkNvbnRvdXJJbnRlZ3JhbH7iiK5+Q29wZn7ihIJ+Q29wcm9kdWN0fuKIkH5Db3VudGVyQ2xvY2t3aXNlQ29udG91ckludGVncmFsfuKIs35Dcm9zc37iqK9+Q3Njcn7wnZKefkN1cH7ii5N+Q3VwQ2FwfuKJjX5ERH7ihYV+RERvdHJhaGR+4qSRfkRKY3l+0IJ+RFNjeX7QhX5EWmN5ftCPfkRhcnJ+4oahfkRhc2h2fuKrpH5EY2Fyb25+xI5+RGN5ftCUfkRlbH7iiId+RGZyfvCdlId+RGlhY3JpdGljYWxBY3V0ZX7CtH5EaWFjcml0aWNhbERvdH7LmX5EaWFjcml0aWNhbERvdWJsZUFjdXRlfsudfkRpYWNyaXRpY2FsR3JhdmV+YH5EaWFjcml0aWNhbFRpbGRlfsucfkRpYW1vbmR+4ouEfkRpZmZlcmVudGlhbER+4oWGfkRvcGZ+8J2Uu35Eb3R+wqh+RG90RG90fuKDnH5Eb3RFcXVhbH7iiZB+RG91YmxlQ29udG91ckludGVncmFsfuKIr35Eb3VibGVEb3R+wqh+RG91YmxlRG93bkFycm93fuKHk35Eb3VibGVMZWZ0QXJyb3d+4oeQfkRvdWJsZUxlZnRSaWdodEFycm93fuKHlH5Eb3VibGVMZWZ0VGVlfuKrpH5Eb3VibGVMb25nTGVmdEFycm93fuKfuH5Eb3VibGVMb25nTGVmdFJpZ2h0QXJyb3d+4p+6fkRvdWJsZUxvbmdSaWdodEFycm93fuKfuX5Eb3VibGVSaWdodEFycm93fuKHkn5Eb3VibGVSaWdodFRlZX7iiqh+RG91YmxlVXBBcnJvd37ih5F+RG91YmxlVXBEb3duQXJyb3d+4oeVfkRvdWJsZVZlcnRpY2FsQmFyfuKIpX5Eb3duQXJyb3d+4oaTfkRvd25BcnJvd0Jhcn7ipJN+RG93bkFycm93VXBBcnJvd37ih7V+RG93bkJyZXZlfsyRfkRvd25MZWZ0UmlnaHRWZWN0b3J+4qWQfkRvd25MZWZ0VGVlVmVjdG9yfuKlnn5Eb3duTGVmdFZlY3Rvcn7ihr1+RG93bkxlZnRWZWN0b3JCYXJ+4qWWfkRvd25SaWdodFRlZVZlY3Rvcn7ipZ9+RG93blJpZ2h0VmVjdG9yfuKHgX5Eb3duUmlnaHRWZWN0b3JCYXJ+4qWXfkRvd25UZWV+4oqkfkRvd25UZWVBcnJvd37ihqd+RG93bmFycm93fuKHk35Ec2NyfvCdkp9+RHN0cm9rfsSQfkVOR37Fin5FY2Fyb25+xJp+RWN5ftCtfkVkb3R+xJZ+RWZyfvCdlIh+RWxlbWVudH7iiIh+RW1hY3J+xJJ+RW1wdHlTbWFsbFNxdWFyZX7il7t+RW1wdHlWZXJ5U21hbGxTcXVhcmV+4parfkVvZ29ufsSYfkVvcGZ+8J2UvH5FcXVhbH7iqbV+RXF1YWxUaWxkZX7iiYJ+RXF1aWxpYnJpdW1+4oeMfkVzY3J+4oSwfkVzaW1+4qmzfkV4aXN0c37iiIN+RXhwb25lbnRpYWxFfuKFh35GY3l+0KR+RmZyfvCdlIl+RmlsbGVkU21hbGxTcXVhcmV+4pe8fkZpbGxlZFZlcnlTbWFsbFNxdWFyZX7ilqp+Rm9wZn7wnZS9fkZvckFsbH7iiIB+Rm91cmllcnRyZn7ihLF+RnNjcn7ihLF+R0pjeX7Qg35HYW1tYWR+z5x+R2JyZXZlfsSefkdjZWRpbH7Eon5HY2lyY37EnH5HY3l+0JN+R2RvdH7EoH5HZnJ+8J2Uin5HZ37ii5l+R29wZn7wnZS+fkdyZWF0ZXJFcXVhbH7iiaV+R3JlYXRlckVxdWFsTGVzc37ii5t+R3JlYXRlckZ1bGxFcXVhbH7iiad+R3JlYXRlckdyZWF0ZXJ+4qqifkdyZWF0ZXJMZXNzfuKJt35HcmVhdGVyU2xhbnRFcXVhbH7iqb5+R3JlYXRlclRpbGRlfuKJs35Hc2NyfvCdkqJ+R3R+4omrfkhBUkRjeX7Qqn5IYWNla37Lh35IYXR+Xn5IY2lyY37EpH5IZnJ+4oSMfkhpbGJlcnRTcGFjZX7ihIt+SG9wZn7ihI1+SG9yaXpvbnRhbExpbmV+4pSAfkhzY3J+4oSLfkhzdHJva37Epn5IdW1wRG93bkh1bXB+4omOfkh1bXBFcXVhbH7iiY9+SUVjeX7QlX5JSmxpZ37Esn5JT2N5ftCBfkljeX7QmH5JZG90fsSwfklmcn7ihJF+SW1+4oSRfkltYWNyfsSqfkltYWdpbmFyeUl+4oWIfkltcGxpZXN+4oeSfkludH7iiKx+SW50ZWdyYWx+4oirfkludGVyc2VjdGlvbn7ii4J+SW52aXNpYmxlQ29tbWF+4oGjfkludmlzaWJsZVRpbWVzfuKBon5Jb2dvbn7Ern5Jb3BmfvCdlYB+SXNjcn7ihJB+SXRpbGRlfsSofkl1a2N5ftCGfkpjaXJjfsS0fkpjeX7QmX5KZnJ+8J2UjX5Kb3BmfvCdlYF+SnNjcn7wnZKlfkpzZXJjeX7QiH5KdWtjeX7QhH5LSGN5ftClfktKY3l+0Ix+S2NlZGlsfsS2fktjeX7Qmn5LZnJ+8J2Ujn5Lb3BmfvCdlYJ+S3Njcn7wnZKmfkxKY3l+0Il+TGFjdXRlfsS5fkxhbmd+4p+qfkxhcGxhY2V0cmZ+4oSSfkxhcnJ+4oaefkxjYXJvbn7EvX5MY2VkaWx+xLt+TGN5ftCbfkxlZnRBbmdsZUJyYWNrZXR+4p+ofkxlZnRBcnJvd37ihpB+TGVmdEFycm93QmFyfuKHpH5MZWZ0QXJyb3dSaWdodEFycm93fuKHhn5MZWZ0Q2VpbGluZ37ijIh+TGVmdERvdWJsZUJyYWNrZXR+4p+mfkxlZnREb3duVGVlVmVjdG9yfuKloX5MZWZ0RG93blZlY3Rvcn7ih4N+TGVmdERvd25WZWN0b3JCYXJ+4qWZfkxlZnRGbG9vcn7ijIp+TGVmdFJpZ2h0QXJyb3d+4oaUfkxlZnRSaWdodFZlY3Rvcn7ipY5+TGVmdFRlZX7iiqN+TGVmdFRlZUFycm93fuKGpH5MZWZ0VGVlVmVjdG9yfuKlmn5MZWZ0VHJpYW5nbGV+4oqyfkxlZnRUcmlhbmdsZUJhcn7ip49+TGVmdFRyaWFuZ2xlRXF1YWx+4oq0fkxlZnRVcERvd25WZWN0b3J+4qWRfkxlZnRVcFRlZVZlY3Rvcn7ipaB+TGVmdFVwVmVjdG9yfuKGv35MZWZ0VXBWZWN0b3JCYXJ+4qWYfkxlZnRWZWN0b3J+4oa8fkxlZnRWZWN0b3JCYXJ+4qWSfkxlZnRhcnJvd37ih5B+TGVmdHJpZ2h0YXJyb3d+4oeUfkxlc3NFcXVhbEdyZWF0ZXJ+4ouafkxlc3NGdWxsRXF1YWx+4ommfkxlc3NHcmVhdGVyfuKJtn5MZXNzTGVzc37iqqF+TGVzc1NsYW50RXF1YWx+4qm9fkxlc3NUaWxkZX7iibJ+TGZyfvCdlI9+TGx+4ouYfkxsZWZ0YXJyb3d+4oeafkxtaWRvdH7Ev35Mb25nTGVmdEFycm93fuKftX5Mb25nTGVmdFJpZ2h0QXJyb3d+4p+3fkxvbmdSaWdodEFycm93fuKftn5Mb25nbGVmdGFycm93fuKfuH5Mb25nbGVmdHJpZ2h0YXJyb3d+4p+6fkxvbmdyaWdodGFycm93fuKfuX5Mb3BmfvCdlYN+TG93ZXJMZWZ0QXJyb3d+4oaZfkxvd2VyUmlnaHRBcnJvd37ihph+THNjcn7ihJJ+THNofuKGsH5Mc3Ryb2t+xYF+THR+4omqfk1hcH7ipIV+TWN5ftCcfk1lZGl1bVNwYWNlfuKBn35NZWxsaW50cmZ+4oSzfk1mcn7wnZSQfk1pbnVzUGx1c37iiJN+TW9wZn7wnZWEfk1zY3J+4oSzfk5KY3l+0Ip+TmFjdXRlfsWDfk5jYXJvbn7Fh35OY2VkaWx+xYV+TmN5ftCdfk5lZ2F0aXZlTWVkaXVtU3BhY2V+4oCLfk5lZ2F0aXZlVGhpY2tTcGFjZX7igIt+TmVnYXRpdmVUaGluU3BhY2V+4oCLfk5lZ2F0aXZlVmVyeVRoaW5TcGFjZX7igIt+TmVzdGVkR3JlYXRlckdyZWF0ZXJ+4omrfk5lc3RlZExlc3NMZXNzfuKJqn5OZXdMaW5lflxcbn5OZnJ+8J2UkX5Ob0JyZWFrfuKBoH5Ob25CcmVha2luZ1NwYWNlfsKgfk5vcGZ+4oSVfk5vdH7iq6x+Tm90Q29uZ3J1ZW50fuKJon5Ob3RDdXBDYXB+4omtfk5vdERvdWJsZVZlcnRpY2FsQmFyfuKIpn5Ob3RFbGVtZW50fuKIiX5Ob3RFcXVhbH7iiaB+Tm90RXF1YWxUaWxkZX7iiYLMuH5Ob3RFeGlzdHN+4oiEfk5vdEdyZWF0ZXJ+4omvfk5vdEdyZWF0ZXJFcXVhbH7iibF+Tm90R3JlYXRlckZ1bGxFcXVhbH7iiafMuH5Ob3RHcmVhdGVyR3JlYXRlcn7iiavMuH5Ob3RHcmVhdGVyTGVzc37iibl+Tm90R3JlYXRlclNsYW50RXF1YWx+4qm+zLh+Tm90R3JlYXRlclRpbGRlfuKJtX5Ob3RIdW1wRG93bkh1bXB+4omOzLh+Tm90SHVtcEVxdWFsfuKJj8y4fk5vdExlZnRUcmlhbmdsZX7ii6p+Tm90TGVmdFRyaWFuZ2xlQmFyfuKnj8y4fk5vdExlZnRUcmlhbmdsZUVxdWFsfuKLrH5Ob3RMZXNzfuKJrn5Ob3RMZXNzRXF1YWx+4omwfk5vdExlc3NHcmVhdGVyfuKJuH5Ob3RMZXNzTGVzc37iiarMuH5Ob3RMZXNzU2xhbnRFcXVhbH7iqb3MuH5Ob3RMZXNzVGlsZGV+4om0fk5vdE5lc3RlZEdyZWF0ZXJHcmVhdGVyfuKqosy4fk5vdE5lc3RlZExlc3NMZXNzfuKqocy4fk5vdFByZWNlZGVzfuKKgH5Ob3RQcmVjZWRlc0VxdWFsfuKqr8y4fk5vdFByZWNlZGVzU2xhbnRFcXVhbH7ii6B+Tm90UmV2ZXJzZUVsZW1lbnR+4oiMfk5vdFJpZ2h0VHJpYW5nbGV+4ourfk5vdFJpZ2h0VHJpYW5nbGVCYXJ+4qeQzLh+Tm90UmlnaHRUcmlhbmdsZUVxdWFsfuKLrX5Ob3RTcXVhcmVTdWJzZXR+4oqPzLh+Tm90U3F1YXJlU3Vic2V0RXF1YWx+4ouifk5vdFNxdWFyZVN1cGVyc2V0fuKKkMy4fk5vdFNxdWFyZVN1cGVyc2V0RXF1YWx+4oujfk5vdFN1YnNldH7iioLig5J+Tm90U3Vic2V0RXF1YWx+4oqIfk5vdFN1Y2NlZWRzfuKKgX5Ob3RTdWNjZWVkc0VxdWFsfuKqsMy4fk5vdFN1Y2NlZWRzU2xhbnRFcXVhbH7ii6F+Tm90U3VjY2VlZHNUaWxkZX7iib/MuH5Ob3RTdXBlcnNldH7iioPig5J+Tm90U3VwZXJzZXRFcXVhbH7iiol+Tm90VGlsZGV+4omBfk5vdFRpbGRlRXF1YWx+4omEfk5vdFRpbGRlRnVsbEVxdWFsfuKJh35Ob3RUaWxkZVRpbGRlfuKJiX5Ob3RWZXJ0aWNhbEJhcn7iiKR+TnNjcn7wnZKpfk9jeX7Qnn5PZGJsYWN+xZB+T2ZyfvCdlJJ+T21hY3J+xYx+T29wZn7wnZWGfk9wZW5DdXJseURvdWJsZVF1b3RlfuKAnH5PcGVuQ3VybHlRdW90ZX7igJh+T3J+4qmUfk9zY3J+8J2Sqn5PdGltZXN+4qi3fk92ZXJCYXJ+4oC+fk92ZXJCcmFjZX7ij55+T3ZlckJyYWNrZXR+4o60fk92ZXJQYXJlbnRoZXNpc37ij5x+UGFydGlhbER+4oiCflBjeX7Qn35QZnJ+8J2Uk35QbHVzTWludXN+wrF+UG9pbmNhcmVwbGFuZX7ihIx+UG9wZn7ihJl+UHJ+4qq7flByZWNlZGVzfuKJun5QcmVjZWRlc0VxdWFsfuKqr35QcmVjZWRlc1NsYW50RXF1YWx+4om8flByZWNlZGVzVGlsZGV+4om+flByb2R1Y3R+4oiPflByb3BvcnRpb25+4oi3flByb3BvcnRpb25hbH7iiJ1+UHNjcn7wnZKrflFmcn7wnZSUflFvcGZ+4oSaflFzY3J+8J2SrH5SQmFycn7ipJB+UmFjdXRlfsWUflJhbmd+4p+rflJhcnJ+4oagflJhcnJ0bH7ipJZ+UmNhcm9ufsWYflJjZWRpbH7Fln5SY3l+0KB+UmV+4oScflJldmVyc2VFbGVtZW50fuKIi35SZXZlcnNlRXF1aWxpYnJpdW1+4oeLflJldmVyc2VVcEVxdWlsaWJyaXVtfuKlr35SZnJ+4oScflJpZ2h0QW5nbGVCcmFja2V0fuKfqX5SaWdodEFycm93fuKGkn5SaWdodEFycm93QmFyfuKHpX5SaWdodEFycm93TGVmdEFycm93fuKHhH5SaWdodENlaWxpbmd+4oyJflJpZ2h0RG91YmxlQnJhY2tldH7in6d+UmlnaHREb3duVGVlVmVjdG9yfuKlnX5SaWdodERvd25WZWN0b3J+4oeCflJpZ2h0RG93blZlY3RvckJhcn7ipZV+UmlnaHRGbG9vcn7ijIt+UmlnaHRUZWV+4oqiflJpZ2h0VGVlQXJyb3d+4oamflJpZ2h0VGVlVmVjdG9yfuKlm35SaWdodFRyaWFuZ2xlfuKKs35SaWdodFRyaWFuZ2xlQmFyfuKnkH5SaWdodFRyaWFuZ2xlRXF1YWx+4oq1flJpZ2h0VXBEb3duVmVjdG9yfuKlj35SaWdodFVwVGVlVmVjdG9yfuKlnH5SaWdodFVwVmVjdG9yfuKGvn5SaWdodFVwVmVjdG9yQmFyfuKllH5SaWdodFZlY3Rvcn7ih4B+UmlnaHRWZWN0b3JCYXJ+4qWTflJpZ2h0YXJyb3d+4oeSflJvcGZ+4oSdflJvdW5kSW1wbGllc37ipbB+UnJpZ2h0YXJyb3d+4oebflJzY3J+4oSbflJzaH7ihrF+UnVsZURlbGF5ZWR+4qe0flNIQ0hjeX7QqX5TSGN5ftCoflNPRlRjeX7QrH5TYWN1dGV+xZp+U2N+4qq8flNjZWRpbH7Fnn5TY2lyY37FnH5TY3l+0KF+U2ZyfvCdlJZ+U2hvcnREb3duQXJyb3d+4oaTflNob3J0TGVmdEFycm93fuKGkH5TaG9ydFJpZ2h0QXJyb3d+4oaSflNob3J0VXBBcnJvd37ihpF+U21hbGxDaXJjbGV+4oiYflNvcGZ+8J2Vin5TcXJ0fuKImn5TcXVhcmV+4pahflNxdWFyZUludGVyc2VjdGlvbn7iipN+U3F1YXJlU3Vic2V0fuKKj35TcXVhcmVTdWJzZXRFcXVhbH7iipF+U3F1YXJlU3VwZXJzZXR+4oqQflNxdWFyZVN1cGVyc2V0RXF1YWx+4oqSflNxdWFyZVVuaW9ufuKKlH5Tc2NyfvCdkq5+U3Rhcn7ii4Z+U3VifuKLkH5TdWJzZXR+4ouQflN1YnNldEVxdWFsfuKKhn5TdWNjZWVkc37iibt+U3VjY2VlZHNFcXVhbH7iqrB+U3VjY2VlZHNTbGFudEVxdWFsfuKJvX5TdWNjZWVkc1RpbGRlfuKJv35TdWNoVGhhdH7iiIt+U3VtfuKIkX5TdXB+4ouRflN1cGVyc2V0fuKKg35TdXBlcnNldEVxdWFsfuKKh35TdXBzZXR+4ouRflRSQURFfuKEon5UU0hjeX7Qi35UU2N5ftCmflRhYn5cXHR+VGNhcm9ufsWkflRjZWRpbH7Fon5UY3l+0KJ+VGZyfvCdlJd+VGhlcmVmb3JlfuKItH5UaGlja1NwYWNlfuKBn+KAin5UaGluU3BhY2V+4oCJflRpbGRlfuKIvH5UaWxkZUVxdWFsfuKJg35UaWxkZUZ1bGxFcXVhbH7iiYV+VGlsZGVUaWxkZX7iiYh+VG9wZn7wnZWLflRyaXBsZURvdH7ig5t+VHNjcn7wnZKvflRzdHJva37Fpn5VYXJyfuKGn35VYXJyb2Npcn7ipYl+VWJyY3l+0I5+VWJyZXZlfsWsflVjeX7Qo35VZGJsYWN+xbB+VWZyfvCdlJh+VW1hY3J+xap+VW5kZXJCYXJ+X35VbmRlckJyYWNlfuKPn35VbmRlckJyYWNrZXR+4o61flVuZGVyUGFyZW50aGVzaXN+4o+dflVuaW9ufuKLg35VbmlvblBsdXN+4oqOflVvZ29ufsWyflVvcGZ+8J2VjH5VcEFycm93fuKGkX5VcEFycm93QmFyfuKkkn5VcEFycm93RG93bkFycm93fuKHhX5VcERvd25BcnJvd37ihpV+VXBFcXVpbGlicml1bX7ipa5+VXBUZWV+4oqlflVwVGVlQXJyb3d+4oalflVwYXJyb3d+4oeRflVwZG93bmFycm93fuKHlX5VcHBlckxlZnRBcnJvd37ihpZ+VXBwZXJSaWdodEFycm93fuKGl35VcHNpfs+SflVyaW5nfsWuflVzY3J+8J2SsH5VdGlsZGV+xah+VkRhc2h+4oqrflZiYXJ+4qurflZjeX7Qkn5WZGFzaH7iiql+VmRhc2hsfuKrpn5WZWV+4ouBflZlcmJhcn7igJZ+VmVydH7igJZ+VmVydGljYWxCYXJ+4oijflZlcnRpY2FsTGluZX58flZlcnRpY2FsU2VwYXJhdG9yfuKdmH5WZXJ0aWNhbFRpbGRlfuKJgH5WZXJ5VGhpblNwYWNlfuKAin5WZnJ+8J2UmX5Wb3BmfvCdlY1+VnNjcn7wnZKxflZ2ZGFzaH7iiqp+V2NpcmN+xbR+V2VkZ2V+4ouAfldmcn7wnZSafldvcGZ+8J2Vjn5Xc2NyfvCdkrJ+WGZyfvCdlJt+WG9wZn7wnZWPflhzY3J+8J2Ss35ZQWN5ftCvfllJY3l+0Id+WVVjeX7Qrn5ZY2lyY37Ftn5ZY3l+0Kt+WWZyfvCdlJx+WW9wZn7wnZWQfllzY3J+8J2StH5aSGN5ftCWflphY3V0ZX7FuX5aY2Fyb25+xb1+WmN5ftCXflpkb3R+xbt+WmVyb1dpZHRoU3BhY2V+4oCLflpmcn7ihKh+Wm9wZn7ihKR+WnNjcn7wnZK1fmFicmV2ZX7Eg35hY37iiL5+YWNFfuKIvsyzfmFjZH7iiL9+YWN5ftCwfmFmfuKBoX5hZnJ+8J2Unn5hbGVwaH7ihLV+YW1hY3J+xIF+YW1hbGd+4qi/fmFuZGFuZH7iqZV+YW5kZH7iqZx+YW5kc2xvcGV+4qmYfmFuZHZ+4qmafmFuZ2V+4qakfmFuZ2xlfuKIoH5hbmdtc2R+4oihfmFuZ21zZGFhfuKmqH5hbmdtc2RhYn7ipql+YW5nbXNkYWN+4qaqfmFuZ21zZGFkfuKmq35hbmdtc2RhZX7ipqx+YW5nbXNkYWZ+4qatfmFuZ21zZGFnfuKmrn5hbmdtc2RhaH7ipq9+YW5ncnR+4oiffmFuZ3J0dmJ+4oq+fmFuZ3J0dmJkfuKmnX5hbmdzcGh+4oiifmFuZ3N0fsOFfmFuZ3phcnJ+4o28fmFvZ29ufsSFfmFvcGZ+8J2Vkn5hcH7iiYh+YXBFfuKpsH5hcGFjaXJ+4qmvfmFwZX7iiYp+YXBpZH7iiYt+YXBwcm94fuKJiH5hcHByb3hlcX7iiYp+YXNjcn7wnZK2fmFzdH4qfmFzeW1wZXF+4omNfmF3Y29uaW50fuKIs35hd2ludH7iqJF+Yk5vdH7iq61+YmFja2Nvbmd+4omMfmJhY2tlcHNpbG9ufs+2fmJhY2twcmltZX7igLV+YmFja3NpbX7iiL1+YmFja3NpbWVxfuKLjX5iYXJ2ZWV+4oq9fmJhcndlZH7ijIV+YmFyd2VkZ2V+4oyFfmJicmt+4o61fmJicmt0YnJrfuKOtn5iY29uZ37iiYx+YmN5ftCxfmJlY2F1c37iiLV+YmVjYXVzZX7iiLV+YmVtcHR5dn7iprB+YmVwc2l+z7Z+YmVybm91fuKErH5iZXRofuKEtn5iZXR3ZWVufuKJrH5iZnJ+8J2Un35iaWdjYXB+4ouCfmJpZ2NpcmN+4pevfmJpZ2N1cH7ii4N+Ymlnb2RvdH7iqIB+Ymlnb3BsdXN+4qiBfmJpZ290aW1lc37iqIJ+Ymlnc3FjdXB+4qiGfmJpZ3N0YXJ+4piFfmJpZ3RyaWFuZ2xlZG93bn7ilr1+YmlndHJpYW5nbGV1cH7ilrN+YmlndXBsdXN+4qiEfmJpZ3ZlZX7ii4F+Ymlnd2VkZ2V+4ouAfmJrYXJvd37ipI1+YmxhY2tsb3plbmdlfuKnq35ibGFja3NxdWFyZX7ilqp+YmxhY2t0cmlhbmdsZX7ilrR+YmxhY2t0cmlhbmdsZWRvd25+4pa+fmJsYWNrdHJpYW5nbGVsZWZ0fuKXgn5ibGFja3RyaWFuZ2xlcmlnaHR+4pa4fmJsYW5rfuKQo35ibGsxMn7ilpJ+YmxrMTR+4paRfmJsazM0fuKWk35ibG9ja37iloh+Ym5lfj3ig6V+Ym5lcXVpdn7iiaHig6V+Ym5vdH7ijJB+Ym9wZn7wnZWTfmJvdH7iiqV+Ym90dG9tfuKKpX5ib3d0aWV+4ouIfmJveERMfuKVl35ib3hEUn7ilZR+Ym94RGx+4pWWfmJveERyfuKVk35ib3hIfuKVkH5ib3hIRH7ilaZ+Ym94SFV+4pWpfmJveEhkfuKVpH5ib3hIdX7ilad+Ym94VUx+4pWdfmJveFVSfuKVmn5ib3hVbH7ilZx+Ym94VXJ+4pWZfmJveFZ+4pWRfmJveFZIfuKVrH5ib3hWTH7ilaN+Ym94VlJ+4pWgfmJveFZofuKVq35ib3hWbH7ilaJ+Ym94VnJ+4pWffmJveGJveH7ip4l+Ym94ZEx+4pWVfmJveGRSfuKVkn5ib3hkbH7ilJB+Ym94ZHJ+4pSMfmJveGh+4pSAfmJveGhEfuKVpX5ib3hoVX7ilah+Ym94aGR+4pSsfmJveGh1fuKUtH5ib3htaW51c37iip9+Ym94cGx1c37iip5+Ym94dGltZXN+4oqgfmJveHVMfuKVm35ib3h1Un7ilZh+Ym94dWx+4pSYfmJveHVyfuKUlH5ib3h2fuKUgn5ib3h2SH7ilap+Ym94dkx+4pWhfmJveHZSfuKVnn5ib3h2aH7ilLx+Ym94dmx+4pSkfmJveHZyfuKUnH5icHJpbWV+4oC1fmJyZXZlfsuYfmJzY3J+8J2St35ic2VtaX7igY9+YnNpbX7iiL1+YnNpbWV+4ouNfmJzb2x+XFxcXH5ic29sYn7ip4V+YnNvbGhzdWJ+4p+IfmJ1bGxldH7igKJ+YnVtcH7iiY5+YnVtcEV+4qqufmJ1bXBlfuKJj35idW1wZXF+4omPfmNhY3V0ZX7Eh35jYXBhbmR+4qmEfmNhcGJyY3VwfuKpiX5jYXBjYXB+4qmLfmNhcGN1cH7iqYd+Y2FwZG90fuKpgH5jYXBzfuKIqe+4gH5jYXJldH7igYF+Y2Fyb25+y4d+Y2NhcHN+4qmNfmNjYXJvbn7EjX5jY2lyY37EiX5jY3Vwc37iqYx+Y2N1cHNzbX7iqZB+Y2RvdH7Ei35jZW1wdHl2fuKmsn5jZW50ZXJkb3R+wrd+Y2ZyfvCdlKB+Y2hjeX7Rh35jaGVja37inJN+Y2hlY2ttYXJrfuKck35jaXJ+4peLfmNpckV+4qeDfmNpcmNlcX7iiZd+Y2lyY2xlYXJyb3dsZWZ0fuKGun5jaXJjbGVhcnJvd3JpZ2h0fuKGu35jaXJjbGVkUn7Crn5jaXJjbGVkU37ik4h+Y2lyY2xlZGFzdH7iipt+Y2lyY2xlZGNpcmN+4oqafmNpcmNsZWRkYXNofuKKnX5jaXJlfuKJl35jaXJmbmludH7iqJB+Y2lybWlkfuKrr35jaXJzY2lyfuKngn5jbHVic3VpdH7imaN+Y29sb25+On5jb2xvbmV+4omUfmNvbG9uZXF+4omUfmNvbW1hfix+Y29tbWF0fkB+Y29tcH7iiIF+Y29tcGZufuKImH5jb21wbGVtZW50fuKIgX5jb21wbGV4ZXN+4oSCfmNvbmdkb3R+4qmtfmNvbmludH7iiK5+Y29wZn7wnZWUfmNvcHJvZH7iiJB+Y29weXNyfuKEl35jcm9zc37inJd+Y3Njcn7wnZK4fmNzdWJ+4quPfmNzdWJlfuKrkX5jc3VwfuKrkH5jc3VwZX7iq5J+Y3Rkb3R+4ouvfmN1ZGFycmx+4qS4fmN1ZGFycnJ+4qS1fmN1ZXByfuKLnn5jdWVzY37ii59+Y3VsYXJyfuKGtn5jdWxhcnJwfuKkvX5jdXBicmNhcH7iqYh+Y3VwY2FwfuKphn5jdXBjdXB+4qmKfmN1cGRvdH7iio1+Y3Vwb3J+4qmFfmN1cHN+4oiq77iAfmN1cmFycn7ihrd+Y3VyYXJybX7ipLx+Y3VybHllcXByZWN+4ouefmN1cmx5ZXFzdWNjfuKLn35jdXJseXZlZX7ii45+Y3VybHl3ZWRnZX7ii49+Y3VydmVhcnJvd2xlZnR+4oa2fmN1cnZlYXJyb3dyaWdodH7ihrd+Y3V2ZWV+4ouOfmN1d2VkfuKLj35jd2NvbmludH7iiLJ+Y3dpbnR+4oixfmN5bGN0eX7ijK1+ZEhhcn7ipaV+ZGFsZXRofuKEuH5kYXNofuKAkH5kYXNodn7iiqN+ZGJrYXJvd37ipI9+ZGJsYWN+y51+ZGNhcm9ufsSPfmRjeX7QtH5kZH7ihYZ+ZGRhZ2dlcn7igKF+ZGRhcnJ+4oeKfmRkb3RzZXF+4qm3fmRlbXB0eXZ+4qaxfmRmaXNodH7ipb9+ZGZyfvCdlKF+ZGhhcmx+4oeDfmRoYXJyfuKHgn5kaWFtfuKLhH5kaWFtb25kfuKLhH5kaWFtb25kc3VpdH7imaZ+ZGllfsKofmRpZ2FtbWF+z51+ZGlzaW5+4ouyfmRpdn7Dt35kaXZpZGVvbnRpbWVzfuKLh35kaXZvbnh+4ouHfmRqY3l+0ZJ+ZGxjb3JufuKMnn5kbGNyb3B+4oyNfmRvbGxhcn4kfmRvcGZ+8J2VlX5kb3R+y5l+ZG90ZXF+4omQfmRvdGVxZG90fuKJkX5kb3RtaW51c37iiLh+ZG90cGx1c37iiJR+ZG90c3F1YXJlfuKKoX5kb3VibGViYXJ3ZWRnZX7ijIZ+ZG93bmFycm93fuKGk35kb3duZG93bmFycm93c37ih4p+ZG93bmhhcnBvb25sZWZ0fuKHg35kb3duaGFycG9vbnJpZ2h0fuKHgn5kcmJrYXJvd37ipJB+ZHJjb3JufuKMn35kcmNyb3B+4oyMfmRzY3J+8J2SuX5kc2N5ftGVfmRzb2x+4qe2fmRzdHJva37EkX5kdGRvdH7ii7F+ZHRyaX7ilr9+ZHRyaWZ+4pa+fmR1YXJyfuKHtX5kdWhhcn7ipa9+ZHdhbmdsZX7ipqZ+ZHpjeX7Rn35kemlncmFycn7in79+ZUREb3R+4qm3fmVEb3R+4omRfmVhc3Rlcn7iqa5+ZWNhcm9ufsSbfmVjaXJ+4omWfmVjb2xvbn7iiZV+ZWN5ftGNfmVkb3R+xJd+ZWV+4oWHfmVmRG90fuKJkn5lZnJ+8J2Uon5lZ37iqpp+ZWdzfuKqln5lZ3Nkb3R+4qqYfmVsfuKqmX5lbGludGVyc37ij6d+ZWxsfuKEk35lbHN+4qqVfmVsc2RvdH7iqpd+ZW1hY3J+xJN+ZW1wdHlzZXR+4oiFfmVtcHR5dn7iiIV+ZW1zcDEzfuKAhH5lbXNwMTR+4oCFfmVuZ37Fi35lb2dvbn7EmX5lb3BmfvCdlZZ+ZXBhcn7ii5V+ZXBhcnNsfuKno35lcGx1c37iqbF+ZXBzaX7OtX5lcHNpdn7PtX5lcWNpcmN+4omWfmVxY29sb25+4omVfmVxc2ltfuKJgn5lcXNsYW50Z3RyfuKqln5lcXNsYW50bGVzc37iqpV+ZXF1YWxzfj1+ZXF1ZXN0fuKJn35lcXVpdkREfuKpuH5lcXZwYXJzbH7ip6V+ZXJEb3R+4omTfmVyYXJyfuKlsX5lc2NyfuKEr35lc2RvdH7iiZB+ZXNpbX7iiYJ+ZXhjbH4hfmV4cGVjdGF0aW9ufuKEsH5leHBvbmVudGlhbGV+4oWHfmZhbGxpbmdkb3RzZXF+4omSfmZjeX7RhH5mZW1hbGV+4pmAfmZmaWxpZ37vrIN+ZmZsaWd+76yAfmZmbGxpZ37vrIR+ZmZyfvCdlKN+ZmlsaWd+76yBfmZqbGlnfmZqfmZsYXR+4pmtfmZsbGlnfu+sgn5mbHRuc37ilrF+Zm9wZn7wnZWXfmZvcmt+4ouUfmZvcmt2fuKrmX5mcGFydGludH7iqI1+ZnJhYzEzfuKFk35mcmFjMTV+4oWVfmZyYWMxNn7ihZl+ZnJhYzE4fuKFm35mcmFjMjN+4oWUfmZyYWMyNX7ihZZ+ZnJhYzM1fuKFl35mcmFjMzh+4oWcfmZyYWM0NX7ihZh+ZnJhYzU2fuKFmn5mcmFjNTh+4oWdfmZyYWM3OH7ihZ5+ZnJvd25+4oyifmZzY3J+8J2Su35nRX7iiad+Z0VsfuKqjH5nYWN1dGV+x7V+Z2FtbWFkfs+dfmdhcH7iqoZ+Z2JyZXZlfsSffmdjaXJjfsSdfmdjeX7Qs35nZG90fsShfmdlbH7ii5t+Z2VxfuKJpX5nZXFxfuKJp35nZXFzbGFudH7iqb5+Z2VzfuKpvn5nZXNjY37iqql+Z2VzZG90fuKqgH5nZXNkb3RvfuKqgn5nZXNkb3RvbH7iqoR+Z2VzbH7ii5vvuIB+Z2VzbGVzfuKqlH5nZnJ+8J2UpH5nZ37iiat+Z2dnfuKLmX5naW1lbH7ihLd+Z2pjeX7Rk35nbH7iibd+Z2xFfuKqkn5nbGF+4qqlfmdsan7iqqR+Z25FfuKJqX5nbmFwfuKqin5nbmFwcHJveH7iqop+Z25lfuKqiH5nbmVxfuKqiH5nbmVxcX7iial+Z25zaW1+4ounfmdvcGZ+8J2VmH5ncmF2ZX5gfmdzY3J+4oSKfmdzaW1+4omzfmdzaW1lfuKqjn5nc2ltbH7iqpB+Z3RjY37iqqd+Z3RjaXJ+4qm6fmd0ZG90fuKLl35ndGxQYXJ+4qaVfmd0cXVlc3R+4qm8fmd0cmFwcHJveH7iqoZ+Z3RyYXJyfuKluH5ndHJkb3R+4ouXfmd0cmVxbGVzc37ii5t+Z3RyZXFxbGVzc37iqox+Z3RybGVzc37iibd+Z3Ryc2ltfuKJs35ndmVydG5lcXF+4omp77iAfmd2bkV+4omp77iAfmhhaXJzcH7igIp+aGFsZn7CvX5oYW1pbHR+4oSLfmhhcmRjeX7Rin5oYXJyY2lyfuKliH5oYXJyd37ihq1+aGJhcn7ihI9+aGNpcmN+xKV+aGVhcnRzdWl0fuKZpX5oZXJjb25+4oq5fmhmcn7wnZSlfmhrc2Vhcm93fuKkpX5oa3N3YXJvd37ipKZ+aG9hcnJ+4oe/fmhvbXRodH7iiLt+aG9va2xlZnRhcnJvd37ihql+aG9va3JpZ2h0YXJyb3d+4oaqfmhvcGZ+8J2VmX5ob3JiYXJ+4oCVfmhzY3J+8J2SvX5oc2xhc2h+4oSPfmhzdHJva37Ep35oeWJ1bGx+4oGDfmh5cGhlbn7igJB+aWN+4oGjfmljeX7QuH5pZWN5ftC1fmlmZn7ih5R+aWZyfvCdlKZ+aWl+4oWIfmlpaWludH7iqIx+aWlpbnR+4oitfmlpbmZpbn7ip5x+aWlvdGF+4oSpfmlqbGlnfsSzfmltYWNyfsSrfmltYWdsaW5lfuKEkH5pbWFncGFydH7ihJF+aW1hdGh+xLF+aW1vZn7iird+aW1wZWR+xrV+aW5+4oiIfmluY2FyZX7ihIV+aW5maW50aWV+4qedfmlub2RvdH7EsX5pbnRjYWx+4oq6fmludGVnZXJzfuKEpH5pbnRlcmNhbH7iirp+aW50bGFyaGt+4qiXfmludHByb2R+4qi8fmlvY3l+0ZF+aW9nb25+xK9+aW9wZn7wnZWafmlwcm9kfuKovH5pc2NyfvCdkr5+aXNpbkV+4ou5fmlzaW5kb3R+4ou1fmlzaW5zfuKLtH5pc2luc3Z+4ouzfmlzaW52fuKIiH5pdH7igaJ+aXRpbGRlfsSpfml1a2N5ftGWfmpjaXJjfsS1fmpjeX7QuX5qZnJ+8J2Up35qbWF0aH7It35qb3BmfvCdlZt+anNjcn7wnZK/fmpzZXJjeX7RmH5qdWtjeX7RlH5rYXBwYXZ+z7B+a2NlZGlsfsS3fmtjeX7Qun5rZnJ+8J2UqH5rZ3JlZW5+xLh+a2hjeX7RhX5ramN5ftGcfmtvcGZ+8J2VnH5rc2NyfvCdk4B+bEFhcnJ+4oeafmxBdGFpbH7ipJt+bEJhcnJ+4qSOfmxFfuKJpn5sRWd+4qqLfmxIYXJ+4qWifmxhY3V0ZX7Eun5sYWVtcHR5dn7iprR+bGFncmFufuKEkn5sYW5nZH7ippF+bGFuZ2xlfuKfqH5sYXB+4qqFfmxhcnJifuKHpH5sYXJyYmZzfuKkn35sYXJyZnN+4qSdfmxhcnJoa37ihql+bGFycmxwfuKGq35sYXJycGx+4qS5fmxhcnJzaW1+4qWzfmxhcnJ0bH7ihqJ+bGF0fuKqq35sYXRhaWx+4qSZfmxhdGV+4qqtfmxhdGVzfuKqre+4gH5sYmFycn7ipIx+bGJicmt+4p2yfmxicmFjZX57fmxicmFja35bfmxicmtlfuKmi35sYnJrc2xkfuKmj35sYnJrc2x1fuKmjX5sY2Fyb25+xL5+bGNlZGlsfsS8fmxjdWJ+e35sY3l+0Lt+bGRjYX7ipLZ+bGRxdW9yfuKAnn5sZHJkaGFyfuKlp35sZHJ1c2hhcn7ipYt+bGRzaH7ihrJ+bGVmdGFycm93fuKGkH5sZWZ0YXJyb3d0YWlsfuKGon5sZWZ0aGFycG9vbmRvd25+4oa9fmxlZnRoYXJwb29udXB+4oa8fmxlZnRsZWZ0YXJyb3dzfuKHh35sZWZ0cmlnaHRhcnJvd37ihpR+bGVmdHJpZ2h0YXJyb3dzfuKHhn5sZWZ0cmlnaHRoYXJwb29uc37ih4t+bGVmdHJpZ2h0c3F1aWdhcnJvd37ihq1+bGVmdHRocmVldGltZXN+4ouLfmxlZ37ii5p+bGVxfuKJpH5sZXFxfuKJpn5sZXFzbGFudH7iqb1+bGVzfuKpvX5sZXNjY37iqqh+bGVzZG90fuKpv35sZXNkb3RvfuKqgX5sZXNkb3Rvcn7iqoN+bGVzZ37ii5rvuIB+bGVzZ2VzfuKqk35sZXNzYXBwcm94fuKqhX5sZXNzZG90fuKLln5sZXNzZXFndHJ+4ouafmxlc3NlcXFndHJ+4qqLfmxlc3NndHJ+4om2fmxlc3NzaW1+4omyfmxmaXNodH7ipbx+bGZyfvCdlKl+bGd+4om2fmxnRX7iqpF+bGhhcmR+4oa9fmxoYXJ1fuKGvH5saGFydWx+4qWqfmxoYmxrfuKWhH5samN5ftGZfmxsfuKJqn5sbGFycn7ih4d+bGxjb3JuZXJ+4oyefmxsaGFyZH7ipat+bGx0cml+4pe6fmxtaWRvdH7FgH5sbW91c3R+4o6wfmxtb3VzdGFjaGV+4o6wfmxuRX7iiah+bG5hcH7iqol+bG5hcHByb3h+4qqJfmxuZX7iqod+bG5lcX7iqod+bG5lcXF+4omofmxuc2ltfuKLpn5sb2FuZ37in6x+bG9hcnJ+4oe9fmxvYnJrfuKfpn5sb25nbGVmdGFycm93fuKftX5sb25nbGVmdHJpZ2h0YXJyb3d+4p+3fmxvbmdtYXBzdG9+4p+8fmxvbmdyaWdodGFycm93fuKftn5sb29wYXJyb3dsZWZ0fuKGq35sb29wYXJyb3dyaWdodH7ihqx+bG9wYXJ+4qaFfmxvcGZ+8J2VnX5sb3BsdXN+4qitfmxvdGltZXN+4qi0fmxvd2Jhcn5ffmxvemVuZ2V+4peKfmxvemZ+4qerfmxwYXJ+KH5scGFybHR+4qaTfmxyYXJyfuKHhn5scmNvcm5lcn7ijJ9+bHJoYXJ+4oeLfmxyaGFyZH7ipa1+bHJ0cml+4oq/fmxzY3J+8J2TgX5sc2h+4oawfmxzaW1+4omyfmxzaW1lfuKqjX5sc2ltZ37iqo9+bHNxYn5bfmxzcXVvcn7igJp+bHN0cm9rfsWCfmx0Y2N+4qqmfmx0Y2lyfuKpuX5sdGRvdH7ii5Z+bHRocmVlfuKLi35sdGltZXN+4ouJfmx0bGFycn7ipbZ+bHRxdWVzdH7iqbt+bHRyUGFyfuKmln5sdHJpfuKXg35sdHJpZX7iirR+bHRyaWZ+4peCfmx1cmRzaGFyfuKlin5sdXJ1aGFyfuKlpn5sdmVydG5lcXF+4omo77iAfmx2bkV+4omo77iAfm1ERG90fuKIun5tYWxlfuKZgn5tYWx0fuKcoH5tYWx0ZXNlfuKcoH5tYXB+4oamfm1hcHN0b37ihqZ+bWFwc3RvZG93bn7ihqd+bWFwc3RvbGVmdH7ihqR+bWFwc3RvdXB+4oalfm1hcmtlcn7ilq5+bWNvbW1hfuKoqX5tY3l+0Lx+bWVhc3VyZWRhbmdsZX7iiKF+bWZyfvCdlKp+bWhvfuKEp35taWR+4oijfm1pZGFzdH4qfm1pZGNpcn7iq7B+bWludXNifuKKn35taW51c2R+4oi4fm1pbnVzZHV+4qiqfm1sY3B+4qubfm1sZHJ+4oCmfm1ucGx1c37iiJN+bW9kZWxzfuKKp35tb3BmfvCdlZ5+bXB+4oiTfm1zY3J+8J2Tgn5tc3Rwb3N+4oi+fm11bHRpbWFwfuKKuH5tdW1hcH7iirh+bkdnfuKLmcy4fm5HdH7iiavig5J+bkd0dn7iiavMuH5uTGVmdGFycm93fuKHjX5uTGVmdHJpZ2h0YXJyb3d+4oeOfm5MbH7ii5jMuH5uTHR+4omq4oOSfm5MdHZ+4omqzLh+blJpZ2h0YXJyb3d+4oePfm5WRGFzaH7iiq9+blZkYXNofuKKrn5uYWN1dGV+xYR+bmFuZ37iiKDig5J+bmFwfuKJiX5uYXBFfuKpsMy4fm5hcGlkfuKJi8y4fm5hcG9zfsWJfm5hcHByb3h+4omJfm5hdHVyfuKZrn5uYXR1cmFsfuKZrn5uYXR1cmFsc37ihJV+bmJ1bXB+4omOzLh+bmJ1bXBlfuKJj8y4fm5jYXB+4qmDfm5jYXJvbn7FiH5uY2VkaWx+xYZ+bmNvbmd+4omHfm5jb25nZG90fuKprcy4fm5jdXB+4qmCfm5jeX7QvX5uZUFycn7ih5d+bmVhcmhrfuKkpH5uZWFycn7ihpd+bmVhcnJvd37ihpd+bmVkb3R+4omQzLh+bmVxdWl2fuKJon5uZXNlYXJ+4qSofm5lc2ltfuKJgsy4fm5leGlzdH7iiIR+bmV4aXN0c37iiIR+bmZyfvCdlKt+bmdFfuKJp8y4fm5nZX7iibF+bmdlcX7iibF+bmdlcXF+4omnzLh+bmdlcXNsYW50fuKpvsy4fm5nZXN+4qm+zLh+bmdzaW1+4om1fm5ndH7iia9+bmd0cn7iia9+bmhBcnJ+4oeOfm5oYXJyfuKGrn5uaHBhcn7iq7J+bmlzfuKLvH5uaXNkfuKLun5uaXZ+4oiLfm5qY3l+0Zp+bmxBcnJ+4oeNfm5sRX7iiabMuH5ubGFycn7ihpp+bmxkcn7igKV+bmxlfuKJsH5ubGVmdGFycm93fuKGmn5ubGVmdHJpZ2h0YXJyb3d+4oaufm5sZXF+4omwfm5sZXFxfuKJpsy4fm5sZXFzbGFudH7iqb3MuH5ubGVzfuKpvcy4fm5sZXNzfuKJrn5ubHNpbX7iibR+bmx0fuKJrn5ubHRyaX7ii6p+bmx0cmllfuKLrH5ubWlkfuKIpH5ub3BmfvCdlZ9+bm90aW5FfuKLucy4fm5vdGluZG90fuKLtcy4fm5vdGludmF+4oiJfm5vdGludmJ+4ou3fm5vdGludmN+4ou2fm5vdG5pfuKIjH5ub3RuaXZhfuKIjH5ub3RuaXZifuKLvn5ub3RuaXZjfuKLvX5ucGFyfuKIpn5ucGFyYWxsZWx+4oimfm5wYXJzbH7iq73ig6V+bnBhcnR+4oiCzLh+bnBvbGludH7iqJR+bnByfuKKgH5ucHJjdWV+4ougfm5wcmV+4qqvzLh+bnByZWN+4oqAfm5wcmVjZXF+4qqvzLh+bnJBcnJ+4oePfm5yYXJyfuKGm35ucmFycmN+4qSzzLh+bnJhcnJ3fuKGncy4fm5yaWdodGFycm93fuKGm35ucnRyaX7ii6t+bnJ0cmllfuKLrX5uc2N+4oqBfm5zY2N1ZX7ii6F+bnNjZX7iqrDMuH5uc2NyfvCdk4N+bnNob3J0bWlkfuKIpH5uc2hvcnRwYXJhbGxlbH7iiKZ+bnNpbX7iiYF+bnNpbWV+4omEfm5zaW1lcX7iiYR+bnNtaWR+4oikfm5zcGFyfuKIpn5uc3FzdWJlfuKLon5uc3FzdXBlfuKLo35uc3ViRX7iq4XMuH5uc3ViZX7iioh+bnN1YnNldH7iioLig5J+bnN1YnNldGVxfuKKiH5uc3Vic2V0ZXFxfuKrhcy4fm5zdWNjfuKKgX5uc3VjY2VxfuKqsMy4fm5zdXB+4oqFfm5zdXBFfuKrhsy4fm5zdXBlfuKKiX5uc3Vwc2V0fuKKg+KDkn5uc3Vwc2V0ZXF+4oqJfm5zdXBzZXRlcXF+4quGzLh+bnRnbH7iibl+bnRsZ37iibh+bnRyaWFuZ2xlbGVmdH7ii6p+bnRyaWFuZ2xlbGVmdGVxfuKLrH5udHJpYW5nbGVyaWdodH7ii6t+bnRyaWFuZ2xlcmlnaHRlcX7ii61+bnVtfiN+bnVtZXJvfuKEln5udW1zcH7igId+bnZEYXNofuKKrX5udkhhcnJ+4qSEfm52YXB+4omN4oOSfm52ZGFzaH7iiqx+bnZnZX7iiaXig5J+bnZndH4+4oOSfm52aW5maW5+4qeefm52bEFycn7ipIJ+bnZsZX7iiaTig5J+bnZsdH484oOSfm52bHRyaWV+4oq04oOSfm52ckFycn7ipIN+bnZydHJpZX7iirXig5J+bnZzaW1+4oi84oOSfm53QXJyfuKHln5ud2FyaGt+4qSjfm53YXJyfuKGln5ud2Fycm93fuKGln5ud25lYXJ+4qSnfm9TfuKTiH5vYXN0fuKKm35vY2lyfuKKmn5vY3l+0L5+b2Rhc2h+4oqdfm9kYmxhY37FkX5vZGl2fuKouH5vZG90fuKKmX5vZHNvbGR+4qa8fm9mY2lyfuKmv35vZnJ+8J2UrH5vZ29ufsubfm9ndH7ip4F+b2hiYXJ+4qa1fm9obX7OqX5vaW50fuKIrn5vbGFycn7ihrp+b2xjaXJ+4qa+fm9sY3Jvc3N+4qa7fm9sdH7ip4B+b21hY3J+xY1+b21pZH7iprZ+b21pbnVzfuKKln5vb3BmfvCdlaB+b3Bhcn7iprd+b3BlcnB+4qa5fm9yYXJyfuKGu35vcmR+4qmdfm9yZGVyfuKEtH5vcmRlcm9mfuKEtH5vcmlnb2Z+4oq2fm9yb3J+4qmWfm9yc2xvcGV+4qmXfm9ydn7iqZt+b3Njcn7ihLR+b3NvbH7iiph+b3RpbWVzYXN+4qi2fm92YmFyfuKMvX5wYXJ+4oilfnBhcmFsbGVsfuKIpX5wYXJzaW1+4quzfnBhcnNsfuKrvX5wY3l+0L9+cGVyY250fiV+cGVyaW9kfi5+cGVydGVua37igLF+cGZyfvCdlK1+cGhpdn7PlX5waG1tYXR+4oSzfnBob25lfuKYjn5waXRjaGZvcmt+4ouUfnBsYW5ja37ihI9+cGxhbmNraH7ihI5+cGxhbmt2fuKEj35wbHVzfit+cGx1c2FjaXJ+4qijfnBsdXNifuKKnn5wbHVzY2lyfuKoon5wbHVzZG9+4oiUfnBsdXNkdX7iqKV+cGx1c2V+4qmyfnBsdXNzaW1+4qimfnBsdXN0d29+4qinfnBtfsKxfnBvaW50aW50fuKolX5wb3BmfvCdlaF+cHJ+4om6fnByRX7iqrN+cHJhcH7iqrd+cHJjdWV+4om8fnByZX7iqq9+cHJlY37iibp+cHJlY2FwcHJveH7iqrd+cHJlY2N1cmx5ZXF+4om8fnByZWNlcX7iqq9+cHJlY25hcHByb3h+4qq5fnByZWNuZXFxfuKqtX5wcmVjbnNpbX7ii6h+cHJlY3NpbX7iib5+cHJpbWVzfuKEmX5wcm5FfuKqtX5wcm5hcH7iqrl+cHJuc2ltfuKLqH5wcm9mYWxhcn7ijK5+cHJvZmxpbmV+4oySfnByb2ZzdXJmfuKMk35wcm9wdG9+4oidfnByc2ltfuKJvn5wcnVyZWx+4oqwfnBzY3J+8J2ThX5wdW5jc3B+4oCIfnFmcn7wnZSufnFpbnR+4qiMfnFvcGZ+8J2Von5xcHJpbWV+4oGXfnFzY3J+8J2Thn5xdWF0ZXJuaW9uc37ihI1+cXVhdGludH7iqJZ+cXVlc3R+P35xdWVzdGVxfuKJn35yQWFycn7ih5t+ckF0YWlsfuKknH5yQmFycn7ipI9+ckhhcn7ipaR+cmFjZX7iiL3MsX5yYWN1dGV+xZV+cmFlbXB0eXZ+4qazfnJhbmdkfuKmkn5yYW5nZX7ipqV+cmFuZ2xlfuKfqX5yYXJyYXB+4qW1fnJhcnJifuKHpX5yYXJyYmZzfuKkoH5yYXJyY37ipLN+cmFycmZzfuKknn5yYXJyaGt+4oaqfnJhcnJscH7ihqx+cmFycnBsfuKlhX5yYXJyc2ltfuKltH5yYXJydGx+4oajfnJhcnJ3fuKGnX5yYXRhaWx+4qSafnJhdGlvfuKItn5yYXRpb25hbHN+4oSafnJiYXJyfuKkjX5yYmJya37inbN+cmJyYWNlfn1+cmJyYWNrfl1+cmJya2V+4qaMfnJicmtzbGR+4qaOfnJicmtzbHV+4qaQfnJjYXJvbn7FmX5yY2VkaWx+xZd+cmN1Yn59fnJjeX7RgH5yZGNhfuKkt35yZGxkaGFyfuKlqX5yZHF1b3J+4oCdfnJkc2h+4oazfnJlYWxpbmV+4oSbfnJlYWxwYXJ0fuKEnH5yZWFsc37ihJ1+cmVjdH7ilq1+cmZpc2h0fuKlvX5yZnJ+8J2Ur35yaGFyZH7ih4F+cmhhcnV+4oeAfnJoYXJ1bH7ipax+cmhvdn7PsX5yaWdodGFycm93fuKGkn5yaWdodGFycm93dGFpbH7ihqN+cmlnaHRoYXJwb29uZG93bn7ih4F+cmlnaHRoYXJwb29udXB+4oeAfnJpZ2h0bGVmdGFycm93c37ih4R+cmlnaHRsZWZ0aGFycG9vbnN+4oeMfnJpZ2h0cmlnaHRhcnJvd3N+4oeJfnJpZ2h0c3F1aWdhcnJvd37ihp1+cmlnaHR0aHJlZXRpbWVzfuKLjH5yaW5nfsuafnJpc2luZ2RvdHNlcX7iiZN+cmxhcnJ+4oeEfnJsaGFyfuKHjH5ybW91c3R+4o6xfnJtb3VzdGFjaGV+4o6xfnJubWlkfuKrrn5yb2FuZ37in61+cm9hcnJ+4oe+fnJvYnJrfuKfp35yb3Bhcn7ipoZ+cm9wZn7wnZWjfnJvcGx1c37iqK5+cm90aW1lc37iqLV+cnBhcn4pfnJwYXJndH7ippR+cnBwb2xpbnR+4qiSfnJyYXJyfuKHiX5yc2NyfvCdk4d+cnNofuKGsX5yc3Fifl1+cnNxdW9yfuKAmX5ydGhyZWV+4ouMfnJ0aW1lc37ii4p+cnRyaX7ilrl+cnRyaWV+4oq1fnJ0cmlmfuKWuH5ydHJpbHRyaX7ip45+cnVsdWhhcn7ipah+cnh+4oSefnNhY3V0ZX7Fm35zY37iibt+c2NFfuKqtH5zY2FwfuKquH5zY2N1ZX7iib1+c2NlfuKqsH5zY2VkaWx+xZ9+c2NpcmN+xZ1+c2NuRX7iqrZ+c2NuYXB+4qq6fnNjbnNpbX7ii6l+c2Nwb2xpbnR+4qiTfnNjc2ltfuKJv35zY3l+0YF+c2RvdGJ+4oqhfnNkb3RlfuKppn5zZUFycn7ih5h+c2VhcmhrfuKkpX5zZWFycn7ihph+c2VhcnJvd37ihph+c2VtaX47fnNlc3dhcn7ipKl+c2V0bWludXN+4oiWfnNldG1ufuKIln5zZXh0fuKctn5zZnJ+8J2UsH5zZnJvd25+4oyifnNoYXJwfuKZr35zaGNoY3l+0Yl+c2hjeX7RiH5zaG9ydG1pZH7iiKN+c2hvcnRwYXJhbGxlbH7iiKV+c2lnbWF2fs+CfnNpbWRvdH7iqap+c2ltZX7iiYN+c2ltZXF+4omDfnNpbWd+4qqefnNpbWdFfuKqoH5zaW1sfuKqnX5zaW1sRX7iqp9+c2ltbmV+4omGfnNpbXBsdXN+4qikfnNpbXJhcnJ+4qWyfnNsYXJyfuKGkH5zbWFsbHNldG1pbnVzfuKIln5zbWFzaHB+4qizfnNtZXBhcnNsfuKnpH5zbWlkfuKIo35zbWlsZX7ijKN+c210fuKqqn5zbXRlfuKqrH5zbXRlc37iqqzvuIB+c29mdGN5ftGMfnNvbH4vfnNvbGJ+4qeEfnNvbGJhcn7ijL9+c29wZn7wnZWkfnNwYWRlc3VpdH7imaB+c3Bhcn7iiKV+c3FjYXB+4oqTfnNxY2Fwc37iipPvuIB+c3FjdXB+4oqUfnNxY3Vwc37iipTvuIB+c3FzdWJ+4oqPfnNxc3ViZX7iipF+c3FzdWJzZXR+4oqPfnNxc3Vic2V0ZXF+4oqRfnNxc3VwfuKKkH5zcXN1cGV+4oqSfnNxc3Vwc2V0fuKKkH5zcXN1cHNldGVxfuKKkn5zcXV+4pahfnNxdWFyZX7ilqF+c3F1YXJmfuKWqn5zcXVmfuKWqn5zcmFycn7ihpJ+c3Njcn7wnZOIfnNzZXRtbn7iiJZ+c3NtaWxlfuKMo35zc3RhcmZ+4ouGfnN0YXJ+4piGfnN0YXJmfuKYhX5zdHJhaWdodGVwc2lsb25+z7V+c3RyYWlnaHRwaGl+z5V+c3RybnN+wq9+c3ViRX7iq4V+c3ViZG90fuKqvX5zdWJlZG90fuKrg35zdWJtdWx0fuKrgX5zdWJuRX7iq4t+c3VibmV+4oqKfnN1YnBsdXN+4qq/fnN1YnJhcnJ+4qW5fnN1YnNldH7iioJ+c3Vic2V0ZXF+4oqGfnN1YnNldGVxcX7iq4V+c3Vic2V0bmVxfuKKin5zdWJzZXRuZXFxfuKri35zdWJzaW1+4quHfnN1YnN1Yn7iq5V+c3Vic3VwfuKrk35zdWNjfuKJu35zdWNjYXBwcm94fuKquH5zdWNjY3VybHllcX7iib1+c3VjY2VxfuKqsH5zdWNjbmFwcHJveH7iqrp+c3VjY25lcXF+4qq2fnN1Y2Nuc2ltfuKLqX5zdWNjc2ltfuKJv35zdW5nfuKZqn5zdXBFfuKrhn5zdXBkb3R+4qq+fnN1cGRzdWJ+4quYfnN1cGVkb3R+4quEfnN1cGhzb2x+4p+JfnN1cGhzdWJ+4quXfnN1cGxhcnJ+4qW7fnN1cG11bHR+4quCfnN1cG5FfuKrjH5zdXBuZX7iiot+c3VwcGx1c37iq4B+c3Vwc2V0fuKKg35zdXBzZXRlcX7iiod+c3Vwc2V0ZXFxfuKrhn5zdXBzZXRuZXF+4oqLfnN1cHNldG5lcXF+4quMfnN1cHNpbX7iq4h+c3Vwc3VifuKrlH5zdXBzdXB+4quWfnN3QXJyfuKHmX5zd2FyaGt+4qSmfnN3YXJyfuKGmX5zd2Fycm93fuKGmX5zd253YXJ+4qSqfnRhcmdldH7ijJZ+dGJya37ijrR+dGNhcm9ufsWlfnRjZWRpbH7Fo350Y3l+0YJ+dGRvdH7ig5t+dGVscmVjfuKMlX50ZnJ+8J2UsX50aGVyZWZvcmV+4oi0fnRoZXRhdn7PkX50aGlja2FwcHJveH7iiYh+dGhpY2tzaW1+4oi8fnRoa2FwfuKJiH50aGtzaW1+4oi8fnRpbWVzYn7iiqB+dGltZXNiYXJ+4qixfnRpbWVzZH7iqLB+dGludH7iiK1+dG9lYX7ipKh+dG9wfuKKpH50b3Bib3R+4oy2fnRvcGNpcn7iq7F+dG9wZn7wnZWlfnRvcGZvcmt+4quafnRvc2F+4qSpfnRwcmltZX7igLR+dHJpYW5nbGV+4pa1fnRyaWFuZ2xlZG93bn7ilr9+dHJpYW5nbGVsZWZ0fuKXg350cmlhbmdsZWxlZnRlcX7iirR+dHJpYW5nbGVxfuKJnH50cmlhbmdsZXJpZ2h0fuKWuX50cmlhbmdsZXJpZ2h0ZXF+4oq1fnRyaWRvdH7il6x+dHJpZX7iiZx+dHJpbWludXN+4qi6fnRyaXBsdXN+4qi5fnRyaXNifuKnjX50cml0aW1lfuKou350cnBleml1bX7ij6J+dHNjcn7wnZOJfnRzY3l+0YZ+dHNoY3l+0Zt+dHN0cm9rfsWnfnR3aXh0fuKJrH50d29oZWFkbGVmdGFycm93fuKGnn50d29oZWFkcmlnaHRhcnJvd37ihqB+dUhhcn7ipaN+dWJyY3l+0Z5+dWJyZXZlfsWtfnVjeX7Rg351ZGFycn7ih4V+dWRibGFjfsWxfnVkaGFyfuKlrn51ZmlzaHR+4qW+fnVmcn7wnZSyfnVoYXJsfuKGv351aGFycn7ihr5+dWhibGt+4paAfnVsY29ybn7ijJx+dWxjb3JuZXJ+4oycfnVsY3JvcH7ijI9+dWx0cml+4pe4fnVtYWNyfsWrfnVvZ29ufsWzfnVvcGZ+8J2Vpn51cGFycm93fuKGkX51cGRvd25hcnJvd37ihpV+dXBoYXJwb29ubGVmdH7ihr9+dXBoYXJwb29ucmlnaHR+4oa+fnVwbHVzfuKKjn51cHNpfs+FfnVwdXBhcnJvd3N+4oeIfnVyY29ybn7ijJ1+dXJjb3JuZXJ+4oydfnVyY3JvcH7ijI5+dXJpbmd+xa9+dXJ0cml+4pe5fnVzY3J+8J2Tin51dGRvdH7ii7B+dXRpbGRlfsWpfnV0cml+4pa1fnV0cmlmfuKWtH51dWFycn7ih4h+dXdhbmdsZX7ipqd+dkFycn7ih5V+dkJhcn7iq6h+dkJhcnZ+4qupfnZEYXNofuKKqH52YW5ncnR+4qacfnZhcmVwc2lsb25+z7V+dmFya2FwcGF+z7B+dmFybm90aGluZ37iiIV+dmFycGhpfs+VfnZhcnBpfs+WfnZhcnByb3B0b37iiJ1+dmFycn7ihpV+dmFycmhvfs+xfnZhcnNpZ21hfs+CfnZhcnN1YnNldG5lcX7iiorvuIB+dmFyc3Vic2V0bmVxcX7iq4vvuIB+dmFyc3Vwc2V0bmVxfuKKi++4gH52YXJzdXBzZXRuZXFxfuKrjO+4gH52YXJ0aGV0YX7PkX52YXJ0cmlhbmdsZWxlZnR+4oqyfnZhcnRyaWFuZ2xlcmlnaHR+4oqzfnZjeX7Qsn52ZGFzaH7iiqJ+dmVlfuKIqH52ZWViYXJ+4oq7fnZlZWVxfuKJmn52ZWxsaXB+4ouufnZlcmJhcn58fnZlcnR+fH52ZnJ+8J2Us352bHRyaX7iirJ+dm5zdWJ+4oqC4oOSfnZuc3VwfuKKg+KDkn52b3BmfvCdlad+dnByb3B+4oidfnZydHJpfuKKs352c2NyfvCdk4t+dnN1Ym5FfuKri++4gH52c3VibmV+4oqK77iAfnZzdXBuRX7iq4zvuIB+dnN1cG5lfuKKi++4gH52emlnemFnfuKmmn53Y2lyY37FtX53ZWRiYXJ+4qmffndlZGdlfuKIp353ZWRnZXF+4omZfndmcn7wnZS0fndvcGZ+8J2VqH53cH7ihJh+d3J+4omAfndyZWF0aH7iiYB+d3Njcn7wnZOMfnhjYXB+4ouCfnhjaXJjfuKXr354Y3VwfuKLg354ZHRyaX7ilr1+eGZyfvCdlLV+eGhBcnJ+4p+6fnhoYXJyfuKft354bEFycn7in7h+eGxhcnJ+4p+1fnhtYXB+4p+8fnhuaXN+4ou7fnhvZG90fuKogH54b3BmfvCdlal+eG9wbHVzfuKogX54b3RpbWV+4qiCfnhyQXJyfuKfuX54cmFycn7in7Z+eHNjcn7wnZONfnhzcWN1cH7iqIZ+eHVwbHVzfuKohH54dXRyaX7ilrN+eHZlZX7ii4F+eHdlZGdlfuKLgH55YWN5ftGPfnljaXJjfsW3fnljeX7Ri355ZnJ+8J2Utn55aWN5ftGXfnlvcGZ+8J2Vqn55c2NyfvCdk45+eXVjeX7Rjn56YWN1dGV+xbp+emNhcm9ufsW+fnpjeX7Qt356ZG90fsW8fnplZXRyZn7ihKh+emZyfvCdlLd+emhjeX7Qtn56aWdyYXJyfuKHnX56b3BmfvCdlat+enNjcn7wnZOPfn5BTVB+Jn5DT1BZfsKpfkdUfj5+TFR+PH5RVU9UflxcXCJ+UkVHfsKuXCIsIG5hbWVkUmVmZXJlbmNlc1snaHRtbDQnXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1uYW1lZC1yZWZlcmVuY2VzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/html-entities/dist/esm/named-references.js\n\n}");

/***/ }),

/***/ "./node_modules/html-entities/dist/esm/numeric-unicode-map.js":
/*!********************************************************************!*\
  !*** ./node_modules/html-entities/dist/esm/numeric-unicode-map.js ***!
  \********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   numericUnicodeMap: () => (/* binding */ numericUnicodeMap)\n/* harmony export */ });\nvar numericUnicodeMap = {\n    0: 65533,\n    128: 8364,\n    130: 8218,\n    131: 402,\n    132: 8222,\n    133: 8230,\n    134: 8224,\n    135: 8225,\n    136: 710,\n    137: 8240,\n    138: 352,\n    139: 8249,\n    140: 338,\n    142: 381,\n    145: 8216,\n    146: 8217,\n    147: 8220,\n    148: 8221,\n    149: 8226,\n    150: 8211,\n    151: 8212,\n    152: 732,\n    153: 8482,\n    154: 353,\n    155: 8250,\n    156: 339,\n    158: 382,\n    159: 376\n};\n//# sourceMappingURL=numeric-unicode-map.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvaHRtbC1lbnRpdGllcy9kaXN0L2VzbS9udW1lcmljLXVuaWNvZGUtbWFwLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvaHRtbC1lbnRpdGllcy9kaXN0L2VzbS9udW1lcmljLXVuaWNvZGUtbWFwLmpzPzQ5ZjAiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHZhciBudW1lcmljVW5pY29kZU1hcCA9IHtcbiAgICAwOiA2NTUzMyxcbiAgICAxMjg6IDgzNjQsXG4gICAgMTMwOiA4MjE4LFxuICAgIDEzMTogNDAyLFxuICAgIDEzMjogODIyMixcbiAgICAxMzM6IDgyMzAsXG4gICAgMTM0OiA4MjI0LFxuICAgIDEzNTogODIyNSxcbiAgICAxMzY6IDcxMCxcbiAgICAxMzc6IDgyNDAsXG4gICAgMTM4OiAzNTIsXG4gICAgMTM5OiA4MjQ5LFxuICAgIDE0MDogMzM4LFxuICAgIDE0MjogMzgxLFxuICAgIDE0NTogODIxNixcbiAgICAxNDY6IDgyMTcsXG4gICAgMTQ3OiA4MjIwLFxuICAgIDE0ODogODIyMSxcbiAgICAxNDk6IDgyMjYsXG4gICAgMTUwOiA4MjExLFxuICAgIDE1MTogODIxMixcbiAgICAxNTI6IDczMixcbiAgICAxNTM6IDg0ODIsXG4gICAgMTU0OiAzNTMsXG4gICAgMTU1OiA4MjUwLFxuICAgIDE1NjogMzM5LFxuICAgIDE1ODogMzgyLFxuICAgIDE1OTogMzc2XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bnVtZXJpYy11bmljb2RlLW1hcC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/html-entities/dist/esm/numeric-unicode-map.js\n\n}");

/***/ }),

/***/ "./node_modules/html-entities/dist/esm/surrogate-pairs.js":
/*!****************************************************************!*\
  !*** ./node_modules/html-entities/dist/esm/surrogate-pairs.js ***!
  \****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fromCodePoint: () => (/* binding */ fromCodePoint),\n/* harmony export */   getCodePoint: () => (/* binding */ getCodePoint),\n/* harmony export */   highSurrogateFrom: () => (/* binding */ highSurrogateFrom),\n/* harmony export */   highSurrogateTo: () => (/* binding */ highSurrogateTo)\n/* harmony export */ });\nvar fromCodePoint = String.fromCodePoint ||\n    function (astralCodePoint) {\n        return String.fromCharCode(Math.floor((astralCodePoint - 0x10000) / 0x400) + 0xd800, ((astralCodePoint - 0x10000) % 0x400) + 0xdc00);\n    };\n// @ts-expect-error - String.prototype.codePointAt might not exist in older node versions\nvar getCodePoint = String.prototype.codePointAt\n    ? function (input, position) {\n        return input.codePointAt(position);\n    }\n    : function (input, position) {\n        return (input.charCodeAt(position) - 0xd800) * 0x400 + input.charCodeAt(position + 1) - 0xdc00 + 0x10000;\n    };\nvar highSurrogateFrom = 0xd800;\nvar highSurrogateTo = 0xdbff;\n//# sourceMappingURL=surrogate-pairs.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvaHRtbC1lbnRpdGllcy9kaXN0L2VzbS9zdXJyb2dhdGUtcGFpcnMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ0E7QUFDUCIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvaHRtbC1lbnRpdGllcy9kaXN0L2VzbS9zdXJyb2dhdGUtcGFpcnMuanM/MjFlNSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdmFyIGZyb21Db2RlUG9pbnQgPSBTdHJpbmcuZnJvbUNvZGVQb2ludCB8fFxuICAgIGZ1bmN0aW9uIChhc3RyYWxDb2RlUG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoTWF0aC5mbG9vcigoYXN0cmFsQ29kZVBvaW50IC0gMHgxMDAwMCkgLyAweDQwMCkgKyAweGQ4MDAsICgoYXN0cmFsQ29kZVBvaW50IC0gMHgxMDAwMCkgJSAweDQwMCkgKyAweGRjMDApO1xuICAgIH07XG4vLyBAdHMtZXhwZWN0LWVycm9yIC0gU3RyaW5nLnByb3RvdHlwZS5jb2RlUG9pbnRBdCBtaWdodCBub3QgZXhpc3QgaW4gb2xkZXIgbm9kZSB2ZXJzaW9uc1xuZXhwb3J0IHZhciBnZXRDb2RlUG9pbnQgPSBTdHJpbmcucHJvdG90eXBlLmNvZGVQb2ludEF0XG4gICAgPyBmdW5jdGlvbiAoaW5wdXQsIHBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiBpbnB1dC5jb2RlUG9pbnRBdChwb3NpdGlvbik7XG4gICAgfVxuICAgIDogZnVuY3Rpb24gKGlucHV0LCBwb3NpdGlvbikge1xuICAgICAgICByZXR1cm4gKGlucHV0LmNoYXJDb2RlQXQocG9zaXRpb24pIC0gMHhkODAwKSAqIDB4NDAwICsgaW5wdXQuY2hhckNvZGVBdChwb3NpdGlvbiArIDEpIC0gMHhkYzAwICsgMHgxMDAwMDtcbiAgICB9O1xuZXhwb3J0IHZhciBoaWdoU3Vycm9nYXRlRnJvbSA9IDB4ZDgwMDtcbmV4cG9ydCB2YXIgaGlnaFN1cnJvZ2F0ZVRvID0gMHhkYmZmO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3Vycm9nYXRlLXBhaXJzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/html-entities/dist/esm/surrogate-pairs.js\n\n}");

/***/ }),

/***/ "./node_modules/tabulator-tables/dist/js/tabulator_esm.js":
/*!****************************************************************!*\
  !*** ./node_modules/tabulator-tables/dist/js/tabulator_esm.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AccessorModule: () => (/* binding */ Accessor),\n/* harmony export */   AjaxModule: () => (/* binding */ Ajax),\n/* harmony export */   CalcComponent: () => (/* binding */ CalcComponent),\n/* harmony export */   CellComponent: () => (/* binding */ CellComponent),\n/* harmony export */   ClipboardModule: () => (/* binding */ Clipboard),\n/* harmony export */   ColumnCalcsModule: () => (/* binding */ ColumnCalcs),\n/* harmony export */   ColumnComponent: () => (/* binding */ ColumnComponent),\n/* harmony export */   DataTreeModule: () => (/* binding */ DataTree),\n/* harmony export */   DownloadModule: () => (/* binding */ Download),\n/* harmony export */   EditModule: () => (/* binding */ Edit),\n/* harmony export */   ExportModule: () => (/* binding */ Export),\n/* harmony export */   FilterModule: () => (/* binding */ Filter),\n/* harmony export */   FormatModule: () => (/* binding */ Format),\n/* harmony export */   FrozenColumnsModule: () => (/* binding */ FrozenColumns),\n/* harmony export */   FrozenRowsModule: () => (/* binding */ FrozenRows),\n/* harmony export */   GroupComponent: () => (/* binding */ GroupComponent),\n/* harmony export */   GroupRowsModule: () => (/* binding */ GroupRows),\n/* harmony export */   HistoryModule: () => (/* binding */ History),\n/* harmony export */   HtmlTableImportModule: () => (/* binding */ HtmlTableImport),\n/* harmony export */   ImportModule: () => (/* binding */ Import),\n/* harmony export */   InteractionModule: () => (/* binding */ Interaction),\n/* harmony export */   KeybindingsModule: () => (/* binding */ Keybindings),\n/* harmony export */   MenuModule: () => (/* binding */ Menu),\n/* harmony export */   Module: () => (/* binding */ Module),\n/* harmony export */   MoveColumnsModule: () => (/* binding */ MoveColumns),\n/* harmony export */   MoveRowsModule: () => (/* binding */ MoveRows),\n/* harmony export */   MutatorModule: () => (/* binding */ Mutator),\n/* harmony export */   PageModule: () => (/* binding */ Page),\n/* harmony export */   PersistenceModule: () => (/* binding */ Persistence),\n/* harmony export */   PopupModule: () => (/* binding */ Popup),\n/* harmony export */   PrintModule: () => (/* binding */ Print),\n/* harmony export */   PseudoRow: () => (/* binding */ PseudoRow),\n/* harmony export */   RangeComponent: () => (/* binding */ RangeComponent),\n/* harmony export */   ReactiveDataModule: () => (/* binding */ ReactiveData),\n/* harmony export */   Renderer: () => (/* binding */ Renderer),\n/* harmony export */   ResizeColumnsModule: () => (/* binding */ ResizeColumns),\n/* harmony export */   ResizeRowsModule: () => (/* binding */ ResizeRows),\n/* harmony export */   ResizeTableModule: () => (/* binding */ ResizeTable),\n/* harmony export */   ResponsiveLayoutModule: () => (/* binding */ ResponsiveLayout),\n/* harmony export */   RowComponent: () => (/* binding */ RowComponent),\n/* harmony export */   SelectRangeModule: () => (/* binding */ SelectRange),\n/* harmony export */   SelectRowModule: () => (/* binding */ SelectRow),\n/* harmony export */   SheetComponent: () => (/* binding */ SheetComponent),\n/* harmony export */   SortModule: () => (/* binding */ Sort),\n/* harmony export */   SpreadsheetModule: () => (/* binding */ Spreadsheet),\n/* harmony export */   Tabulator: () => (/* binding */ Tabulator$1),\n/* harmony export */   TabulatorFull: () => (/* binding */ TabulatorFull$1),\n/* harmony export */   TooltipModule: () => (/* binding */ Tooltip),\n/* harmony export */   ValidateModule: () => (/* binding */ Validate)\n/* harmony export */ });\n/* Tabulator v6.3.1 (c) Oliver Folkerd 2025 */\nclass CoreFeature{\n\n\tconstructor(table){\n\t\tthis.table = table;\n\t}\n\n\t//////////////////////////////////////////\n\t/////////////// DataLoad /////////////////\n\t//////////////////////////////////////////\n\n\treloadData(data, silent, columnsChanged){\n\t\treturn this.table.dataLoader.load(data, undefined, undefined, undefined, silent, columnsChanged);\n\t}\n\n\t//////////////////////////////////////////\n\t///////////// Localization ///////////////\n\t//////////////////////////////////////////\n\n\tlangText(){\n\t\treturn this.table.modules.localize.getText(...arguments);\n\t}\n\n\tlangBind(){\n\t\treturn this.table.modules.localize.bind(...arguments);\n\t}\n\n\tlangLocale(){\n\t\treturn this.table.modules.localize.getLocale(...arguments);\n\t}\n\n\n\t//////////////////////////////////////////\n\t////////// Inter Table Comms /////////////\n\t//////////////////////////////////////////\n\n\tcommsConnections(){\n\t\treturn this.table.modules.comms.getConnections(...arguments);\n\t}\n\n\tcommsSend(){\n\t\treturn this.table.modules.comms.send(...arguments);\n\t}\n\n\t//////////////////////////////////////////\n\t//////////////// Layout  /////////////////\n\t//////////////////////////////////////////\n\n\tlayoutMode(){\n\t\treturn this.table.modules.layout.getMode();\n\t}\n\n\tlayoutRefresh(force){\n\t\treturn this.table.modules.layout.layout(force);\n\t}\n\n\n\t//////////////////////////////////////////\n\t/////////////// Event Bus ////////////////\n\t//////////////////////////////////////////\n\n\tsubscribe(){\n\t\treturn this.table.eventBus.subscribe(...arguments);\n\t}\n\n\tunsubscribe(){\n\t\treturn this.table.eventBus.unsubscribe(...arguments);\n\t}\n\n\tsubscribed(key){\n\t\treturn this.table.eventBus.subscribed(key);\n\t}\n\n\tsubscriptionChange(){\n\t\treturn this.table.eventBus.subscriptionChange(...arguments);\n\t}\n\n\tdispatch(){\n\t\treturn this.table.eventBus.dispatch(...arguments);\n\t}\n\n\tchain(){\n\t\treturn this.table.eventBus.chain(...arguments);\n\t}\n\n\tconfirm(){\n\t\treturn this.table.eventBus.confirm(...arguments);\n\t}\n\n\tdispatchExternal(){\n\t\treturn this.table.externalEvents.dispatch(...arguments);\n\t}\n\n\tsubscribedExternal(key){\n\t\treturn this.table.externalEvents.subscribed(key);\n\t}\n\n\tsubscriptionChangeExternal(){\n\t\treturn this.table.externalEvents.subscriptionChange(...arguments);\n\t}\n\n\t//////////////////////////////////////////\n\t//////////////// Options /////////////////\n\t//////////////////////////////////////////\n\n\toptions(key){\n\t\treturn this.table.options[key];\n\t}\n\n\tsetOption(key, value){\n\t\tif(typeof value !== \"undefined\"){\n\t\t\tthis.table.options[key] = value;\n\t\t}\n\n\t\treturn this.table.options[key];\n\t}\n\n\t//////////////////////////////////////////\n\t/////////// Deprecation Checks ///////////\n\t//////////////////////////////////////////\n\n\tdeprecationCheck(oldOption, newOption,  convert){\n\t\treturn this.table.deprecationAdvisor.check(oldOption, newOption,  convert);\n\t}\n\n\tdeprecationCheckMsg(oldOption, msg){\n\t\treturn this.table.deprecationAdvisor.checkMsg(oldOption, msg);\n\t}\n\n\tdeprecationMsg(msg){\n\t\treturn this.table.deprecationAdvisor.msg(msg);\n\t}\n\t//////////////////////////////////////////\n\t//////////////// Modules /////////////////\n\t//////////////////////////////////////////\n\n\tmodule(key){\n\t\treturn this.table.module(key);\n\t}\n}\n\nclass Helpers{\n\n\tstatic elVisible(el){\n\t\treturn !(el.offsetWidth <= 0 && el.offsetHeight <= 0);\n\t}\n\n\tstatic elOffset(el){\n\t\tvar box = el.getBoundingClientRect();\n\n\t\treturn {\n\t\t\ttop: box.top + window.pageYOffset - document.documentElement.clientTop,\n\t\t\tleft: box.left + window.pageXOffset - document.documentElement.clientLeft\n\t\t};\n\t}\n\n\tstatic retrieveNestedData(separator, field, data){\n\t\tvar structure = separator ? field.split(separator) : [field],\n\t\tlength = structure.length,\n\t\toutput;\n\n\t\tfor(let i = 0; i < length; i++){\n\n\t\t\tdata = data[structure[i]];\n\n\t\t\toutput = data;\n\n\t\t\tif(!data){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tstatic deepClone(obj, clone, list = []){\n\t\tvar objectProto = {}.__proto__,\n\t\tarrayProto = [].__proto__;\n\n\t\tif (!clone){\n\t\t\tclone = Object.assign(Array.isArray(obj) ? [] : {}, obj);\n\t\t}\n\n\t\tfor(var i in obj) {\n\t\t\tlet subject = obj[i],\n\t\t\tmatch, copy;\n\n\t\t\tif(subject != null && typeof subject === \"object\" && (subject.__proto__ === objectProto || subject.__proto__ === arrayProto)){\n\t\t\t\tmatch = list.findIndex((item) => {\n\t\t\t\t\treturn item.subject === subject;\n\t\t\t\t});\n\n\t\t\t\tif(match > -1){\n\t\t\t\t\tclone[i] = list[match].copy;\n\t\t\t\t}else {\n\t\t\t\t\tcopy = Object.assign(Array.isArray(subject) ? [] : {}, subject);\n\n\t\t\t\t\tlist.unshift({subject, copy});\n\n\t\t\t\t\tclone[i] = this.deepClone(subject, copy, list);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn clone;\n\t}\n}\n\nlet Popup$1 = class Popup extends CoreFeature{\n\tconstructor(table, element, parent){\n\t\tsuper(table);\n\t\t\n\t\tthis.element = element;\n\t\tthis.container = this._lookupContainer();\n\t\t\n\t\tthis.parent = parent;\n\t\t\n\t\tthis.reversedX = false;\n\t\tthis.childPopup = null;\n\t\tthis.blurable = false;\n\t\tthis.blurCallback = null;\n\t\tthis.blurEventsBound = false;\n\t\tthis.renderedCallback = null;\n\t\t\n\t\tthis.visible = false;\n\t\tthis.hideable = true;\n\t\t\n\t\tthis.element.classList.add(\"tabulator-popup-container\");\n\t\t\n\t\tthis.blurEvent = this.hide.bind(this, false);\n\t\tthis.escEvent = this._escapeCheck.bind(this);\n\t\t\n\t\tthis.destroyBinding = this.tableDestroyed.bind(this);\n\t\tthis.destroyed = false;\n\t}\n\t\n\ttableDestroyed(){\n\t\tthis.destroyed = true;\n\t\tthis.hide(true);\n\t}\n\t\n\t_lookupContainer(){\n\t\tvar container = this.table.options.popupContainer;\n\t\t\n\t\tif(typeof container === \"string\"){\n\t\t\tcontainer = document.querySelector(container);\n\t\t\t\n\t\t\tif(!container){\n\t\t\t\tconsole.warn(\"Menu Error - no container element found matching selector:\",  this.table.options.popupContainer , \"(defaulting to document body)\");\n\t\t\t}\n\t\t}else if (container === true){\n\t\t\tcontainer = this.table.element;\n\t\t}\n\t\t\n\t\tif(container && !this._checkContainerIsParent(container)){\n\t\t\tcontainer = false;\n\t\t\tconsole.warn(\"Menu Error - container element does not contain this table:\",  this.table.options.popupContainer , \"(defaulting to document body)\");\n\t\t}\n\t\t\n\t\tif(!container){\n\t\t\tcontainer = document.body;\n\t\t}\n\t\t\n\t\treturn container;\n\t}\n\t\n\t_checkContainerIsParent(container, element = this.table.element){\n\t\tif(container === element){\n\t\t\treturn true;\n\t\t}else {\n\t\t\treturn element.parentNode ? this._checkContainerIsParent(container, element.parentNode) : false;\n\t\t}\n\t}\n\t\n\trenderCallback(callback){\n\t\tthis.renderedCallback = callback;\n\t}\n\t\n\tcontainerEventCoords(e){\n\t\tvar touch = !(e instanceof MouseEvent);\n\t\t\n\t\tvar x = touch ? e.touches[0].pageX : e.pageX;\n\t\tvar y = touch ? e.touches[0].pageY : e.pageY;\n\t\t\n\t\tif(this.container !== document.body){\n\t\t\tlet parentOffset = Helpers.elOffset(this.container);\n\t\t\t\n\t\t\tx -= parentOffset.left;\n\t\t\ty -= parentOffset.top;\n\t\t}\n\t\t\n\t\treturn {x, y};\n\t}\n\t\n\telementPositionCoords(element, position = \"right\"){\n\t\tvar offset = Helpers.elOffset(element),\n\t\tcontainerOffset, x, y;\n\t\t\n\t\tif(this.container !== document.body){\n\t\t\tcontainerOffset = Helpers.elOffset(this.container);\n\t\t\t\n\t\t\toffset.left -= containerOffset.left;\n\t\t\toffset.top -= containerOffset.top;\n\t\t}\n\t\t\n\t\tswitch(position){\n\t\t\tcase \"right\":\n\t\t\t\tx = offset.left + element.offsetWidth;\n\t\t\t\ty = offset.top - 1;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"bottom\":\n\t\t\t\tx = offset.left;\n\t\t\t\ty = offset.top + element.offsetHeight;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"left\":\n\t\t\t\tx = offset.left;\n\t\t\t\ty = offset.top - 1;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"top\":\n\t\t\t\tx = offset.left;\n\t\t\t\ty = offset.top;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"center\":\n\t\t\t\tx = offset.left + (element.offsetWidth / 2);\n\t\t\t\ty = offset.top + (element.offsetHeight / 2);\n\t\t\t\tbreak;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn {x, y, offset};\n\t}\n\t\n\tshow(origin, position){\n\t\tvar x, y, parentEl, parentOffset, coords;\n\t\t\n\t\tif(this.destroyed || this.table.destroyed){\n\t\t\treturn this;\n\t\t}\n\t\t\n\t\tif(origin instanceof HTMLElement){\n\t\t\tparentEl = origin;\n\t\t\tcoords = this.elementPositionCoords(origin, position);\n\t\t\t\n\t\t\tparentOffset = coords.offset;\n\t\t\tx = coords.x;\n\t\t\ty = coords.y;\n\t\t\t\n\t\t}else if(typeof origin === \"number\"){\n\t\t\tparentOffset = {top:0, left:0};\n\t\t\tx = origin;\n\t\t\ty = position;\n\t\t}else {\n\t\t\tcoords = this.containerEventCoords(origin);\n\t\t\t\n\t\t\tx = coords.x;\n\t\t\ty = coords.y;\n\t\t\t\n\t\t\tthis.reversedX = false;\n\t\t}\n\t\t\n\t\tthis.element.style.top = y + \"px\";\n\t\tthis.element.style.left = x + \"px\";\n\t\t\n\t\tthis.container.appendChild(this.element);\n\t\t\n\t\tif(typeof this.renderedCallback === \"function\"){\n\t\t\tthis.renderedCallback();\n\t\t}\n\t\t\n\t\tthis._fitToScreen(x, y, parentEl, parentOffset, position);\n\t\t\n\t\tthis.visible = true;\n\t\t\n\t\tthis.subscribe(\"table-destroy\", this.destroyBinding);\n\t\t\n\t\tthis.element.addEventListener(\"mousedown\", (e) => {\n\t\t\te.stopPropagation();\n\t\t});\n\t\t\n\t\treturn this;\n\t}\n\t\n\t_fitToScreen(x, y, parentEl, parentOffset, position){\n\t\tvar scrollTop = this.container === document.body ? document.documentElement.scrollTop : this.container.scrollTop;\n\t\t\n\t\t//move menu to start on right edge if it is too close to the edge of the screen\n\t\tif((x + this.element.offsetWidth) >= this.container.offsetWidth || this.reversedX){\n\t\t\tthis.element.style.left = \"\";\n\t\t\t\n\t\t\tif(parentEl){\n\t\t\t\tthis.element.style.right = (this.container.offsetWidth - parentOffset.left) + \"px\";\n\t\t\t}else {\n\t\t\t\tthis.element.style.right = (this.container.offsetWidth - x) + \"px\";\n\t\t\t}\n\t\t\t\n\t\t\tthis.reversedX = true;\n\t\t}\n\t\t\n\t\t//move menu to start on bottom edge if it is too close to the edge of the screen\n\t\tlet offsetHeight = Math.max(this.container.offsetHeight, scrollTop ? this.container.scrollHeight : 0);\n\t\tif((y + this.element.offsetHeight) > offsetHeight) {\n\t\t\tif(parentEl){\n\t\t\t\tswitch(position){\n\t\t\t\t\tcase \"bottom\":\n\t\t\t\t\t\tthis.element.style.top = (parseInt(this.element.style.top) - this.element.offsetHeight - parentEl.offsetHeight - 1) + \"px\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.element.style.top = (parseInt(this.element.style.top) - this.element.offsetHeight + parentEl.offsetHeight + 1) + \"px\";\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tthis.element.style.height = offsetHeight + \"px\";\n\t\t\t}\n\t\t}\n\t}\n\t\n\tisVisible(){\n\t\treturn this.visible;\n\t}\n\t\n\thideOnBlur(callback){\n\t\tthis.blurable = true;\n\t\t\n\t\tif(this.visible){\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(this.visible){\n\t\t\t\t\tthis.table.rowManager.element.addEventListener(\"scroll\", this.blurEvent);\n\t\t\t\t\tthis.subscribe(\"cell-editing\", this.blurEvent);\n\t\t\t\t\tdocument.body.addEventListener(\"click\", this.blurEvent);\n\t\t\t\t\tdocument.body.addEventListener(\"contextmenu\", this.blurEvent);\n\t\t\t\t\tdocument.body.addEventListener(\"mousedown\", this.blurEvent);\n\t\t\t\t\twindow.addEventListener(\"resize\", this.blurEvent);\n\t\t\t\t\tdocument.body.addEventListener(\"keydown\", this.escEvent);\n\n\t\t\t\t\tthis.blurEventsBound = true;\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t\t\n\t\t\tthis.blurCallback = callback;\n\t\t}\n\t\t\n\t\treturn this;\n\t}\n\t\n\t_escapeCheck(e){\n\t\tif(e.keyCode == 27){\n\t\t\tthis.hide();\n\t\t}\n\t}\n\t\n\tblockHide(){\n\t\tthis.hideable = false;\n\t}\n\t\n\trestoreHide(){\n\t\tthis.hideable = true;\n\t}\n\t\n\thide(silent = false){\n\t\tif(this.visible && this.hideable){\n\t\t\tif(this.blurable && this.blurEventsBound){\n\t\t\t\tdocument.body.removeEventListener(\"keydown\", this.escEvent);\n\t\t\t\tdocument.body.removeEventListener(\"click\", this.blurEvent);\n\t\t\t\tdocument.body.removeEventListener(\"contextmenu\", this.blurEvent);\n\t\t\t\tdocument.body.removeEventListener(\"mousedown\", this.blurEvent);\n\t\t\t\twindow.removeEventListener(\"resize\", this.blurEvent);\n\t\t\t\tthis.table.rowManager.element.removeEventListener(\"scroll\", this.blurEvent);\n\t\t\t\tthis.unsubscribe(\"cell-editing\", this.blurEvent);\n\n\t\t\t\tthis.blurEventsBound = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(this.childPopup){\n\t\t\t\tthis.childPopup.hide();\n\t\t\t}\n\t\t\t\n\t\t\tif(this.parent){\n\t\t\t\tthis.parent.childPopup = null;\n\t\t\t}\n\t\t\t\n\t\t\tif(this.element.parentNode){\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t\t\n\t\t\tthis.visible = false;\n\t\t\t\n\t\t\tif(this.blurCallback && !silent){\n\t\t\t\tthis.blurCallback();\n\t\t\t}\n\t\t\t\n\t\t\tthis.unsubscribe(\"table-destroy\", this.destroyBinding);\n\t\t}\n\t\t\n\t\treturn this;\n\t}\n\t\n\tchild(element){\n\t\tif(this.childPopup){\n\t\t\tthis.childPopup.hide();\n\t\t}\n\t\t\n\t\tthis.childPopup = new Popup(this.table, element, this);\n\t\t\n\t\treturn this.childPopup;\n\t}\n};\n\nclass Module extends CoreFeature{\n\t\n\tconstructor(table, name){\n\t\tsuper(table);\n\t\t\n\t\tthis._handler = null;\n\t}\n\t\n\tinitialize(){\n\t\t// setup module when table is initialized, to be overridden in module\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t////// Options Registration ///////\n\t///////////////////////////////////\n\t\n\tregisterTableOption(key, value){\n\t\tthis.table.optionsList.register(key, value);\n\t}\n\t\n\tregisterColumnOption(key, value){\n\t\tthis.table.columnManager.optionsList.register(key, value);\n\t}\n\t\n\t///////////////////////////////////\n\t/// Public Function Registration ///\n\t///////////////////////////////////\n\t\n\tregisterTableFunction(name, func){\n\t\tif(typeof this.table[name] === \"undefined\"){\n\t\t\tthis.table[name] = (...args) => {\n\t\t\t\tthis.table.initGuard(name);\n\t\t\t\t\n\t\t\t\treturn func(...args);\n\t\t\t};\n\t\t}else {\n\t\t\tconsole.warn(\"Unable to bind table function, name already in use\", name);\n\t\t}\n\t}\n\t\n\tregisterComponentFunction(component, func, handler){\n\t\treturn this.table.componentFunctionBinder.bind(component, func, handler);\n\t}\n\t\n\t///////////////////////////////////\n\t////////// Data Pipeline //////////\n\t///////////////////////////////////\n\t\n\tregisterDataHandler(handler, priority){\n\t\tthis.table.rowManager.registerDataPipelineHandler(handler, priority);\n\t\tthis._handler = handler;\n\t}\n\t\n\tregisterDisplayHandler(handler, priority){\n\t\tthis.table.rowManager.registerDisplayPipelineHandler(handler, priority);\n\t\tthis._handler = handler;\n\t}\n\t\n\tdisplayRows(adjust){\n\t\tvar index = this.table.rowManager.displayRows.length - 1, \n\t\tlookupIndex;\n\t\t\n\t\tif(this._handler){\n\t\t\tlookupIndex = this.table.rowManager.displayPipeline.findIndex((item) => {\n\t\t\t\treturn item.handler === this._handler;\n\t\t\t});\n\n\t\t\tif(lookupIndex > -1){\n\t\t\t\tindex = lookupIndex;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(adjust){\n\t\t\tindex = index + adjust;\n\t\t}\n\n\t\tif(this._handler){\n\t\t\tif(index > -1){\n\t\t\t\treturn this.table.rowManager.getDisplayRows(index);\n\t\t\t}else {\n\t\t\t\treturn this.activeRows();\n\t\t\t}\n\t\t}\t\n\t}\n\t\n\tactiveRows(){\n\t\treturn this.table.rowManager.activeRows;\n\t}\n\t\n\trefreshData(renderInPosition, handler){\n\t\tif(!handler){\n\t\t\thandler = this._handler;\n\t\t}\n\t\t\n\t\tif(handler){\n\t\t\tthis.table.rowManager.refreshActiveData(handler, false, renderInPosition);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t//////// Footer Management ////////\n\t///////////////////////////////////\n\t\n\tfooterAppend(element){\n\t\treturn this.table.footerManager.append(element);\n\t}\n\t\n\tfooterPrepend(element){\n\t\treturn this.table.footerManager.prepend(element);\n\t}\n\t\n\tfooterRemove(element){\n\t\treturn this.table.footerManager.remove(element);\n\t} \n\t\n\t///////////////////////////////////\n\t//////// Popups Management ////////\n\t///////////////////////////////////\n\t\n\tpopup(menuEl, menuContainer){\n\t\treturn new Popup$1(this.table, menuEl, menuContainer);\n\t}\n\t\n\t///////////////////////////////////\n\t//////// Alert Management ////////\n\t///////////////////////////////////\n\t\n\talert(content, type){\n\t\treturn this.table.alertManager.alert(content, type);\n\t}\n\t\n\tclearAlert(){\n\t\treturn this.table.alertManager.clear();\n\t}\n\t\n}\n\nvar defaultAccessors = {\r\n\trownum:function(value, data, type, params, column, row){\r\n\t\treturn row.getPosition();\r\n\t}\r\n};\n\nclass Accessor extends Module{\n\t\n\tstatic moduleName = \"accessor\";\n\n\t//load defaults\n\tstatic accessors = defaultAccessors;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.allowedTypes = [\"\", \"data\", \"download\", \"clipboard\", \"print\", \"htmlOutput\"]; //list of accessor types\n\n\t\tthis.registerColumnOption(\"accessor\");\n\t\tthis.registerColumnOption(\"accessorParams\");\n\t\tthis.registerColumnOption(\"accessorData\");\n\t\tthis.registerColumnOption(\"accessorDataParams\");\n\t\tthis.registerColumnOption(\"accessorDownload\");\n\t\tthis.registerColumnOption(\"accessorDownloadParams\");\n\t\tthis.registerColumnOption(\"accessorClipboard\");\n\t\tthis.registerColumnOption(\"accessorClipboardParams\");\n\t\tthis.registerColumnOption(\"accessorPrint\");\n\t\tthis.registerColumnOption(\"accessorPrintParams\");\n\t\tthis.registerColumnOption(\"accessorHtmlOutput\");\n\t\tthis.registerColumnOption(\"accessorHtmlOutputParams\");\n\t}\n\n\tinitialize(){\n\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"row-data-retrieve\", this.transformRow.bind(this));\n\t}\n\n\t//initialize column accessor\n\tinitializeColumn(column){\n\t\tvar match = false,\n\t\tconfig = {};\n\n\t\tthis.allowedTypes.forEach((type) => {\n\t\t\tvar key = \"accessor\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\t\taccessor;\n\n\t\t\tif(column.definition[key]){\n\t\t\t\taccessor = this.lookupAccessor(column.definition[key]);\n\n\t\t\t\tif(accessor){\n\t\t\t\t\tmatch = true;\n\n\t\t\t\t\tconfig[key] = {\n\t\t\t\t\t\taccessor:accessor,\n\t\t\t\t\t\tparams: column.definition[key + \"Params\"] || {},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(match){\n\t\t\tcolumn.modules.accessor = config;\n\t\t}\n\t}\n\n\tlookupAccessor(value){\n\t\tvar accessor = false;\n\n\t\t//set column accessor\n\t\tswitch(typeof value){\n\t\t\tcase \"string\":\n\t\t\t\tif(Accessor.accessors[value]){\n\t\t\t\t\taccessor = Accessor.accessors[value];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Accessor Error - No such accessor found, ignoring: \", value);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\taccessor = value;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn accessor;\n\t}\n\n\t//apply accessor to row\n\ttransformRow(row, type){\n\t\tvar key = \"accessor\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\trowComponent = row.getComponent();\n\n\t\t//clone data object with deep copy to isolate internal data from returned result\n\t\tvar data = Helpers.deepClone(row.data || {});\n\n\t\tthis.table.columnManager.traverse(function(column){\n\t\t\tvar value, accessor, params, colComponent;\n\n\t\t\tif(column.modules.accessor){\n\n\t\t\t\taccessor = column.modules.accessor[key] || column.modules.accessor.accessor || false;\n\n\t\t\t\tif(accessor){\n\t\t\t\t\tvalue = column.getFieldValue(data);\n\n\t\t\t\t\tif(value != \"undefined\"){\n\t\t\t\t\t\tcolComponent = column.getComponent();\n\t\t\t\t\t\tparams = typeof accessor.params === \"function\" ? accessor.params(value, data, type, colComponent, rowComponent) : accessor.params;\n\t\t\t\t\t\tcolumn.setFieldValue(data, accessor.accessor(value, data, type, params, colComponent, rowComponent));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn data;\n\t}\n}\n\nvar defaultConfig = {\n\tmethod: \"GET\",\n};\n\nfunction generateParamsList$1(data, prefix){\n\tvar output = [];\n\n\tprefix = prefix || \"\";\n\n\tif(Array.isArray(data)){\n\t\tdata.forEach((item, i) => {\n\t\t\toutput = output.concat(generateParamsList$1(item, prefix ? prefix + \"[\" + i + \"]\" : i));\n\t\t});\n\t}else if (typeof data === \"object\"){\n\t\tfor (var key in data){\n\t\t\toutput = output.concat(generateParamsList$1(data[key], prefix ? prefix + \"[\" + key + \"]\" : key));\n\t\t}\n\t}else {\n\t\toutput.push({key:prefix, value:data});\n\t}\n\n\treturn output;\n}\n\nfunction serializeParams(params){\n\tvar output = generateParamsList$1(params),\n\tencoded = [];\n\n\toutput.forEach(function(item){\n\t\tencoded.push(encodeURIComponent(item.key) + \"=\" + encodeURIComponent(item.value));\n\t});\n\n\treturn encoded.join(\"&\");\n}\n\nfunction urlBuilder(url, config, params){\n\tif(url){\n\t\tif(params && Object.keys(params).length){\n\t\t\tif(!config.method || config.method.toLowerCase() == \"get\"){\n\t\t\t\tconfig.method = \"get\";\n\n\t\t\t\turl += (url.includes(\"?\") ? \"&\" : \"?\") + serializeParams(params);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn url;\n}\n\nfunction defaultLoaderPromise(url, config, params){\n\tvar contentType;\n\n\treturn new Promise((resolve, reject) => {\n\t\t//set url\n\t\turl = this.urlGenerator.call(this.table, url, config, params);\n\n\t\t//set body content if not GET request\n\t\tif(config.method.toUpperCase() != \"GET\"){\n\t\t\tcontentType = typeof this.table.options.ajaxContentType === \"object\" ?  this.table.options.ajaxContentType : this.contentTypeFormatters[this.table.options.ajaxContentType];\n\t\t\tif(contentType){\n\n\t\t\t\tfor(var key in contentType.headers){\n\t\t\t\t\tif(!config.headers){\n\t\t\t\t\t\tconfig.headers = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tif(typeof config.headers[key] === \"undefined\"){\n\t\t\t\t\t\tconfig.headers[key] = contentType.headers[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconfig.body = contentType.body.call(this, url, config, params);\n\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Ajax Error - Invalid ajaxContentType value:\", this.table.options.ajaxContentType);\n\t\t\t}\n\t\t}\n\n\t\tif(url){\n\t\t\t//configure headers\n\t\t\tif(typeof config.headers === \"undefined\"){\n\t\t\t\tconfig.headers = {};\n\t\t\t}\n\n\t\t\tif(typeof config.headers.Accept === \"undefined\"){\n\t\t\t\tconfig.headers.Accept = \"application/json\";\n\t\t\t}\n\n\t\t\tif(typeof config.headers[\"X-Requested-With\"] === \"undefined\"){\n\t\t\t\tconfig.headers[\"X-Requested-With\"] = \"XMLHttpRequest\";\n\t\t\t}\n\n\t\t\tif(typeof config.mode === \"undefined\"){\n\t\t\t\tconfig.mode = \"cors\";\n\t\t\t}\n\n\t\t\tif(config.mode == \"cors\"){\n\t\t\t\tif(typeof config.headers[\"Origin\"] === \"undefined\"){\n\t\t\t\t\tconfig.headers[\"Origin\"] = window.location.origin;\n\t\t\t\t}\n        \n\t\t\t\tif(typeof config.credentials === \"undefined\"){\n\t\t\t\t\tconfig.credentials = 'same-origin';\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(typeof config.credentials === \"undefined\"){\n\t\t\t\t\tconfig.credentials = 'include';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//send request\n\t\t\tfetch(url, config)\n\t\t\t\t.then((response)=>{\n\t\t\t\t\tif(response.ok) {\n\t\t\t\t\t\tresponse.json()\n\t\t\t\t\t\t\t.then((data)=>{\n\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t}).catch((error)=>{\n\t\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t\t\tconsole.warn(\"Ajax Load Error - Invalid JSON returned\", error);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.error(\"Ajax Load Error - Connection Error: \" + response.status, response.statusText);\n\t\t\t\t\t\treject(response);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error)=>{\n\t\t\t\t\tconsole.error(\"Ajax Load Error - Connection Error: \", error);\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t}else {\n\t\t\tconsole.warn(\"Ajax Load Error - No URL Set\");\n\t\t\tresolve([]);\n\t\t}\n\t});\n}\n\nfunction generateParamsList(data, prefix){\n\tvar output = [];\n\n\tprefix = prefix || \"\";\n\n\tif(Array.isArray(data)){\n\t\tdata.forEach((item, i) => {\n\t\t\toutput = output.concat(generateParamsList(item, prefix ? prefix + \"[\" + i + \"]\" : i));\n\t\t});\n\t}else if (typeof data === \"object\"){\n\t\tfor (var key in data){\n\t\t\toutput = output.concat(generateParamsList(data[key], prefix ? prefix + \"[\" + key + \"]\" : key));\n\t\t}\n\t}else {\n\t\toutput.push({key:prefix, value:data});\n\t}\n\n\treturn output;\n}\n\nvar defaultContentTypeFormatters = {\n\t\"json\":{\n\t\theaders:{\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody:function(url, config, params){\n\t\t\treturn JSON.stringify(params);\n\t\t},\n\t},\n\t\"form\":{\n\t\theaders:{\n\t\t},\n\t\tbody:function(url, config, params){\n\n\t\t\tvar output = generateParamsList(params),\n\t\t\tform = new FormData();\n\n\t\t\toutput.forEach(function(item){\n\t\t\t\tform.append(item.key, item.value);\n\t\t\t});\n\n\t\t\treturn form;\n\t\t},\n\t},\n};\n\nclass Ajax extends Module{\n\n\tstatic moduleName = \"ajax\";\n\n\t//load defaults\n\tstatic defaultConfig = defaultConfig;\n\tstatic defaultURLGenerator = urlBuilder;\n\tstatic defaultLoaderPromise = defaultLoaderPromise;\n\tstatic contentTypeFormatters = defaultContentTypeFormatters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.config = {}; //hold config object for ajax request\n\t\tthis.url = \"\"; //request URL\n\t\tthis.urlGenerator = false;\n\t\tthis.params = false; //request parameters\n\t\t\n\t\tthis.loaderPromise = false;\n\t\t\n\t\tthis.registerTableOption(\"ajaxURL\", false); //url for ajax loading\n\t\tthis.registerTableOption(\"ajaxURLGenerator\", false);\n\t\tthis.registerTableOption(\"ajaxParams\", {});  //params for ajax loading\n\t\tthis.registerTableOption(\"ajaxConfig\", \"get\"); //ajax request type\n\t\tthis.registerTableOption(\"ajaxContentType\", \"form\"); //ajax request type\n\t\tthis.registerTableOption(\"ajaxRequestFunc\", false); //promise function\n\t\t\n\t\tthis.registerTableOption(\"ajaxRequesting\", function(){});\n\t\tthis.registerTableOption(\"ajaxResponse\", false);\n\t\t\n\t\tthis.contentTypeFormatters = Ajax.contentTypeFormatters;\n\t}\n\t\n\t//initialize setup options\n\tinitialize(){\n\t\tthis.loaderPromise = this.table.options.ajaxRequestFunc || Ajax.defaultLoaderPromise;\n\t\tthis.urlGenerator = this.table.options.ajaxURLGenerator || Ajax.defaultURLGenerator;\n\t\t\n\t\tif(this.table.options.ajaxURL){\n\t\t\tthis.setUrl(this.table.options.ajaxURL);\n\t\t}\n\n\n\t\tthis.setDefaultConfig(this.table.options.ajaxConfig);\n\t\t\n\t\tthis.registerTableFunction(\"getAjaxUrl\", this.getUrl.bind(this));\n\t\t\n\t\tthis.subscribe(\"data-loading\", this.requestDataCheck.bind(this));\n\t\tthis.subscribe(\"data-params\", this.requestParams.bind(this));\n\t\tthis.subscribe(\"data-load\", this.requestData.bind(this));\n\t}\n\t\n\trequestParams(data, config, silent, params){\n\t\tvar ajaxParams = this.table.options.ajaxParams;\n\t\t\n\t\tif(ajaxParams){\n\t\t\tif(typeof ajaxParams === \"function\"){\n\t\t\t\tajaxParams = ajaxParams.call(this.table);\n\t\t\t}\n\t\t\t\n\t\t\tparams = Object.assign(Object.assign({}, ajaxParams), params);\n\t\t}\t\t\n\t\t\n\t\treturn params;\n\t}\n\t\n\trequestDataCheck(data, params, config, silent){\n\t\treturn !!((!data && this.url) || typeof data === \"string\");\n\t}\n\t\n\trequestData(url, params, config, silent, previousData){\n\t\tvar ajaxConfig;\n\t\t\n\t\tif(!previousData && this.requestDataCheck(url)){\n\t\t\tif(url){\n\t\t\t\tthis.setUrl(url);\n\t\t\t}\n\t\t\t\n\t\t\tajaxConfig = this.generateConfig(config);\n\t\t\t\n\t\t\treturn this.sendRequest(this.url, params, ajaxConfig);\n\t\t}else {\n\t\t\treturn previousData;\n\t\t}\n\t}\n\t\n\tsetDefaultConfig(config = {}){\n\t\tthis.config = Object.assign({}, Ajax.defaultConfig);\n\n\t\tif(typeof config == \"string\"){\n\t\t\tthis.config.method = config;\n\t\t}else {\n\t\t\tObject.assign(this.config, config);\n\t\t}\n\t}\n\t\n\t//load config object\n\tgenerateConfig(config = {}){\n\t\tvar ajaxConfig = Object.assign({}, this.config);\n\t\t\n\t\tif(typeof config == \"string\"){\n\t\t\tajaxConfig.method = config;\n\t\t}else {\n\t\t\tObject.assign(ajaxConfig, config);\n\t\t}\n\t\t\n\t\treturn ajaxConfig;\n\t}\n\t\n\t//set request url\n\tsetUrl(url){\n\t\tthis.url = url;\n\t}\n\t\n\t//get request url\n\tgetUrl(){\n\t\treturn this.url;\n\t}\n\t\n\t//send ajax request\n\tsendRequest(url, params, config){\n\t\tif(this.table.options.ajaxRequesting.call(this.table, url, params) !== false){\n\t\t\treturn this.loaderPromise(url, config, params)\n\t\t\t\t.then((data)=>{\n\t\t\t\t\tif(this.table.options.ajaxResponse){\n\t\t\t\t\t\tdata = this.table.options.ajaxResponse.call(this.table, url, params, data);\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\treturn data;\n\t\t\t\t});\n\t\t}else {\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n}\n\nvar defaultPasteActions = {\n\treplace:function(data){\n\t\treturn this.table.setData(data);\n\t},\n\tupdate:function(data){\n\t\treturn this.table.updateOrAddData(data);\n\t},\n\tinsert:function(data){\n\t\treturn this.table.addData(data);\n\t},\n};\n\nvar defaultPasteParsers = {\n\ttable:function(clipboard){\n\t\tvar data = [],\n\t\theaderFindSuccess = true,\n\t\tcolumns = this.table.columnManager.columns,\n\t\tcolumnMap = [],\n\t\trows = [];\n\t\t\n\t\t//get data from clipboard into array of columns and rows.\n\t\tclipboard = clipboard.split(\"\\n\");\n\t\t\n\t\tclipboard.forEach(function(row){\n\t\t\tdata.push(row.split(\"\\t\"));\n\t\t});\n\t\t\n\t\tif(data.length && !(data.length === 1 && data[0].length < 2)){\n\t\t\t\n\t\t\t//check if headers are present by title\n\t\t\tdata[0].forEach(function(value){\n\t\t\t\tvar column = columns.find(function(column){\n\t\t\t\t\treturn value && column.definition.title && value.trim() && column.definition.title.trim() === value.trim();\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(column){\n\t\t\t\t\tcolumnMap.push(column);\n\t\t\t\t}else {\n\t\t\t\t\theaderFindSuccess = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t//check if column headers are present by field\n\t\t\tif(!headerFindSuccess){\n\t\t\t\theaderFindSuccess = true;\n\t\t\t\tcolumnMap = [];\n\t\t\t\t\n\t\t\t\tdata[0].forEach(function(value){\n\t\t\t\t\tvar column = columns.find(function(column){\n\t\t\t\t\t\treturn value && column.field && value.trim() && column.field.trim() === value.trim();\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif(column){\n\t\t\t\t\t\tcolumnMap.push(column);\n\t\t\t\t\t}else {\n\t\t\t\t\t\theaderFindSuccess = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(!headerFindSuccess){\n\t\t\t\t\tcolumnMap = this.table.columnManager.columnsByIndex;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//remove header row if found\n\t\t\tif(headerFindSuccess){\n\t\t\t\tdata.shift();\n\t\t\t}\n\t\t\t\n\t\t\tdata.forEach(function(item){\n\t\t\t\tvar row = {};\n\t\t\t\t\n\t\t\t\titem.forEach(function(value, i){\n\t\t\t\t\tif(columnMap[i]){\n\t\t\t\t\t\trow[columnMap[i].field] = value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\trows.push(row);\n\t\t\t});\n\t\t\t\n\t\t\treturn rows;\n\t\t}else {\n\t\t\treturn false;\n\t\t}\n\t},\n};\n\nvar bindings$2 = {\r\n\tcopyToClipboard:[\"ctrl + 67\", \"meta + 67\"],\r\n};\n\nvar actions$2 = {\r\n\tcopyToClipboard:function(e){\r\n\t\tif(!this.table.modules.edit.currentCell){\r\n\t\t\tif(this.table.modExists(\"clipboard\", true)){\r\n\t\t\t\tthis.table.modules.clipboard.copy(false, true);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n};\n\nvar extensions$4 = {\r\n\tkeybindings:{\r\n\t\tbindings:bindings$2,\r\n\t\tactions:actions$2\r\n\t},\r\n};\n\nclass Clipboard extends Module{\n\n\tstatic moduleName = \"clipboard\";\n\tstatic moduleExtensions = extensions$4;\n\n\t//load defaults\n\tstatic pasteActions = defaultPasteActions;\n\tstatic pasteParsers = defaultPasteParsers;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.mode = true;\n\t\tthis.pasteParser = function(){};\n\t\tthis.pasteAction = function(){};\n\t\tthis.customSelection = false;\n\t\tthis.rowRange = false;\n\t\tthis.blocked = true; //block copy actions not originating from this command\n\n\t\tthis.registerTableOption(\"clipboard\", false); //enable clipboard\n\t\tthis.registerTableOption(\"clipboardCopyStyled\", true); //formatted table data\n\t\tthis.registerTableOption(\"clipboardCopyConfig\", false); //clipboard config\n\t\tthis.registerTableOption(\"clipboardCopyFormatter\", false); //DEPRECATED - REMOVE in 5.0\n\t\tthis.registerTableOption(\"clipboardCopyRowRange\", \"active\"); //restrict clipboard to visible rows only\n\t\tthis.registerTableOption(\"clipboardPasteParser\", \"table\"); //convert pasted clipboard data to rows\n\t\tthis.registerTableOption(\"clipboardPasteAction\", \"insert\"); //how to insert pasted data into the table\n\n\t\tthis.registerColumnOption(\"clipboard\");\n\t\tthis.registerColumnOption(\"titleClipboard\");\n\t}\n\n\tinitialize(){\n\t\tthis.mode = this.table.options.clipboard;\n\n\t\tthis.rowRange = this.table.options.clipboardCopyRowRange;\n\n\t\tif(this.mode === true || this.mode === \"copy\"){\n\t\t\tthis.table.element.addEventListener(\"copy\", (e) => {\n\t\t\t\tvar plain, html, list;\n\n\t\t\t\tif(!this.blocked){\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif(this.customSelection){\n\t\t\t\t\t\tplain = this.customSelection;\n\n\t\t\t\t\t\tif(this.table.options.clipboardCopyFormatter){\n\t\t\t\t\t\t\tplain = this.table.options.clipboardCopyFormatter(\"plain\", plain);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\n\t\t\t\t\t\tlist = this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig, this.table.options.clipboardCopyStyled, this.rowRange, \"clipboard\");\n\n\t\t\t\t\t\thtml = this.table.modules.export.generateHTMLTable(list);\n\t\t\t\t\t\tplain = html ? this.generatePlainContent(list) : \"\";\n\n\t\t\t\t\t\tif(this.table.options.clipboardCopyFormatter){\n\t\t\t\t\t\t\tplain = this.table.options.clipboardCopyFormatter(\"plain\", plain);\n\t\t\t\t\t\t\thtml = this.table.options.clipboardCopyFormatter(\"html\", html);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (window.clipboardData && window.clipboardData.setData) {\n\t\t\t\t\t\twindow.clipboardData.setData('Text', plain);\n\t\t\t\t\t} else if (e.clipboardData && e.clipboardData.setData) {\n\t\t\t\t\t\te.clipboardData.setData('text/plain', plain);\n\t\t\t\t\t\tif(html){\n\t\t\t\t\t\t\te.clipboardData.setData('text/html', html);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (e.originalEvent && e.originalEvent.clipboardData.setData) {\n\t\t\t\t\t\te.originalEvent.clipboardData.setData('text/plain', plain);\n\t\t\t\t\t\tif(html){\n\t\t\t\t\t\t\te.originalEvent.clipboardData.setData('text/html', html);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.dispatchExternal(\"clipboardCopied\", plain, html);\n\n\t\t\t\t\tthis.reset();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif(this.mode === true || this.mode === \"paste\"){\n\t\t\tthis.table.element.addEventListener(\"paste\", (e) => {\n\t\t\t\tthis.paste(e);\n\t\t\t});\n\t\t}\n\n\t\tthis.setPasteParser(this.table.options.clipboardPasteParser);\n\t\tthis.setPasteAction(this.table.options.clipboardPasteAction);\n\n\t\tthis.registerTableFunction(\"copyToClipboard\", this.copy.bind(this));\n\t}\n\n\treset(){\n\t\tthis.blocked = true;\n\t\tthis.customSelection = false;\n\t}\n\n\tgeneratePlainContent (list) {\n\t\tvar output = [];\n\n\t\tlist.forEach((row) => {\n\t\t\tvar rowData = [];\n\n\t\t\trow.columns.forEach((col) => {\n\t\t\t\tvar value = \"\";\n\n\t\t\t\tif(col){\n\n\t\t\t\t\tif(row.type === \"group\"){\n\t\t\t\t\t\tcol.value = col.component.getKey();\n\t\t\t\t\t}\n\n\t\t\t\t\tif(col.value === null){\n\t\t\t\t\t\tvalue = \"\";\n\t\t\t\t\t}else {\n\t\t\t\t\t\tswitch(typeof col.value){\n\t\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\t\tvalue = JSON.stringify(col.value);\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\t\tvalue = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tvalue = col.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trowData.push(value);\n\t\t\t});\n\n\t\t\toutput.push(rowData.join(\"\\t\"));\n\t\t});\n\n\t\treturn output.join(\"\\n\");\n\t}\n\n\tcopy (range, internal) {\n\t\tvar sel, textRange;\n\t\tthis.blocked = false;\n\t\tthis.customSelection = false;\n\t\n\n\t\tif (this.mode === true || this.mode === \"copy\") {\n\n\t\t\tthis.rowRange = range || this.table.options.clipboardCopyRowRange;\n\n\t\t\tif (typeof window.getSelection != \"undefined\" && typeof document.createRange != \"undefined\") {\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.selectNodeContents(this.table.element);\n\t\t\t\tsel = window.getSelection();\n\n\t\t\t\tif (sel.toString() && internal) {\n\t\t\t\t\tthis.customSelection = sel.toString();\n\t\t\t\t}\n\n\t\t\t\tsel.removeAllRanges();\n\t\t\t\tsel.addRange(range);\n\t\t\t} else if (typeof document.selection != \"undefined\" && typeof document.body.createTextRange != \"undefined\") {\n\t\t\t\ttextRange = document.body.createTextRange();\n\t\t\t\ttextRange.moveToElementText(this.table.element);\n\t\t\t\ttextRange.select();\n\t\t\t}\n\n\t\t\tdocument.execCommand('copy');\n\n\t\t\tif (sel) {\n\t\t\t\tsel.removeAllRanges();\n\t\t\t}\n\t\t}\n\t}\n\n\t//PASTE EVENT HANDLING\n\tsetPasteAction(action){\n\n\t\tswitch(typeof action){\n\t\t\tcase \"string\":\n\t\t\t\tthis.pasteAction = Clipboard.pasteActions[action];\n\n\t\t\t\tif(!this.pasteAction){\n\t\t\t\t\tconsole.warn(\"Clipboard Error - No such paste action found:\", action);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tthis.pasteAction = action;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetPasteParser(parser){\n\t\tswitch(typeof parser){\n\t\t\tcase \"string\":\n\t\t\t\tthis.pasteParser = Clipboard.pasteParsers[parser];\n\n\t\t\t\tif(!this.pasteParser){\n\t\t\t\t\tconsole.warn(\"Clipboard Error - No such paste parser found:\", parser);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tthis.pasteParser = parser;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpaste(e){\n\t\tvar data, rowData, rows;\n\n\t\tif(this.checkPasteOrigin(e)){\n\n\t\t\tdata = this.getPasteData(e);\n\n\t\t\trowData = this.pasteParser.call(this, data);\n\n\t\t\tif(rowData){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tif(this.table.modExists(\"mutator\")){\n\t\t\t\t\trowData = this.mutateData(rowData);\n\t\t\t\t}\n\n\t\t\t\trows = this.pasteAction.call(this, rowData);\n\n\t\t\t\tthis.dispatchExternal(\"clipboardPasted\", data, rowData, rows);\n\t\t\t}else {\n\t\t\t\tthis.dispatchExternal(\"clipboardPasteError\", data);\n\t\t\t}\n\t\t}\n\t}\n\n\tmutateData(data){\n\t\tvar output = [];\n\n\t\tif(Array.isArray(data)){\n\t\t\tdata.forEach((row) => {\n\t\t\t\toutput.push(this.table.modules.mutator.transformRow(row, \"clipboard\"));\n\t\t\t});\n\t\t}else {\n\t\t\toutput = data;\n\t\t}\n\n\t\treturn output;\n\t}\n\n\n\tcheckPasteOrigin(e){\n\t\tvar valid = true;\n\t\tvar blocked = this.confirm(\"clipboard-paste\", [e]);\n\n\t\tif(blocked || ![\"DIV\", \"SPAN\"].includes(e.target.tagName)){\n\t\t\tvalid = false;\n\t\t}\n\n\t\treturn valid;\n\t}\n\n\tgetPasteData(e){\n\t\tvar data;\n\n\t\tif (window.clipboardData && window.clipboardData.getData) {\n\t\t\tdata = window.clipboardData.getData('Text');\n\t\t} else if (e.clipboardData && e.clipboardData.getData) {\n\t\t\tdata = e.clipboardData.getData('text/plain');\n\t\t} else if (e.originalEvent && e.originalEvent.clipboardData.getData) {\n\t\t\tdata = e.originalEvent.clipboardData.getData('text/plain');\n\t\t}\n\n\t\treturn data;\n\t}\n}\n\nclass CalcComponent{\n\tconstructor (row){\n\t\tthis._row = row;\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._row.table.componentFunctionBinder.handle(\"row\", target._row, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetData(transform){\n\t\treturn this._row.getData(transform);\n\t}\n\n\tgetElement(){\n\t\treturn this._row.getElement();\n\t}\n\n\tgetTable(){\n\t\treturn this._row.table;\n\t}\n\n\tgetCells(){\n\t\tvar cells = [];\n\n\t\tthis._row.getCells().forEach(function(cell){\n\t\t\tcells.push(cell.getComponent());\n\t\t});\n\n\t\treturn cells;\n\t}\n\n\tgetCell(column){\n\t\tvar cell = this._row.getCell(column);\n\t\treturn cell ? cell.getComponent() : false;\n\t}\n\n\t_getSelf(){\n\t\treturn this._row;\n\t}\n}\n\n//public cell object\nclass CellComponent {\n\n\tconstructor (cell){\n\t\tthis._cell = cell;\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._cell.table.componentFunctionBinder.handle(\"cell\", target._cell, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetValue(){\n\t\treturn this._cell.getValue();\n\t}\n\n\tgetOldValue(){\n\t\treturn this._cell.getOldValue();\n\t}\n\n\tgetInitialValue(){\n\t\treturn this._cell.initialValue;\n\t}\n\n\tgetElement(){\n\t\treturn this._cell.getElement();\n\t}\n\n\tgetRow(){\n\t\treturn this._cell.row.getComponent();\n\t}\n\n\tgetData(transform){\n\t\treturn this._cell.row.getData(transform);\n\t}\n\tgetType(){\n\t\treturn \"cell\";\n\t}\n\tgetField(){\n\t\treturn this._cell.column.getField();\n\t}\n\n\tgetColumn(){\n\t\treturn this._cell.column.getComponent();\n\t}\n\n\tsetValue(value, mutate){\n\t\tif(typeof mutate == \"undefined\"){\n\t\t\tmutate = true;\n\t\t}\n\n\t\tthis._cell.setValue(value, mutate);\n\t}\n\n\trestoreOldValue(){\n\t\tthis._cell.setValueActual(this._cell.getOldValue());\n\t}\n\n\trestoreInitialValue(){\n\t\tthis._cell.setValueActual(this._cell.initialValue);\n\t}\n\n\tcheckHeight(){\n\t\tthis._cell.checkHeight();\n\t}\n\n\tgetTable(){\n\t\treturn this._cell.table;\n\t}\n\n\t_getSelf(){\n\t\treturn this._cell;\n\t}\n}\n\nclass Cell extends CoreFeature{\n\tconstructor(column, row){\n\t\tsuper(column.table);\n\n\t\tthis.table = column.table;\n\t\tthis.column = column;\n\t\tthis.row = row;\n\t\tthis.element = null;\n\t\tthis.value = null;\n\t\tthis.initialValue;\n\t\tthis.oldValue = null;\n\t\tthis.modules = {};\n\n\t\tthis.height = null;\n\t\tthis.width = null;\n\t\tthis.minWidth = null;\n\n\t\tthis.component = null;\n\n\t\tthis.loaded = false; //track if the cell has been added to the DOM yet\n\n\t\tthis.build();\n\t}\n\n\t//////////////// Setup Functions /////////////////\n\t//generate element\n\tbuild(){\n\t\tthis.generateElement();\n\n\t\tthis.setWidth();\n\n\t\tthis._configureCell();\n\n\t\tthis.setValueActual(this.column.getFieldValue(this.row.data));\n\n\t\tthis.initialValue = this.value;\n\t}\n\n\tgenerateElement(){\n\t\tthis.element = document.createElement('div');\n\t\tthis.element.className = \"tabulator-cell\";\n\t\tthis.element.setAttribute(\"role\", \"gridcell\");\n\n\t\tif(this.column.isRowHeader){\n\t\t\tthis.element.classList.add(\"tabulator-row-header\");\n\t\t}\n\t}\n\n\t_configureCell(){\n\t\tvar element = this.element,\n\t\tfield = this.column.getField(),\n\t\tvertAligns = {\n\t\t\ttop:\"flex-start\",\n\t\t\tbottom:\"flex-end\",\n\t\t\tmiddle:\"center\",\n\t\t},\n\t\thozAligns = {\n\t\t\tleft:\"flex-start\",\n\t\t\tright:\"flex-end\",\n\t\t\tcenter:\"center\",\n\t\t};\n\n\t\t//set text alignment\n\t\telement.style.textAlign = this.column.hozAlign;\n\n\t\tif(this.column.vertAlign){\n\t\t\telement.style.display = \"inline-flex\";\n\n\t\t\telement.style.alignItems = vertAligns[this.column.vertAlign] || \"\";\n\n\t\t\tif(this.column.hozAlign){\n\t\t\t\telement.style.justifyContent = hozAligns[this.column.hozAlign] || \"\";\n\t\t\t}\n\t\t}\n\n\t\tif(field){\n\t\t\telement.setAttribute(\"tabulator-field\", field);\n\t\t}\n\n\t\t//add class to cell if needed\n\t\tif(this.column.definition.cssClass){\n\t\t\tvar classNames = this.column.definition.cssClass.split(\" \");\n\t\t\tclassNames.forEach((className) => {\n\t\t\t\telement.classList.add(className);\n\t\t\t});\n\t\t}\n\n\t\tthis.dispatch(\"cell-init\", this);\n\n\t\t//hide cell if not visible\n\t\tif(!this.column.visible){\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\t//generate cell contents\n\t_generateContents(){\n\t\tvar val;\n\n\t\tval = this.chain(\"cell-format\", this, null, () => {\n\t\t\treturn this.element.innerHTML = this.value;\n\t\t});\n\n\t\tswitch(typeof val){\n\t\t\tcase \"object\":\n\t\t\t\tif(val instanceof Node){\n\n\t\t\t\t\t//clear previous cell contents\n\t\t\t\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\n\t\t\t\t\tthis.element.appendChild(val);\n\t\t\t\t}else {\n\t\t\t\t\tthis.element.innerHTML = \"\";\n\n\t\t\t\t\tif(val != null){\n\t\t\t\t\t\tconsole.warn(\"Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:\", val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"undefined\":\n\t\t\t\tthis.element.innerHTML = \"\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.element.innerHTML = val;\n\t\t}\n\t}\n\n\tcellRendered(){\n\t\tthis.dispatch(\"cell-rendered\", this);\n\t}\n\n\t//////////////////// Getters ////////////////////\n\tgetElement(containerOnly){\n\t\tif(!this.loaded){\n\t\t\tthis.loaded = true;\n\t\t\tif(!containerOnly){\n\t\t\t\tthis.layoutElement();\n\t\t\t}\n\t\t}\n\n\t\treturn this.element;\n\t}\n\n\tgetValue(){\n\t\treturn this.value;\n\t}\n\n\tgetOldValue(){\n\t\treturn this.oldValue;\n\t}\n\n\t//////////////////// Actions ////////////////////\n\tsetValue(value, mutate, force){\n\t\tvar changed = this.setValueProcessData(value, mutate, force);\n\n\t\tif(changed){\n\t\t\tthis.dispatch(\"cell-value-updated\", this);\n\n\t\t\tthis.cellRendered();\n\n\t\t\tif(this.column.definition.cellEdited){\n\t\t\t\tthis.column.definition.cellEdited.call(this.table, this.getComponent());\n\t\t\t}\n\n\t\t\tthis.dispatchExternal(\"cellEdited\", this.getComponent());\n\n\t\t\tif(this.subscribedExternal(\"dataChanged\")){\n\t\t\t\tthis.dispatchExternal(\"dataChanged\", this.table.rowManager.getData());\n\t\t\t}\n\t\t}\n\t}\n\n\tsetValueProcessData(value, mutate, force){\n\t\tvar changed = false;\n\n\t\tif(this.value !== value || force){\n\n\t\t\tchanged = true;\n\n\t\t\tif(mutate){\n\t\t\t\tvalue = this.chain(\"cell-value-changing\", [this, value], null, value);\n\t\t\t}\n\t\t}\n\n\t\tthis.setValueActual(value);\n\n\t\tif(changed){\n\t\t\tthis.dispatch(\"cell-value-changed\", this);\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\tsetValueActual(value){\n\t\tthis.oldValue = this.value;\n\n\t\tthis.value = value;\n\n\t\tthis.dispatch(\"cell-value-save-before\", this);\n\n\t\tthis.column.setFieldValue(this.row.data, value);\n\n\t\tthis.dispatch(\"cell-value-save-after\", this);\n\n\t\tif(this.loaded){\n\t\t\tthis.layoutElement();\n\t\t}\n\t}\n\n\tlayoutElement(){\n\t\tthis._generateContents();\n\n\t\tthis.dispatch(\"cell-layout\", this);\n\t}\n\n\tsetWidth(){\n\t\tthis.width = this.column.width;\n\t\tthis.element.style.width = this.column.widthStyled;\n\t}\n\n\tclearWidth(){\n\t\tthis.width = \"\";\n\t\tthis.element.style.width = \"\";\n\t}\n\n\tgetWidth(){\n\t\treturn this.width || this.element.offsetWidth;\n\t}\n\n\tsetMinWidth(){\n\t\tthis.minWidth = this.column.minWidth;\n\t\tthis.element.style.minWidth = this.column.minWidthStyled;\n\t}\n\n\tsetMaxWidth(){\n\t\tthis.maxWidth = this.column.maxWidth;\n\t\tthis.element.style.maxWidth = this.column.maxWidthStyled;\n\t}\n\n\tcheckHeight(){\n\t\t// var height = this.element.css(\"height\");\n\t\tthis.row.reinitializeHeight();\n\t}\n\n\tclearHeight(){\n\t\tthis.element.style.height = \"\";\n\t\tthis.height = null;\n\n\t\tthis.dispatch(\"cell-height\", this, \"\");\n\t}\n\n\tsetHeight(){\n\t\tthis.height = this.row.height;\n\t\tthis.element.style.height = this.row.heightStyled;\n\n\t\tthis.dispatch(\"cell-height\", this, this.row.heightStyled);\n\t}\n\n\tgetHeight(){\n\t\treturn this.height || this.element.offsetHeight;\n\t}\n\n\tshow(){\n\t\tthis.element.style.display = this.column.vertAlign ? \"inline-flex\" : \"\";\n\t}\n\n\thide(){\n\t\tthis.element.style.display = \"none\";\n\t}\n\n\tdelete(){\n\t\tthis.dispatch(\"cell-delete\", this);\n\n\t\tif(!this.table.rowManager.redrawBlock && this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n\n\t\tthis.element = false;\n\t\tthis.column.deleteCell(this);\n\t\tthis.row.deleteCell(this);\n\t\tthis.calcs = {};\n\t}\n\n\tgetIndex(){\n\t\treturn this.row.getCellIndex(this);\n\t}\n\n\t//////////////// Object Generation /////////////////\n\tgetComponent(){\n\t\tif(!this.component){\n\t\t\tthis.component = new CellComponent(this);\n\t\t}\n\n\t\treturn this.component;\n\t}\n}\n\n//public column object\nclass ColumnComponent {\n\tconstructor (column){\n\t\tthis._column = column;\n\t\tthis.type = \"ColumnComponent\";\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._column.table.componentFunctionBinder.handle(\"column\", target._column, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetElement(){\n\t\treturn this._column.getElement();\n\t}\n\n\tgetDefinition(){\n\t\treturn this._column.getDefinition();\n\t}\n\n\tgetField(){\n\t\treturn this._column.getField();\n\t}\n\n\tgetTitleDownload() {\n\t\treturn this._column.getTitleDownload();\n\t}\n\n\tgetCells(){\n\t\tvar cells = [];\n\n\t\tthis._column.cells.forEach(function(cell){\n\t\t\tcells.push(cell.getComponent());\n\t\t});\n\n\t\treturn cells;\n\t}\n\n\tisVisible(){\n\t\treturn this._column.visible;\n\t}\n\n\tshow(){\n\t\tif(this._column.isGroup){\n\t\t\tthis._column.columns.forEach(function(column){\n\t\t\t\tcolumn.show();\n\t\t\t});\n\t\t}else {\n\t\t\tthis._column.show();\n\t\t}\n\t}\n\n\thide(){\n\t\tif(this._column.isGroup){\n\t\t\tthis._column.columns.forEach(function(column){\n\t\t\t\tcolumn.hide();\n\t\t\t});\n\t\t}else {\n\t\t\tthis._column.hide();\n\t\t}\n\t}\n\n\ttoggle(){\n\t\tif(this._column.visible){\n\t\t\tthis.hide();\n\t\t}else {\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\tdelete(){\n\t\treturn this._column.delete();\n\t}\n\n\tgetSubColumns(){\n\t\tvar output = [];\n\n\t\tif(this._column.columns.length){\n\t\t\tthis._column.columns.forEach(function(column){\n\t\t\t\toutput.push(column.getComponent());\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tgetParentColumn(){\n\t\treturn this._column.getParentComponent();\n\t}\n\n\t_getSelf(){\n\t\treturn this._column;\n\t}\n\n\tscrollTo(position, ifVisible){\n\t\treturn this._column.table.columnManager.scrollToColumn(this._column, position, ifVisible);\n\t}\n\n\tgetTable(){\n\t\treturn this._column.table;\n\t}\n\n\tmove(to, after){\n\t\tvar toColumn = this._column.table.columnManager.findColumn(to);\n\n\t\tif(toColumn){\n\t\t\tthis._column.table.columnManager.moveColumn(this._column, toColumn, after);\n\t\t}else {\n\t\t\tconsole.warn(\"Move Error - No matching column found:\", toColumn);\n\t\t}\n\t}\n\n\tgetNextColumn(){\n\t\tvar nextCol = this._column.nextColumn();\n\n\t\treturn nextCol ? nextCol.getComponent() : false;\n\t}\n\n\tgetPrevColumn(){\n\t\tvar prevCol = this._column.prevColumn();\n\n\t\treturn prevCol ? prevCol.getComponent() : false;\n\t}\n\n\tupdateDefinition(updates){\n\t\treturn this._column.updateDefinition(updates);\n\t}\n\n\tgetWidth(){\n\t\treturn this._column.getWidth();\n\t}\n\n\tsetWidth(width){\n\t\tvar result;\n\n\t\tif(width === true){\n\t\t\tresult =  this._column.reinitializeWidth(true);\n\t\t}else {\n\t\t\tresult =  this._column.setWidth(width);\n\t\t}\n\n\t\tthis._column.table.columnManager.rerenderColumns(true);\n\n\t\treturn result;\n\t}\n}\n\nvar defaultColumnOptions = {\n\t\"title\": undefined,\n\t\"field\": undefined,\n\t\"columns\": undefined,\n\t\"visible\": undefined,\n\t\"hozAlign\": undefined,\n\t\"vertAlign\": undefined,\n\t\"width\": undefined,\n\t\"minWidth\": 40,\n\t\"maxWidth\": undefined,\n\t\"maxInitialWidth\": undefined,\n\t\"cssClass\": undefined,\n\t\"variableHeight\": undefined,\n\t\"headerVertical\": undefined,\n\t\"headerHozAlign\": undefined,\n\t\"headerWordWrap\": false,\n\t\"editableTitle\": undefined,\n};\n\nclass Column extends CoreFeature{\n\t\n\tstatic defaultOptionList = defaultColumnOptions;\n\t\n\tconstructor(def, parent, rowHeader){\n\t\tsuper(parent.table);\n\t\t\n\t\tthis.definition = def; //column definition\n\t\tthis.parent = parent; //hold parent object\n\t\tthis.type = \"column\"; //type of element\n\t\tthis.columns = []; //child columns\n\t\tthis.cells = []; //cells bound to this column\n\t\tthis.isGroup = false;\n\t\tthis.isRowHeader = rowHeader;\n\t\tthis.element = this.createElement(); //column header element\n\t\tthis.contentElement = false;\n\t\tthis.titleHolderElement = false;\n\t\tthis.titleElement = false;\n\t\tthis.groupElement = this.createGroupElement(); //column group holder element\n\t\tthis.hozAlign = \"\"; //horizontal text alignment\n\t\tthis.vertAlign = \"\"; //vert text alignment\n\t\t\n\t\t//multi dimensional filed handling\n\t\tthis.field =\"\";\n\t\tthis.fieldStructure = \"\";\n\t\tthis.getFieldValue = \"\";\n\t\tthis.setFieldValue = \"\";\n\t\t\n\t\tthis.titleDownload = null;\n\t\tthis.titleFormatterRendered = false;\n\t\t\n\t\tthis.mapDefinitions();\n\t\t\n\t\tthis.setField(this.definition.field);\n\t\t\n\t\tthis.modules = {}; //hold module variables;\n\t\t\n\t\tthis.width = null; //column width\n\t\tthis.widthStyled = \"\"; //column width pre-styled to improve render efficiency\n\t\tthis.maxWidth = null; //column maximum width\n\t\tthis.maxWidthStyled = \"\"; //column maximum pre-styled to improve render efficiency\n\t\tthis.maxInitialWidth = null;\n\t\tthis.minWidth = null; //column minimum width\n\t\tthis.minWidthStyled = \"\"; //column minimum pre-styled to improve render efficiency\n\t\tthis.widthFixed = false; //user has specified a width for this column\n\t\t\n\t\tthis.visible = true; //default visible state\n\t\t\n\t\tthis.component = null;\n\t\t\n\t\t//initialize column\n\t\tif(this.definition.columns){\n\t\t\t\n\t\t\tthis.isGroup = true;\n\t\t\t\n\t\t\tthis.definition.columns.forEach((def, i) => {\n\t\t\t\tvar newCol = new Column(def, this);\n\t\t\t\tthis.attachColumn(newCol);\n\t\t\t});\n\t\t\t\n\t\t\tthis.checkColumnVisibility();\n\t\t}else {\n\t\t\tparent.registerColumnField(this);\n\t\t}\n\t\t\n\t\tthis._initialize();\n\t}\n\t\n\tcreateElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-col\");\n\t\tel.setAttribute(\"role\", \"columnheader\");\n\t\tel.setAttribute(\"aria-sort\", \"none\");\n\n\t\tif(this.isRowHeader){\n\t\t\tel.classList.add(\"tabulator-row-header\");\n\t\t}\n\t\t\n\t\tswitch(this.table.options.columnHeaderVertAlign){\n\t\t\tcase \"middle\":\n\t\t\t\tel.style.justifyContent = \"center\";\n\t\t\t\tbreak;\n\t\t\tcase \"bottom\":\n\t\t\t\tel.style.justifyContent = \"flex-end\";\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\treturn el;\n\t}\n\t\n\tcreateGroupElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-col-group-cols\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tmapDefinitions(){\n\t\tvar defaults = this.table.options.columnDefaults;\n\t\t\n\t\t//map columnDefaults onto column definitions\n\t\tif(defaults){\n\t\t\tfor(let key in defaults){\n\t\t\t\tif(typeof this.definition[key] === \"undefined\"){\n\t\t\t\t\tthis.definition[key] = defaults[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.definition = this.table.columnManager.optionsList.generate(Column.defaultOptionList, this.definition);\n\t}\n\t\n\tcheckDefinition(){\n\t\tObject.keys(this.definition).forEach((key) => {\n\t\t\tif(Column.defaultOptionList.indexOf(key) === -1){\n\t\t\t\tconsole.warn(\"Invalid column definition option in '\" + (this.field || this.definition.title) + \"' column:\", key);\n\t\t\t}\n\t\t});\n\t}\n\n\tsetField(field){\n\t\tthis.field = field;\n\t\tthis.fieldStructure = field ? (this.table.options.nestedFieldSeparator ? field.split(this.table.options.nestedFieldSeparator) : [field]) : [];\n\t\tthis.getFieldValue = this.fieldStructure.length > 1 ? this._getNestedData : this._getFlatData;\n\t\tthis.setFieldValue = this.fieldStructure.length > 1 ? this._setNestedData : this._setFlatData;\n\t}\n\t\n\t//register column position with column manager\n\tregisterColumnPosition(column){\n\t\tthis.parent.registerColumnPosition(column);\n\t}\n\t\n\t//register column position with column manager\n\tregisterColumnField(column){\n\t\tthis.parent.registerColumnField(column);\n\t}\n\t\n\t//trigger position registration\n\treRegisterPosition(){\n\t\tif(this.isGroup){\n\t\t\tthis.columns.forEach(function(column){\n\t\t\t\tcolumn.reRegisterPosition();\n\t\t\t});\n\t\t}else {\n\t\t\tthis.registerColumnPosition(this);\n\t\t}\n\t}\n\t\n\t//build header element\n\t_initialize(){\n\t\tvar def = this.definition;\n\t\t\n\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\t\t\n\t\tif(def.headerVertical){\n\t\t\tthis.element.classList.add(\"tabulator-col-vertical\");\n\t\t\t\n\t\t\tif(def.headerVertical === \"flip\"){\n\t\t\t\tthis.element.classList.add(\"tabulator-col-vertical-flip\");\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.contentElement = this._buildColumnHeaderContent();\n\t\t\n\t\tthis.element.appendChild(this.contentElement);\n\t\t\n\t\tif(this.isGroup){\n\t\t\tthis._buildGroupHeader();\n\t\t}else {\n\t\t\tthis._buildColumnHeader();\n\t\t}\n\t\t\n\t\tthis.dispatch(\"column-init\", this);\n\t}\n\t\n\t//build header element for header\n\t_buildColumnHeader(){\n\t\tvar def = this.definition;\n\t\t\n\t\tthis.dispatch(\"column-layout\", this);\n\t\t\n\t\t//set column visibility\n\t\tif(typeof def.visible != \"undefined\"){\n\t\t\tif(def.visible){\n\t\t\t\tthis.show(true);\n\t\t\t}else {\n\t\t\t\tthis.hide(true);\n\t\t\t}\n\t\t}\n\t\t\n\t\t//assign additional css classes to column header\n\t\tif(def.cssClass){\n\t\t\tvar classNames = def.cssClass.split(\" \");\n\t\t\tclassNames.forEach((className) => {\n\t\t\t\tthis.element.classList.add(className);\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(def.field){\n\t\t\tthis.element.setAttribute(\"tabulator-field\", def.field);\n\t\t}\n\t\t\n\t\t//set min width if present\n\t\tthis.setMinWidth(parseInt(def.minWidth));\n\t\t\n\t\tif (def.maxInitialWidth) {\n\t\t\tthis.maxInitialWidth = parseInt(def.maxInitialWidth);\n\t\t}\n\t\t\n\t\tif(def.maxWidth){\n\t\t\tthis.setMaxWidth(parseInt(def.maxWidth));\n\t\t}\n\t\t\n\t\tthis.reinitializeWidth();\n\t\t\n\t\t//set horizontal text alignment\n\t\tthis.hozAlign = this.definition.hozAlign;\n\t\tthis.vertAlign = this.definition.vertAlign;\n\t\t\n\t\tthis.titleElement.style.textAlign = this.definition.headerHozAlign;\n\t}\n\t\n\t_buildColumnHeaderContent(){\n\t\tvar contentElement = document.createElement(\"div\");\n\t\tcontentElement.classList.add(\"tabulator-col-content\");\n\t\t\n\t\tthis.titleHolderElement = document.createElement(\"div\");\n\t\tthis.titleHolderElement.classList.add(\"tabulator-col-title-holder\");\n\t\t\n\t\tcontentElement.appendChild(this.titleHolderElement);\n\t\t\n\t\tthis.titleElement = this._buildColumnHeaderTitle();\n\t\t\n\t\tthis.titleHolderElement.appendChild(this.titleElement);\n\t\t\n\t\treturn contentElement;\n\t}\n\t\n\t//build title element of column\n\t_buildColumnHeaderTitle(){\n\t\tvar def = this.definition;\n\t\t\n\t\tvar titleHolderElement = document.createElement(\"div\");\n\t\ttitleHolderElement.classList.add(\"tabulator-col-title\");\n\t\t\n\t\tif(def.headerWordWrap){\n\t\t\ttitleHolderElement.classList.add(\"tabulator-col-title-wrap\");\n\t\t}\n\t\t\n\t\tif(def.editableTitle){\n\t\t\tvar titleElement = document.createElement(\"input\");\n\t\t\ttitleElement.classList.add(\"tabulator-title-editor\");\n\t\t\t\n\t\t\ttitleElement.addEventListener(\"click\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\ttitleElement.focus();\n\t\t\t});\n\t\t\t\n\t\t\ttitleElement.addEventListener(\"mousedown\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t\t\n\t\t\ttitleElement.addEventListener(\"change\", () => {\n\t\t\t\tdef.title = titleElement.value;\n\t\t\t\tthis.dispatchExternal(\"columnTitleChanged\", this.getComponent());\n\t\t\t});\n\t\t\t\n\t\t\ttitleHolderElement.appendChild(titleElement);\n\t\t\t\n\t\t\tif(def.field){\n\t\t\t\tthis.langBind(\"columns|\" + def.field, (text) => {\n\t\t\t\t\ttitleElement.value = text || (def.title || \"&nbsp;\");\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\ttitleElement.value  = def.title || \"&nbsp;\";\n\t\t\t}\n\t\t\t\n\t\t}else {\n\t\t\tif(def.field){\n\t\t\t\tthis.langBind(\"columns|\" + def.field, (text) => {\n\t\t\t\t\tthis._formatColumnHeaderTitle(titleHolderElement, text || (def.title || \"&nbsp;\"));\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tthis._formatColumnHeaderTitle(titleHolderElement, def.title || \"&nbsp;\");\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn titleHolderElement;\n\t}\n\t\n\t_formatColumnHeaderTitle(el, title){\n\t\tvar contents = this.chain(\"column-format\", [this, title, el], null, () => {\n\t\t\treturn title;\n\t\t});\n\t\t\n\t\tswitch(typeof contents){\n\t\t\tcase \"object\":\n\t\t\t\tif(contents instanceof Node){\n\t\t\t\t\tel.appendChild(contents);\n\t\t\t\t}else {\n\t\t\t\t\tel.innerHTML = \"\";\n\t\t\t\t\tconsole.warn(\"Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:\", contents);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"undefined\":\n\t\t\t\tel.innerHTML = \"\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tel.innerHTML = contents;\n\t\t}\n\t}\n\t\n\t//build header element for column group\n\t_buildGroupHeader(){\n\t\tthis.element.classList.add(\"tabulator-col-group\");\n\t\tthis.element.setAttribute(\"role\", \"columngroup\");\n\t\tthis.element.setAttribute(\"aria-title\", this.definition.title);\n\t\t\n\t\t//asign additional css classes to column header\n\t\tif(this.definition.cssClass){\n\t\t\tvar classNames = this.definition.cssClass.split(\" \");\n\t\t\tclassNames.forEach((className) => {\n\t\t\t\tthis.element.classList.add(className);\n\t\t\t});\n\t\t}\n\t\t\n\t\tthis.titleElement.style.textAlign = this.definition.headerHozAlign;\n\t\t\n\t\tthis.element.appendChild(this.groupElement);\n\t}\n\t\n\t//flat field lookup\n\t_getFlatData(data){\n\t\treturn data[this.field];\n\t}\n\t\n\t//nested field lookup\n\t_getNestedData(data){\n\t\tvar dataObj = data,\n\t\tstructure = this.fieldStructure,\n\t\tlength = structure.length,\n\t\toutput;\n\t\t\n\t\tfor(let i = 0; i < length; i++){\n\t\t\t\n\t\t\tdataObj = dataObj[structure[i]];\n\t\t\t\n\t\t\toutput = dataObj;\n\t\t\t\n\t\t\tif(!dataObj){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\t//flat field set\n\t_setFlatData(data, value){\n\t\tif(this.field){\n\t\t\tdata[this.field] = value;\n\t\t}\n\t}\n\t\n\t//nested field set\n\t_setNestedData(data, value){\n\t\tvar dataObj = data,\n\t\tstructure = this.fieldStructure,\n\t\tlength = structure.length;\n\t\t\n\t\tfor(let i = 0; i < length; i++){\n\t\t\t\n\t\t\tif(i == length -1){\n\t\t\t\tdataObj[structure[i]] = value;\n\t\t\t}else {\n\t\t\t\tif(!dataObj[structure[i]]){\n\t\t\t\t\tif(typeof value !== \"undefined\"){\n\t\t\t\t\t\tdataObj[structure[i]] = {};\n\t\t\t\t\t}else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdataObj = dataObj[structure[i]];\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//attach column to this group\n\tattachColumn(column){\n\t\tif(this.groupElement){\n\t\t\tthis.columns.push(column);\n\t\t\tthis.groupElement.appendChild(column.getElement());\n\t\t\t\n\t\t\tcolumn.columnRendered();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Warning - Column being attached to another column instead of column group\");\n\t\t}\n\t}\n\t\n\t//vertically align header in column\n\tverticalAlign(alignment, height){\n\t\t\n\t\t//calculate height of column header and group holder element\n\t\tvar parentHeight = this.parent.isGroup ? this.parent.getGroupElement().clientHeight : (height || this.parent.getHeadersElement().clientHeight);\n\t\t// var parentHeight = this.parent.isGroup ? this.parent.getGroupElement().clientHeight : this.parent.getHeadersElement().clientHeight;\n\t\t\n\t\tthis.element.style.height = parentHeight + \"px\";\n\t\t\n\t\tthis.dispatch(\"column-height\", this, this.element.style.height);\n\t\t\n\t\tif(this.isGroup){\n\t\t\tthis.groupElement.style.minHeight = (parentHeight - this.contentElement.offsetHeight) + \"px\";\n\t\t}\n\t\t\n\t\t//vertically align cell contents\n\t\t// if(!this.isGroup && alignment !== \"top\"){\n\t\t// \tif(alignment === \"bottom\"){\n\t\t// \t\tthis.element.style.paddingTop = (this.element.clientHeight - this.contentElement.offsetHeight) + \"px\";\n\t\t// \t}else{\n\t\t// \t\tthis.element.style.paddingTop = ((this.element.clientHeight - this.contentElement.offsetHeight) / 2) + \"px\";\n\t\t// \t}\n\t\t// }\n\t\t\n\t\tthis.columns.forEach(function(column){\n\t\t\tcolumn.verticalAlign(alignment);\n\t\t});\n\t}\n\t\n\t//clear vertical alignment\n\tclearVerticalAlign(){\n\t\tthis.element.style.paddingTop = \"\";\n\t\tthis.element.style.height = \"\";\n\t\tthis.element.style.minHeight = \"\";\n\t\tthis.groupElement.style.minHeight = \"\";\n\t\t\n\t\tthis.columns.forEach(function(column){\n\t\t\tcolumn.clearVerticalAlign();\n\t\t});\n\t\t\n\t\tthis.dispatch(\"column-height\", this, \"\");\n\t}\n\t\n\t//// Retrieve Column Information ////\n\t//return column header element\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\t\n\t//return column group element\n\tgetGroupElement(){\n\t\treturn this.groupElement;\n\t}\n\t\n\t//return field name\n\tgetField(){\n\t\treturn this.field;\n\t}\n\t\n\tgetTitleDownload() {\n\t\treturn this.titleDownload;\n\t}\n\t\n\t//return the first column in a group\n\tgetFirstColumn(){\n\t\tif(!this.isGroup){\n\t\t\treturn this;\n\t\t}else {\n\t\t\tif(this.columns.length){\n\t\t\t\treturn this.columns[0].getFirstColumn();\n\t\t\t}else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//return the last column in a group\n\tgetLastColumn(){\n\t\tif(!this.isGroup){\n\t\t\treturn this;\n\t\t}else {\n\t\t\tif(this.columns.length){\n\t\t\t\treturn this.columns[this.columns.length -1].getLastColumn();\n\t\t\t}else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//return all columns in a group\n\tgetColumns(traverse){\n\t\tvar columns = [];\n\t\t\n\t\tif(traverse){\n\t\t\tthis.columns.forEach((column) => {\n\t\t\t\tcolumns.push(column);\n\t\t\t\t\n\t\t\t\tcolumns = columns.concat(column.getColumns(true));\n\t\t\t});\n\t\t}else {\n\t\t\tcolumns = this.columns;\n\t\t}\n\t\t\n\t\treturn columns;\n\t}\n\t\n\t//return all columns in a group\n\tgetCells(){\n\t\treturn this.cells;\n\t}\n\t\n\t//retrieve the top column in a group of columns\n\tgetTopColumn(){\n\t\tif(this.parent.isGroup){\n\t\t\treturn this.parent.getTopColumn();\n\t\t}else {\n\t\t\treturn this;\n\t\t}\n\t}\n\t\n\t//return column definition object\n\tgetDefinition(updateBranches){\n\t\tvar colDefs = [];\n\t\t\n\t\tif(this.isGroup && updateBranches){\n\t\t\tthis.columns.forEach(function(column){\n\t\t\t\tcolDefs.push(column.getDefinition(true));\n\t\t\t});\n\t\t\t\n\t\t\tthis.definition.columns = colDefs;\n\t\t}\n\t\t\n\t\treturn this.definition;\n\t}\n\t\n\t//////////////////// Actions ////////////////////\n\tcheckColumnVisibility(){\n\t\tvar visible = false;\n\t\t\n\t\tthis.columns.forEach(function(column){\n\t\t\tif(column.visible){\n\t\t\t\tvisible = true;\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(visible){\n\t\t\tthis.show();\n\t\t\tthis.dispatchExternal(\"columnVisibilityChanged\", this.getComponent(), false);\n\t\t}else {\n\t\t\tthis.hide();\n\t\t}\n\t}\n\t\n\t//show column\n\tshow(silent, responsiveToggle){\n\t\tif(!this.visible){\n\t\t\tthis.visible = true;\n\t\t\t\n\t\t\tthis.element.style.display = \"\";\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.checkColumnVisibility();\n\t\t\t}\n\t\t\t\n\t\t\tthis.cells.forEach(function(cell){\n\t\t\t\tcell.show();\n\t\t\t});\n\t\t\t\n\t\t\tif(!this.isGroup && this.width === null){\n\t\t\t\tthis.reinitializeWidth();\n\t\t\t}\n\t\t\t\n\t\t\tthis.table.columnManager.verticalAlignHeaders();\n\t\t\t\n\t\t\tthis.dispatch(\"column-show\", this, responsiveToggle);\n\t\t\t\n\t\t\tif(!silent){\n\t\t\t\tthis.dispatchExternal(\"columnVisibilityChanged\", this.getComponent(), true);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.matchChildWidths();\n\t\t\t}\n\t\t\t\n\t\t\tif(!this.silent){\n\t\t\t\tthis.table.columnManager.rerenderColumns();\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//hide column\n\thide(silent, responsiveToggle){\n\t\tif(this.visible){\n\t\t\tthis.visible = false;\n\t\t\t\n\t\t\tthis.element.style.display = \"none\";\n\t\t\t\n\t\t\tthis.table.columnManager.verticalAlignHeaders();\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.checkColumnVisibility();\n\t\t\t}\n\t\t\t\n\t\t\tthis.cells.forEach(function(cell){\n\t\t\t\tcell.hide();\n\t\t\t});\n\t\t\t\n\t\t\tthis.dispatch(\"column-hide\", this, responsiveToggle);\n\t\t\t\n\t\t\tif(!silent){\n\t\t\t\tthis.dispatchExternal(\"columnVisibilityChanged\", this.getComponent(), false);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.matchChildWidths();\n\t\t\t}\n\t\t\t\n\t\t\tif(!this.silent){\n\t\t\t\tthis.table.columnManager.rerenderColumns();\n\t\t\t}\n\t\t}\n\t}\n\t\n\tmatchChildWidths(){\n\t\tvar childWidth = 0;\n\t\t\n\t\tif(this.contentElement && this.columns.length){\n\t\t\tthis.columns.forEach(function(column){\n\t\t\t\tif(column.visible){\n\t\t\t\t\tchildWidth += column.getWidth();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.contentElement.style.maxWidth = (childWidth - 1) + \"px\";\n\t\t\tif (this.table.initialized) {\n\t\t\t\tthis.element.style.width = childWidth + \"px\";\n\t\t\t}\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.matchChildWidths();\n\t\t\t}\n\t\t}\n\t}\n\t\n\tremoveChild(child){\n\t\tvar index = this.columns.indexOf(child);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.columns.splice(index, 1);\n\t\t}\n\t\t\n\t\tif(!this.columns.length){\n\t\t\tthis.delete();\n\t\t}\n\t}\n\t\n\tsetWidth(width){\n\t\tthis.widthFixed = true;\n\t\tthis.setWidthActual(width);\n\t}\n\t\n\tsetWidthActual(width){\n\t\tif(isNaN(width)){\n\t\t\twidth = Math.floor((this.table.element.clientWidth/100) * parseInt(width));\n\t\t}\n\t\t\n\t\twidth = Math.max(this.minWidth, width);\n\t\t\n\t\tif(this.maxWidth){\n\t\t\twidth = Math.min(this.maxWidth, width);\n\t\t}\n\t\t\n\t\tthis.width = width;\n\t\tthis.widthStyled = width ? width + \"px\" : \"\";\n\t\t\n\t\tthis.element.style.width = this.widthStyled;\n\t\t\n\t\tif(!this.isGroup){\n\t\t\tthis.cells.forEach(function(cell){\n\t\t\t\tcell.setWidth();\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(this.parent.isGroup){\n\t\t\tthis.parent.matchChildWidths();\n\t\t}\n\t\t\n\t\tthis.dispatch(\"column-width\", this);\n\t\t\n\t\tif(this.subscribedExternal(\"columnWidth\")){\n\t\t\tthis.dispatchExternal(\"columnWidth\", this.getComponent());\n\t\t}\n\t}\n\t\n\tcheckCellHeights(){\n\t\tvar rows = [];\n\t\t\n\t\tthis.cells.forEach(function(cell){\n\t\t\tif(cell.row.heightInitialized){\n\t\t\t\tif(cell.row.getElement().offsetParent !== null){\n\t\t\t\t\trows.push(cell.row);\n\t\t\t\t\tcell.row.clearCellHeight();\n\t\t\t\t}else {\n\t\t\t\t\tcell.row.heightInitialized = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\trows.forEach(function(row){\n\t\t\trow.calcHeight();\n\t\t});\n\t\t\n\t\trows.forEach(function(row){\n\t\t\trow.setCellHeight();\n\t\t});\n\t}\n\t\n\tgetWidth(){\n\t\tvar width = 0;\n\t\t\n\t\tif(this.isGroup){\n\t\t\tthis.columns.forEach(function(column){\n\t\t\t\tif(column.visible){\n\t\t\t\t\twidth += column.getWidth();\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\twidth = this.width;\n\t\t}\n\t\t\n\t\treturn width;\n\t}\n\t\n\tgetLeftOffset(){\n\t\tvar offset = this.element.offsetLeft;\n\t\t\n\t\tif(this.parent.isGroup){\n\t\t\toffset += this.parent.getLeftOffset();\n\t\t}\n\t\t\n\t\treturn offset;\n\t}\n\t\n\tgetHeight(){\n\t\treturn Math.ceil(this.element.getBoundingClientRect().height);\n\t}\n\t\n\tsetMinWidth(minWidth){\n\t\tif(this.maxWidth && minWidth > this.maxWidth){\n\t\t\tminWidth = this.maxWidth;\n\t\t\t\n\t\t\tconsole.warn(\"the minWidth (\"+ minWidth + \"px) for column '\" + this.field + \"' cannot be bigger that its maxWidth (\"+ this.maxWidthStyled + \")\");\n\t\t}\n\t\t\n\t\tthis.minWidth = minWidth;\n\t\tthis.minWidthStyled = minWidth ? minWidth + \"px\" : \"\";\n\t\t\n\t\tthis.element.style.minWidth = this.minWidthStyled;\n\t\t\n\t\tthis.cells.forEach(function(cell){\n\t\t\tcell.setMinWidth();\n\t\t});\n\t}\n\t\n\tsetMaxWidth(maxWidth){\n\t\tif(this.minWidth && maxWidth < this.minWidth){\n\t\t\tmaxWidth = this.minWidth;\n\t\t\t\n\t\t\tconsole.warn(\"the maxWidth (\"+ maxWidth + \"px) for column '\" + this.field + \"' cannot be smaller that its minWidth (\"+ this.minWidthStyled + \")\");\n\t\t}\n\t\t\n\t\tthis.maxWidth = maxWidth;\n\t\tthis.maxWidthStyled = maxWidth ? maxWidth + \"px\" : \"\";\n\t\t\n\t\tthis.element.style.maxWidth = this.maxWidthStyled;\n\t\t\n\t\tthis.cells.forEach(function(cell){\n\t\t\tcell.setMaxWidth();\n\t\t});\n\t}\n\t\n\tdelete(){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(this.isGroup){\n\t\t\t\tthis.columns.forEach(function(column){\n\t\t\t\t\tcolumn.delete();\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"column-delete\", this);\n\t\t\t\n\t\t\tvar cellCount = this.cells.length;\n\t\t\t\n\t\t\tfor(let i = 0; i < cellCount; i++){\n\t\t\t\tthis.cells[0].delete();\n\t\t\t}\n\t\t\t\n\t\t\tif(this.element.parentNode){\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t\t\n\t\t\tthis.element = false;\n\t\t\tthis.contentElement = false;\n\t\t\tthis.titleElement = false;\n\t\t\tthis.groupElement = false;\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.removeChild(this);\n\t\t\t}\n\t\t\t\n\t\t\tthis.table.columnManager.deregisterColumn(this);\n\t\t\t\n\t\t\tthis.table.columnManager.rerenderColumns(true);\n\t\t\t\n\t\t\tthis.dispatch(\"column-deleted\", this);\n\t\t\t\n\t\t\tresolve();\n\t\t});\n\t}\n\t\n\tcolumnRendered(){\n\t\tif(this.titleFormatterRendered){\n\t\t\tthis.titleFormatterRendered();\n\t\t}\n\t\t\n\t\tthis.dispatch(\"column-rendered\", this);\n\t}\n\t\n\t//////////////// Cell Management /////////////////\n\t//generate cell for this column\n\tgenerateCell(row){\n\t\tvar cell = new Cell(this, row);\n\t\t\n\t\tthis.cells.push(cell);\n\t\t\n\t\treturn cell;\n\t}\n\t\n\tnextColumn(){\n\t\tvar index = this.table.columnManager.findColumnIndex(this);\n\t\treturn index > -1 ? this._nextVisibleColumn(index + 1) : false;\n\t}\n\t\n\t_nextVisibleColumn(index){\n\t\tvar column = this.table.columnManager.getColumnByIndex(index);\n\t\treturn !column || column.visible ? column : this._nextVisibleColumn(index + 1);\n\t}\n\t\n\tprevColumn(){\n\t\tvar index = this.table.columnManager.findColumnIndex(this);\n\t\treturn index > -1 ? this._prevVisibleColumn(index - 1) : false;\n\t}\n\t\n\t_prevVisibleColumn(index){\n\t\tvar column = this.table.columnManager.getColumnByIndex(index);\n\t\treturn !column || column.visible ? column : this._prevVisibleColumn(index - 1);\n\t}\n\t\n\treinitializeWidth(force){\n\t\tthis.widthFixed = false;\n\t\t\n\t\t//set width if present\n\t\tif(typeof this.definition.width !== \"undefined\" && !force){\n\t\t\t// maxInitialWidth ignored here as width specified\n\t\t\tthis.setWidth(this.definition.width);\n\t\t}\n\t\t\n\t\tthis.dispatch(\"column-width-fit-before\", this);\n\t\t\n\t\tthis.fitToData(force);\n\t\t\n\t\tthis.dispatch(\"column-width-fit-after\", this);\n\t}\n\t\n\t//set column width to maximum cell width for non group columns\n\tfitToData(force){\n\t\tif(this.isGroup){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif(!this.widthFixed){\n\t\t\tthis.element.style.width = \"\";\n\t\t\t\n\t\t\tthis.cells.forEach((cell) => {\n\t\t\t\tcell.clearWidth();\n\t\t\t});\n\t\t}\n\t\t\n\t\tvar maxWidth = this.element.offsetWidth;\n\t\t\n\t\tif(!this.width || !this.widthFixed){\n\t\t\tthis.cells.forEach((cell) => {\n\t\t\t\tvar width = cell.getWidth();\n\t\t\t\t\n\t\t\t\tif(width > maxWidth){\n\t\t\t\t\tmaxWidth = width;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(maxWidth){\n\t\t\t\tvar setTo = maxWidth + 1;\n\t\t\t\t\n\t\t\t\tif(force){\n\t\t\t\t\tthis.setWidth(setTo);\n\t\t\t\t}else {\n\t\t\t\t\tif (this.maxInitialWidth && !force) {\n\t\t\t\t\t\tsetTo = Math.min(setTo, this.maxInitialWidth);\n\t\t\t\t\t}\n\t\t\t\t\tthis.setWidthActual(setTo);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tupdateDefinition(updates){\n\t\tvar definition;\n\t\t\n\t\tif(!this.isGroup){\n\t\t\tif(!this.parent.isGroup){\n\t\t\t\tdefinition = Object.assign({}, this.getDefinition());\n\t\t\t\tdefinition = Object.assign(definition, updates);\n\t\t\t\t\n\t\t\t\treturn this.table.columnManager.addColumn(definition, false, this)\n\t\t\t\t\t.then((column) => {\n\t\t\t\t\t\n\t\t\t\t\t\tif(definition.field == this.field){\n\t\t\t\t\t\t\tthis.field = false; //clear field name to prevent deletion of duplicate column from arrays\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\treturn this.delete()\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconsole.error(\"Column Update Error - The updateDefinition function is only available on ungrouped columns\");\n\t\t\t\treturn Promise.reject(\"Column Update Error - The updateDefinition function is only available on columns, not column groups\");\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.error(\"Column Update Error - The updateDefinition function is only available on ungrouped columns\");\n\t\t\treturn Promise.reject(\"Column Update Error - The updateDefinition function is only available on columns, not column groups\");\n\t\t}\n\t}\n\t\n\tdeleteCell(cell){\n\t\tvar index = this.cells.indexOf(cell);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.cells.splice(index, 1);\n\t\t}\n\t}\n\t\n\t//////////////// Object Generation /////////////////\n\tgetComponent(){\n\t\tif(!this.component){\n\t\t\tthis.component = new ColumnComponent(this);\n\t\t}\n\t\t\n\t\treturn this.component;\n\t}\n\t\n\tgetPosition(){\n\t\treturn this.table.columnManager.getVisibleColumnsByIndex().indexOf(this) + 1;\n\t}\n\t\n\tgetParentComponent(){\n\t\treturn this.parent instanceof Column ? this.parent.getComponent() : false;\n\t}\n}\n\n//public row object\nclass RowComponent {\n\n\tconstructor (row){\n\t\tthis._row = row;\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._row.table.componentFunctionBinder.handle(\"row\", target._row, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetData(transform){\n\t\treturn this._row.getData(transform);\n\t}\n\n\tgetElement(){\n\t\treturn this._row.getElement();\n\t}\n\n\tgetCells(){\n\t\tvar cells = [];\n\n\t\tthis._row.getCells().forEach(function(cell){\n\t\t\tcells.push(cell.getComponent());\n\t\t});\n\n\t\treturn cells;\n\t}\n\n\tgetCell(column){\n\t\tvar cell = this._row.getCell(column);\n\t\treturn cell ? cell.getComponent() : false;\n\t}\n\n\tgetIndex(){\n\t\treturn this._row.getData(\"data\")[this._row.table.options.index];\n\t}\n\n\tgetPosition(){\n\t\treturn this._row.getPosition();\n\t}\n\n\twatchPosition(callback){\n\t\treturn this._row.watchPosition(callback);\n\t}\n\n\tdelete(){\n\t\treturn this._row.delete();\n\t}\n\n\tscrollTo(position, ifVisible){\n\t\treturn this._row.table.rowManager.scrollToRow(this._row, position, ifVisible);\n\t}\n\n\tmove(to, after){\n\t\tthis._row.moveToRow(to, after);\n\t}\n\n\tupdate(data){\n\t\treturn this._row.updateData(data);\n\t}\n\n\tnormalizeHeight(){\n\t\tthis._row.normalizeHeight(true);\n\t}\n\n\t_getSelf(){\n\t\treturn this._row;\n\t}\n\n\treformat(){\n\t\treturn this._row.reinitialize();\n\t}\n\n\tgetTable(){\n\t\treturn this._row.table;\n\t}\n\n\tgetNextRow(){\n\t\tvar row = this._row.nextRow();\n\t\treturn row ? row.getComponent() : row;\n\t}\n\n\tgetPrevRow(){\n\t\tvar row = this._row.prevRow();\n\t\treturn row ? row.getComponent() : row;\n\t}\n}\n\nclass Row extends CoreFeature{\n\tconstructor (data, parent, type = \"row\"){\n\t\tsuper(parent.table);\n\t\t\n\t\tthis.parent = parent;\n\t\tthis.data = {};\n\t\tthis.type = type; //type of element\n\t\tthis.element = false;\n\t\tthis.modules = {}; //hold module variables;\n\t\tthis.cells = [];\n\t\tthis.height = 0; //hold element height\n\t\tthis.heightStyled = \"\"; //hold element height pre-styled to improve render efficiency\n\t\tthis.manualHeight = false; //user has manually set row height\n\t\tthis.outerHeight = 0; //hold elements outer height\n\t\tthis.initialized = false; //element has been rendered\n\t\tthis.heightInitialized = false; //element has resized cells to fit\n\t\tthis.position = 0; //store position of element in row list\n\t\tthis.positionWatchers = [];\n\t\t\n\t\tthis.component = null;\n\t\t\n\t\tthis.created = false;\n\t\t\n\t\tthis.setData(data);\n\t}\n\t\n\tcreate(){\n\t\tif(!this.created){\n\t\t\tthis.created = true;\n\t\t\tthis.generateElement();\n\t\t}\n\t}\n\t\n\tcreateElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-row\");\n\t\tel.setAttribute(\"role\", \"row\");\n\t\t\n\t\tthis.element = el;\n\t}\n\t\n\tgetElement(){\n\t\tthis.create();\n\t\treturn this.element;\n\t}\n\t\n\tdetachElement(){\n\t\tif (this.element && this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n\t}\n\t\n\tgenerateElement(){\n\t\tthis.createElement();\n\t\tthis.dispatch(\"row-init\", this);\n\t}\n\t\n\tgenerateCells(){\n\t\tthis.cells = this.table.columnManager.generateCells(this);\n\t}\n\t\n\t//functions to setup on first render\n\tinitialize(force, inFragment){\n\t\tthis.create();\n\t\t\n\t\tif(!this.initialized || force){\n\t\t\t\n\t\t\tthis.deleteCells();\n\t\t\t\n\t\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\t\t\t\n\t\t\tthis.dispatch(\"row-layout-before\", this);\n\t\t\t\n\t\t\tthis.generateCells();\n\t\t\t\n\t\t\tthis.initialized = true;\n\t\t\t\n\t\t\tthis.table.columnManager.renderer.renderRowCells(this, inFragment);\n\t\t\t\n\t\t\tif(force){\n\t\t\t\tthis.normalizeHeight();\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-layout\", this);\n\t\t\t\n\t\t\tif(this.table.options.rowFormatter){\n\t\t\t\tthis.table.options.rowFormatter(this.getComponent());\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-layout-after\", this);\n\t\t}else {\n\t\t\tthis.table.columnManager.renderer.rerenderRowCells(this, inFragment);\n\t\t}\n\t}\n\n\trendered(){\n\t\tthis.cells.forEach((cell) => {\n\t\t\tcell.cellRendered();\n\t\t});\n\t}\n\t\n\treinitializeHeight(){\n\t\tthis.heightInitialized = false;\n\t\t\n\t\tif(this.element && this.element.offsetParent !== null){\n\t\t\tthis.normalizeHeight(true);\n\t\t}\n\t}\n\n\tdeinitialize(){\n\t\tthis.initialized = false;\n\t}\n\t\n\tdeinitializeHeight(){\n\t\tthis.heightInitialized = false;\n\t}\n\t\n\treinitialize(children){\n\t\tthis.initialized = false;\n\t\tthis.heightInitialized = false;\n\t\t\n\t\tif(!this.manualHeight){\n\t\t\tthis.height = 0;\n\t\t\tthis.heightStyled = \"\";\n\t\t}\n\t\t\n\t\tif(this.element && this.element.offsetParent !== null){\n\t\t\tthis.initialize(true);\n\t\t}\n\t\t\n\t\tthis.dispatch(\"row-relayout\", this);\n\t}\n\t\n\t//get heights when doing bulk row style calcs in virtual DOM\n\tcalcHeight(force){\n\t\tvar maxHeight = 0, minHeight  = 0;\n\n\t\tif(this.table.options.rowHeight){\n\t\t\tthis.height = this.table.options.rowHeight;\n\t\t}else {\n\t\t\tminHeight = this.calcMinHeight();\n\t\t\tmaxHeight = this.calcMaxHeight();\n\t\t\t\n\t\t\tif(force){\n\t\t\t\tthis.height = Math.max(maxHeight, minHeight);\n\t\t\t}else {\n\t\t\t\tthis.height = this.manualHeight ? this.height : Math.max(maxHeight, minHeight);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.heightStyled = this.height ? this.height + \"px\" : \"\";\n\t\tthis.outerHeight = this.element.offsetHeight;\n\t}\n\n\tcalcMinHeight(){\n\t\treturn this.table.options.resizableRows ? this.element.clientHeight : 0;\n\t}\n\n\tcalcMaxHeight(){\n\t\tvar maxHeight = 0;\n\n\t\tthis.cells.forEach(function(cell){\n\t\t\tvar height = cell.getHeight();\n\n\t\t\tif(height > maxHeight){\n\t\t\t\tmaxHeight = height;\n\t\t\t}\n\t\t});\n\n\t\treturn maxHeight;\n\t}\n\t\n\t//set of cells\n\tsetCellHeight(){\n\t\tthis.cells.forEach(function(cell){\n\t\t\tcell.setHeight();\n\t\t});\n\t\t\n\t\tthis.heightInitialized = true;\n\t}\n\t\n\tclearCellHeight(){\n\t\tthis.cells.forEach(function(cell){\n\t\t\tcell.clearHeight();\n\t\t});\n\t}\n\t\n\t//normalize the height of elements in the row\n\tnormalizeHeight(force){\n\t\tif(force && !this.table.options.rowHeight){\n\t\t\tthis.clearCellHeight();\n\t\t}\n\t\t\n\t\tthis.calcHeight(force);\n\t\t\n\t\tthis.setCellHeight();\n\t}\n\t\n\t//set height of rows\n\tsetHeight(height, force){\n\t\tif(this.height != height || force){\n\t\t\t\n\t\t\tthis.manualHeight = true;\n\t\t\t\n\t\t\tthis.height = height;\n\t\t\tthis.heightStyled = height ? height + \"px\" : \"\";\n\t\t\t\n\t\t\tthis.setCellHeight();\n\t\t\t\n\t\t\t// this.outerHeight = this.element.outerHeight();\n\t\t\tthis.outerHeight = this.element.offsetHeight;\n\n\t\t\tif(this.subscribedExternal(\"rowHeight\")){\n\t\t\t\tthis.dispatchExternal(\"rowHeight\", this.getComponent());\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//return rows outer height\n\tgetHeight(){\n\t\treturn this.outerHeight;\n\t}\n\t\n\t//return rows outer Width\n\tgetWidth(){\n\t\treturn this.element.offsetWidth;\n\t}\n\t\n\t//////////////// Cell Management /////////////////\n\tdeleteCell(cell){\n\t\tvar index = this.cells.indexOf(cell);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.cells.splice(index, 1);\n\t\t}\n\t}\n\t\n\t//////////////// Data Management /////////////////\n\tsetData(data){\n\t\tthis.data = this.chain(\"row-data-init-before\", [this, data], undefined, data);\n\t\t\n\t\tthis.dispatch(\"row-data-init-after\", this);\n\t}\n\t\n\t//update the rows data\n\tupdateData(updatedData){\n\t\tvar visible = this.element && Helpers.elVisible(this.element),\n\t\ttempData = {},\n\t\tnewRowData;\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t\n\t\t\tif(typeof updatedData === \"string\"){\n\t\t\t\tupdatedData = JSON.parse(updatedData);\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-data-save-before\", this);\n\t\t\t\n\t\t\tif(this.subscribed(\"row-data-changing\")){\n\t\t\t\ttempData = Object.assign(tempData, this.data);\n\t\t\t\ttempData = Object.assign(tempData, updatedData);\n\t\t\t}\n\t\t\t\n\t\t\tnewRowData = this.chain(\"row-data-changing\", [this, tempData, updatedData], null, updatedData);\n\t\t\t\n\t\t\t//set data\n\t\t\tfor (let attrname in newRowData) {\n\t\t\t\tthis.data[attrname] = newRowData[attrname];\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-data-save-after\", this);\n\t\t\t\n\t\t\t//update affected cells only\n\t\t\tfor (let attrname in updatedData) {\n\t\t\t\t\n\t\t\t\tlet columns = this.table.columnManager.getColumnsByFieldRoot(attrname);\n\t\t\t\t\n\t\t\t\tcolumns.forEach((column) => {\n\t\t\t\t\tlet cell = this.getCell(column.getField());\n\t\t\t\t\t\n\t\t\t\t\tif(cell){\n\t\t\t\t\t\tlet value = column.getFieldValue(newRowData);\n\t\t\t\t\t\tif(cell.getValue() !== value){\n\t\t\t\t\t\t\tcell.setValueProcessData(value);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(visible){\n\t\t\t\t\t\t\t\tcell.cellRendered();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t//Partial reinitialization if visible\n\t\t\tif(visible){\n\t\t\t\tthis.normalizeHeight(true);\n\t\t\t\t\n\t\t\t\tif(this.table.options.rowFormatter){\n\t\t\t\t\tthis.table.options.rowFormatter(this.getComponent());\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.initialized = false;\n\t\t\t\tthis.height = 0;\n\t\t\t\tthis.heightStyled = \"\";\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-data-changed\", this, visible, updatedData);\n\t\t\t\n\t\t\t//this.reinitialize();\n\t\t\t\n\t\t\tthis.dispatchExternal(\"rowUpdated\", this.getComponent());\n\t\t\t\n\t\t\tif(this.subscribedExternal(\"dataChanged\")){\n\t\t\t\tthis.dispatchExternal(\"dataChanged\", this.table.rowManager.getData());\n\t\t\t}\n\t\t\t\n\t\t\tresolve();\n\t\t});\n\t}\n\t\n\tgetData(transform){\n\t\tif(transform){\n\t\t\treturn this.chain(\"row-data-retrieve\", [this, transform], null, this.data);\n\t\t}\n\t\t\n\t\treturn this.data;\n\t}\n\t\n\tgetCell(column){\n\t\tvar match = false;\n\t\t\n\t\tcolumn = this.table.columnManager.findColumn(column);\n\t\t\n\t\tif(!this.initialized && this.cells.length === 0){\n\t\t\tthis.generateCells();\n\t\t}\n\t\t\n\t\tmatch = this.cells.find(function(cell){\n\t\t\treturn cell.column === column;\n\t\t});\n\t\t\n\t\treturn match;\n\t}\n\t\n\tgetCellIndex(findCell){\n\t\treturn this.cells.findIndex(function(cell){\n\t\t\treturn cell === findCell;\n\t\t});\n\t}\n\t\n\tfindCell(subject){\n\t\treturn this.cells.find((cell) => {\n\t\t\treturn cell.element === subject;\n\t\t});\n\t}\n\t\n\tgetCells(){\n\t\tif(!this.initialized && this.cells.length === 0){\n\t\t\tthis.generateCells();\n\t\t}\n\t\t\n\t\treturn this.cells;\n\t}\n\t\n\tnextRow(){\n\t\tvar row = this.table.rowManager.nextDisplayRow(this, true);\n\t\treturn row || false;\n\t}\n\t\n\tprevRow(){\n\t\tvar row = this.table.rowManager.prevDisplayRow(this, true);\n\t\treturn row || false;\n\t}\n\t\n\tmoveToRow(to, before){\n\t\tvar toRow = this.table.rowManager.findRow(to);\n\t\t\n\t\tif(toRow){\n\t\t\tthis.table.rowManager.moveRowActual(this, toRow, !before);\n\t\t\tthis.table.rowManager.refreshActiveData(\"display\", false, true);\n\t\t}else {\n\t\t\tconsole.warn(\"Move Error - No matching row found:\", to);\n\t\t}\n\t}\n\t\n\t///////////////////// Actions  /////////////////////\n\tdelete(){\n\t\tthis.dispatch(\"row-delete\", this);\n\t\t\n\t\tthis.deleteActual();\n\t\t\n\t\treturn Promise.resolve();\n\t}\n\t\n\tdeleteActual(blockRedraw){\n\t\tthis.detachModules();\n\t\t\n\t\tthis.table.rowManager.deleteRow(this, blockRedraw);\n\t\t\n\t\tthis.deleteCells();\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.heightInitialized = false;\n\t\tthis.element = false;\n\t\t\n\t\tthis.dispatch(\"row-deleted\", this);\n\t}\n\t\n\tdetachModules(){\n\t\tthis.dispatch(\"row-deleting\", this);\n\t}\n\t\n\tdeleteCells(){\n\t\tvar cellCount = this.cells.length;\n\t\t\n\t\tfor(let i = 0; i < cellCount; i++){\n\t\t\tthis.cells[0].delete();\n\t\t}\n\t}\n\t\n\twipe(){\n\t\tthis.detachModules();\n\t\tthis.deleteCells();\n\t\t\n\t\tif(this.element){\n\t\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\t\t\t\n\t\t\tif(this.element.parentNode){\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.element = false;\n\t\tthis.modules = {};\n\t}\n\n\tisDisplayed(){\n\t\treturn this.table.rowManager.getDisplayRows().includes(this);\n\t}\n\n\tgetPosition(){\n\t\treturn this.isDisplayed() ? this.position : false;\n\t}\n\n\tsetPosition(position){\n\t\tif(position != this.position){\n\t\t\tthis.position = position;\n\n\t\t\tthis.positionWatchers.forEach((callback) => {\n\t\t\t\tcallback(this.position);\n\t\t\t});\n\t\t}\n\t}\n\n\twatchPosition(callback){\n\t\tthis.positionWatchers.push(callback);\n\n\t\tcallback(this.position);\n\t}\n\t\n\tgetGroup(){\n\t\treturn this.modules.group || false;\n\t}\n\t\n\t//////////////// Object Generation /////////////////\n\tgetComponent(){\n\t\tif(!this.component){\n\t\t\tthis.component = new RowComponent(this);\n\t\t}\n\t\t\n\t\treturn this.component;\n\t}\n}\n\nvar defaultCalculations = {\n\t\"avg\":function(values, data, calcParams){\n\t\tvar output = 0,\n\t\tprecision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : 2;\n\n\t\tif(values.length){\n\t\t\toutput = values.reduce(function(sum, value){\n\t\t\t\treturn Number(sum) + Number(value);\n\t\t\t});\n\n\t\t\toutput = output / values.length;\n\n\t\t\toutput = precision !== false ? output.toFixed(precision) : output;\n\t\t}\n\n\t\treturn parseFloat(output).toString();\n\t},\n\t\"max\":function(values, data, calcParams){\n\t\tvar output = null,\n\t\tprecision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tvalues.forEach(function(value){\n\n\t\t\tvalue = Number(value);\n\n\t\t\tif(value > output || output === null){\n\t\t\t\toutput = value;\n\t\t\t}\n\t\t});\n\n\t\treturn output !== null ? (precision !== false ? output.toFixed(precision) : output) : \"\";\n\t},\n\t\"min\":function(values, data, calcParams){\n\t\tvar output = null,\n\t\tprecision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tvalues.forEach(function(value){\n\n\t\t\tvalue = Number(value);\n\n\t\t\tif(value < output || output === null){\n\t\t\t\toutput = value;\n\t\t\t}\n\t\t});\n\n\t\treturn output !== null ? (precision !== false ? output.toFixed(precision) : output) : \"\";\n\t},\n\t\"sum\":function(values, data, calcParams){\n\t\tvar output = 0,\n\t\tprecision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tif(values.length){\n\t\t\tvalues.forEach(function(value){\n\t\t\t\tvalue = Number(value);\n\n\t\t\t\toutput += !isNaN(value) ? Number(value) : 0;\n\t\t\t});\n\t\t}\n\n\t\treturn precision !== false ? output.toFixed(precision) : output;\n\t},\n\t\"concat\":function(values, data, calcParams){\n\t\tvar output = 0;\n\n\t\tif(values.length){\n\t\t\toutput = values.reduce(function(sum, value){\n\t\t\t\treturn String(sum) + String(value);\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t},\n\t\"count\":function(values, data, calcParams){\n\t\tvar output = 0;\n\n\t\tif(values.length){\n\t\t\tvalues.forEach(function(value){\n\t\t\t\tif(value){\n\t\t\t\t\toutput ++;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t},\n\t\"unique\":function(values, data, calcParams){\n\t\tvar unique = values.filter((value, index) => {\n\t\t\treturn (values || value === 0) && values.indexOf(value) === index;\n\t\t});\n\n\t\treturn unique.length;\n\t},\n};\n\nclass ColumnCalcs extends Module{\n\n\tstatic moduleName = \"columnCalcs\";\n\n\t//load defaults\n\tstatic calculations = defaultCalculations;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.topCalcs = [];\n\t\tthis.botCalcs = [];\n\t\tthis.genColumn = false;\n\t\tthis.topElement = this.createElement();\n\t\tthis.botElement = this.createElement();\n\t\tthis.topRow = false;\n\t\tthis.botRow = false;\n\t\tthis.topInitialized = false;\n\t\tthis.botInitialized = false;\n\t\t\n\t\tthis.blocked = false;\n\t\tthis.recalcAfterBlock = false;\n\t\t\n\t\tthis.registerTableOption(\"columnCalcs\", true);\n\t\t\n\t\tthis.registerColumnOption(\"topCalc\");\n\t\tthis.registerColumnOption(\"topCalcParams\");\n\t\tthis.registerColumnOption(\"topCalcFormatter\");\n\t\tthis.registerColumnOption(\"topCalcFormatterParams\");\n\t\tthis.registerColumnOption(\"bottomCalc\");\n\t\tthis.registerColumnOption(\"bottomCalcParams\");\n\t\tthis.registerColumnOption(\"bottomCalcFormatter\");\n\t\tthis.registerColumnOption(\"bottomCalcFormatterParams\");\n\t}\n\t\n\tcreateElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-calcs-holder\");\n\t\treturn el;\n\t}\n\t\n\tinitialize(){\n\t\tthis.genColumn = new Column({field:\"value\"}, this);\n\t\t\n\t\tthis.subscribe(\"cell-value-changed\", this.cellValueChanged.bind(this));\n\t\tthis.subscribe(\"column-init\", this.initializeColumnCheck.bind(this));\n\t\tthis.subscribe(\"row-deleted\", this.rowsUpdated.bind(this));\n\t\tthis.subscribe(\"scroll-horizontal\", this.scrollHorizontal.bind(this));\n\t\tthis.subscribe(\"row-added\", this.rowsUpdated.bind(this));\n\t\tthis.subscribe(\"column-moved\", this.recalcActiveRows.bind(this));\n\t\tthis.subscribe(\"column-add\", this.recalcActiveRows.bind(this));\n\t\tthis.subscribe(\"data-refreshed\", this.recalcActiveRowsRefresh.bind(this));\n\t\tthis.subscribe(\"table-redraw\", this.tableRedraw.bind(this));\n\t\tthis.subscribe(\"rows-visible\", this.visibleRows.bind(this));\n\t\tthis.subscribe(\"scrollbar-vertical\", this.adjustForScrollbar.bind(this));\n\t\t\n\t\tthis.subscribe(\"redraw-blocked\", this.blockRedraw.bind(this));\n\t\tthis.subscribe(\"redraw-restored\", this.restoreRedraw.bind(this));\n\n\t\tthis.subscribe(\"table-redrawing\", this.resizeHolderWidth.bind(this));\n\t\tthis.subscribe(\"column-resized\", this.resizeHolderWidth.bind(this));\n\t\tthis.subscribe(\"column-show\", this.resizeHolderWidth.bind(this));\n\t\tthis.subscribe(\"column-hide\", this.resizeHolderWidth.bind(this));\n\t\t\n\t\tthis.registerTableFunction(\"getCalcResults\", this.getResults.bind(this));\n\t\tthis.registerTableFunction(\"recalc\", this.userRecalc.bind(this));\n\n\n\t\tthis.resizeHolderWidth();\n\t}\n\n\tresizeHolderWidth(){\n\t\tthis.topElement.style.minWidth = this.table.columnManager.headersElement.offsetWidth + \"px\";\n\t}\n\n\t\n\ttableRedraw(force){\n\t\tthis.recalc(this.table.rowManager.activeRows);\n\t\t\n\t\tif(force){\n\t\t\tthis.redraw();\n\t\t}\n\t}\n\t\n\tblockRedraw(){\n\t\tthis.blocked = true;\n\t\tthis.recalcAfterBlock = false;\n\t}\n\t\n\t\n\trestoreRedraw(){\n\t\tthis.blocked = false;\n\t\t\n\t\tif(this.recalcAfterBlock){\n\t\t\tthis.recalcAfterBlock = false;\n\t\t\tthis.recalcActiveRowsRefresh();\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\tuserRecalc(){\n\t\tthis.recalc(this.table.rowManager.activeRows);\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tblockCheck(){\n\t\tif(this.blocked){\n\t\t\tthis.recalcAfterBlock = true;\n\t\t}\n\t\t\n\t\treturn this.blocked;\n\t}\n\t\n\tvisibleRows(viewable, rows){\n\t\tif(this.topRow){\n\t\t\trows.unshift(this.topRow);\n\t\t}\n\t\t\n\t\tif(this.botRow){\n\t\t\trows.push(this.botRow);\n\t\t}\n\t\t\n\t\treturn rows;\n\t}\n\t\n\trowsUpdated(row){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.recalcRowGroup(row);\n\t\t}else {\n\t\t\tthis.recalcActiveRows();\n\t\t}\n\t}\n\t\n\trecalcActiveRowsRefresh(){\n\t\tif(this.table.options.groupBy && this.table.options.dataTreeStartExpanded && this.table.options.dataTree){\n\t\t\tthis.recalcAll();\n\t\t}else {\n\t\t\tthis.recalcActiveRows();\n\t\t}\n\t}\n\t\n\trecalcActiveRows(){\n\t\tthis.recalc(this.table.rowManager.activeRows);\n\t}\n\t\n\tcellValueChanged(cell){\n\t\tif(cell.column.definition.topCalc || cell.column.definition.bottomCalc){\n\t\t\tif(this.table.options.groupBy){\n\t\t\t\tif(this.table.options.columnCalcs == \"table\" || this.table.options.columnCalcs == \"both\"){\n\t\t\t\t\tthis.recalcActiveRows();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.table.options.columnCalcs != \"table\"){\n\t\t\t\t\tthis.recalcRowGroup(cell.row);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.recalcActiveRows();\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinitializeColumnCheck(column){\n\t\tif(column.definition.topCalc || column.definition.bottomCalc){\n\t\t\tthis.initializeColumn(column);\n\t\t}\n\t}\n\t\n\t//initialize column calcs\n\tinitializeColumn(column){\n\t\tvar def = column.definition;\n\t\t\n\t\tvar config = {\n\t\t\ttopCalcParams:def.topCalcParams || {},\n\t\t\tbotCalcParams:def.bottomCalcParams || {},\n\t\t};\n\t\t\n\t\tif(def.topCalc){\n\t\t\t\n\t\t\tswitch(typeof def.topCalc){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tif(ColumnCalcs.calculations[def.topCalc]){\n\t\t\t\t\t\tconfig.topCalc = ColumnCalcs.calculations[def.topCalc];\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Column Calc Error - No such calculation found, ignoring: \", def.topCalc);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"function\":\n\t\t\t\t\tconfig.topCalc = def.topCalc;\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif(config.topCalc){\n\t\t\t\tcolumn.modules.columnCalcs = config;\n\t\t\t\tthis.topCalcs.push(column);\n\t\t\t\t\n\t\t\t\tif(this.table.options.columnCalcs != \"group\"){\n\t\t\t\t\tthis.initializeTopRow();\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tif(def.bottomCalc){\n\t\t\tswitch(typeof def.bottomCalc){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tif(ColumnCalcs.calculations[def.bottomCalc]){\n\t\t\t\t\t\tconfig.botCalc = ColumnCalcs.calculations[def.bottomCalc];\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Column Calc Error - No such calculation found, ignoring: \", def.bottomCalc);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"function\":\n\t\t\t\t\tconfig.botCalc = def.bottomCalc;\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif(config.botCalc){\n\t\t\t\tcolumn.modules.columnCalcs = config;\n\t\t\t\tthis.botCalcs.push(column);\n\t\t\t\t\n\t\t\t\tif(this.table.options.columnCalcs != \"group\"){\n\t\t\t\t\tthis.initializeBottomRow();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\t\n\t//dummy functions to handle being mock column manager\n\tregisterColumnField(){}\n\t\n\tremoveCalcs(){\n\t\tvar changed = false;\n\t\t\n\t\tif(this.topInitialized){\n\t\t\tthis.topInitialized = false;\n\t\t\tthis.topElement.parentNode.removeChild(this.topElement);\n\t\t\tchanged = true;\n\t\t}\n\t\t\n\t\tif(this.botInitialized){\n\t\t\tthis.botInitialized = false;\n\t\t\tthis.footerRemove(this.botElement);\n\t\t\tchanged = true;\n\t\t}\n\t\t\n\t\tif(changed){\n\t\t\tthis.table.rowManager.adjustTableSize();\n\t\t}\n\t}\n\t\n\treinitializeCalcs(){\n\t\tif(this.topCalcs.length){\n\t\t\tthis.initializeTopRow();\n\t\t}\n\n\t\tif(this.botCalcs.length){\n\t\t\tthis.initializeBottomRow();\n\t\t}\n\t}\n\t\n\tinitializeTopRow(){\n\t\tvar\tfragment = document.createDocumentFragment();\n\t\t\n\t\tif(!this.topInitialized){\n\n\t\t\tfragment.appendChild(document.createElement(\"br\"));\n\t\t\tfragment.appendChild(this.topElement);\n\n\t\t\tthis.table.columnManager.getContentsElement().insertBefore(fragment, this.table.columnManager.headersElement.nextSibling);\n\t\t\tthis.topInitialized = true;\n\t\t}\n\t}\n\t\n\tinitializeBottomRow(){\n\t\tif(!this.botInitialized){\n\t\t\tthis.footerPrepend(this.botElement);\n\t\t\tthis.botInitialized = true;\n\t\t}\n\t}\n\t\n\tscrollHorizontal(left){\n\t\tif(this.botInitialized && this.botRow){\n\t\t\tthis.botElement.scrollLeft = left;\n\t\t}\n\t}\n\t\n\trecalc(rows){\n\t\tvar data, row;\n\t\t\n\t\tif(!this.blockCheck()){\n\t\t\tif(this.topInitialized || this.botInitialized){\n\t\t\t\tdata = this.rowsToData(rows);\n\t\t\t\t\n\t\t\t\tif(this.topInitialized){\n\t\t\t\t\tif(this.topRow){\n\t\t\t\t\t\tthis.topRow.deleteCells();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\trow = this.generateRow(\"top\", data);\n\t\t\t\t\tthis.topRow = row;\n\t\t\t\t\twhile(this.topElement.firstChild) this.topElement.removeChild(this.topElement.firstChild);\n\t\t\t\t\tthis.topElement.appendChild(row.getElement());\n\t\t\t\t\trow.initialize(true);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.botInitialized){\n\t\t\t\t\tif(this.botRow){\n\t\t\t\t\t\tthis.botRow.deleteCells();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\trow = this.generateRow(\"bottom\", data);\n\t\t\t\t\tthis.botRow = row;\n\t\t\t\t\twhile(this.botElement.firstChild) this.botElement.removeChild(this.botElement.firstChild);\n\t\t\t\t\tthis.botElement.appendChild(row.getElement());\n\t\t\t\t\trow.initialize(true);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.table.rowManager.adjustTableSize();\n\t\t\t\t\n\t\t\t\t//set resizable handles\n\t\t\t\tif(this.table.modExists(\"frozenColumns\")){\n\t\t\t\t\tthis.table.modules.frozenColumns.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\trecalcRowGroup(row){\n\t\tthis.recalcGroup(this.table.modules.groupRows.getRowGroup(row));\n\t}\n\t\n\trecalcAll(){\n\t\tif(this.topCalcs.length || this.botCalcs.length){\n\t\t\tif(this.table.options.columnCalcs !== \"group\"){\n\t\t\t\tthis.recalcActiveRows();\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.options.groupBy && this.table.options.columnCalcs !== \"table\"){\n\t\t\t\t\n\t\t\t\tvar groups = this.table.modules.groupRows.getChildGroups();\n\t\t\t\t\n\t\t\t\tgroups.forEach((group) => {\n\t\t\t\t\tthis.recalcGroup(group);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\t\n\trecalcGroup(group){\n\t\tvar data, rowData;\n\t\t\n\t\tif(!this.blockCheck()){\n\t\t\tif(group){\n\t\t\t\tif(group.calcs){\n\t\t\t\t\tif(group.calcs.bottom){\n\t\t\t\t\t\tdata = this.rowsToData(group.rows);\n\t\t\t\t\t\trowData = this.generateRowData(\"bottom\", data);\n\t\t\t\t\t\t\n\t\t\t\t\t\tgroup.calcs.bottom.updateData(rowData);\n\t\t\t\t\t\tgroup.calcs.bottom.reinitialize();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(group.calcs.top){\n\t\t\t\t\t\tdata = this.rowsToData(group.rows);\n\t\t\t\t\t\trowData = this.generateRowData(\"top\", data);\n\t\t\t\t\t\t\n\t\t\t\t\t\tgroup.calcs.top.updateData(rowData);\n\t\t\t\t\t\tgroup.calcs.top.reinitialize();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//generate top stats row\n\tgenerateTopRow(rows){\n\t\treturn this.generateRow(\"top\", this.rowsToData(rows));\n\t}\n\t//generate bottom stats row\n\tgenerateBottomRow(rows){\n\t\treturn this.generateRow(\"bottom\", this.rowsToData(rows));\n\t}\n\t\n\trowsToData(rows){\n\t\tvar data = [],\n\t\thasDataTreeColumnCalcs = this.table.options.dataTree && this.table.options.dataTreeChildColumnCalcs,\n\t\tdataTree = this.table.modules.dataTree;\n\n\t\trows.forEach((row) => {\n\t\t\tdata.push(row.getData());\n\n\t\t\tif(hasDataTreeColumnCalcs && row.modules.dataTree?.open){\n\t\t\t\tthis.rowsToData(dataTree.getFilteredTreeChildren(row)).forEach(dataRow =>{\n\t\t\t\t\tdata.push(row);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn data;\n\t}\n\t\n\t//generate stats row\n\tgenerateRow(pos, data){\n\t\tvar rowData = this.generateRowData(pos, data),\n\t\trow;\n\t\t\n\t\tif(this.table.modExists(\"mutator\")){\n\t\t\tthis.table.modules.mutator.disable();\n\t\t}\n\t\t\n\t\trow = new Row(rowData, this, \"calc\");\n\t\t\n\t\tif(this.table.modExists(\"mutator\")){\n\t\t\tthis.table.modules.mutator.enable();\n\t\t}\n\t\t\n\t\trow.getElement().classList.add(\"tabulator-calcs\", \"tabulator-calcs-\" + pos);\n\t\t\n\t\trow.component = false;\n\t\t\n\t\trow.getComponent = () => {\n\t\t\tif(!row.component){\n\t\t\t\trow.component = new CalcComponent(row);\n\t\t\t}\n\t\t\t\n\t\t\treturn row.component;\n\t\t};\n\t\t\n\t\trow.generateCells = () => {\n\t\t\t\n\t\t\tvar cells = [];\n\t\t\t\n\t\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\t\t\n\t\t\t\t//set field name of mock column\n\t\t\t\tthis.genColumn.setField(column.getField());\n\t\t\t\tthis.genColumn.hozAlign = column.hozAlign;\n\t\t\t\t\n\t\t\t\tif(column.definition[pos + \"CalcFormatter\"] && this.table.modExists(\"format\")){\n\t\t\t\t\tthis.genColumn.modules.format = {\n\t\t\t\t\t\tformatter: this.table.modules.format.lookupFormatter(column.definition[pos + \"CalcFormatter\"]),\n\t\t\t\t\t\tparams: column.definition[pos + \"CalcFormatterParams\"] || {},\n\t\t\t\t\t};\n\t\t\t\t}else {\n\t\t\t\t\tthis.genColumn.modules.format = {\n\t\t\t\t\t\tformatter: this.table.modules.format.lookupFormatter(\"plaintext\"),\n\t\t\t\t\t\tparams:{}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//ensure css class definition is replicated to calculation cell\n\t\t\t\tthis.genColumn.definition.cssClass = column.definition.cssClass;\n\t\t\t\t\n\t\t\t\t//generate cell and assign to correct column\n\t\t\t\tvar cell = new Cell(this.genColumn, row);\n\t\t\t\tcell.getElement();\n\t\t\t\tcell.column = column;\n\t\t\t\tcell.setWidth();\n\t\t\t\t\n\t\t\t\tcolumn.cells.push(cell);\n\t\t\t\tcells.push(cell);\n\t\t\t\t\n\t\t\t\tif(!column.visible){\n\t\t\t\t\tcell.hide();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\trow.cells = cells;\n\t\t};\n\t\t\n\t\treturn row;\n\t}\n\t\n\t//generate stats row\n\tgenerateRowData(pos, data){\n\t\tvar rowData = {},\n\t\tcalcs = pos == \"top\" ? this.topCalcs : this.botCalcs,\n\t\ttype = pos == \"top\" ? \"topCalc\" : \"botCalc\",\n\t\tparams, paramKey;\n\t\t\n\t\tcalcs.forEach(function(column){\n\t\t\tvar values = [];\n\t\t\t\n\t\t\tif(column.modules.columnCalcs && column.modules.columnCalcs[type]){\n\t\t\t\tdata.forEach(function(item){\n\t\t\t\t\tvalues.push(column.getFieldValue(item));\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tparamKey = type + \"Params\";\n\t\t\t\tparams = typeof column.modules.columnCalcs[paramKey] === \"function\" ? column.modules.columnCalcs[paramKey](values, data) : column.modules.columnCalcs[paramKey];\n\t\t\t\t\n\t\t\t\tcolumn.setFieldValue(rowData, column.modules.columnCalcs[type](values, data, params));\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn rowData;\n\t}\n\t\n\thasTopCalcs(){\n\t\treturn\t!!(this.topCalcs.length);\n\t}\n\t\n\thasBottomCalcs(){\n\t\treturn\t!!(this.botCalcs.length);\n\t}\n\t\n\t//handle table redraw\n\tredraw(){\n\t\tif(this.topRow){\n\t\t\tthis.topRow.normalizeHeight(true);\n\t\t}\n\t\tif(this.botRow){\n\t\t\tthis.botRow.normalizeHeight(true);\n\t\t}\n\t}\n\t\n\t//return the calculated\n\tgetResults(){\n\t\tvar results = {},\n\t\tgroups;\n\t\t\n\t\tif(this.table.options.groupBy && this.table.modExists(\"groupRows\")){\n\t\t\tgroups = this.table.modules.groupRows.getGroups(true);\n\t\t\t\n\t\t\tgroups.forEach((group) => {\n\t\t\t\tresults[group.getKey()] = this.getGroupResults(group);\n\t\t\t});\n\t\t}else {\n\t\t\tresults = {\n\t\t\t\ttop: this.topRow ? this.topRow.getData() : {},\n\t\t\t\tbottom: this.botRow ? this.botRow.getData() : {},\n\t\t\t};\n\t\t}\n\t\t\n\t\treturn results;\n\t}\n\t\n\t//get results from a group\n\tgetGroupResults(group){\n\t\tvar groupObj = group._getSelf(),\n\t\tsubGroups = group.getSubGroups(),\n\t\tsubGroupResults = {},\n\t\tresults = {};\n\t\t\n\t\tsubGroups.forEach((subgroup) => {\n\t\t\tsubGroupResults[subgroup.getKey()] = this.getGroupResults(subgroup);\n\t\t});\n\t\t\n\t\tresults = {\n\t\t\ttop: groupObj.calcs.top ? groupObj.calcs.top.getData() : {},\n\t\t\tbottom: groupObj.calcs.bottom ? groupObj.calcs.bottom.getData() : {},\n\t\t\tgroups: subGroupResults,\n\t\t};\n\t\t\n\t\treturn results;\n\t}\n\t\n\tadjustForScrollbar(width){\n\t\tif(this.botRow){\n\t\t\tif(this.table.rtl){\n\t\t\t\tthis.botElement.style.paddingLeft = width + \"px\";\n\t\t\t}else {\n\t\t\t\tthis.botElement.style.paddingRight = width + \"px\";\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass DataTree extends Module{\n\n\tstatic moduleName = \"dataTree\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.indent = 10;\n\t\tthis.field = \"\";\n\t\tthis.collapseEl = null;\n\t\tthis.expandEl = null;\n\t\tthis.branchEl = null;\n\t\tthis.elementField = false;\n\n\t\tthis.startOpen = function(){};\n\n\t\tthis.registerTableOption(\"dataTree\", false); //enable data tree\n\t\tthis.registerTableOption(\"dataTreeFilter\", true); //filter child rows\n\t\tthis.registerTableOption(\"dataTreeSort\", true); //sort child rows\n\t\tthis.registerTableOption(\"dataTreeElementColumn\", false);\n\t\tthis.registerTableOption(\"dataTreeBranchElement\", true);//show data tree branch element\n\t\tthis.registerTableOption(\"dataTreeChildIndent\", 9); //data tree child indent in px\n\t\tthis.registerTableOption(\"dataTreeChildField\", \"_children\");//data tre column field to look for child rows\n\t\tthis.registerTableOption(\"dataTreeCollapseElement\", false);//data tree row collapse element\n\t\tthis.registerTableOption(\"dataTreeExpandElement\", false);//data tree row expand element\n\t\tthis.registerTableOption(\"dataTreeStartExpanded\", false);\n\t\tthis.registerTableOption(\"dataTreeChildColumnCalcs\", false);//include visible data tree rows in column calculations\n\t\tthis.registerTableOption(\"dataTreeSelectPropagate\", false);//selecting a parent row selects its children\n\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"treeCollapse\", this.collapseRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"treeExpand\", this.expandRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"treeToggle\", this.toggleRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"getTreeParent\", this.getTreeParent.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"getTreeChildren\", this.getRowChildren.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"addTreeChild\", this.addTreeChildRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"isTreeExpanded\", this.isRowExpanded.bind(this));\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.dataTree){\n\t\t\tvar dummyEl = null,\n\t\t\toptions = this.table.options;\n\n\t\t\tthis.field = options.dataTreeChildField;\n\t\t\tthis.indent = options.dataTreeChildIndent;\n\n\t\t\tif(this.options(\"movableRows\")){\n\t\t\t\tconsole.warn(\"The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior\");\n\t\t\t}\n\n\t\t\tif(options.dataTreeBranchElement){\n\n\t\t\t\tif(options.dataTreeBranchElement === true){\n\t\t\t\t\tthis.branchEl = document.createElement(\"div\");\n\t\t\t\t\tthis.branchEl.classList.add(\"tabulator-data-tree-branch\");\n\t\t\t\t}else {\n\t\t\t\t\tif(typeof options.dataTreeBranchElement === \"string\"){\n\t\t\t\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\t\t\t\tdummyEl.innerHTML = options.dataTreeBranchElement;\n\t\t\t\t\t\tthis.branchEl = dummyEl.firstChild;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.branchEl = options.dataTreeBranchElement;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.branchEl = document.createElement(\"div\");\n\t\t\t\tthis.branchEl.classList.add(\"tabulator-data-tree-branch-empty\");\n\t\t\t}\n\n\t\t\tif(options.dataTreeCollapseElement){\n\t\t\t\tif(typeof options.dataTreeCollapseElement === \"string\"){\n\t\t\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\t\t\tdummyEl.innerHTML = options.dataTreeCollapseElement;\n\t\t\t\t\tthis.collapseEl = dummyEl.firstChild;\n\t\t\t\t}else {\n\t\t\t\t\tthis.collapseEl = options.dataTreeCollapseElement;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.collapseEl = document.createElement(\"div\");\n\t\t\t\tthis.collapseEl.classList.add(\"tabulator-data-tree-control\");\n\t\t\t\tthis.collapseEl.tabIndex = 0;\n\t\t\t\tthis.collapseEl.innerHTML = \"<div class='tabulator-data-tree-control-collapse'></div>\";\n\t\t\t}\n\n\t\t\tif(options.dataTreeExpandElement){\n\t\t\t\tif(typeof options.dataTreeExpandElement === \"string\"){\n\t\t\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\t\t\tdummyEl.innerHTML = options.dataTreeExpandElement;\n\t\t\t\t\tthis.expandEl = dummyEl.firstChild;\n\t\t\t\t}else {\n\t\t\t\t\tthis.expandEl = options.dataTreeExpandElement;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.expandEl = document.createElement(\"div\");\n\t\t\t\tthis.expandEl.classList.add(\"tabulator-data-tree-control\");\n\t\t\t\tthis.expandEl.tabIndex = 0;\n\t\t\t\tthis.expandEl.innerHTML = \"<div class='tabulator-data-tree-control-expand'></div>\";\n\t\t\t}\n\n\n\t\t\tswitch(typeof options.dataTreeStartExpanded){\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tthis.startOpen = function(row, index){\n\t\t\t\t\t\treturn options.dataTreeStartExpanded;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\tthis.startOpen = options.dataTreeStartExpanded;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis.startOpen = function(row, index){\n\t\t\t\t\t\treturn options.dataTreeStartExpanded[index];\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.subscribe(\"row-init\", this.initializeRow.bind(this));\n\t\t\tthis.subscribe(\"row-layout-after\", this.layoutRow.bind(this));\n\t\t\tthis.subscribe(\"row-deleting\", this.rowDeleting.bind(this));\n\t\t\tthis.subscribe(\"row-deleted\", this.rowDelete.bind(this),0);\n\t\t\tthis.subscribe(\"row-data-changed\", this.rowDataChanged.bind(this), 10);\n\t\t\tthis.subscribe(\"cell-value-updated\", this.cellValueChanged.bind(this));\n\t\t\tthis.subscribe(\"edit-cancelled\", this.cellValueChanged.bind(this));\n\t\t\tthis.subscribe(\"column-moving-rows\", this.columnMoving.bind(this));\n\t\t\tthis.subscribe(\"table-built\", this.initializeElementField.bind(this));\n\t\t\tthis.subscribe(\"table-redrawing\", this.tableRedrawing.bind(this));\n\n\t\t\tthis.registerDisplayHandler(this.getRows.bind(this), 30);\n\t\t}\n\t}\n\n\ttableRedrawing(force){\n\t\tvar rows;\n\n\t\tif(force){\n\t\t\trows = this.table.rowManager.getRows();\n\t\t\t\n\t\t\trows.forEach((row) => {\n\t\t\t\tthis.reinitializeRowChildren(row);\n\t\t\t});\n\t\t}\n\t}\n\n\tinitializeElementField(){\n\t\tvar firstCol = this.table.columnManager.getFirstVisibleColumn();\n\n\t\tthis.elementField = this.table.options.dataTreeElementColumn || (firstCol ? firstCol.field : false);\n\t}\n\t\n\tgetRowChildren(row){\n\t\treturn this.getTreeChildren(row, true);\n\t}\n\n\tcolumnMoving(){\n\t\tvar rows = [];\n\n\t\tthis.table.rowManager.rows.forEach((row) => {\n\t\t\trows = rows.concat(this.getTreeChildren(row, false, true));\n\t\t});\n\n\t\treturn rows;\n\t}\n\n\trowDataChanged(row, visible, updatedData){\n\t\tif(this.redrawNeeded(updatedData)){\n\t\t\tthis.initializeRow(row);\n\n\t\t\tif(visible){\n\t\t\t\tthis.layoutRow(row);\n\t\t\t\tthis.refreshData(true);\n\t\t\t}\n\t\t}\n\t}\n\n\tcellValueChanged(cell){\n\t\tvar field = cell.column.getField();\n\n\t\tif(field === this.elementField){\n\t\t\tthis.layoutRow(cell.row);\n\t\t}\n\t}\n\n\tinitializeRow(row){\n\t\tvar childArray = row.getData()[this.field];\n\t\tvar isArray = Array.isArray(childArray);\n\n\t\tvar children = isArray || (!isArray && typeof childArray === \"object\" && childArray !== null);\n\n\t\tif(!children && row.modules.dataTree && row.modules.dataTree.branchEl){\n\t\t\trow.modules.dataTree.branchEl.parentNode.removeChild(row.modules.dataTree.branchEl);\n\t\t}\n\n\t\tif(!children && row.modules.dataTree && row.modules.dataTree.controlEl){\n\t\t\trow.modules.dataTree.controlEl.parentNode.removeChild(row.modules.dataTree.controlEl);\n\t\t}\n\n\t\trow.modules.dataTree = {\n\t\t\tindex: row.modules.dataTree ? row.modules.dataTree.index : 0,\n\t\t\topen: children ? (row.modules.dataTree ? row.modules.dataTree.open : this.startOpen(row.getComponent(), 0)) : false,\n\t\t\tcontrolEl: row.modules.dataTree && children ? row.modules.dataTree.controlEl : false,\n\t\t\tbranchEl: row.modules.dataTree && children ? row.modules.dataTree.branchEl : false,\n\t\t\tparent: row.modules.dataTree ? row.modules.dataTree.parent : false,\n\t\t\tchildren:children,\n\t\t};\n\t}\n\n\treinitializeRowChildren(row){\n\t\tvar children = this.getTreeChildren(row, false, true);\n\n\t\tchildren.forEach(function(child){\n\t\t\tchild.reinitialize(true);\n\t\t});\n\t}\n\n\tlayoutRow(row){\n\t\tvar cell = this.elementField ? row.getCell(this.elementField) : row.getCells()[0],\n\t\tel = cell.getElement(),\n\t\tconfig = row.modules.dataTree;\n\n\t\tif(config.branchEl){\n\t\t\tif(config.branchEl.parentNode){\n\t\t\t\tconfig.branchEl.parentNode.removeChild(config.branchEl);\n\t\t\t}\n\t\t\tconfig.branchEl = false;\n\t\t}\n\n\t\tif(config.controlEl){\n\t\t\tif(config.controlEl.parentNode){\n\t\t\t\tconfig.controlEl.parentNode.removeChild(config.controlEl);\n\t\t\t}\n\t\t\tconfig.controlEl = false;\n\t\t}\n\n\t\tthis.generateControlElement(row, el);\n\n\t\trow.getElement().classList.add(\"tabulator-tree-level-\" + config.index);\n\n\t\tif(config.index){\n\t\t\tif(this.branchEl){\n\t\t\t\tconfig.branchEl = this.branchEl.cloneNode(true);\n\t\t\t\tel.insertBefore(config.branchEl, el.firstChild);\n\n\t\t\t\tif(this.table.rtl){\n\t\t\t\t\tconfig.branchEl.style.marginRight = (((config.branchEl.offsetWidth + config.branchEl.style.marginLeft) * (config.index - 1)) + (config.index * this.indent)) + \"px\";\n\t\t\t\t}else {\n\t\t\t\t\tconfig.branchEl.style.marginLeft = (((config.branchEl.offsetWidth + config.branchEl.style.marginRight) * (config.index - 1)) + (config.index * this.indent)) + \"px\";\n\t\t\t\t}\n\t\t\t}else {\n\n\t\t\t\tif(this.table.rtl){\n\t\t\t\t\tel.style.paddingRight = parseInt(window.getComputedStyle(el, null).getPropertyValue('padding-right')) + (config.index * this.indent) + \"px\";\n\t\t\t\t}else {\n\t\t\t\t\tel.style.paddingLeft = parseInt(window.getComputedStyle(el, null).getPropertyValue('padding-left')) + (config.index * this.indent) + \"px\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgenerateControlElement(row, el){\n\t\tvar config = row.modules.dataTree,\n\t\toldControl = config.controlEl;\n\n\t\tel = el || row.getCells()[0].getElement();\n\n\t\tif(config.children !== false){\n\n\t\t\tif(config.open){\n\t\t\t\tconfig.controlEl = this.collapseEl.cloneNode(true);\n\t\t\t\tconfig.controlEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.collapseRow(row);\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconfig.controlEl = this.expandEl.cloneNode(true);\n\t\t\t\tconfig.controlEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.expandRow(row);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconfig.controlEl.addEventListener(\"mousedown\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\n\t\t\tif(oldControl && oldControl.parentNode === el){\n\t\t\t\toldControl.parentNode.replaceChild(config.controlEl,oldControl);\n\t\t\t}else {\n\t\t\t\tel.insertBefore(config.controlEl, el.firstChild);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetRows(rows){\n\t\tvar output = [];\n\n\t\trows.forEach((row, i) => {\n\t\t\tvar config, children;\n\n\t\t\toutput.push(row);\n\n\t\t\tif(row instanceof Row){\n\n\t\t\t\trow.create();\n\n\t\t\t\tconfig = row.modules.dataTree;\n\n\t\t\t\tif(!config.index && config.children !== false){\n\t\t\t\t\tchildren = this.getChildren(row, false, true);\n\n\t\t\t\t\tchildren.forEach((child) => {\n\t\t\t\t\t\tchild.create();\n\t\t\t\t\t\toutput.push(child);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\tgetChildren(row, allChildren, sortOnly){\n\t\tvar config = row.modules.dataTree,\n\t\tchildren = [],\n\t\toutput = [];\n\n\t\tif(config.children !== false && (config.open || allChildren)){\n\t\t\tif(!Array.isArray(config.children)){\n\t\t\t\tconfig.children = this.generateChildren(row);\n\t\t\t}\n\n\t\t\tif(this.table.modExists(\"filter\") && this.table.options.dataTreeFilter){\n\t\t\t\tchildren = this.table.modules.filter.filter(config.children);\n\t\t\t}else {\n\t\t\t\tchildren = config.children;\n\t\t\t}\n\n\t\t\tif(this.table.modExists(\"sort\") && this.table.options.dataTreeSort){\n\t\t\t\tthis.table.modules.sort.sort(children, sortOnly);\n\t\t\t}\n\n\t\t\tchildren.forEach((child) => {\n\t\t\t\toutput.push(child);\n\n\t\t\t\tvar subChildren = this.getChildren(child, false, true);\n\n\t\t\t\tsubChildren.forEach((sub) => {\n\t\t\t\t\toutput.push(sub);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tgenerateChildren(row){\n\t\tvar children = [];\n\n\t\tvar childArray = row.getData()[this.field];\n\n\t\tif(!Array.isArray(childArray)){\n\t\t\tchildArray = [childArray];\n\t\t}\n\n\t\tchildArray.forEach((childData) => {\n\t\t\tvar childRow = new Row(childData || {}, this.table.rowManager);\n\n\t\t\tchildRow.create();\n\n\t\t\tchildRow.modules.dataTree.index = row.modules.dataTree.index + 1;\n\t\t\tchildRow.modules.dataTree.parent = row;\n\n\t\t\tif(childRow.modules.dataTree.children){\n\t\t\t\tchildRow.modules.dataTree.open = this.startOpen(childRow.getComponent(), childRow.modules.dataTree.index);\n\t\t\t}\n\t\t\tchildren.push(childRow);\n\t\t});\n\n\t\treturn children;\n\t}\n\n\texpandRow(row, silent){\n\t\tvar config = row.modules.dataTree;\n\n\t\tif(config.children !== false){\n\t\t\tconfig.open = true;\n\n\t\t\trow.reinitialize();\n\n\t\t\tthis.refreshData(true);\n\n\t\t\tthis.dispatchExternal(\"dataTreeRowExpanded\", row.getComponent(), row.modules.dataTree.index);\n\t\t}\n\t}\n\n\tcollapseRow(row){\n\t\tvar config = row.modules.dataTree;\n\n\t\tif(config.children !== false){\n\t\t\tconfig.open = false;\n\n\t\t\trow.reinitialize();\n\n\t\t\tthis.refreshData(true);\n\n\t\t\tthis.dispatchExternal(\"dataTreeRowCollapsed\", row.getComponent(), row.modules.dataTree.index);\n\t\t}\n\t}\n\n\ttoggleRow(row){\n\t\tvar config = row.modules.dataTree;\n\n\t\tif(config.children !== false){\n\t\t\tif(config.open){\n\t\t\t\tthis.collapseRow(row);\n\t\t\t}else {\n\t\t\t\tthis.expandRow(row);\n\t\t\t}\n\t\t}\n\t}\n\n\tisRowExpanded(row){\n\t\treturn row.modules.dataTree.open;\n\t}\n\n\tgetTreeParent(row){\n\t\treturn row.modules.dataTree.parent ? row.modules.dataTree.parent.getComponent() : false;\n\t}\n\n\tgetTreeParentRoot(row){\n\t\treturn row.modules.dataTree && row.modules.dataTree.parent ? this.getTreeParentRoot(row.modules.dataTree.parent) : row;\n\t}\n\n\tgetFilteredTreeChildren(row){\n\t\tvar config = row.modules.dataTree,\n\t\toutput = [], children;\n\n\t\tif(config.children){\n\n\t\t\tif(!Array.isArray(config.children)){\n\t\t\t\tconfig.children = this.generateChildren(row);\n\t\t\t}\n\n\t\t\tif(this.table.modExists(\"filter\") && this.table.options.dataTreeFilter){\n\t\t\t\tchildren = this.table.modules.filter.filter(config.children);\n\t\t\t}else {\n\t\t\t\tchildren = config.children;\n\t\t\t}\n\n\t\t\tchildren.forEach((childRow) => {\n\t\t\t\tif(childRow instanceof Row){\n\t\t\t\t\toutput.push(childRow);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\trowDeleting(row){\n\t\tvar config = row.modules.dataTree;\n\n\t\tif (config && config.children && Array.isArray(config.children)){\n\t\t\tconfig.children.forEach((childRow) => {\n\t\t\t\tif(childRow instanceof Row){\n\t\t\t\t\tchildRow.wipe();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\trowDelete(row){\n\t\tvar parent = row.modules.dataTree.parent,\n\t\tchildIndex;\n\n\t\tif(parent){\n\t\t\tchildIndex = this.findChildIndex(row, parent);\n\n\t\t\tif(childIndex !== false){\n\t\t\t\tparent.data[this.field].splice(childIndex, 1);\n\t\t\t}\n\n\t\t\tif(!parent.data[this.field].length){\n\t\t\t\tdelete parent.data[this.field];\n\t\t\t}\n\n\t\t\tthis.initializeRow(parent);\n\t\t\tthis.layoutRow(parent);\n\t\t}\n\n\t\tthis.refreshData(true);\n\t}\n\n\taddTreeChildRow(row, data, top, index){\n\t\tvar childIndex = false;\n\n\t\tif(typeof data === \"string\"){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\n\t\tif(!Array.isArray(row.data[this.field])){\n\t\t\trow.data[this.field] = [];\n\n\t\t\trow.modules.dataTree.open = this.startOpen(row.getComponent(), row.modules.dataTree.index);\n\t\t}\n\n\t\tif(typeof index !== \"undefined\"){\n\t\t\tchildIndex = this.findChildIndex(index, row);\n\n\t\t\tif(childIndex !== false){\n\t\t\t\trow.data[this.field].splice((top ? childIndex : childIndex + 1), 0, data);\n\t\t\t}\n\t\t}\n\n\t\tif(childIndex === false){\n\t\t\tif(top){\n\t\t\t\trow.data[this.field].unshift(data);\n\t\t\t}else {\n\t\t\t\trow.data[this.field].push(data);\n\t\t\t}\n\t\t}\n\n\t\tthis.initializeRow(row);\n\t\tthis.layoutRow(row);\n\n\t\tthis.refreshData(true);\n\t}\n\n\tfindChildIndex(subject, parent){\n\t\tvar match = false;\n\n\t\tif(typeof subject == \"object\"){\n\n\t\t\tif(subject instanceof Row){\n\t\t\t\t//subject is row element\n\t\t\t\tmatch = subject.data;\n\t\t\t}else if(subject instanceof RowComponent){\n\t\t\t\t//subject is public row component\n\t\t\t\tmatch = subject._getSelf().data;\n\t\t\t}else if(typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement){\n\t\t\t\tif(parent.modules.dataTree){\n\t\t\t\t\tmatch = parent.modules.dataTree.children.find((childRow) => {\n\t\t\t\t\t\treturn childRow instanceof Row ? childRow.element === subject : false;\n\t\t\t\t\t});\n\n\t\t\t\t\tif(match){\n\t\t\t\t\t\tmatch = match.data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else if(subject === null){\n\t\t\t\tmatch = false;\n\t\t\t}\n\n\t\t}else if(typeof subject == \"undefined\"){\n\t\t\tmatch = false;\n\t\t}else {\n\t\t\t//subject should be treated as the index of the row\n\t\t\tmatch = parent.data[this.field].find((row) => {\n\t\t\t\treturn row.data[this.table.options.index] == subject;\n\t\t\t});\n\t\t}\n\n\t\tif(match){\n\n\t\t\tif(Array.isArray(parent.data[this.field])){\n\t\t\t\tmatch = parent.data[this.field].indexOf(match);\n\t\t\t}\n\n\t\t\tif(match == -1){\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t}\n\n\t\t//catch all for any other type of input\n\n\t\treturn match;\n\t}\n\n\tgetTreeChildren(row, component, recurse){\n\t\tvar config = row.modules.dataTree,\n\t\toutput = [];\n\n\t\tif(config && config.children){\n\n\t\t\tif(!Array.isArray(config.children)){\n\t\t\t\tconfig.children = this.generateChildren(row);\n\t\t\t}\n\n\t\t\tconfig.children.forEach((childRow) => {\n\t\t\t\tif(childRow instanceof Row){\n\t\t\t\t\toutput.push(component ? childRow.getComponent() : childRow);\n\n\t\t\t\t\tif(recurse){\n\t\t\t\t\t\tthis.getTreeChildren(childRow, component, recurse).forEach(child => {\n\t\t\t\t\t\t\toutput.push(child);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tgetChildField(){\n\t\treturn this.field;\n\t}\n\n\tredrawNeeded(data){\n\t\treturn (this.field ? typeof data[this.field] !== \"undefined\" : false) || (this.elementField ? typeof data[this.elementField] !== \"undefined\" : false);\n\t}\n}\n\nfunction csv$1(list, options = {}, setFileContents){\n\tvar delimiter = options.delimiter ? options.delimiter : \",\",\n\tfileContents = [],\n\theaders = [];\n\n\tlist.forEach((row) => {\n\t\tvar item = [];\n\n\t\tswitch(row.type){\n\t\t\tcase \"group\":\n\t\t\t\tconsole.warn(\"Download Warning - CSV downloader cannot process row groups\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tconsole.warn(\"Download Warning - CSV downloader cannot process column calculations\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"header\":\n\t\t\t\trow.columns.forEach((col, i) => {\n\t\t\t\t\tif(col && col.depth === 1){\n\t\t\t\t\t\theaders[i] = typeof col.value == \"undefined\"  || col.value === null ? \"\" : ('\"' + String(col.value).split('\"').join('\"\"') + '\"');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\trow.columns.forEach((col) => {\n\n\t\t\t\t\tif(col){\n\n\t\t\t\t\t\tswitch(typeof col.value){\n\t\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\t\tcol.value = col.value !== null ? JSON.stringify(col.value) : \"\";\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\t\tcol.value = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\titem.push('\"' + String(col.value).split('\"').join('\"\"') + '\"');\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfileContents.push(item.join(delimiter));\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(headers.length){\n\t\tfileContents.unshift(headers.join(delimiter));\n\t}\n\n\tfileContents = fileContents.join(\"\\n\");\n\n\tif(options.bom){\n\t\tfileContents = \"\\ufeff\" + fileContents;\n\t}\n\n\tsetFileContents(fileContents, \"text/csv\");\n}\n\nfunction json$2(list, options, setFileContents){\n\tvar fileContents = [];\n\n\tlist.forEach((row) => {\n\t\tvar item = {};\n\n\t\tswitch(row.type){\n\t\t\tcase \"header\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process row groups\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process column calculations\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\trow.columns.forEach((col) => {\n\t\t\t\t\tif(col){\n\t\t\t\t\t\titem[col.component.getTitleDownload() || col.component.getField()] = col.value;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfileContents.push(item);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tfileContents = JSON.stringify(fileContents, null, '\\t');\n\n\tsetFileContents(fileContents, \"application/json\");\n}\n\nfunction pdf(list, options = {}, setFileContents){\n\tvar header = [],\n\tbody = [],\n\tautoTableParams = {},\n\trowGroupStyles = options.rowGroupStyles || {\n\t\tfontStyle: \"bold\",\n\t\tfontSize: 12,\n\t\tcellPadding: 6,\n\t\tfillColor: 220,\n\t},\n\trowCalcStyles = options.rowCalcStyles || {\n\t\tfontStyle: \"bold\",\n\t\tfontSize: 10,\n\t\tcellPadding: 4,\n\t\tfillColor: 232,\n\t},\n\tjsPDFParams = options.jsPDF || {},\n\ttitle = options.title ? options.title : \"\",\n\tjspdfLib, doc;\n\n\tif(!jsPDFParams.orientation){\n\t\tjsPDFParams.orientation = options.orientation || \"landscape\";\n\t}\n\n\tif(!jsPDFParams.unit){\n\t\tjsPDFParams.unit = \"pt\";\n\t}\n\n\t//parse row list\n\tlist.forEach((row) => {\n\t\tswitch(row.type){\n\t\t\tcase \"header\":\n\t\t\t\theader.push(parseRow(row));\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tbody.push(parseRow(row, rowGroupStyles));\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tbody.push(parseRow(row, rowCalcStyles));\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\tbody.push(parseRow(row));\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tfunction parseRow(row, styles){\n\t\tvar rowData = [];\n\n\t\trow.columns.forEach((col) =>{\n\t\t\tvar cell;\n\n\t\t\tif(col){\n\t\t\t\tswitch(typeof col.value){\n\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\tcol.value = col.value !== null ? JSON.stringify(col.value) : \"\";\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\tcol.value = \"\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcell = {\n\t\t\t\t\tcontent:col.value,\n\t\t\t\t\tcolSpan:col.width,\n\t\t\t\t\trowSpan:col.height,\n\t\t\t\t};\n\n\t\t\t\tif(styles){\n\t\t\t\t\tcell.styles = styles;\n\t\t\t\t}\n\n\t\t\t\trowData.push(cell);\n\t\t\t}\n\t\t});\n\n\t\treturn rowData;\n\t}\n\n\n\t//configure PDF\n\tjspdfLib = this.dependencyRegistry.lookup(\"jspdf\", \"jsPDF\");\n\tdoc = new jspdfLib(jsPDFParams); //set document to landscape, better for most tables\n\n\tif(options.autoTable){\n\t\tif(typeof options.autoTable === \"function\"){\n\t\t\tautoTableParams = options.autoTable(doc) || {};\n\t\t}else {\n\t\t\tautoTableParams = options.autoTable;\n\t\t}\n\t}\n\n\tif(title){\n\t\tautoTableParams.didDrawPage = function(data) {\n\t\t\tdoc.text(title, 40, 30);\n\t\t};\n\t}\n\n\tautoTableParams.head = header;\n\tautoTableParams.body = body;\n\n\tdoc.autoTable(autoTableParams);\n\n\tif(options.documentProcessing){\n\t\toptions.documentProcessing(doc);\n\t}\n\n\tsetFileContents(doc.output(\"arraybuffer\"), \"application/pdf\");\n}\n\nfunction xlsx$1(list, options, setFileContents){\n\tvar self = this,\n\tsheetName = options.sheetName || \"Sheet1\",\n\tXLSXLib = this.dependencyRegistry.lookup(\"XLSX\"),\n\tworkbook = XLSXLib.utils.book_new(),\n\ttableFeatures = new CoreFeature(this),\n\tcompression =  'compress' in options ? options.compress : true,\n\twriteOptions = options.writeOptions || {bookType:'xlsx', bookSST:true, compression},\n\toutput;\n\n\twriteOptions.type = 'binary';\n\n\tworkbook.SheetNames = [];\n\tworkbook.Sheets = {};\n\n\tfunction generateSheet(){\n\t\tvar rows = [],\n\t\tmerges = [],\n\t\tworksheet = {},\n\t\trange = {s: {c:0, r:0}, e: {c:(list[0] ? list[0].columns.reduce((a, b) => a + (b && b.width ? b.width : 1), 0) : 0), r:list.length }};\n\n\t\t//parse row list\n\t\tlist.forEach((row, i) => {\n\t\t\tvar rowData = [];\n\n\t\t\trow.columns.forEach(function(col, j){\n\n\t\t\t\tif(col){\n\t\t\t\t\trowData.push(!(col.value instanceof Date) && typeof col.value === \"object\" ? JSON.stringify(col.value) : col.value);\n\n\t\t\t\t\tif(col.width > 1 || col.height > -1){\n\t\t\t\t\t\tif(col.height > 1 || col.width > 1){\n\t\t\t\t\t\t\tmerges.push({s:{r:i,c:j},e:{r:i + col.height - 1,c:j + col.width - 1}});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\trowData.push(\"\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trows.push(rowData);\n\t\t});\n\n\t\t//convert rows to worksheet\n\t\tXLSXLib.utils.sheet_add_aoa(worksheet, rows);\n\n\t\tworksheet['!ref'] = XLSXLib.utils.encode_range(range);\n\n\t\tif(merges.length){\n\t\t\tworksheet[\"!merges\"] = merges;\n\t\t}\n\n\t\treturn worksheet;\n\t}\n\n\tif(options.sheetOnly){\n\t\tsetFileContents(generateSheet());\n\t\treturn;\n\t}\n\n\tif(options.sheets){\n\t\tfor(var sheet in options.sheets){\n\n\t\t\tif(options.sheets[sheet] === true){\n\t\t\t\tworkbook.SheetNames.push(sheet);\n\t\t\t\tworkbook.Sheets[sheet] = generateSheet();\n\t\t\t}else {\n\n\t\t\t\tworkbook.SheetNames.push(sheet);\n\n\t\t\t\ttableFeatures.commsSend(options.sheets[sheet], \"download\", \"intercept\",{\n\t\t\t\t\ttype:\"xlsx\",\n\t\t\t\t\toptions:{sheetOnly:true},\n\t\t\t\t\tactive:self.active,\n\t\t\t\t\tintercept:function(data){\n\t\t\t\t\t\tworkbook.Sheets[sheet] = data;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}else {\n\t\tworkbook.SheetNames.push(sheetName);\n\t\tworkbook.Sheets[sheetName] = generateSheet();\n\t}\n\n\tif(options.documentProcessing){\n\t\tworkbook = options.documentProcessing(workbook);\n\t}\n\n\t//convert workbook to binary array\n\tfunction s2ab(s) {\n\t\tvar buf = new ArrayBuffer(s.length);\n\t\tvar view = new Uint8Array(buf);\n\t\tfor (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\t\treturn buf;\n\t}\n\n\toutput = XLSXLib.write(workbook, writeOptions);\n\n\tsetFileContents(s2ab(output), \"application/octet-stream\");\n}\n\nfunction html$1(list, options, setFileContents){\n\tif(this.modExists(\"export\", true)){\n\t\tsetFileContents(this.modules.export.generateHTMLTable(list), \"text/html\");\n\t}\n}\n\nfunction jsonLines (list, options, setFileContents) {\n\tconst fileContents = [];\n\n\tlist.forEach((row) => {\n\t\tconst item = {};\n\n\t\tswitch (row.type) {\n\t\t\tcase \"header\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process row groups\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process column calculations\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\trow.columns.forEach((col) => {\n\t\t\t\t\tif (col) {\n\t\t\t\t\t\titem[col.component.getTitleDownload() || col.component.getField()] = col.value;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfileContents.push(JSON.stringify(item));\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tsetFileContents(fileContents.join(\"\\n\"), \"application/x-ndjson\");\n}\n\nvar defaultDownloaders = {\n\tcsv:csv$1,\n\tjson:json$2,\n\tjsonLines:jsonLines,\n\tpdf:pdf,\n\txlsx:xlsx$1,\n\thtml:html$1,\n};\n\nclass Download extends Module{\n\n\tstatic moduleName = \"download\";\n\n\t//load defaults\n\tstatic downloaders = defaultDownloaders;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.registerTableOption(\"downloadEncoder\", function(data, mimeType){\n\t\t\treturn new Blob([data],{type:mimeType});\n\t\t}); //function to manipulate download data\n\t\tthis.registerTableOption(\"downloadConfig\", {}); //download config\n\t\tthis.registerTableOption(\"downloadRowRange\", \"active\"); //restrict download to active rows only\n\n\t\tthis.registerColumnOption(\"download\");\n\t\tthis.registerColumnOption(\"titleDownload\");\n\t}\n\n\tinitialize(){\n\t\tthis.deprecatedOptionsCheck();\n\n\t\tthis.registerTableFunction(\"download\", this.download.bind(this));\n\t\tthis.registerTableFunction(\"downloadToTab\", this.downloadToTab.bind(this));\n\t}\n\n\tdeprecatedOptionsCheck(){\n\n\t}\t\n\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\n\tdownloadToTab(type, filename, options, active){\n\t\tthis.download(type, filename, options, active, true);\n\t}\n\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\n\t//trigger file download\n\tdownload(type, filename, options, range, interceptCallback){\n\t\tvar downloadFunc = false;\n\n\t\tfunction buildLink(data, mime){\n\t\t\tif(interceptCallback){\n\t\t\t\tif(interceptCallback === true){\n\t\t\t\t\tthis.triggerDownload(data, mime, type, filename, true);\n\t\t\t\t}else {\n\t\t\t\t\tinterceptCallback(data);\n\t\t\t\t}\n\n\t\t\t}else {\n\t\t\t\tthis.triggerDownload(data, mime, type, filename);\n\t\t\t}\n\t\t}\n\n\t\tif(typeof type == \"function\"){\n\t\t\tdownloadFunc = type;\n\t\t}else {\n\t\t\tif(Download.downloaders[type]){\n\t\t\t\tdownloadFunc = Download.downloaders[type];\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Download Error - No such download type found: \", type);\n\t\t\t}\n\t\t}\n\n\t\tif(downloadFunc){\n\t\t\tvar list = this.generateExportList(range);\n\n\t\t\tdownloadFunc.call(this.table, list , options || {}, buildLink.bind(this));\n\t\t}\n\t}\n\n\tgenerateExportList(range){\n\t\tvar list = this.table.modules.export.generateExportList(this.table.options.downloadConfig, false, range || this.table.options.downloadRowRange, \"download\");\n\n\t\t//assign group header formatter\n\t\tvar groupHeader = this.table.options.groupHeaderDownload;\n\n\t\tif(groupHeader && !Array.isArray(groupHeader)){\n\t\t\tgroupHeader = [groupHeader];\n\t\t}\n\n\t\tlist.forEach((row) => {\n\t\t\tvar group;\n\n\t\t\tif(row.type === \"group\"){\n\t\t\t\tgroup = row.columns[0];\n\n\t\t\t\tif(groupHeader && groupHeader[row.indent]){\n\t\t\t\t\tgroup.value = groupHeader[row.indent](group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn list;\n\t}\n\n\ttriggerDownload(data, mime, type, filename, newTab){\n\t\tvar element = document.createElement('a'),\n\t\tblob = this.table.options.downloadEncoder(data, mime);\n\n\t\tif(blob){\n\t\t\tif(newTab){\n\t\t\t\twindow.open(window.URL.createObjectURL(blob));\n\t\t\t}else {\n\t\t\t\tfilename = filename || \"Tabulator.\" + (typeof type === \"function\" ? \"txt\" : type);\n\t\t\t\t\n\t\t\t\tif(navigator.msSaveOrOpenBlob){\n\t\t\t\t\tnavigator.msSaveOrOpenBlob(blob, filename);\n\t\t\t\t}else {\n\t\t\t\t\telement.setAttribute('href', window.URL.createObjectURL(blob));\n\n\t\t\t\t\t//set file title\n\t\t\t\t\telement.setAttribute('download', filename);\n\n\t\t\t\t\t//trigger download\n\t\t\t\t\telement.style.display = 'none';\n\t\t\t\t\tdocument.body.appendChild(element);\n\t\t\t\t\telement.click();\n\n\t\t\t\t\t//remove temporary link element\n\t\t\t\t\tdocument.body.removeChild(element);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.dispatchExternal(\"downloadComplete\");\n\t\t}\n\t}\n\n\tcommsReceived(table, action, data){\n\t\tswitch(action){\n\t\t\tcase \"intercept\":\n\t\t\t\tthis.download(data.type, \"\", data.options, data.active, data.intercept);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nfunction maskInput(el, options){\n\tvar mask = options.mask,\n\tmaskLetter = typeof options.maskLetterChar !== \"undefined\" ? options.maskLetterChar : \"A\",\n\tmaskNumber = typeof options.maskNumberChar !== \"undefined\" ? options.maskNumberChar : \"9\",\n\tmaskWildcard = typeof options.maskWildcardChar !== \"undefined\" ? options.maskWildcardChar : \"*\";\n\n\tfunction fillSymbols(index){\n\t\tvar symbol = mask[index];\n\t\tif(typeof symbol !== \"undefined\" && symbol !== maskWildcard && symbol !== maskLetter && symbol !== maskNumber){\n\t\t\tel.value = el.value + \"\" + symbol;\n\t\t\tfillSymbols(index+1);\n\t\t}\n\t}\n\n\tel.addEventListener(\"keydown\", (e) => {\n\t\tvar index = el.value.length,\n\t\tchar = e.key;\n\n\t\tif(e.keyCode > 46 && !e.ctrlKey && !e.metaKey){\n\t\t\tif(index >= mask.length){\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}else {\n\t\t\t\tswitch(mask[index]){\n\t\t\t\t\tcase maskLetter:\n\t\t\t\t\t\tif(char.toUpperCase() == char.toLowerCase()){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase maskNumber:\n\t\t\t\t\t\tif(isNaN(char)){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase maskWildcard:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(char !== mask[index]){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn;\n\t});\n\n\tel.addEventListener(\"keyup\", (e) => {\n\t\tif(e.keyCode > 46){\n\t\t\tif(options.maskAutoFill){\n\t\t\t\tfillSymbols(el.value.length);\n\t\t\t}\n\t\t}\n\t});\n\n\n\tif(!el.placeholder){\n\t\tel.placeholder = mask;\n\t}\n\n\tif(options.maskAutoFill){\n\t\tfillSymbols(el.value.length);\n\t}\n}\n\n//input element\nfunction input(cell, onRendered, success, cancel, editorParams){\n\t//create and style input\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\n\tinput.setAttribute(\"type\", editorParams.search ? \"search\" : \"text\");\n\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\tinput.value = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\n\tonRendered(function(){\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction onChange(e){\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && input.value !== \"\") || input.value !== cellValue){\n\t\t\tif(success(input.value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\n\t//submit new value on blur or change\n\tinput.addEventListener(\"change\", onChange);\n\tinput.addEventListener(\"blur\", onChange);\n\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\t// case 9:\n\t\t\tcase 13:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(editorParams.mask){\n\t\tmaskInput(input, editorParams);\n\t}\n\n\treturn input;\n}\n\n//resizable text area element\nfunction textarea$1(cell, onRendered, success, cancel, editorParams){\n\tvar cellValue = cell.getValue(),\n\tvertNav = editorParams.verticalNavigation || \"hybrid\",\n\tvalue = String(cellValue !== null && typeof cellValue !== \"undefined\"  ? cellValue : \"\"),\n\tinput = document.createElement(\"textarea\"),\n\tscrollHeight = 0;\n\n\t//create and style input\n\tinput.style.display = \"block\";\n\tinput.style.padding = \"2px\";\n\tinput.style.height = \"100%\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\tinput.style.whiteSpace = \"pre-wrap\";\n\tinput.style.resize = \"none\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\tinput.value = value;\n\n\tonRendered(function(){\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\n\t\t\tinput.scrollHeight;\n\t\t\tinput.style.height = input.scrollHeight + \"px\";\n\t\t\tcell.getRow().normalizeHeight();\n\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction onChange(e){\n\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && input.value !== \"\") || input.value !== cellValue){\n\n\t\t\tif(success(input.value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tcell.getRow().normalizeHeight();\n\t\t\t},300);\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\n\t//submit new value on blur or change\n\tinput.addEventListener(\"change\", onChange);\n\tinput.addEventListener(\"blur\", onChange);\n\n\tinput.addEventListener(\"keyup\", function(){\n\n\t\tinput.style.height = \"\";\n\n\t\tvar heightNow = input.scrollHeight;\n\n\t\tinput.style.height = heightNow + \"px\";\n\n\t\tif(heightNow != scrollHeight){\n\t\t\tscrollHeight = heightNow;\n\t\t\tcell.getRow().normalizeHeight();\n\t\t}\n\t});\n\n\tinput.addEventListener(\"keydown\", function(e){\n\n\t\tswitch(e.keyCode){\n\n\t\t\tcase 13:\n\t\t\t\tif(e.shiftKey && editorParams.shiftEnterSubmit){\n\t\t\t\t\tonChange();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\n\t\t\tcase 38: //up arrow\n\t\t\t\tif(vertNav == \"editor\" || (vertNav == \"hybrid\" && input.selectionStart)){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\" || (vertNav == \"hybrid\" && input.selectionStart !== input.value.length)){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(editorParams.mask){\n\t\tmaskInput(input, editorParams);\n\t}\n\n\treturn input;\n}\n\n//input element with type of number\nfunction number$1(cell, onRendered, success, cancel, editorParams){\n\tvar cellValue = cell.getValue(),\n\tvertNav = editorParams.verticalNavigation || \"editor\",\n\tinput = document.createElement(\"input\");\n\n\tinput.setAttribute(\"type\", \"number\");\n\n\tif(typeof editorParams.max != \"undefined\"){\n\t\tinput.setAttribute(\"max\", editorParams.max);\n\t}\n\n\tif(typeof editorParams.min != \"undefined\"){\n\t\tinput.setAttribute(\"min\", editorParams.min);\n\t}\n\n\tif(typeof editorParams.step != \"undefined\"){\n\t\tinput.setAttribute(\"step\", editorParams.step);\n\t}\n\n\t//create and style input\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\tinput.value = cellValue;\n\n\tvar blurFunc = function(e){\n\t\tonChange();\n\t};\n\n\tonRendered(function () {\n\t\tif(cell.getType() === \"cell\"){\n\t\t\t//submit new value on blur\n\t\t\tinput.removeEventListener(\"blur\", blurFunc);\n\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\n\t\t\t//submit new value on blur\n\t\t\tinput.addEventListener(\"blur\", blurFunc);\n\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction onChange(){\n\t\tvar value = input.value;\n\n\t\tif(!isNaN(value) && value !==\"\"){\n\t\t\tvalue = Number(value);\n\t\t}\n\n\t\tif(value !== cellValue){\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 13:\n\t\t\t// case 9:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\n\t\t\tcase 38: //up arrow\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\"){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(editorParams.mask){\n\t\tmaskInput(input, editorParams);\n\t}\n\n\treturn input;\n}\n\n//input element with type of number\nfunction range(cell, onRendered, success, cancel, editorParams){\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\t\n\tinput.setAttribute(\"type\", \"range\");\n\t\n\tif (typeof editorParams.max != \"undefined\") {\n\t\tinput.setAttribute(\"max\", editorParams.max);\n\t}\n\t\n\tif (typeof editorParams.min != \"undefined\") {\n\t\tinput.setAttribute(\"min\", editorParams.min);\n\t}\n\t\n\tif (typeof editorParams.step != \"undefined\") {\n\t\tinput.setAttribute(\"step\", editorParams.step);\n\t}\n\t\n\t//create and style input\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinput.value = cellValue;\n\t\n\tonRendered(function () {\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\t\t}\n\t});\n\t\n\tfunction onChange(){\n\t\tvar value = input.value;\n\t\t\n\t\tif(!isNaN(value) && value !==\"\"){\n\t\t\tvalue = Number(value);\n\t\t}\n\t\t\n\t\tif(value != cellValue){\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"blur\", function(e){\n\t\tonChange();\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 13:\n\t\t\t// case 9:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\n//input element\nfunction date$1(cell, onRendered, success, cancel, editorParams){\n\tvar inputFormat = editorParams.format,\n\tvertNav = editorParams.verticalNavigation || \"editor\",\n\tDT = inputFormat ? (window.DateTime || luxon.DateTime) : null;\n\t\n\t//create and style input\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\t\n\tfunction convertDate(value){\n\t\tvar newDatetime;\n\t\t\n\t\tif(DT.isDateTime(value)){\n\t\t\tnewDatetime = value;\n\t\t}else if(inputFormat === \"iso\"){\n\t\t\tnewDatetime = DT.fromISO(String(value));\n\t\t}else {\n\t\t\tnewDatetime = DT.fromFormat(String(value), inputFormat);\n\t\t}\n\t\t\n\t\treturn newDatetime.toFormat(\"yyyy-MM-dd\");\n\t}\n\t\n\tinput.type = \"date\";\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\n\tif(editorParams.max){\n\t\tinput.setAttribute(\"max\", inputFormat ? convertDate(editorParams.max) : editorParams.max);\n\t}\n\n\tif(editorParams.min){\n\t\tinput.setAttribute(\"min\", inputFormat ? convertDate(editorParams.min) : editorParams.min);\n\t}\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcellValue = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\t\n\tif(inputFormat){\n\t\tif(DT){\t\t\n\t\t\tcellValue = convertDate(cellValue);\t\t\t\n\t\t}else {\n\t\t\tconsole.error(\"Editor Error - 'date' editor 'format' param is dependant on luxon.js\");\n\t\t}\n\t}\n\t\n\tinput.value = cellValue;\n\t\n\tonRendered(function(){\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\t\t\t\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\t\n\tfunction onChange(){\n\t\tvar value = input.value,\n\t\tluxDate;\n\t\t\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && value !== \"\") || value !== cellValue){\n\t\t\t\n\t\t\tif(value && inputFormat){\n\t\t\t\tluxDate = DT.fromFormat(String(value), \"yyyy-MM-dd\");\n\n\t\t\t\tswitch(inputFormat){\n\t\t\t\t\tcase true:\n\t\t\t\t\t\tvalue = luxDate;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"iso\":\n\t\t\t\t\t\tvalue = luxDate.toISO();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvalue = luxDate.toFormat(inputFormat);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"blur\", function(e) {\n\t\tif (e.relatedTarget || e.rangeParent || e.explicitOriginalTarget !== input) {\n\t\t\tonChange(); // only on a \"true\" blur; not when focusing browser's date/time picker\n\t\t}\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\t// case 9:\n\t\t\tcase 13:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 38: //up arrow\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\"){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\n//input element\nfunction time$1(cell, onRendered, success, cancel, editorParams){\n\tvar inputFormat = editorParams.format,\n\tvertNav = editorParams.verticalNavigation || \"editor\",\n\tDT = inputFormat ? (window.DateTime || luxon.DateTime) : null, \n\tnewDatetime;\n\t\n\t//create and style input\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\t\n\tinput.type = \"time\";\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcellValue = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\t\n\tif(inputFormat){\n\t\tif(DT){\n\t\t\tif(DT.isDateTime(cellValue)){\n\t\t\t\tnewDatetime = cellValue;\n\t\t\t}else if(inputFormat === \"iso\"){\n\t\t\t\tnewDatetime = DT.fromISO(String(cellValue));\n\t\t\t}else {\n\t\t\t\tnewDatetime = DT.fromFormat(String(cellValue), inputFormat);\n\t\t\t}\n\t\t\t\n\t\t\tcellValue = newDatetime.toFormat(\"HH:mm\");\n\t\t\t\n\t\t}else {\n\t\t\tconsole.error(\"Editor Error - 'date' editor 'format' param is dependant on luxon.js\");\n\t\t}\n\t}\n\t\n\tinput.value = cellValue;\n\t\n\tonRendered(function(){\n\t\tif(cell.getType() == \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\t\t\t\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\t\n\tfunction onChange(){\n\t\tvar value = input.value,\n\t\tluxTime;\n\t\t\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && value !== \"\") || value !== cellValue){\n\t\t\t\n\t\t\tif(value && inputFormat){\n\t\t\t\tluxTime = DT.fromFormat(String(value), \"hh:mm\");\n\n\t\t\t\tswitch(inputFormat){\n\t\t\t\t\tcase true:\n\t\t\t\t\t\tvalue = luxTime;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"iso\":\n\t\t\t\t\t\tvalue = luxTime.toISO();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvalue = luxTime.toFormat(inputFormat);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"blur\", function(e) {\n\t\tif (e.relatedTarget || e.rangeParent || e.explicitOriginalTarget !== input) {\n\t\t\tonChange(); // only on a \"true\" blur; not when focusing browser's date/time picker\n\t\t}\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\t// case 9:\n\t\t\tcase 13:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\n\t\t\tcase 38: //up arrow\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\"){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\n//input element\nfunction datetime$2(cell, onRendered, success, cancel, editorParams){\n\tvar inputFormat = editorParams.format,\n\tvertNav = editorParams.verticalNavigation || \"editor\",\n\tDT = inputFormat ? (this.table.dependencyRegistry.lookup([\"luxon\", \"DateTime\"], \"DateTime\")) : null, \n\tnewDatetime;\n\t\n\t//create and style input\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\t\n\tinput.type = \"datetime-local\";\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcellValue = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\t\n\tif(inputFormat){\n\t\tif(DT){\n\t\t\tif(DT.isDateTime(cellValue)){\n\t\t\t\tnewDatetime = cellValue;\n\t\t\t}else if(inputFormat === \"iso\"){\n\t\t\t\tnewDatetime = DT.fromISO(String(cellValue));\n\t\t\t}else {\n\t\t\t\tnewDatetime = DT.fromFormat(String(cellValue), inputFormat);\n\t\t\t}\n\t\t\t\n\t\t\tcellValue = newDatetime.toFormat(\"yyyy-MM-dd\")  + \"T\" + newDatetime.toFormat(\"HH:mm\");\n\t\t}else {\n\t\t\tconsole.error(\"Editor Error - 'date' editor 'format' param is dependant on luxon.js\");\n\t\t}\n\t}\n\t\n\tinput.value = cellValue;\n\t\n\tonRendered(function(){\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\t\t\t\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\t\n\tfunction onChange(){\n\t\tvar value = input.value,\n\t\tluxDateTime;\n\t\t\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && value !== \"\") || value !== cellValue){\n\n\t\t\tif(value && inputFormat){\n\t\t\t\tluxDateTime = DT.fromISO(String(value));\n\n\t\t\t\tswitch(inputFormat){\n\t\t\t\t\tcase true:\n\t\t\t\t\t\tvalue = luxDateTime;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"iso\":\n\t\t\t\t\t\tvalue = luxDateTime.toISO();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvalue = luxDateTime.toFormat(inputFormat);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"blur\", function(e) {\n\t\tif (e.relatedTarget || e.rangeParent || e.explicitOriginalTarget !== input) {\n\t\t\tonChange(); // only on a \"true\" blur; not when focusing browser's date/time picker\n\t\t}\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\t// case 9:\n\t\t\tcase 13:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\n\t\t\tcase 38: //up arrow\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\"){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\nlet Edit$1 = class Edit{\n\tconstructor(editor, cell, onRendered, success, cancel, editorParams){\n\t\tthis.edit = editor;\n\t\tthis.table = editor.table;\n\t\tthis.cell = cell;\n\t\tthis.params = this._initializeParams(editorParams);\n\t\t\n\t\tthis.data = [];\n\t\tthis.displayItems = [];\n\t\tthis.currentItems = [];\n\t\tthis.focusedItem = null;\n\t\t\n\t\tthis.input = this._createInputElement();\n\t\tthis.listEl = this._createListElement();\n\t\t\n\t\tthis.initialValues = null; \n\t\t\n\t\tthis.isFilter = cell.getType() === \"header\";\n\t\t\n\t\tthis.filterTimeout = null;\n\t\tthis.filtered = false;\n\t\tthis.typing = false;\n\t\t\n\t\tthis.values = []; \n\t\tthis.popup = null;  \n\t\t\n\t\tthis.listIteration = 0;\n\t\t\n\t\tthis.lastAction=\"\";\n\t\tthis.filterTerm=\"\";\n\t\t\n\t\tthis.blurable = true;\n\t\t\n\t\tthis.actions = {\n\t\t\tsuccess:success,\n\t\t\tcancel:cancel\n\t\t};\n\t\t\n\t\tthis._deprecatedOptionsCheck();\n\t\tthis._initializeValue();\n\t\t\n\t\tonRendered(this._onRendered.bind(this));\n\t}\n\t\n\t_deprecatedOptionsCheck(){\n\t\t// if(this.params.listItemFormatter){\n\t\t// \tthis.cell.getTable().deprecationAdvisor.msg(\"The listItemFormatter editor param has been deprecated, please see the latest editor documentation for updated options\");\n\t\t// }\n\t\t\n\t\t// if(this.params.sortValuesList){\n\t\t// \tthis.cell.getTable().deprecationAdvisor.msg(\"The sortValuesList editor param has been deprecated, please see the latest editor documentation for updated options\");\n\t\t// }\n\t\t\n\t\t// if(this.params.searchFunc){\n\t\t// \tthis.cell.getTable().deprecationAdvisor.msg(\"The searchFunc editor param has been deprecated, please see the latest editor documentation for updated options\");\n\t\t// }\n\t\t\n\t\t// if(this.params.searchingPlaceholder){\n\t\t// \tthis.cell.getTable().deprecationAdvisor.msg(\"The searchingPlaceholder editor param has been deprecated, please see the latest editor documentation for updated options\");\n\t\t// }\n\t}\n\t\n\t_initializeValue(){\n\t\tvar initialValue = this.cell.getValue();\n\t\t\n\t\tif(typeof initialValue === \"undefined\" && typeof this.params.defaultValue !== \"undefined\"){\n\t\t\tinitialValue = this.params.defaultValue;\n\t\t}\n\t\t\n\t\tthis.initialValues = this.params.multiselect ? initialValue : [initialValue];\n\t\t\n\t\tif(this.isFilter){\n\t\t\tthis.input.value = this.initialValues ? this.initialValues.join(\",\") : \"\";\n\t\t\tthis.headerFilterInitialListGen();            \n\t\t}\n\t}\n\t\n\t_onRendered(){\n\t\tvar cellEl = this.cell.getElement();\n\t\t\n\t\tfunction clickStop(e){\n\t\t\te.stopPropagation();\n\t\t}\t\n\t\t\n\t\tif(!this.isFilter){\n\t\t\tthis.input.style.height = \"100%\";\n\t\t\tthis.input.focus({preventScroll: true});\n\t\t}\n\t\t\n\t\t\n\t\tcellEl.addEventListener(\"click\", clickStop);\n\t\t\n\t\tsetTimeout(() => {\n\t\t\tcellEl.removeEventListener(\"click\", clickStop);\n\t\t}, 1000);\n\t\t\n\t\tthis.input.addEventListener(\"mousedown\", this._preventPopupBlur.bind(this));\n\t}\n\t\n\t_createListElement(){\n\t\tvar listEl = document.createElement(\"div\");\n\t\tlistEl.classList.add(\"tabulator-edit-list\");\n\t\t\n\t\tlistEl.addEventListener(\"mousedown\", this._preventBlur.bind(this));\n\t\tlistEl.addEventListener(\"keydown\", this._inputKeyDown.bind(this));\n\t\t\n\t\treturn listEl;\n\t}\n\t\n\t_setListWidth(){\n\t\tvar element = this.isFilter ? this.input : this.cell.getElement();\n\t\t\n\t\tthis.listEl.style.minWidth = element.offsetWidth + \"px\";\n\t\t\n\t\tif(this.params.maxWidth){\n\t\t\tif(this.params.maxWidth === true){\n\t\t\t\tthis.listEl.style.maxWidth = element.offsetWidth + \"px\";\n\t\t\t}else if(typeof this.params.maxWidth === \"number\"){\n\t\t\t\tthis.listEl.style.maxWidth = this.params.maxWidth + \"px\";\n\t\t\t}else {\n\t\t\t\tthis.listEl.style.maxWidth = this.params.maxWidth;\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\t\n\t_createInputElement(){\n\t\tvar attribs = this.params.elementAttributes;\n\t\tvar input = document.createElement(\"input\");\n\t\t\n\t\tinput.setAttribute(\"type\", this.params.clearable ? \"search\" : \"text\");\n\t\t\n\t\tinput.style.padding = \"4px\";\n\t\tinput.style.width = \"100%\";\n\t\tinput.style.boxSizing = \"border-box\";\n\t\t\n\t\tif(!this.params.autocomplete){\n\t\t\tinput.style.cursor = \"default\";\n\t\t\tinput.style.caretColor = \"transparent\";\n\t\t\t// input.readOnly = (this.edit.currentCell != false);\n\t\t}\n\t\t\n\t\tif(attribs && typeof attribs == \"object\"){\n\t\t\tfor (let key in attribs){\n\t\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + attribs[\"+\" + key]);\n\t\t\t\t}else {\n\t\t\t\t\tinput.setAttribute(key, attribs[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(this.params.mask){\n\t\t\tmaskInput(input, this.params);\n\t\t}\n\t\t\n\t\tthis._bindInputEvents(input);\n\t\t\n\t\treturn input;\n\t}\n\t\n\t_initializeParams(params){\n\t\tvar valueKeys = [\"values\", \"valuesURL\", \"valuesLookup\"],\n\t\tvalueCheck;\n\t\t\n\t\tparams = Object.assign({}, params);\n\t\t\n\t\tparams.verticalNavigation = params.verticalNavigation || \"editor\";\n\t\tparams.placeholderLoading = typeof params.placeholderLoading === \"undefined\" ? \"Searching ...\" : params.placeholderLoading;\n\t\tparams.placeholderEmpty = typeof params.placeholderEmpty === \"undefined\" ? \"No Results Found\" : params.placeholderEmpty;\n\t\tparams.filterDelay = typeof params.filterDelay === \"undefined\" ? 300 : params.filterDelay;\n\t\t\n\t\tparams.emptyValue = Object.keys(params).includes(\"emptyValue\") ? params.emptyValue : \"\";\n\t\t\n\t\tvalueCheck = Object.keys(params).filter(key => valueKeys.includes(key)).length;\n\t\t\n\t\tif(!valueCheck){\n\t\t\tconsole.warn(\"list editor config error - either the values, valuesURL, or valuesLookup option must be set\");\n\t\t}else if(valueCheck > 1){\n\t\t\tconsole.warn(\"list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor\");\n\t\t}\n\t\t\n\t\tif(params.autocomplete){\n\t\t\tif(params.multiselect){\n\t\t\t\tparams.multiselect = false;\n\t\t\t\tconsole.warn(\"list editor config error - multiselect option is not available when autocomplete is enabled\");\n\t\t\t}\n\t\t}else {\n\t\t\tif(params.freetext){\n\t\t\t\tparams.freetext = false;\n\t\t\t\tconsole.warn(\"list editor config error - freetext option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.filterFunc){\n\t\t\t\tparams.filterFunc = false;\n\t\t\t\tconsole.warn(\"list editor config error - filterFunc option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.filterRemote){\n\t\t\t\tparams.filterRemote = false;\n\t\t\t\tconsole.warn(\"list editor config error - filterRemote option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.mask){\n\t\t\t\tparams.mask = false;\n\t\t\t\tconsole.warn(\"list editor config error - mask option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.allowEmpty){\n\t\t\t\tparams.allowEmpty = false;\n\t\t\t\tconsole.warn(\"list editor config error - allowEmpty option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.listOnEmpty){\n\t\t\t\tparams.listOnEmpty = false;\n\t\t\t\tconsole.warn(\"list editor config error - listOnEmpty option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(params.filterRemote && !(typeof params.valuesLookup === \"function\" || params.valuesURL)){\n\t\t\tparams.filterRemote = false;\n\t\t\tconsole.warn(\"list editor config error - filterRemote option should only be used when values list is populated from a remote source\");\n\t\t}\n\t\treturn params;\n\t}\n\t//////////////////////////////////////\n\t////////// Event Handling ////////////\n\t//////////////////////////////////////\n\t\n\t_bindInputEvents(input){\n\t\tinput.addEventListener(\"focus\", this._inputFocus.bind(this));\n\t\tinput.addEventListener(\"click\", this._inputClick.bind(this));\n\t\tinput.addEventListener(\"blur\", this._inputBlur.bind(this));\n\t\tinput.addEventListener(\"keydown\", this._inputKeyDown.bind(this));\n\t\tinput.addEventListener(\"search\", this._inputSearch.bind(this));\n\t\t\n\t\tif(this.params.autocomplete){\n\t\t\tinput.addEventListener(\"keyup\", this._inputKeyUp.bind(this));\n\t\t}\n\t}\n\t\n\t\n\t_inputFocus(e){\n\t\tthis.rebuildOptionsList();\n\t}\n\t\n\t_filter(){\n\t\tif(this.params.filterRemote){\n\t\t\tclearTimeout(this.filterTimeout);\n\t\t\t\n\t\t\tthis.filterTimeout = setTimeout(() => {\n\t\t\t\tthis.rebuildOptionsList();\n\t\t\t}, this.params.filterDelay);\n\t\t}else {\n\t\t\tthis._filterList();\n\t\t}\n\t}\n\t\n\t_inputClick(e){\n\t\te.stopPropagation();\n\t}\n\t\n\t_inputBlur(e){\n\t\tif(this.blurable){\n\t\t\tif(this.popup){\n\t\t\t\tthis.popup.hide();\n\t\t\t}else {\n\t\t\t\tthis._resolveValue(true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_inputSearch(){\n\t\tthis._clearChoices();\n\t}\n\t\n\t_inputKeyDown(e){\n\t\tswitch(e.keyCode){\n\t\t\t\n\t\t\tcase 38: //up arrow\n\t\t\t\tthis._keyUp(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 40: //down arrow\n\t\t\t\tthis._keyDown(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 37: //left arrow\n\t\t\tcase 39: //right arrow\n\t\t\t\tthis._keySide(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 13: //enter\n\t\t\t\tthis._keyEnter();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27: //escape\n\t\t\t\tthis._keyEsc();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 36: //home\n\t\t\tcase 35: //end\n\t\t\t\tthis._keyHomeEnd(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 9: //tab\n\t\t\t\tthis._keyTab(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tthis._keySelectLetter(e);\n\t\t}\n\t}\n\t\n\t_inputKeyUp(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 38: //up arrow\n\t\t\tcase 37: //left arrow\n\t\t\tcase 39: //up arrow\n\t\t\tcase 40: //right arrow\n\t\t\tcase 13: //enter\n\t\t\tcase 27: //escape\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tthis._keyAutoCompLetter(e);\n\t\t}\n\t}\n\t\n\t_preventPopupBlur(){\n\t\tif(this.popup){\n\t\t\tthis.popup.blockHide();\n\t\t}\n\t\t\n\t\tsetTimeout(() =>{\n\t\t\tif(this.popup){\n\t\t\t\tthis.popup.restoreHide();\n\t\t\t}\n\t\t}, 10);\n\t}\n\t\n\t_preventBlur(){\n\t\tthis.blurable = false;\n\t\t\n\t\tsetTimeout(() =>{\n\t\t\tthis.blurable = true;\n\t\t}, 10);\n\t}\n\t\n\t//////////////////////////////////////\n\t//////// Keyboard Navigation /////////\n\t//////////////////////////////////////\n\t\n\t_keyTab(e){\n\t\tif(this.params.autocomplete && this.lastAction === \"typing\"){\n\t\t\tthis._resolveValue(true);\n\t\t}else {\n\t\t\tif(this.focusedItem){\n\t\t\t\tthis._chooseItem(this.focusedItem, true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keyUp(e){\n\t\tvar index = this.displayItems.indexOf(this.focusedItem);\n\t\t\n\t\tif(this.params.verticalNavigation == \"editor\" || (this.params.verticalNavigation == \"hybrid\" && index)){\n\t\t\te.stopImmediatePropagation();\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tif(index > 0){\n\t\t\t\tthis._focusItem(this.displayItems[index - 1]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keyDown(e){\n\t\tvar index = this.displayItems.indexOf(this.focusedItem);\n\t\t\n\t\tif(this.params.verticalNavigation == \"editor\" || (this.params.verticalNavigation == \"hybrid\" && index < this.displayItems.length - 1)){\n\t\t\te.stopImmediatePropagation();\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tif(index < this.displayItems.length - 1){\n\t\t\t\tif(index == -1){\n\t\t\t\t\tthis._focusItem(this.displayItems[0]);\n\t\t\t\t}else {\n\t\t\t\t\tthis._focusItem(this.displayItems[index + 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keySide(e){\n\t\tif(!this.params.autocomplete){\n\t\t\te.stopImmediatePropagation();\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\t\n\t_keyEnter(e){\n\t\tif(this.params.autocomplete && this.lastAction === \"typing\"){\n\t\t\tthis._resolveValue(true);\n\t\t}else {\n\t\t\tif(this.focusedItem){\n\t\t\t\tthis._chooseItem(this.focusedItem);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keyEsc(e){\n\t\tthis._cancel();\n\t}\n\t\n\t_keyHomeEnd(e){\n\t\tif(this.params.autocomplete){\n\t\t\t//prevent table navigation while using input element\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t}\n\t\n\t_keySelectLetter(e){\n\t\tif(!this.params.autocomplete){\n\t\t\t// if(this.edit.currentCell === false){\n\t\t\te.preventDefault();\n\t\t\t// }\n\t\t\t\n\t\t\tif(e.keyCode >= 38 && e.keyCode <= 90){\n\t\t\t\tthis._scrollToValue(e.keyCode);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keyAutoCompLetter(e){\n\t\tthis._filter();\n\t\tthis.lastAction = \"typing\";\n\t\tthis.typing = true;\n\t}\n\t\n\t\n\t_scrollToValue(char){\n\t\tclearTimeout(this.filterTimeout);\n\t\t\n\t\tvar character = String.fromCharCode(char).toLowerCase();\n\t\tthis.filterTerm += character.toLowerCase();\n\t\t\n\t\tvar match = this.displayItems.find((item) => {\n\t\t\treturn typeof item.label !== \"undefined\" && item.label.toLowerCase().startsWith(this.filterTerm);\n\t\t});\n\t\t\n\t\tif(match){\n\t\t\tthis._focusItem(match);\n\t\t}\n\t\t\n\t\tthis.filterTimeout = setTimeout(() => {\n\t\t\tthis.filterTerm = \"\";\n\t\t}, 800);\n\t}\n\t\n\t_focusItem(item){\n\t\tthis.lastAction = \"focus\";\n\t\t\n\t\tif(this.focusedItem && this.focusedItem.element){\n\t\t\tthis.focusedItem.element.classList.remove(\"focused\");\n\t\t}\n\t\t\n\t\tthis.focusedItem = item;\n\t\t\n\t\tif(item && item.element){\n\t\t\titem.element.classList.add(\"focused\");\n\t\t\titem.element.scrollIntoView({behavior: 'smooth', block: 'nearest', inline: 'start'});\n\t\t}\n\t}\n\t\n\t\n\t//////////////////////////////////////\n\t/////// Data List Generation /////////\n\t//////////////////////////////////////\n\theaderFilterInitialListGen(){\n\t\tthis._generateOptions(true);\n\t}\n\t\n\trebuildOptionsList(){\n\t\tthis._generateOptions()\n\t\t\t.then(this._sortOptions.bind(this))\n\t\t\t.then(this._buildList.bind(this))\n\t\t\t.then(this._showList.bind(this))\n\t\t\t.catch((e) => {\n\t\t\t\tif(!Number.isInteger(e)){\n\t\t\t\t\tconsole.error(\"List generation error\", e);\n\t\t\t\t}\n\t\t\t});\n\t}\n\t\n\t_filterList(){\n\t\tthis._buildList(this._filterOptions());\n\t\tthis._showList();\n\t}\n\t\n\t_generateOptions(silent){\n\t\tvar values = [];\n\t\tvar iteration = ++ this.listIteration;\n\t\t\n\t\tthis.filtered = false;\n\t\t\n\t\tif(this.params.values){\n\t\t\tvalues = this.params.values;\n\t\t}else if (this.params.valuesURL){\n\t\t\tvalues = this._ajaxRequest(this.params.valuesURL, this.input.value);\n\t\t}else {\n\t\t\tif(typeof this.params.valuesLookup === \"function\"){\n\t\t\t\tvalues = this.params.valuesLookup(this.cell, this.input.value);\n\t\t\t}else if(this.params.valuesLookup){\n\t\t\t\tvalues = this._uniqueColumnValues(this.params.valuesLookupField);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(values instanceof Promise){\n\t\t\tif(!silent){\n\t\t\t\tthis._addPlaceholder(this.params.placeholderLoading);\n\t\t\t}\n\t\t\t\n\t\t\treturn values.then()\n\t\t\t\t.then((responseValues) => {\n\t\t\t\t\tif(this.listIteration === iteration){\n\t\t\t\t\t\treturn this._parseList(responseValues);\n\t\t\t\t\t}else {\n\t\t\t\t\t\treturn Promise.reject(iteration);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}else {\n\t\t\treturn Promise.resolve(this._parseList(values));\n\t\t}\n\t}\n\t\n\t_addPlaceholder(contents){\n\t\tvar placeholder = document.createElement(\"div\");\n\t\t\n\t\tif(typeof contents === \"function\"){\n\t\t\tcontents = contents(this.cell.getComponent(), this.listEl);\n\t\t}\n\t\t\n\t\tif(contents){\n\t\t\tthis._clearList();\n\t\t\t\n\t\t\tif(contents instanceof HTMLElement){\n\t\t\t\tplaceholder = contents;\n\t\t\t}else {\n\t\t\t\tplaceholder.classList.add(\"tabulator-edit-list-placeholder\");\n\t\t\t\tplaceholder.innerHTML = contents;\n\t\t\t}\n\t\t\t\n\t\t\tthis.listEl.appendChild(placeholder);\n\t\t\t\n\t\t\tthis._showList();\n\t\t}\n\t}\n\t\n\t_ajaxRequest(url, term){\n\t\tvar params = this.params.filterRemote ? {term:term} : {};\n\t\turl = urlBuilder(url, {}, params);\n\t\t\n\t\treturn fetch(url)\n\t\t\t.then((response)=>{\n\t\t\t\tif(response.ok) {\n\t\t\t\t\treturn response.json()\n\t\t\t\t\t\t.catch((error)=>{\n\t\t\t\t\t\t\tconsole.warn(\"List Ajax Load Error - Invalid JSON returned\", error);\n\t\t\t\t\t\t\treturn Promise.reject(error);\n\t\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tconsole.error(\"List Ajax Load Error - Connection Error: \" + response.status, response.statusText);\n\t\t\t\t\treturn Promise.reject(response);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error)=>{\n\t\t\t\tconsole.error(\"List Ajax Load Error - Connection Error: \", error);\n\t\t\t\treturn Promise.reject(error);\n\t\t\t});\n\t}\n\t\n\t_uniqueColumnValues(field){\n\t\tvar output = {},\n\t\tdata = this.table.getData(this.params.valuesLookup),\n\t\tcolumn;\n\t\t\n\t\tif(field){\n\t\t\tcolumn = this.table.columnManager.getColumnByField(field);\n\t\t}else {\n\t\t\tcolumn = this.cell.getColumn()._getSelf();\n\t\t}\n\t\t\n\t\tif(column){\n\t\t\tdata.forEach((row) => {\n\t\t\t\tvar val = column.getFieldValue(row);\n\t\t\t\t\n\t\t\t\tif(!this._emptyValueCheck(val)){\n\t\t\t\t\tif(this.params.multiselect && Array.isArray(val)){\n\t\t\t\t\t\tval.forEach((item) => {\n\t\t\t\t\t\t\tif(!this._emptyValueCheck(item)){\n\t\t\t\t\t\t\t\toutput[item] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\toutput[val] = true;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\tconsole.warn(\"unable to find matching column to create select lookup list:\", field);\n\t\t\toutput = [];\n\t\t}\n\t\t\n\t\treturn Object.keys(output);\n\t}\n\n\t_emptyValueCheck(value){\n\t\treturn value === null || typeof value === \"undefined\" || value === \"\";\n\t}\n\t\n\t_parseList(inputValues){\n\t\tvar data = [];\n\t\t\n\t\tif(!Array.isArray(inputValues)){\n\t\t\tinputValues = Object.entries(inputValues).map(([key, value]) => {\n\t\t\t\treturn {\n\t\t\t\t\tlabel:value,\n\t\t\t\t\tvalue:key,\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t\t\n\t\tinputValues.forEach((value) => {\n\t\t\tif(typeof value !== \"object\"){\n\t\t\t\tvalue = {\n\t\t\t\t\tlabel:value,\n\t\t\t\t\tvalue:value,\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tthis._parseListItem(value, data, 0);\n\t\t});\n\t\t\n\t\tif(!this.currentItems.length && this.params.freetext){\n\t\t\tthis.input.value = this.initialValues;\n\t\t\tthis.typing = true;\n\t\t\tthis.lastAction = \"typing\";\n\t\t}\n\t\t\n\t\tthis.data = data;\n\t\t\n\t\treturn data;    \n\t}\n\t\n\t_parseListItem(option, data, level){\n\t\tvar item = {};\n\t\t\n\t\tif(option.options){\n\t\t\titem = this._parseListGroup(option, level + 1);\n\t\t}else {\n\t\t\titem = {\n\t\t\t\tlabel:option.label,\n\t\t\t\tvalue:option.value,\n\t\t\t\titemParams:option.itemParams,\n\t\t\t\telementAttributes: option.elementAttributes,\n\t\t\t\telement:false,\n\t\t\t\tselected:false,\n\t\t\t\tvisible:true,\n\t\t\t\tlevel:level,\n\t\t\t\toriginal:option,\n\t\t\t};\n\t\t\t\n\t\t\tif(this.initialValues && this.initialValues.indexOf(option.value) > -1){\n\t\t\t\tthis._chooseItem(item, true);\n\t\t\t}\n\t\t}\n\t\t\n\t\tdata.push(item);\n\t}\n\t\n\t_parseListGroup(option, level){\n\t\tvar item = {\n\t\t\tlabel:option.label,\n\t\t\tgroup:true,\n\t\t\titemParams:option.itemParams,\n\t\t\telementAttributes:option.elementAttributes,\n\t\t\telement:false,\n\t\t\tvisible:true,\n\t\t\tlevel:level,\n\t\t\toptions:[],\n\t\t\toriginal:option,\n\t\t};\n\t\t\n\t\toption.options.forEach((child) => {\n\t\t\tthis._parseListItem(child, item.options, level);\n\t\t});\n\t\t\n\t\treturn item;\n\t}\n\t\n\t_sortOptions(options){\n\t\tvar sorter;\n\t\t\n\t\tif(this.params.sort){\n\t\t\tsorter = typeof this.params.sort === \"function\" ? this.params.sort : this._defaultSortFunction.bind(this);\n\t\t\t\n\t\t\tthis._sortGroup(sorter, options);\n\t\t}\n\t\t\n\t\treturn options;\n\t}\n\t\n\t_sortGroup(sorter, options){\n\t\toptions.sort((a,b) => {\n\t\t\treturn sorter(a.label, b.label, a.value, b.value, a.original, b.original);\n\t\t});\n\t\t\n\t\toptions.forEach((option) => {\n\t\t\tif(option.group){\n\t\t\t\tthis._sortGroup(sorter, option.options);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t_defaultSortFunction(as, bs){\n\t\tvar a, b, a1, b1, i= 0, L, rx = /(\\d+)|(\\D+)/g, rd = /\\d/;\n\t\tvar emptyAlign = 0;\n\t\t\n\t\tif(this.params.sort === \"desc\"){\n\t\t\t[as, bs] = [bs, as];\n\t\t}\n\t\t\n\t\t//handle empty values\n\t\tif(!as && as!== 0){\n\t\t\temptyAlign =  !bs && bs!== 0 ? 0 : -1;\n\t\t}else if(!bs && bs!== 0){\n\t\t\temptyAlign =  1;\n\t\t}else {\n\t\t\tif(isFinite(as) && isFinite(bs)) return as - bs;\n\t\t\ta = String(as).toLowerCase();\n\t\t\tb = String(bs).toLowerCase();\n\t\t\tif(a === b) return 0;\n\t\t\tif(!(rd.test(a) && rd.test(b))) return a > b ? 1 : -1;\n\t\t\ta = a.match(rx);\n\t\t\tb = b.match(rx);\n\t\t\tL = a.length > b.length ? b.length : a.length;\n\t\t\twhile(i < L){\n\t\t\t\ta1= a[i];\n\t\t\t\tb1= b[i++];\n\t\t\t\tif(a1 !== b1){\n\t\t\t\t\tif(isFinite(a1) && isFinite(b1)){\n\t\t\t\t\t\tif(a1.charAt(0) === \"0\") a1 = \".\" + a1;\n\t\t\t\t\t\tif(b1.charAt(0) === \"0\") b1 = \".\" + b1;\n\t\t\t\t\t\treturn a1 - b1;\n\t\t\t\t\t}\n\t\t\t\t\telse return a1 > b1 ? 1 : -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn a.length > b.length;\n\t\t}\n\t\t\n\t\treturn emptyAlign;\n\t}\n\t\n\t_filterOptions(){\n\t\tvar filterFunc = this.params.filterFunc || this._defaultFilterFunc,\n\t\tterm = this.input.value;\n\t\t\n\t\tif(term){\n\t\t\tthis.filtered = true;\n\t\t\t\n\t\t\tthis.data.forEach((item) => {\n\t\t\t\tthis._filterItem(filterFunc, term, item);\n\t\t\t});\n\t\t}else {\n\t\t\tthis.filtered = false;\n\t\t}\n\t\t\n\t\treturn this.data;\n\t}\n\t\n\t_filterItem(func, term, item){\n\t\tvar matches = false;\n\t\t\n\t\tif(!item.group){\n\t\t\titem.visible = func(term, item.label, item.value, item.original);\n\t\t}else {\n\t\t\titem.options.forEach((option) => {\n\t\t\t\tif(this._filterItem(func, term, option)){\n\t\t\t\t\tmatches = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\titem.visible = matches;\n\t\t}\n\t\t\n\t\treturn item.visible;\n\t}\n\t\n\t_defaultFilterFunc(term, label, value, item){\n\t\tterm = String(term).toLowerCase();\n\t\t\n\t\tif(label !== null && typeof label !== \"undefined\"){\n\t\t\tif(String(label).toLowerCase().indexOf(term) > -1 || String(value).toLowerCase().indexOf(term) > -1){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\t//////////////////////////////////////\n\t/////////// Display List /////////////\n\t//////////////////////////////////////\n\t\n\t_clearList(){\n\t\twhile(this.listEl.firstChild) this.listEl.removeChild(this.listEl.firstChild);\n\t\t\n\t\tthis.displayItems = [];\n\t}\n\t\n\t_buildList(data){\n\t\tthis._clearList();\n\t\t\n\t\tdata.forEach((option) => {\n\t\t\tthis._buildItem(option);\n\t\t});\n\t\t\n\t\tif(!this.displayItems.length){\n\t\t\tthis._addPlaceholder(this.params.placeholderEmpty);\n\t\t}  \n\t}\n\t\n\t_buildItem(item){\n\t\tvar el = item.element,\n\t\tcontents;\n\t\t\n\t\tif(!this.filtered || item.visible){\n\t\t\t\n\t\t\tif(!el){\n\t\t\t\tel = document.createElement(\"div\");\n\t\t\t\tel.tabIndex = 0;\n\t\t\t\t\n\t\t\t\tcontents = this.params.itemFormatter ? this.params.itemFormatter(item.label, item.value, item.original, el) : item.label;\n\t\t\t\t\n\t\t\t\tif(contents instanceof HTMLElement){\n\t\t\t\t\tel.appendChild(contents);\n\t\t\t\t}else {\n\t\t\t\t\tel.innerHTML = contents;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(item.group){\n\t\t\t\t\tel.classList.add(\"tabulator-edit-list-group\");\n\t\t\t\t}else {\n\t\t\t\t\tel.classList.add(\"tabulator-edit-list-item\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tel.classList.add(\"tabulator-edit-list-group-level-\" + item.level);\n\t\t\t\t\n\t\t\t\tif(item.elementAttributes && typeof item.elementAttributes == \"object\"){\n\t\t\t\t\tfor (let key in item.elementAttributes){\n\t\t\t\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\t\t\tel.setAttribute(key, this.input.getAttribute(key) + item.elementAttributes[\"+\" + key]);\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tel.setAttribute(key, item.elementAttributes[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(item.group){\n\t\t\t\t\tel.addEventListener(\"click\", this._groupClick.bind(this, item));\n\t\t\t\t}else {\n\t\t\t\t\tel.addEventListener(\"click\", this._itemClick.bind(this, item));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tel.addEventListener(\"mousedown\", this._preventBlur.bind(this));\n\t\t\t\t\n\t\t\t\titem.element = el;\n\t\t\t}\n\t\t\t\n\t\t\tthis._styleItem(item);\n\t\t\t\n\t\t\tthis.listEl.appendChild(el);\n\t\t\t\n\t\t\tif(item.group){\n\t\t\t\titem.options.forEach((option) => {\n\t\t\t\t\tthis._buildItem(option);\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tthis.displayItems.push(item);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_showList(){\n\t\tvar startVis = this.popup && this.popup.isVisible();\n\t\t\n\t\tif(this.input.parentNode){\n\t\t\tif(this.params.autocomplete && this.input.value === \"\" && !this.params.listOnEmpty){\n\t\t\t\tif(this.popup){\n\t\t\t\t\tthis.popup.hide(true);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tthis._setListWidth();\n\t\t\t\n\t\t\tif(!this.popup){\n\t\t\t\tthis.popup = this.edit.popup(this.listEl);\n\t\t\t}\n\t\t\t\n\t\t\tthis.popup.show(this.cell.getElement(), \"bottom\");\n\t\t\t\n\t\t\tif(!startVis){\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.popup.hideOnBlur(this._resolveValue.bind(this, true));\n\t\t\t\t}, 10);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_styleItem(item){\n\t\tif(item && item.element){\n\t\t\tif(item.selected){\n\t\t\t\titem.element.classList.add(\"active\");\n\t\t\t}else {\n\t\t\t\titem.element.classList.remove(\"active\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//////////////////////////////////////\n\t///////// User Interaction ///////////\n\t//////////////////////////////////////\n\t\n\t_itemClick(item, e){\n\t\te.stopPropagation();\n\t\t\n\t\tthis._chooseItem(item);\n\t}\n\t\n\t_groupClick(item, e){\n\t\te.stopPropagation();\n\t}\n\t\n\t\n\t//////////////////////////////////////\n\t////// Current Item Management ///////\n\t//////////////////////////////////////\n\t\n\t_cancel(){\n\t\tthis.popup.hide(true);\n\t\tthis.actions.cancel();\n\t}\n\t\n\t_clearChoices(){\n\t\tthis.typing = true;\n\t\t\n\t\tthis.currentItems.forEach((item) => {\n\t\t\titem.selected = false;\n\t\t\tthis._styleItem(item);\n\t\t});\n\t\t\n\t\tthis.currentItems = [];\n\t\t\n\t\tthis.focusedItem = null;\n\t}\n\t\n\t_chooseItem(item, silent){\n\t\tvar index;\n\t\t\n\t\tthis.typing = false;\n\t\t\n\t\tif(this.params.multiselect){\n\t\t\tindex = this.currentItems.indexOf(item);\n\t\t\t\n\t\t\tif(index > -1){\n\t\t\t\tthis.currentItems.splice(index, 1);\n\t\t\t\titem.selected = false;\n\t\t\t}else {\n\t\t\t\tthis.currentItems.push(item);\n\t\t\t\titem.selected = true;\n\t\t\t}\n\t\t\t\n\t\t\tthis.input.value = this.currentItems.map(item => item.label).join(\",\");\n\t\t\t\n\t\t\tthis._styleItem(item);\n\t\t\t\n\t\t}else {\n\t\t\tthis.currentItems = [item];\n\t\t\titem.selected = true;\n\t\t\t\n\t\t\tthis.input.value = item.label;\n\t\t\t\n\t\t\tthis._styleItem(item);\n\t\t\t\n\t\t\tif(!silent){\n\t\t\t\tthis._resolveValue();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._focusItem(item);\n\t}\n\t\n\t_resolveValue(blur){\n\t\tvar output, initialValue;\n\t\t\n\t\tif(this.popup){\n\t\t\tthis.popup.hide(true);\n\t\t}\n\t\t\n\t\tif(this.params.multiselect){\n\t\t\toutput = this.currentItems.map(item => item.value);\n\t\t}else {\n\t\t\tif(blur && this.params.autocomplete && this.typing){\n\t\t\t\tif(this.params.freetext || (this.params.allowEmpty && this.input.value === \"\")){\n\t\t\t\t\toutput = this.input.value;\n\t\t\t\t}else {\n\t\t\t\t\tthis.actions.cancel();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(this.currentItems[0]){\n\t\t\t\t\toutput = this.currentItems[0].value;\n\t\t\t\t}else {\n\t\t\t\t\tinitialValue = Array.isArray(this.initialValues) ? this.initialValues[0] : this.initialValues;\n\t\t\t\t\t\n\t\t\t\t\tif(initialValue === null || typeof initialValue === \"undefined\" || initialValue === \"\"){\n\t\t\t\t\t\toutput = initialValue;\n\t\t\t\t\t}else {\n\t\t\t\t\t\toutput = this.params.emptyValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(output === \"\"){\n\t\t\toutput = this.params.emptyValue;\n\t\t}\n\t\t\n\t\tthis.actions.success(output);\n\t\t\n\t\tif(this.isFilter){\n\t\t\tthis.initialValues = output && !Array.isArray(output) ? [output] : output;\n\t\t\tthis.currentItems = [];\n\t\t}\n\t}\n\t\n};\n\nfunction list(cell, onRendered, success, cancel, editorParams){\n\tvar list = new Edit$1(this, cell, onRendered, success, cancel, editorParams);\n\n\treturn list.input;\n}\n\n//star rating\nfunction star$1(cell, onRendered, success, cancel, editorParams){\n\tvar self = this,\n\telement = cell.getElement(),\n\tvalue = cell.getValue(),\n\tmaxStars = element.getElementsByTagName(\"svg\").length || 5,\n\tsize = element.getElementsByTagName(\"svg\")[0] ? element.getElementsByTagName(\"svg\")[0].getAttribute(\"width\") : 14,\n\tstars = [],\n\tstarsHolder = document.createElement(\"div\"),\n\tstar = document.createElementNS('http://www.w3.org/2000/svg', \"svg\");\n\n\n\t//change star type\n\tfunction starChange(val){\n\t\tstars.forEach(function(star, i){\n\t\t\tif(i < val){\n\t\t\t\tif(self.table.browser == \"ie\"){\n\t\t\t\t\tstar.setAttribute(\"class\", \"tabulator-star-active\");\n\t\t\t\t}else {\n\t\t\t\t\tstar.classList.replace(\"tabulator-star-inactive\", \"tabulator-star-active\");\n\t\t\t\t}\n\n\t\t\t\tstar.innerHTML = '<polygon fill=\"#488CE9\" stroke=\"#014AAE\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\t\t\t}else {\n\t\t\t\tif(self.table.browser == \"ie\"){\n\t\t\t\t\tstar.setAttribute(\"class\", \"tabulator-star-inactive\");\n\t\t\t\t}else {\n\t\t\t\t\tstar.classList.replace(\"tabulator-star-active\", \"tabulator-star-inactive\");\n\t\t\t\t}\n\n\t\t\t\tstar.innerHTML = '<polygon fill=\"#010155\" stroke=\"#686868\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\t\t\t}\n\t\t});\n\t}\n\n\t//build stars\n\tfunction buildStar(i){\n\n\t\tvar starHolder =  document.createElement(\"span\");\n\t\tvar nextStar = star.cloneNode(true);\n\n\t\tstars.push(nextStar);\n\n\t\tstarHolder.addEventListener(\"mouseenter\", function(e){\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t\tstarChange(i);\n\t\t});\n\n\t\tstarHolder.addEventListener(\"mousemove\", function(e){\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t});\n\n\t\tstarHolder.addEventListener(\"click\", function(e){\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t\tsuccess(i);\n\t\t\telement.blur();\n\t\t});\n\n\t\tstarHolder.appendChild(nextStar);\n\t\tstarsHolder.appendChild(starHolder);\n\n\t}\n\n\t//handle keyboard navigation value change\n\tfunction changeValue(val){\n\t\tvalue = val;\n\t\tstarChange(val);\n\t}\n\n\t//style cell\n\telement.style.whiteSpace = \"nowrap\";\n\telement.style.overflow = \"hidden\";\n\telement.style.textOverflow = \"ellipsis\";\n\n\t//style holding element\n\tstarsHolder.style.verticalAlign = \"middle\";\n\tstarsHolder.style.display = \"inline-block\";\n\tstarsHolder.style.padding = \"4px\";\n\n\t//style star\n\tstar.setAttribute(\"width\", size);\n\tstar.setAttribute(\"height\", size);\n\tstar.setAttribute(\"viewBox\", \"0 0 512 512\");\n\tstar.setAttribute(\"xml:space\", \"preserve\");\n\tstar.style.padding = \"0 1px\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tstarsHolder.setAttribute(key, starsHolder.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tstarsHolder.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//create correct number of stars\n\tfor(var i=1;i<= maxStars;i++){\n\t\tbuildStar(i);\n\t}\n\n\t//ensure value does not exceed number of stars\n\tvalue = Math.min(parseInt(value), maxStars);\n\n\t// set initial styling of stars\n\tstarChange(value);\n\n\tstarsHolder.addEventListener(\"mousemove\", function(e){\n\t\tstarChange(0);\n\t});\n\n\tstarsHolder.addEventListener(\"click\", function(e){\n\t\tsuccess(0);\n\t});\n\n\telement.addEventListener(\"blur\", function(e){\n\t\tcancel();\n\t});\n\n\t//allow key based navigation\n\telement.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 39: //right arrow\n\t\t\t\tchangeValue(value + 1);\n\t\t\t\tbreak;\n\n\t\t\tcase 37: //left arrow\n\t\t\t\tchangeValue(value - 1);\n\t\t\t\tbreak;\n\n\t\t\tcase 13: //enter\n\t\t\t\tsuccess(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 27: //escape\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\treturn starsHolder;\n}\n\n//draggable progress bar\nfunction progress$1(cell, onRendered, success, cancel, editorParams){\n\tvar element = cell.getElement(),\n\tmax = typeof editorParams.max === \"undefined\" ? ((element.getElementsByTagName(\"div\")[0] && element.getElementsByTagName(\"div\")[0].getAttribute(\"max\")) || 100) : editorParams.max,\n\tmin = typeof editorParams.min === \"undefined\" ? ((element.getElementsByTagName(\"div\")[0] && element.getElementsByTagName(\"div\")[0].getAttribute(\"min\")) || 0) : editorParams.min,\n\tpercent = (max - min) / 100,\n\tvalue = cell.getValue() || 0,\n\thandle = document.createElement(\"div\"),\n\tbar = document.createElement(\"div\"),\n\tmouseDrag, mouseDragWidth;\n\n\t//set new value\n\tfunction updateValue(){\n\t\tvar style = window.getComputedStyle(element, null);\n\n\t\tvar calcVal = (percent * Math.round(bar.offsetWidth / ((element.clientWidth - parseInt(style.getPropertyValue(\"padding-left\")) - parseInt(style.getPropertyValue(\"padding-right\")))/100))) + min;\n\t\tsuccess(calcVal);\n\t\telement.setAttribute(\"aria-valuenow\", calcVal);\n\t\telement.setAttribute(\"aria-label\", value);\n\t}\n\n\t//style handle\n\thandle.style.position = \"absolute\";\n\thandle.style.right = \"0\";\n\thandle.style.top = \"0\";\n\thandle.style.bottom = \"0\";\n\thandle.style.width = \"5px\";\n\thandle.classList.add(\"tabulator-progress-handle\");\n\n\t//style bar\n\tbar.style.display = \"inline-block\";\n\tbar.style.position = \"relative\";\n\t// bar.style.top = \"8px\";\n\t// bar.style.bottom = \"8px\";\n\t// bar.style.left = \"4px\";\n\t// bar.style.marginRight = \"4px\";\n\tbar.style.height = \"100%\";\n\tbar.style.backgroundColor = \"#488CE9\";\n\tbar.style.maxWidth = \"100%\";\n\tbar.style.minWidth = \"0%\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tbar.setAttribute(key, bar.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tbar.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//style cell\n\telement.style.padding = \"4px 4px\";\n\n\t//make sure value is in range\n\tvalue = Math.min(parseFloat(value), max);\n\tvalue = Math.max(parseFloat(value), min);\n\n\t//workout percentage\n\tvalue = Math.round((value - min) / percent);\n\t// bar.style.right = value + \"%\";\n\tbar.style.width = value + \"%\";\n\n\telement.setAttribute(\"aria-valuemin\", min);\n\telement.setAttribute(\"aria-valuemax\", max);\n\n\tbar.appendChild(handle);\n\n\thandle.addEventListener(\"mousedown\", function(e){\n\t\tmouseDrag = e.screenX;\n\t\tmouseDragWidth = bar.offsetWidth;\n\t});\n\n\thandle.addEventListener(\"mouseover\", function(){\n\t\thandle.style.cursor = \"ew-resize\";\n\t});\n\n\telement.addEventListener(\"mousemove\", function(e){\n\t\tif(mouseDrag){\n\t\t\tbar.style.width = (mouseDragWidth + e.screenX - mouseDrag) + \"px\";\n\t\t}\n\t});\n\n\telement.addEventListener(\"mouseup\", function(e){\n\t\tif(mouseDrag){\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\n\t\t\tmouseDrag = false;\n\t\t\tmouseDragWidth = false;\n\n\t\t\tupdateValue();\n\t\t}\n\t});\n\n\t//allow key based navigation\n\telement.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 39: //right arrow\n\t\t\t\te.preventDefault();\n\t\t\t\tbar.style.width = (bar.clientWidth + element.clientWidth/100) + \"px\";\n\t\t\t\tbreak;\n\n\t\t\tcase 37: //left arrow\n\t\t\t\te.preventDefault();\n\t\t\t\tbar.style.width = (bar.clientWidth - element.clientWidth/100) + \"px\";\n\t\t\t\tbreak;\n\n\t\t\tcase 9: //tab\n\t\t\tcase 13: //enter\n\t\t\t\tupdateValue();\n\t\t\t\tbreak;\n\n\t\t\tcase 27: //escape\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\n\t\t}\n\t});\n\n\telement.addEventListener(\"blur\", function(){\n\t\tcancel();\n\t});\n\n\treturn bar;\n}\n\n//checkbox\nfunction tickCross$1(cell, onRendered, success, cancel, editorParams){\n\tvar value = cell.getValue(),\n\tinput = document.createElement(\"input\"),\n\ttristate = editorParams.tristate,\n\tindetermValue = typeof editorParams.indeterminateValue === \"undefined\" ? null : editorParams.indeterminateValue,\n\tindetermState = false,\n\ttrueValueSet = Object.keys(editorParams).includes(\"trueValue\"),\n\tfalseValueSet = Object.keys(editorParams).includes(\"falseValue\");\n\t\n\tinput.setAttribute(\"type\", \"checkbox\");\n\tinput.style.marginTop = \"5px\";\n\tinput.style.boxSizing = \"border-box\";\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinput.value = value;\n\t\n\tif(tristate && (typeof value === \"undefined\" || value === indetermValue || value === \"\")){\n\t\tindetermState = true;\n\t\tinput.indeterminate = true;\n\t}\n\t\n\tif(this.table.browser != \"firefox\" && this.table.browser != \"safari\"){ //prevent blur issue on mac firefox\n\t\tonRendered(function(){\n\t\t\tif(cell.getType() === \"cell\"){\n\t\t\t\tinput.focus({preventScroll: true});\n\t\t\t}\n\t\t});\n\t}\n\t\n\tinput.checked = trueValueSet ? value === editorParams.trueValue : (value === true || value === \"true\" || value === \"True\" || value === 1);\n\t\n\tfunction setValue(blur){\n\t\tvar checkedValue = input.checked;\n\t\t\n\t\tif(trueValueSet && checkedValue){\n\t\t\tcheckedValue = editorParams.trueValue;\n\t\t}else if(falseValueSet && !checkedValue){\n\t\t\tcheckedValue = editorParams.falseValue;\n\t\t}\n\t\t\n\t\tif(tristate){\n\t\t\tif(!blur){\n\t\t\t\tif(input.checked && !indetermState){\n\t\t\t\t\tinput.checked = false;\n\t\t\t\t\tinput.indeterminate = true;\n\t\t\t\t\tindetermState = true;\n\t\t\t\t\treturn indetermValue;\n\t\t\t\t}else {\n\t\t\t\t\tindetermState = false;\n\t\t\t\t\treturn checkedValue;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(indetermState){\n\t\t\t\t\treturn indetermValue;\n\t\t\t\t}else {\n\t\t\t\t\treturn checkedValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\treturn checkedValue;\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"change\", function(e){\n\t\tsuccess(setValue());\n\t});\n\n\tinput.addEventListener(\"blur\", function(e){\n\t\tsuccess(setValue(true));\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tif(e.keyCode == 13){\n\t\t\tsuccess(setValue());\n\t\t}\n\t\tif(e.keyCode == 27){\n\t\t\tcancel();\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\nfunction adaptable$1(cell, onRendered, success, cancel, params){\r\n\tvar column = cell._getSelf().column,\r\n\tlookup, editorFunc, editorParams;\r\n    \r\n\tfunction defaultLookup(cell){\r\n\t\tvar value = cell.getValue(),\r\n\t\teditor = \"input\";\r\n        \r\n\t\tswitch(typeof value){\r\n\t\t\tcase \"number\":\r\n\t\t\t\teditor = \"number\";\r\n\t\t\t\tbreak;\r\n            \r\n\t\t\tcase \"boolean\":\r\n\t\t\t\teditor = \"tickCross\";\r\n\t\t\t\tbreak;\r\n            \r\n\t\t\tcase \"string\":\r\n\t\t\t\tif(value.includes(\"\\n\")){\r\n\t\t\t\t\teditor = \"textarea\";\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n        \r\n\t\treturn editor;\r\n\t}\r\n    \r\n\tlookup = params.editorLookup ? params.editorLookup(cell) : defaultLookup(cell);\r\n\r\n\tif(params.paramsLookup){\r\n\t\teditorParams = typeof params.paramsLookup === \"function\" ? params.paramsLookup(lookup, cell) : params.paramsLookup[lookup];\r\n\t}\r\n\r\n\teditorFunc = this.table.modules.edit.lookupEditor(lookup, column);\r\n    \r\n\treturn  editorFunc.call(this, cell, onRendered, success, cancel, editorParams || {});\r\n}\n\nvar defaultEditors = {\n\tinput:input,\n\ttextarea:textarea$1,\n\tnumber:number$1,\n\trange:range,\n\tdate:date$1,\n\ttime:time$1,\n\tdatetime:datetime$2,\n\tlist:list,\n\tstar:star$1,\n\tprogress:progress$1,\n\ttickCross:tickCross$1,\n\tadaptable:adaptable$1,\n};\n\nclass Edit extends Module{\n\n\tstatic moduleName = \"edit\";\n\n\t//load defaults\n\tstatic editors = defaultEditors;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.currentCell = false; //hold currently editing cell\n\t\tthis.mouseClick = false; //hold mousedown state to prevent click binding being overridden by editor opening\n\t\tthis.recursionBlock = false; //prevent focus recursion\n\t\tthis.invalidEdit = false;\n\t\tthis.editedCells = [];\n\t\tthis.convertEmptyValues = false;\n\t\t\n\t\tthis.editors = Edit.editors;\n\t\n\t\tthis.registerTableOption(\"editTriggerEvent\", \"focus\");\n\t\tthis.registerTableOption(\"editorEmptyValue\");\n\t\tthis.registerTableOption(\"editorEmptyValueFunc\", this.emptyValueCheck.bind(this));\n\n\t\tthis.registerColumnOption(\"editable\");\n\t\tthis.registerColumnOption(\"editor\");\n\t\tthis.registerColumnOption(\"editorParams\");\n\t\tthis.registerColumnOption(\"editorEmptyValue\");\n\t\tthis.registerColumnOption(\"editorEmptyValueFunc\");\n\t\t\n\t\tthis.registerColumnOption(\"cellEditing\");\n\t\tthis.registerColumnOption(\"cellEdited\");\n\t\tthis.registerColumnOption(\"cellEditCancelled\");\n\t\t\n\t\tthis.registerTableFunction(\"getEditedCells\", this.getEditedCells.bind(this));\n\t\tthis.registerTableFunction(\"clearCellEdited\", this.clearCellEdited.bind(this));\n\t\tthis.registerTableFunction(\"navigatePrev\", this.navigatePrev.bind(this));\n\t\tthis.registerTableFunction(\"navigateNext\", this.navigateNext.bind(this));\n\t\tthis.registerTableFunction(\"navigateLeft\", this.navigateLeft.bind(this));\n\t\tthis.registerTableFunction(\"navigateRight\", this.navigateRight.bind(this));\n\t\tthis.registerTableFunction(\"navigateUp\", this.navigateUp.bind(this));\n\t\tthis.registerTableFunction(\"navigateDown\", this.navigateDown.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"cell\", \"isEdited\", this.cellIsEdited.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"clearEdited\", this.clearEdited.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"edit\", this.editCell.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"cancelEdit\", this.cellCancelEdit.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"cell\", \"navigatePrev\", this.navigatePrev.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateNext\", this.navigateNext.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateLeft\", this.navigateLeft.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateRight\", this.navigateRight.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateUp\", this.navigateUp.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateDown\", this.navigateDown.bind(this));\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"cell-init\", this.bindEditor.bind(this));\n\t\tthis.subscribe(\"cell-delete\", this.clearEdited.bind(this));\n\t\tthis.subscribe(\"cell-value-changed\", this.updateCellClass.bind(this));\n\t\tthis.subscribe(\"column-layout\", this.initializeColumnCheck.bind(this));\n\t\tthis.subscribe(\"column-delete\", this.columnDeleteCheck.bind(this));\n\t\tthis.subscribe(\"row-deleting\", this.rowDeleteCheck.bind(this));\n\t\tthis.subscribe(\"row-layout\", this.rowEditableCheck.bind(this));\n\t\tthis.subscribe(\"data-refreshing\", this.cancelEdit.bind(this));\n\t\tthis.subscribe(\"clipboard-paste\", this.pasteBlocker.bind(this));\n\t\t\n\t\tthis.subscribe(\"keybinding-nav-prev\", this.navigatePrev.bind(this, undefined));\n\t\tthis.subscribe(\"keybinding-nav-next\", this.keybindingNavigateNext.bind(this));\n\t\t\n\t\t// this.subscribe(\"keybinding-nav-left\", this.navigateLeft.bind(this, undefined));\n\t\t// this.subscribe(\"keybinding-nav-right\", this.navigateRight.bind(this, undefined));\n\t\tthis.subscribe(\"keybinding-nav-up\", this.navigateUp.bind(this, undefined));\n\t\tthis.subscribe(\"keybinding-nav-down\", this.navigateDown.bind(this, undefined));\n\n\t\tif(Object.keys(this.table.options).includes(\"editorEmptyValue\")){\n\t\t\tthis.convertEmptyValues = true;\n\t\t}\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////// Paste Negation //////////\n\t///////////////////////////////////\n\t\n\tpasteBlocker(e){\n\t\tif(this.currentCell){\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t////// Keybinding Functions ///////\n\t///////////////////////////////////\n\t\n\tkeybindingNavigateNext(e){\n\t\tvar cell = this.currentCell,\n\t\tnewRow = this.options(\"tabEndNewRow\");\n\n\t\tif(cell){\n\t\t\tif(!this.navigateNext(cell, e)){\n\t\t\t\tif(newRow){\n\t\t\t\t\tcell.getElement().firstChild.blur();\n\t\t\t\t\t\n\t\t\t\t\tif(!this.invalidEdit){\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(newRow === true){\n\t\t\t\t\t\t\tnewRow = this.table.addRow({});\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tif(typeof newRow == \"function\"){\n\t\t\t\t\t\t\t\tnewRow = this.table.addRow(newRow(cell.row.getComponent()));\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tnewRow = this.table.addRow(Object.assign({}, newRow));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tnewRow.then(() => {\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tcell.getComponent().navigateNext();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Cell Functions //////////\n\t///////////////////////////////////\n\t\n\tcellIsEdited(cell){\n\t\treturn !! cell.modules.edit && cell.modules.edit.edited;\n\t}\n\t\n\tcellCancelEdit(cell){\n\t\tif(cell === this.currentCell){\n\t\t\tthis.table.modules.edit.cancelEdit();\n\t\t}else {\n\t\t\tconsole.warn(\"Cancel Editor Error - This cell is not currently being edited \");\n\t\t}\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\tupdateCellClass(cell){\n\t\tif(this.allowEdit(cell)) {\n\t\t\tcell.getElement().classList.add(\"tabulator-editable\");\n\t\t}\n\t\telse {\n\t\t\tcell.getElement().classList.remove(\"tabulator-editable\");\n\t\t}\n\t}\n\t\n\tclearCellEdited(cells){\n\t\tif(!cells){\n\t\t\tcells = this.table.modules.edit.getEditedCells();\n\t\t}\n\t\t\n\t\tif(!Array.isArray(cells)){\n\t\t\tcells = [cells];\n\t\t}\n\t\t\n\t\tcells.forEach((cell) => {\n\t\t\tthis.table.modules.edit.clearEdited(cell._getSelf());\n\t\t});\n\t}\n\t\n\tnavigatePrev(cell = this.currentCell, e){\n\t\tvar nextCell, prevRow;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tnextCell = this.navigateLeft();\n\t\t\t\n\t\t\tif(nextCell){\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tprevRow = this.table.rowManager.prevDisplayRow(cell.row, true);\n\t\t\t\t\n\t\t\t\tif(prevRow){\n\t\t\t\t\tnextCell = this.findPrevEditableCell(prevRow, prevRow.cells.length);\n\t\t\t\t\t\n\t\t\t\t\tif(nextCell){\n\t\t\t\t\t\tnextCell.getComponent().edit();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateNext(cell = this.currentCell, e){\n\t\tvar nextCell, nextRow;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tnextCell = this.navigateRight();\n\t\t\t\n\t\t\tif(nextCell){\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tnextRow = this.table.rowManager.nextDisplayRow(cell.row, true);\n\t\t\t\t\n\t\t\t\tif(nextRow){\n\t\t\t\t\tnextCell = this.findNextEditableCell(nextRow, -1);\n\t\t\t\t\t\n\t\t\t\t\tif(nextCell){\n\t\t\t\t\t\tnextCell.getComponent().edit();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateLeft(cell = this.currentCell, e){\n\t\tvar index, nextCell;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tindex = cell.getIndex();\n\t\t\tnextCell = this.findPrevEditableCell(cell.row, index);\n\t\t\t\n\t\t\tif(nextCell){\n\t\t\t\tnextCell.getComponent().edit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateRight(cell = this.currentCell, e){\n\t\tvar index, nextCell;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tindex = cell.getIndex();\n\t\t\tnextCell = this.findNextEditableCell(cell.row, index);\n\t\t\t\n\t\t\tif(nextCell){\n\t\t\t\tnextCell.getComponent().edit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateUp(cell = this.currentCell, e){\n\t\tvar index, nextRow;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tindex = cell.getIndex();\n\t\t\tnextRow = this.table.rowManager.prevDisplayRow(cell.row, true);\n\t\t\t\n\t\t\tif(nextRow){\n\t\t\t\tnextRow.cells[index].getComponent().edit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateDown(cell = this.currentCell, e){\n\t\tvar index, nextRow;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tindex = cell.getIndex();\n\t\t\tnextRow = this.table.rowManager.nextDisplayRow(cell.row, true);\n\t\t\t\n\t\t\tif(nextRow){\n\t\t\t\tnextRow.cells[index].getComponent().edit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tfindNextEditableCell(row, index){\n\t\tvar nextCell = false;\n\t\t\n\t\tif(index < row.cells.length-1){\n\t\t\tfor(var i = index+1; i < row.cells.length; i++){\n\t\t\t\tlet cell = row.cells[i];\n\t\t\t\t\n\t\t\t\tif(cell.column.modules.edit && Helpers.elVisible(cell.getElement())){\n\t\t\t\t\tlet allowEdit = this.allowEdit(cell);\n\t\t\t\t\t\n\t\t\t\t\tif(allowEdit){\n\t\t\t\t\t\tnextCell = cell;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn nextCell;\n\t}\n\t\n\tfindPrevEditableCell(row, index){\n\t\tvar prevCell = false;\n\t\t\n\t\tif(index > 0){\n\t\t\tfor(var i = index-1; i >= 0; i--){\n\t\t\t\tlet cell = row.cells[i];\n\t\t\t\t\n\t\t\t\tif(cell.column.modules.edit && Helpers.elVisible(cell.getElement())){\n\t\t\t\t\tlet allowEdit = this.allowEdit(cell);\n\t\t\t\t\t\n\t\t\t\t\tif(allowEdit){\n\t\t\t\t\t\tprevCell = cell;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn prevCell;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tinitializeColumnCheck(column){\n\t\tif(typeof column.definition.editor !== \"undefined\"){\n\t\t\tthis.initializeColumn(column);\n\t\t}\n\t}\n\t\n\tcolumnDeleteCheck(column){\n\t\tif(this.currentCell && this.currentCell.column === column){\n\t\t\tthis.cancelEdit();\n\t\t}\n\t}\n\t\n\trowDeleteCheck(row){\n\t\tif(this.currentCell && this.currentCell.row === row){\n\t\t\tthis.cancelEdit();\n\t\t}\n\t}\n\t\n\trowEditableCheck(row){\n\t\trow.getCells().forEach((cell) => {\n\t\t\tif(cell.column.modules.edit && typeof cell.column.modules.edit.check === \"function\"){\n\t\t\t\tthis.updateCellClass(cell);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//initialize column editor\n\tinitializeColumn(column){\n\t\tvar convertEmpty = Object.keys(column.definition).includes(\"editorEmptyValue\");\n\n\t\tvar config = {\n\t\t\teditor:false,\n\t\t\tblocked:false,\n\t\t\tcheck:column.definition.editable,\n\t\t\tparams:column.definition.editorParams || {},\n\t\t\tconvertEmptyValues:convertEmpty,\n\t\t\teditorEmptyValue:column.definition.editorEmptyValue,\n\t\t\teditorEmptyValueFunc:column.definition.editorEmptyValueFunc,\n\t\t};\n\t\t\n\t\t//set column editor\n\t\tconfig.editor = this.lookupEditor(column.definition.editor, column);\n\t\t\n\t\tif(config.editor){\n\t\t\tcolumn.modules.edit = config;\n\t\t}\n\t}\n\n\tlookupEditor(editor, column){\n\t\tvar editorFunc;\n\n\t\tswitch(typeof editor){\n\t\t\tcase \"string\":\n\t\t\t\tif(this.editors[editor]){\n\t\t\t\t\teditorFunc = this.editors[editor];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Editor Error - No such editor found: \", editor);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"function\":\n\t\t\t\teditorFunc = editor;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"boolean\":\n\t\t\t\tif(editor === true){\n\t\t\t\t\tif(typeof column.definition.formatter !== \"function\"){\n\t\t\t\t\t\tif(this.editors[column.definition.formatter]){\n\t\t\t\t\t\t\teditorFunc = this.editors[column.definition.formatter];\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\teditorFunc = this.editors[\"input\"];\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Editor Error - Cannot auto lookup editor for a custom formatter: \", column.definition.formatter);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn editorFunc;\n\t}\n\t\n\tgetCurrentCell(){\n\t\treturn this.currentCell ? this.currentCell.getComponent() : false;\n\t}\n\t\n\tclearEditor(cancel){\n\t\tvar cell = this.currentCell,\n\t\tcellEl;\n\t\t\n\t\tthis.invalidEdit = false;\n\t\t\n\t\tif(cell){\n\t\t\tthis.currentCell = false;\n\t\t\t\n\t\t\tcellEl = cell.getElement();\n\t\t\t\n\t\t\tthis.dispatch(\"edit-editor-clear\", cell, cancel);\n\t\t\t\n\t\t\tcellEl.classList.remove(\"tabulator-editing\");\n\t\t\t\n\t\t\twhile(cellEl.firstChild) cellEl.removeChild(cellEl.firstChild);\n\t\t\t\n\t\t\tcell.row.getElement().classList.remove(\"tabulator-editing\");\n\t\t\t\n\t\t\tcell.table.element.classList.remove(\"tabulator-editing\");\n\t\t}\n\t}\n\t\n\tcancelEdit(){\n\t\tif(this.currentCell){\n\t\t\tvar cell = this.currentCell;\n\t\t\tvar component = this.currentCell.getComponent();\n\t\t\t\n\t\t\tthis.clearEditor(true);\n\t\t\tcell.setValueActual(cell.getValue());\n\t\t\tcell.cellRendered();\n\t\t\t\n\t\t\tif(cell.column.definition.editor == \"textarea\" || cell.column.definition.variableHeight){\n\t\t\t\tcell.row.normalizeHeight(true);\n\t\t\t}\n\t\t\t\n\t\t\tif(cell.column.definition.cellEditCancelled){\n\t\t\t\tcell.column.definition.cellEditCancelled.call(this.table, component);\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"edit-cancelled\", cell);\n\t\t\tthis.dispatchExternal(\"cellEditCancelled\", component);\n\t\t}\n\t}\n\t\n\t//return a formatted value for a cell\n\tbindEditor(cell){\n\t\tif(cell.column.modules.edit){\n\t\t\tvar self = this,\n\t\t\telement = cell.getElement(true);\n\t\t\t\n\t\t\tthis.updateCellClass(cell);\n\t\t\telement.setAttribute(\"tabindex\", 0);\n\t\t\t\n\t\t\telement.addEventListener(\"mousedown\", function(e){\n\t\t\t\tif (e.button === 2) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}else {\n\t\t\t\t\tself.mouseClick = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(this.options(\"editTriggerEvent\") === \"dblclick\"){\n\t\t\t\telement.addEventListener(\"dblclick\", function(e){\n\t\t\t\t\tif(!element.classList.contains(\"tabulator-editing\")){\n\t\t\t\t\t\telement.focus({preventScroll: true});\n\t\t\t\t\t\tself.edit(cell, e, false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tif(this.options(\"editTriggerEvent\") === \"focus\" || this.options(\"editTriggerEvent\") === \"click\"){\n\t\t\t\telement.addEventListener(\"click\", function(e){\n\t\t\t\t\tif(!element.classList.contains(\"tabulator-editing\")){\n\t\t\t\t\t\telement.focus({preventScroll: true});\n\t\t\t\t\t\tself.edit(cell, e, false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif(this.options(\"editTriggerEvent\") === \"focus\"){\n\t\t\t\telement.addEventListener(\"focus\", function(e){\n\t\t\t\t\tif(!self.recursionBlock){\n\t\t\t\t\t\tself.edit(cell, e, false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfocusCellNoEvent(cell, block){\n\t\tthis.recursionBlock = true;\n\t\t\n\t\tif(!(block && this.table.browser === \"ie\")){\n\t\t\tcell.getElement().focus({preventScroll: true});\n\t\t}\n\t\t\n\t\tthis.recursionBlock = false;\n\t}\n\t\n\teditCell(cell, forceEdit){\n\t\tthis.focusCellNoEvent(cell);\n\t\tthis.edit(cell, false, forceEdit);\n\t}\n\t\n\tfocusScrollAdjust(cell){\n\t\tif(this.table.rowManager.getRenderMode() == \"virtual\"){\n\t\t\tvar topEdge = this.table.rowManager.element.scrollTop,\n\t\t\tbottomEdge = this.table.rowManager.element.clientHeight + this.table.rowManager.element.scrollTop,\n\t\t\trowEl = cell.row.getElement();\n\t\t\t\n\t\t\tif(rowEl.offsetTop < topEdge){\n\t\t\t\tthis.table.rowManager.element.scrollTop -= (topEdge - rowEl.offsetTop);\n\t\t\t}else {\n\t\t\t\tif(rowEl.offsetTop + rowEl.offsetHeight  > bottomEdge){\n\t\t\t\t\tthis.table.rowManager.element.scrollTop += (rowEl.offsetTop + rowEl.offsetHeight - bottomEdge);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tvar leftEdge = this.table.rowManager.element.scrollLeft,\n\t\t\trightEdge = this.table.rowManager.element.clientWidth + this.table.rowManager.element.scrollLeft,\n\t\t\tcellEl = cell.getElement();\n\t\t\t\n\t\t\tif(this.table.modExists(\"frozenColumns\")){\n\t\t\t\tleftEdge += parseInt(this.table.modules.frozenColumns.leftMargin || 0);\n\t\t\t\trightEdge -= parseInt(this.table.modules.frozenColumns.rightMargin || 0);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.options.renderHorizontal === \"virtual\"){\n\t\t\t\tleftEdge -= parseInt(this.table.columnManager.renderer.vDomPadLeft);\n\t\t\t\trightEdge -= parseInt(this.table.columnManager.renderer.vDomPadLeft);\n\t\t\t}\n\t\t\t\n\t\t\tif(cellEl.offsetLeft < leftEdge){\n\t\t\t\tthis.table.rowManager.element.scrollLeft -= (leftEdge - cellEl.offsetLeft);\n\t\t\t}else {\n\t\t\t\tif(cellEl.offsetLeft + cellEl.offsetWidth  > rightEdge){\n\t\t\t\t\tthis.table.rowManager.element.scrollLeft += (cellEl.offsetLeft + cellEl.offsetWidth - rightEdge);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tallowEdit(cell) {\n\t\tvar check = cell.column.modules.edit ? true : false;\n\t\t\n\t\tif(cell.column.modules.edit){\n\t\t\tswitch(typeof cell.column.modules.edit.check){\n\t\t\t\tcase \"function\":\n\t\t\t\t\tif(cell.row.initialized){\n\t\t\t\t\t\tcheck = cell.column.modules.edit.check(cell.getComponent());\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"string\":\n\t\t\t\t\tcheck = !!cell.row.data[cell.column.modules.edit.check];\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tcheck = cell.column.modules.edit.check;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn check;\n\t}\n\t\n\tedit(cell, e, forceEdit){\n\t\tvar self = this,\n\t\tallowEdit = true,\n\t\trendered = function(){},\n\t\telement = cell.getElement(),\n\t\teditFinished = false,\n\t\tcellEditor, component, params;\n\n\t\t//prevent editing if another cell is refusing to leave focus (eg. validation fail)\n\t\t\n\t\tif(this.currentCell){\n\t\t\tif(!this.invalidEdit && this.currentCell !== cell){\n\t\t\t\tthis.cancelEdit();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t//handle successful value change\n\t\tfunction success(value){\n\t\t\tif(self.currentCell === cell && !editFinished){\n\t\t\t\tvar valid = self.chain(\"edit-success\", [cell, value], true, true);\n\n\t\t\t\tif(valid === true || self.table.options.validationMode === \"highlight\"){\n\n\t\t\t\t\teditFinished = true;\n\n\t\t\t\t\tself.clearEditor();\n\t\t\t\t\t\n\t\t\t\t\tif(!cell.modules.edit){\n\t\t\t\t\t\tcell.modules.edit = {};\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tcell.modules.edit.edited = true;\n\t\t\t\t\t\n\t\t\t\t\tif(self.editedCells.indexOf(cell) == -1){\n\t\t\t\t\t\tself.editedCells.push(cell);\n\t\t\t\t\t}\n\n\t\t\t\t\tvalue = self.transformEmptyValues(value, cell);\n\t\t\t\t\t\n\t\t\t\t\tcell.setValue(value, true);\n\n\t\t\t\t\treturn valid === true;\n\t\t\t\t}else {\n\t\t\t\t\teditFinished = true;\n\t\t\t\t\tself.invalidEdit = true;\n\t\t\t\t\tself.focusCellNoEvent(cell, true);\n\t\t\t\t\trendered();\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\teditFinished = false;\n\t\t\t\t\t}, 10);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t//handle aborted edit\n\t\tfunction cancel(){\n\t\t\t// editFinished = true;\n\n\t\t\tif(self.currentCell === cell && !editFinished){\n\t\t\t\tself.cancelEdit();\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction onRendered(callback){\n\t\t\trendered = callback;\n\t\t}\n\t\t\n\t\tif(!cell.column.modules.edit.blocked){\n\t\t\tif(e){\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t\t\n\t\t\tallowEdit = this.allowEdit(cell);\n\t\t\t\n\t\t\tif(allowEdit || forceEdit){\n\t\t\t\tself.cancelEdit();\n\t\t\t\t\n\t\t\t\tself.currentCell = cell;\n\t\t\t\t\n\t\t\t\tthis.focusScrollAdjust(cell);\n\t\t\t\t\n\t\t\t\tcomponent = cell.getComponent();\n\t\t\t\t\n\t\t\t\tif(this.mouseClick){\n\t\t\t\t\tthis.mouseClick = false;\n\t\t\t\t\t\n\t\t\t\t\tif(cell.column.definition.cellClick){\n\t\t\t\t\t\tcell.column.definition.cellClick.call(this.table, e, component);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(cell.column.definition.cellEditing){\n\t\t\t\t\tcell.column.definition.cellEditing.call(this.table, component);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.dispatch(\"cell-editing\", cell);\n\t\t\t\tthis.dispatchExternal(\"cellEditing\", component);\n\t\t\t\t\n\t\t\t\tparams = typeof cell.column.modules.edit.params === \"function\" ? cell.column.modules.edit.params(component) : cell.column.modules.edit.params;\n\t\t\t\t\n\t\t\t\tcellEditor = cell.column.modules.edit.editor.call(self, component, onRendered, success, cancel, params);\n\t\t\t\t\n\t\t\t\t//if editor returned, add to DOM, if false, abort edit\n\t\t\t\tif(this.currentCell && cellEditor !== false){\n\t\t\t\t\tif(cellEditor instanceof Node){\n\t\t\t\t\t\telement.classList.add(\"tabulator-editing\");\n\t\t\t\t\t\tcell.row.getElement().classList.add(\"tabulator-editing\");\n\t\t\t\t\t\tcell.table.element.classList.add(\"tabulator-editing\");\n\t\t\t\t\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\t\t\t\t\t\telement.appendChild(cellEditor);\n\t\t\t\t\t\t\n\t\t\t\t\t\t//trigger onRendered Callback\n\t\t\t\t\t\trendered();\n\t\t\t\t\t\t\n\t\t\t\t\t\t//prevent editing from triggering rowClick event\n\t\t\t\t\t\tvar children = element.children;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\t\t\t\tchildren[i].addEventListener(\"click\", function(e){\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Edit Error - Editor should return an instance of Node, the editor returned:\", cellEditor);\n\t\t\t\t\t\tthis.blur(element);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tthis.blur(element);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tthis.mouseClick = false;\n\t\t\t\tthis.blur(element);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else {\n\t\t\tthis.mouseClick = false;\n\t\t\tthis.blur(element);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\temptyValueCheck(value){\n\t\treturn value === \"\" || value === null || typeof value === \"undefined\";\n\t}\n\n\ttransformEmptyValues(value, cell){\n\t\tvar mod = cell.column.modules.edit, \n\t\tconvert = mod.convertEmptyValues || this.convertEmptyValues,\n\t\tcheckFunc;\n\t\t\n\t\tif(convert){\n\t\t\tcheckFunc = mod.editorEmptyValueFunc || this.options(\"editorEmptyValueFunc\");\n\n\t\t\tif(checkFunc && checkFunc(value)){\n\t\t\t\tvalue = mod.convertEmptyValues ? mod.editorEmptyValue : this.options(\"editorEmptyValue\");\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn value;\n\t}\n\t\n\tblur(element){\n\t\tif(!this.confirm(\"edit-blur\", [element]) ){\n\t\t\telement.blur();\n\t\t}\n\t}\n\t\n\tgetEditedCells(){\n\t\tvar output = [];\n\t\t\n\t\tthis.editedCells.forEach((cell) => {\n\t\t\toutput.push(cell.getComponent());\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tclearEdited(cell){\n\t\tvar editIndex;\n\t\t\n\t\tif(cell.modules.edit && cell.modules.edit.edited){\n\t\t\tcell.modules.edit.edited = false;\n\t\t\t\n\t\t\tthis.dispatch(\"edit-edited-clear\", cell);\n\t\t}\n\t\t\n\t\teditIndex = this.editedCells.indexOf(cell);\n\t\t\n\t\tif(editIndex > -1){\n\t\t\tthis.editedCells.splice(editIndex, 1);\n\t\t}\n\t}\n}\n\nclass ExportRow{\n\tconstructor(type, columns, component, indent){\n\t\tthis.type = type;\n\t\tthis.columns = columns;\n\t\tthis.component = component || false;\n\t\tthis.indent = indent || 0;\n\t}\n}\n\nclass ExportColumn{\n\tconstructor(value, component, width, height, depth){\n\t\tthis.value = value;\n\t\tthis.component = component || false;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.depth = depth;\n\t}\n}\n\nvar columnLookups$1 = {\r\n\r\n};\n\nvar rowLookups$1 = {\r\n\tvisible:function(){\r\n\t\treturn this.rowManager.getVisibleRows(false, true);\r\n\t},\r\n\tall:function(){\r\n\t\treturn this.rowManager.rows;\r\n\t},\r\n\tselected:function(){\r\n\t\treturn this.modules.selectRow.selectedRows;\r\n\t},\r\n\tactive:function(){\r\n\t\tif(this.options.pagination){\r\n\t\t\treturn this.rowManager.getDisplayRows(this.rowManager.displayRows.length - 2);\r\n\t\t}else {\r\n\t\t\treturn this.rowManager.getDisplayRows();\r\n\t\t}\r\n\t},\r\n};\n\nclass Export extends Module{\n\n\tstatic moduleName = \"export\";\n\n\tstatic columnLookups = columnLookups$1;\n\tstatic rowLookups = rowLookups$1;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.config = {};\n\t\tthis.cloneTableStyle = true;\n\t\tthis.colVisProp = \"\";\n\t\tthis.colVisPropAttach = \"\";\n\t\t\n\t\tthis.registerTableOption(\"htmlOutputConfig\", false); //html output config\n\t\t\n\t\tthis.registerColumnOption(\"htmlOutput\");\n\t\tthis.registerColumnOption(\"titleHtmlOutput\");\n\t}\n\t\n\tinitialize(){\n\t\tthis.registerTableFunction(\"getHtml\", this.getHtml.bind(this));\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tgenerateExportList(config, style, range, colVisProp){\n\t\tvar headers, body, columns, colLookup;\n\n\t\tthis.cloneTableStyle = style;\n\t\tthis.config = config || {};\n\t\tthis.colVisProp = colVisProp;\n\t\tthis.colVisPropAttach = this.colVisProp.charAt(0).toUpperCase() + this.colVisProp.slice(1);\n\n\t\tcolLookup = Export.columnLookups[range];\n\n\t\tif(colLookup){\n\t\t\tcolumns = colLookup.call(this.table);\n\t\t\tcolumns = columns.filter(col => this.columnVisCheck(col));\n\t\t}\n\n\t\theaders = this.config.columnHeaders !== false ? this.headersToExportRows(this.generateColumnGroupHeaders(columns)) : [];\n\n\t\tif(columns){\n\t\t\tcolumns = columns.map(col => col.getComponent());\n\t\t}\n\t\t\n\t\tbody = this.bodyToExportRows(this.rowLookup(range), columns);\n\n\t\treturn headers.concat(body);\n\t}\n\t\n\tgenerateTable(config, style, range, colVisProp){\n\t\tvar list = this.generateExportList(config, style, range, colVisProp);\n\t\t\n\t\treturn this.generateTableElement(list);\n\t}\n\t\n\trowLookup(range){\n\t\tvar rows = [], \n\t\trowLookup;\n\t\t\n\t\tif(typeof range == \"function\"){\n\t\t\trange.call(this.table).forEach((row) =>{\n\t\t\t\trow = this.table.rowManager.findRow(row);\n\t\t\t\t\n\t\t\t\tif(row){\n\t\t\t\t\trows.push(row);\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\trowLookup = Export.rowLookups[range] || Export.rowLookups[\"active\"];\n\n\t\t\trows = rowLookup.call(this.table);\n\t\t}\n\t\t\n\t\treturn Object.assign([], rows);\n\t}\n\t\n\tgenerateColumnGroupHeaders(columns){\n\t\tvar output = [];\n\t\t\n\t\tif (!columns) {\n\t\t\tcolumns = this.config.columnGroups !== false ? this.table.columnManager.columns : this.table.columnManager.columnsByIndex;\n\t\t}\n\t\t\n\t\tcolumns.forEach((column) => {\n\t\t\tvar colData = this.processColumnGroup(column);\n\t\t\t\n\t\t\tif(colData){\n\t\t\t\toutput.push(colData);\n\t\t\t}\n\t\t});\n\n\n\n\t\treturn output;\n\t}\n\t\n\tprocessColumnGroup(column){\n\t\tvar subGroups = column.columns,\n\t\tmaxDepth = 0,\n\t\ttitle = column.definition[\"title\" + (this.colVisPropAttach)] || column.definition.title;\n\t\t\n\t\tvar groupData = {\n\t\t\ttitle:title,\n\t\t\tcolumn:column,\n\t\t\tdepth:1,\n\t\t};\n\t\t\n\t\tif(subGroups.length){\n\t\t\tgroupData.subGroups = [];\n\t\t\tgroupData.width = 0;\n\t\t\t\n\t\t\tsubGroups.forEach((subGroup) => {\n\t\t\t\tvar subGroupData = this.processColumnGroup(subGroup);\n\t\t\t\t\n\t\t\t\tif(subGroupData){\n\t\t\t\t\tgroupData.width += subGroupData.width;\n\t\t\t\t\tgroupData.subGroups.push(subGroupData);\n\t\t\t\t\t\n\t\t\t\t\tif(subGroupData.depth > maxDepth){\n\t\t\t\t\t\tmaxDepth = subGroupData.depth;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tgroupData.depth += maxDepth;\n\t\t\t\n\t\t\tif(!groupData.width){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else {\n\t\t\tif(this.columnVisCheck(column)){\n\t\t\t\tgroupData.width = 1;\n\t\t\t}else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn groupData;\n\t}\n\t\n\tcolumnVisCheck(column){\n\t\tvar visProp = column.definition[this.colVisProp];\n\n\t\tif(this.config.rowHeaders === false && column.isRowHeader){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(typeof visProp === \"function\"){\n\t\t\tvisProp = visProp.call(this.table, column.getComponent());\n\t\t}\n\n\t\tif(visProp === false || visProp === true){\n\t\t\treturn visProp;\n\t\t}\n\n\t\treturn column.visible && column.field;\n\t}\n\t\n\theadersToExportRows(columns){\n\t\tvar headers = [],\n\t\theaderDepth = 0,\n\t\texportRows = [];\n\t\t\n\t\tfunction parseColumnGroup(column, level){\n\t\t\t\n\t\t\tvar depth = headerDepth - level;\n\t\t\t\n\t\t\tif(typeof headers[level] === \"undefined\"){\n\t\t\t\theaders[level] = [];\n\t\t\t}\n\t\t\t\n\t\t\tcolumn.height = column.subGroups ? 1 : (depth - column.depth) + 1;\n\t\t\t\n\t\t\theaders[level].push(column);\n\t\t\t\n\t\t\tif(column.height > 1){\n\t\t\t\tfor(let i = 1; i < column.height; i ++){\n\t\t\t\t\t\n\t\t\t\t\tif(typeof headers[level + i] === \"undefined\"){\n\t\t\t\t\t\theaders[level + i] = [];\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\theaders[level + i].push(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(column.width > 1){\n\t\t\t\tfor(let i = 1; i < column.width; i ++){\n\t\t\t\t\theaders[level].push(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(column.subGroups){\n\t\t\t\tcolumn.subGroups.forEach(function(subGroup){\n\t\t\t\t\tparseColumnGroup(subGroup, level+1);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\t\t//calculate maximum header depth\n\t\tcolumns.forEach(function(column){\n\t\t\tif(column.depth > headerDepth){\n\t\t\t\theaderDepth = column.depth;\n\t\t\t}\n\t\t});\n\t\t\n\t\tcolumns.forEach(function(column){\n\t\t\tparseColumnGroup(column,0);\n\t\t});\n\t\t\n\t\theaders.forEach((header) => {\n\t\t\tvar columns = [];\n\t\t\t\n\t\t\theader.forEach((col) => {\n\t\t\t\tif(col){\n\t\t\t\t\tlet title = typeof col.title === \"undefined\" ? \"\" : col.title;\n\t\t\t\t\tcolumns.push(new ExportColumn(title, col.column.getComponent(), col.width, col.height, col.depth));\n\t\t\t\t}else {\n\t\t\t\t\tcolumns.push(null);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\texportRows.push(new ExportRow(\"header\", columns));\n\t\t});\n\t\t\n\t\treturn exportRows;\n\t}\n\t\n\tbodyToExportRows(rows, columns = []){\n\t\tvar exportRows = [];\n\t\t\n\t\tif (columns.length === 0) {\n\t\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\t\tif (this.columnVisCheck(column)) {\n\t\t\t\t\tcolumns.push(column.getComponent());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(this.config.columnCalcs !== false && this.table.modExists(\"columnCalcs\")){\n\t\t\tif(this.table.modules.columnCalcs.topInitialized){\n\t\t\t\trows.unshift(this.table.modules.columnCalcs.topRow);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.modules.columnCalcs.botInitialized){\n\t\t\t\trows.push(this.table.modules.columnCalcs.botRow);\n\t\t\t}\n\t\t}\n\n\t\trows = rows.filter((row) => {\n\t\t\tswitch(row.type){\n\t\t\t\tcase \"group\":\n\t\t\t\t\treturn this.config.rowGroups !== false;\n\t\t\t\t\n\t\t\t\tcase \"calc\":\n\t\t\t\t\treturn this.config.columnCalcs !== false;\n\t\t\t\t\n\t\t\t\tcase \"row\":\n\t\t\t\t\treturn !(this.table.options.dataTree && this.config.dataTree === false && row.modules.dataTree.parent);\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\n\t\t});\n\t\t\n\t\trows.forEach((row, i) => {\n\t\t\tvar rowData = row.getData(this.colVisProp);\n\t\t\tvar exportCols = [];\n\t\t\tvar indent = 0;\n\t\t\t\n\t\t\tswitch(row.type){\n\t\t\t\tcase \"group\":\n\t\t\t\t\tindent = row.level;\n\t\t\t\t\texportCols.push(new ExportColumn(row.key, row.getComponent(), columns.length, 1));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"calc\" :\n\t\t\t\tcase \"row\" :\n\t\t\t\t\tcolumns.forEach((col) => {\n\t\t\t\t\t\texportCols.push(new ExportColumn(col._column.getFieldValue(rowData), col, 1, 1));\n\t\t\t\t\t});\n\t\t\t\t\n\t\t\t\t\tif(this.table.options.dataTree && this.config.dataTree !== false){\n\t\t\t\t\t\tindent = row.modules.dataTree.index;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\texportRows.push(new ExportRow(row.type, exportCols, row.getComponent(), indent));\n\t\t});\n\t\t\n\t\treturn exportRows;\n\t}\n\t\n\tgenerateTableElement(list){\n\t\tvar table = document.createElement(\"table\"),\n\t\theaderEl = document.createElement(\"thead\"),\n\t\tbodyEl = document.createElement(\"tbody\"),\n\t\tstyles = this.lookupTableStyles(),\n\t\trowFormatter = this.table.options[\"rowFormatter\" + (this.colVisPropAttach)],\n\t\tsetup = {};\n\t\t\n\t\tsetup.rowFormatter = rowFormatter !== null ? rowFormatter : this.table.options.rowFormatter;\n\t\t\n\t\tif(this.table.options.dataTree &&this.config.dataTree !== false && this.table.modExists(\"columnCalcs\")){\n\t\t\tsetup.treeElementField = this.table.modules.dataTree.elementField;\n\t\t}\n\t\t\n\t\t//assign group header formatter\n\t\tsetup.groupHeader = this.table.options[\"groupHeader\" + (this.colVisPropAttach)];\n\t\t\n\t\tif(setup.groupHeader && !Array.isArray(setup.groupHeader)){\n\t\t\tsetup.groupHeader = [setup.groupHeader];\n\t\t}\n\t\t\n\t\ttable.classList.add(\"tabulator-print-table\");\n\t\t\n\t\tthis.mapElementStyles(this.table.columnManager.getHeadersElement(), headerEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"background-color\", \"color\", \"font-weight\", \"font-family\", \"font-size\"]);\n\n\t\tif(list.length > 1000){\n\t\t\tconsole.warn(\"It may take a long time to render an HTML table with more than 1000 rows\");\n\t\t}\n\t\t\n\t\tlist.forEach((row, i) => {\n\t\t\tlet rowEl;\n\t\t\t\n\t\t\tswitch(row.type){\n\t\t\t\tcase \"header\":\n\t\t\t\t\theaderEl.appendChild(this.generateHeaderElement(row, setup, styles));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"group\":\n\t\t\t\t\tbodyEl.appendChild(this.generateGroupElement(row, setup, styles));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"calc\":\n\t\t\t\t\tbodyEl.appendChild(this.generateCalcElement(row, setup, styles));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"row\":\n\t\t\t\t\trowEl = this.generateRowElement(row, setup, styles);\n\t\t\t\t\n\t\t\t\t\tthis.mapElementStyles(((i % 2) && styles.evenRow) ? styles.evenRow : styles.oddRow, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\t\t\t\t\tbodyEl.appendChild(rowEl);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(headerEl.innerHTML){\n\t\t\ttable.appendChild(headerEl);\n\t\t}\n\t\t\n\t\ttable.appendChild(bodyEl);\n\t\t\n\t\t\n\t\tthis.mapElementStyles(this.table.element, table, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\"]);\n\t\treturn table;\n\t}\n\t\n\tlookupTableStyles(){\n\t\tvar styles = {};\n\t\t\n\t\t//lookup row styles\n\t\tif(this.cloneTableStyle && window.getComputedStyle){\n\t\t\tstyles.oddRow = this.table.element.querySelector(\".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\t\tstyles.evenRow = this.table.element.querySelector(\".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\t\tstyles.calcRow = this.table.element.querySelector(\".tabulator-row.tabulator-calcs\");\n\t\t\tstyles.firstRow = this.table.element.querySelector(\".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\t\tstyles.firstGroup = this.table.element.getElementsByClassName(\"tabulator-group\")[0];\n\t\t\t\n\t\t\tif(styles.firstRow){\n\t\t\t\tstyles.styleCells = styles.firstRow.getElementsByClassName(\"tabulator-cell\");\n\t\t\t\tstyles.styleRowHeader = styles.firstRow.getElementsByClassName(\"tabulator-row-header\")[0];\n\t\t\t\tstyles.firstCell = styles.styleCells[0];\n\t\t\t\tstyles.lastCell = styles.styleCells[styles.styleCells.length - 1];\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn styles;\n\t}\n\t\n\tgenerateHeaderElement(row, setup, styles){\n\t\tvar rowEl = document.createElement(\"tr\");\n\t\t\n\t\trow.columns.forEach((column) => {\n\t\t\tif(column){\n\t\t\t\tvar cellEl = document.createElement(\"th\");\n\t\t\t\tvar classNames = column.component._column.definition.cssClass ? column.component._column.definition.cssClass.split(\" \") : [];\n\t\t\t\t\n\t\t\t\tcellEl.colSpan = column.width;\n\t\t\t\tcellEl.rowSpan = column.height;\n\t\t\t\t\n\t\t\t\tcellEl.innerHTML = column.value;\n\t\t\t\t\n\t\t\t\tif(this.cloneTableStyle){\n\t\t\t\t\tcellEl.style.boxSizing = \"border-box\";\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tclassNames.forEach(function(className) {\n\t\t\t\t\tcellEl.classList.add(className);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.mapElementStyles(column.component.getElement(), cellEl, [\"text-align\", \"border-left\", \"border-right\", \"background-color\", \"color\", \"font-weight\", \"font-family\", \"font-size\"]);\n\t\t\t\tthis.mapElementStyles(column.component._column.contentElement, cellEl, [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\"]);\n\t\t\n\t\t\t\tif(column.component._column.visible){\n\t\t\t\t\tthis.mapElementStyles(column.component.getElement(), cellEl, [\"width\"]);\n\t\t\t\t}else {\n\t\t\t\t\tif(column.component._column.definition.width){\n\t\t\t\t\t\tcellEl.style.width = column.component._column.definition.width + \"px\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(column.component._column.parent && column.component._column.parent.isGroup){\n\t\t\t\t\tthis.mapElementStyles(column.component._column.parent.groupElement, cellEl, [\"border-top\"]);\n\t\t\t\t}else {\n\t\t\t\t\tthis.mapElementStyles(column.component.getElement(), cellEl, [\"border-top\"]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(column.component._column.isGroup){\n\t\t\t\t\tthis.mapElementStyles(column.component.getElement(), cellEl, [\"border-bottom\"]);\n\t\t\t\t}else {\n\t\t\t\t\tthis.mapElementStyles(this.table.columnManager.getElement(), cellEl, [\"border-bottom\"]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trowEl.appendChild(cellEl);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn rowEl;\n\t}\n\t\n\tgenerateGroupElement(row, setup, styles){\n\t\t\n\t\tvar rowEl = document.createElement(\"tr\"),\n\t\tcellEl = document.createElement(\"td\"),\n\t\tgroup = row.columns[0];\n\t\t\n\t\trowEl.classList.add(\"tabulator-print-table-row\");\n\t\t\n\t\tif(setup.groupHeader && setup.groupHeader[row.indent]){\n\t\t\tgroup.value = setup.groupHeader[row.indent](group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t\t}else {\n\t\t\tif(setup.groupHeader !== false){\n\t\t\t\tgroup.value = row.component._group.generator(group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t\t\t}\n\t\t}\n\t\t\n\t\tcellEl.colSpan = group.width;\n\t\tcellEl.innerHTML = group.value;\n\t\t\n\t\trowEl.classList.add(\"tabulator-print-table-group\");\n\t\trowEl.classList.add(\"tabulator-group-level-\" + row.indent);\n\t\t\n\t\tif(group.component.isVisible()){\n\t\t\trowEl.classList.add(\"tabulator-group-visible\");\n\t\t}\n\t\t\n\t\tthis.mapElementStyles(styles.firstGroup, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\t\tthis.mapElementStyles(styles.firstGroup, cellEl, [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\"]);\n\t\t\n\t\trowEl.appendChild(cellEl);\n\t\t\n\t\treturn rowEl;\n\t}\n\t\n\tgenerateCalcElement(row, setup, styles){\n\t\tvar rowEl = this.generateRowElement(row, setup, styles);\n\t\t\n\t\trowEl.classList.add(\"tabulator-print-table-calcs\");\n\t\tthis.mapElementStyles(styles.calcRow, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\t\t\n\t\treturn rowEl;\n\t}\n\t\n\tgenerateRowElement(row, setup, styles){\n\t\tvar rowEl = document.createElement(\"tr\");\n\t\t\n\t\trowEl.classList.add(\"tabulator-print-table-row\");\n\t\t\n\t\trow.columns.forEach((col, i) => {\n\t\t\tif(col){\n\t\t\t\tvar cellEl = document.createElement(\"td\"),\n\t\t\t\tcolumn = col.component._column,\n\t\t\t\ttable =  this.table,\n\t\t\t\tindex = table.columnManager.findColumnIndex(column),\n\t\t\t\tvalue = col.value,\n\t\t\t\tcellStyle, styleProps;\n\t\t\t\t\n\t\t\t\tvar cellWrapper = {\n\t\t\t\t\tmodules:{},\n\t\t\t\t\tgetValue:function(){\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t},\n\t\t\t\t\tgetField:function(){\n\t\t\t\t\t\treturn column.definition.field;\n\t\t\t\t\t},\n\t\t\t\t\tgetElement:function(){\n\t\t\t\t\t\treturn cellEl;\n\t\t\t\t\t},\n\t\t\t\t\tgetType:function(){\n\t\t\t\t\t\treturn \"cell\";\n\t\t\t\t\t},\n\t\t\t\t\tgetColumn:function(){\n\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t},\n\t\t\t\t\tgetData:function(){\n\t\t\t\t\t\treturn row.component.getData();\n\t\t\t\t\t},\n\t\t\t\t\tgetRow:function(){\n\t\t\t\t\t\treturn row.component;\n\t\t\t\t\t},\n\t\t\t\t\tgetTable:function(){\n\t\t\t\t\t\treturn table;\n\t\t\t\t\t},\n\t\t\t\t\tgetComponent:function(){\n\t\t\t\t\t\treturn cellWrapper;\n\t\t\t\t\t},\n\t\t\t\t\tcolumn:column,\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tvar classNames = column.definition.cssClass ? column.definition.cssClass.split(\" \") : [];\n\t\t\t\t\n\t\t\t\tclassNames.forEach(function(className) {\n\t\t\t\t\tcellEl.classList.add(className);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(this.table.modExists(\"format\") && this.config.formatCells !== false){\n\t\t\t\t\tvalue = this.table.modules.format.formatExportValue(cellWrapper, this.colVisProp);\n\t\t\t\t}else {\n\t\t\t\t\tswitch(typeof value){\n\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\tvalue = value !== null ? JSON.stringify(value) : \"\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\tvalue = \"\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(value instanceof Node){\n\t\t\t\t\tcellEl.appendChild(value);\n\t\t\t\t}else {\n\t\t\t\t\tcellEl.innerHTML = value;\n\t\t\t\t}\n\n\t\t\t\tstyleProps = [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\", \"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"text-align\"];\n\n\t\t\t\tif(column.isRowHeader){\n\t\t\t\t\tcellStyle = styles.styleRowHeader;\n\t\t\t\t\tstyleProps.push(\"background-color\");\n\t\t\t\t}else {\n\t\t\t\t\tcellStyle = styles.styleCells && styles.styleCells[index] ? styles.styleCells[index] : styles.firstCell;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(cellStyle){\n\t\t\t\t\tthis.mapElementStyles(cellStyle, cellEl, styleProps);\n\t\t\t\t\t\n\t\t\t\t\tif(column.definition.align){\n\t\t\t\t\t\tcellEl.style.textAlign = column.definition.align;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.table.options.dataTree && this.config.dataTree !== false){\n\t\t\t\t\tif((setup.treeElementField && setup.treeElementField == column.field) || (!setup.treeElementField && i == 0)){\n\t\t\t\t\t\tif(row.component._row.modules.dataTree.controlEl){\n\t\t\t\t\t\t\tcellEl.insertBefore(row.component._row.modules.dataTree.controlEl.cloneNode(true), cellEl.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(row.component._row.modules.dataTree.branchEl){\n\t\t\t\t\t\t\tcellEl.insertBefore(row.component._row.modules.dataTree.branchEl.cloneNode(true), cellEl.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trowEl.appendChild(cellEl);\n\t\t\t\t\n\t\t\t\tif(cellWrapper.modules.format && cellWrapper.modules.format.renderedCallback){\n\t\t\t\t\tcellWrapper.modules.format.renderedCallback();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(setup.rowFormatter && row.type === \"row\" && this.config.formatCells !== false){\n\t\t\tlet formatComponent = Object.assign(row.component);\n\n\t\t\tformatComponent.getElement = function(){return rowEl;};\n\n\t\t\tsetup.rowFormatter(row.component);\n\t\t}\n\t\t\n\t\treturn rowEl;\n\t}\n\t\n\tgenerateHTMLTable(list){\n\t\tvar holder = document.createElement(\"div\");\n\t\t\n\t\tholder.appendChild(this.generateTableElement(list));\n\t\t\n\t\treturn holder.innerHTML;\n\t}\n\t\n\tgetHtml(visible, style, config, colVisProp){\n\t\tvar list = this.generateExportList(config || this.table.options.htmlOutputConfig, style, visible, colVisProp || \"htmlOutput\");\n\t\t\n\t\treturn this.generateHTMLTable(list);\n\t}\n\t\n\tmapElementStyles(from, to, props){\n\t\tif(this.cloneTableStyle && from && to){\n\t\t\t\n\t\t\tvar lookup = {\n\t\t\t\t\"background-color\" : \"backgroundColor\",\n\t\t\t\t\"color\" : \"fontColor\",\n\t\t\t\t\"width\" : \"width\",\n\t\t\t\t\"font-weight\" : \"fontWeight\",\n\t\t\t\t\"font-family\" : \"fontFamily\",\n\t\t\t\t\"font-size\" : \"fontSize\",\n\t\t\t\t\"text-align\" : \"textAlign\",\n\t\t\t\t\"border-top\" : \"borderTop\",\n\t\t\t\t\"border-left\" : \"borderLeft\",\n\t\t\t\t\"border-right\" : \"borderRight\",\n\t\t\t\t\"border-bottom\" : \"borderBottom\",\n\t\t\t\t\"padding-top\" : \"paddingTop\",\n\t\t\t\t\"padding-left\" : \"paddingLeft\",\n\t\t\t\t\"padding-right\" : \"paddingRight\",\n\t\t\t\t\"padding-bottom\" : \"paddingBottom\",\n\t\t\t};\n\t\t\t\n\t\t\tif(window.getComputedStyle){\n\t\t\t\tvar fromStyle = window.getComputedStyle(from);\n\n\t\t\t\tprops.forEach(function(prop){\n\t\t\t\t\tif(!to.style[lookup[prop]]){\n\t\t\t\t\t\tto.style[lookup[prop]] = fromStyle.getPropertyValue(prop);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar defaultFilters = {\n\n\t//equal to\n\t\"=\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal == filterVal ? true : false;\n\t},\n\n\t//less than\n\t\"<\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal < filterVal ? true : false;\n\t},\n\n\t//less than or equal to\n\t\"<=\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal <= filterVal ? true : false;\n\t},\n\n\t//greater than\n\t\">\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal > filterVal ? true : false;\n\t},\n\n\t//greater than or equal to\n\t\">=\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal >= filterVal ? true : false;\n\t},\n\n\t//not equal to\n\t\"!=\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal != filterVal ? true : false;\n\t},\n\n\t\"regex\":function(filterVal, rowVal, rowData, filterParams){\n\n\t\tif(typeof filterVal == \"string\"){\n\t\t\tfilterVal = new RegExp(filterVal);\n\t\t}\n\n\t\treturn filterVal.test(rowVal);\n\t},\n\n\t//contains the string\n\t\"like\":function(filterVal, rowVal, rowData, filterParams){\n\t\tif(filterVal === null || typeof filterVal === \"undefined\"){\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t}else {\n\t\t\tif(typeof rowVal !== 'undefined' && rowVal !== null){\n\t\t\t\treturn String(rowVal).toLowerCase().indexOf(filterVal.toLowerCase()) > -1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//contains the keywords\n\t\"keywords\":function(filterVal, rowVal, rowData, filterParams){\n\t\tvar keywords = filterVal.toLowerCase().split(typeof filterParams.separator === \"undefined\" ? \" \" : filterParams.separator),\n\t\tvalue = String(rowVal === null || typeof rowVal === \"undefined\" ? \"\" : rowVal).toLowerCase(),\n\t\tmatches = [];\n\n\t\tkeywords.forEach((keyword) =>{\n\t\t\tif(value.includes(keyword)){\n\t\t\t\tmatches.push(true);\n\t\t\t}\n\t\t});\n\n\t\treturn filterParams.matchAll ? matches.length === keywords.length : !!matches.length;\n\t},\n\n\t//starts with the string\n\t\"starts\":function(filterVal, rowVal, rowData, filterParams){\n\t\tif(filterVal === null || typeof filterVal === \"undefined\"){\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t}else {\n\t\t\tif(typeof rowVal !== 'undefined' && rowVal !== null){\n\t\t\t\treturn String(rowVal).toLowerCase().startsWith(filterVal.toLowerCase());\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//ends with the string\n\t\"ends\":function(filterVal, rowVal, rowData, filterParams){\n\t\tif(filterVal === null || typeof filterVal === \"undefined\"){\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t}else {\n\t\t\tif(typeof rowVal !== 'undefined' && rowVal !== null){\n\t\t\t\treturn String(rowVal).toLowerCase().endsWith(filterVal.toLowerCase());\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//in array\n\t\"in\":function(filterVal, rowVal, rowData, filterParams){\n\t\tif(Array.isArray(filterVal)){\n\t\t\treturn filterVal.length ? filterVal.indexOf(rowVal) > -1 : true;\n\t\t}else {\n\t\t\tconsole.warn(\"Filter Error - filter value is not an array:\", filterVal);\n\t\t\treturn false;\n\t\t}\n\t},\n};\n\nclass Filter extends Module{\n\n\tstatic moduleName = \"filter\";\n\n\t//load defaults\n\tstatic filters = defaultFilters;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.filterList = []; //hold filter list\n\t\tthis.headerFilters = {}; //hold column filters\n\t\tthis.headerFilterColumns = []; //hold columns that use header filters\n\n\t\tthis.prevHeaderFilterChangeCheck = \"\";\n\t\tthis.prevHeaderFilterChangeCheck = \"{}\";\n\n\t\tthis.changed = false; //has filtering changed since last render\n\t\tthis.tableInitialized = false;\n\n\t\tthis.registerTableOption(\"filterMode\", \"local\"); //local or remote filtering\n\n\t\tthis.registerTableOption(\"initialFilter\", false); //initial filtering criteria\n\t\tthis.registerTableOption(\"initialHeaderFilter\", false); //initial header filtering criteria\n\t\tthis.registerTableOption(\"headerFilterLiveFilterDelay\", 300); //delay before updating column after user types in header filter\n\t\tthis.registerTableOption(\"placeholderHeaderFilter\", false); //placeholder when header filter is empty\n\n\t\tthis.registerColumnOption(\"headerFilter\");\n\t\tthis.registerColumnOption(\"headerFilterPlaceholder\");\n\t\tthis.registerColumnOption(\"headerFilterParams\");\n\t\tthis.registerColumnOption(\"headerFilterEmptyCheck\");\n\t\tthis.registerColumnOption(\"headerFilterFunc\");\n\t\tthis.registerColumnOption(\"headerFilterFuncParams\");\n\t\tthis.registerColumnOption(\"headerFilterLiveFilter\");\n\n\t\tthis.registerTableFunction(\"searchRows\", this.searchRows.bind(this));\n\t\tthis.registerTableFunction(\"searchData\", this.searchData.bind(this));\n\n\t\tthis.registerTableFunction(\"setFilter\", this.userSetFilter.bind(this));\n\t\tthis.registerTableFunction(\"refreshFilter\", this.userRefreshFilter.bind(this));\n\t\tthis.registerTableFunction(\"addFilter\", this.userAddFilter.bind(this));\n\t\tthis.registerTableFunction(\"getFilters\", this.getFilters.bind(this));\n\t\tthis.registerTableFunction(\"setHeaderFilterFocus\", this.userSetHeaderFilterFocus.bind(this));\n\t\tthis.registerTableFunction(\"getHeaderFilterValue\", this.userGetHeaderFilterValue.bind(this));\n\t\tthis.registerTableFunction(\"setHeaderFilterValue\", this.userSetHeaderFilterValue.bind(this));\n\t\tthis.registerTableFunction(\"getHeaderFilters\", this.getHeaderFilters.bind(this));\n\t\tthis.registerTableFunction(\"removeFilter\", this.userRemoveFilter.bind(this));\n\t\tthis.registerTableFunction(\"clearFilter\", this.userClearFilter.bind(this));\n\t\tthis.registerTableFunction(\"clearHeaderFilter\", this.userClearHeaderFilter.bind(this));\n\n\t\tthis.registerComponentFunction(\"column\", \"headerFilterFocus\", this.setHeaderFilterFocus.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"reloadHeaderFilter\", this.reloadHeaderFilter.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"getHeaderFilterValue\", this.getHeaderFilterValue.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"setHeaderFilterValue\", this.setHeaderFilterValue.bind(this));\n\t}\n\n\tinitialize(){\n\t\tthis.subscribe(\"column-init\", this.initializeColumnHeaderFilter.bind(this));\n\t\tthis.subscribe(\"column-width-fit-before\", this.hideHeaderFilterElements.bind(this));\n\t\tthis.subscribe(\"column-width-fit-after\", this.showHeaderFilterElements.bind(this));\n\t\tthis.subscribe(\"table-built\", this.tableBuilt.bind(this));\n\t\tthis.subscribe(\"placeholder\", this.generatePlaceholder.bind(this));\n\n\t\tif(this.table.options.filterMode === \"remote\"){\n\t\t\tthis.subscribe(\"data-params\", this.remoteFilterParams.bind(this));\n\t\t}\n\n\t\tthis.registerDataHandler(this.filter.bind(this), 10);\n\t}\n\n\ttableBuilt(){\n\t\tif(this.table.options.initialFilter){\n\t\t\tthis.setFilter(this.table.options.initialFilter);\n\t\t}\n\n\t\tif(this.table.options.initialHeaderFilter){\n\t\t\tthis.table.options.initialHeaderFilter.forEach((item) => {\n\n\t\t\t\tvar column = this.table.columnManager.findColumn(item.field);\n\n\t\t\t\tif(column){\n\t\t\t\t\tthis.setHeaderFilterValue(column, item.value);\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", item.field);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.tableInitialized = true;\n\t}\n\n\tremoteFilterParams(data, config, silent, params){\n\t\tparams.filter = this.getFilters(true, true);\n\t\treturn params;\n\t}\n\n\tgeneratePlaceholder(text){\n\t\tif(this.table.options.placeholderHeaderFilter && Object.keys(this.headerFilters).length){\n\t\t\treturn this.table.options.placeholderHeaderFilter;\n\t\t}\n\t}\n\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\n\t//set standard filters\n\tuserSetFilter(field, type, value, params){\n\t\tthis.setFilter(field, type, value, params);\n\t\tthis.refreshFilter();\n\t}\n\n\t//set standard filters\n\tuserRefreshFilter(){\n\t\tthis.refreshFilter();\n\t}\n\n\t//add filter to array\n\tuserAddFilter(field, type, value, params){\n\t\tthis.addFilter(field, type, value, params);\n\t\tthis.refreshFilter();\n\t}\n\n\tuserSetHeaderFilterFocus(field){\n\t\tvar column = this.table.columnManager.findColumn(field);\n\n\t\tif(column){\n\t\t\tthis.setHeaderFilterFocus(column);\n\t\t}else {\n\t\t\tconsole.warn(\"Column Filter Focus Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tuserGetHeaderFilterValue(field) {\n\t\tvar column = this.table.columnManager.findColumn(field);\n\n\t\tif(column){\n\t\t\treturn this.getHeaderFilterValue(column);\n\t\t}else {\n\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", field);\n\t\t}\n\t}\n\n\tuserSetHeaderFilterValue(field, value){\n\t\tvar column = this.table.columnManager.findColumn(field);\n\n\t\tif(column){\n\t\t\tthis.setHeaderFilterValue(column, value);\n\t\t}else {\n\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//remove filter from array\n\tuserRemoveFilter(field, type, value){\n\t\tthis.removeFilter(field, type, value);\n\t\tthis.refreshFilter();\n\t}\n\n\t//clear filters\n\tuserClearFilter(all){\n\t\tthis.clearFilter(all);\n\t\tthis.refreshFilter();\n\t}\n\n\t//clear header filters\n\tuserClearHeaderFilter(){\n\t\tthis.clearHeaderFilter();\n\t\tthis.refreshFilter();\n\t}\n\n\n\t//search for specific row components\n\tsearchRows(field, type, value){\n\t\treturn this.search(\"rows\", field, type, value);\n\t}\n\n\t//search for specific data\n\tsearchData(field, type, value){\n\t\treturn this.search(\"data\", field, type, value);\n\t}\n\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\n\tinitializeColumnHeaderFilter(column){\n\t\tvar def = column.definition;\n\n\t\tif(def.headerFilter){\n\t\t\tthis.initializeColumn(column);\n\t\t}\n\t}\n\n\t//initialize column header filter\n\tinitializeColumn(column, value){\n\t\tvar self = this,\n\t\tfield = column.getField();\n\n\t\t//handle successfully value change\n\t\tfunction success(value){\n\t\t\tvar filterType = (column.modules.filter.tagType == \"input\" && column.modules.filter.attrType == \"text\") || column.modules.filter.tagType == \"textarea\" ? \"partial\" : \"match\",\n\t\t\ttype = \"\",\n\t\t\tfilterChangeCheck = \"\",\n\t\t\tfilterFunc;\n\n\t\t\tif(typeof column.modules.filter.prevSuccess === \"undefined\" || column.modules.filter.prevSuccess !== value){\n\n\t\t\t\tcolumn.modules.filter.prevSuccess = value;\n\n\t\t\t\tif(!column.modules.filter.emptyFunc(value)){\n\t\t\t\t\tcolumn.modules.filter.value = value;\n\n\t\t\t\t\tswitch(typeof column.definition.headerFilterFunc){\n\t\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\t\tif(Filter.filters[column.definition.headerFilterFunc]){\n\t\t\t\t\t\t\t\ttype = column.definition.headerFilterFunc;\n\t\t\t\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\t\t\t\tvar params = column.definition.headerFilterFuncParams || {};\n\t\t\t\t\t\t\t\t\tvar fieldVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\t\t\tparams = typeof params === \"function\" ? params(value, fieldVal, data) : params;\n\n\t\t\t\t\t\t\t\t\treturn Filter.filters[column.definition.headerFilterFunc](value, fieldVal, data, params);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tconsole.warn(\"Header Filter Error - Matching filter function not found: \", column.definition.headerFilterFunc);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\t\t\tvar params = column.definition.headerFilterFuncParams || {};\n\t\t\t\t\t\t\t\tvar fieldVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\t\tparams = typeof params === \"function\" ? params(value, fieldVal, data) : params;\n\n\t\t\t\t\t\t\t\treturn column.definition.headerFilterFunc(value, fieldVal, data, params);\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\ttype = filterFunc;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(!filterFunc){\n\t\t\t\t\t\tswitch(filterType){\n\t\t\t\t\t\t\tcase \"partial\":\n\t\t\t\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\t\t\t\tvar colVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\t\t\tif(typeof colVal !== 'undefined' && colVal !== null){\n\t\t\t\t\t\t\t\t\t\treturn String(colVal).toLowerCase().indexOf(String(value).toLowerCase()) > -1;\n\t\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\ttype = \"like\";\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\t\t\t\treturn column.getFieldValue(data) == value;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\ttype = \"=\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tself.headerFilters[field] = {value:value, func:filterFunc, type:type};\n\t\t\t\t}else {\n\t\t\t\t\tdelete self.headerFilters[field];\n\t\t\t\t}\n\n\t\t\t\tcolumn.modules.filter.value = value;\n\n\t\t\t\tfilterChangeCheck = JSON.stringify(self.headerFilters);\n\n\t\t\t\tif(self.prevHeaderFilterChangeCheck !== filterChangeCheck){\n\t\t\t\t\tself.prevHeaderFilterChangeCheck = filterChangeCheck;\n\n\t\t\t\t\tself.trackChanges();\n\t\t\t\t\tself.refreshFilter();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\tcolumn.modules.filter = {\n\t\t\tsuccess:success,\n\t\t\tattrType:false,\n\t\t\ttagType:false,\n\t\t\temptyFunc:false,\n\t\t};\n\n\t\tthis.generateHeaderFilterElement(column);\n\t}\n\n\tgenerateHeaderFilterElement(column, initialValue, reinitialize){\n\t\tvar self = this,\n\t\tsuccess = column.modules.filter.success,\n\t\tfield = column.getField(),\n\t\tfilterElement, editor, editorElement, cellWrapper, typingTimer, searchTrigger, params, onRenderedCallback;\n\n\t\tcolumn.modules.filter.value = initialValue;\n\n\t\t//handle aborted edit\n\t\tfunction cancel(){}\n\n\t\tfunction onRendered(callback){\n\t\t\tonRenderedCallback = callback;\n\t\t}\n\n\t\tif(column.modules.filter.headerElement && column.modules.filter.headerElement.parentNode){\n\t\t\tcolumn.contentElement.removeChild(column.modules.filter.headerElement.parentNode);\n\t\t}\n\n\t\tif(field){\n\n\t\t\t//set empty value function\n\t\t\tcolumn.modules.filter.emptyFunc = column.definition.headerFilterEmptyCheck || function(value){\n\t\t\t\treturn !value && value !== 0;\n\t\t\t};\n\n\t\t\tfilterElement = document.createElement(\"div\");\n\t\t\tfilterElement.classList.add(\"tabulator-header-filter\");\n\n\t\t\t//set column editor\n\t\t\tswitch(typeof column.definition.headerFilter){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tif(self.table.modules.edit.editors[column.definition.headerFilter]){\n\t\t\t\t\t\teditor = self.table.modules.edit.editors[column.definition.headerFilter];\n\n\t\t\t\t\t\tif((column.definition.headerFilter === \"tick\" || column.definition.headerFilter === \"tickCross\") && !column.definition.headerFilterEmptyCheck){\n\t\t\t\t\t\t\tcolumn.modules.filter.emptyFunc = function(value){\n\t\t\t\t\t\t\t\treturn value !== true && value !== false;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Filter Error - Cannot build header filter, No such editor found: \", column.definition.editor);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\teditor = column.definition.headerFilter;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tif(column.modules.edit && column.modules.edit.editor){\n\t\t\t\t\t\teditor = column.modules.edit.editor;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(column.definition.formatter && self.table.modules.edit.editors[column.definition.formatter]){\n\t\t\t\t\t\t\teditor = self.table.modules.edit.editors[column.definition.formatter];\n\n\t\t\t\t\t\t\tif((column.definition.formatter === \"tick\" || column.definition.formatter === \"tickCross\") && !column.definition.headerFilterEmptyCheck){\n\t\t\t\t\t\t\t\tcolumn.modules.filter.emptyFunc = function(value){\n\t\t\t\t\t\t\t\t\treturn value !== true && value !== false;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\teditor = self.table.modules.edit.editors[\"input\"];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif(editor){\n\n\t\t\t\tcellWrapper = {\n\t\t\t\t\tgetValue:function(){\n\t\t\t\t\t\treturn typeof initialValue !== \"undefined\" ? initialValue : \"\";\n\t\t\t\t\t},\n\t\t\t\t\tgetField:function(){\n\t\t\t\t\t\treturn column.definition.field;\n\t\t\t\t\t},\n\t\t\t\t\tgetElement:function(){\n\t\t\t\t\t\treturn filterElement;\n\t\t\t\t\t},\n\t\t\t\t\tgetColumn:function(){\n\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t},\n\t\t\t\t\tgetTable:() => {\n\t\t\t\t\t\treturn this.table;\n\t\t\t\t\t},\n\t\t\t\t\tgetType:() => {\n\t\t\t\t\t\treturn \"header\";\n\t\t\t\t\t},\n\t\t\t\t\tgetRow:function(){\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tnormalizeHeight:function(){\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tparams = column.definition.headerFilterParams || {};\n\n\t\t\t\tparams = typeof params === \"function\" ? params.call(self.table, cellWrapper) : params;\n\n\t\t\t\teditorElement = editor.call(this.table.modules.edit, cellWrapper, onRendered, success, cancel, params);\n\n\t\t\t\tif(!editorElement){\n\t\t\t\t\tconsole.warn(\"Filter Error - Cannot add filter to \" + field + \" column, editor returned a value of false\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!(editorElement instanceof Node)){\n\t\t\t\t\tconsole.warn(\"Filter Error - Cannot add filter to \" + field + \" column, editor should return an instance of Node, the editor returned:\", editorElement);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//set Placeholder Text\n\t\t\t\tself.langBind(\"headerFilters|columns|\" + column.definition.field, function(value){\n\t\t\t\t\teditorElement.setAttribute(\"placeholder\", typeof value !== \"undefined\" && value ? value : (column.definition.headerFilterPlaceholder || self.langText(\"headerFilters|default\")));\n\t\t\t\t});\n\n\t\t\t\t//focus on element on click\n\t\t\t\teditorElement.addEventListener(\"click\", function(e){\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\teditorElement.focus();\n\t\t\t\t});\n\n\t\t\t\teditorElement.addEventListener(\"focus\", (e) => {\n\t\t\t\t\tvar left = this.table.columnManager.contentsElement.scrollLeft;\n\n\t\t\t\t\tvar headerPos = this.table.rowManager.element.scrollLeft;\n\n\t\t\t\t\tif(left !== headerPos){\n\t\t\t\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\t\t\t\t\t\tthis.table.columnManager.scrollHorizontal(left);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t//live update filters as user types\n\t\t\t\ttypingTimer = false;\n\n\t\t\t\tsearchTrigger = function(e){\n\t\t\t\t\tif(typingTimer){\n\t\t\t\t\t\tclearTimeout(typingTimer);\n\t\t\t\t\t}\n\n\t\t\t\t\ttypingTimer = setTimeout(function(){\n\t\t\t\t\t\tsuccess(editorElement.value);\n\t\t\t\t\t},self.table.options.headerFilterLiveFilterDelay);\n\t\t\t\t};\n\n\t\t\t\tcolumn.modules.filter.headerElement = editorElement;\n\t\t\t\tcolumn.modules.filter.attrType = editorElement.hasAttribute(\"type\") ? editorElement.getAttribute(\"type\").toLowerCase() : \"\" ;\n\t\t\t\tcolumn.modules.filter.tagType = editorElement.tagName.toLowerCase();\n\n\t\t\t\tif(column.definition.headerFilterLiveFilter !== false){\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!(\n\t\t\t\t\t\t\tcolumn.definition.headerFilter === 'autocomplete' ||\n\t\t\t\t\t\t\tcolumn.definition.headerFilter === 'tickCross' ||\n\t\t\t\t\t\t\t((column.definition.editor === 'autocomplete' ||\n\t\t\t\t\t\t\t\tcolumn.definition.editor === 'tickCross') &&\n\t\t\t\t\t\t\tcolumn.definition.headerFilter === true)\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\teditorElement.addEventListener(\"keyup\", searchTrigger);\n\t\t\t\t\t\teditorElement.addEventListener(\"search\", searchTrigger);\n\n\n\t\t\t\t\t\t//update number filtered columns on change\n\t\t\t\t\t\tif(column.modules.filter.attrType == \"number\"){\n\t\t\t\t\t\t\teditorElement.addEventListener(\"change\", function(e){\n\t\t\t\t\t\t\t\tsuccess(editorElement.value);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//change text inputs to search inputs to allow for clearing of field\n\t\t\t\t\t\tif(column.modules.filter.attrType == \"text\" && this.table.browser !== \"ie\"){\n\t\t\t\t\t\t\teditorElement.setAttribute(\"type\", \"search\");\n\t\t\t\t\t\t// editorElement.off(\"change blur\"); //prevent blur from triggering filter and preventing selection click\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//prevent input and select elements from propagating click to column sorters etc\n\t\t\t\t\tif(column.modules.filter.tagType == \"input\" || column.modules.filter.tagType == \"select\" || column.modules.filter.tagType == \"textarea\"){\n\t\t\t\t\t\teditorElement.addEventListener(\"mousedown\",function(e){\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfilterElement.appendChild(editorElement);\n\n\t\t\t\tcolumn.contentElement.appendChild(filterElement);\n\n\t\t\t\tif(!reinitialize){\n\t\t\t\t\tself.headerFilterColumns.push(column);\n\t\t\t\t}\n\n\t\t\t\tif(onRenderedCallback){\n\t\t\t\t\tonRenderedCallback();\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Filter Error - Cannot add header filter, column has no field set:\", column.definition.title);\n\t\t}\n\t}\n\n\t//hide all header filter elements (used to ensure correct column widths in \"fitData\" layout mode)\n\thideHeaderFilterElements(){\n\t\tthis.headerFilterColumns.forEach(function(column){\n\t\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\t\tcolumn.modules.filter.headerElement.style.display = 'none';\n\t\t\t}\n\t\t});\n\t}\n\n\t//show all header filter elements (used to ensure correct column widths in \"fitData\" layout mode)\n\tshowHeaderFilterElements(){\n\t\tthis.headerFilterColumns.forEach(function(column){\n\t\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\t\tcolumn.modules.filter.headerElement.style.display = '';\n\t\t\t}\n\t\t});\n\t}\n\n\t//programmatically set focus of header filter\n\tsetHeaderFilterFocus(column){\n\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\tcolumn.modules.filter.headerElement.focus();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Filter Focus Error - No header filter set on column:\", column.getField());\n\t\t}\n\t}\n\n\t//programmatically get value of header filter\n\tgetHeaderFilterValue(column){\n\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\treturn column.modules.filter.value;\n\t\t} else {\n\t\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t\t}\n\t}\n\n\t//programmatically set value of header filter\n\tsetHeaderFilterValue(column, value){\n\t\tif (column){\n\t\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\t\tthis.generateHeaderFilterElement(column, value, true);\n\t\t\t\tcolumn.modules.filter.success(value);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t\t\t}\n\t\t}\n\t}\n\n\treloadHeaderFilter(column){\n\t\tif (column){\n\t\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\t\tthis.generateHeaderFilterElement(column, column.modules.filter.value, true);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t\t\t}\n\t\t}\n\t}\n\n\trefreshFilter(){\n\t\tif(this.tableInitialized){\n\t\t\tif(this.table.options.filterMode === \"remote\"){\n\t\t\t\tthis.reloadData(null, false, false);\n\t\t\t}else {\n\t\t\t\tthis.refreshData(true);\n\t\t\t}\n\t\t}\n\n\t\t//TODO - Persist left position of row manager\n\t\t// left = this.scrollLeft;\n\t\t// this.scrollHorizontal(left);\n\t}\n\n\t//check if the filters has changed since last use\n\ttrackChanges(){\n\t\tthis.changed = true;\n\t\tthis.dispatch(\"filter-changed\");\n\t}\n\n\t//check if the filters has changed since last use\n\thasChanged(){\n\t\tvar changed = this.changed;\n\t\tthis.changed = false;\n\t\treturn changed;\n\t}\n\n\t//set standard filters\n\tsetFilter(field, type, value, params){\n\t\tthis.filterList = [];\n\n\t\tif(!Array.isArray(field)){\n\t\t\tfield = [{field:field, type:type, value:value, params:params}];\n\t\t}\n\n\t\tthis.addFilter(field);\n\t}\n\n\t//add filter to array\n\taddFilter(field, type, value, params){\n\t\tvar changed = false;\n\n\t\tif(!Array.isArray(field)){\n\t\t\tfield = [{field:field, type:type, value:value, params:params}];\n\t\t}\n\n\t\tfield.forEach((filter) => {\n\t\t\tfilter = this.findFilter(filter);\n\n\t\t\tif(filter){\n\t\t\t\tthis.filterList.push(filter);\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\n\t\tif(changed){\n\t\t\tthis.trackChanges();\n\t\t}\n\t}\n\n\tfindFilter(filter){\n\t\tvar column;\n\n\t\tif(Array.isArray(filter)){\n\t\t\treturn this.findSubFilters(filter);\n\t\t}\n\n\t\tvar filterFunc = false;\n\n\t\tif(typeof filter.field == \"function\"){\n\t\t\tfilterFunc = function(data){\n\t\t\t\treturn filter.field(data, filter.type || {});// pass params to custom filter function\n\t\t\t};\n\t\t}else {\n\n\t\t\tif(Filter.filters[filter.type]){\n\n\t\t\t\tcolumn = this.table.columnManager.getColumnByField(filter.field);\n\n\t\t\t\tif(column){\n\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\treturn Filter.filters[filter.type](filter.value, column.getFieldValue(data), data, filter.params || {});\n\t\t\t\t\t};\n\t\t\t\t}else {\n\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\treturn Filter.filters[filter.type](filter.value, data[filter.field], data, filter.params || {});\n\t\t\t\t\t};\n\t\t\t\t}\n\n\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Filter Error - No such filter type found, ignoring: \", filter.type);\n\t\t\t}\n\t\t}\n\n\t\tfilter.func = filterFunc;\n\n\t\treturn filter.func ? filter : false;\n\t}\n\n\tfindSubFilters(filters){\n\t\tvar output = [];\n\n\t\tfilters.forEach((filter) => {\n\t\t\tfilter = this.findFilter(filter);\n\n\t\t\tif(filter){\n\t\t\t\toutput.push(filter);\n\t\t\t}\n\t\t});\n\n\t\treturn output.length ? output : false;\n\t}\n\n\t//get all filters\n\tgetFilters(all, ajax){\n\t\tvar output = [];\n\n\t\tif(all){\n\t\t\toutput = this.getHeaderFilters();\n\t\t}\n\n\t\tif(ajax){\n\t\t\toutput.forEach(function(item){\n\t\t\t\tif(typeof item.type == \"function\"){\n\t\t\t\t\titem.type = \"function\";\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\toutput = output.concat(this.filtersToArray(this.filterList, ajax));\n\n\t\treturn output;\n\t}\n\n\t//filter to Object\n\tfiltersToArray(filterList, ajax){\n\t\tvar output = [];\n\n\t\tfilterList.forEach((filter) => {\n\t\t\tvar item;\n\n\t\t\tif(Array.isArray(filter)){\n\t\t\t\toutput.push(this.filtersToArray(filter, ajax));\n\t\t\t}else {\n\t\t\t\titem = {field:filter.field, type:filter.type, value:filter.value};\n\n\t\t\t\tif(ajax){\n\t\t\t\t\tif(typeof item.type == \"function\"){\n\t\t\t\t\t\titem.type = \"function\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toutput.push(item);\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\t//get all filters\n\tgetHeaderFilters(){\n\t\tvar output = [];\n\n\t\tfor(var key in this.headerFilters){\n\t\t\toutput.push({field:key, type:this.headerFilters[key].type, value:this.headerFilters[key].value});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\t//remove filter from array\n\tremoveFilter(field, type, value){\n\t\tif(!Array.isArray(field)){\n\t\t\tfield = [{field:field, type:type, value:value}];\n\t\t}\n\n\t\tfield.forEach((filter) => {\n\t\t\tvar index = -1;\n\n\t\t\tif(typeof filter.field == \"object\"){\n\t\t\t\tindex = this.filterList.findIndex((element) => {\n\t\t\t\t\treturn filter === element;\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tindex = this.filterList.findIndex((element) => {\n\t\t\t\t\treturn filter.field === element.field && filter.type === element.type  && filter.value === element.value;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif(index > -1){\n\t\t\t\tthis.filterList.splice(index, 1);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Filter Error - No matching filter type found, ignoring: \", filter.type);\n\t\t\t}\n\t\t});\n\n\t\tthis.trackChanges();\n\t}\n\n\t//clear filters\n\tclearFilter(all){\n\t\tthis.filterList = [];\n\n\t\tif(all){\n\t\t\tthis.clearHeaderFilter();\n\t\t}\n\n\t\tthis.trackChanges();\n\t}\n\n\t//clear header filters\n\tclearHeaderFilter(){\n\t\tthis.headerFilters = {};\n\t\tthis.prevHeaderFilterChangeCheck = \"{}\";\n\n\t\tthis.headerFilterColumns.forEach((column) => {\n\t\t\tif(typeof column.modules.filter.value !== \"undefined\"){\n\t\t\t\tdelete column.modules.filter.value;\n\t\t\t}\n\t\t\tcolumn.modules.filter.prevSuccess = undefined;\n\t\t\tthis.reloadHeaderFilter(column);\n\t\t});\n\n\t\tthis.trackChanges();\n\t}\n\n\t//search data and return matching rows\n\tsearch (searchType, field, type, value){\n\t\tvar activeRows = [],\n\t\tfilterList = [];\n\n\t\tif(!Array.isArray(field)){\n\t\t\tfield = [{field:field, type:type, value:value}];\n\t\t}\n\n\t\tfield.forEach((filter) => {\n\t\t\tfilter = this.findFilter(filter);\n\n\t\t\tif(filter){\n\t\t\t\tfilterList.push(filter);\n\t\t\t}\n\t\t});\n\n\t\tthis.table.rowManager.rows.forEach((row) => {\n\t\t\tvar match = true;\n\n\t\t\tfilterList.forEach((filter) => {\n\t\t\t\tif(!this.filterRecurse(filter, row.getData())){\n\t\t\t\t\tmatch = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(match){\n\t\t\t\tactiveRows.push(searchType === \"data\" ? row.getData(\"data\") : row.getComponent());\n\t\t\t}\n\n\t\t});\n\n\t\treturn activeRows;\n\t}\n\n\t//filter row array\n\tfilter(rowList, filters){\n\t\tvar activeRows = [],\n\t\tactiveRowComponents = [];\n\n\t\tif(this.subscribedExternal(\"dataFiltering\")){\n\t\t\tthis.dispatchExternal(\"dataFiltering\", this.getFilters(true));\n\t\t}\n\n\t\tif(this.table.options.filterMode !== \"remote\" && (this.filterList.length || Object.keys(this.headerFilters).length)){\n\n\t\t\trowList.forEach((row) => {\n\t\t\t\tif(this.filterRow(row)){\n\t\t\t\t\tactiveRows.push(row);\n\t\t\t\t}\n\t\t\t});\n\n\t\t}else {\n\t\t\tactiveRows = rowList.slice(0);\n\t\t}\n\n\t\tif(this.subscribedExternal(\"dataFiltered\")){\n\n\t\t\tactiveRows.forEach((row) => {\n\t\t\t\tactiveRowComponents.push(row.getComponent());\n\t\t\t});\n\n\t\t\tthis.dispatchExternal(\"dataFiltered\", this.getFilters(true), activeRowComponents);\n\t\t}\n\n\t\treturn activeRows;\n\t}\n\n\t//filter individual row\n\tfilterRow(row, filters){\n\t\tvar match = true,\n\t\tdata = row.getData();\n\n\t\tthis.filterList.forEach((filter) => {\n\t\t\tif(!this.filterRecurse(filter, data)){\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t});\n\n\n\t\tfor(var field in this.headerFilters){\n\t\t\tif(!this.headerFilters[field].func(data)){\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t}\n\n\t\treturn match;\n\t}\n\n\tfilterRecurse(filter, data){\n\t\tvar match = false;\n\n\t\tif(Array.isArray(filter)){\n\t\t\tfilter.forEach((subFilter) => {\n\t\t\t\tif(this.filterRecurse(subFilter, data)){\n\t\t\t\t\tmatch = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\tmatch = filter.func(data);\n\t\t}\n\n\t\treturn match;\n\t}\n}\n\nfunction plaintext(cell, formatterParams, onRendered){\n\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n}\n\nfunction html(cell, formatterParams, onRendered){\n\treturn cell.getValue();\n}\n\nfunction textarea(cell, formatterParams, onRendered){\n\tcell.getElement().style.whiteSpace = \"pre-wrap\";\n\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n}\n\nfunction money(cell, formatterParams, onRendered){\n\tvar floatVal = parseFloat(cell.getValue()),\n\tsign = \"\",\n\tnumber, integer, decimal, rgx, value;\n\n\tvar decimalSym = formatterParams.decimal || \".\";\n\tvar thousandSym = formatterParams.thousand || \",\";\n\tvar negativeSign = formatterParams.negativeSign || \"-\";\n\tvar symbol = formatterParams.symbol || \"\";\n\tvar after = !!formatterParams.symbolAfter;\n\tvar precision = typeof formatterParams.precision !== \"undefined\" ? formatterParams.precision : 2;\n\n\tif(isNaN(floatVal)){\n\t\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n\t}\n\n\tif(floatVal < 0){\n\t\tfloatVal = Math.abs(floatVal);\n\t\tsign = negativeSign;\n\t}\n\n\tnumber = precision !== false ? floatVal.toFixed(precision) : floatVal;\n\tnumber = String(number).split(\".\");\n\n\tinteger = number[0];\n\tdecimal = number.length > 1 ? decimalSym + number[1] : \"\";\n\n\tif (formatterParams.thousand !== false) {\n\t\trgx = /(\\d+)(\\d{3})/;\n\n\t\twhile (rgx.test(integer)){\n\t\t\tinteger = integer.replace(rgx, \"$1\" + thousandSym + \"$2\");\n\t\t}\n\t}\n\n\tvalue = integer + decimal;\n\t\n\tif(sign === true){\n\t\tvalue = \"(\" + value  + \")\";\n\t\treturn after ? value + symbol : symbol + value;\n\t}else {\n\t\treturn after ? sign + value + symbol : sign + symbol + value;\n\t}\n}\n\nfunction link(cell, formatterParams, onRendered){\n\tvar value = cell.getValue(),\n\turlPrefix = formatterParams.urlPrefix || \"\",\n\tdownload = formatterParams.download,\n\tlabel = value,\n\tel = document.createElement(\"a\"),\n\tdata;\n\n\tfunction labelTraverse(path, data){\n\t\tvar item = path.shift(),\n\t\tvalue = data[item];\n\t\t\n\t\tif(path.length && typeof value === \"object\"){\n\t\t\treturn labelTraverse(path, value);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tif(formatterParams.labelField){\n\t\tdata = cell.getData();\n\t\tlabel = labelTraverse(formatterParams.labelField.split(this.table.options.nestedFieldSeparator), data);\n\t}\n\n\tif(formatterParams.label){\n\t\tswitch(typeof formatterParams.label){\n\t\t\tcase \"string\":\n\t\t\t\tlabel = formatterParams.label;\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tlabel = formatterParams.label(cell);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(label){\n\t\tif(formatterParams.urlField){\n\t\t\tdata = cell.getData();\n\n\t\t\tvalue = Helpers.retrieveNestedData(this.table.options.nestedFieldSeparator, formatterParams.urlField, data);\n\t\t}\n\n\t\tif(formatterParams.url){\n\t\t\tswitch(typeof formatterParams.url){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tvalue = formatterParams.url;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\tvalue = formatterParams.url(cell);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tel.setAttribute(\"href\", urlPrefix + value);\n\n\t\tif(formatterParams.target){\n\t\t\tel.setAttribute(\"target\", formatterParams.target);\n\t\t}\n\n\t\tif(formatterParams.download){\n\n\t\t\tif(typeof download == \"function\"){\n\t\t\t\tdownload = download(cell);\n\t\t\t}else {\n\t\t\t\tdownload = download === true ? \"\" : download;\n\t\t\t}\n\n\t\t\tel.setAttribute(\"download\", download);\n\t\t}\n\n\t\tel.innerHTML = this.emptyToSpace(this.sanitizeHTML(label));\n\n\t\treturn el;\n\t}else {\n\t\treturn \"&nbsp;\";\n\t}\n}\n\nfunction image(cell, formatterParams, onRendered){\n\tvar el = document.createElement(\"img\"),\n\tsrc = cell.getValue();\n\n\tif(formatterParams.urlPrefix){\n\t\tsrc = formatterParams.urlPrefix + cell.getValue();\n\t}\n\n\tif(formatterParams.urlSuffix){\n\t\tsrc = src + formatterParams.urlSuffix;\n\t}\n\n\tel.setAttribute(\"src\", src);\n\n\tswitch(typeof formatterParams.height){\n\t\tcase \"number\":\n\t\t\tel.style.height = formatterParams.height + \"px\";\n\t\t\tbreak;\n\n\t\tcase \"string\":\n\t\t\tel.style.height = formatterParams.height;\n\t\t\tbreak;\n\t}\n\n\tswitch(typeof formatterParams.width){\n\t\tcase \"number\":\n\t\t\tel.style.width = formatterParams.width + \"px\";\n\t\t\tbreak;\n\n\t\tcase \"string\":\n\t\t\tel.style.width = formatterParams.width;\n\t\t\tbreak;\n\t}\n\n\tel.addEventListener(\"load\", function(){\n\t\tcell.getRow().normalizeHeight();\n\t});\n\n\treturn el;\n}\n\nfunction tickCross(cell, formatterParams, onRendered){\n\tvar value = cell.getValue(),\n\telement = cell.getElement(),\n\tempty = formatterParams.allowEmpty,\n\ttruthy = formatterParams.allowTruthy,\n\ttrueValueSet = Object.keys(formatterParams).includes(\"trueValue\"),\n\ttick = typeof formatterParams.tickElement !== \"undefined\" ? formatterParams.tickElement : '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#2DC214\" clip-rule=\"evenodd\" d=\"M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z\" fill-rule=\"evenodd\"/></svg>',\n\tcross = typeof formatterParams.crossElement !== \"undefined\" ? formatterParams.crossElement : '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\"  viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#CE1515\" d=\"M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z\"/></svg>';\n\n\tif((trueValueSet && value === formatterParams.trueValue) || (!trueValueSet && ((truthy && value) || (value === true || value === \"true\" || value === \"True\" || value === 1 || value === \"1\")))){\n\t\telement.setAttribute(\"aria-checked\", true);\n\t\treturn tick || \"\";\n\t}else {\n\t\tif(empty && (value === \"null\" || value === \"\" || value === null || typeof value === \"undefined\")){\n\t\t\telement.setAttribute(\"aria-checked\", \"mixed\");\n\t\t\treturn \"\";\n\t\t}else {\n\t\t\telement.setAttribute(\"aria-checked\", false);\n\t\t\treturn cross || \"\";\n\t\t}\n\t}\n}\n\nfunction datetime$1(cell, formatterParams, onRendered){\n\tvar DT = this.table.dependencyRegistry.lookup([\"luxon\", \"DateTime\"], \"DateTime\");\n\tvar inputFormat = formatterParams.inputFormat || \"yyyy-MM-dd HH:mm:ss\";\n\tvar\toutputFormat = formatterParams.outputFormat || \"dd/MM/yyyy HH:mm:ss\";\n\tvar\tinvalid = typeof formatterParams.invalidPlaceholder !== \"undefined\" ? formatterParams.invalidPlaceholder : \"\";\n\tvar value = cell.getValue();\n\n\tif(typeof DT != \"undefined\"){\n\t\tvar newDatetime;\n\n\t\tif(DT.isDateTime(value)){\n\t\t\tnewDatetime = value;\n\t\t}else if(inputFormat === \"iso\"){\n\t\t\tnewDatetime = DT.fromISO(String(value));\n\t\t}else {\n\t\t\tnewDatetime = DT.fromFormat(String(value), inputFormat);\n\t\t}\n\n\t\tif(newDatetime.isValid){\n\t\t\tif(formatterParams.timezone){\n\t\t\t\tnewDatetime = newDatetime.setZone(formatterParams.timezone);\n\t\t\t}\n\n\t\t\treturn newDatetime.toFormat(outputFormat);\n\t\t}else {\n\t\t\tif(invalid === true || !value){\n\t\t\t\treturn value;\n\t\t\t}else if(typeof invalid === \"function\"){\n\t\t\t\treturn invalid(value);\n\t\t\t}else {\n\t\t\t\treturn invalid;\n\t\t\t}\n\t\t}\n\t}else {\n\t\tconsole.error(\"Format Error - 'datetime' formatter is dependant on luxon.js\");\n\t}\n}\n\nfunction datetimediff (cell, formatterParams, onRendered) {\n\tvar DT = this.table.dependencyRegistry.lookup([\"luxon\", \"DateTime\"], \"DateTime\");\n\tvar inputFormat = formatterParams.inputFormat || \"yyyy-MM-dd HH:mm:ss\";\n\tvar invalid = typeof formatterParams.invalidPlaceholder !== \"undefined\" ? formatterParams.invalidPlaceholder : \"\";\n\tvar suffix = typeof formatterParams.suffix !== \"undefined\" ? formatterParams.suffix : false;\n\tvar unit = typeof formatterParams.unit !== \"undefined\" ? formatterParams.unit : \"days\";\n\tvar humanize = typeof formatterParams.humanize !== \"undefined\" ? formatterParams.humanize : false;\n\tvar date = typeof formatterParams.date !== \"undefined\" ? formatterParams.date : DT.now();\n\tvar value = cell.getValue();\n\n\tif(typeof DT != \"undefined\"){\n\t\tvar newDatetime;\n\n\t\tif(DT.isDateTime(value)){\n\t\t\tnewDatetime = value;\n\t\t}else if(inputFormat === \"iso\"){\n\t\t\tnewDatetime = DT.fromISO(String(value));\n\t\t}else {\n\t\t\tnewDatetime = DT.fromFormat(String(value), inputFormat);\n\t\t}\n\n\t\tif (newDatetime.isValid){\n\t\t\tif(humanize){\n\t\t\t\treturn newDatetime.diff(date, unit).toHuman()  + (suffix ? \" \" + suffix : \"\");\n\t\t\t}else {\n\t\t\t\treturn parseInt(newDatetime.diff(date, unit)[unit]) + (suffix ? \" \" + suffix : \"\");\n\t\t\t}\n\t\t} else {\n\n\t\t\tif (invalid === true) {\n\t\t\t\treturn value;\n\t\t\t} else if (typeof invalid === \"function\") {\n\t\t\t\treturn invalid(value);\n\t\t\t} else {\n\t\t\t\treturn invalid;\n\t\t\t}\n\t\t}\n\t}else {\n\t\tconsole.error(\"Format Error - 'datetimediff' formatter is dependant on luxon.js\");\n\t}\n}\n\nfunction lookup (cell, formatterParams, onRendered) {\n\tvar value = cell.getValue();\n\n\tif (typeof formatterParams[value] === \"undefined\") {\n\t\tconsole.warn('Missing display value for ' + value);\n\t\treturn value;\n\t}\n\n\treturn formatterParams[value];\n}\n\nfunction star(cell, formatterParams, onRendered){\n\tvar value = cell.getValue(),\n\telement = cell.getElement(),\n\tmaxStars = formatterParams && formatterParams.stars ? formatterParams.stars : 5,\n\tstars = document.createElement(\"span\"),\n\tstar = document.createElementNS('http://www.w3.org/2000/svg', \"svg\"),\n\tstarActive = '<polygon fill=\"#FFEA00\" stroke=\"#C1AB60\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>',\n\tstarInactive = '<polygon fill=\"#D2D2D2\" stroke=\"#686868\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\n\t//style stars holder\n\tstars.style.verticalAlign = \"middle\";\n\n\t//style star\n\tstar.setAttribute(\"width\", \"14\");\n\tstar.setAttribute(\"height\", \"14\");\n\tstar.setAttribute(\"viewBox\", \"0 0 512 512\");\n\tstar.setAttribute(\"xml:space\", \"preserve\");\n\tstar.style.padding = \"0 1px\";\n\n\tvalue = value && !isNaN(value) ? parseInt(value) : 0;\n\n\tvalue = Math.max(0, Math.min(value, maxStars));\n\n\tfor(var i=1;i<= maxStars;i++){\n\t\tvar nextStar = star.cloneNode(true);\n\t\tnextStar.innerHTML = i <= value ? starActive : starInactive;\n\n\t\tstars.appendChild(nextStar);\n\t}\n\n\telement.style.whiteSpace = \"nowrap\";\n\telement.style.overflow = \"hidden\";\n\telement.style.textOverflow = \"ellipsis\";\n\n\telement.setAttribute(\"aria-label\", value);\n\n\treturn stars;\n}\n\nfunction traffic(cell, formatterParams, onRendered){\n\tvar value = this.sanitizeHTML(cell.getValue()) || 0,\n\tel = document.createElement(\"span\"),\n\tmax = formatterParams && formatterParams.max ? formatterParams.max : 100,\n\tmin = formatterParams && formatterParams.min ? formatterParams.min : 0,\n\tcolors = formatterParams && typeof formatterParams.color !== \"undefined\" ? formatterParams.color : [\"red\", \"orange\", \"green\"],\n\tcolor = \"#666666\",\n\tpercent, percentValue;\n\n\tif(isNaN(value) || typeof cell.getValue() === \"undefined\"){\n\t\treturn;\n\t}\n\n\tel.classList.add(\"tabulator-traffic-light\");\n\n\t//make sure value is in range\n\tpercentValue = parseFloat(value) <= max ? parseFloat(value) : max;\n\tpercentValue = parseFloat(percentValue) >= min ? parseFloat(percentValue) : min;\n\n\t//workout percentage\n\tpercent = (max - min) / 100;\n\tpercentValue = Math.round((percentValue - min) / percent);\n\n\t//set color\n\tswitch(typeof colors){\n\t\tcase \"string\":\n\t\t\tcolor = colors;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tcolor = colors(value);\n\t\t\tbreak;\n\t\tcase \"object\":\n\t\t\tif(Array.isArray(colors)){\n\t\t\t\tvar unit = 100 / colors.length;\n\t\t\t\tvar index = Math.floor(percentValue / unit);\n\n\t\t\t\tindex = Math.min(index, colors.length - 1);\n\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\tcolor = colors[index];\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\n\tel.style.backgroundColor = color;\n\n\treturn el;\n}\n\nfunction progress(cell, formatterParams = {}, onRendered){ //progress bar\n\tvar value = this.sanitizeHTML(cell.getValue()) || 0,\n\telement = cell.getElement(),\n\tmax = formatterParams.max ? formatterParams.max : 100,\n\tmin = formatterParams.min ? formatterParams.min : 0,\n\tlegendAlign = formatterParams.legendAlign ? formatterParams.legendAlign : \"center\",\n\tpercent, percentValue, color, legend, legendColor;\n\n\t//make sure value is in range\n\tpercentValue = parseFloat(value) <= max ? parseFloat(value) : max;\n\tpercentValue = parseFloat(percentValue) >= min ? parseFloat(percentValue) : min;\n\n\t//workout percentage\n\tpercent = (max - min) / 100;\n\tpercentValue = Math.round((percentValue - min) / percent);\n\n\t//set bar color\n\tswitch(typeof formatterParams.color){\n\t\tcase \"string\":\n\t\t\tcolor = formatterParams.color;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tcolor = formatterParams.color(value);\n\t\t\tbreak;\n\t\tcase \"object\":\n\t\t\tif(Array.isArray(formatterParams.color)){\n\t\t\t\tlet unit = 100 / formatterParams.color.length;\n\t\t\t\tlet index = Math.floor(percentValue / unit);\n\n\t\t\t\tindex = Math.min(index, formatterParams.color.length - 1);\n\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\tcolor = formatterParams.color[index];\n\t\t\t\tbreak;\n\t\t\t}\n\t\tdefault:\n\t\t\tcolor = \"#2DC214\";\n\t}\n\n\t//generate legend\n\tswitch(typeof formatterParams.legend){\n\t\tcase \"string\":\n\t\t\tlegend = formatterParams.legend;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tlegend = formatterParams.legend(value);\n\t\t\tbreak;\n\t\tcase \"boolean\":\n\t\t\tlegend = value;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlegend = false;\n\t}\n\n\t//set legend color\n\tswitch(typeof formatterParams.legendColor){\n\t\tcase \"string\":\n\t\t\tlegendColor = formatterParams.legendColor;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tlegendColor = formatterParams.legendColor(value);\n\t\t\tbreak;\n\t\tcase \"object\":\n\t\t\tif(Array.isArray(formatterParams.legendColor)){\n\t\t\t\tlet unit = 100 / formatterParams.legendColor.length;\n\t\t\t\tlet index = Math.floor(percentValue / unit);\n\n\t\t\t\tindex = Math.min(index, formatterParams.legendColor.length - 1);\n\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\tlegendColor = formatterParams.legendColor[index];\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlegendColor = \"#000\";\n\t}\n\n\telement.style.minWidth = \"30px\";\n\telement.style.position = \"relative\";\n\n\telement.setAttribute(\"aria-label\", percentValue);\n\n\tvar barEl = document.createElement(\"div\");\n\tbarEl.style.display = \"inline-block\";\n\tbarEl.style.width = percentValue + \"%\";\n\tbarEl.style.backgroundColor = color;\n\tbarEl.style.height = \"100%\";\n\n\tbarEl.setAttribute('data-max', max);\n\tbarEl.setAttribute('data-min', min);\n\n\tvar barContainer = document.createElement(\"div\");\n\tbarContainer.style.position = \"relative\";\n\tbarContainer.style.width = \"100%\";\n\tbarContainer.style.height = \"100%\";\n\n\tif(legend){\n\t\tvar legendEl = document.createElement(\"div\");\n\t\tlegendEl.style.position = \"absolute\";\n\t\tlegendEl.style.top = 0;\n\t\tlegendEl.style.left = 0;\n\t\tlegendEl.style.textAlign = legendAlign;\n\t\tlegendEl.style.width = \"100%\";\n\t\tlegendEl.style.color = legendColor;\n\t\tlegendEl.innerHTML = legend;\n\t}\n\n\tonRendered(function(){\n\n\t\t//handle custom element needed if formatter is to be included in printed/downloaded output\n\t\tif(!(cell instanceof CellComponent)){\n\t\t\tvar holderEl = document.createElement(\"div\");\n\t\t\tholderEl.style.position = \"absolute\";\n\t\t\tholderEl.style.top = \"4px\";\n\t\t\tholderEl.style.bottom = \"4px\";\n\t\t\tholderEl.style.left = \"4px\";\n\t\t\tholderEl.style.right = \"4px\";\n\n\t\t\telement.appendChild(holderEl);\n\n\t\t\telement = holderEl;\n\t\t}\n\n\t\telement.appendChild(barContainer);\n\t\tbarContainer.appendChild(barEl);\n\n\t\tif(legend){\n\t\t\tbarContainer.appendChild(legendEl);\n\t\t}\n\t});\n\n\treturn \"\";\n}\n\nfunction color(cell, formatterParams, onRendered){\n\tcell.getElement().style.backgroundColor = this.sanitizeHTML(cell.getValue());\n\treturn \"\";\n}\n\nfunction buttonTick(cell, formatterParams, onRendered){\n\treturn '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#2DC214\" clip-rule=\"evenodd\" d=\"M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z\" fill-rule=\"evenodd\"/></svg>';\n}\n\nfunction buttonCross(cell, formatterParams, onRendered){\n\treturn '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#CE1515\" d=\"M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z\"/></svg>';\n}\n\nfunction toggle(cell, formatterParams, onRendered){\r\n\tvar value = cell.getValue(),\r\n\tsize = formatterParams.size ||15,\r\n\tsizePx = size + \"px\",\r\n\tcontainEl, switchEl,\r\n\tonValue = formatterParams.hasOwnProperty(\"onValue\") ? formatterParams.onValue : true,\r\n\toffValue = formatterParams.hasOwnProperty(\"offValue\") ? formatterParams.offValue : false,\r\n\r\n\r\n\tstate = formatterParams.onTruthy ? value : value === onValue;\r\n\r\n\t\r\n\tcontainEl = document.createElement(\"div\");\r\n\tcontainEl.classList.add(\"tabulator-toggle\");\r\n\r\n\tif(state){\r\n\t\tcontainEl.classList.add(\"tabulator-toggle-on\");\r\n\t\tcontainEl.style.flexDirection = \"row-reverse\";\r\n\r\n\t\tif(formatterParams.onColor){\r\n\t\t\tcontainEl.style.background = formatterParams.onColor;\r\n\t\t}\r\n\t}else {\r\n\t\tif(formatterParams.offColor){\r\n\t\t\tcontainEl.style.background = formatterParams.offColor;\r\n\t\t}\r\n\t}\r\n\r\n\tcontainEl.style.width = (2.5 * size) + \"px\";\r\n\tcontainEl.style.borderRadius = sizePx;\r\n\r\n\tif(formatterParams.clickable){\r\n\t\tcontainEl.addEventListener(\"click\", (e) => {\r\n\t\t\tcell.setValue(state ? offValue : onValue);\r\n\t\t});\r\n\t}\r\n\r\n\tswitchEl = document.createElement(\"div\");\r\n\tswitchEl.classList.add(\"tabulator-toggle-switch\");\r\n\r\n\tswitchEl.style.height = sizePx;\r\n\tswitchEl.style.width = sizePx;\r\n\tswitchEl.style.borderRadius = sizePx;\r\n\t\r\n\tcontainEl.appendChild(switchEl);\r\n\t\r\n\treturn containEl;\r\n}\n\nfunction rownum(cell, formatterParams, onRendered){\n\tvar content = document.createElement(\"span\");\n\tvar row = cell.getRow();\n\tvar table = cell.getTable();\n\n\trow.watchPosition((position) => {\n\t\tif (formatterParams.relativeToPage) {\n\t\t\tposition += table.modules.page.getPageSize() * (table.modules.page.getPage() - 1);\n\t\t}\n\t\tcontent.innerText = position;\n\t});\n\t\n\treturn content;\n}\n\nfunction handle(cell, formatterParams, onRendered){\n\tcell.getElement().classList.add(\"tabulator-row-handle\");\n\treturn \"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>\";\n}\n\nfunction adaptable(cell, params, onRendered){\r\n\tvar lookup, formatterFunc, formatterParams;\r\n    \r\n\tfunction defaultLookup(cell){\r\n\t\tvar value = cell.getValue(),\r\n\t\tformatter = \"plaintext\";\r\n        \r\n\t\tswitch(typeof value){           \r\n\t\t\tcase \"boolean\":\r\n\t\t\t\tformatter = \"tickCross\";\r\n\t\t\t\tbreak;\r\n            \r\n\t\t\tcase \"string\":\r\n\t\t\t\tif(value.includes(\"\\n\")){\r\n\t\t\t\t\tformatter = \"textarea\";\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n        \r\n\t\treturn formatter;\r\n\t}\r\n    \r\n\tlookup = params.formatterLookup ? params.formatterLookup(cell) : defaultLookup(cell);\r\n\r\n\tif(params.paramsLookup){\r\n\t\tformatterParams = typeof params.paramsLookup === \"function\" ? params.paramsLookup(lookup, cell) : params.paramsLookup[lookup];\r\n\t}\r\n\r\n\tformatterFunc = this.table.modules.format.lookupFormatter(lookup);\r\n    \r\n\treturn  formatterFunc.call(this, cell, formatterParams || {}, onRendered);\r\n}\n\nfunction array$2(cell, formatterParams, onRendered){\n\tvar delimiter = formatterParams.delimiter || \",\",\n\tvalue = cell.getValue(),\n\ttable = this.table,\n\tvalueMap;\n\t\n\tif(formatterParams.valueMap){\n\t\tif(typeof formatterParams.valueMap === \"string\"){\n\t\t\tvalueMap = function(value){\n\t\t\t\treturn value.map((item) => {\n\t\t\t\t\treturn Helpers.retrieveNestedData(table.options.nestedFieldSeparator, formatterParams.valueMap, item);\n\t\t\t\t});\n\t\t\t};\n\t\t}else {\n\t\t\tvalueMap = formatterParams.valueMap;\n\t\t}\n\t}\n\n\tif(Array.isArray(value)){\n\t\tif(valueMap){\n\t\t\tvalue = valueMap(value);\n\t\t}\n\n\t\treturn value.join(delimiter);\n\t}else {\n\t\treturn value;\n\t}\n}\n\nfunction json$1(cell, formatterParams, onRendered){\n\tvar indent = formatterParams.indent || \"\\t\",\n\tmultiline = typeof formatterParams.multiline === \"undefined\" ? true : formatterParams.multiline,\n\treplacer = formatterParams.replacer || null,\n\tvalue = cell.getValue();\n\t\n\tif(multiline){\n\t\tcell.getElement().style.whiteSpace = \"pre-wrap\";\n\t}\n\n\treturn JSON.stringify(value, replacer, indent);\n}\n\nvar defaultFormatters = {\n\tplaintext:plaintext,\n\thtml:html,\n\ttextarea:textarea,\n\tmoney:money,\n\tlink:link,\n\timage:image,\n\ttickCross:tickCross,\n\tdatetime:datetime$1,\n\tdatetimediff:datetimediff,\n\tlookup:lookup,\n\tstar:star,\n\ttraffic:traffic,\n\tprogress:progress,\n\tcolor:color,\n\tbuttonTick:buttonTick,\n\tbuttonCross:buttonCross,\n\ttoggle:toggle,\n\trownum:rownum,\n\thandle:handle,\n\tadaptable:adaptable,\n\tarray:array$2,\n\tjson:json$1,\n};\n\nclass Format extends Module{\n\t\n\tstatic moduleName = \"format\";\n\t\n\t//load defaults\n\tstatic formatters = defaultFormatters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.registerColumnOption(\"formatter\");\n\t\tthis.registerColumnOption(\"formatterParams\");\n\t\t\n\t\tthis.registerColumnOption(\"formatterPrint\");\n\t\tthis.registerColumnOption(\"formatterPrintParams\");\n\t\tthis.registerColumnOption(\"formatterClipboard\");\n\t\tthis.registerColumnOption(\"formatterClipboardParams\");\n\t\tthis.registerColumnOption(\"formatterHtmlOutput\");\n\t\tthis.registerColumnOption(\"formatterHtmlOutputParams\");\n\t\tthis.registerColumnOption(\"titleFormatter\");\n\t\tthis.registerColumnOption(\"titleFormatterParams\");\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"cell-format\", this.formatValue.bind(this));\n\t\tthis.subscribe(\"cell-rendered\", this.cellRendered.bind(this));\n\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"column-format\", this.formatHeader.bind(this));\n\t}\n\t\n\t//initialize column formatter\n\tinitializeColumn(column){\n\t\tcolumn.modules.format = this.lookupTypeFormatter(column, \"\");\n\t\t\n\t\tif(typeof column.definition.formatterPrint !== \"undefined\"){\n\t\t\tcolumn.modules.format.print = this.lookupTypeFormatter(column, \"Print\");\n\t\t}\n\t\t\n\t\tif(typeof column.definition.formatterClipboard !== \"undefined\"){\n\t\t\tcolumn.modules.format.clipboard = this.lookupTypeFormatter(column, \"Clipboard\");\n\t\t}\n\t\t\n\t\tif(typeof column.definition.formatterHtmlOutput !== \"undefined\"){\n\t\t\tcolumn.modules.format.htmlOutput = this.lookupTypeFormatter(column, \"HtmlOutput\");\n\t\t}\n\t}\n\t\n\tlookupTypeFormatter(column, type){\n\t\tvar config = {params:column.definition[\"formatter\" + type + \"Params\"] || {}},\n\t\tformatter = column.definition[\"formatter\" + type];\n\t\t\n\t\tconfig.formatter = this.lookupFormatter(formatter);\n\t\t\n\t\treturn config;\n\t}\n\t\n\t\n\tlookupFormatter(formatter){\n\t\tvar formatterFunc;\n\n\t\t//set column formatter\n\t\tswitch(typeof formatter){\n\t\t\tcase \"string\":\n\t\t\t\tif(Format.formatters[formatter]){\n\t\t\t\t\tformatterFunc = Format.formatters[formatter];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Formatter Error - No such formatter found: \", formatter);\n\t\t\t\t\tformatterFunc = Format.formatters.plaintext;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"function\":\n\t\t\t\tformatterFunc = formatter;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tformatterFunc = Format.formatters.plaintext;\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\treturn formatterFunc;\n\t}\n\t\n\tcellRendered(cell){\n\t\tif(cell.modules.format && cell.modules.format.renderedCallback && !cell.modules.format.rendered){\n\t\t\tcell.modules.format.renderedCallback();\n\t\t\tcell.modules.format.rendered = true;\n\t\t}\n\t}\n\t\n\t//return a formatted value for a column header\n\tformatHeader(column, title, el){\n\t\tvar formatter, params, onRendered, mockCell;\n\t\t\n\t\tif(column.definition.titleFormatter){\n\t\t\tformatter = this.lookupFormatter(column.definition.titleFormatter);\n\t\t\t\n\t\t\tonRendered = (callback) => {\n\t\t\t\tcolumn.titleFormatterRendered = callback;\n\t\t\t};\n\t\t\t\n\t\t\tmockCell = {\n\t\t\t\tgetValue:function(){\n\t\t\t\t\treturn title;\n\t\t\t\t},\n\t\t\t\tgetElement:function(){\n\t\t\t\t\treturn el;\n\t\t\t\t},\n\t\t\t\tgetType:function(){\n\t\t\t\t\treturn \"header\";\n\t\t\t\t},\n\t\t\t\tgetColumn:function(){\n\t\t\t\t\treturn column.getComponent();\n\t\t\t\t},\n\t\t\t\tgetTable:() => {\n\t\t\t\t\treturn this.table;\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\tparams = column.definition.titleFormatterParams || {};\n\t\t\t\n\t\t\tparams = typeof params === \"function\" ? params() : params;\n\t\t\t\n\t\t\treturn formatter.call(this, mockCell, params, onRendered);\n\t\t}else {\n\t\t\treturn title;\n\t\t}\n\t}\n\t\n\t\n\t//return a formatted value for a cell\n\tformatValue(cell){\n\t\tvar component = cell.getComponent(),\n\t\tparams = typeof cell.column.modules.format.params === \"function\" ? cell.column.modules.format.params(component) : cell.column.modules.format.params;\n\t\t\n\t\tfunction onRendered(callback){\n\t\t\tif(!cell.modules.format){\n\t\t\t\tcell.modules.format = {};\n\t\t\t}\n\t\t\t\n\t\t\tcell.modules.format.renderedCallback = callback;\n\t\t\tcell.modules.format.rendered = false;\n\t\t}\n\t\t\n\t\treturn cell.column.modules.format.formatter.call(this, component, params, onRendered);\n\t}\n\t\n\tformatExportValue(cell, type){\n\t\tvar formatter = cell.column.modules.format[type],\n\t\tparams;\n\t\t\n\t\tif(formatter){\n\t\t\tparams = typeof formatter.params === \"function\" ? formatter.params(cell.getComponent()) : formatter.params;\n\t\t\t\n\t\t\tfunction onRendered(callback){\n\t\t\t\tif(!cell.modules.format){\n\t\t\t\t\tcell.modules.format = {};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcell.modules.format.renderedCallback = callback;\n\t\t\t\tcell.modules.format.rendered = false;\n\t\t\t}\n\t\t\t\n\t\t\treturn formatter.formatter.call(this, cell.getComponent(), params, onRendered);\n\t\t\t\n\t\t}else {\n\t\t\treturn this.formatValue(cell);\n\t\t}\n\t}\n\t\n\tsanitizeHTML(value){\n\t\tif(value){\n\t\t\tvar entityMap = {\n\t\t\t\t'&': '&amp;',\n\t\t\t\t'<': '&lt;',\n\t\t\t\t'>': '&gt;',\n\t\t\t\t'\"': '&quot;',\n\t\t\t\t\"'\": '&#39;',\n\t\t\t\t'/': '&#x2F;',\n\t\t\t\t'`': '&#x60;',\n\t\t\t\t'=': '&#x3D;'\n\t\t\t};\n\t\t\t\n\t\t\treturn String(value).replace(/[&<>\"'`=/]/g, function (s) {\n\t\t\t\treturn entityMap[s];\n\t\t\t});\n\t\t}else {\n\t\t\treturn value;\n\t\t}\n\t}\n\t\n\temptyToSpace(value){\n\t\treturn value === null || typeof value === \"undefined\" || value === \"\" ? \"&nbsp;\" : value;\n\t}\n\t\n}\n\nclass FrozenColumns extends Module{\n\n\tstatic moduleName = \"frozenColumns\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.leftColumns = [];\n\t\tthis.rightColumns = [];\n\t\tthis.initializationMode = \"left\";\n\t\tthis.active = false;\n\t\tthis.blocked = true;\n\t\t\n\t\tthis.registerColumnOption(\"frozen\");\n\t}\n\t\n\t//reset initial state\n\treset(){\n\t\tthis.initializationMode = \"left\";\n\t\tthis.leftColumns = [];\n\t\tthis.rightColumns = [];\n\t\tthis.active = false;\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"cell-layout\", this.layoutCell.bind(this));\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"column-width\", this.layout.bind(this));\n\t\tthis.subscribe(\"row-layout-after\", this.layoutRow.bind(this));\n\t\tthis.subscribe(\"table-layout\", this.layout.bind(this));\n\t\tthis.subscribe(\"columns-loading\", this.reset.bind(this));\n\t\t\n\t\tthis.subscribe(\"column-add\", this.reinitializeColumns.bind(this));\n\t\tthis.subscribe(\"column-deleted\", this.reinitializeColumns.bind(this));\n\t\tthis.subscribe(\"column-hide\", this.reinitializeColumns.bind(this));\n\t\tthis.subscribe(\"column-show\", this.reinitializeColumns.bind(this));\n\t\tthis.subscribe(\"columns-loaded\", this.reinitializeColumns.bind(this));\n\t\t\n\t\tthis.subscribe(\"table-redraw\", this.layout.bind(this));\n\t\tthis.subscribe(\"layout-refreshing\", this.blockLayout.bind(this));\n\t\tthis.subscribe(\"layout-refreshed\", this.unblockLayout.bind(this));\n\t\tthis.subscribe(\"scrollbar-vertical\", this.adjustForScrollbar.bind(this));\n\t}\n\t\n\tblockLayout(){\n\t\tthis.blocked = true;\n\t}\n\t\n\tunblockLayout(){\n\t\tthis.blocked = false;\n\t}\n\t\n\tlayoutCell(cell){\n\t\tthis.layoutElement(cell.element, cell.column);\n\t}\n\t\n\treinitializeColumns(){\n\t\tthis.reset();\n\t\t\n\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\tthis.initializeColumn(column);\n\t\t});\n\n\t\tthis.layout();\n\t}\n\t\n\t//initialize specific column\n\tinitializeColumn(column){\n\t\tvar config = {margin:0, edge:false};\n\t\t\n\t\tif(!column.isGroup){\t\t\t\n\t\t\tif(this.frozenCheck(column)){\n\t\t\t\tconfig.position = this.initializationMode;\n\t\t\t\t\n\t\t\t\tif(this.initializationMode == \"left\"){\n\t\t\t\t\tthis.leftColumns.push(column);\n\t\t\t\t}else {\n\t\t\t\t\tthis.rightColumns.unshift(column);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.active = true;\n\t\t\t\t\n\t\t\t\tcolumn.modules.frozen = config;\n\t\t\t}else {\n\t\t\t\tthis.initializationMode = \"right\";\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfrozenCheck(column){\n\t\tif(column.parent.isGroup && column.definition.frozen){\n\t\t\tconsole.warn(\"Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups\");\n\t\t}\n\t\t\n\t\tif(column.parent.isGroup){\n\t\t\treturn this.frozenCheck(column.parent);\n\t\t}else {\n\t\t\treturn column.definition.frozen;\n\t\t}\n\t}\n\t\n\t//layout calculation rows\n\tlayoutCalcRows(){\n\t\tif(this.table.modExists(\"columnCalcs\")){\n\t\t\tif(this.table.modules.columnCalcs.topInitialized && this.table.modules.columnCalcs.topRow){\n\t\t\t\tthis.layoutRow(this.table.modules.columnCalcs.topRow);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.modules.columnCalcs.botInitialized && this.table.modules.columnCalcs.botRow){\n\t\t\t\tthis.layoutRow(this.table.modules.columnCalcs.botRow);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.modExists(\"groupRows\")){\n\t\t\t\tthis.layoutGroupCalcs(this.table.modules.groupRows.getGroups());\n\t\t\t}\n\t\t}\n\t}\n\t\n\tlayoutGroupCalcs(groups){\n\t\tgroups.forEach((group) => {\n\t\t\tif(group.calcs.top){\n\t\t\t\tthis.layoutRow(group.calcs.top);\n\t\t\t}\n\t\t\t\n\t\t\tif(group.calcs.bottom){\n\t\t\t\tthis.layoutRow(group.calcs.bottom);\n\t\t\t}\n\t\t\t\n\t\t\tif(group.groupList && group.groupList.length){\n\t\t\t\tthis.layoutGroupCalcs(group.groupList);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//calculate column positions and layout headers\n\tlayoutColumnPosition(allCells){\n\t\tvar leftParents = [];\n\t\t\n\t\tvar leftMargin = 0;\n\t\tvar rightMargin = 0;\n\t\t\n\t\tthis.leftColumns.forEach((column, i) => {\t\n\t\t\tcolumn.modules.frozen.marginValue = leftMargin;\n\t\t\tcolumn.modules.frozen.margin = column.modules.frozen.marginValue + \"px\";\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\tleftMargin += column.getWidth();\n\t\t\t}\n\t\t\t\n\t\t\tif(i == this.leftColumns.length - 1){\n\t\t\t\tcolumn.modules.frozen.edge = true;\n\t\t\t}else {\n\t\t\t\tcolumn.modules.frozen.edge = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(column.parent.isGroup){\n\t\t\t\tvar parentEl = this.getColGroupParentElement(column);\n\t\t\t\tif(!leftParents.includes(parentEl)){\n\t\t\t\t\tthis.layoutElement(parentEl, column);\n\t\t\t\t\tleftParents.push(parentEl);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tparentEl.classList.toggle(\"tabulator-frozen-left\",  column.modules.frozen.edge && column.modules.frozen.position === \"left\");\n\t\t\t\tparentEl.classList.toggle(\"tabulator-frozen-right\", column.modules.frozen.edge && column.modules.frozen.position === \"right\");\n\t\t\t}else {\n\t\t\t\tthis.layoutElement(column.getElement(), column);\n\t\t\t}\n\t\t\t\n\t\t\tif(allCells){\n\t\t\t\tcolumn.cells.forEach((cell) => {\n\t\t\t\t\tthis.layoutElement(cell.getElement(true), column);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.rightColumns.forEach((column, i) => {\n\t\t\t\n\t\t\tcolumn.modules.frozen.marginValue = rightMargin;\n\t\t\tcolumn.modules.frozen.margin = column.modules.frozen.marginValue + \"px\";\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\trightMargin += column.getWidth();\n\t\t\t}\n\t\t\t\n\t\t\tif(i == this.rightColumns.length - 1){\n\t\t\t\tcolumn.modules.frozen.edge = true;\n\t\t\t}else {\n\t\t\t\tcolumn.modules.frozen.edge = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(column.parent.isGroup){\n\t\t\t\tthis.layoutElement(this.getColGroupParentElement(column), column);\n\t\t\t}else {\n\t\t\t\tthis.layoutElement(column.getElement(), column);\n\t\t\t}\n\t\t\t\n\t\t\tif(allCells){\n\t\t\t\tcolumn.cells.forEach((cell) => {\n\t\t\t\t\tthis.layoutElement(cell.getElement(true), column);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\t\n\tgetColGroupParentElement(column){\n\t\treturn column.parent.isGroup ? this.getColGroupParentElement(column.parent) : column.getElement();\n\t}\n\t\n\t//layout columns appropriately\n\tlayout(){\t\n\t\tif(this.active && !this.blocked){\n\t\t\t//calculate left columns\n\t\t\tthis.layoutColumnPosition();\n\t\t\t\n\t\t\tthis.reinitializeRows();\n\t\t\t\n\t\t\tthis.layoutCalcRows();\n\t\t}\n\t}\n\t\n\treinitializeRows(){\n\t\tvar visibleRows = this.table.rowManager.getVisibleRows(true);\n\t\tvar otherRows = this.table.rowManager.getRows().filter(row => !visibleRows.includes(row));\n\t\t\n\t\totherRows.forEach((row) =>{\n\t\t\trow.deinitialize();\n\t\t});\n\t\t\n\t\tvisibleRows.forEach((row) =>{\n\t\t\tif(row.type === \"row\"){\n\t\t\t\tthis.layoutRow(row);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tlayoutRow(row){\n\t\tif(this.table.options.layout === \"fitDataFill\" && this.rightColumns.length){\n\t\t\tthis.table.rowManager.getTableElement().style.minWidth = \"calc(100% - \" + this.rightMargin + \")\";\n\t\t}\n\t\t\n\t\tthis.leftColumns.forEach((column) => {\n\t\t\tvar cell = row.getCell(column);\n\t\t\t\n\t\t\tif(cell){\n\t\t\t\tthis.layoutElement(cell.getElement(true), column);\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.rightColumns.forEach((column) => {\n\t\t\tvar cell = row.getCell(column);\n\t\t\t\n\t\t\tif(cell){\n\t\t\t\tthis.layoutElement(cell.getElement(true), column);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tlayoutElement(element, column){\n\t\tvar position;\n\t\t\n\t\tif(column.modules.frozen && element){\n\t\t\telement.style.position = \"sticky\";\n\n\t\t\tif(this.table.rtl){\n\t\t\t\tposition = column.modules.frozen.position === \"left\" ? \"right\" : \"left\";\n\t\t\t}else {\n\t\t\t\tposition = column.modules.frozen.position;\n\t\t\t}\n\t\t\n\t\t\telement.style[position] = column.modules.frozen.margin;\n\n\t\t\telement.classList.add(\"tabulator-frozen\");\n\t\t\t\n\t\t\telement.classList.toggle(\"tabulator-frozen-left\",  column.modules.frozen.edge && column.modules.frozen.position === \"left\");\n\t\t\telement.classList.toggle(\"tabulator-frozen-right\", column.modules.frozen.edge && column.modules.frozen.position === \"right\");\n\t\t}\n\t}\n\n\tadjustForScrollbar(width){\n\t\tif(this.rightColumns.length){\n\t\t\tthis.table.columnManager.getContentsElement().style.width = \"calc(100% - \" + width + \"px)\";\n\t\t}\n\t}\n\n\tgetFrozenColumns(){\n\t\treturn this.leftColumns.concat(this.rightColumns);\n\t}\n\t\n\t_calcSpace(columns, index){\n\t\tvar width = 0;\n\t\t\n\t\tfor (let i = 0; i < index; i++){\n\t\t\tif(columns[i].visible){\n\t\t\t\twidth += columns[i].getWidth();\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn width;\n\t}\n}\n\nclass FrozenRows extends Module{\n\n\tstatic moduleName = \"frozenRows\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.topElement = document.createElement(\"div\");\n\t\tthis.rows = [];\n\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"freeze\", this.freezeRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"unfreeze\", this.unfreezeRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"isFrozen\", this.isRowFrozen.bind(this));\n\n\t\t//register table options\n\t\tthis.registerTableOption(\"frozenRowsField\", \"id\"); //field to choose frozen rows by\n\t\tthis.registerTableOption(\"frozenRows\", false); //holder for frozen row identifiers\n\t}\n\n\tinitialize(){\n\t\tvar\tfragment = document.createDocumentFragment();\n\t\t\n\t\tthis.rows = [];\n\n\t\tthis.topElement.classList.add(\"tabulator-frozen-rows-holder\");\n\t\t\n\t\tfragment.appendChild(document.createElement(\"br\"));\n\t\tfragment.appendChild(this.topElement);\n\n\t\t// this.table.columnManager.element.append(this.topElement);\n\t\tthis.table.columnManager.getContentsElement().insertBefore(fragment, this.table.columnManager.headersElement.nextSibling);\n\n\t\tthis.subscribe(\"row-deleting\", this.detachRow.bind(this));\n\t\tthis.subscribe(\"rows-visible\", this.visibleRows.bind(this));\n\n\t\tthis.registerDisplayHandler(this.getRows.bind(this), 10);\n\n\t\tif(this.table.options.frozenRows){\n\t\t\tthis.subscribe(\"data-processed\", this.initializeRows.bind(this));\n\t\t\tthis.subscribe(\"row-added\", this.initializeRow.bind(this));\n\t\t\tthis.subscribe(\"table-redrawing\", this.resizeHolderWidth.bind(this));\n\t\t\tthis.subscribe(\"column-resized\", this.resizeHolderWidth.bind(this));\n\t\t\tthis.subscribe(\"column-show\", this.resizeHolderWidth.bind(this));\n\t\t\tthis.subscribe(\"column-hide\", this.resizeHolderWidth.bind(this));\n\t\t}\n\n\t\tthis.resizeHolderWidth();\n\t}\n\n\tresizeHolderWidth(){\n\t\tthis.topElement.style.minWidth = this.table.columnManager.headersElement.offsetWidth + \"px\";\n\t}\n\n\tinitializeRows(){\n\t\tthis.table.rowManager.getRows().forEach((row) => {\n\t\t\tthis.initializeRow(row);\n\t\t});\n\t}\n\n\tinitializeRow(row){\n\t\tvar frozenRows = this.table.options.frozenRows,\n\t\trowType = typeof frozenRows;\n\n\t\tif(rowType === \"number\"){\n\t\t\tif(row.getPosition() && (row.getPosition() + this.rows.length) <= frozenRows){\n\t\t\t\tthis.freezeRow(row);\n\t\t\t}\n\t\t}else if(rowType === \"function\"){\n\t\t\tif(frozenRows.call(this.table, row.getComponent())){\n\t\t\t\tthis.freezeRow(row);\n\t\t\t}\n\t\t}else if(Array.isArray(frozenRows)){\n\t\t\tif(frozenRows.includes(row.data[this.options(\"frozenRowsField\")])){\n\t\t\t\tthis.freezeRow(row);\n\t\t\t}\n\t\t}\n\t}\n\n\tisRowFrozen(row){\n\t\tvar index = this.rows.indexOf(row);\n\t\treturn index > -1;\n\t}\n\n\tisFrozen(){\n\t\treturn !!this.rows.length;\n\t}\n\n\tvisibleRows(viewable, rows){\n\t\tthis.rows.forEach((row) => {\n\t\t\trows.push(row);\n\t\t});\n\n\t\treturn rows;\n\t}\n\n\t//filter frozen rows out of display data\n\tgetRows(rows){\n\t\tvar output = rows.slice(0);\n\n\t\tthis.rows.forEach(function(row){\n\t\t\tvar index = output.indexOf(row);\n\n\t\t\tif(index > -1){\n\t\t\t\toutput.splice(index, 1);\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\tfreezeRow(row){\n\t\tif(!row.modules.frozen){\n\t\t\trow.modules.frozen = true;\n\t\t\tthis.topElement.appendChild(row.getElement());\n\t\t\trow.initialize();\n\t\t\trow.normalizeHeight();\n\t\t\n\t\t\tthis.rows.push(row);\n\n\t\t\tthis.refreshData(false, \"display\");\n\n\t\t\tthis.table.rowManager.adjustTableSize();\n\n\t\t\tthis.styleRows();\n\n\t\t}else {\n\t\t\tconsole.warn(\"Freeze Error - Row is already frozen\");\n\t\t}\n\t}\n\n\tunfreezeRow(row){\n\t\tif(row.modules.frozen){\n\n\t\t\trow.modules.frozen = false;\n\n\t\t\tthis.detachRow(row);\n\n\t\t\tthis.table.rowManager.adjustTableSize();\n\n\t\t\tthis.refreshData(false, \"display\");\n\n\t\t\tif(this.rows.length){\n\t\t\t\tthis.styleRows();\n\t\t\t}\n\n\t\t}else {\n\t\t\tconsole.warn(\"Freeze Error - Row is already unfrozen\");\n\t\t}\n\t}\n\n\tdetachRow(row){\n\t\tvar index = this.rows.indexOf(row);\n\n\t\tif(index > -1){\n\t\t\tvar rowEl = row.getElement();\n\n\t\t\tif(rowEl.parentNode){\n\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t}\n\n\t\t\tthis.rows.splice(index, 1);\n\t\t}\n\t}\n\n\tstyleRows(row){\n\t\tthis.rows.forEach((row, i) => {\n\t\t\tthis.table.rowManager.styleRow(row, i);\n\t\t});\n\t}\n}\n\n//public group object\nclass GroupComponent {\n\tconstructor (group){\n\t\tthis._group = group;\n\t\tthis.type = \"GroupComponent\";\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._group.groupManager.table.componentFunctionBinder.handle(\"group\", target._group, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetKey(){\n\t\treturn this._group.key;\n\t}\n\n\tgetField(){\n\t\treturn this._group.field;\n\t}\n\n\tgetElement(){\n\t\treturn this._group.element;\n\t}\n\n\tgetRows(){\n\t\treturn this._group.getRows(true);\n\t}\n\n\tgetSubGroups(){\n\t\treturn this._group.getSubGroups(true);\n\t}\n\n\tgetParentGroup(){\n\t\treturn this._group.parent ? this._group.parent.getComponent() : false;\n\t}\n\n\tisVisible(){\n\t\treturn this._group.visible;\n\t}\n\n\tshow(){\n\t\tthis._group.show();\n\t}\n\n\thide(){\n\t\tthis._group.hide();\n\t}\n\n\ttoggle(){\n\t\tthis._group.toggleVisibility();\n\t}\n\n\tscrollTo(position, ifVisible){\n\t\treturn this._group.groupManager.table.rowManager.scrollToRow(this._group, position, ifVisible);\n\t}\n\n\t_getSelf(){\n\t\treturn this._group;\n\t}\n\n\tgetTable(){\n\t\treturn this._group.groupManager.table;\n\t}\n}\n\n//Group functions\nclass Group{\n\t\n\tconstructor(groupManager, parent, level, key, field, generator, oldGroup){\n\t\tthis.groupManager = groupManager;\n\t\tthis.parent = parent;\n\t\tthis.key = key;\n\t\tthis.level = level;\n\t\tthis.field = field;\n\t\tthis.hasSubGroups = level < (groupManager.groupIDLookups.length - 1);\n\t\tthis.addRow = this.hasSubGroups ? this._addRowToGroup : this._addRow;\n\t\tthis.type = \"group\"; //type of element\n\t\tthis.old = oldGroup;\n\t\tthis.rows = [];\n\t\tthis.groups = [];\n\t\tthis.groupList = [];\n\t\tthis.generator = generator;\n\t\tthis.element = false;\n\t\tthis.elementContents = false;\n\t\tthis.height = 0;\n\t\tthis.outerHeight = 0;\n\t\tthis.initialized = false;\n\t\tthis.calcs = {};\n\t\tthis.initialized = false;\n\t\tthis.modules = {};\n\t\tthis.arrowElement = false;\n\t\t\n\t\tthis.visible = oldGroup ? oldGroup.visible : (typeof groupManager.startOpen[level] !== \"undefined\" ? groupManager.startOpen[level] : groupManager.startOpen[0]);\n\t\t\n\t\tthis.component = null;\n\t\t\n\t\tthis.createElements();\n\t\tthis.addBindings();\n\t\t\n\t\tthis.createValueGroups();\n\t}\n\t\n\twipe(elementsOnly){\n\t\tif(!elementsOnly){\n\t\t\tif(this.groupList.length){\n\t\t\t\tthis.groupList.forEach(function(group){\n\t\t\t\t\tgroup.wipe();\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tthis.rows.forEach((row) => {\n\t\t\t\t\tif(row.modules){\n\t\t\t\t\t\tdelete row.modules.group;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.element = false;\n\t\tthis.arrowElement = false;\n\t\tthis.elementContents = false;\n\t}\n\t\n\tcreateElements(){\n\t\tvar arrow = document.createElement(\"div\");\n\t\tarrow.classList.add(\"tabulator-arrow\");\n\t\t\n\t\tthis.element = document.createElement(\"div\");\n\t\tthis.element.classList.add(\"tabulator-row\");\n\t\tthis.element.classList.add(\"tabulator-group\");\n\t\tthis.element.classList.add(\"tabulator-group-level-\" + this.level);\n\t\tthis.element.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\tthis.arrowElement = document.createElement(\"div\");\n\t\tthis.arrowElement.classList.add(\"tabulator-group-toggle\");\n\t\tthis.arrowElement.appendChild(arrow);\n\t\t\n\t\t//setup movable rows\n\t\tif(this.groupManager.table.options.movableRows !== false && this.groupManager.table.modExists(\"moveRow\")){\n\t\t\tthis.groupManager.table.modules.moveRow.initializeGroupHeader(this);\n\t\t}\n\t}\n\t\n\tcreateValueGroups(){\n\t\tvar level = this.level + 1;\n\t\tif(this.groupManager.allowedValues && this.groupManager.allowedValues[level]){\n\t\t\tthis.groupManager.allowedValues[level].forEach((value) => {\n\t\t\t\tthis._createGroup(value, level);\n\t\t\t});\n\t\t}\n\t}\n\t\n\taddBindings(){\n\t\tvar toggleElement;\n\t\t\n\t\tif(this.groupManager.table.options.groupToggleElement){\n\t\t\ttoggleElement = this.groupManager.table.options.groupToggleElement == \"arrow\" ? this.arrowElement : this.element;\n\t\t\t\n\t\t\ttoggleElement.addEventListener(\"click\", (e) => {\n\t\t\t\tif(this.groupManager.table.options.groupToggleElement === \"arrow\"){\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t}\n\n\t\t\t\t//allow click event to propagate before toggling visibility\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.toggleVisibility();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\t\n\t_createGroup(groupID, level){\n\t\tvar groupKey = level + \"_\" + groupID;\n\t\tvar group = new Group(this.groupManager, this, level, groupID,  this.groupManager.groupIDLookups[level].field, this.groupManager.headerGenerator[level] || this.groupManager.headerGenerator[0], this.old ? this.old.groups[groupKey] : false);\n\t\t\n\t\tthis.groups[groupKey] = group;\n\t\tthis.groupList.push(group);\n\t}\n\t\n\t_addRowToGroup(row){\n\t\t\n\t\tvar level = this.level + 1;\n\t\t\n\t\tif(this.hasSubGroups){\n\t\t\tvar groupID = this.groupManager.groupIDLookups[level].func(row.getData()),\n\t\t\tgroupKey = level + \"_\" + groupID;\n\t\t\t\n\t\t\tif(this.groupManager.allowedValues && this.groupManager.allowedValues[level]){\n\t\t\t\tif(this.groups[groupKey]){\n\t\t\t\t\tthis.groups[groupKey].addRow(row);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(!this.groups[groupKey]){\n\t\t\t\t\tthis._createGroup(groupID, level);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.groups[groupKey].addRow(row);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_addRow(row){\n\t\tthis.rows.push(row);\n\t\trow.modules.group = this;\n\t}\n\t\n\tinsertRow(row, to, after){\n\t\tvar data = this.conformRowData({});\n\t\t\n\t\trow.updateData(data);\n\t\t\n\t\tvar toIndex = this.rows.indexOf(to);\n\t\t\n\t\tif(toIndex > -1){\n\t\t\tif(after){\n\t\t\t\tthis.rows.splice(toIndex+1, 0, row);\n\t\t\t}else {\n\t\t\t\tthis.rows.splice(toIndex, 0, row);\n\t\t\t}\n\t\t}else {\n\t\t\tif(after){\n\t\t\t\tthis.rows.push(row);\n\t\t\t}else {\n\t\t\t\tthis.rows.unshift(row);\n\t\t\t}\n\t\t}\n\t\t\n\t\trow.modules.group = this;\n\t\t\n\t\t// this.generateGroupHeaderContents();\n\t\t\n\t\tif(this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.options.columnCalcs != \"table\"){\n\t\t\tthis.groupManager.table.modules.columnCalcs.recalcGroup(this);\n\t\t}\n\t\t\n\t\tthis.groupManager.updateGroupRows(true);\n\t}\n\t\n\tscrollHeader(left){\n\t\tif(this.arrowElement){\n\t\t\tthis.arrowElement.style.marginLeft = left;\n\t\t\t\n\t\t\tthis.groupList.forEach(function(child){\n\t\t\t\tchild.scrollHeader(left);\n\t\t\t});\n\t\t}\n\t}\n\t\n\tgetRowIndex(row){}\n\t\n\t//update row data to match grouping constraints\n\tconformRowData(data){\n\t\tif(this.field){\n\t\t\tdata[this.field] = this.key;\n\t\t}else {\n\t\t\tconsole.warn(\"Data Conforming Error - Cannot conform row data to match new group as groupBy is a function\");\n\t\t}\n\t\t\n\t\tif(this.parent){\n\t\t\tdata = this.parent.conformRowData(data);\n\t\t}\n\t\t\n\t\treturn data;\n\t}\n\t\n\tremoveRow(row){\n\t\tvar index = this.rows.indexOf(row);\n\t\tvar el = row.getElement();\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.rows.splice(index, 1);\n\t\t}\n\t\t\n\t\tif(!this.groupManager.table.options.groupValues && !this.rows.length){\n\t\t\tif(this.parent){\n\t\t\t\tthis.parent.removeGroup(this);\n\t\t\t}else {\n\t\t\t\tthis.groupManager.removeGroup(this);\n\t\t\t}\t\t\n\t\t\t\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t\t\n\t\t}else {\n\t\t\t\n\t\t\tif(el.parentNode){\n\t\t\t\tel.parentNode.removeChild(el);\n\t\t\t}\n\t\t\t\n\t\t\tif(!this.groupManager.blockRedraw){\n\t\t\t\tthis.generateGroupHeaderContents();\n\t\t\t\t\n\t\t\t\tif(this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.options.columnCalcs != \"table\"){\n\t\t\t\t\tthis.groupManager.table.modules.columnCalcs.recalcGroup(this);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\t\n\tremoveGroup(group){\n\t\tvar groupKey = group.level + \"_\" + group.key,\n\t\tindex;\n\t\t\n\t\tif(this.groups[groupKey]){\n\t\t\tdelete this.groups[groupKey];\n\t\t\t\n\t\t\tindex = this.groupList.indexOf(group);\n\t\t\t\n\t\t\tif(index > -1){\n\t\t\t\tthis.groupList.splice(index, 1);\n\t\t\t}\n\t\t\t\n\t\t\tif(!this.groupList.length){\n\t\t\t\tif(this.parent){\n\t\t\t\t\tthis.parent.removeGroup(this);\n\t\t\t\t}else {\n\t\t\t\t\tthis.groupManager.removeGroup(this);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tgetHeadersAndRows(){\n\t\tvar output = [];\n\t\t\n\t\toutput.push(this);\n\t\t\n\t\tthis._visSet();\n\t\t\n\t\t\n\t\tif(this.calcs.top){\n\t\t\tthis.calcs.top.detachElement();\n\t\t\tthis.calcs.top.deleteCells();\n\t\t}\n\t\t\n\t\tif(this.calcs.bottom){\n\t\t\tthis.calcs.bottom.detachElement();\n\t\t\tthis.calcs.bottom.deleteCells();\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\tif(this.visible){\n\t\t\tif(this.groupList.length){\n\t\t\t\tthis.groupList.forEach(function(group){\n\t\t\t\t\toutput = output.concat(group.getHeadersAndRows());\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tif(this.groupManager.table.options.columnCalcs != \"table\" && this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.modules.columnCalcs.hasTopCalcs()){\n\t\t\t\t\tthis.calcs.top = this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows);\n\t\t\t\t\toutput.push(this.calcs.top);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\toutput = output.concat(this.rows);\n\t\t\t\t\n\t\t\t\tif(this.groupManager.table.options.columnCalcs != \"table\" &&  this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.modules.columnCalcs.hasBottomCalcs()){\n\t\t\t\t\tthis.calcs.bottom = this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows);\n\t\t\t\t\toutput.push(this.calcs.bottom);\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tif(!this.groupList.length && this.groupManager.table.options.columnCalcs != \"table\"){\n\t\t\t\t\n\t\t\t\tif(this.groupManager.table.modExists(\"columnCalcs\")){\n\t\t\t\t\tif(this.groupManager.table.modules.columnCalcs.hasTopCalcs()){\n\t\t\t\t\t\tif(this.groupManager.table.options.groupClosedShowCalcs){\n\t\t\t\t\t\t\tthis.calcs.top = this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows);\n\t\t\t\t\t\t\toutput.push(this.calcs.top);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(this.groupManager.table.modules.columnCalcs.hasBottomCalcs()){\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.groupManager.table.options.groupClosedShowCalcs){\n\t\t\t\t\t\t\tthis.calcs.bottom = this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows);\n\t\t\t\t\t\t\toutput.push(this.calcs.bottom);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetData(visible, transform){\n\t\tvar output = [];\n\t\t\n\t\tthis._visSet();\n\t\t\n\t\tif(!visible || (visible && this.visible)){\n\t\t\tthis.rows.forEach((row) => {\n\t\t\t\toutput.push(row.getData(transform || \"data\"));\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetRowCount(){\n\t\tvar count = 0;\n\t\t\n\t\tif(this.groupList.length){\n\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\tcount += group.getRowCount();\n\t\t\t});\n\t\t}else {\n\t\t\tcount = this.rows.length;\n\t\t}\n\t\treturn count;\n\t}\n\n\t\n\ttoggleVisibility(){\n\t\tif(this.visible){\n\t\t\tthis.hide();\n\t\t}else {\n\t\t\tthis.show();\n\t\t}\n\t}\n\t\n\thide(){\n\t\tthis.visible = false;\n\t\t\n\t\tif(this.groupManager.table.rowManager.getRenderMode() == \"basic\" && !this.groupManager.table.options.pagination){\n\t\t\t\n\t\t\tthis.element.classList.remove(\"tabulator-group-visible\");\n\t\t\t\n\t\t\tif(this.groupList.length){\n\t\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\t\t\n\t\t\t\t\tvar rows = group.getHeadersAndRows();\n\t\t\t\t\t\n\t\t\t\t\trows.forEach((row) => {\n\t\t\t\t\t\trow.detachElement();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tthis.rows.forEach((row) => {\n\t\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t\t\n\t\t}else {\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t}\n\t\t\n\t\tthis.groupManager.table.externalEvents.dispatch(\"groupVisibilityChanged\", this.getComponent(), false);\n\t}\n\t\n\tshow(){\n\t\tthis.visible = true;\n\t\t\n\t\tif(this.groupManager.table.rowManager.getRenderMode() == \"basic\" && !this.groupManager.table.options.pagination){\n\t\t\t\n\t\t\tthis.element.classList.add(\"tabulator-group-visible\");\n\t\t\t\n\t\t\tvar prev = this.generateElement();\n\t\t\t\n\t\t\tif(this.groupList.length){\n\t\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\t\tvar rows = group.getHeadersAndRows();\n\t\t\t\t\t\n\t\t\t\t\trows.forEach((row) => {\n\t\t\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\t\t\tprev.parentNode.insertBefore(rowEl, prev.nextSibling);\n\t\t\t\t\t\trow.initialize();\n\t\t\t\t\t\tprev = rowEl;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tthis.rows.forEach((row) => {\n\t\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\t\tprev.parentNode.insertBefore(rowEl, prev.nextSibling);\n\t\t\t\t\trow.initialize();\n\t\t\t\t\tprev = rowEl;\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t}else {\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t}\n\t\t\n\t\tthis.groupManager.table.externalEvents.dispatch(\"groupVisibilityChanged\", this.getComponent(), true);\n\t}\n\t\n\t_visSet(){\n\t\tvar data = [];\n\t\t\n\t\tif(typeof this.visible == \"function\"){\n\t\t\t\n\t\t\tthis.rows.forEach(function(row){\n\t\t\t\tdata.push(row.getData());\n\t\t\t});\n\t\t\t\n\t\t\tthis.visible = this.visible(this.key, this.getRowCount(), data, this.getComponent());\n\t\t}\n\t}\n\t\n\tgetRowGroup(row){\n\t\tvar match = false;\n\t\tif(this.groupList.length){\n\t\t\tthis.groupList.forEach(function(group){\n\t\t\t\tvar result = group.getRowGroup(row);\n\t\t\t\t\n\t\t\t\tif(result){\n\t\t\t\t\tmatch = result;\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\tif(this.rows.find(function(item){\n\t\t\t\treturn item === row;\n\t\t\t})){\n\t\t\t\tmatch = this;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn match;\n\t}\n\t\n\tgetSubGroups(component){\n\t\tvar output = [];\n\t\t\n\t\tthis.groupList.forEach(function(child){\n\t\t\toutput.push(component ? child.getComponent() : child);\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetRows(component, includeChildren){\n\t\tvar output = [];\n\t\t\n\t\tif(includeChildren && this.groupList.length){\n\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\toutput = output.concat(group.getRows(component, includeChildren));\n\t\t\t});\n\t\t}else {\n\t\t\tthis.rows.forEach(function(row){\n\t\t\t\toutput.push(component ? row.getComponent() : row);\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgenerateGroupHeaderContents(){\n\t\tvar data = [];\n\t\t\n\t\tvar rows = this.getRows(false, true);\n\t\t\n\t\trows.forEach(function(row){\n\t\t\tdata.push(row.getData());\n\t\t});\n\t\t\n\t\tthis.elementContents = this.generator(this.key, this.getRowCount(), data, this.getComponent());\n\t\t\n\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\t\t\n\t\tif(typeof this.elementContents === \"string\"){\n\t\t\tthis.element.innerHTML = this.elementContents;\n\t\t}else {\n\t\t\tthis.element.appendChild(this.elementContents);\n\t\t}\n\t\t\n\t\tthis.element.insertBefore(this.arrowElement, this.element.firstChild);\n\t}\n\t\n\tgetPath(path = []) {\n\t\tpath.unshift(this.key);\n\t\tif(this.parent) {\n\t\t\tthis.parent.getPath(path);\n\t\t}\n\t\treturn path;\n\t}\n\t\n\t////////////// Standard Row Functions //////////////\n\t\n\tgetElement(){\n\t\treturn this.elementContents ? this.element : this.generateElement();\n\t}\n\t\n\tgenerateElement(){\n\t\tthis.addBindings = false;\n\t\t\n\t\tthis._visSet();\n\t\t\n\t\tif(this.visible){\n\t\t\tthis.element.classList.add(\"tabulator-group-visible\");\n\t\t}else {\n\t\t\tthis.element.classList.remove(\"tabulator-group-visible\");\n\t\t}\n\t\t\n\t\tfor(var i = 0; i < this.element.childNodes.length; ++i){\n\t\t\tthis.element.childNodes[i].parentNode.removeChild(this.element.childNodes[i]);\n\t\t}\n\t\t\n\t\tthis.generateGroupHeaderContents();\n\t\t\n\t\t// this.addBindings();\n\t\t\n\t\treturn this.element;\n\t}\n\t\n\tdetachElement(){\n\t\tif (this.element && this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n\t}\n\t\n\t//normalize the height of elements in the row\n\tnormalizeHeight(){\n\t\tthis.setHeight(this.element.clientHeight);\n\t}\n\t\n\tinitialize(force){\n\t\tif(!this.initialized || force){\n\t\t\tthis.normalizeHeight();\n\t\t\tthis.initialized = true;\n\t\t}\n\t}\n\t\n\treinitialize(){\n\t\tthis.initialized = false;\n\t\tthis.height = 0;\n\t\t\n\t\tif(Helpers.elVisible(this.element)){\n\t\t\tthis.initialize(true);\n\t\t}\n\t}\n\t\n\tsetHeight(height){\n\t\tif(this.height != height){\n\t\t\tthis.height = height;\n\t\t\tthis.outerHeight = this.element.offsetHeight;\n\t\t}\n\t}\n\t\n\t//return rows outer height\n\tgetHeight(){\n\t\treturn this.outerHeight;\n\t}\n\t\n\tgetGroup(){\n\t\treturn this;\n\t}\n\t\n\treinitializeHeight(){}\n\t\n\tcalcHeight(){}\n\t\n\tsetCellHeight(){}\n\t\n\tclearCellHeight(){}\n\t\n\tdeinitializeHeight(){}\n\n\trendered(){}\n\t\n\t//////////////// Object Generation /////////////////\n\tgetComponent(){\n\t\tif(!this.component){\n\t\t\tthis.component = new GroupComponent(this);\n\t\t}\n\t\t\n\t\treturn this.component;\n\t}\n}\n\nclass GroupRows extends Module{\n\n\tstatic moduleName = \"groupRows\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.groupIDLookups = false; //enable table grouping and set field to group by\n\t\tthis.startOpen = [function(){return false;}]; //starting state of group\n\t\tthis.headerGenerator = [function(){return \"\";}];\n\t\tthis.groupList = []; //ordered list of groups\n\t\tthis.allowedValues = false;\n\t\tthis.groups = {}; //hold row groups\n\t\t\n\t\tthis.displayHandler = this.getRows.bind(this);\n\n\t\tthis.blockRedraw = false;\n\t\t\n\t\t//register table options\n\t\tthis.registerTableOption(\"groupBy\", false); //enable table grouping and set field to group by\n\t\tthis.registerTableOption(\"groupStartOpen\", true); //starting state of group\n\t\tthis.registerTableOption(\"groupValues\", false);\n\t\tthis.registerTableOption(\"groupUpdateOnCellEdit\", false);\n\t\tthis.registerTableOption(\"groupHeader\", false); //header generation function\n\t\tthis.registerTableOption(\"groupHeaderPrint\", null);\n\t\tthis.registerTableOption(\"groupHeaderClipboard\", null);\n\t\tthis.registerTableOption(\"groupHeaderHtmlOutput\", null);\n\t\tthis.registerTableOption(\"groupHeaderDownload\", null);\n\t\tthis.registerTableOption(\"groupToggleElement\", \"arrow\");\n\t\tthis.registerTableOption(\"groupClosedShowCalcs\", false);\n\t\t\n\t\t//register table functions\n\t\tthis.registerTableFunction(\"setGroupBy\", this.setGroupBy.bind(this));\n\t\tthis.registerTableFunction(\"setGroupValues\", this.setGroupValues.bind(this));\n\t\tthis.registerTableFunction(\"setGroupStartOpen\", this.setGroupStartOpen.bind(this));\n\t\tthis.registerTableFunction(\"setGroupHeader\", this.setGroupHeader.bind(this));\n\t\tthis.registerTableFunction(\"getGroups\", this.userGetGroups.bind(this));\n\t\tthis.registerTableFunction(\"getGroupedData\", this.userGetGroupedData.bind(this));\n\t\t\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"getGroup\", this.rowGetGroup.bind(this));\n\t}\n\t\n\t//initialize group configuration\n\tinitialize(){\n\t\tthis.subscribe(\"table-destroy\", this._blockRedrawing.bind(this));\n\t\tthis.subscribe(\"rows-wipe\", this._blockRedrawing.bind(this));\n\t\tthis.subscribe(\"rows-wiped\", this._restore_redrawing.bind(this));\n\n\t\tif(this.table.options.groupBy){\n\t\t\tif(this.table.options.groupUpdateOnCellEdit){\n\t\t\t\tthis.subscribe(\"cell-value-updated\", this.cellUpdated.bind(this));\n\t\t\t\tthis.subscribe(\"row-data-changed\", this.reassignRowToGroup.bind(this), 0);\n\t\t\t}\n\t\t\t\n\t\t\tthis.subscribe(\"table-built\", this.configureGroupSetup.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"row-deleting\", this.rowDeleting.bind(this));\n\t\t\tthis.subscribe(\"row-deleted\", this.rowsUpdated.bind(this));\n\t\t\tthis.subscribe(\"scroll-horizontal\", this.scrollHeaders.bind(this));\n\t\t\tthis.subscribe(\"rows-wipe\", this.wipe.bind(this));\n\t\t\tthis.subscribe(\"rows-added\", this.rowsUpdated.bind(this));\n\t\t\tthis.subscribe(\"row-moving\", this.rowMoving.bind(this));\n\t\t\tthis.subscribe(\"row-adding-index\", this.rowAddingIndex.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"rows-sample\", this.rowSample.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"render-virtual-fill\", this.virtualRenderFill.bind(this));\n\t\t\t\n\t\t\tthis.registerDisplayHandler(this.displayHandler, 20);\n\t\t\t\n\t\t\tthis.initialized = true;\n\t\t}\n\t}\n\t\n\t_blockRedrawing(){\n\t\tthis.blockRedraw = true;\n\t}\n\n\t_restore_redrawing(){\n\t\tthis.blockRedraw = false;\n\t}\n\n\tconfigureGroupSetup(){\n\t\tif(this.table.options.groupBy){\n\t\t\tvar groupBy = this.table.options.groupBy,\n\t\t\tstartOpen = this.table.options.groupStartOpen,\n\t\t\tgroupHeader = this.table.options.groupHeader;\n\t\t\t\n\t\t\tthis.allowedValues = this.table.options.groupValues;\n\t\t\t\n\t\t\tif(Array.isArray(groupBy) && Array.isArray(groupHeader) && groupBy.length > groupHeader.length){\n\t\t\t\tconsole.warn(\"Error creating group headers, groupHeader array is shorter than groupBy array\");\n\t\t\t}\n\t\t\t\n\t\t\tthis.headerGenerator = [function(){return \"\";}];\n\t\t\tthis.startOpen = [function(){return false;}]; //starting state of group\n\t\t\t\n\t\t\tthis.langBind(\"groups|item\", (langValue, lang) => {\n\t\t\t\tthis.headerGenerator[0] = (value, count, data) => { //header layout function\n\t\t\t\t\treturn (typeof value === \"undefined\" ? \"\" : value) + \"<span>(\" + count + \" \" + ((count === 1) ? langValue : lang.groups.items) + \")</span>\";\n\t\t\t\t};\n\t\t\t});\n\t\t\t\n\t\t\tthis.groupIDLookups = [];\n\t\t\t\n\t\t\tif(groupBy){\n\t\t\t\tif(this.table.modExists(\"columnCalcs\") && this.table.options.columnCalcs != \"table\" && this.table.options.columnCalcs != \"both\"){\n\t\t\t\t\tthis.table.modules.columnCalcs.removeCalcs();\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(this.table.modExists(\"columnCalcs\") && this.table.options.columnCalcs != \"group\"){\n\t\t\t\t\t\n\t\t\t\t\tvar cols = this.table.columnManager.getRealColumns();\n\t\t\t\t\t\n\t\t\t\t\tcols.forEach((col) => {\n\t\t\t\t\t\tif(col.definition.topCalc){\n\t\t\t\t\t\t\tthis.table.modules.columnCalcs.initializeTopRow();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(col.definition.bottomCalc){\n\t\t\t\t\t\t\tthis.table.modules.columnCalcs.initializeBottomRow();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(!Array.isArray(groupBy)){\n\t\t\t\tgroupBy = [groupBy];\n\t\t\t}\n\t\t\t\n\t\t\tgroupBy.forEach((group, i) => {\n\t\t\t\tvar lookupFunc, column;\n\t\t\t\t\n\t\t\t\tif(typeof group == \"function\"){\n\t\t\t\t\tlookupFunc = group;\n\t\t\t\t}else {\n\t\t\t\t\tcolumn = this.table.columnManager.getColumnByField(group);\n\t\t\t\t\t\n\t\t\t\t\tif(column){\n\t\t\t\t\t\tlookupFunc = function(data){\n\t\t\t\t\t\t\treturn column.getFieldValue(data);\n\t\t\t\t\t\t};\n\t\t\t\t\t}else {\n\t\t\t\t\t\tlookupFunc = function(data){\n\t\t\t\t\t\t\treturn data[group];\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.groupIDLookups.push({\n\t\t\t\t\tfield: typeof group === \"function\" ? false : group,\n\t\t\t\t\tfunc:lookupFunc,\n\t\t\t\t\tvalues:this.allowedValues ? this.allowedValues[i] : false,\n\t\t\t\t});\n\t\t\t});\n\t\t\t\n\t\t\tif(startOpen){\n\t\t\t\tif(!Array.isArray(startOpen)){\n\t\t\t\t\tstartOpen = [startOpen];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tstartOpen.forEach((level) => {\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.startOpen = startOpen;\n\t\t\t}\n\t\t\t\n\t\t\tif(groupHeader){\n\t\t\t\tthis.headerGenerator = Array.isArray(groupHeader) ? groupHeader : [groupHeader];\n\t\t\t}\n\t\t}else {\n\t\t\tthis.groupList = [];\n\t\t\tthis.groups = {};\n\t\t}\n\t}\n\t\n\trowSample(rows, prevValue){\n\t\tif(this.table.options.groupBy){\n\t\t\tvar group = this.getGroups(false)[0];\n\t\t\t\n\t\t\tprevValue.push(group.getRows(false)[0]);\n\t\t}\n\t\t\n\t\treturn prevValue;\n\t}\n\t\n\tvirtualRenderFill(){\n\t\tvar el = this.table.rowManager.tableElement;\n\t\tvar rows = this.table.rowManager.getVisibleRows();\n\t\t\n\t\tif(this.table.options.groupBy){\n\t\t\trows = rows.filter((row) => {\n\t\t\t\treturn row.type !== \"group\";\n\t\t\t});\n\t\t\t\n\t\t\tel.style.minWidth = !rows.length ? this.table.columnManager.getWidth() + \"px\" : \"\";\n\t\t}else {\n\t\t\treturn rows;\n\t\t}\n\t}\n\t\n\trowAddingIndex(row, index, top){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.assignRowToGroup(row);\n\t\t\t\n\t\t\tvar groupRows = row.modules.group.rows;\n\t\t\t\n\t\t\tif(groupRows.length > 1){\n\t\t\t\tif(!index || (index && groupRows.indexOf(index) == -1)){\n\t\t\t\t\tif(top){\n\t\t\t\t\t\tif(groupRows[0] !== row){\n\t\t\t\t\t\t\tindex = groupRows[0];\n\t\t\t\t\t\t\tthis.table.rowManager.moveRowInArray(row.modules.group.rows, row, index, !top);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(groupRows[groupRows.length -1] !== row){\n\t\t\t\t\t\t\tindex = groupRows[groupRows.length -1];\n\t\t\t\t\t\t\tthis.table.rowManager.moveRowInArray(row.modules.group.rows, row, index, !top);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tthis.table.rowManager.moveRowInArray(row.modules.group.rows, row, index, !top);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn index;\n\t\t}\n\t}\n\t\n\ttrackChanges(){\n\t\tthis.dispatch(\"group-changed\");\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\t\n\tsetGroupBy(groups){\n\t\tthis.table.options.groupBy = groups;\n\t\t\n\t\tif(!this.initialized){\n\t\t\tthis.initialize();\n\t\t}\n\t\t\n\t\tthis.configureGroupSetup();\n\n\t\tif(!groups && this.table.modExists(\"columnCalcs\") && this.table.options.columnCalcs === true){\n\t\t\tthis.table.modules.columnCalcs.reinitializeCalcs();\n\t\t}\n\t\t\n\t\tthis.refreshData();\n\t\t\n\t\tthis.trackChanges();\n\t}\n\t\n\tsetGroupValues(groupValues){\n\t\tthis.table.options.groupValues = groupValues;\n\t\tthis.configureGroupSetup();\n\t\tthis.refreshData();\n\t\t\n\t\tthis.trackChanges();\n\t}\n\t\n\tsetGroupStartOpen(values){\n\t\tthis.table.options.groupStartOpen = values;\n\t\tthis.configureGroupSetup();\n\t\t\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.refreshData();\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t}else {\n\t\t\tconsole.warn(\"Grouping Update - cant refresh view, no groups have been set\");\n\t\t}\n\t}\n\t\n\tsetGroupHeader(values){\n\t\tthis.table.options.groupHeader = values;\n\t\tthis.configureGroupSetup();\n\t\t\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.refreshData();\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t}else {\n\t\t\tconsole.warn(\"Grouping Update - cant refresh view, no groups have been set\");\n\t\t}\n\t}\n\t\n\tuserGetGroups(values){\n\t\treturn this.getGroups(true);\n\t}\n\t\n\t// get grouped table data in the same format as getData()\n\tuserGetGroupedData(){\n\t\treturn this.table.options.groupBy ? this.getGroupedData() : this.getData();\n\t}\n\t\n\t\n\t///////////////////////////////////////\n\t///////// Component Functions /////////\n\t///////////////////////////////////////\n\t\n\trowGetGroup(row){\n\t\treturn row.modules.group ? row.modules.group.getComponent() : false;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\trowMoving(from, to, after){\n\t\tif(this.table.options.groupBy){\n\t\t\tif(!after && to instanceof Group){\n\t\t\t\tto = this.table.rowManager.prevDisplayRow(from) || to;\n\t\t\t}\n\t\t\t\n\t\t\tvar toGroup = to instanceof Group ? to : to.modules.group;\n\t\t\tvar fromGroup = from instanceof Group ? from : from.modules.group;\n\t\t\t\n\t\t\tif(toGroup === fromGroup){\n\t\t\t\tthis.table.rowManager.moveRowInArray(toGroup.rows, from, to, after);\n\t\t\t}else {\n\t\t\t\tif(fromGroup){\n\t\t\t\t\tfromGroup.removeRow(from);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttoGroup.insertRow(from, to, after);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\trowDeleting(row){\n\t\t//remove from group\n\t\tif(this.table.options.groupBy && row.modules.group){\n\t\t\trow.modules.group.removeRow(row);\n\t\t}\n\t}\n\t\n\trowsUpdated(row){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.updateGroupRows(true);\n\t\t}\t\n\t}\n\t\n\tcellUpdated(cell){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.reassignRowToGroup(cell.row);\n\t\t}\n\t}\n\t\n\t//return appropriate rows with group headers\n\tgetRows(rows){\n\t\tif(this.table.options.groupBy && this.groupIDLookups.length){\n\t\t\t\n\t\t\tthis.dispatchExternal(\"dataGrouping\");\n\t\t\t\n\t\t\tthis.generateGroups(rows);\n\t\t\t\n\t\t\tif(this.subscribedExternal(\"dataGrouped\")){\n\t\t\t\tthis.dispatchExternal(\"dataGrouped\", this.getGroups(true));\n\t\t\t}\n\t\t\t\n\t\t\treturn this.updateGroupRows();\n\t\t\t\n\t\t}else {\n\t\t\treturn rows.slice(0);\n\t\t}\n\t}\n\t\n\tgetGroups(component){\n\t\tvar groupComponents = [];\n\t\t\n\t\tthis.groupList.forEach(function(group){\n\t\t\tgroupComponents.push(component ? group.getComponent() : group);\n\t\t});\n\t\t\n\t\treturn groupComponents;\n\t}\n\t\n\tgetChildGroups(group){\n\t\tvar groupComponents = [];\n\t\t\n\t\tif(!group){\n\t\t\tgroup = this;\n\t\t}\n\t\t\n\t\tgroup.groupList.forEach((child) => {\n\t\t\tif(child.groupList.length){\n\t\t\t\tgroupComponents = groupComponents.concat(this.getChildGroups(child));\n\t\t\t}else {\n\t\t\t\tgroupComponents.push(child);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groupComponents;\n\t}\n\t\n\twipe(){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.groupList.forEach(function(group){\n\t\t\t\tgroup.wipe();\n\t\t\t});\n\t\t\t\n\t\t\tthis.groupList = [];\n\t\t\tthis.groups = {};\n\t\t}\n\t}\n\t\n\tpullGroupListData(groupList) {\n\t\tvar groupListData = [];\n\t\t\n\t\tgroupList.forEach((group) => {\n\t\t\tvar groupHeader = {};\n\t\t\tgroupHeader.level = 0;\n\t\t\tgroupHeader.rowCount = 0;\n\t\t\tgroupHeader.headerContent = \"\";\n\t\t\tvar childData = [];\n\t\t\t\n\t\t\tif (group.hasSubGroups) {\n\t\t\t\tchildData = this.pullGroupListData(group.groupList);\n\t\t\t\t\n\t\t\t\tgroupHeader.level = group.level;\n\t\t\t\tgroupHeader.rowCount = childData.length - group.groupList.length; // data length minus number of sub-headers\n\t\t\t\tgroupHeader.headerContent = group.generator(group.key, groupHeader.rowCount, group.rows, group);\n\t\t\t\t\n\t\t\t\tgroupListData.push(groupHeader);\n\t\t\t\tgroupListData = groupListData.concat(childData);\n\t\t\t}\n\t\t\t\n\t\t\telse {\n\t\t\t\tgroupHeader.level = group.level;\n\t\t\t\tgroupHeader.headerContent = group.generator(group.key, group.rows.length, group.rows, group);\n\t\t\t\tgroupHeader.rowCount = group.getRows().length;\n\t\t\t\t\n\t\t\t\tgroupListData.push(groupHeader);\n\t\t\t\t\n\t\t\t\tgroup.getRows().forEach((row) => {\n\t\t\t\t\tgroupListData.push(row.getData(\"data\"));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groupListData;\n\t}\n\t\n\tgetGroupedData(){\n\t\t\n\t\treturn this.pullGroupListData(this.groupList);\n\t}\n\t\n\tgetRowGroup(row){\n\t\tvar match = false;\n\t\t\n\t\tif(this.options(\"dataTree\")){\n\t\t\trow = this.table.modules.dataTree.getTreeParentRoot(row);\n\t\t}\n\t\t\n\t\tthis.groupList.forEach((group) => {\n\t\t\tvar result = group.getRowGroup(row);\n\t\t\t\n\t\t\tif(result){\n\t\t\t\tmatch = result;\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn match;\n\t}\n\t\n\tcountGroups(){\n\t\treturn this.groupList.length;\n\t}\n\t\n\tgenerateGroups(rows){\n\t\tvar oldGroups = this.groups;\n\t\t\n\t\tthis.groups = {};\n\t\tthis.groupList = [];\n\t\t\n\t\tif(this.allowedValues && this.allowedValues[0]){\n\t\t\tthis.allowedValues[0].forEach((value) => {\n\t\t\t\tthis.createGroup(value, 0, oldGroups);\n\t\t\t});\n\t\t\t\n\t\t\trows.forEach((row) => {\n\t\t\t\tthis.assignRowToExistingGroup(row, oldGroups);\n\t\t\t});\n\t\t}else {\n\t\t\trows.forEach((row) => {\n\t\t\t\tthis.assignRowToGroup(row, oldGroups);\n\t\t\t});\n\t\t}\n\t\t\n\t\tObject.values(oldGroups).forEach((group) => {\n\t\t\tgroup.wipe(true);\n\t\t});\t\n\t}\n\t\n\t\n\tcreateGroup(groupID, level, oldGroups){\n\t\tvar groupKey = level + \"_\" + groupID,\n\t\tgroup;\n\t\t\n\t\toldGroups = oldGroups || [];\n\t\t\n\t\tgroup = new Group(this, false, level, groupID, this.groupIDLookups[0].field, this.headerGenerator[0], oldGroups[groupKey]);\n\t\t\n\t\tthis.groups[groupKey] = group;\n\t\tthis.groupList.push(group);\n\t}\n\t\n\tassignRowToExistingGroup(row, oldGroups){\n\t\tvar groupID = this.groupIDLookups[0].func(row.getData()),\n\t\tgroupKey = \"0_\" + groupID;\n\t\t\n\t\tif(this.groups[groupKey]){\n\t\t\tthis.groups[groupKey].addRow(row);\n\t\t}\n\t}\n\t\n\tassignRowToGroup(row, oldGroups){\n\t\tvar groupID = this.groupIDLookups[0].func(row.getData()),\n\t\tnewGroupNeeded = !this.groups[\"0_\" + groupID];\n\t\t\n\t\tif(newGroupNeeded){\n\t\t\tthis.createGroup(groupID, 0, oldGroups);\n\t\t}\n\t\t\n\t\tthis.groups[\"0_\" + groupID].addRow(row);\n\t\t\n\t\treturn !newGroupNeeded;\n\t}\n\t\n\treassignRowToGroup(row){\n\t\tif(row.type === \"row\"){\n\t\t\tvar oldRowGroup = row.modules.group,\n\t\t\toldGroupPath = oldRowGroup.getPath(),\n\t\t\tnewGroupPath = this.getExpectedPath(row),\n\t\t\tsamePath;\n\t\t\t\n\t\t\t// figure out if new group path is the same as old group path\n\t\t\tsamePath = (oldGroupPath.length == newGroupPath.length) && oldGroupPath.every((element, index) => {\n\t\t\t\treturn element === newGroupPath[index];\n\t\t\t});\n\t\t\t\n\t\t\t// refresh if they new path and old path aren't the same (aka the row's groupings have changed)\n\t\t\tif(!samePath) {\n\t\t\t\toldRowGroup.removeRow(row);\n\t\t\t\tthis.assignRowToGroup(row, this.groups);\n\t\t\t\tthis.refreshData(true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tgetExpectedPath(row) {\n\t\tvar groupPath = [], rowData = row.getData();\n\t\t\n\t\tthis.groupIDLookups.forEach((groupId) => {\n\t\t\tgroupPath.push(groupId.func(rowData));\n\t\t});\n\t\t\n\t\treturn groupPath;\n\t}\n\t\n\tupdateGroupRows(force){\n\t\tvar output = [];\n\n\t\tif(!this.blockRedraw){\n\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\toutput = output.concat(group.getHeadersAndRows());\n\t\t\t});\n\t\t\t\n\t\t\tif(force){\n\t\t\t\tthis.refreshData(true);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tscrollHeaders(left){\n\t\tif(this.table.options.groupBy){\n\t\t\tif(this.table.options.renderHorizontal === \"virtual\"){\n\t\t\t\tleft -= this.table.columnManager.renderer.vDomPadLeft;\n\t\t\t}\n\t\t\t\n\t\t\tleft = left + \"px\";\n\t\t\t\n\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\tgroup.scrollHeader(left);\n\t\t\t});\n\t\t}\n\t}\n\t\n\tremoveGroup(group){\n\t\tvar groupKey = group.level + \"_\" + group.key,\n\t\tindex;\n\t\t\n\t\tif(this.groups[groupKey]){\n\t\t\tdelete this.groups[groupKey];\n\t\t\t\n\t\t\tindex = this.groupList.indexOf(group);\n\t\t\t\n\t\t\tif(index > -1){\n\t\t\t\tthis.groupList.splice(index, 1);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcheckBasicModeGroupHeaderWidth(){\n\t\tvar element = this.table.rowManager.tableElement,\n\t\tonlyGroupHeaders = true;\n\t\t\n\t\tthis.table.rowManager.getDisplayRows().forEach((row, index) =>{\n\t\t\tthis.table.rowManager.styleRow(row, index);\n\t\t\telement.appendChild(row.getElement());\n\t\t\trow.initialize(true);\n\t\t\t\n\t\t\tif(row.type !== \"group\"){\n\t\t\t\tonlyGroupHeaders = false;\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(onlyGroupHeaders){\n\t\t\telement.style.minWidth = this.table.columnManager.getWidth() + \"px\";\n\t\t}else {\n\t\t\telement.style.minWidth = \"\";\n\t\t}\n\t}\n\t\n}\n\nvar defaultUndoers = {\n\tcellEdit: function(action){\n\t\taction.component.setValueProcessData(action.data.oldValue);\n\t\taction.component.cellRendered();\n\t},\n\n\trowAdd: function(action){\n\t\taction.component.deleteActual();\n\n\t\tthis.table.rowManager.checkPlaceholder();\n\t},\n\n\trowDelete: function(action){\n\t\tvar newRow = this.table.rowManager.addRowActual(action.data.data, action.data.pos, action.data.index);\n\n\t\tif(this.table.options.groupBy && this.table.modExists(\"groupRows\")){\n\t\t\tthis.table.modules.groupRows.updateGroupRows(true);\n\t\t}\n\n\t\tthis._rebindRow(action.component, newRow);\n\n\t\tthis.table.rowManager.checkPlaceholder();\n\t},\n\n\trowMove: function(action){\n\t\tvar after = (action.data.posFrom  - action.data.posTo) > 0;\n\n\t\tthis.table.rowManager.moveRowActual(action.component, this.table.rowManager.getRowFromPosition(action.data.posFrom), after);\n\n\t\tthis.table.rowManager.regenerateRowPositions();\n\t\tthis.table.rowManager.reRenderInPosition();\n\t},\n};\n\nvar defaultRedoers = {\n\tcellEdit: function(action){\n\t\taction.component.setValueProcessData(action.data.newValue);\n\t\taction.component.cellRendered();\n\t},\n\n\trowAdd: function(action){\n\t\tvar newRow = this.table.rowManager.addRowActual(action.data.data, action.data.pos, action.data.index);\n\n\t\tif(this.table.options.groupBy && this.table.modExists(\"groupRows\")){\n\t\t\tthis.table.modules.groupRows.updateGroupRows(true);\n\t\t}\n\n\t\tthis._rebindRow(action.component, newRow);\n\n\t\tthis.table.rowManager.checkPlaceholder();\n\t},\n\n\trowDelete:function(action){\n\t\taction.component.deleteActual();\n\n\t\tthis.table.rowManager.checkPlaceholder();\n\t},\n\n\trowMove: function(action){\n\t\tthis.table.rowManager.moveRowActual(action.component, this.table.rowManager.getRowFromPosition(action.data.posTo), action.data.after);\n\t\t\n\t\tthis.table.rowManager.regenerateRowPositions();\n\t\tthis.table.rowManager.reRenderInPosition();\n\t},\n};\n\nvar bindings$1 = {\r\n\tundo:[\"ctrl + 90\", \"meta + 90\"],\r\n\tredo:[\"ctrl + 89\", \"meta + 89\"],\r\n};\n\nvar actions$1 = {\r\n\tundo:function(e){\r\n\t\tvar cell = false;\r\n\t\tif(this.table.options.history && this.table.modExists(\"history\") && this.table.modExists(\"edit\")){\r\n\r\n\t\t\tcell = this.table.modules.edit.currentCell;\r\n\r\n\t\t\tif(!cell){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.table.modules.history.undo();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tredo:function(e){\r\n\t\tvar cell = false;\r\n\t\tif(this.table.options.history && this.table.modExists(\"history\") && this.table.modExists(\"edit\")){\r\n\r\n\t\t\tcell = this.table.modules.edit.currentCell;\r\n\r\n\t\t\tif(!cell){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.table.modules.history.redo();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n};\n\nvar extensions$3 = {\r\n\tkeybindings:{\r\n\t\tbindings:bindings$1,\r\n\t\tactions:actions$1\r\n\t},\r\n};\n\nclass History extends Module{\n\n\tstatic moduleName = \"history\";\n\tstatic moduleExtensions = extensions$3;\n\n\t//load defaults\n\tstatic undoers = defaultUndoers;\n\tstatic redoers = defaultRedoers;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.history = [];\n\t\tthis.index = -1;\n\n\t\tthis.registerTableOption(\"history\", false); //enable edit history\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.history){\n\t\t\tthis.subscribe(\"cell-value-updated\", this.cellUpdated.bind(this));\n\t\t\tthis.subscribe(\"cell-delete\", this.clearComponentHistory.bind(this));\n\t\t\tthis.subscribe(\"row-delete\", this.rowDeleted.bind(this));\n\t\t\tthis.subscribe(\"rows-wipe\", this.clear.bind(this));\n\t\t\tthis.subscribe(\"row-added\", this.rowAdded.bind(this));\n\t\t\tthis.subscribe(\"row-move\", this.rowMoved.bind(this));\n\t\t}\n\n\t\tthis.registerTableFunction(\"undo\", this.undo.bind(this));\n\t\tthis.registerTableFunction(\"redo\", this.redo.bind(this));\n\t\tthis.registerTableFunction(\"getHistoryUndoSize\", this.getHistoryUndoSize.bind(this));\n\t\tthis.registerTableFunction(\"getHistoryRedoSize\", this.getHistoryRedoSize.bind(this));\n\t\tthis.registerTableFunction(\"clearHistory\", this.clear.bind(this));\n\t}\n\n\trowMoved(from, to, after){\n\t\tthis.action(\"rowMove\", from, {posFrom:from.getPosition(), posTo:to.getPosition(), to:to, after:after});\n\t}\n\n\trowAdded(row, data, pos, index){\n\t\tthis.action(\"rowAdd\", row, {data:data, pos:pos, index:index});\n\t}\n\n\trowDeleted(row){\n\t\tvar index, rows;\n\n\t\tif(this.table.options.groupBy){\n\n\t\t\trows = row.getComponent().getGroup()._getSelf().rows;\n\t\t\tindex = rows.indexOf(row);\n\n\t\t\tif(index){\n\t\t\t\tindex = rows[index-1];\n\t\t\t}\n\t\t}else {\n\t\t\tindex = row.table.rowManager.getRowIndex(row);\n\n\t\t\tif(index){\n\t\t\t\tindex = row.table.rowManager.rows[index-1];\n\t\t\t}\n\t\t}\n\n\t\tthis.action(\"rowDelete\", row, {data:row.getData(), pos:!index, index:index});\n\t}\n\n\tcellUpdated(cell){\n\t\tthis.action(\"cellEdit\", cell, {oldValue:cell.oldValue, newValue:cell.value});\n\t}\n\n\tclear(){\n\t\tthis.history = [];\n\t\tthis.index = -1;\n\t}\n\n\taction(type, component, data){\n\t\tthis.history = this.history.slice(0, this.index + 1);\n\n\t\tthis.history.push({\n\t\t\ttype:type,\n\t\t\tcomponent:component,\n\t\t\tdata:data,\n\t\t});\n\n\t\tthis.index ++;\n\t}\n\n\tgetHistoryUndoSize(){\n\t\treturn this.index + 1;\n\t}\n\n\tgetHistoryRedoSize(){\n\t\treturn this.history.length - (this.index + 1);\n\t}\n\n\tclearComponentHistory(component){\n\t\tvar index = this.history.findIndex(function(item){\n\t\t\treturn item.component === component;\n\t\t});\n\n\t\tif(index > -1){\n\t\t\tthis.history.splice(index, 1);\n\t\t\tif(index <= this.index){\n\t\t\t\tthis.index--;\n\t\t\t}\n\n\t\t\tthis.clearComponentHistory(component);\n\t\t}\n\t}\n\n\tundo(){\n\t\tif(this.index > -1){\n\t\t\tlet action = this.history[this.index];\n\n\t\t\tHistory.undoers[action.type].call(this, action);\n\n\t\t\tthis.index--;\n\n\t\t\tthis.dispatchExternal(\"historyUndo\", action.type, action.component.getComponent(), action.data);\n\n\t\t\treturn true;\n\t\t}else {\n\t\t\tconsole.warn(this.options(\"history\") ? \"History Undo Error - No more history to undo\" : \"History module not enabled\");\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tredo(){\n\t\tif(this.history.length-1 > this.index){\n\n\t\t\tthis.index++;\n\n\t\t\tlet action = this.history[this.index];\n\n\t\t\tHistory.redoers[action.type].call(this, action);\n\n\t\t\tthis.dispatchExternal(\"historyRedo\", action.type, action.component.getComponent(), action.data);\n\n\t\t\treturn true;\n\t\t}else {\n\t\t\tconsole.warn(this.options(\"history\") ? \"History Redo Error - No more history to redo\" : \"History module not enabled\");\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//rebind rows to new element after deletion\n\t_rebindRow(oldRow, newRow){\n\t\tthis.history.forEach(function(action){\n\t\t\tif(action.component instanceof Row){\n\t\t\t\tif(action.component === oldRow){\n\t\t\t\t\taction.component = newRow;\n\t\t\t\t}\n\t\t\t}else if(action.component instanceof Cell){\n\t\t\t\tif(action.component.row === oldRow){\n\t\t\t\t\tvar field = action.component.column.getField();\n\n\t\t\t\t\tif(field){\n\t\t\t\t\t\taction.component = newRow.getCell(field);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nclass HtmlTableImport extends Module{\n\n\tstatic moduleName = \"htmlTableImport\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.fieldIndex = [];\n\t\tthis.hasIndex = false;\n\t}\n\n\tinitialize(){\n\t\tthis.tableElementCheck();\n\t}\n\n\ttableElementCheck(){\n\t\tif(this.table.originalElement && this.table.originalElement.tagName === \"TABLE\"){\n\t\t\tif(this.table.originalElement.childNodes.length){\n\t\t\t\tthis.parseTable();\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element.\");\n\t\t\t}\n\t\t}\n\t}\n\n\tparseTable(){\n\t\tvar element = this.table.originalElement,\n\t\toptions = this.table.options,\n\t\theaders = element.getElementsByTagName(\"th\"),\n\t\trows = element.getElementsByTagName(\"tbody\")[0],\n\t\tdata = [];\n\n\t\tthis.hasIndex = false;\n\n\t\tthis.dispatchExternal(\"htmlImporting\");\n\n\t\trows = rows ? rows.getElementsByTagName(\"tr\") : [];\n\n\t\t//check for Tabulator inline options\n\t\tthis._extractOptions(element, options);\n\n\t\tif(headers.length){\n\t\t\tthis._extractHeaders(headers, rows);\n\t\t}else {\n\t\t\tthis._generateBlankHeaders(headers, rows);\n\t\t}\n\n\t\t//iterate through table rows and build data set\n\t\tfor(var index = 0; index < rows.length; index++){\n\t\t\tvar row = rows[index],\n\t\t\tcells = row.getElementsByTagName(\"td\"),\n\t\t\titem = {};\n\n\t\t\t//create index if the don't exist in table\n\t\t\tif(!this.hasIndex){\n\t\t\t\titem[options.index] = index;\n\t\t\t}\n\n\t\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\t\tvar cell = cells[i];\n\t\t\t\tif(typeof this.fieldIndex[i] !== \"undefined\"){\n\t\t\t\t\titem[this.fieldIndex[i]] = cell.innerHTML;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//add row data to item\n\t\t\tdata.push(item);\n\t\t}\n\n\t\toptions.data = data;\n\n\t\tthis.dispatchExternal(\"htmlImported\");\n\t}\n\n\t//extract tabulator attribute options\n\t_extractOptions(element, options, defaultOptions){\n\t\tvar attributes = element.attributes;\n\t\tvar optionsArr = defaultOptions ? Object.keys(defaultOptions) : Object.keys(options);\n\t\tvar optionsList = {};\n\n\t\toptionsArr.forEach((item) => {\n\t\t\toptionsList[item.toLowerCase()] = item;\n\t\t});\n\n\t\tfor(var index in attributes){\n\t\t\tvar attrib = attributes[index];\n\t\t\tvar name;\n\n\t\t\tif(attrib && typeof attrib == \"object\" && attrib.name && attrib.name.indexOf(\"tabulator-\") === 0){\n\t\t\t\tname = attrib.name.replace(\"tabulator-\", \"\");\n\n\t\t\t\tif(typeof optionsList[name] !== \"undefined\"){\n\t\t\t\t\toptions[optionsList[name]] = this._attribValue(attrib.value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//get value of attribute\n\t_attribValue(value){\n\t\tif(value === \"true\"){\n\t\t\treturn true;\n\t\t}\n\n\t\tif(value === \"false\"){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\t//find column if it has already been defined\n\t_findCol(title){\n\t\tvar match = this.table.options.columns.find((column) => {\n\t\t\treturn column.title === title;\n\t\t});\n\n\t\treturn match || false;\n\t}\n\n\t//extract column from headers\n\t_extractHeaders(headers, rows){\n\t\tfor(var index = 0; index < headers.length; index++){\n\t\t\tvar header = headers[index],\n\t\t\texists = false,\n\t\t\tcol = this._findCol(header.textContent),\n\t\t\twidth;\n\n\t\t\tif(col){\n\t\t\t\texists = true;\n\t\t\t}else {\n\t\t\t\tcol = {title:header.textContent.trim()};\n\t\t\t}\n\n\t\t\tif(!col.field) {\n\t\t\t\tcol.field = header.textContent.trim().toLowerCase().replaceAll(\" \", \"_\");\n\t\t\t}\n\n\t\t\twidth = header.getAttribute(\"width\");\n\n\t\t\tif(width && !col.width)\t{\n\t\t\t\tcol.width = width;\n\t\t\t}\n\n\t\t\t//check for Tabulator inline options\n\t\t\tthis._extractOptions(header, col, this.table.columnManager.optionsList.registeredDefaults);\n\n\t\t\tthis.fieldIndex[index] = col.field;\n\n\t\t\tif(col.field == this.table.options.index){\n\t\t\t\tthis.hasIndex = true;\n\t\t\t}\n\n\t\t\tif(!exists){\n\t\t\t\tthis.table.options.columns.push(col);\n\t\t\t}\n\n\t\t}\n\t}\n\n\t//generate blank headers\n\t_generateBlankHeaders(headers, rows){\n\t\tfor(var index = 0; index < headers.length; index++){\n\t\t\tvar header = headers[index],\n\t\t\tcol = {title:\"\", field:\"col\" + index};\n\n\t\t\tthis.fieldIndex[index] = col.field;\n\n\t\t\tvar width = header.getAttribute(\"width\");\n\n\t\t\tif(width){\n\t\t\t\tcol.width = width;\n\t\t\t}\n\n\t\t\tthis.table.options.columns.push(col);\n\t\t}\n\t}\n}\n\nfunction csv(input){\n\tvar data = [],\n\trow = 0, \n\tcol = 0,\n\tinQuote = false;\n    \n\t//Iterate over each character\n\tfor (let index = 0; index < input.length; index++) {\n\t\tlet char = input[index], \n\t\tnextChar = input[index+1];      \n        \n\t\t//Initialize empty row\n\t\tif(!data[row]){\n\t\t\tdata[row] = [];\n\t\t}\n\n\t\t//Initialize empty column\n\t\tif(!data[row][col]){\n\t\t\tdata[row][col] = \"\";\n\t\t}\n        \n\t\t//Handle quotation mark inside string\n\t\tif (char == '\"' && inQuote && nextChar == '\"') { \n\t\t\tdata[row][col] += char; \n\t\t\tindex++;\n\t\t\tcontinue; \n\t\t}\n        \n\t\t//Begin / End Quote\n\t\tif (char == '\"') { \n\t\t\tinQuote = !inQuote;\n\t\t\tcontinue;\n\t\t}\n        \n\t\t//Next column (if not in quote)\n\t\tif (char == ',' && !inQuote) { \n\t\t\tcol++;\n\t\t\tcontinue; \n\t\t}\n        \n\t\t//New row if new line and not in quote (CRLF) \n\t\tif (char == '\\r' && nextChar == '\\n' && !inQuote) { \n\t\t\tcol = 0; \n\t\t\trow++; \n\t\t\tindex++; \n\t\t\tcontinue; \n\t\t}\n        \n\t\t//New row if new line and not in quote (CR or LF) \n\t\tif ((char == '\\r' || char == '\\n') && !inQuote) { \n\t\t\tcol = 0;\n\t\t\trow++;\n\t\t\tcontinue; \n\t\t}\n\n\t\t//Normal Character, append to column\n\t\tdata[row][col] += char;\n\t}\n\n\treturn data;\n}\n\nfunction json(input){\n\ttry {\n\t\treturn JSON.parse(input);\n\t} catch(e) {\n\t\tconsole.warn(\"JSON Import Error - File contents is invalid JSON\", e);\n\t\treturn Promise.reject();\n\t}\n}\n\nfunction array$1 (input){\n\treturn input;\n}\n\nfunction xlsx(input){\r\n\tvar XLSXLib = this.dependencyRegistry.lookup(\"XLSX\"),\r\n\tworkbook2 = XLSXLib.read(input),\r\n\tsheet = workbook2.Sheets[workbook2.SheetNames[0]];\r\n\t\r\n\treturn XLSXLib.utils.sheet_to_json(sheet, {header: 1 });\r\n}\n\nvar defaultImporters = {\n\tcsv:csv,\n\tjson:json,\n\tarray:array$1,\n\txlsx:xlsx,\n};\n\nclass Import extends Module{\n\t\n\tstatic moduleName = \"import\";\n\t\n\t//load defaults\n\tstatic importers = defaultImporters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.registerTableOption(\"importFormat\");\n\t\tthis.registerTableOption(\"importReader\", \"text\");\n\t\tthis.registerTableOption(\"importHeaderTransform\");\n\t\tthis.registerTableOption(\"importValueTransform\");\n\t\tthis.registerTableOption(\"importDataValidator\");\n\t\tthis.registerTableOption(\"importFileValidator\");\n\t}\n\t\n\tinitialize(){\n\t\tthis.registerTableFunction(\"import\", this.importFromFile.bind(this));\n\t\t\n\t\tif(this.table.options.importFormat){\n\t\t\tthis.subscribe(\"data-loading\", this.loadDataCheck.bind(this), 10);\n\t\t\tthis.subscribe(\"data-load\", this.loadData.bind(this), 10);\n\t\t}\n\t}\n\t\n\tloadDataCheck(data){\n\t\treturn this.table.options.importFormat && (typeof data === \"string\" || (Array.isArray(data) && data.length && Array.isArray(data)));\n\t}\n\t\n\tloadData(data, params, config, silent, previousData){\n\t\treturn this.importData(this.lookupImporter(), data)\n\t\t\t.then(this.structureData.bind(this))\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.error(\"Import Error:\", err || \"Unable to import data\");\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t}\n\t\n\tlookupImporter(importFormat){\n\t\tvar importer;\n\t\t\n\t\tif(!importFormat){\n\t\t\timportFormat = this.table.options.importFormat;\n\t\t}\n\t\t\n\t\tif(typeof importFormat === \"string\"){\n\t\t\timporter = Import.importers[importFormat];\n\t\t}else {\n\t\t\timporter = importFormat;\n\t\t}\n\t\t\n\t\tif(!importer){\n\t\t\tconsole.error(\"Import Error - Importer not found:\", importFormat);\n\t\t}\n\t\t\n\t\treturn importer;\n\t}\n\t\n\timportFromFile(importFormat, extension, importReader){\n\t\tvar importer = this.lookupImporter(importFormat);\n\t\t\n\t\tif(importer){\n\t\t\treturn this.pickFile(extension, importReader)\n\t\t\t\t.then(this.importData.bind(this, importer))\n\t\t\t\t.then(this.structureData.bind(this))\n\t\t\t\t.then(this.mutateData.bind(this))\n\t\t\t\t.then(this.validateData.bind(this))\n\t\t\t\t.then(this.setData.bind(this))\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tthis.dispatch(\"import-error\", err);\n\t\t\t\t\tthis.dispatchExternal(\"importError\", err);\n\t\t\t\t\t\n\t\t\t\t\tconsole.error(\"Import Error:\", err || \"Unable to import file\");\n\t\t\t\t\t\n\t\t\t\t\tthis.table.dataLoader.alertError();\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.table.dataLoader.clearAlert();\n\t\t\t\t\t}, 3000);\n\t\t\t\t\t\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t});\n\t\t}\n\t}\n\t\n\tpickFile(extensions, importReader){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar input = document.createElement(\"input\");\n\t\t\tinput.type = \"file\";\n\t\t\tinput.accept = extensions;\n\t\t\t\n\t\t\tinput.addEventListener(\"change\", (e) => {\n\t\t\t\tvar file = input.files[0],\n\t\t\t\treader = new FileReader(),\n\t\t\t\tvalid = this.validateFile(file);\n\n\t\t\t\tif(valid === true){\n\t\t\t\t\n\t\t\t\t\tthis.dispatch(\"import-importing\", input.files);\n\t\t\t\t\tthis.dispatchExternal(\"importImporting\", input.files);\n\t\t\t\t\n\t\t\t\t\tswitch(importReader || this.table.options.importReader){\n\t\t\t\t\t\tcase \"buffer\":\n\t\t\t\t\t\t\treader.readAsArrayBuffer(file);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase \"binary\":\n\t\t\t\t\t\t\treader.readAsBinaryString(file);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase \"url\":\n\t\t\t\t\t\t\treader.readAsDataURL(file);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase \"text\":\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treader.readAsText(file);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treader.onload = (e) => {\n\t\t\t\t\t\tresolve(reader.result);\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\treader.onerror = (e) => {\n\t\t\t\t\t\tconsole.warn(\"File Load Error - Unable to read file\");\n\t\t\t\t\t\treject(e);\n\t\t\t\t\t};\n\t\t\t\t}else {\n\t\t\t\t\treject(valid);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.dispatch(\"import-choose\");\n\t\t\tthis.dispatchExternal(\"importChoose\");\n\t\t\tinput.click();\n\t\t});\n\t}\n\t\n\timportData(importer, fileContents){\n\t\tvar data;\n\t\t\n\t\tthis.table.dataLoader.alertLoader();\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tdata = importer.call(this.table, fileContents);\n\t\t\t\t\n\t\t\t\tif(data instanceof Promise){\n\t\t\t\t\tresolve(data);\n\t\t\t\t}else {\n\t\t\t\t\tdata ? resolve(data) : reject();\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t});\n\t}\n\t\n\tstructureData(parsedData){\n\t\tvar data = [];\n\t\t\n\t\tif(Array.isArray(parsedData) && parsedData.length && Array.isArray(parsedData[0])){\n\t\t\tif(this.table.options.autoColumns){\n\t\t\t\tdata = this.structureArrayToObject(parsedData);\n\t\t\t}else {\n\t\t\t\tdata = this.structureArrayToColumns(parsedData);\n\t\t\t}\n\t\t\t\n\t\t\treturn data;\n\t\t}else {\n\t\t\treturn parsedData;\n\t\t}\n\t}\n\t\n\tmutateData(data){\n\t\tvar output = [];\n\t\t\n\t\tif(Array.isArray(data)){\n\t\t\tdata.forEach((row) => {\n\t\t\t\toutput.push(this.table.modules.mutator.transformRow(row, \"import\"));\n\t\t\t});\n\t\t}else {\n\t\t\toutput = data;\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\ttransformHeader(headers){\n\t\tvar output = [];\n\t\t\n\t\tif(this.table.options.importHeaderTransform){\n\t\t\theaders.forEach((item) => {\n\t\t\t\toutput.push(this.table.options.importHeaderTransform.call(this.table, item, headers));\n\t\t\t});\n\t\t}else {\n\t\t\treturn headers;\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\ttransformData(row){\n\t\tvar output = [];\n\n\t\tif(this.table.options.importValueTransform){\n\t\t\trow.forEach((item) => {\n\t\t\t\toutput.push(this.table.options.importValueTransform.call(this.table, item, row));\n\t\t\t});\n\t\t}else {\n\t\t\treturn row;\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tstructureArrayToObject(parsedData){\n\t\tvar columns = this.transformHeader(parsedData.shift());\t\n\t\t\n\t\tvar data = parsedData.map((values) => {\n\t\t\tvar row = {};\n\n\t\t\tvalues = this.transformData(values);\n\t\t\t\n\t\t\tcolumns.forEach((key, i) => {\n\t\t\t\trow[key] = values[i];\n\t\t\t});\n\t\t\t\n\t\t\treturn row;\n\t\t});\n\t\t\n\t\treturn data;\n\t}\n\t\n\tstructureArrayToColumns(parsedData){\n\t\tvar data = [],\n\t\tfirstRow = this.transformHeader(parsedData[0]),\n\t\tcolumns = this.table.getColumns();\n\t\t\n\t\t//remove first row if it is the column names\n\t\tif(columns[0] && firstRow[0]){\n\t\t\tif(columns[0].getDefinition().title === firstRow[0]){\n\t\t\t\tparsedData.shift();\n\t\t\t}\n\t\t}\n\t\t\n\t\t//convert row arrays to objects\n\t\tparsedData.forEach((rowData) => {\n\t\t\tvar row = {};\n\n\t\t\trowData = this.transformData(rowData);\n\t\t\t\n\t\t\trowData.forEach((value, index) => {\n\t\t\t\tvar column = columns[index];\n\t\t\t\t\n\t\t\t\tif(column){\n\t\t\t\t\trow[column.getField()] = value;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tdata.push(row);\n\t\t});\n\t\t\n\t\treturn data;\n\t}\n\n\tvalidateFile(file){\n\t\tif(this.table.options.importFileValidator){\n\t\t\treturn this.table.options.importFileValidator.call(this.table, file);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tvalidateData(data){\n\t\tvar result;\n\n\t\tif(this.table.options.importDataValidator){\n\t\t\tresult = this.table.options.importDataValidator.call(this.table, data);\n\n\t\t\tif(result === true){\n\t\t\t\treturn data;\n\t\t\t}else {\n\t\t\t\treturn Promise.reject(result);\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\t\n\tsetData(data){\n\t\tthis.dispatch(\"import-imported\", data);\n\t\tthis.dispatchExternal(\"importImported\", data);\n\t\t\n\t\tthis.table.dataLoader.clearAlert();\n\t\t\n\t\treturn this.table.setData(data);\n\t}\n}\n\nclass Interaction extends Module{\n\n\tstatic moduleName = \"interaction\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.eventMap = {\n\t\t\t//row events\n\t\t\trowClick:\"row-click\",\n\t\t\trowDblClick:\"row-dblclick\",\n\t\t\trowContext:\"row-contextmenu\",\n\t\t\trowMouseEnter:\"row-mouseenter\",\n\t\t\trowMouseLeave:\"row-mouseleave\",\n\t\t\trowMouseOver:\"row-mouseover\",\n\t\t\trowMouseOut:\"row-mouseout\",\n\t\t\trowMouseMove:\"row-mousemove\",\n\t\t\trowMouseDown:\"row-mousedown\",\n\t\t\trowMouseUp:\"row-mouseup\",\n\t\t\trowTap:\"row\",\n\t\t\trowDblTap:\"row\",\n\t\t\trowTapHold:\"row\",\n\n\t\t\t//cell events\n\t\t\tcellClick:\"cell-click\",\n\t\t\tcellDblClick:\"cell-dblclick\",\n\t\t\tcellContext:\"cell-contextmenu\",\n\t\t\tcellMouseEnter:\"cell-mouseenter\",\n\t\t\tcellMouseLeave:\"cell-mouseleave\",\n\t\t\tcellMouseOver:\"cell-mouseover\",\n\t\t\tcellMouseOut:\"cell-mouseout\",\n\t\t\tcellMouseMove:\"cell-mousemove\",\n\t\t\tcellMouseDown:\"cell-mousedown\",\n\t\t\tcellMouseUp:\"cell-mouseup\",\n\t\t\tcellTap:\"cell\",\n\t\t\tcellDblTap:\"cell\",\n\t\t\tcellTapHold:\"cell\",\n\n\t\t\t//column header events\n\t\t\theaderClick:\"column-click\",\n\t\t\theaderDblClick:\"column-dblclick\",\n\t\t\theaderContext:\"column-contextmenu\",\n\t\t\theaderMouseEnter:\"column-mouseenter\",\n\t\t\theaderMouseLeave:\"column-mouseleave\",\n\t\t\theaderMouseOver:\"column-mouseover\",\n\t\t\theaderMouseOut:\"column-mouseout\",\n\t\t\theaderMouseMove:\"column-mousemove\",\n\t\t\theaderMouseDown:\"column-mousedown\",\n\t\t\theaderMouseUp:\"column-mouseup\",\n\t\t\theaderTap:\"column\",\n\t\t\theaderDblTap:\"column\",\n\t\t\theaderTapHold:\"column\",\n\n\t\t\t//group header\n\t\t\tgroupClick:\"group-click\",\n\t\t\tgroupDblClick:\"group-dblclick\",\n\t\t\tgroupContext:\"group-contextmenu\",\n\t\t\tgroupMouseEnter:\"group-mouseenter\",\n\t\t\tgroupMouseLeave:\"group-mouseleave\",\n\t\t\tgroupMouseOver:\"group-mouseover\",\n\t\t\tgroupMouseOut:\"group-mouseout\",\n\t\t\tgroupMouseMove:\"group-mousemove\",\n\t\t\tgroupMouseDown:\"group-mousedown\",\n\t\t\tgroupMouseUp:\"group-mouseup\",\n\t\t\tgroupTap:\"group\",\n\t\t\tgroupDblTap:\"group\",\n\t\t\tgroupTapHold:\"group\",\n\t\t};\n\n\t\tthis.subscribers = {};\n\n\t\tthis.touchSubscribers = {};\n\n\t\tthis.columnSubscribers = {};\n\n\t\tthis.touchWatchers = {\n\t\t\trow:{\n\t\t\t\ttap:null,\n\t\t\t\ttapDbl:null,\n\t\t\t\ttapHold:null,\n\t\t\t},\n\t\t\tcell:{\n\t\t\t\ttap:null,\n\t\t\t\ttapDbl:null,\n\t\t\t\ttapHold:null,\n\t\t\t},\n\t\t\tcolumn:{\n\t\t\t\ttap:null,\n\t\t\t\ttapDbl:null,\n\t\t\t\ttapHold:null,\n\t\t\t},\n\t\t\tgroup:{\n\t\t\t\ttap:null,\n\t\t\t\ttapDbl:null,\n\t\t\t\ttapHold:null,\n\t\t\t}\n\t\t};\n\n\t\tthis.registerColumnOption(\"headerClick\");\n\t\tthis.registerColumnOption(\"headerDblClick\");\n\t\tthis.registerColumnOption(\"headerContext\");\n\t\tthis.registerColumnOption(\"headerMouseEnter\");\n\t\tthis.registerColumnOption(\"headerMouseLeave\");\n\t\tthis.registerColumnOption(\"headerMouseOver\");\n\t\tthis.registerColumnOption(\"headerMouseOut\");\n\t\tthis.registerColumnOption(\"headerMouseMove\");\n\t\tthis.registerColumnOption(\"headerMouseDown\");\n\t\tthis.registerColumnOption(\"headerMouseUp\");\n\t\tthis.registerColumnOption(\"headerTap\");\n\t\tthis.registerColumnOption(\"headerDblTap\");\n\t\tthis.registerColumnOption(\"headerTapHold\");\n\n\t\tthis.registerColumnOption(\"cellClick\");\n\t\tthis.registerColumnOption(\"cellDblClick\");\n\t\tthis.registerColumnOption(\"cellContext\");\n\t\tthis.registerColumnOption(\"cellMouseEnter\");\n\t\tthis.registerColumnOption(\"cellMouseLeave\");\n\t\tthis.registerColumnOption(\"cellMouseOver\");\n\t\tthis.registerColumnOption(\"cellMouseOut\");\n\t\tthis.registerColumnOption(\"cellMouseMove\");\n\t\tthis.registerColumnOption(\"cellMouseDown\");\n\t\tthis.registerColumnOption(\"cellMouseUp\");\n\t\tthis.registerColumnOption(\"cellTap\");\n\t\tthis.registerColumnOption(\"cellDblTap\");\n\t\tthis.registerColumnOption(\"cellTapHold\");\n\n\t}\n\n\tinitialize(){\n\t\tthis.initializeExternalEvents();\n\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"cell-dblclick\", this.cellContentsSelectionFixer.bind(this));\n\t\tthis.subscribe(\"scroll-horizontal\", this.clearTouchWatchers.bind(this));\n\t\tthis.subscribe(\"scroll-vertical\", this.clearTouchWatchers.bind(this));\n\t}\n\n\tclearTouchWatchers(){\n\t\tvar types = Object.values(this.touchWatchers);\n\n\t\ttypes.forEach((type) => {\n\t\t\tfor(let key in type){\n\t\t\t\ttype[key] = null;\n\t\t\t}\n\t\t});\n\t}\n\t\t\n\tcellContentsSelectionFixer(e, cell){\n\t\tvar range;\n\n\t\tif(this.table.modExists(\"edit\")){\n\t\t\tif (this.table.modules.edit.currentCell === cell){\n\t\t\t\treturn; //prevent instant selection of editor content\n\t\t\t}\n\t\t}\n\n\t\te.preventDefault();\n\n\t\ttry{\n\t\t\tif (document.selection) { // IE\n\t\t\t\trange = document.body.createTextRange();\n\t\t\t\trange.moveToElementText(cell.getElement());\n\t\t\t\trange.select();\n\t\t\t} else if (window.getSelection) {\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.selectNode(cell.getElement());\n\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\twindow.getSelection().addRange(range);\n\t\t\t}\n\t\t}catch(e){}\n\t}\n\n\tinitializeExternalEvents(){\n\t\tfor(let key in this.eventMap){\n\t\t\tthis.subscriptionChangeExternal(key, this.subscriptionChanged.bind(this, key));\n\t\t}\n\t}\n\n\tsubscriptionChanged(key, added){\n\t\tif(added){\n\t\t\tif(!this.subscribers[key]){\n\t\t\t\tif(this.eventMap[key].includes(\"-\")){\n\t\t\t\t\tthis.subscribers[key] = this.handle.bind(this, key);\n\t\t\t\t\tthis.subscribe(this.eventMap[key], this.subscribers[key]);\n\t\t\t\t}else {\n\t\t\t\t\tthis.subscribeTouchEvents(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tif(this.eventMap[key].includes(\"-\")){\n\t\t\t\tif(this.subscribers[key] && !this.columnSubscribers[key]  && !this.subscribedExternal(key)){\n\t\t\t\t\tthis.unsubscribe(this.eventMap[key], this.subscribers[key]);\n\t\t\t\t\tdelete this.subscribers[key];\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.unsubscribeTouchEvents(key);\n\t\t\t}\n\t\t}\n\t}\n\n\n\tsubscribeTouchEvents(key){\n\t\tvar type = this.eventMap[key];\n\n\t\tif(!this.touchSubscribers[type + \"-touchstart\"]){\n\t\t\tthis.touchSubscribers[type + \"-touchstart\"] = this.handleTouch.bind(this, type, \"start\");\n\t\t\tthis.touchSubscribers[type + \"-touchend\"] = this.handleTouch.bind(this, type, \"end\");\n\n\t\t\tthis.subscribe(type + \"-touchstart\", this.touchSubscribers[type + \"-touchstart\"]);\n\t\t\tthis.subscribe(type + \"-touchend\", this.touchSubscribers[type + \"-touchend\"]);\n\t\t}\n\n\t\tthis.subscribers[key] = true;\n\t}\n\n\tunsubscribeTouchEvents(key){\n\t\tvar noTouch = true,\n\t\ttype = this.eventMap[key];\n\n\t\tif(this.subscribers[key] && !this.subscribedExternal(key)){\n\t\t\tdelete this.subscribers[key];\n\n\t\t\tfor(let i in this.eventMap){\n\t\t\t\tif(this.eventMap[i] === type){\n\t\t\t\t\tif(this.subscribers[i]){\n\t\t\t\t\t\tnoTouch = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(noTouch){\n\t\t\t\tthis.unsubscribe(type + \"-touchstart\", this.touchSubscribers[type + \"-touchstart\"]);\n\t\t\t\tthis.unsubscribe(type + \"-touchend\", this.touchSubscribers[type + \"-touchend\"]);\n\n\t\t\t\tdelete this.touchSubscribers[type + \"-touchstart\"];\n\t\t\t\tdelete this.touchSubscribers[type + \"-touchend\"];\n\t\t\t}\n\t\t}\n\t}\n\n\tinitializeColumn(column){\n\t\tvar def = column.definition;\n\n\t\tfor(let key in this.eventMap){\n\t\t\tif(def[key]){\n\t\t\t\tthis.subscriptionChanged(key, true);\n\n\t\t\t\tif(!this.columnSubscribers[key]){\n\t\t\t\t\tthis.columnSubscribers[key] = [];\n\t\t\t\t}\n\n\t\t\t\tthis.columnSubscribers[key].push(column);\n\t\t\t}\n\t\t}\n\t}\n\n\thandle(action, e, component){\n\t\tthis.dispatchEvent(action, e, component);\n\t}\n\n\thandleTouch(type, action, e, component){\n\t\tvar watchers = this.touchWatchers[type];\n\n\t\tif(type === \"column\"){\n\t\t\ttype = \"header\";\n\t\t}\n\n\t\tswitch(action){\n\t\t\tcase \"start\":\n\t\t\t\twatchers.tap = true;\n\n\t\t\t\tclearTimeout(watchers.tapHold);\n\n\t\t\t\twatchers.tapHold = setTimeout(() => {\n\t\t\t\t\tclearTimeout(watchers.tapHold);\n\t\t\t\t\twatchers.tapHold = null;\n\n\t\t\t\t\twatchers.tap = null;\n\t\t\t\t\tclearTimeout(watchers.tapDbl);\n\t\t\t\t\twatchers.tapDbl = null;\n\n\t\t\t\t\tthis.dispatchEvent(type + \"TapHold\", e,  component);\n\t\t\t\t}, 1000);\n\t\t\t\tbreak;\n\n\t\t\tcase \"end\":\n\t\t\t\tif(watchers.tap){\n\n\t\t\t\t\twatchers.tap = null;\n\t\t\t\t\tthis.dispatchEvent(type + \"Tap\", e,  component);\n\t\t\t\t}\n\n\t\t\t\tif(watchers.tapDbl){\n\t\t\t\t\tclearTimeout(watchers.tapDbl);\n\t\t\t\t\twatchers.tapDbl = null;\n\n\t\t\t\t\tthis.dispatchEvent(type + \"DblTap\", e,  component);\n\t\t\t\t}else {\n\t\t\t\t\twatchers.tapDbl = setTimeout(() => {\n\t\t\t\t\t\tclearTimeout(watchers.tapDbl);\n\t\t\t\t\t\twatchers.tapDbl = null;\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\n\t\t\t\tclearTimeout(watchers.tapHold);\n\t\t\t\twatchers.tapHold = null;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tdispatchEvent(action, e, component){\n\t\tvar componentObj = component.getComponent(),\n\t\tcallback;\n\n\t\tif(this.columnSubscribers[action]){\n\n\t\t\tif(component instanceof Cell){\n\t\t\t\tcallback = component.column.definition[action];\n\t\t\t}else if(component instanceof Column){\n\t\t\t\tcallback = component.definition[action];\n\t\t\t}\n\n\t\t\tif(callback){\n\t\t\t\tcallback(e, componentObj);\n\t\t\t}\n\t\t}\n\n\t\tthis.dispatchExternal(action, e, componentObj);\n\t}\n}\n\nvar defaultBindings = {\n\tnavPrev:\"shift + 9\",\n\tnavNext:9,\n\tnavUp:38,\n\tnavDown:40,\n\tnavLeft:37,\n\tnavRight:39,\n\tscrollPageUp:33,\n\tscrollPageDown:34,\n\tscrollToStart:36,\n\tscrollToEnd:35,\n};\n\nvar defaultActions = {\n\tkeyBlock:function(e){\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\n\tscrollPageUp:function(e){\n\t\tvar rowManager = this.table.rowManager,\n\t\tnewPos = rowManager.scrollTop - rowManager.element.clientHeight;\n\n\t\te.preventDefault();\n\n\t\tif(rowManager.displayRowsCount){\n\t\t\tif(newPos >= 0){\n\t\t\t\trowManager.element.scrollTop = newPos;\n\t\t\t}else {\n\t\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[0]);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\n\tscrollPageDown:function(e){\n\t\tvar rowManager = this.table.rowManager,\n\t\tnewPos = rowManager.scrollTop + rowManager.element.clientHeight,\n\t\tscrollMax = rowManager.element.scrollHeight;\n\n\t\te.preventDefault();\n\n\t\tif(rowManager.displayRowsCount){\n\t\t\tif(newPos <= scrollMax){\n\t\t\t\trowManager.element.scrollTop = newPos;\n\t\t\t}else {\n\t\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount - 1]);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.element.focus();\n\n\t},\n\n\tscrollToStart:function(e){\n\t\tvar rowManager = this.table.rowManager;\n\n\t\te.preventDefault();\n\n\t\tif(rowManager.displayRowsCount){\n\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[0]);\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\n\tscrollToEnd:function(e){\n\t\tvar rowManager = this.table.rowManager;\n\n\t\te.preventDefault();\n\n\t\tif(rowManager.displayRowsCount){\n\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount - 1]);\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\n\tnavPrev:function(e){\n\t\tthis.dispatch(\"keybinding-nav-prev\", e);\n\t},\n\n\tnavNext:function(e){\n\t\tthis.dispatch(\"keybinding-nav-next\", e);\n\t},\n\n\tnavLeft:function(e){\n\t\tthis.dispatch(\"keybinding-nav-left\", e);\n\t},\n\n\tnavRight:function(e){\n\t\tthis.dispatch(\"keybinding-nav-right\", e);\n\t},\n\n\tnavUp:function(e){\n\t\tthis.dispatch(\"keybinding-nav-up\", e);\n\t},\n\n\tnavDown:function(e){\n\t\tthis.dispatch(\"keybinding-nav-down\", e);\n\t},\n};\n\nclass Keybindings extends Module{\n\n\tstatic moduleName = \"keybindings\";\n\n\t//load defaults\n\tstatic bindings = defaultBindings;\n\tstatic actions = defaultActions;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.watchKeys = null;\n\t\tthis.pressedKeys = null;\n\t\tthis.keyupBinding = false;\n\t\tthis.keydownBinding = false;\n\n\t\tthis.registerTableOption(\"keybindings\", {}); //array for keybindings\n\t\tthis.registerTableOption(\"tabEndNewRow\", false); //create new row when tab to end of table\n\t}\n\n\tinitialize(){\n\t\tvar bindings = this.table.options.keybindings,\n\t\tmergedBindings = {};\n\n\t\tthis.watchKeys = {};\n\t\tthis.pressedKeys = [];\n\n\t\tif(bindings !== false){\n\t\t\tObject.assign(mergedBindings, Keybindings.bindings);\n\t\t\tObject.assign(mergedBindings, bindings);\n\n\t\t\tthis.mapBindings(mergedBindings);\n\t\t\tthis.bindEvents();\n\t\t}\n\n\t\tthis.subscribe(\"table-destroy\", this.clearBindings.bind(this));\n\t}\n\n\tmapBindings(bindings){\n\t\tfor(let key in bindings){\n\t\t\tif(Keybindings.actions[key]){\n\t\t\t\tif(bindings[key]){\n\t\t\t\t\tif(typeof bindings[key] !== \"object\"){\n\t\t\t\t\t\tbindings[key] = [bindings[key]];\n\t\t\t\t\t}\n\n\t\t\t\t\tbindings[key].forEach((binding) => {\n\t\t\t\t\t\tvar bindingList = Array.isArray(binding) ?  binding : [binding];\n\t\t\t\t\t\t\n\t\t\t\t\t\tbindingList.forEach((item) => {\n\t\t\t\t\t\t\tthis.mapBinding(key, item);\n\t\t\t\t\t\t});\t\t\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Key Binding Error - no such action:\", key);\n\t\t\t}\n\t\t}\n\t}\n\n\tmapBinding(action, symbolsList){\n\t\tvar binding = {\n\t\t\taction: Keybindings.actions[action],\n\t\t\tkeys: [],\n\t\t\tctrl: false,\n\t\t\tshift: false,\n\t\t\tmeta: false,\n\t\t};\n\n\t\tvar symbols = symbolsList.toString().toLowerCase().split(\" \").join(\"\").split(\"+\");\n\n\t\tsymbols.forEach((symbol) => {\n\t\t\tswitch(symbol){\n\t\t\t\tcase \"ctrl\":\n\t\t\t\t\tbinding.ctrl = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"shift\":\n\t\t\t\t\tbinding.shift = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"meta\":\n\t\t\t\t\tbinding.meta = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tsymbol = isNaN(symbol) ? symbol.toUpperCase().charCodeAt(0) : parseInt(symbol);\n\t\t\t\t\tbinding.keys.push(symbol);\n\n\t\t\t\t\tif(!this.watchKeys[symbol]){\n\t\t\t\t\t\tthis.watchKeys[symbol] = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.watchKeys[symbol].push(binding);\n\t\t\t}\n\t\t});\n\t}\n\n\tbindEvents(){\n\t\tvar self = this;\n\n\t\tthis.keyupBinding = function(e){\n\t\t\tvar code = e.keyCode;\n\t\t\tvar bindings = self.watchKeys[code];\n\n\t\t\tif(bindings){\n\n\t\t\t\tself.pressedKeys.push(code);\n\n\t\t\t\tbindings.forEach(function(binding){\n\t\t\t\t\tself.checkBinding(e, binding);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tthis.keydownBinding = function(e){\n\t\t\tvar code = e.keyCode;\n\t\t\tvar bindings = self.watchKeys[code];\n\n\t\t\tif(bindings){\n\n\t\t\t\tvar index = self.pressedKeys.indexOf(code);\n\n\t\t\t\tif(index > -1){\n\t\t\t\t\tself.pressedKeys.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.table.element.addEventListener(\"keydown\", this.keyupBinding);\n\n\t\tthis.table.element.addEventListener(\"keyup\", this.keydownBinding);\n\t}\n\n\tclearBindings(){\n\t\tif(this.keyupBinding){\n\t\t\tthis.table.element.removeEventListener(\"keydown\", this.keyupBinding);\n\t\t}\n\n\t\tif(this.keydownBinding){\n\t\t\tthis.table.element.removeEventListener(\"keyup\", this.keydownBinding);\n\t\t}\n\t}\n\n\tcheckBinding(e, binding){\n\t\tvar match = true;\n\n\t\tif(e.ctrlKey == binding.ctrl && e.shiftKey == binding.shift && e.metaKey == binding.meta){\n\t\t\tbinding.keys.forEach((key) => {\n\t\t\t\tvar index = this.pressedKeys.indexOf(key);\n\n\t\t\t\tif(index == -1){\n\t\t\t\t\tmatch = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(match){\n\t\t\t\tbinding.action.call(this, e);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nclass Menu extends Module{\n\n\tstatic moduleName = \"menu\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.menuContainer = null;\n\t\tthis.nestedMenuBlock = false;\n\t\t\n\t\tthis.currentComponent = null;\n\t\tthis.rootPopup = null;\n\t\t\n\t\tthis.columnSubscribers = {};\n\t\t\n\t\t// this.registerTableOption(\"menuContainer\", undefined); //deprecated\n\t\t\n\t\tthis.registerTableOption(\"rowContextMenu\", false);\n\t\tthis.registerTableOption(\"rowClickMenu\", false);\n\t\tthis.registerTableOption(\"rowDblClickMenu\", false);\n\t\tthis.registerTableOption(\"groupContextMenu\", false);\n\t\tthis.registerTableOption(\"groupClickMenu\", false);\n\t\tthis.registerTableOption(\"groupDblClickMenu\", false);\n\t\t\n\t\tthis.registerColumnOption(\"headerContextMenu\");\n\t\tthis.registerColumnOption(\"headerClickMenu\");\n\t\tthis.registerColumnOption(\"headerDblClickMenu\");\n\t\tthis.registerColumnOption(\"headerMenu\");\n\t\tthis.registerColumnOption(\"headerMenuIcon\");\n\t\tthis.registerColumnOption(\"contextMenu\");\n\t\tthis.registerColumnOption(\"clickMenu\");\n\t\tthis.registerColumnOption(\"dblClickMenu\");\n\t\t\n\t}\n\t\n\tinitialize(){\n\t\tthis.deprecatedOptionsCheck();\n\t\tthis.initializeRowWatchers();\n\t\tthis.initializeGroupWatchers();\n\t\t\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t}\n\t\n\tdeprecatedOptionsCheck(){\n\t\t// if(!this.deprecationCheck(\"menuContainer\", \"popupContainer\")){\n\t\t// \tthis.table.options.popupContainer = this.table.options.menuContainer;\n\t\t// }\n\t}\t\n\t\n\tinitializeRowWatchers(){\n\t\tif(this.table.options.rowContextMenu){\n\t\t\tthis.subscribe(\"row-contextmenu\", this.loadMenuEvent.bind(this, this.table.options.rowContextMenu));\n\t\t\tthis.table.on(\"rowTapHold\", this.loadMenuEvent.bind(this, this.table.options.rowContextMenu));\n\t\t}\n\t\t\n\t\tif(this.table.options.rowClickMenu){\n\t\t\tthis.subscribe(\"row-click\", this.loadMenuEvent.bind(this, this.table.options.rowClickMenu));\n\t\t}\n\t\t\n\t\tif(this.table.options.rowDblClickMenu){\n\t\t\tthis.subscribe(\"row-dblclick\", this.loadMenuEvent.bind(this, this.table.options.rowDblClickMenu));\n\t\t}\n\t}\n\t\n\tinitializeGroupWatchers(){\n\t\tif(this.table.options.groupContextMenu){\n\t\t\tthis.subscribe(\"group-contextmenu\", this.loadMenuEvent.bind(this, this.table.options.groupContextMenu));\n\t\t\tthis.table.on(\"groupTapHold\", this.loadMenuEvent.bind(this, this.table.options.groupContextMenu));\n\t\t}\n\t\t\n\t\tif(this.table.options.groupClickMenu){\n\t\t\tthis.subscribe(\"group-click\", this.loadMenuEvent.bind(this, this.table.options.groupClickMenu));\n\t\t}\n\t\t\n\t\tif(this.table.options.groupDblClickMenu){\n\t\t\tthis.subscribe(\"group-dblclick\", this.loadMenuEvent.bind(this, this.table.options.groupDblClickMenu));\n\t\t}\n\t}\n\n\tinitializeColumn(column){\n\t\tvar\tdef = column.definition;\n\t\t\n\t\t//handle column events\n\t\tif(def.headerContextMenu && !this.columnSubscribers.headerContextMenu){\n\t\t\tthis.columnSubscribers.headerContextMenu = this.loadMenuTableColumnEvent.bind(this, \"headerContextMenu\");\n\t\t\tthis.subscribe(\"column-contextmenu\", this.columnSubscribers.headerContextMenu);\n\t\t\tthis.table.on(\"headerTapHold\", this.loadMenuTableColumnEvent.bind(this, \"headerContextMenu\"));\n\t\t}\n\t\t\n\t\tif(def.headerClickMenu && !this.columnSubscribers.headerClickMenu){\n\t\t\tthis.columnSubscribers.headerClickMenu = this.loadMenuTableColumnEvent.bind(this, \"headerClickMenu\");\n\t\t\tthis.subscribe(\"column-click\", this.columnSubscribers.headerClickMenu);\n\t\t}\n\t\t\n\t\tif(def.headerDblClickMenu && !this.columnSubscribers.headerDblClickMenu){\n\t\t\tthis.columnSubscribers.headerDblClickMenu = this.loadMenuTableColumnEvent.bind(this, \"headerDblClickMenu\");\n\t\t\tthis.subscribe(\"column-dblclick\", this.columnSubscribers.headerDblClickMenu);\n\t\t}\n\t\t\n\t\tif(def.headerMenu){\n\t\t\tthis.initializeColumnHeaderMenu(column);\n\t\t}\n\t\t\n\t\t//handle cell events\n\t\tif(def.contextMenu && !this.columnSubscribers.contextMenu){\n\t\t\tthis.columnSubscribers.contextMenu = this.loadMenuTableCellEvent.bind(this, \"contextMenu\");\n\t\t\tthis.subscribe(\"cell-contextmenu\", this.columnSubscribers.contextMenu);\n\t\t\tthis.table.on(\"cellTapHold\", this.loadMenuTableCellEvent.bind(this, \"contextMenu\"));\n\t\t}\n\t\t\n\t\tif(def.clickMenu && !this.columnSubscribers.clickMenu){\n\t\t\tthis.columnSubscribers.clickMenu = this.loadMenuTableCellEvent.bind(this, \"clickMenu\");\n\t\t\tthis.subscribe(\"cell-click\", this.columnSubscribers.clickMenu);\n\t\t}\n\t\t\n\t\tif(def.dblClickMenu && !this.columnSubscribers.dblClickMenu){\n\t\t\tthis.columnSubscribers.dblClickMenu = this.loadMenuTableCellEvent.bind(this, \"dblClickMenu\");\n\t\t\tthis.subscribe(\"cell-dblclick\", this.columnSubscribers.dblClickMenu);\n\t\t}\n\t}\n\t\n\tinitializeColumnHeaderMenu(column){\n\t\tvar icon = column.definition.headerMenuIcon,\n\t\theaderMenuEl;\n\t\t\n\t\theaderMenuEl = document.createElement(\"span\");\n\t\theaderMenuEl.classList.add(\"tabulator-header-popup-button\");\n\t\t\n\t\tif(icon){\n\t\t\tif(typeof icon === \"function\"){\n\t\t\t\ticon = icon(column.getComponent());\n\t\t\t}\n\t\t\t\n\t\t\tif(icon instanceof HTMLElement){\n\t\t\t\theaderMenuEl.appendChild(icon);\n\t\t\t}else {\n\t\t\t\theaderMenuEl.innerHTML = icon;\n\t\t\t}\n\t\t}else {\n\t\t\theaderMenuEl.innerHTML = \"&vellip;\";\n\t\t}\n\t\t\n\t\theaderMenuEl.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tthis.loadMenuEvent(column.definition.headerMenu, e, column);\n\t\t});\n\t\t\n\t\tcolumn.titleElement.insertBefore(headerMenuEl, column.titleElement.firstChild);\n\t}\n\t\n\tloadMenuTableCellEvent(option, e, cell){\n\t\tif(cell._cell){\n\t\t\tcell = cell._cell;\n\t\t}\n\t\t\n\t\tif(cell.column.definition[option]){\n\t\t\tthis.loadMenuEvent(cell.column.definition[option], e, cell);\n\t\t}\n\t}\n\t\n\tloadMenuTableColumnEvent(option, e, column){\n\t\tif(column._column){\n\t\t\tcolumn = column._column;\n\t\t}\n\t\t\n\t\tif(column.definition[option]){\n\t\t\tthis.loadMenuEvent(column.definition[option], e, column);\n\t\t}\n\t}\n\t\n\tloadMenuEvent(menu, e, component){\n\t\tif(component._group){\n\t\t\tcomponent = component._group;\n\t\t}else if(component._row){\n\t\t\tcomponent = component._row;\n\t\t}\n\t\t\n\t\tmenu = typeof menu == \"function\" ? menu.call(this.table, e, component.getComponent()) : menu;\n\t\t\n\t\tthis.loadMenu(e, component, menu);\n\t}\n\t\n\tloadMenu(e, component, menu, parentEl, parentPopup){\n\t\tvar touch = !(e instanceof MouseEvent),\t\t\n\t\tmenuEl = document.createElement(\"div\"),\n\t\tpopup;\n\t\t\n\t\tmenuEl.classList.add(\"tabulator-menu\");\n\t\t\n\t\tif(!touch){\n\t\t\te.preventDefault();\n\t\t}\n\t\t\n\t\t//abort if no menu set\n\t\tif(!menu || !menu.length){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif(!parentEl){\n\t\t\tif(this.nestedMenuBlock){\n\t\t\t\t//abort if child menu already open\n\t\t\t\tif(this.rootPopup){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.nestedMenuBlock = setTimeout(() => {\n\t\t\t\t\tthis.nestedMenuBlock = false;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.rootPopup){\n\t\t\t\tthis.rootPopup.hide();\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.rootPopup = popup = this.popup(menuEl);\n\t\t\t\n\t\t}else {\n\t\t\tpopup = parentPopup.child(menuEl);\n\t\t}\n\t\t\n\t\tmenu.forEach((item) => {\n\t\t\tvar itemEl = document.createElement(\"div\"),\n\t\t\tlabel = item.label,\n\t\t\tdisabled = item.disabled;\n\t\t\t\n\t\t\tif(item.separator){\n\t\t\t\titemEl.classList.add(\"tabulator-menu-separator\");\n\t\t\t}else {\n\t\t\t\titemEl.classList.add(\"tabulator-menu-item\");\n\t\t\t\t\n\t\t\t\tif(typeof label == \"function\"){\n\t\t\t\t\tlabel = label.call(this.table, component.getComponent());\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(label instanceof Node){\n\t\t\t\t\titemEl.appendChild(label);\n\t\t\t\t}else {\n\t\t\t\t\titemEl.innerHTML = label;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(typeof disabled == \"function\"){\n\t\t\t\t\tdisabled = disabled.call(this.table, component.getComponent());\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(disabled){\n\t\t\t\t\titemEl.classList.add(\"tabulator-menu-item-disabled\");\n\t\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tif(item.menu && item.menu.length){\n\t\t\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tthis.loadMenu(e, component, item.menu, itemEl, popup);\n\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(item.action){\n\t\t\t\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\t\t\titem.action(e, component.getComponent());\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(item.menu && item.menu.length){\n\t\t\t\t\titemEl.classList.add(\"tabulator-menu-item-submenu\");\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tmenuEl.appendChild(itemEl);\n\t\t});\n\t\t\n\t\tmenuEl.addEventListener(\"click\", (e) => {\n\t\t\tif(this.rootPopup){\n\t\t\t\tthis.rootPopup.hide();\n\t\t\t}\n\t\t});\n\t\t\n\t\tpopup.show(parentEl || e);\n\t\t\n\t\tif(popup === this.rootPopup){\n\t\t\tthis.rootPopup.hideOnBlur(() => {\n\t\t\t\tthis.rootPopup = null;\n\t\t\t\t\n\t\t\t\tif(this.currentComponent){\n\t\t\t\t\tthis.dispatch(\"menu-closed\", menu, popup);\n\t\t\t\t\tthis.dispatchExternal(\"menuClosed\", this.currentComponent.getComponent());\n\t\t\t\t\tthis.currentComponent = null;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.currentComponent = component;\n\t\t\t\n\t\t\tthis.dispatch(\"menu-opened\", menu, popup);\n\t\t\tthis.dispatchExternal(\"menuOpened\", component.getComponent());\n\t\t}\n\t}\n}\n\nclass MoveColumns extends Module{\n\n\tstatic moduleName = \"moveColumn\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.placeholderElement = this.createPlaceholderElement();\n\t\tthis.hoverElement = false; //floating column header element\n\t\tthis.checkTimeout = false; //click check timeout holder\n\t\tthis.checkPeriod = 250; //period to wait on mousedown to consider this a move and not a click\n\t\tthis.moving = false; //currently moving column\n\t\tthis.toCol = false; //destination column\n\t\tthis.toColAfter = false; //position of moving column relative to the destination column\n\t\tthis.startX = 0; //starting position within header element\n\t\tthis.autoScrollMargin = 40; //auto scroll on edge when within margin\n\t\tthis.autoScrollStep = 5; //auto scroll distance in pixels\n\t\tthis.autoScrollTimeout = false; //auto scroll timeout\n\t\tthis.touchMove = false;\n\t\t\n\t\tthis.moveHover = this.moveHover.bind(this);\n\t\tthis.endMove = this.endMove.bind(this);\n\t\t\n\t\tthis.registerTableOption(\"movableColumns\", false); //enable movable columns\n\t}\n\t\n\tcreatePlaceholderElement(){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-col\");\n\t\tel.classList.add(\"tabulator-col-placeholder\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tinitialize(){\n\t\tif(this.table.options.movableColumns){\n\t\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\t\tthis.subscribe(\"alert-show\", this.abortMove.bind(this));\n\t\t}\n\t}\n\n\tabortMove(){\n\t\tclearTimeout(this.checkTimeout);\n\t}\n\t\n\tinitializeColumn(column){\n\t\tvar self = this,\n\t\tconfig = {},\n\t\tcolEl;\n\n\t\tif(!column.modules.frozen && !column.isGroup && !column.isRowHeader){\n\t\t\tcolEl = column.getElement();\n\t\t\t\n\t\t\tconfig.mousemove = function(e){\n\t\t\t\tif(column.parent === self.moving.parent){\n\t\t\t\t\tif((((self.touchMove ? e.touches[0].pageX : e.pageX) - Helpers.elOffset(colEl).left) + self.table.columnManager.contentsElement.scrollLeft) > (column.getWidth() / 2)){\n\t\t\t\t\t\tif(self.toCol !== column || !self.toColAfter){\n\t\t\t\t\t\t\tcolEl.parentNode.insertBefore(self.placeholderElement, colEl.nextSibling);\n\t\t\t\t\t\t\tself.moveColumn(column, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(self.toCol !== column || self.toColAfter){\n\t\t\t\t\t\t\tcolEl.parentNode.insertBefore(self.placeholderElement, colEl);\n\t\t\t\t\t\t\tself.moveColumn(column, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(self);\n\t\t\t\n\t\t\tcolEl.addEventListener(\"mousedown\", function(e){\n\t\t\t\tself.touchMove = false;\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tself.checkTimeout = setTimeout(function(){\n\t\t\t\t\t\tself.startMove(e, column);\n\t\t\t\t\t}, self.checkPeriod);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tcolEl.addEventListener(\"mouseup\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tif(self.checkTimeout){\n\t\t\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tself.bindTouchEvents(column);\n\t\t}\n\t\t\n\t\tcolumn.modules.moveColumn = config;\n\t}\n\t\n\tbindTouchEvents(column){\n\t\tvar colEl = column.getElement(),\n\t\tstartXMove = false, //shifting center position of the cell\n\t\tnextCol, prevCol, nextColWidth, prevColWidth, nextColWidthLast, prevColWidthLast;\n\t\t\n\t\tcolEl.addEventListener(\"touchstart\", (e) => {\n\t\t\tthis.checkTimeout = setTimeout(() => {\n\t\t\t\tthis.touchMove = true;\n\t\t\t\tnextCol = column.nextColumn();\n\t\t\t\tnextColWidth = nextCol ? nextCol.getWidth()/2 : 0;\n\t\t\t\tprevCol = column.prevColumn();\n\t\t\t\tprevColWidth = prevCol ? prevCol.getWidth()/2 : 0;\n\t\t\t\tnextColWidthLast = 0;\n\t\t\t\tprevColWidthLast = 0;\n\t\t\t\tstartXMove = false;\n\t\t\t\t\n\t\t\t\tthis.startMove(e, column);\n\t\t\t}, this.checkPeriod);\n\t\t}, {passive: true});\n\t\t\n\t\tcolEl.addEventListener(\"touchmove\", (e) => {\n\t\t\tvar diff, moveToCol;\n\t\t\t\n\t\t\tif(this.moving){\n\t\t\t\tthis.moveHover(e);\n\t\t\t\t\n\t\t\t\tif(!startXMove){\n\t\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdiff = e.touches[0].pageX - startXMove;\n\t\t\t\t\n\t\t\t\tif(diff > 0){\n\t\t\t\t\tif(nextCol && diff - nextColWidthLast > nextColWidth){\n\t\t\t\t\t\tmoveToCol = nextCol;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(moveToCol !== column){\n\t\t\t\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t\t\t\t\tmoveToCol.getElement().parentNode.insertBefore(this.placeholderElement, moveToCol.getElement().nextSibling);\n\t\t\t\t\t\t\tthis.moveColumn(moveToCol, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tif(prevCol && -diff - prevColWidthLast >  prevColWidth){\n\t\t\t\t\t\tmoveToCol = prevCol;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(moveToCol !== column){\n\t\t\t\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t\t\t\t\tmoveToCol.getElement().parentNode.insertBefore(this.placeholderElement, moveToCol.getElement());\n\t\t\t\t\t\t\tthis.moveColumn(moveToCol, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(moveToCol){\n\t\t\t\t\tnextCol = moveToCol.nextColumn();\n\t\t\t\t\tnextColWidthLast = nextColWidth;\n\t\t\t\t\tnextColWidth = nextCol ? nextCol.getWidth() / 2 : 0;\n\t\t\t\t\tprevCol = moveToCol.prevColumn();\n\t\t\t\t\tprevColWidthLast = prevColWidth;\n\t\t\t\t\tprevColWidth = prevCol ? prevCol.getWidth() / 2 : 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {passive: true});\n\t\t\n\t\tcolEl.addEventListener(\"touchend\", (e) => {\n\t\t\tif(this.checkTimeout){\n\t\t\t\tclearTimeout(this.checkTimeout);\n\t\t\t}\n\t\t\tif(this.moving){\n\t\t\t\tthis.endMove(e);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tstartMove(e, column){\n\t\tvar element = column.getElement(),\n\t\theaderElement = this.table.columnManager.getContentsElement(),\n\t\theadersElement = this.table.columnManager.getHeadersElement();\n\t\t\n\t\t//Prevent moving columns when range selection is active\n\t\tif(this.table.modules.selectRange && this.table.modules.selectRange.columnSelection){\n\t\t\tif(this.table.modules.selectRange.mousedown && this.table.modules.selectRange.selecting === \"column\"){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.moving = column;\n\t\tthis.startX = (this.touchMove ? e.touches[0].pageX : e.pageX) - Helpers.elOffset(element).left;\n\t\t\n\t\tthis.table.element.classList.add(\"tabulator-block-select\");\n\t\t\n\t\t//create placeholder\n\t\tthis.placeholderElement.style.width = column.getWidth() + \"px\";\n\t\tthis.placeholderElement.style.height = column.getHeight() + \"px\";\n\t\t\n\t\telement.parentNode.insertBefore(this.placeholderElement, element);\n\t\telement.parentNode.removeChild(element);\n\t\t\n\t\t//create hover element\n\t\tthis.hoverElement = element.cloneNode(true);\n\t\tthis.hoverElement.classList.add(\"tabulator-moving\");\n\t\t\n\t\theaderElement.appendChild(this.hoverElement);\n\t\t\n\t\tthis.hoverElement.style.left = \"0\";\n\t\tthis.hoverElement.style.bottom = (headerElement.clientHeight - headersElement.offsetHeight) + \"px\";\n\t\t\n\t\tif(!this.touchMove){\n\t\t\tthis._bindMouseMove();\n\t\t\t\n\t\t\tdocument.body.addEventListener(\"mousemove\", this.moveHover);\n\t\t\tdocument.body.addEventListener(\"mouseup\", this.endMove);\n\t\t}\n\t\t\n\t\tthis.moveHover(e);\n\n\t\tthis.dispatch(\"column-moving\", e, this.moving);\n\t}\n\t\n\t_bindMouseMove(){\n\t\tthis.table.columnManager.columnsByIndex.forEach(function(column){\n\t\t\tif(column.modules.moveColumn.mousemove){\n\t\t\t\tcolumn.getElement().addEventListener(\"mousemove\", column.modules.moveColumn.mousemove);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t_unbindMouseMove(){\n\t\tthis.table.columnManager.columnsByIndex.forEach(function(column){\n\t\t\tif(column.modules.moveColumn.mousemove){\n\t\t\t\tcolumn.getElement().removeEventListener(\"mousemove\", column.modules.moveColumn.mousemove);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tmoveColumn(column, after){\n\t\tvar movingCells = this.moving.getCells();\n\t\t\n\t\tthis.toCol = column;\n\t\tthis.toColAfter = after;\n\t\t\n\t\tif(after){\n\t\t\tcolumn.getCells().forEach(function(cell, i){\n\t\t\t\tvar cellEl = cell.getElement(true);\n\t\t\t\t\n\t\t\t\tif(cellEl.parentNode && movingCells[i]){\n\t\t\t\t\tcellEl.parentNode.insertBefore(movingCells[i].getElement(), cellEl.nextSibling);\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\tcolumn.getCells().forEach(function(cell, i){\n\t\t\t\tvar cellEl = cell.getElement(true);\n\t\t\t\t\n\t\t\t\tif(cellEl.parentNode && movingCells[i]){\n\t\t\t\t\tcellEl.parentNode.insertBefore(movingCells[i].getElement(), cellEl);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\t\n\tendMove(e){\n\t\tif(e.which === 1 || this.touchMove){\n\t\t\tthis._unbindMouseMove();\n\t\t\t\n\t\t\tthis.placeholderElement.parentNode.insertBefore(this.moving.getElement(), this.placeholderElement.nextSibling);\n\t\t\tthis.placeholderElement.parentNode.removeChild(this.placeholderElement);\n\t\t\tthis.hoverElement.parentNode.removeChild(this.hoverElement);\n\t\t\t\n\t\t\tthis.table.element.classList.remove(\"tabulator-block-select\");\n\t\t\t\n\t\t\tif(this.toCol){\n\t\t\t\tthis.table.columnManager.moveColumnActual(this.moving, this.toCol, this.toColAfter);\n\t\t\t}\n\n\t\t\tthis.moving = false;\n\t\t\tthis.toCol = false;\n\t\t\tthis.toColAfter = false;\n\t\t\t\n\t\t\tif(!this.touchMove){\n\t\t\t\tdocument.body.removeEventListener(\"mousemove\", this.moveHover);\n\t\t\t\tdocument.body.removeEventListener(\"mouseup\", this.endMove);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tmoveHover(e){\n\t\tvar columnHolder = this.table.columnManager.getContentsElement(),\n\t\tscrollLeft = columnHolder.scrollLeft,\n\t\txPos = ((this.touchMove ? e.touches[0].pageX : e.pageX) - Helpers.elOffset(columnHolder).left) + scrollLeft,\n\t\tscrollPos;\n\t\t\n\t\tthis.hoverElement.style.left = (xPos - this.startX) + \"px\";\n\t\t\n\t\tif(xPos - scrollLeft < this.autoScrollMargin){\n\t\t\tif(!this.autoScrollTimeout){\n\t\t\t\tthis.autoScrollTimeout = setTimeout(() => {\n\t\t\t\t\tscrollPos = Math.max(0,scrollLeft-5);\n\t\t\t\t\tthis.table.rowManager.getElement().scrollLeft = scrollPos;\n\t\t\t\t\tthis.autoScrollTimeout = false;\n\t\t\t\t}, 1);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(scrollLeft + columnHolder.clientWidth - xPos < this.autoScrollMargin){\n\t\t\tif(!this.autoScrollTimeout){\n\t\t\t\tthis.autoScrollTimeout = setTimeout(() => {\n\t\t\t\t\tscrollPos = Math.min(columnHolder.clientWidth, scrollLeft+5);\n\t\t\t\t\tthis.table.rowManager.getElement().scrollLeft = scrollPos;\n\t\t\t\t\tthis.autoScrollTimeout = false;\n\t\t\t\t}, 1);\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar defaultSenders = {\r\n\tdelete:function(fromRow, toRow, toTable){\r\n\t\tfromRow.delete();\r\n\t}\r\n};\n\nvar defaultReceivers = {\r\n\tinsert:function(fromRow, toRow, fromTable){\r\n\t\tthis.table.addRow(fromRow.getData(), undefined, toRow);\r\n\t\treturn true;\r\n\t},\r\n\r\n\tadd:function(fromRow, toRow, fromTable){\r\n\t\tthis.table.addRow(fromRow.getData());\r\n\t\treturn true;\r\n\t},\r\n\r\n\tupdate:function(fromRow, toRow, fromTable){\r\n\t\tif(toRow){\r\n\t\t\ttoRow.update(fromRow.getData());\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\r\n\treplace:function(fromRow, toRow, fromTable){\r\n\t\tif(toRow){\r\n\t\t\tthis.table.addRow(fromRow.getData(), undefined, toRow);\r\n\t\t\ttoRow.delete();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n};\n\nclass MoveRows extends Module{\n\n\tstatic moduleName = \"moveRow\";\n\n\t//load defaults\n\tstatic senders = defaultSenders;\n\tstatic receivers = defaultReceivers;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.placeholderElement = this.createPlaceholderElement();\n\t\tthis.hoverElement = false; //floating row header element\n\t\tthis.checkTimeout = false; //click check timeout holder\n\t\tthis.checkPeriod = 150; //period to wait on mousedown to consider this a move and not a click\n\t\tthis.moving = false; //currently moving row\n\t\tthis.toRow = false; //destination row\n\t\tthis.toRowAfter = false; //position of moving row relative to the destination row\n\t\tthis.hasHandle = false; //row has handle instead of fully movable row\n\t\tthis.startY = 0; //starting Y position within header element\n\t\tthis.startX = 0; //starting X position within header element\n\n\t\tthis.moveHover = this.moveHover.bind(this);\n\t\tthis.endMove = this.endMove.bind(this);\n\t\tthis.tableRowDropEvent = false;\n\n\t\tthis.touchMove = false;\n\n\t\tthis.connection = false;\n\t\tthis.connectionSelectorsTables = false;\n\t\tthis.connectionSelectorsElements = false;\n\t\tthis.connectionElements = [];\n\t\tthis.connections = [];\n\n\t\tthis.connectedTable = false;\n\t\tthis.connectedRow = false;\n\n\t\tthis.registerTableOption(\"movableRows\", false); //enable movable rows\n\t\tthis.registerTableOption(\"movableRowsConnectedTables\", false); //tables for movable rows to be connected to\n\t\tthis.registerTableOption(\"movableRowsConnectedElements\", false); //other elements for movable rows to be connected to\n\t\tthis.registerTableOption(\"movableRowsSender\", false);\n\t\tthis.registerTableOption(\"movableRowsReceiver\", \"insert\");\n\n\t\tthis.registerColumnOption(\"rowHandle\");\n\t}\n\n\tcreatePlaceholderElement(){\n\t\tvar el = document.createElement(\"div\");\n\n\t\tel.classList.add(\"tabulator-row\");\n\t\tel.classList.add(\"tabulator-row-placeholder\");\n\n\t\treturn el;\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.movableRows){\n\t\t\tthis.connectionSelectorsTables = this.table.options.movableRowsConnectedTables;\n\t\t\tthis.connectionSelectorsElements = this.table.options.movableRowsConnectedElements;\n\n\t\t\tthis.connection = this.connectionSelectorsTables || this.connectionSelectorsElements;\n\n\t\t\tthis.subscribe(\"cell-init\", this.initializeCell.bind(this));\n\t\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\t\tthis.subscribe(\"row-init\", this.initializeRow.bind(this));\n\t\t}\n\t}\n\n\tinitializeGroupHeader(group){\n\t\tvar self = this,\n\t\tconfig = {};\n\n\t\t//inter table drag drop\n\t\tconfig.mouseup = function(e){\n\t\t\tself.tableRowDrop(e, group);\n\t\t}.bind(self);\n\n\t\t//same table drag drop\n\t\tconfig.mousemove = function(e){\n\t\t\tvar rowEl;\n\n\t\t\tif(((e.pageY - Helpers.elOffset(group.element).top) + self.table.rowManager.element.scrollTop) > (group.getHeight() / 2)){\n\t\t\t\tif(self.toRow !== group || !self.toRowAfter){\n\t\t\t\t\trowEl = group.getElement();\n\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl.nextSibling);\n\t\t\t\t\tself.moveRow(group, true);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(self.toRow !== group || self.toRowAfter){\n\t\t\t\t\trowEl = group.getElement();\n\t\t\t\t\tif(rowEl.previousSibling){\n\t\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl);\n\t\t\t\t\t\tself.moveRow(group, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(self);\n\n\t\tgroup.modules.moveRow = config;\n\t}\n\n\tinitializeRow(row){\n\t\tvar self = this,\n\t\tconfig = {},\n\t\trowEl;\n\n\t\t//inter table drag drop\n\t\tconfig.mouseup = function(e){\n\t\t\tself.tableRowDrop(e, row);\n\t\t}.bind(self);\n\n\t\t//same table drag drop\n\t\tconfig.mousemove = function(e){\n\t\t\tvar rowEl = row.getElement();\n\n\t\t\tif(((e.pageY - Helpers.elOffset(rowEl).top) + self.table.rowManager.element.scrollTop) > (row.getHeight() / 2)){\n\t\t\t\tif(self.toRow !== row || !self.toRowAfter){\n\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl.nextSibling);\n\t\t\t\t\tself.moveRow(row, true);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(self.toRow !== row || self.toRowAfter){\n\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl);\n\t\t\t\t\tself.moveRow(row, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(self);\n\n\n\t\tif(!this.hasHandle){\n\n\t\t\trowEl = row.getElement();\n\n\t\t\trowEl.addEventListener(\"mousedown\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tself.checkTimeout = setTimeout(function(){\n\t\t\t\t\t\tself.startMove(e, row);\n\t\t\t\t\t}, self.checkPeriod);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trowEl.addEventListener(\"mouseup\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tif(self.checkTimeout){\n\t\t\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bindTouchEvents(row, row.getElement());\n\t\t}\n\n\t\trow.modules.moveRow = config;\n\t}\n\n\tinitializeColumn(column){\n\t\tif(column.definition.rowHandle && this.table.options.movableRows !== false){\n\t\t\tthis.hasHandle = true;\n\t\t}\n\t}\n\n\tinitializeCell(cell){\n\t\tif(cell.column.definition.rowHandle && this.table.options.movableRows !== false){\n\t\t\tvar self = this,\n\t\t\tcellEl = cell.getElement(true);\n\n\t\t\tcellEl.addEventListener(\"mousedown\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tself.checkTimeout = setTimeout(function(){\n\t\t\t\t\t\tself.startMove(e, cell.row);\n\t\t\t\t\t}, self.checkPeriod);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tcellEl.addEventListener(\"mouseup\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tif(self.checkTimeout){\n\t\t\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bindTouchEvents(cell.row, cellEl);\n\t\t}\n\t}\n\n\tbindTouchEvents(row, element){\n\t\tvar startYMove = false, //shifting center position of the cell\n\t\tnextRow, prevRow, nextRowHeight, prevRowHeight, nextRowHeightLast, prevRowHeightLast;\n\n\t\telement.addEventListener(\"touchstart\", (e) => {\n\t\t\tthis.checkTimeout = setTimeout(() => {\n\t\t\t\tthis.touchMove = true;\n\t\t\t\tnextRow = row.nextRow();\n\t\t\t\tnextRowHeight = nextRow ? nextRow.getHeight()/2 : 0;\n\t\t\t\tprevRow = row.prevRow();\n\t\t\t\tprevRowHeight = prevRow ? prevRow.getHeight()/2 : 0;\n\t\t\t\tnextRowHeightLast = 0;\n\t\t\t\tprevRowHeightLast = 0;\n\t\t\t\tstartYMove = false;\n\n\t\t\t\tthis.startMove(e, row);\n\t\t\t}, this.checkPeriod);\n\t\t}, {passive: true});\n\t\tthis.moving, this.toRow, this.toRowAfter;\n\t\telement.addEventListener(\"touchmove\", (e) => {\n\n\t\t\tvar diff, moveToRow;\n\n\t\t\tif(this.moving){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tthis.moveHover(e);\n\n\t\t\t\tif(!startYMove){\n\t\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t\t}\n\n\t\t\t\tdiff = e.touches[0].pageY - startYMove;\n\n\t\t\t\tif(diff > 0){\n\t\t\t\t\tif(nextRow && diff - nextRowHeightLast > nextRowHeight){\n\t\t\t\t\t\tmoveToRow = nextRow;\n\n\t\t\t\t\t\tif(moveToRow !== row){\n\t\t\t\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t\t\t\t\tmoveToRow.getElement().parentNode.insertBefore(this.placeholderElement, moveToRow.getElement().nextSibling);\n\t\t\t\t\t\t\tthis.moveRow(moveToRow, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tif(prevRow && -diff - prevRowHeightLast >  prevRowHeight){\n\t\t\t\t\t\tmoveToRow = prevRow;\n\n\t\t\t\t\t\tif(moveToRow !== row){\n\t\t\t\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t\t\t\t\tmoveToRow.getElement().parentNode.insertBefore(this.placeholderElement, moveToRow.getElement());\n\t\t\t\t\t\t\tthis.moveRow(moveToRow, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(moveToRow){\n\t\t\t\t\tnextRow = moveToRow.nextRow();\n\t\t\t\t\tnextRowHeightLast = nextRowHeight;\n\t\t\t\t\tnextRowHeight = nextRow ? nextRow.getHeight() / 2 : 0;\n\t\t\t\t\tprevRow = moveToRow.prevRow();\n\t\t\t\t\tprevRowHeightLast = prevRowHeight;\n\t\t\t\t\tprevRowHeight = prevRow ? prevRow.getHeight() / 2 : 0;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener(\"touchend\", (e) => {\n\t\t\tif(this.checkTimeout){\n\t\t\t\tclearTimeout(this.checkTimeout);\n\t\t\t}\n\t\t\tif(this.moving){\n\t\t\t\tthis.endMove(e);\n\t\t\t\tthis.touchMove = false;\n\t\t\t}\n\t\t});\n\t}\n\n\t_bindMouseMove(){\n\t\tthis.table.rowManager.getDisplayRows().forEach((row) => {\n\t\t\tif((row.type === \"row\" || row.type === \"group\") && row.modules.moveRow && row.modules.moveRow.mousemove){\n\t\t\t\trow.getElement().addEventListener(\"mousemove\", row.modules.moveRow.mousemove);\n\t\t\t}\n\t\t});\n\t}\n\n\t_unbindMouseMove(){\n\t\tthis.table.rowManager.getDisplayRows().forEach((row) => {\n\t\t\tif((row.type === \"row\" || row.type === \"group\") && row.modules.moveRow && row.modules.moveRow.mousemove){\n\t\t\t\trow.getElement().removeEventListener(\"mousemove\", row.modules.moveRow.mousemove);\n\t\t\t}\n\t\t});\n\t}\n\n\tstartMove(e, row){\n\t\tvar element = row.getElement();\n\n\t\tthis.setStartPosition(e, row);\n\n\t\tthis.moving = row;\n\n\t\tthis.table.element.classList.add(\"tabulator-block-select\");\n\n\t\t//create placeholder\n\t\tthis.placeholderElement.style.width = row.getWidth() + \"px\";\n\t\tthis.placeholderElement.style.height = row.getHeight() + \"px\";\n\n\t\tif(!this.connection){\n\t\t\telement.parentNode.insertBefore(this.placeholderElement, element);\n\t\t\telement.parentNode.removeChild(element);\n\t\t}else {\n\t\t\tthis.table.element.classList.add(\"tabulator-movingrow-sending\");\n\t\t\tthis.connectToTables(row);\n\t\t}\n\n\t\t//create hover element\n\t\tthis.hoverElement = element.cloneNode(true);\n\t\tthis.hoverElement.classList.add(\"tabulator-moving\");\n\n\t\tif(this.connection){\n\t\t\tdocument.body.appendChild(this.hoverElement);\n\t\t\tthis.hoverElement.style.left = \"0\";\n\t\t\tthis.hoverElement.style.top = \"0\";\n\t\t\tthis.hoverElement.style.width = this.table.element.clientWidth + \"px\";\n\t\t\tthis.hoverElement.style.whiteSpace = \"nowrap\";\n\t\t\tthis.hoverElement.style.overflow = \"hidden\";\n\t\t\tthis.hoverElement.style.pointerEvents = \"none\";\n\t\t}else {\n\t\t\tthis.table.rowManager.getTableElement().appendChild(this.hoverElement);\n\n\t\t\tthis.hoverElement.style.left = \"0\";\n\t\t\tthis.hoverElement.style.top = \"0\";\n\n\t\t\tthis._bindMouseMove();\n\t\t}\n\n\t\tdocument.body.addEventListener(\"mousemove\", this.moveHover);\n\t\tdocument.body.addEventListener(\"mouseup\", this.endMove);\n\n\t\tthis.dispatchExternal(\"rowMoving\", row.getComponent());\n\n\t\tthis.moveHover(e);\n\t}\n\n\tsetStartPosition(e, row){\n\t\tvar pageX = this.touchMove ? e.touches[0].pageX : e.pageX,\n\t\tpageY = this.touchMove ? e.touches[0].pageY : e.pageY,\n\t\telement, position;\n\n\t\telement = row.getElement();\n\t\tif(this.connection){\n\t\t\tposition = element.getBoundingClientRect();\n\n\t\t\tthis.startX = position.left - pageX + window.pageXOffset;\n\t\t\tthis.startY = position.top - pageY + window.pageYOffset;\n\t\t}else {\n\t\t\tthis.startY = (pageY - element.getBoundingClientRect().top);\n\t\t}\n\t}\n\n\tendMove(e){\n\t\tif(!e || e.which === 1 || this.touchMove){\n\t\t\tthis._unbindMouseMove();\n\n\t\t\tif(!this.connection){\n\t\t\t\tthis.placeholderElement.parentNode.insertBefore(this.moving.getElement(), this.placeholderElement.nextSibling);\n\t\t\t\tthis.placeholderElement.parentNode.removeChild(this.placeholderElement);\n\t\t\t}\n\n\t\t\tthis.hoverElement.parentNode.removeChild(this.hoverElement);\n\n\t\t\tthis.table.element.classList.remove(\"tabulator-block-select\");\n\n\t\t\tif(this.toRow){\n\t\t\t\tthis.table.rowManager.moveRow(this.moving, this.toRow, this.toRowAfter);\n\t\t\t}else {\n\t\t\t\tthis.dispatchExternal(\"rowMoveCancelled\", this.moving.getComponent());\n\t\t\t}\n\n\t\t\tthis.moving = false;\n\t\t\tthis.toRow = false;\n\t\t\tthis.toRowAfter = false;\n\n\t\t\tdocument.body.removeEventListener(\"mousemove\", this.moveHover);\n\t\t\tdocument.body.removeEventListener(\"mouseup\", this.endMove);\n\n\t\t\tif(this.connection){\n\t\t\t\tthis.table.element.classList.remove(\"tabulator-movingrow-sending\");\n\t\t\t\tthis.disconnectFromTables();\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveRow(row, after){\n\t\tthis.toRow = row;\n\t\tthis.toRowAfter = after;\n\t}\n\n\tmoveHover(e){\n\t\tif(this.connection){\n\t\t\tthis.moveHoverConnections.call(this, e);\n\t\t}else {\n\t\t\tthis.moveHoverTable.call(this, e);\n\t\t}\n\t}\n\n\tmoveHoverTable(e){\n\t\tvar rowHolder = this.table.rowManager.getElement(),\n\t\tscrollTop = rowHolder.scrollTop,\n\t\tyPos = ((this.touchMove ? e.touches[0].pageY : e.pageY) - rowHolder.getBoundingClientRect().top) + scrollTop;\n\t\t\n\t\tthis.hoverElement.style.top = Math.min(yPos - this.startY, this.table.rowManager.element.scrollHeight - this.hoverElement.offsetHeight) + \"px\";\n\t}\n\n\tmoveHoverConnections(e){\n\t\tthis.hoverElement.style.left = (this.startX + (this.touchMove ? e.touches[0].pageX : e.pageX)) + \"px\";\n\t\tthis.hoverElement.style.top = (this.startY + (this.touchMove ? e.touches[0].pageY : e.pageY)) + \"px\";\n\t}\n\n\telementRowDrop(e, element, row){\n\t\tthis.dispatchExternal(\"movableRowsElementDrop\", e, element, row ? row.getComponent() : false);\n\t}\n\n\t//establish connection with other tables\n\tconnectToTables(row){\n\t\tvar connectionTables;\n\n\t\tif(this.connectionSelectorsTables){\n\t\t\tconnectionTables = this.commsConnections(this.connectionSelectorsTables);\n\n\t\t\tthis.dispatchExternal(\"movableRowsSendingStart\", connectionTables);\n\n\t\t\tthis.commsSend(this.connectionSelectorsTables, \"moveRow\", \"connect\", {\n\t\t\t\trow:row,\n\t\t\t});\n\t\t}\n\n\t\tif(this.connectionSelectorsElements){\n\n\t\t\tthis.connectionElements = [];\n\n\t\t\tif(!Array.isArray(this.connectionSelectorsElements)){\n\t\t\t\tthis.connectionSelectorsElements = [this.connectionSelectorsElements];\n\t\t\t}\n\n\t\t\tthis.connectionSelectorsElements.forEach((query) => {\n\t\t\t\tif(typeof query === \"string\"){\n\t\t\t\t\tthis.connectionElements = this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(query)));\n\t\t\t\t}else {\n\t\t\t\t\tthis.connectionElements.push(query);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.connectionElements.forEach((element) => {\n\t\t\t\tvar dropEvent = (e) => {\n\t\t\t\t\tthis.elementRowDrop(e, element, this.moving);\n\t\t\t\t};\n\n\t\t\t\telement.addEventListener(\"mouseup\", dropEvent);\n\t\t\t\telement.tabulatorElementDropEvent = dropEvent;\n\n\t\t\t\telement.classList.add(\"tabulator-movingrow-receiving\");\n\t\t\t});\n\t\t}\n\t}\n\n\t//disconnect from other tables\n\tdisconnectFromTables(){\n\t\tvar connectionTables;\n\n\t\tif(this.connectionSelectorsTables){\n\t\t\tconnectionTables = this.commsConnections(this.connectionSelectorsTables);\n\n\t\t\tthis.dispatchExternal(\"movableRowsSendingStop\", connectionTables);\n\n\t\t\tthis.commsSend(this.connectionSelectorsTables, \"moveRow\", \"disconnect\");\n\t\t}\n\n\t\tthis.connectionElements.forEach((element) => {\n\t\t\telement.classList.remove(\"tabulator-movingrow-receiving\");\n\t\t\telement.removeEventListener(\"mouseup\", element.tabulatorElementDropEvent);\n\t\t\tdelete element.tabulatorElementDropEvent;\n\t\t});\n\t}\n\n\t//accept incomming connection\n\tconnect(table, row){\n\t\tif(!this.connectedTable){\n\t\t\tthis.connectedTable = table;\n\t\t\tthis.connectedRow = row;\n\n\t\t\tthis.table.element.classList.add(\"tabulator-movingrow-receiving\");\n\n\t\t\tthis.table.rowManager.getDisplayRows().forEach((row) => {\n\t\t\t\tif(row.type === \"row\" && row.modules.moveRow && row.modules.moveRow.mouseup){\n\t\t\t\t\trow.getElement().addEventListener(\"mouseup\", row.modules.moveRow.mouseup);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.tableRowDropEvent = this.tableRowDrop.bind(this);\n\n\t\t\tthis.table.element.addEventListener(\"mouseup\", this.tableRowDropEvent);\n\n\t\t\tthis.dispatchExternal(\"movableRowsReceivingStart\", row, table);\n\n\t\t\treturn true;\n\t\t}else {\n\t\t\tconsole.warn(\"Move Row Error - Table cannot accept connection, already connected to table:\", this.connectedTable);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//close incoming connection\n\tdisconnect(table){\n\t\tif(table === this.connectedTable){\n\t\t\tthis.connectedTable = false;\n\t\t\tthis.connectedRow = false;\n\n\t\t\tthis.table.element.classList.remove(\"tabulator-movingrow-receiving\");\n\n\t\t\tthis.table.rowManager.getDisplayRows().forEach((row) =>{\n\t\t\t\tif(row.type === \"row\" && row.modules.moveRow && row.modules.moveRow.mouseup){\n\t\t\t\t\trow.getElement().removeEventListener(\"mouseup\", row.modules.moveRow.mouseup);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.table.element.removeEventListener(\"mouseup\", this.tableRowDropEvent);\n\n\t\t\tthis.dispatchExternal(\"movableRowsReceivingStop\", table);\n\t\t}else {\n\t\t\tconsole.warn(\"Move Row Error - trying to disconnect from non connected table\");\n\t\t}\n\t}\n\n\tdropComplete(table, row, success){\n\t\tvar sender = false;\n\n\t\tif(success){\n\n\t\t\tswitch(typeof this.table.options.movableRowsSender){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tsender = MoveRows.senders[this.table.options.movableRowsSender];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\tsender = this.table.options.movableRowsSender;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif(sender){\n\t\t\t\tsender.call(this, this.moving ? this.moving.getComponent() : undefined, row ? row.getComponent() : undefined, table);\n\t\t\t}else {\n\t\t\t\tif(this.table.options.movableRowsSender){\n\t\t\t\t\tconsole.warn(\"Mover Row Error - no matching sender found:\", this.table.options.movableRowsSender);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.dispatchExternal(\"movableRowsSent\", this.moving.getComponent(), row ? row.getComponent() : undefined, table);\n\t\t}else {\n\t\t\tthis.dispatchExternal(\"movableRowsSentFailed\", this.moving.getComponent(), row ? row.getComponent() : undefined, table);\n\t\t}\n\n\t\tthis.endMove();\n\t}\n\n\ttableRowDrop(e, row){\n\t\tvar receiver = false,\n\t\tsuccess = false;\n\n\t\te.stopImmediatePropagation();\n\n\t\tswitch(typeof this.table.options.movableRowsReceiver){\n\t\t\tcase \"string\":\n\t\t\t\treceiver = MoveRows.receivers[this.table.options.movableRowsReceiver];\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\treceiver = this.table.options.movableRowsReceiver;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif(receiver){\n\t\t\tsuccess = receiver.call(this, this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t\t}else {\n\t\t\tconsole.warn(\"Mover Row Error - no matching receiver found:\", this.table.options.movableRowsReceiver);\n\t\t}\n\n\t\tif(success){\n\t\t\tthis.dispatchExternal(\"movableRowsReceived\", this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t\t}else {\n\t\t\tthis.dispatchExternal(\"movableRowsReceivedFailed\", this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t\t}\n\n\t\tthis.commsSend(this.connectedTable, \"moveRow\", \"dropcomplete\", {\n\t\t\trow:row,\n\t\t\tsuccess:success,\n\t\t});\n\t}\n\n\tcommsReceived(table, action, data){\n\t\tswitch(action){\n\t\t\tcase \"connect\":\n\t\t\t\treturn this.connect(table, data.row);\n\n\t\t\tcase \"disconnect\":\n\t\t\t\treturn this.disconnect(table);\n\n\t\t\tcase \"dropcomplete\":\n\t\t\t\treturn this.dropComplete(table, data.row, data.success);\n\t\t}\n\t}\n}\n\nvar defaultMutators = {};\n\nclass Mutator extends Module{\n\n\tstatic moduleName = \"mutator\";\n\n\t//load defaults\n\tstatic mutators = defaultMutators;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.allowedTypes = [\"\", \"data\", \"edit\", \"clipboard\", \"import\"]; //list of mutation types\n\t\tthis.enabled = true;\n\n\t\tthis.registerColumnOption(\"mutator\");\n\t\tthis.registerColumnOption(\"mutatorParams\");\n\t\tthis.registerColumnOption(\"mutatorData\");\n\t\tthis.registerColumnOption(\"mutatorDataParams\");\n\t\tthis.registerColumnOption(\"mutatorEdit\");\n\t\tthis.registerColumnOption(\"mutatorEditParams\");\n\t\tthis.registerColumnOption(\"mutatorClipboard\");\n\t\tthis.registerColumnOption(\"mutatorClipboardParams\");\n\t\tthis.registerColumnOption(\"mutatorImport\");\n\t\tthis.registerColumnOption(\"mutatorImportParams\");\n\t\tthis.registerColumnOption(\"mutateLink\");\n\t}\n\n\tinitialize(){\n\t\tthis.subscribe(\"cell-value-changing\", this.transformCell.bind(this));\n\t\tthis.subscribe(\"cell-value-changed\", this.mutateLink.bind(this));\n\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"row-data-init-before\", this.rowDataChanged.bind(this));\n\t\tthis.subscribe(\"row-data-changing\", this.rowDataChanged.bind(this));\n\t}\n\n\trowDataChanged(row, tempData, updatedData){\n\t\treturn this.transformRow(tempData, \"data\", updatedData);\n\t}\n\n\t//initialize column mutator\n\tinitializeColumn(column){\n\t\tvar match = false,\n\t\tconfig = {};\n\n\t\tthis.allowedTypes.forEach((type) => {\n\t\t\tvar key = \"mutator\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\t\tmutator;\n\n\t\t\tif(column.definition[key]){\n\t\t\t\tmutator = this.lookupMutator(column.definition[key]);\n\n\t\t\t\tif(mutator){\n\t\t\t\t\tmatch = true;\n\n\t\t\t\t\tconfig[key] = {\n\t\t\t\t\t\tmutator:mutator,\n\t\t\t\t\t\tparams: column.definition[key + \"Params\"] || {},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(match){\n\t\t\tcolumn.modules.mutate = config;\n\t\t}\n\t}\n\n\tlookupMutator(value){\n\t\tvar mutator = false;\n\n\t\t//set column mutator\n\t\tswitch(typeof value){\n\t\t\tcase \"string\":\n\t\t\t\tif(Mutator.mutators[value]){\n\t\t\t\t\tmutator = Mutator.mutators[value];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Mutator Error - No such mutator found, ignoring: \", value);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tmutator = value;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn mutator;\n\t}\n\n\t//apply mutator to row\n\ttransformRow(data, type, updatedData){\n\t\tvar key = \"mutator\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\tvalue;\n\n\t\t// console.log(\"key\", key)\n\n\t\tif(this.enabled){\n\n\t\t\tthis.table.columnManager.traverse((column) => {\n\t\t\t\tvar mutator, params, component;\n\n\t\t\t\tif(column.modules.mutate){\n\t\t\t\t\tmutator = column.modules.mutate[key] || column.modules.mutate.mutator || false;\n\n\t\t\t\t\tif(mutator){\n\t\t\t\t\t\tvalue = column.getFieldValue(typeof updatedData !== \"undefined\" ? updatedData : data);\n\n\t\t\t\t\t\tif((type == \"data\" && !updatedData)|| typeof value !== \"undefined\"){\n\t\t\t\t\t\t\tcomponent = column.getComponent();\n\t\t\t\t\t\t\tparams = typeof mutator.params === \"function\" ? mutator.params(value, data, type, component) : mutator.params;\n\t\t\t\t\t\t\tcolumn.setFieldValue(data, mutator.mutator(value, data, type, params, component));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn data;\n\t}\n\n\t//apply mutator to new cell value\n\ttransformCell(cell, value){\n\t\tif(cell.column.modules.mutate){\n\t\t\tvar mutator = cell.column.modules.mutate.mutatorEdit || cell.column.modules.mutate.mutator || false,\n\t\t\ttempData = {};\n\n\t\t\tif(mutator){\n\t\t\t\ttempData = Object.assign(tempData, cell.row.getData());\n\t\t\t\tcell.column.setFieldValue(tempData, value);\n\t\t\t\treturn mutator.mutator(value, tempData, \"edit\", mutator.params, cell.getComponent());\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tmutateLink(cell){\n\t\tvar links = cell.column.definition.mutateLink;\n\n\t\tif(links){\n\t\t\tif(!Array.isArray(links)){\n\t\t\t\tlinks = [links];\n\t\t\t}\n\n\t\t\tlinks.forEach((link) => {\n\t\t\t\tvar linkCell = cell.row.getCell(link);\n\n\t\t\t\tif(linkCell){\n\t\t\t\t\tlinkCell.setValue(linkCell.getValue(), true, true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tenable(){\n\t\tthis.enabled = true;\n\t}\n\n\tdisable(){\n\t\tthis.enabled = false;\n\t}\n}\n\nfunction rows(pageSize, currentRow, currentPage, totalRows, totalPages){\n\tvar el = document.createElement(\"span\"),\n\tshowingEl = document.createElement(\"span\"),\n\tvalueEl = document.createElement(\"span\"),\n\tofEl = document.createElement(\"span\"),\n\ttotalEl = document.createElement(\"span\"),\n\trowsEl = document.createElement(\"span\");\n\n\tthis.table.modules.localize.langBind(\"pagination|counter|showing\", (value) => {\n\t\tshowingEl.innerHTML = value;\n\t});\n\n\tthis.table.modules.localize.langBind(\"pagination|counter|of\", (value) => {\n\t\tofEl.innerHTML = value;\n\t});\n\n\tthis.table.modules.localize.langBind(\"pagination|counter|rows\", (value) => {\n\t\trowsEl.innerHTML = value;\n\t});\n\n\tif(totalRows){\n\t\tvalueEl.innerHTML = \" \" + currentRow + \"-\" + Math.min((currentRow + pageSize - 1), totalRows) + \" \";\n\t\t\n\t\ttotalEl.innerHTML = \" \" + totalRows + \" \";\n\t\t\n\t\tel.appendChild(showingEl);\n\t\tel.appendChild(valueEl);\n\t\tel.appendChild(ofEl);\n\t\tel.appendChild(totalEl);\n\t\tel.appendChild(rowsEl);\n\t}else {\n\t\tvalueEl.innerHTML = \" 0 \";\n\n\t\tel.appendChild(showingEl);\n\t\tel.appendChild(valueEl);\n\t\tel.appendChild(rowsEl);\n\t}\n\t\n\treturn el;\n}\n\nfunction pages(pageSize, currentRow, currentPage, totalRows, totalPages){\n\n\tvar el = document.createElement(\"span\"),\n\tshowingEl = document.createElement(\"span\"),\n\tvalueEl = document.createElement(\"span\"),\n\tofEl = document.createElement(\"span\"),\n\ttotalEl = document.createElement(\"span\"),\n\trowsEl = document.createElement(\"span\");\n\t\n\tthis.table.modules.localize.langBind(\"pagination|counter|showing\", (value) => {\n\t\tshowingEl.innerHTML = value;\n\t});\n\t\n\tvalueEl.innerHTML = \" \" + currentPage + \" \";\n\t\n\tthis.table.modules.localize.langBind(\"pagination|counter|of\", (value) => {\n\t\tofEl.innerHTML = value;\n\t});\n\t\n\ttotalEl.innerHTML = \" \" + totalPages + \" \";\n\t\n\tthis.table.modules.localize.langBind(\"pagination|counter|pages\", (value) => {\n\t\trowsEl.innerHTML = value;\n\t});\n\t\n\tel.appendChild(showingEl);\n\tel.appendChild(valueEl);\n\tel.appendChild(ofEl);\n\tel.appendChild(totalEl);\n\tel.appendChild(rowsEl);\n\t\n\treturn el;\n}\n\nvar defaultPageCounters = {\n\trows:rows,\n\tpages:pages,\n};\n\nclass Page extends Module{\n\n\tstatic moduleName = \"page\";\n\n\t//load defaults\n\tstatic pageCounters = defaultPageCounters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.mode = \"local\";\n\t\tthis.progressiveLoad = false;\n\t\t\n\t\tthis.element = null;\n\t\tthis.pageCounterElement = null;\n\t\tthis.pageCounter = null;\n\t\t\n\t\tthis.size = 0;\n\t\tthis.page = 1;\n\t\tthis.count = 5;\n\t\tthis.max = 1;\n\n\t\tthis.remoteRowCountEstimate = null;\n\t\t\n\t\tthis.initialLoad = true;\n\t\tthis.dataChanging = false; //flag to check if data is being changed by this module\n\t\t\n\t\tthis.pageSizes = [];\n\t\t\n\t\tthis.registerTableOption(\"pagination\", false); //set pagination type\n\t\tthis.registerTableOption(\"paginationMode\", \"local\"); //local or remote pagination\n\t\tthis.registerTableOption(\"paginationSize\", false); //set number of rows to a page\n\t\tthis.registerTableOption(\"paginationInitialPage\", 1); //initial page to show on load\n\t\tthis.registerTableOption(\"paginationCounter\", false);  // set pagination counter\n\t\tthis.registerTableOption(\"paginationCounterElement\", false);  // set pagination counter\n\t\tthis.registerTableOption(\"paginationButtonCount\", 5);  // set count of page button\n\t\tthis.registerTableOption(\"paginationSizeSelector\", false); //add pagination size selector element\n\t\tthis.registerTableOption(\"paginationElement\", false); //element to hold pagination numbers\n\t\t// this.registerTableOption(\"paginationDataSent\", {}); //pagination data sent to the server\n\t\t// this.registerTableOption(\"paginationDataReceived\", {}); //pagination data received from the server\n\t\tthis.registerTableOption(\"paginationAddRow\", \"page\"); //add rows on table or page\n\t\tthis.registerTableOption(\"paginationOutOfRange\", false); //reset the current page when the last page < this.page, values: false|function|any value accepted by setPage()\n\t\t\n\t\tthis.registerTableOption(\"progressiveLoad\", false); //progressive loading\n\t\tthis.registerTableOption(\"progressiveLoadDelay\", 0); //delay between requests\n\t\tthis.registerTableOption(\"progressiveLoadScrollMargin\", 0); //margin before scroll begins\n\t\t\n\t\tthis.registerTableFunction(\"setMaxPage\", this.setMaxPage.bind(this));\n\t\tthis.registerTableFunction(\"setPage\", this.setPage.bind(this));\n\t\tthis.registerTableFunction(\"setPageToRow\", this.userSetPageToRow.bind(this));\n\t\tthis.registerTableFunction(\"setPageSize\", this.userSetPageSize.bind(this));\n\t\tthis.registerTableFunction(\"getPageSize\", this.getPageSize.bind(this));\n\t\tthis.registerTableFunction(\"previousPage\", this.previousPage.bind(this));\n\t\tthis.registerTableFunction(\"nextPage\", this.nextPage.bind(this));\n\t\tthis.registerTableFunction(\"getPage\", this.getPage.bind(this));\n\t\tthis.registerTableFunction(\"getPageMax\", this.getPageMax.bind(this));\n\t\t\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"pageTo\", this.setPageToRow.bind(this));\n\t}\n\t\n\tinitialize(){\n\t\tif(this.table.options.pagination){\n\t\t\tthis.subscribe(\"row-deleted\", this.rowsUpdated.bind(this));\n\t\t\tthis.subscribe(\"row-added\", this.rowsUpdated.bind(this));\n\t\t\tthis.subscribe(\"data-processed\", this.initialLoadComplete.bind(this));\n\t\t\tthis.subscribe(\"table-built\", this.calculatePageSizes.bind(this));\n\t\t\tthis.subscribe(\"footer-redraw\", this.footerRedraw.bind(this));\n\n\t\t\tif(this.table.options.paginationAddRow == \"page\"){\n\t\t\t\tthis.subscribe(\"row-adding-position\", this.rowAddingPosition.bind(this));\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.options.paginationMode === \"remote\"){\n\t\t\t\tthis.subscribe(\"data-params\", this.remotePageParams.bind(this));\n\t\t\t\tthis.subscribe(\"data-loaded\", this._parseRemoteData.bind(this));\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.options.progressiveLoad){\n\t\t\t\tconsole.error(\"Progressive Load Error - Pagination and progressive load cannot be used at the same time\");\n\t\t\t}\n\t\t\t\n\t\t\tthis.registerDisplayHandler(this.restOnRenderBefore.bind(this), 40);\n\t\t\tthis.registerDisplayHandler(this.getRows.bind(this), 50);\n\t\t\t\n\t\t\tthis.createElements();\n\t\t\tthis.initializePageCounter();\n\t\t\tthis.initializePaginator();\n\t\t}else if(this.table.options.progressiveLoad){\n\t\t\tthis.subscribe(\"data-params\", this.remotePageParams.bind(this));\n\t\t\tthis.subscribe(\"data-loaded\", this._parseRemoteData.bind(this));\n\t\t\tthis.subscribe(\"table-built\", this.calculatePageSizes.bind(this));\n\t\t\tthis.subscribe(\"data-processed\", this.initialLoadComplete.bind(this));\n\t\t\t\n\t\t\tthis.initializeProgressive(this.table.options.progressiveLoad);\n\t\t\t\n\t\t\tif(this.table.options.progressiveLoad === \"scroll\"){\n\t\t\t\tthis.subscribe(\"scroll-vertical\", this.scrollVertical.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\t\n\trowAddingPosition(row, top){\n\t\tvar rowManager = this.table.rowManager,\n\t\tdisplayRows = rowManager.getDisplayRows(),\n\t\tindex;\n\t\t\n\t\tif(top){\n\t\t\tif(displayRows.length){\n\t\t\t\tindex = displayRows[0];\n\t\t\t}else {\n\t\t\t\tif(rowManager.activeRows.length){\n\t\t\t\t\tindex = rowManager.activeRows[rowManager.activeRows.length-1];\n\t\t\t\t\ttop = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tif(displayRows.length){\n\t\t\t\tindex = displayRows[displayRows.length - 1];\n\t\t\t\ttop = displayRows.length < this.size ? false : true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn {index, top};\n\t}\n\t\n\tcalculatePageSizes(){\n\t\tvar testElRow, testElCell;\n\t\t\n\t\tif(this.table.options.paginationSize){\n\t\t\tthis.size = this.table.options.paginationSize;\n\t\t}else {\n\t\t\ttestElRow = document.createElement(\"div\");\n\t\t\ttestElRow.classList.add(\"tabulator-row\");\n\t\t\ttestElRow.style.visibility = \"hidden\";\n\t\t\t\n\t\t\ttestElCell = document.createElement(\"div\");\n\t\t\ttestElCell.classList.add(\"tabulator-cell\");\n\t\t\ttestElCell.innerHTML = \"Page Row Test\";\n\t\t\t\n\t\t\ttestElRow.appendChild(testElCell);\n\t\t\t\n\t\t\tthis.table.rowManager.getTableElement().appendChild(testElRow);\n\t\t\t\n\t\t\tthis.size = Math.floor(this.table.rowManager.getElement().clientHeight / testElRow.offsetHeight);\n\t\t\t\n\t\t\tthis.table.rowManager.getTableElement().removeChild(testElRow);\n\t\t}\n\n\t\tthis.dispatchExternal(\"pageSizeChanged\", this.size);\n\t\t\n\t\tthis.generatePageSizeSelectList();\n\t}\n\t\n\tinitialLoadComplete(){\n\t\tthis.initialLoad = false;\n\t}\n\t\n\tremotePageParams(data, config, silent, params){\n\t\tif(!this.initialLoad){\n\t\t\tif((this.progressiveLoad && !silent) || (!this.progressiveLoad && !this.dataChanging)){\n\t\t\t\tthis.reset(true);\n\t\t\t}\n\t\t}\n\t\t\n\t\t//configure request params\n\t\tparams.page = this.page;\n\t\t\n\t\t//set page size if defined\n\t\tif(this.size){\n\t\t\tparams.size = this.size;\n\t\t}\n\t\t\n\t\treturn params;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\t\n\tuserSetPageToRow(row){\n\t\tif(this.table.options.pagination){\n\t\t\trow = this.table.rowManager.findRow(row);\n\t\t\t\n\t\t\tif(row){\n\t\t\t\treturn this.setPageToRow(row);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn Promise.reject();\n\t}\n\t\n\tuserSetPageSize(size){\n\t\tif(this.table.options.pagination){\n\t\t\tthis.setPageSize(size);\n\t\t\treturn this.setPage(1);\n\t\t}else {\n\t\t\treturn false;\n\t\t}\n\t}\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tscrollVertical(top, dir){\n\t\tvar element, diff, margin;\n\t\tif(!dir && !this.table.dataLoader.loading){\n\t\t\telement = this.table.rowManager.getElement();\n\t\t\tdiff = element.scrollHeight - element.clientHeight - top;\n\t\t\tmargin = this.table.options.progressiveLoadScrollMargin || (element.clientHeight * 2);\n\t\t\t\n\t\t\tif(diff < margin){\n\t\t\t\tthis.nextPage()\n\t\t\t\t\t.catch(() => {}); //consume the exception thrown when on the last page\n\t\t\t}\n\t\t}\n\t}\n\t\n\trestOnRenderBefore(rows, renderInPosition){\n\t\tif(!renderInPosition){\n\t\t\tif(this.mode === \"local\"){\n\t\t\t\tthis.reset();\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn rows;\n\t}\n\t\n\trowsUpdated(){\n\t\tthis.refreshData(true, \"all\");\n\t}\n\t\n\tcreateElements(){\n\t\tvar button;\n\t\t\n\t\tthis.element = document.createElement(\"span\");\n\t\tthis.element.classList.add(\"tabulator-paginator\");\n\t\t\n\t\tthis.pagesElement = document.createElement(\"span\");\n\t\tthis.pagesElement.classList.add(\"tabulator-pages\");\n\t\t\n\t\tbutton = document.createElement(\"button\");\n\t\tbutton.classList.add(\"tabulator-page\");\n\t\tbutton.setAttribute(\"type\", \"button\");\n\t\tbutton.setAttribute(\"role\", \"button\");\n\t\tbutton.setAttribute(\"aria-label\", \"\");\n\t\tbutton.setAttribute(\"title\", \"\");\n\t\t\n\t\tthis.firstBut = button.cloneNode(true);\n\t\tthis.firstBut.setAttribute(\"data-page\", \"first\");\n\t\t\n\t\tthis.prevBut = button.cloneNode(true);\n\t\tthis.prevBut.setAttribute(\"data-page\", \"prev\");\n\t\t\n\t\tthis.nextBut = button.cloneNode(true);\n\t\tthis.nextBut.setAttribute(\"data-page\", \"next\");\n\t\t\n\t\tthis.lastBut = button.cloneNode(true);\n\t\tthis.lastBut.setAttribute(\"data-page\", \"last\");\n\t\t\n\t\tif(this.table.options.paginationSizeSelector){\n\t\t\tthis.pageSizeSelect = document.createElement(\"select\");\n\t\t\tthis.pageSizeSelect.classList.add(\"tabulator-page-size\");\n\t\t}\n\t}\n\t\n\tgeneratePageSizeSelectList(){\n\t\tvar pageSizes = [];\n\t\t\n\t\tif(this.pageSizeSelect){\n\t\t\t\n\t\t\tif(Array.isArray(this.table.options.paginationSizeSelector)){\n\t\t\t\tpageSizes = this.table.options.paginationSizeSelector;\n\t\t\t\tthis.pageSizes = pageSizes;\n\t\t\t\t\n\t\t\t\tif(this.pageSizes.indexOf(this.size) == -1){\n\t\t\t\t\tpageSizes.unshift(this.size);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\t\n\t\t\t\tif(this.pageSizes.indexOf(this.size) == -1){\n\t\t\t\t\tpageSizes = [];\n\t\t\t\t\t\n\t\t\t\t\tfor (let i = 1; i < 5; i++){\n\t\t\t\t\t\tpageSizes.push(this.size * i);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.pageSizes = pageSizes;\n\t\t\t\t}else {\n\t\t\t\t\tpageSizes = this.pageSizes;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\twhile(this.pageSizeSelect.firstChild) this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);\n\t\t\t\n\t\t\tpageSizes.forEach((item) => {\n\t\t\t\tvar itemEl = document.createElement(\"option\");\n\t\t\t\titemEl.value = item;\n\t\t\t\t\n\t\t\t\tif(item === true){\n\t\t\t\t\tthis.langBind(\"pagination|all\", function(value){\n\t\t\t\t\t\titemEl.innerHTML = value;\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\titemEl.innerHTML = item;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tthis.pageSizeSelect.appendChild(itemEl);\n\t\t\t});\n\t\t\t\n\t\t\tthis.pageSizeSelect.value = this.size;\n\t\t}\n\t}\n\t\n\tinitializePageCounter(){\n\t\tvar counter = this.table.options.paginationCounter,\n\t\tpageCounter = null;\n\t\t\n\t\tif(counter){\n\t\t\tif(typeof counter === \"function\"){\n\t\t\t\tpageCounter = counter;\n\t\t\t}else {\n\t\t\t\tpageCounter = Page.pageCounters[counter];\n\t\t\t}\n\t\t\t\n\t\t\tif(pageCounter){\n\t\t\t\tthis.pageCounter = pageCounter;\n\t\t\t\t\n\t\t\t\tthis.pageCounterElement = document.createElement(\"span\");\n\t\t\t\tthis.pageCounterElement.classList.add(\"tabulator-page-counter\");\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Pagination Error - No such page counter found: \", counter);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//setup pagination\n\tinitializePaginator(hidden){\n\t\tvar pageSelectLabel, paginationCounterHolder;\n\t\t\n\t\tif(!hidden){\n\t\t\t//build pagination element\n\t\t\t\n\t\t\t//bind localizations\n\t\t\tthis.langBind(\"pagination|first\", (value) => {\n\t\t\t\tthis.firstBut.innerHTML = value;\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|first_title\", (value) => {\n\t\t\t\tthis.firstBut.setAttribute(\"aria-label\", value);\n\t\t\t\tthis.firstBut.setAttribute(\"title\", value);\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|prev\", (value) => {\n\t\t\t\tthis.prevBut.innerHTML = value;\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|prev_title\", (value) => {\n\t\t\t\tthis.prevBut.setAttribute(\"aria-label\", value);\n\t\t\t\tthis.prevBut.setAttribute(\"title\", value);\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|next\", (value) => {\n\t\t\t\tthis.nextBut.innerHTML = value;\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|next_title\", (value) => {\n\t\t\t\tthis.nextBut.setAttribute(\"aria-label\", value);\n\t\t\t\tthis.nextBut.setAttribute(\"title\", value);\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|last\", (value) => {\n\t\t\t\tthis.lastBut.innerHTML = value;\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|last_title\", (value) => {\n\t\t\t\tthis.lastBut.setAttribute(\"aria-label\", value);\n\t\t\t\tthis.lastBut.setAttribute(\"title\", value);\n\t\t\t});\n\t\t\t\n\t\t\t//click bindings\n\t\t\tthis.firstBut.addEventListener(\"click\", () => {\n\t\t\t\tthis.setPage(1);\n\t\t\t});\n\t\t\t\n\t\t\tthis.prevBut.addEventListener(\"click\", () => {\n\t\t\t\tthis.previousPage();\n\t\t\t});\n\t\t\t\n\t\t\tthis.nextBut.addEventListener(\"click\", () => {\n\t\t\t\tthis.nextPage();\n\t\t\t});\n\t\t\t\n\t\t\tthis.lastBut.addEventListener(\"click\", () => {\n\t\t\t\tthis.setPage(this.max);\n\t\t\t});\n\t\t\t\n\t\t\tif(this.table.options.paginationElement){\n\t\t\t\tthis.element = this.table.options.paginationElement;\n\t\t\t}\n\t\t\t\n\t\t\tif(this.pageSizeSelect){\n\t\t\t\tpageSelectLabel = document.createElement(\"label\");\n\t\t\t\t\n\t\t\t\tthis.langBind(\"pagination|page_size\", (value) => {\n\t\t\t\t\tthis.pageSizeSelect.setAttribute(\"aria-label\", value);\n\t\t\t\t\tthis.pageSizeSelect.setAttribute(\"title\", value);\n\t\t\t\t\tpageSelectLabel.innerHTML = value;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.element.appendChild(pageSelectLabel);\n\t\t\t\tthis.element.appendChild(this.pageSizeSelect);\n\t\t\t\t\n\t\t\t\tthis.pageSizeSelect.addEventListener(\"change\", (e) => {\n\t\t\t\t\tthis.setPageSize(this.pageSizeSelect.value == \"true\" ? true : this.pageSizeSelect.value);\n\t\t\t\t\tthis.setPage(1);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t//append to DOM\n\t\t\tthis.element.appendChild(this.firstBut);\n\t\t\tthis.element.appendChild(this.prevBut);\n\t\t\tthis.element.appendChild(this.pagesElement);\n\t\t\tthis.element.appendChild(this.nextBut);\n\t\t\tthis.element.appendChild(this.lastBut);\n\t\t\t\n\t\t\tif(!this.table.options.paginationElement){\n\t\t\t\tif(this.table.options.paginationCounter){\n\n\t\t\t\t\tif(this.table.options.paginationCounterElement){\n\t\t\t\t\t\tif(this.table.options.paginationCounterElement instanceof HTMLElement){\n\t\t\t\t\t\t\tthis.table.options.paginationCounterElement.appendChild(this.pageCounterElement);\n\t\t\t\t\t\t}else if(typeof this.table.options.paginationCounterElement === \"string\"){\n\t\t\t\t\t\t\tpaginationCounterHolder = document.querySelector(this.table.options.paginationCounterElement);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(paginationCounterHolder){\n\t\t\t\t\t\t\t\tpaginationCounterHolder.appendChild(this.pageCounterElement);\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tconsole.warn(\"Pagination Error - Unable to find element matching paginationCounterElement selector:\", this.table.options.paginationCounterElement);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.footerAppend(this.pageCounterElement);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.footerAppend(this.element);\n\t\t\t}\n\t\t\t\n\t\t\tthis.page = this.table.options.paginationInitialPage;\n\t\t\tthis.count = this.table.options.paginationButtonCount;\n\t\t}\n\t\t\n\t\t//set default values\n\t\tthis.mode = this.table.options.paginationMode;\n\t}\n\t\n\tinitializeProgressive(mode){\n\t\tthis.initializePaginator(true);\n\t\tthis.mode = \"progressive_\" + mode;\n\t\tthis.progressiveLoad = true;\n\t}\n\t\n\ttrackChanges(){\n\t\tthis.dispatch(\"page-changed\");\n\t}\n\t\n\t//calculate maximum page from number of rows\n\tsetMaxRows(rowCount){\n\t\tif(!rowCount){\n\t\t\tthis.max = 1;\n\t\t}else {\n\t\t\tthis.max = this.size === true ?  1 : Math.ceil(rowCount/this.size);\n\t\t}\n\t\t\n\t\tif(this.page > this.max){\n\t\t\tthis.page = this.max;\n\t\t}\n\t}\n\t\n\t//reset to first page without triggering action\n\treset(force){\n\t\tif(!this.initialLoad){\n\t\t\tif(this.mode == \"local\" || force){\n\t\t\t\tthis.page = 1;\n\t\t\t\tthis.trackChanges();\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//set the maximum page\n\tsetMaxPage(max){\n\t\t\n\t\tmax = parseInt(max);\n\t\t\n\t\tthis.max = max || 1;\n\t\t\n\t\tif(this.page > this.max){\n\t\t\tthis.page = this.max;\n\t\t\tthis.trigger();\n\t\t}\n\t}\n\t\n\t//set current page number\n\tsetPage(page){\n\t\tswitch(page){\n\t\t\tcase \"first\":\n\t\t\t\treturn this.setPage(1);\n\t\n\t\t\tcase \"prev\":\n\t\t\t\treturn this.previousPage();\n\t\t\t\n\t\t\tcase \"next\":\n\t\t\t\treturn this.nextPage();\n\t\t\t\n\t\t\tcase \"last\":\n\t\t\t\treturn this.setPage(this.max);\n\t\t}\n\t\t\n\t\tpage = parseInt(page);\n\t\t\n\t\tif((page > 0 && page <= this.max) || this.mode !== \"local\"){\n\t\t\tthis.page = page;\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t\t\n\t\t\treturn this.trigger();\n\t\t}else {\n\t\t\tconsole.warn(\"Pagination Error - Requested page is out of range of 1 - \" + this.max + \":\", page);\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\tsetPageToRow(row){\n\t\tvar rows = this.displayRows(-1);\n\t\tvar index = rows.indexOf(row);\n\t\n\t\tif(index > -1){\n\t\t\tvar page = this.size === true ? 1 : Math.ceil((index + 1) / this.size);\n\t\t\t\n\t\t\treturn this.setPage(page);\n\t\t}else {\n\t\t\tconsole.warn(\"Pagination Error - Requested row is not visible\");\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\tsetPageSize(size){\n\t\tif(size !== true){\n\t\t\tsize = parseInt(size);\n\t\t}\n\n\t\tif(size > 0){\n\t\t\tthis.size = size;\n\t\t\tthis.dispatchExternal(\"pageSizeChanged\", size);\n\t\t}\n\t\t\n\t\tif(this.pageSizeSelect){\n\t\t\t// this.pageSizeSelect.value = size;\n\t\t\tthis.generatePageSizeSelectList();\n\t\t}\n\t\t\n\t\tthis.trackChanges();\n\t}\n\t\n\t_setPageCounter(totalRows, size, currentRow){\n\t\tvar content;\n\t\t\n\t\tif(this.pageCounter){\n\n\t\t\tif(this.mode === \"remote\"){\n\t\t\t\tsize = this.size;\n\t\t\t\tcurrentRow = ((this.page - 1) * this.size) + 1;\n\t\t\t\ttotalRows = this.remoteRowCountEstimate;\n\t\t\t}\n\n\t\t\tcontent = this.pageCounter.call(this, size, currentRow, this.page, totalRows, this.max);\n\t\t\t\n\t\t\tswitch(typeof content){\n\t\t\t\tcase \"object\":\n\t\t\t\t\tif(content instanceof Node){\n\t\t\t\t\t\n\t\t\t\t\t\t//clear previous cell contents\n\t\t\t\t\t\twhile(this.pageCounterElement.firstChild) this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);\n\t\t\t\t\t\n\t\t\t\t\t\tthis.pageCounterElement.appendChild(content);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.pageCounterElement.innerHTML = \"\";\n\t\t\t\t\t\n\t\t\t\t\t\tif(content != null){\n\t\t\t\t\t\t\tconsole.warn(\"Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:\", content);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"undefined\":\n\t\t\t\t\tthis.pageCounterElement.innerHTML = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.pageCounterElement.innerHTML = content;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//setup the pagination buttons\n\t_setPageButtons(){\n\t\tlet leftSize = Math.floor((this.count-1) / 2);\n\t\tlet rightSize = Math.ceil((this.count-1) / 2);\n\t\tlet min = this.max - this.page + leftSize + 1 < this.count ? this.max-this.count+1: Math.max(this.page-leftSize,1);\n\t\tlet max = this.page <= rightSize? Math.min(this.count, this.max) :Math.min(this.page+rightSize, this.max);\n\t\t\n\t\twhile(this.pagesElement.firstChild) this.pagesElement.removeChild(this.pagesElement.firstChild);\n\t\t\n\t\tif(this.page == 1){\n\t\t\tthis.firstBut.disabled = true;\n\t\t\tthis.prevBut.disabled = true;\n\t\t}else {\n\t\t\tthis.firstBut.disabled = false;\n\t\t\tthis.prevBut.disabled = false;\n\t\t}\n\t\t\n\t\tif(this.page == this.max){\n\t\t\tthis.lastBut.disabled = true;\n\t\t\tthis.nextBut.disabled = true;\n\t\t}else {\n\t\t\tthis.lastBut.disabled = false;\n\t\t\tthis.nextBut.disabled = false;\n\t\t}\n\t\t\n\t\tfor(let i = min; i <= max; i++){\n\t\t\tif(i>0 && i <= this.max){\n\t\t\t\tthis.pagesElement.appendChild(this._generatePageButton(i));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.footerRedraw();\n\t}\n\t\n\t_generatePageButton(page){\n\t\tvar button = document.createElement(\"button\");\n\t\t\n\t\tbutton.classList.add(\"tabulator-page\");\n\t\tif(page == this.page){\n\t\t\tbutton.classList.add(\"active\");\n\t\t}\n\t\t\n\t\tbutton.setAttribute(\"type\", \"button\");\n\t\tbutton.setAttribute(\"role\", \"button\");\n\t\t\n\t\tthis.langBind(\"pagination|page_title\", (value) => {\n\t\t\tbutton.setAttribute(\"aria-label\", value + \" \" + page);\n\t\t\tbutton.setAttribute(\"title\", value + \" \" + page);\n\t\t});\n\t\t\n\t\tbutton.setAttribute(\"data-page\", page);\n\t\tbutton.textContent = page;\n\t\t\n\t\tbutton.addEventListener(\"click\", (e) => {\n\t\t\tthis.setPage(page);\n\t\t});\n\t\t\n\t\treturn button;\n\t}\n\t\n\t//previous page\n\tpreviousPage(){\n\t\tif(this.page > 1){\n\t\t\tthis.page--;\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t\t\n\t\t\treturn this.trigger();\n\t\t\t\n\t\t}else {\n\t\t\tconsole.warn(\"Pagination Error - Previous page would be less than page 1:\", 0);\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\t//next page\n\tnextPage(){\n\t\tif(this.page < this.max){\n\t\t\tthis.page++;\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t\t\n\t\t\treturn this.trigger();\n\t\t\t\n\t\t}else {\n\t\t\tif(!this.progressiveLoad){\n\t\t\t\tconsole.warn(\"Pagination Error - Next page would be greater than maximum page of \" + this.max + \":\", this.max + 1);\n\t\t\t}\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\t//return current page number\n\tgetPage(){\n\t\treturn this.page;\n\t}\n\t\n\t//return max page number\n\tgetPageMax(){\n\t\treturn this.max;\n\t}\n\t\n\tgetPageSize(size){\n\t\treturn this.size;\n\t}\n\t\n\tgetMode(){\n\t\treturn this.mode;\n\t}\n\t\n\t//return appropriate rows for current page\n\tgetRows(data){\n\t\tvar actualRowPageSize = 0,\n\t\toutput, start, end, actualStartRow;\n\n\t\tvar actualRows = data.filter((row) => {\n\t\t\treturn row.type === \"row\";\n\t\t});\n\t\t\n\t\tif(this.mode == \"local\"){\n\t\t\toutput = [];\n\t\t\t\n\t\t\tthis.setMaxRows(data.length);\n\t\t\t\n\t\t\tif(this.size === true){\n\t\t\t\tstart = 0;\n\t\t\t\tend = data.length;\n\t\t\t}else {\n\t\t\t\tstart = this.size * (this.page - 1);\n\t\t\t\tend = start + parseInt(this.size);\n\t\t\t}\n\t\t\t\n\t\t\tthis._setPageButtons();\n\t\t\t\n\t\t\tfor(let i = start; i < end; i++){\n\t\t\t\tlet row = data[i];\n\n\t\t\t\tif(row){\n\t\t\t\t\toutput.push(row);\n\n\t\t\t\t\tif(row.type === \"row\"){\n\t\t\t\t\t\tif(!actualStartRow){\n\t\t\t\t\t\t\tactualStartRow = row;\n\t\t\t\t\t\t}\t\n\n\t\t\t\t\t\tactualRowPageSize++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis._setPageCounter(actualRows.length, actualRowPageSize, actualStartRow ? (actualRows.indexOf(actualStartRow) + 1) : 0);\n\t\t\t\n\t\t\treturn output;\n\t\t}else {\n\t\t\tthis._setPageButtons();\n\t\t\tthis._setPageCounter(actualRows.length);\n\t\t\t\n\t\t\treturn data.slice(0);\n\t\t}\n\t}\n\t\n\ttrigger(){\n\t\tvar left;\n\t\t\n\t\tswitch(this.mode){\n\t\t\tcase \"local\":\n\t\t\t\tleft = this.table.rowManager.scrollLeft;\n\t\t\t\n\t\t\t\tthis.refreshData();\n\t\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\t\t\t\n\t\t\t\tthis.dispatchExternal(\"pageLoaded\", this.getPage());\n\t\t\t\n\t\t\t\treturn Promise.resolve();\n\t\t\t\n\t\t\tcase \"remote\":\n\t\t\t\tthis.dataChanging = true;\n\t\t\t\treturn this.reloadData(null)\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tthis.dataChanging = false;\n\t\t\t\t\t});\n\t\t\t\n\t\t\tcase \"progressive_load\":\n\t\t\tcase \"progressive_scroll\":\n\t\t\t\treturn this.reloadData(null, true);\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tconsole.warn(\"Pagination Error - no such pagination mode:\", this.mode);\n\t\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\t_parseRemoteData(data){\n\t\tvar margin, paginationOutOfRange;\n\t\t\n\t\tif(typeof data.last_page === \"undefined\"){\n\t\t\tconsole.warn(\"Remote Pagination Error - Server response missing '\" + (this.options(\"dataReceiveParams\").last_page || \"last_page\") + \"' property\");\n\t\t}\n\t\t\n\t\tif(data.data){\n\t\t\tthis.max = parseInt(data.last_page) || 1;\n\n\t\t\tthis.remoteRowCountEstimate = typeof data.last_row !== \"undefined\" ? data.last_row : (data.last_page * this.size - (this.page == data.last_page ? (this.size - data.data.length) : 0));\n\t\t\t\n\t\t\tif(this.progressiveLoad){\n\t\t\t\tswitch(this.mode){\n\t\t\t\t\tcase \"progressive_load\":\n\t\t\t\t\t\n\t\t\t\t\t\tif(this.page == 1){\n\t\t\t\t\t\t\tthis.table.rowManager.setData(data.data, false, this.page == 1);\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tthis.table.rowManager.addRows(data.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\tif(this.page < this.max){\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tthis.nextPage();\n\t\t\t\t\t\t\t}, this.table.options.progressiveLoadDelay);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"progressive_scroll\":\n\t\t\t\t\t\tdata = this.page === 1 ? data.data : this.table.rowManager.getData().concat(data.data);\n\t\t\t\t\t\n\t\t\t\t\t\tthis.table.rowManager.setData(data, this.page !== 1, this.page == 1);\n\t\t\t\t\t\n\t\t\t\t\t\tmargin = this.table.options.progressiveLoadScrollMargin || (this.table.rowManager.element.clientHeight * 2);\n\t\t\t\t\t\n\t\t\t\t\t\tif(this.table.rowManager.element.scrollHeight <= (this.table.rowManager.element.clientHeight + margin)){\n\t\t\t\t\t\t\tif(this.page < this.max){\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tthis.nextPage();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn false;\n\t\t\t}else {\n\n\t\t\t\tif(this.page > this.max){\n\t\t\t\t\tconsole.warn( \"Remote Pagination Error - Server returned last page value lower than the current page\" );\n\n\t\t\t\t\tpaginationOutOfRange = this.options('paginationOutOfRange');\n\n\t\t\t\t\tif(paginationOutOfRange){\n\t\t\t\t\t\treturn this.setPage(typeof paginationOutOfRange === 'function' ? paginationOutOfRange.call(this, this.page, this.max) :\tpaginationOutOfRange);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// left = this.table.rowManager.scrollLeft;\n\t\t\t\tthis.dispatchExternal(\"pageLoaded\",  this.getPage());\n\t\t\t\t// this.table.rowManager.scrollHorizontal(left);\n\t\t\t\t// this.table.columnManager.scrollHorizontal(left);\n\t\t\t}\n\t\t\t\n\t\t}else {\n\t\t\tconsole.warn(\"Remote Pagination Error - Server response missing '\" + (this.options(\"dataReceiveParams\").data || \"data\") + \"' property\");\n\t\t}\n\t\t\n\t\treturn data.data;\n\t}\n\t\n\t//handle the footer element being redrawn\n\tfooterRedraw(){\n\t\tvar footer = this.table.footerManager.containerElement;\n\n\t\tif((Math.ceil(footer.clientWidth) - footer.scrollWidth) < 0){\n\t\t\tthis.pagesElement.style.display = 'none';\n\t\t}else {\n\t\t\tthis.pagesElement.style.display = '';\n\t\t\t\n\t\t\tif((Math.ceil(footer.clientWidth) - footer.scrollWidth) < 0){\n\t\t\t\tthis.pagesElement.style.display = 'none';\n\t\t\t}\n\t\t}\n\t}\n}\n\n// read persistance information from storage\nvar defaultReaders = {\n\tlocal:function(id, type){\n\t\tvar data = localStorage.getItem(id + \"-\" + type);\n\n\t\treturn data ? JSON.parse(data) : false;\n\t},\n\tcookie:function(id, type){\n\t\tvar cookie = document.cookie,\n\t\tkey = id + \"-\" + type,\n\t\tcookiePos = cookie.indexOf(key + \"=\"),\n\t\tend, data;\n\n\t\t//if cookie exists, decode and load column data into tabulator\n\t\tif(cookiePos > -1){\n\t\t\tcookie = cookie.slice(cookiePos);\n\n\t\t\tend = cookie.indexOf(\";\");\n\n\t\t\tif(end > -1){\n\t\t\t\tcookie = cookie.slice(0, end);\n\t\t\t}\n\n\t\t\tdata = cookie.replace(key + \"=\", \"\");\n\t\t}\n\n\t\treturn data ? JSON.parse(data) : false;\n\t}\n};\n\n//write persistence information to storage\nvar defaultWriters = {\n\tlocal:function(id, type, data){\n\t\tlocalStorage.setItem(id + \"-\" + type, JSON.stringify(data));\n\t},\n\tcookie:function(id, type, data){\n\t\tvar expireDate = new Date();\n\n\t\texpireDate.setDate(expireDate.getDate() + 10000);\n\n\t\tdocument.cookie = id + \"-\" + type + \"=\" + JSON.stringify(data) + \"; expires=\" + expireDate.toUTCString();\n\t}\n};\n\nclass Persistence extends Module{\n\n\tstatic moduleName = \"persistence\";\n\n\tstatic moduleInitOrder = -10;\n\n\t//load defaults\n\tstatic readers = defaultReaders;\n\tstatic writers = defaultWriters;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.mode = \"\";\n\t\tthis.id = \"\";\n\t\t// this.persistProps = [\"field\", \"width\", \"visible\"];\n\t\tthis.defWatcherBlock = false;\n\t\tthis.config = {};\n\t\tthis.readFunc = false;\n\t\tthis.writeFunc = false;\n\n\t\tthis.registerTableOption(\"persistence\", false);\n\t\tthis.registerTableOption(\"persistenceID\", \"\"); //key for persistent storage\n\t\tthis.registerTableOption(\"persistenceMode\", true); //mode for storing persistence information\n\t\tthis.registerTableOption(\"persistenceReaderFunc\", false); //function for handling persistence data reading\n\t\tthis.registerTableOption(\"persistenceWriterFunc\", false); //function for handling persistence data writing\n\t}\n\n\t// Test for whether localStorage is available for use.\n\tlocalStorageTest() {\n\t\tvar  testKey =  \"_tabulator_test\";\n\n\t\ttry {\n\t\t\twindow.localStorage.setItem( testKey, testKey);\n\t\t\twindow.localStorage.removeItem( testKey );\n\t\t\treturn true;\n\t\t} catch(e) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//setup parameters\n\tinitialize(){\n\t\tif(this.table.options.persistence){\n\t\t\t//determine persistent layout storage type\n\t\t\tvar mode = this.table.options.persistenceMode,\n\t\t\tid = this.table.options.persistenceID,\n\t\t\tretrievedData;\n\n\t\t\tthis.mode = mode !== true ?  mode : (this.localStorageTest() ? \"local\" : \"cookie\");\n\n\t\t\tif(this.table.options.persistenceReaderFunc){\n\t\t\t\tif(typeof this.table.options.persistenceReaderFunc === \"function\"){\n\t\t\t\t\tthis.readFunc = this.table.options.persistenceReaderFunc;\n\t\t\t\t}else {\n\t\t\t\t\tif(Persistence.readers[this.table.options.persistenceReaderFunc]){\n\t\t\t\t\t\tthis.readFunc = Persistence.readers[this.table.options.persistenceReaderFunc];\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Persistence Read Error - invalid reader set\", this.table.options.persistenceReaderFunc);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(Persistence.readers[this.mode]){\n\t\t\t\t\tthis.readFunc = Persistence.readers[this.mode];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Persistence Read Error - invalid reader set\", this.mode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.table.options.persistenceWriterFunc){\n\t\t\t\tif(typeof this.table.options.persistenceWriterFunc === \"function\"){\n\t\t\t\t\tthis.writeFunc = this.table.options.persistenceWriterFunc;\n\t\t\t\t}else {\n\t\t\t\t\tif(Persistence.writers[this.table.options.persistenceWriterFunc]){\n\t\t\t\t\t\tthis.writeFunc = Persistence.writers[this.table.options.persistenceWriterFunc];\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Persistence Write Error - invalid reader set\", this.table.options.persistenceWriterFunc);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(Persistence.writers[this.mode]){\n\t\t\t\t\tthis.writeFunc = Persistence.writers[this.mode];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Persistence Write Error - invalid writer set\", this.mode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//set storage tag\n\t\t\tthis.id = \"tabulator-\" + (id || (this.table.element.getAttribute(\"id\") || \"\"));\n\n\t\t\tthis.config = {\n\t\t\t\tsort:this.table.options.persistence === true || this.table.options.persistence.sort,\n\t\t\t\tfilter:this.table.options.persistence === true || this.table.options.persistence.filter,\n\t\t\t\theaderFilter:this.table.options.persistence === true || this.table.options.persistence.headerFilter,\n\t\t\t\tgroup:this.table.options.persistence === true || this.table.options.persistence.group,\n\t\t\t\tpage:this.table.options.persistence === true || this.table.options.persistence.page,\n\t\t\t\tcolumns:this.table.options.persistence === true ? [\"title\", \"width\", \"visible\"] : this.table.options.persistence.columns,\n\t\t\t};\n\n\t\t\t//load pagination data if needed\n\t\t\tif(this.config.page){\n\t\t\t\tretrievedData = this.retrieveData(\"page\");\n\n\t\t\t\tif(retrievedData){\n\t\t\t\t\tif(typeof retrievedData.paginationSize !== \"undefined\" && (this.config.page === true || this.config.page.size)){\n\t\t\t\t\t\tthis.table.options.paginationSize = retrievedData.paginationSize;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(typeof retrievedData.paginationInitialPage !== \"undefined\" && (this.config.page === true || this.config.page.page)){\n\t\t\t\t\t\tthis.table.options.paginationInitialPage = retrievedData.paginationInitialPage;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//load group data if needed\n\t\t\tif(this.config.group){\n\t\t\t\tretrievedData = this.retrieveData(\"group\");\n\n\t\t\t\tif(retrievedData){\n\t\t\t\t\tif(typeof retrievedData.groupBy !== \"undefined\" && (this.config.group === true || this.config.group.groupBy)){\n\t\t\t\t\t\tthis.table.options.groupBy = retrievedData.groupBy;\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof retrievedData.groupStartOpen !== \"undefined\" && (this.config.group === true || this.config.group.groupStartOpen)){\n\t\t\t\t\t\tthis.table.options.groupStartOpen = retrievedData.groupStartOpen;\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof retrievedData.groupHeader !== \"undefined\" && (this.config.group === true || this.config.group.groupHeader)){\n\t\t\t\t\t\tthis.table.options.groupHeader = retrievedData.groupHeader;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.config.columns){\n\t\t\t\tthis.table.options.columns = this.load(\"columns\", this.table.options.columns);\n\t\t\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\t\t\tthis.subscribe(\"column-show\", this.save.bind(this, \"columns\"));\n\t\t\t\tthis.subscribe(\"column-hide\", this.save.bind(this, \"columns\"));\n\t\t\t\tthis.subscribe(\"column-moved\", this.save.bind(this, \"columns\"));\n\t\t\t}\n\n\t\t\tthis.subscribe(\"table-built\", this.tableBuilt.bind(this), 0);\n\n\t\t\tthis.subscribe(\"table-redraw\", this.tableRedraw.bind(this));\n\n\t\t\tthis.subscribe(\"filter-changed\", this.eventSave.bind(this, \"filter\"));\n\t\t\tthis.subscribe(\"filter-changed\", this.eventSave.bind(this, \"headerFilter\"));\n\t\t\tthis.subscribe(\"sort-changed\", this.eventSave.bind(this, \"sort\"));\n\t\t\tthis.subscribe(\"group-changed\", this.eventSave.bind(this, \"group\"));\n\t\t\tthis.subscribe(\"page-changed\", this.eventSave.bind(this, \"page\"));\n\t\t\tthis.subscribe(\"column-resized\", this.eventSave.bind(this, \"columns\"));\n\t\t\tthis.subscribe(\"column-width\", this.eventSave.bind(this, \"columns\"));\n\t\t\tthis.subscribe(\"layout-refreshed\", this.eventSave.bind(this, \"columns\"));\n\t\t}\n\n\t\tthis.registerTableFunction(\"getColumnLayout\", this.getColumnLayout.bind(this));\n\t\tthis.registerTableFunction(\"setColumnLayout\", this.setColumnLayout.bind(this));\n\t}\n\n\teventSave(type){\n\t\tif(this.config[type]){\n\t\t\tthis.save(type);\n\t\t}\n\t}\n\n\ttableBuilt(){\n\t\tvar sorters, filters, headerFilters;\n\n\t\tif(this.config.sort){\n\t\t\tsorters = this.load(\"sort\");\n\n\t\t\tif(!sorters === false){\n\t\t\t\tthis.table.options.initialSort = sorters;\n\t\t\t}\n\t\t}\n\n\t\tif(this.config.filter){\n\t\t\tfilters = this.load(\"filter\");\n\n\t\t\tif(!filters === false){\n\t\t\t\tthis.table.options.initialFilter = filters;\n\t\t\t}\n\t\t}\n\t\tif(this.config.headerFilter){\n\t\t\theaderFilters = this.load(\"headerFilter\");\n\n\t\t\tif(!headerFilters === false){\n\t\t\t\tthis.table.options.initialHeaderFilter = headerFilters;\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\n\ttableRedraw(force){\n\t\tif(force && this.config.columns){\n\t\t\tthis.save(\"columns\");\n\t\t}\n\t}\n\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\n\tgetColumnLayout(){\n\t\treturn this.parseColumns(this.table.columnManager.getColumns());\n\t}\n\n\tsetColumnLayout(layout){\n\t\tthis.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns, layout, true));\n\t\treturn true;\n\t}\n\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\n\tinitializeColumn(column){\n\t\tvar def, keys;\n\n\t\tif(this.config.columns){\n\t\t\tthis.defWatcherBlock = true;\n\n\t\t\tdef = column.getDefinition();\n\n\t\t\tkeys = this.config.columns === true ? Object.keys(def) : this.config.columns;\n\n\t\t\tkeys.forEach((key)=>{\n\t\t\t\tvar props = Object.getOwnPropertyDescriptor(def, key);\n\t\t\t\tvar value = def[key];\n\n\t\t\t\tif(props){\n\t\t\t\t\tObject.defineProperty(def, key, {\n\t\t\t\t\t\tset: (newValue) => {\n\t\t\t\t\t\t\tvalue = newValue;\n\n\t\t\t\t\t\t\tif(!this.defWatcherBlock){\n\t\t\t\t\t\t\t\tthis.save(\"columns\");\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(props.set){\n\t\t\t\t\t\t\t\tprops.set(newValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tget:() => {\n\t\t\t\t\t\t\tif(props.get){\n\t\t\t\t\t\t\t\tprops.get();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.defWatcherBlock = false;\n\t\t}\n\t}\n\n\t//load saved definitions\n\tload(type, current){\n\t\tvar data = this.retrieveData(type);\n\n\t\tif(current){\n\t\t\tdata = data ? this.mergeDefinition(current, data) : current;\n\t\t}\n\n\t\treturn data;\n\t}\n\n\t//retrieve data from memory\n\tretrieveData(type){\n\t\treturn this.readFunc ? this.readFunc(this.id, type) : false;\n\t}\n\n\t//merge old and new column definitions\n\tmergeDefinition(oldCols, newCols, mergeAllNew){\n\t\tvar output = [];\n\n\t\tnewCols = newCols || [];\n\n\t\tnewCols.forEach((column, to) => {\n\t\t\tvar from = this._findColumn(oldCols, column),\n\t\t\tkeys;\n\n\t\t\tif(from){\n\t\t\t\tif(mergeAllNew){\n\t\t\t\t\tkeys = Object.keys(column);\n\t\t\t\t}else if(this.config.columns === true || this.config.columns == undefined){\n\t\t\t\t\tkeys =  Object.keys(from);\n\t\t\t\t\tkeys.push(\"width\");\n\t\t\t\t}else {\n\t\t\t\t\tkeys = this.config.columns;\n\t\t\t\t}\n\n\t\t\t\tkeys.forEach((key)=>{\n\t\t\t\t\tif(key !== \"columns\" && typeof column[key] !== \"undefined\"){\n\t\t\t\t\t\tfrom[key] = column[key];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(from.columns){\n\t\t\t\t\tfrom.columns = this.mergeDefinition(from.columns, column.columns);\n\t\t\t\t}\n\n\t\t\t\toutput.push(from);\n\t\t\t}\n\t\t});\n\n\t\toldCols.forEach((column, i) => {\n\t\t\tvar from = this._findColumn(newCols, column);\n\n\t\t\tif (!from) {\n\t\t\t\tif(output.length>i){\n\t\t\t\t\toutput.splice(i, 0, column);\n\t\t\t\t}else {\n\t\t\t\t\toutput.push(column);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\t//find matching columns\n\t_findColumn(columns, subject){\n\t\tvar type = subject.columns ? \"group\" : (subject.field ? \"field\" : \"object\");\n\n\t\treturn columns.find(function(col){\n\t\t\tswitch(type){\n\t\t\t\tcase \"group\":\n\t\t\t\t\treturn col.title === subject.title && col.columns.length === subject.columns.length;\n\n\t\t\t\tcase \"field\":\n\t\t\t\t\treturn col.field === subject.field;\n\n\t\t\t\tcase \"object\":\n\t\t\t\t\treturn col === subject;\n\t\t\t}\n\t\t});\n\t}\n\n\t//save data\n\tsave(type){\n\t\tvar data = {};\n\n\t\tswitch(type){\n\t\t\tcase \"columns\":\n\t\t\t\tdata = this.parseColumns(this.table.columnManager.getColumns());\n\t\t\t\tbreak;\n\n\t\t\tcase \"filter\":\n\t\t\t\tdata = this.table.modules.filter.getFilters();\n\t\t\t\tbreak;\n\n\t\t\tcase \"headerFilter\":\n\t\t\t\tdata = this.table.modules.filter.getHeaderFilters();\n\t\t\t\tbreak;\n\n\t\t\tcase \"sort\":\n\t\t\t\tdata = this.validateSorters(this.table.modules.sort.getSort());\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tdata = this.getGroupConfig();\n\t\t\t\tbreak;\n\n\t\t\tcase \"page\":\n\t\t\t\tdata = this.getPageConfig();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif(this.writeFunc){\n\t\t\tthis.writeFunc(this.id, type, data);\n\t\t}\n\n\t}\n\n\t//ensure sorters contain no function data\n\tvalidateSorters(data){\n\t\tdata.forEach(function(item){\n\t\t\titem.column = item.field;\n\t\t\tdelete item.field;\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tgetGroupConfig(){\n\t\tvar data = {};\n\n\t\tif(this.config.group){\n\t\t\tif(this.config.group === true || this.config.group.groupBy){\n\t\t\t\tdata.groupBy = this.table.options.groupBy;\n\t\t\t}\n\n\t\t\tif(this.config.group === true || this.config.group.groupStartOpen){\n\t\t\t\tdata.groupStartOpen = this.table.options.groupStartOpen;\n\t\t\t}\n\n\t\t\tif(this.config.group === true || this.config.group.groupHeader){\n\t\t\t\tdata.groupHeader = this.table.options.groupHeader;\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tgetPageConfig(){\n\t\tvar data = {};\n\n\t\tif(this.config.page){\n\t\t\tif(this.config.page === true || this.config.page.size){\n\t\t\t\tdata.paginationSize = this.table.modules.page.getPageSize();\n\t\t\t}\n\n\t\t\tif(this.config.page === true || this.config.page.page){\n\t\t\t\tdata.paginationInitialPage = this.table.modules.page.getPage();\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\n\n\t//parse columns for data to store\n\tparseColumns(columns){\n\t\tvar definitions = [],\n\t\texcludedKeys = [\"headerContextMenu\", \"headerMenu\", \"contextMenu\", \"clickMenu\"];\n\n\t\tcolumns.forEach((column) => {\n\t\t\tvar defStore = {},\n\t\t\tcolDef = column.getDefinition(),\n\t\t\tkeys;\n\n\t\t\tif(column.isGroup){\n\t\t\t\tdefStore.title = colDef.title;\n\t\t\t\tdefStore.columns = this.parseColumns(column.getColumns());\n\t\t\t}else {\n\t\t\t\tdefStore.field = column.getField();\n\n\t\t\t\tif(this.config.columns === true || this.config.columns == undefined){\n\t\t\t\t\tkeys =  Object.keys(colDef);\n\t\t\t\t\tkeys.push(\"width\");\n\t\t\t\t\tkeys.push(\"visible\");\n\t\t\t\t}else {\n\t\t\t\t\tkeys = this.config.columns;\n\t\t\t\t}\n\n\t\t\t\tkeys.forEach((key)=>{\n\t\t\t\t\tswitch(key){\n\t\t\t\t\t\tcase \"width\":\n\t\t\t\t\t\t\tdefStore.width = column.getWidth();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"visible\":\n\t\t\t\t\t\t\tdefStore.visible = column.visible;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif(typeof colDef[key] !== \"function\" && excludedKeys.indexOf(key) === -1){\n\t\t\t\t\t\t\t\tdefStore[key] = colDef[key];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tdefinitions.push(defStore);\n\t\t});\n\n\t\treturn definitions;\n\t}\n}\n\nclass Popup extends Module{\n\t\n\tstatic moduleName = \"popup\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.columnSubscribers = {};\n\t\t\n\t\tthis.registerTableOption(\"rowContextPopup\", false);\n\t\tthis.registerTableOption(\"rowClickPopup\", false);\n\t\tthis.registerTableOption(\"rowDblClickPopup\", false);\n\t\tthis.registerTableOption(\"groupContextPopup\", false);\n\t\tthis.registerTableOption(\"groupClickPopup\", false);\n\t\tthis.registerTableOption(\"groupDblClickPopup\", false);\n\t\t\n\t\tthis.registerColumnOption(\"headerContextPopup\");\n\t\tthis.registerColumnOption(\"headerClickPopup\");\n\t\tthis.registerColumnOption(\"headerDblClickPopup\");\n\t\tthis.registerColumnOption(\"headerPopup\");\n\t\tthis.registerColumnOption(\"headerPopupIcon\");\n\t\tthis.registerColumnOption(\"contextPopup\");\n\t\tthis.registerColumnOption(\"clickPopup\");\n\t\tthis.registerColumnOption(\"dblClickPopup\");\n\n\t\tthis.registerComponentFunction(\"cell\", \"popup\", this._componentPopupCall.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"popup\", this._componentPopupCall.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"popup\", this._componentPopupCall.bind(this));\n\t\tthis.registerComponentFunction(\"group\", \"popup\", this._componentPopupCall.bind(this));\n\t\t\n\t}\n\t\n\tinitialize(){\n\t\tthis.initializeRowWatchers();\n\t\tthis.initializeGroupWatchers();\n\t\t\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t}\n\n\t_componentPopupCall(component, contents, position){\n\t\tthis.loadPopupEvent(contents, null, component, position);\n\t}\n\t\n\tinitializeRowWatchers(){\n\t\tif(this.table.options.rowContextPopup){\n\t\t\tthis.subscribe(\"row-contextmenu\", this.loadPopupEvent.bind(this, this.table.options.rowContextPopup));\n\t\t\tthis.table.on(\"rowTapHold\", this.loadPopupEvent.bind(this, this.table.options.rowContextPopup));\n\t\t}\n\t\t\n\t\tif(this.table.options.rowClickPopup){\n\t\t\tthis.subscribe(\"row-click\", this.loadPopupEvent.bind(this, this.table.options.rowClickPopup));\n\t\t}\n\n\t\tif(this.table.options.rowDblClickPopup){\n\t\t\tthis.subscribe(\"row-dblclick\", this.loadPopupEvent.bind(this, this.table.options.rowDblClickPopup));\n\t\t}\n\t}\n\t\n\tinitializeGroupWatchers(){\n\t\tif(this.table.options.groupContextPopup){\n\t\t\tthis.subscribe(\"group-contextmenu\", this.loadPopupEvent.bind(this, this.table.options.groupContextPopup));\n\t\t\tthis.table.on(\"groupTapHold\", this.loadPopupEvent.bind(this, this.table.options.groupContextPopup));\n\t\t}\n\t\t\n\t\tif(this.table.options.groupClickPopup){\n\t\t\tthis.subscribe(\"group-click\", this.loadPopupEvent.bind(this, this.table.options.groupClickPopup));\n\t\t}\n\n\t\tif(this.table.options.groupDblClickPopup){\n\t\t\tthis.subscribe(\"group-dblclick\", this.loadPopupEvent.bind(this, this.table.options.groupDblClickPopup));\n\t\t}\n\t}\n\n\tinitializeColumn(column){\n\t\tvar def = column.definition;\n\t\t\n\t\t//handle column events\n\t\tif(def.headerContextPopup && !this.columnSubscribers.headerContextPopup){\n\t\t\tthis.columnSubscribers.headerContextPopup = this.loadPopupTableColumnEvent.bind(this, \"headerContextPopup\");\n\t\t\tthis.subscribe(\"column-contextmenu\", this.columnSubscribers.headerContextPopup);\n\t\t\tthis.table.on(\"headerTapHold\", this.loadPopupTableColumnEvent.bind(this, \"headerContextPopup\"));\n\t\t}\n\t\t\n\t\tif(def.headerClickPopup && !this.columnSubscribers.headerClickPopup){\n\t\t\tthis.columnSubscribers.headerClickPopup = this.loadPopupTableColumnEvent.bind(this, \"headerClickPopup\");\n\t\t\tthis.subscribe(\"column-click\", this.columnSubscribers.headerClickPopup);\n\t\t\n\t\t\n\t\t}if(def.headerDblClickPopup && !this.columnSubscribers.headerDblClickPopup){\n\t\t\tthis.columnSubscribers.headerDblClickPopup = this.loadPopupTableColumnEvent.bind(this, \"headerDblClickPopup\");\n\t\t\tthis.subscribe(\"column-dblclick\", this.columnSubscribers.headerDblClickPopup);\n\t\t}\n\t\t\n\t\tif(def.headerPopup){\n\t\t\tthis.initializeColumnHeaderPopup(column);\n\t\t}\n\t\t\n\t\t//handle cell events\n\t\tif(def.contextPopup && !this.columnSubscribers.contextPopup){\n\t\t\tthis.columnSubscribers.contextPopup = this.loadPopupTableCellEvent.bind(this, \"contextPopup\");\n\t\t\tthis.subscribe(\"cell-contextmenu\", this.columnSubscribers.contextPopup);\n\t\t\tthis.table.on(\"cellTapHold\", this.loadPopupTableCellEvent.bind(this, \"contextPopup\"));\n\t\t}\n\t\t\n\t\tif(def.clickPopup && !this.columnSubscribers.clickPopup){\n\t\t\tthis.columnSubscribers.clickPopup = this.loadPopupTableCellEvent.bind(this, \"clickPopup\");\n\t\t\tthis.subscribe(\"cell-click\", this.columnSubscribers.clickPopup);\n\t\t}\n\n\t\tif(def.dblClickPopup && !this.columnSubscribers.dblClickPopup){\n\t\t\tthis.columnSubscribers.dblClickPopup = this.loadPopupTableCellEvent.bind(this, \"dblClickPopup\");\n\t\t\tthis.subscribe(\"cell-click\", this.columnSubscribers.dblClickPopup);\n\t\t}\n\t}\n\t\n\tinitializeColumnHeaderPopup(column){\n\t\tvar icon = column.definition.headerPopupIcon,\n\t\theaderPopupEl;\n\t\t\n\t\theaderPopupEl = document.createElement(\"span\");\n\t\theaderPopupEl.classList.add(\"tabulator-header-popup-button\");\n\n\t\tif(icon){\n\t\t\tif(typeof icon === \"function\"){\n\t\t\t\ticon = icon(column.getComponent());\n\t\t\t}\n\n\t\t\tif(icon instanceof HTMLElement){\n\t\t\t\theaderPopupEl.appendChild(icon);\n\t\t\t}else {\n\t\t\t\theaderPopupEl.innerHTML = icon;\n\t\t\t}\n\t\t}else {\n\t\t\theaderPopupEl.innerHTML = \"&vellip;\";\n\t\t}\n\t\t\n\t\theaderPopupEl.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tthis.loadPopupEvent(column.definition.headerPopup, e, column);\n\t\t});\n\t\t\n\t\tcolumn.titleElement.insertBefore(headerPopupEl, column.titleElement.firstChild);\n\t}\n\t\n\tloadPopupTableCellEvent(option, e, cell){\n\t\tif(cell._cell){\n\t\t\tcell = cell._cell;\n\t\t}\n\t\t\n\t\tif(cell.column.definition[option]){\n\t\t\tthis.loadPopupEvent(cell.column.definition[option], e, cell);\n\t\t}\n\t}\n\t\n\tloadPopupTableColumnEvent(option, e, column){\n\t\tif(column._column){\n\t\t\tcolumn = column._column;\n\t\t}\n\t\t\n\t\tif(column.definition[option]){\n\t\t\tthis.loadPopupEvent(column.definition[option], e, column);\n\t\t}\n\t}\n\t\n\tloadPopupEvent(contents, e, component, position){\n\t\tvar renderedCallback;\n\n\t\tfunction onRendered(callback){\n\t\t\trenderedCallback = callback;\n\t\t}\n\t\t\n\t\tif(component._group){\n\t\t\tcomponent = component._group;\n\t\t}else if(component._row){\n\t\t\tcomponent = component._row;\n\t\t}\n\t\t\n\t\tcontents = typeof contents == \"function\" ? contents.call(this.table, e, component.getComponent(),  onRendered) : contents;\n\t\t\n\t\tthis.loadPopup(e, component, contents, renderedCallback, position);\n\t}\n\t\n\tloadPopup(e, component, contents, renderedCallback, position){\n\t\tvar touch = !(e instanceof MouseEvent),\n\t\tcontentsEl, popup;\n\t\t\n\t\tif(contents instanceof HTMLElement){\n\t\t\tcontentsEl = contents;\n\t\t}else {\n\t\t\tcontentsEl = document.createElement(\"div\");\n\t\t\tcontentsEl.innerHTML = contents;\n\t\t}\n\t\t\n\t\tcontentsEl.classList.add(\"tabulator-popup\");\n\n\t\tcontentsEl.addEventListener(\"click\", (e) =>{\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tif(!touch){\n\t\t\te.preventDefault();\n\t\t}\n\t\t\n\t\tpopup = this.popup(contentsEl);\n\n\t\tif(typeof renderedCallback === \"function\"){\n\t\t\tpopup.renderCallback(renderedCallback);\n\t\t}\n\n\t\tif(e){\n\t\t\tpopup.show(e);\n\t\t}else {\n\t\t\tpopup.show(component.getElement(), position || \"center\");\n\t\t}\n\n\t\t\n\t\tpopup.hideOnBlur(() => {\n\t\t\tthis.dispatchExternal(\"popupClosed\", component.getComponent());\n\t\t});\n\n\t\tthis.dispatchExternal(\"popupOpened\", component.getComponent());\n\t}\n}\n\nclass Print extends Module{\n\n\tstatic moduleName = \"print\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.element = false;\n\t\tthis.manualBlock = false;\n\t\tthis.beforeprintEventHandler = null;\n\t\tthis.afterprintEventHandler = null;\n\n\t\tthis.registerTableOption(\"printAsHtml\", false); //enable print as html\n\t\tthis.registerTableOption(\"printFormatter\", false); //printing page formatter\n\t\tthis.registerTableOption(\"printHeader\", false); //page header contents\n\t\tthis.registerTableOption(\"printFooter\", false); //page footer contents\n\t\tthis.registerTableOption(\"printStyled\", true); //enable print as html styling\n\t\tthis.registerTableOption(\"printRowRange\", \"visible\"); //restrict print to visible rows only\n\t\tthis.registerTableOption(\"printConfig\", {}); //print config options\n\n\t\tthis.registerColumnOption(\"print\");\n\t\tthis.registerColumnOption(\"titlePrint\");\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.printAsHtml){\n\t\t\tthis.beforeprintEventHandler = this.replaceTable.bind(this);\n\t\t\tthis.afterprintEventHandler = this.cleanup.bind(this);\n\n\t\t\twindow.addEventListener(\"beforeprint\", this.beforeprintEventHandler );\n\t\t\twindow.addEventListener(\"afterprint\", this.afterprintEventHandler);\n\t\t\tthis.subscribe(\"table-destroy\", this.destroy.bind(this));\n\t\t}\n\n\t\tthis.registerTableFunction(\"print\", this.printFullscreen.bind(this));\n\t}\n\n\tdestroy(){\n\t\tif(this.table.options.printAsHtml){\n\t\t\twindow.removeEventListener( \"beforeprint\", this.beforeprintEventHandler );\n\t\t\twindow.removeEventListener( \"afterprint\", this.afterprintEventHandler );\n\t\t}\n\t}\n\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\n\treplaceTable(){\n\t\tif(!this.manualBlock){\n\t\t\tthis.element = document.createElement(\"div\");\n\t\t\tthis.element.classList.add(\"tabulator-print-table\");\n\n\t\t\tthis.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig, this.table.options.printStyled, this.table.options.printRowRange, \"print\"));\n\n\t\t\tthis.table.element.style.display = \"none\";\n\n\t\t\tthis.table.element.parentNode.insertBefore(this.element, this.table.element);\n\t\t}\n\t}\n\n\tcleanup(){\n\t\tdocument.body.classList.remove(\"tabulator-print-fullscreen-hide\");\n\n\t\tif(this.element && this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\tthis.table.element.style.display = \"\";\n\t\t}\n\t}\n\n\tprintFullscreen(visible, style, config){\n\t\tvar scrollX = window.scrollX,\n\t\tscrollY = window.scrollY,\n\t\theaderEl = document.createElement(\"div\"),\n\t\tfooterEl = document.createElement(\"div\"),\n\t\ttableEl = this.table.modules.export.generateTable(typeof config != \"undefined\" ? config : this.table.options.printConfig, typeof style != \"undefined\" ? style : this.table.options.printStyled, visible || this.table.options.printRowRange, \"print\"),\n\t\theaderContent, footerContent;\n\n\t\tthis.manualBlock = true;\n\n\t\tthis.element = document.createElement(\"div\");\n\t\tthis.element.classList.add(\"tabulator-print-fullscreen\");\n\n\t\tif(this.table.options.printHeader){\n\t\t\theaderEl.classList.add(\"tabulator-print-header\");\n\n\t\t\theaderContent = typeof this.table.options.printHeader == \"function\" ? this.table.options.printHeader.call(this.table) : this.table.options.printHeader;\n\n\t\t\tif(typeof headerContent == \"string\"){\n\t\t\t\theaderEl.innerHTML = headerContent;\n\t\t\t}else {\n\t\t\t\theaderEl.appendChild(headerContent);\n\t\t\t}\n\n\t\t\tthis.element.appendChild(headerEl);\n\t\t}\n\n\t\tthis.element.appendChild(tableEl);\n\n\t\tif(this.table.options.printFooter){\n\t\t\tfooterEl.classList.add(\"tabulator-print-footer\");\n\n\t\t\tfooterContent = typeof this.table.options.printFooter == \"function\" ? this.table.options.printFooter.call(this.table) : this.table.options.printFooter;\n\n\n\t\t\tif(typeof footerContent == \"string\"){\n\t\t\t\tfooterEl.innerHTML = footerContent;\n\t\t\t}else {\n\t\t\t\tfooterEl.appendChild(footerContent);\n\t\t\t}\n\n\t\t\tthis.element.appendChild(footerEl);\n\t\t}\n\n\t\tdocument.body.classList.add(\"tabulator-print-fullscreen-hide\");\n\t\tdocument.body.appendChild(this.element);\n\n\t\tif(this.table.options.printFormatter){\n\t\t\tthis.table.options.printFormatter(this.element, tableEl);\n\t\t}\n\n\t\twindow.print();\n\n\t\tthis.cleanup();\n\n\t\twindow.scrollTo(scrollX, scrollY);\n\n\t\tthis.manualBlock = false;\n\t}\n}\n\nclass ReactiveData extends Module{\n\n\tstatic moduleName = \"reactiveData\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.data = false;\n\t\tthis.blocked = false; //block reactivity while performing update\n\t\tthis.origFuncs = {}; // hold original data array functions to allow replacement after data is done with\n\t\tthis.currentVersion = 0;\n\t\t\n\t\tthis.registerTableOption(\"reactiveData\", false); //enable data reactivity\n\t}\n\t\n\tinitialize(){\n\t\tif(this.table.options.reactiveData){\n\t\t\tthis.subscribe(\"cell-value-save-before\", this.block.bind(this, \"cellsave\"));\n\t\t\tthis.subscribe(\"cell-value-save-after\", this.unblock.bind(this, \"cellsave\"));\n\t\t\tthis.subscribe(\"row-data-save-before\", this.block.bind(this, \"rowsave\"));\n\t\t\tthis.subscribe(\"row-data-save-after\", this.unblock.bind(this, \"rowsave\"));\n\t\t\tthis.subscribe(\"row-data-init-after\", this.watchRow.bind(this));\n\t\t\tthis.subscribe(\"data-processing\", this.watchData.bind(this));\n\t\t\tthis.subscribe(\"table-destroy\", this.unwatchData.bind(this));\n\t\t}\n\t}\n\t\n\twatchData(data){\n\t\tvar self = this,\n\t\tversion;\n\t\t\n\t\tthis.currentVersion ++;\n\t\t\n\t\tversion = this.currentVersion;\n\t\t\n\t\tthis.unwatchData();\n\t\t\n\t\tthis.data = data;\n\t\t\n\t\t//override array push function\n\t\tthis.origFuncs.push = data.push;\n\t\t\n\t\tObject.defineProperty(this.data, \"push\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar args = Array.from(arguments),\n\t\t\t\tresult;\n\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\t\n\t\t\t\t\tself.block(\"data-push\");\n\n\t\t\t\t\targs.forEach((arg) => {\n\t\t\t\t\t\tself.table.rowManager.addRowActual(arg, false);\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tresult = self.origFuncs.push.apply(data, arguments);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"data-push\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t\t\n\t\t//override array unshift function\n\t\tthis.origFuncs.unshift = data.unshift;\n\t\t\n\t\tObject.defineProperty(this.data, \"unshift\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar args = Array.from(arguments),\n\t\t\t\tresult;\n\t\t\t\t\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"data-unshift\");\n\t\t\t\t\t\n\t\t\t\t\targs.forEach((arg) => {\n\t\t\t\t\t\tself.table.rowManager.addRowActual(arg, true);\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tresult = self.origFuncs.unshift.apply(data, arguments);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"data-unshift\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t\t\n\t\t\n\t\t//override array shift function\n\t\tthis.origFuncs.shift = data.shift;\n\t\t\n\t\tObject.defineProperty(this.data, \"shift\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar row, result;\n\t\t\t\t\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"data-shift\");\n\t\t\t\t\t\n\t\t\t\t\tif(self.data.length){\n\t\t\t\t\t\trow = self.table.rowManager.getRowFromDataObject(self.data[0]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(row){\n\t\t\t\t\t\t\trow.deleteActual();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = self.origFuncs.shift.call(data);\n\n\t\t\t\t\tself.unblock(\"data-shift\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t\t\n\t\t//override array pop function\n\t\tthis.origFuncs.pop = data.pop;\n\t\t\n\t\tObject.defineProperty(this.data, \"pop\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar row, result;\n\t\t\t\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"data-pop\");\n\t\t\t\t\t\n\t\t\t\t\tif(self.data.length){\n\t\t\t\t\t\trow = self.table.rowManager.getRowFromDataObject(self.data[self.data.length - 1]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(row){\n\t\t\t\t\t\t\trow.deleteActual();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = self.origFuncs.pop.call(data);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"data-pop\");\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t\t\n\t\t\n\t\t//override array splice function\n\t\tthis.origFuncs.splice = data.splice;\n\t\t\n\t\tObject.defineProperty(this.data, \"splice\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar args = Array.from(arguments),\n\t\t\t\tstart = args[0] < 0 ? data.length + args[0] : args[0],\n\t\t\t\tend = args[1],\n\t\t\t\tnewRows = args[2] ? args.slice(2) : false,\n\t\t\t\tstartRow, result;\n\t\t\t\t\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"data-splice\");\n\t\t\t\t\t//add new rows\n\t\t\t\t\tif(newRows){\n\t\t\t\t\t\tstartRow = data[start] ? self.table.rowManager.getRowFromDataObject(data[start]) : false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(startRow){\n\t\t\t\t\t\t\tnewRows.forEach((rowData) => {\n\t\t\t\t\t\t\t\tself.table.rowManager.addRowActual(rowData, true, startRow, true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tnewRows = newRows.slice().reverse();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tnewRows.forEach((rowData) => {\n\t\t\t\t\t\t\t\tself.table.rowManager.addRowActual(rowData, true, false, true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t//delete removed rows\n\t\t\t\t\tif(end !== 0){\n\t\t\t\t\t\tvar oldRows = data.slice(start, typeof args[1] === \"undefined\" ? args[1] : start + end);\n\t\t\t\t\t\t\n\t\t\t\t\t\toldRows.forEach((rowData, i) => {\n\t\t\t\t\t\t\tvar row = self.table.rowManager.getRowFromDataObject(rowData);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(row){\n\t\t\t\t\t\t\t\trow.deleteActual(i !== oldRows.length - 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(newRows || end !== 0){\n\t\t\t\t\t\tself.table.rowManager.reRenderInPosition();\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = self.origFuncs.splice.apply(data, arguments);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"data-splice\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn result ;\n\t\t\t}\n\t\t});\n\t}\n\t\n\tunwatchData(){\n\t\tif(this.data !== false){\n\t\t\tfor(var key in this.origFuncs){\n\t\t\t\tObject.defineProperty(this.data, key, {\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tconfigurable:true,\n\t\t\t\t\twritable:true,\n\t\t\t\t\tvalue: this.origFuncs.key,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\t\n\twatchRow(row){\n\t\tvar data = row.getData();\n\t\t\n\t\tfor(var key in data){\n\t\t\tthis.watchKey(row, data, key);\n\t\t}\n\t\t\n\t\tif(this.table.options.dataTree){\n\t\t\tthis.watchTreeChildren(row);\n\t\t}\n\t}\n\t\n\twatchTreeChildren (row){\n\t\tvar self = this,\n\t\tchildField = row.getData()[this.table.options.dataTreeChildField],\n\t\torigFuncs = {};\n\t\t\n\t\tif(childField){\n\t\t\t\n\t\t\torigFuncs.push = childField.push;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"push\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-push\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result = origFuncs.push.apply(childField, arguments);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-push\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\torigFuncs.unshift = childField.unshift;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"unshift\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-unshift\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result =  origFuncs.unshift.apply(childField, arguments);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-unshift\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\torigFuncs.shift = childField.shift;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"shift\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-shift\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result =  origFuncs.shift.call(childField);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-shift\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\torigFuncs.pop = childField.pop;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"pop\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-pop\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result =  origFuncs.pop.call(childField);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-pop\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\torigFuncs.splice = childField.splice;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"splice\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-splice\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result =  origFuncs.splice.apply(childField, arguments);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-splice\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\t\n\trebuildTree(row){\n\t\tthis.table.modules.dataTree.initializeRow(row);\n\t\tthis.table.modules.dataTree.layoutRow(row);\n\t\tthis.table.rowManager.refreshActiveData(\"tree\", false, true);\n\t}\n\t\n\twatchKey(row, data, key){\n\t\tvar self = this,\n\t\tprops = Object.getOwnPropertyDescriptor(data, key),\n\t\tvalue = data[key],\n\t\tversion = this.currentVersion;\n\t\t\n\t\tObject.defineProperty(data, key, {\n\t\t\tset: (newValue) => {\n\t\t\t\tvalue = newValue;\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"key\");\n\t\t\t\t\t\n\t\t\t\t\tvar update = {};\n\t\t\t\t\tupdate[key] = newValue;\n\t\t\t\t\trow.updateData(update);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"key\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(props.set){\n\t\t\t\t\tprops.set(newValue);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget:() => {\n\t\t\t\t\n\t\t\t\tif(props.get){\n\t\t\t\t\tprops.get();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn value;\n\t\t\t}\n\t\t});\n\t}\n\t\n\tunwatchRow(row){\n\t\tvar data = row.getData();\n\t\t\n\t\tfor(var key in data){\n\t\t\tObject.defineProperty(data, key, {\n\t\t\t\tvalue:data[key],\n\t\t\t});\n\t\t}\n\t}\n\t\n\tblock(key){\n\t\tif(!this.blocked){\n\t\t\tthis.blocked = key;\n\t\t}\n\t}\n\t\n\tunblock(key){\n\t\tif(this.blocked === key){\n\t\t\tthis.blocked = false;\n\t\t}\n\t}\n}\n\nclass ResizeColumns extends Module{\n\n\tstatic moduleName = \"resizeColumns\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.startColumn = false;\n\t\tthis.startX = false;\n\t\tthis.startWidth = false;\n\t\tthis.latestX = false;\n\t\tthis.handle = null;\n\t\tthis.initialNextColumn = null;\n\t\tthis.nextColumn = null;\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.registerColumnOption(\"resizable\", true);\n\t\tthis.registerTableOption(\"resizableColumnFit\", false);\n\t\tthis.registerTableOption(\"resizableColumnGuide\", false);\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"column-rendered\", this.layoutColumnHeader.bind(this));\n\t}\n\t\n\tinitializeEventWatchers(){\n\t\tif(!this.initialized){\n\t\t\t\n\t\t\tthis.subscribe(\"cell-rendered\", this.layoutCellHandles.bind(this));\n\t\t\tthis.subscribe(\"cell-delete\", this.deInitializeComponent.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"cell-height\", this.resizeHandle.bind(this));\n\t\t\tthis.subscribe(\"column-moved\", this.columnLayoutUpdated.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"column-hide\", this.deInitializeColumn.bind(this));\n\t\t\tthis.subscribe(\"column-show\", this.columnLayoutUpdated.bind(this));\n\t\t\tthis.subscribe(\"column-width\", this.columnWidthUpdated.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"column-delete\", this.deInitializeComponent.bind(this));\n\t\t\tthis.subscribe(\"column-height\", this.resizeHandle.bind(this));\n\t\t\t\n\t\t\tthis.initialized = true;\n\t\t}\n\t}\n\t\n\t\n\tlayoutCellHandles(cell){\n\t\tif(cell.row.type === \"row\"){\n\t\t\tthis.deInitializeComponent(cell);\n\t\t\tthis.initializeColumn(\"cell\", cell, cell.column, cell.element);\n\t\t}\n\t}\n\t\n\tlayoutColumnHeader(column){\n\t\tif(column.definition.resizable){\n\t\t\tthis.initializeEventWatchers();\n\t\t\tthis.deInitializeComponent(column);\n\t\t\tthis.initializeColumn(\"header\", column, column, column.element);\n\t\t}\n\t}\n\t\n\tcolumnLayoutUpdated(column){\n\t\tvar prev = column.prevColumn();\n\t\t\n\t\tthis.reinitializeColumn(column);\n\t\t\n\t\tif(prev){\n\t\t\tthis.reinitializeColumn(prev);\n\t\t}\n\t}\n\t\n\tcolumnWidthUpdated(column){\n\t\tif(column.modules.frozen){\n\t\t\tif(this.table.modules.frozenColumns.leftColumns.includes(column)){\n\t\t\t\tthis.table.modules.frozenColumns.leftColumns.forEach((col) => {\n\t\t\t\t\tthis.reinitializeColumn(col);\n\t\t\t\t});\n\t\t\t}else if(this.table.modules.frozenColumns.rightColumns.includes(column)){\n\t\t\t\tthis.table.modules.frozenColumns.rightColumns.forEach((col) => {\n\t\t\t\t\tthis.reinitializeColumn(col);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tfrozenColumnOffset(column){\n\t\tvar offset = false;\n\n\t\tif(column.modules.frozen){\n\t\t\toffset = column.modules.frozen.marginValue; \n\n\t\t\tif(column.modules.frozen.position === \"left\"){\n\t\t\t\toffset += column.getWidth() - 3;\n\t\t\t}else {\n\t\t\t\tif(offset){\n\t\t\t\t\toffset -= 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn offset !== false ? offset + \"px\" : false;\n\t}\n\t\n\treinitializeColumn(column){\n\t\tvar frozenOffset = this.frozenColumnOffset(column);\n\t\t\n\t\tcolumn.cells.forEach((cell) => {\n\t\t\tif(cell.modules.resize && cell.modules.resize.handleEl){\n\t\t\t\tif(frozenOffset){\n\t\t\t\t\tcell.modules.resize.handleEl.style[column.modules.frozen.position] = frozenOffset;\n\t\t\t\t\tcell.modules.resize.handleEl.style[\"z-index\"] = 11;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcell.element.after(cell.modules.resize.handleEl);\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(column.modules.resize && column.modules.resize.handleEl){\n\t\t\tif(frozenOffset){\n\t\t\t\tcolumn.modules.resize.handleEl.style[column.modules.frozen.position] = frozenOffset;\n\t\t\t}\n\t\t\t\n\t\t\tcolumn.element.after(column.modules.resize.handleEl);\n\t\t}\n\t}\n\t\n\tinitializeColumn(type, component, column, element){\n\t\tvar self = this,\n\t\tvariableHeight = false,\n\t\tmode = column.definition.resizable,\n\t\tconfig = {},\n\t\tnearestColumn = column.getLastColumn();\n\t\t\n\t\t//set column resize mode\n\t\tif(type === \"header\"){\n\t\t\tvariableHeight = column.definition.formatter == \"textarea\" || column.definition.variableHeight;\n\t\t\tconfig = {variableHeight:variableHeight};\n\t\t}\n\t\t\n\t\tif((mode === true || mode == type) && this._checkResizability(nearestColumn)){\n\t\t\t\n\t\t\tvar handle = document.createElement('span');\n\t\t\thandle.className = \"tabulator-col-resize-handle\";\n\t\t\t\n\t\t\thandle.addEventListener(\"click\", function(e){\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t\t\n\t\t\tvar handleDown = function(e){\n\t\t\t\tself.startColumn = column;\n\t\t\t\tself.initialNextColumn = self.nextColumn = nearestColumn.nextColumn();\n\t\t\t\tself._mouseDown(e, nearestColumn, handle);\n\t\t\t};\n\t\t\t\n\t\t\thandle.addEventListener(\"mousedown\", handleDown);\n\t\t\thandle.addEventListener(\"touchstart\", handleDown, {passive: true});\n\t\t\t\n\t\t\t//resize column on  double click\n\t\t\thandle.addEventListener(\"dblclick\", (e) => {\n\t\t\t\tvar oldWidth = nearestColumn.getWidth();\n\t\t\t\t\n\t\t\t\te.stopPropagation();\n\t\t\t\tnearestColumn.reinitializeWidth(true);\n\t\t\t\t\n\t\t\t\tif(oldWidth !== nearestColumn.getWidth()){\n\t\t\t\t\tself.dispatch(\"column-resized\", nearestColumn);\n\t\t\t\t\tself.dispatchExternal(\"columnResized\", nearestColumn.getComponent());\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(column.modules.frozen){\n\t\t\t\thandle.style.position = \"sticky\";\n\t\t\t\thandle.style[column.modules.frozen.position] = this.frozenColumnOffset(column);\n\t\t\t}\n\t\t\t\n\t\t\tconfig.handleEl = handle;\n\t\t\t\n\t\t\tif(element.parentNode && column.visible){\n\t\t\t\telement.after(handle);\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tcomponent.modules.resize = config;\n\t}\n\t\n\tdeInitializeColumn(column){\n\t\tthis.deInitializeComponent(column);\n\t\t\n\t\tcolumn.cells.forEach((cell) => {\n\t\t\tthis.deInitializeComponent(cell);\n\t\t});\n\t}\n\t\n\tdeInitializeComponent(component){\n\t\tvar handleEl;\n\t\t\n\t\tif(component.modules.resize){\n\t\t\thandleEl = component.modules.resize.handleEl;\n\t\t\t\n\t\t\tif(handleEl && handleEl.parentElement){\n\t\t\t\thandleEl.parentElement.removeChild(handleEl);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tresizeHandle(component, height){\n\t\tif(component.modules.resize && component.modules.resize.handleEl){\n\t\t\tcomponent.modules.resize.handleEl.style.height = height;\n\t\t}\n\t}\n\t\n\tresize(e, column){\n\t\tvar x = typeof e.clientX === \"undefined\" ? e.touches[0].clientX : e.clientX,\n\t\tstartDiff = x - this.startX,\n\t\tmoveDiff = x - this.latestX,\n\t\tblockedBefore, blockedAfter;\n\n\t\tthis.latestX = x;\n\n\t\tif(this.table.rtl){\n\t\t\tstartDiff = -startDiff;\n\t\t\tmoveDiff = -moveDiff;\n\t\t}\n\n\t\tblockedBefore = column.width == column.minWidth || column.width == column.maxWidth;\n\n\t\tcolumn.setWidth(this.startWidth + startDiff);\n\n\t\tblockedAfter = column.width == column.minWidth || column.width == column.maxWidth;\n\n\t\tif(moveDiff < 0){\n\t\t\tthis.nextColumn = this.initialNextColumn;\n\t\t}\n\n\t\tif(this.table.options.resizableColumnFit && this.nextColumn && !(blockedBefore && blockedAfter)){\n\t\t\tlet colWidth = this.nextColumn.getWidth();\n\n\t\t\tif(moveDiff > 0){\n\t\t\t\tif(colWidth <= this.nextColumn.minWidth){\n\t\t\t\t\tthis.nextColumn = this.nextColumn.nextColumn();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.nextColumn){\n\t\t\t\tthis.nextColumn.setWidth(this.nextColumn.getWidth() - moveDiff);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.columnManager.rerenderColumns(true);\n\n\t\tif(!this.table.browserSlow && column.modules.resize && column.modules.resize.variableHeight){\n\t\t\tcolumn.checkCellHeights();\n\t\t}\n\t}\n\n\tcalcGuidePosition(e, column, handle) {\n\t\tvar mouseX = typeof e.clientX === \"undefined\" ? e.touches[0].clientX : e.clientX,\n\t\thandleX = handle.getBoundingClientRect().x - this.table.element.getBoundingClientRect().x,\n\t\ttableX = this.table.element.getBoundingClientRect().x,\n\t\tcolumnX = column.element.getBoundingClientRect().left - tableX,\n\t\tmouseDiff = mouseX - this.startX,\n\t\tpos = Math.max(handleX + mouseDiff, columnX + column.minWidth);\n\n\t\tif(column.maxWidth){\n\t\t\tpos = Math.min(pos, columnX + column.maxWidth);\n\t\t}\n\n\t\treturn pos;\n\t}\n\n\t_checkResizability(column){\n\t\treturn column.definition.resizable;\n\t}\n\t\n\t_mouseDown(e, column, handle){\n\t\tvar self = this,\n\t\tguideEl;\n\n\t\tthis.dispatchExternal(\"columnResizing\", column.getComponent());\n\n\t\tif(self.table.options.resizableColumnGuide){\n\t\t\tguideEl = document.createElement(\"span\");\n\t\t\tguideEl.classList.add('tabulator-col-resize-guide');\n\t\t\tself.table.element.appendChild(guideEl);\n\t\t\tsetTimeout(() => {\n\t\t\t\tguideEl.style.left = self.calcGuidePosition(e, column, handle) + \"px\";\n\t\t\t});\n\t\t}\n\n\t\tself.table.element.classList.add(\"tabulator-block-select\");\n\n\t\tfunction mouseMove(e){\n\t\t\tif(self.table.options.resizableColumnGuide){\n\t\t\t\tguideEl.style.left = self.calcGuidePosition(e, column, handle) + \"px\";\n\t\t\t}else {\n\t\t\t\tself.resize(e, column);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction mouseUp(e){\n\t\t\tif(self.table.options.resizableColumnGuide){\n\t\t\t\tself.resize(e, column);\n\t\t\t\tguideEl.remove();\n\t\t\t}\n\t\t\t\n\t\t\t//block editor from taking action while resizing is taking place\n\t\t\tif(self.startColumn.modules.edit){\n\t\t\t\tself.startColumn.modules.edit.blocked = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(self.table.browserSlow && column.modules.resize && column.modules.resize.variableHeight){\n\t\t\t\tcolumn.checkCellHeights();\n\t\t\t}\n\t\t\t\n\t\t\tdocument.body.removeEventListener(\"mouseup\", mouseUp);\n\t\t\tdocument.body.removeEventListener(\"mousemove\", mouseMove);\n\t\t\t\n\t\t\thandle.removeEventListener(\"touchmove\", mouseMove);\n\t\t\thandle.removeEventListener(\"touchend\", mouseUp);\n\t\t\t\n\t\t\tself.table.element.classList.remove(\"tabulator-block-select\");\n\t\t\t\n\t\t\tif(self.startWidth !== column.getWidth()){\n\t\t\t\tself.table.columnManager.verticalAlignHeaders();\n\n\t\t\t\tself.dispatch(\"column-resized\", column);\n\t\t\t\tself.dispatchExternal(\"columnResized\", column.getComponent());\n\t\t\t}\n\t\t}\n\t\t\n\t\te.stopPropagation(); //prevent resize from interfering with movable columns\n\t\t\n\t\t//block editor from taking action while resizing is taking place\n\t\tif(self.startColumn.modules.edit){\n\t\t\tself.startColumn.modules.edit.blocked = true;\n\t\t}\n\t\t\n\t\tself.startX = typeof e.clientX === \"undefined\" ? e.touches[0].clientX : e.clientX;\n\t\tself.latestX = self.startX;\n\t\tself.startWidth = column.getWidth();\n\t\t\n\t\tdocument.body.addEventListener(\"mousemove\", mouseMove);\n\t\tdocument.body.addEventListener(\"mouseup\", mouseUp);\n\t\thandle.addEventListener(\"touchmove\", mouseMove, {passive: true});\n\t\thandle.addEventListener(\"touchend\", mouseUp);\n\t}\n}\n\nclass ResizeRows extends Module{\n\n\tstatic moduleName = \"resizeRows\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.startColumn = false;\n\t\tthis.startY = false;\n\t\tthis.startHeight = false;\n\t\tthis.handle = null;\n\t\tthis.prevHandle = null;\n\n\t\tthis.registerTableOption(\"resizableRows\", false); //resizable rows\n\t\tthis.registerTableOption(\"resizableRowGuide\", false);\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.resizableRows){\n\t\t\tthis.subscribe(\"row-layout-after\", this.initializeRow.bind(this));\n\t\t}\n\t}\n\n\tinitializeRow(row){\n\t\tvar self = this,\n\t\trowEl = row.getElement();\n\n\t\tvar handle = document.createElement('div');\n\t\thandle.className = \"tabulator-row-resize-handle\";\n\n\t\tvar prevHandle = document.createElement('div');\n\t\tprevHandle.className = \"tabulator-row-resize-handle prev\";\n\n\t\thandle.addEventListener(\"click\", function(e){\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tvar handleDown = function(e){\n\t\t\tself.startRow = row;\n\t\t\tself._mouseDown(e, row, handle);\n\t\t};\n\n\t\thandle.addEventListener(\"mousedown\", handleDown);\n\t\thandle.addEventListener(\"touchstart\", handleDown, {passive: true});\n\n\t\tprevHandle.addEventListener(\"click\", function(e){\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tvar prevHandleDown =  function(e){\n\t\t\tvar prevRow = self.table.rowManager.prevDisplayRow(row);\n\n\t\t\tif(prevRow){\n\t\t\t\tself.startRow = prevRow;\n\t\t\t\tself._mouseDown(e, prevRow, prevHandle);\n\t\t\t}\n\t\t};\n\n\t\tprevHandle.addEventListener(\"mousedown\",prevHandleDown);\n\t\tprevHandle.addEventListener(\"touchstart\",prevHandleDown, {passive: true});\n\n\t\trowEl.appendChild(handle);\n\t\trowEl.appendChild(prevHandle);\n\t}\n\n\tresize(e, row) {\n\t\trow.setHeight(this.startHeight + ((typeof e.screenY === \"undefined\" ? e.touches[0].screenY : e.screenY) - this.startY));\n\t}\n\n\tcalcGuidePosition(e, row, handle) {\n\t\tvar mouseY = typeof e.screenY === \"undefined\" ? e.touches[0].screenY : e.screenY,\n\t\thandleY = handle.getBoundingClientRect().y - this.table.element.getBoundingClientRect().y,\n\t\ttableY = this.table.element.getBoundingClientRect().y,\n\t\trowY = row.element.getBoundingClientRect().top - tableY,\n\t\tmouseDiff = mouseY - this.startY;\n\n\t\treturn Math.max(handleY + mouseDiff, rowY);\n\t}\n\n\t_mouseDown(e, row, handle){\n\t\tvar self = this,\n\t\tguideEl;\n\n\t\tself.dispatchExternal(\"rowResizing\", row.getComponent());\n\n\t\tif(self.table.options.resizableRowGuide){\n\t\t\tguideEl = document.createElement(\"span\");\n\t\t\tguideEl.classList.add('tabulator-row-resize-guide');\n\t\t\tself.table.element.appendChild(guideEl);\n\t\t\tsetTimeout(() => {\n\t\t\t\tguideEl.style.top = self.calcGuidePosition(e, row, handle) + \"px\";\n\t\t\t});\n\t\t}\n\n\t\tself.table.element.classList.add(\"tabulator-block-select\");\n\n\t\tfunction mouseMove(e){\n\t\t\tif(self.table.options.resizableRowGuide){\n\t\t\t\tguideEl.style.top = self.calcGuidePosition(e, row, handle) + \"px\";\n\t\t\t}else {\n\t\t\t\tself.resize(e, row);\n\t\t\t}\n\t\t}\n\n\t\tfunction mouseUp(e){\n\t\t\tif(self.table.options.resizableRowGuide){\n\t\t\t\tself.resize(e, row);\n\t\t\t\tguideEl.remove();\n\t\t\t}\n\n\t\t\t// //block editor from taking action while resizing is taking place\n\t\t\t// if(self.startColumn.modules.edit){\n\t\t\t// \tself.startColumn.modules.edit.blocked = false;\n\t\t\t// }\n\n\t\t\tdocument.body.removeEventListener(\"mouseup\", mouseMove);\n\t\t\tdocument.body.removeEventListener(\"mousemove\", mouseMove);\n\n\t\t\thandle.removeEventListener(\"touchmove\", mouseMove);\n\t\t\thandle.removeEventListener(\"touchend\", mouseUp);\n\n\t\t\tself.table.element.classList.remove(\"tabulator-block-select\");\n\n\t\t\tself.dispatchExternal(\"rowResized\", row.getComponent());\n\t\t}\n\n\t\te.stopPropagation(); //prevent resize from interfering with movable columns\n\n\t\t//block editor from taking action while resizing is taking place\n\t\t// if(self.startColumn.modules.edit){\n\t\t// \tself.startColumn.modules.edit.blocked = true;\n\t\t// }\n\n\t\tself.startY = typeof e.screenY === \"undefined\" ? e.touches[0].screenY : e.screenY;\n\t\tself.startHeight = row.getHeight();\n\n\t\tdocument.body.addEventListener(\"mousemove\", mouseMove);\n\t\tdocument.body.addEventListener(\"mouseup\", mouseUp);\n\n\t\thandle.addEventListener(\"touchmove\", mouseMove, {passive: true});\n\t\thandle.addEventListener(\"touchend\", mouseUp);\n\t}\n}\n\nclass ResizeTable extends Module{\n\n\tstatic moduleName = \"resizeTable\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.binding = false;\n\t\tthis.visibilityObserver = false;\n\t\tthis.resizeObserver = false;\n\t\tthis.containerObserver = false;\n\t\t\n\t\tthis.tableHeight = 0;\n\t\tthis.tableWidth = 0;\n\t\tthis.containerHeight = 0;\n\t\tthis.containerWidth = 0;\n\t\t\n\t\tthis.autoResize = false;\n\t\t\n\t\tthis.visible = false;\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.initialRedraw = false;\n\t\t\n\t\tthis.registerTableOption(\"autoResize\", true); //auto resize table\n\t}\n\t\n\tinitialize(){\n\t\tif(this.table.options.autoResize){\n\t\t\tvar table = this.table,\n\t\t\ttableStyle;\n\t\t\t\n\t\t\tthis.tableHeight = table.element.clientHeight;\n\t\t\tthis.tableWidth = table.element.clientWidth;\n\t\t\t\n\t\t\tif(table.element.parentNode){\n\t\t\t\tthis.containerHeight = table.element.parentNode.clientHeight;\n\t\t\t\tthis.containerWidth = table.element.parentNode.clientWidth;\n\t\t\t}\n\t\t\t\n\t\t\tif(typeof IntersectionObserver !== \"undefined\" && typeof ResizeObserver !== \"undefined\" && table.rowManager.getRenderMode() === \"virtual\"){\n\t\t\t\t\n\t\t\t\tthis.initializeVisibilityObserver();\n\t\t\t\t\n\t\t\t\tthis.autoResize = true;\n\t\t\t\t\n\t\t\t\tthis.resizeObserver = new ResizeObserver((entry) => {\n\t\t\t\t\tif(!table.browserMobile || (table.browserMobile && (!table.modules.edit || (table.modules.edit && !table.modules.edit.currentCell)))){\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar nodeHeight = Math.floor(entry[0].contentRect.height);\n\t\t\t\t\t\tvar nodeWidth = Math.floor(entry[0].contentRect.width);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.tableHeight != nodeHeight || this.tableWidth != nodeWidth){\n\t\t\t\t\t\t\tthis.tableHeight = nodeHeight;\n\t\t\t\t\t\t\tthis.tableWidth = nodeWidth;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(table.element.parentNode){\n\t\t\t\t\t\t\t\tthis.containerHeight = table.element.parentNode.clientHeight;\n\t\t\t\t\t\t\t\tthis.containerWidth = table.element.parentNode.clientWidth;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tthis.redrawTable();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.resizeObserver.observe(table.element);\n\t\t\t\t\n\t\t\t\ttableStyle = window.getComputedStyle(table.element);\n\t\t\t\t\n\t\t\t\tif(this.table.element.parentNode && !this.table.rowManager.fixedHeight && (tableStyle.getPropertyValue(\"max-height\") || tableStyle.getPropertyValue(\"min-height\"))){\n\t\t\t\t\t\n\t\t\t\t\tthis.containerObserver = new ResizeObserver((entry) => {\n\t\t\t\t\t\tif(!table.browserMobile || (table.browserMobile && (!table.modules.edit || (table.modules.edit && !table.modules.edit.currentCell)))){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar nodeHeight = Math.floor(entry[0].contentRect.height);\n\t\t\t\t\t\t\tvar nodeWidth = Math.floor(entry[0].contentRect.width);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(this.containerHeight != nodeHeight || this.containerWidth != nodeWidth){\n\t\t\t\t\t\t\t\tthis.containerHeight = nodeHeight;\n\t\t\t\t\t\t\t\tthis.containerWidth = nodeWidth;\n\t\t\t\t\t\t\t\tthis.tableHeight = table.element.clientHeight;\n\t\t\t\t\t\t\t\tthis.tableWidth = table.element.clientWidth;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tthis.redrawTable();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.containerObserver.observe(this.table.element.parentNode);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.subscribe(\"table-resize\", this.tableResized.bind(this));\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tthis.binding = function(){\n\t\t\t\t\tif(!table.browserMobile || (table.browserMobile && (!table.modules.edit || (table.modules.edit && !table.modules.edit.currentCell)))){\n\t\t\t\t\t\ttable.columnManager.rerenderColumns(true);\n\t\t\t\t\t\ttable.redraw();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\twindow.addEventListener(\"resize\", this.binding);\n\t\t\t}\n\t\t\t\n\t\t\tthis.subscribe(\"table-destroy\", this.clearBindings.bind(this));\n\t\t}\n\t}\n\t\n\tinitializeVisibilityObserver(){\n\t\tthis.visibilityObserver = new IntersectionObserver((entries) => {\n\t\t\tthis.visible = entries[0].isIntersecting;\n\t\t\t\n\t\t\tif(!this.initialized){\n\t\t\t\tthis.initialized = true;\n\t\t\t\tthis.initialRedraw = !this.visible;\n\t\t\t}else {\n\t\t\t\tif(this.visible){\n\t\t\t\t\tthis.redrawTable(this.initialRedraw);\n\t\t\t\t\tthis.initialRedraw = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.visibilityObserver.observe(this.table.element);\n\t}\n\t\n\tredrawTable(force){\n\t\tif(this.initialized && this.visible){\n\t\t\tthis.table.columnManager.rerenderColumns(true);\n\t\t\tthis.table.redraw(force);\n\t\t}\n\t}\n\t\n\ttableResized(){\n\t\tthis.table.rowManager.redraw();\n\t}\n\t\n\tclearBindings(){\n\t\tif(this.binding){\n\t\t\twindow.removeEventListener(\"resize\", this.binding);\n\t\t}\n\t\t\n\t\tif(this.resizeObserver){\n\t\t\tthis.resizeObserver.unobserve(this.table.element);\n\t\t}\n\t\t\n\t\tif(this.visibilityObserver){\n\t\t\tthis.visibilityObserver.unobserve(this.table.element);\n\t\t}\n\t\t\n\t\tif(this.containerObserver){\n\t\t\tthis.containerObserver.unobserve(this.table.element.parentNode);\n\t\t}\n\t}\n}\n\nfunction responsiveCollapse(cell, formatterParams, onRendered){\n\tvar el = document.createElement(\"div\"),\n\tconfig = cell.getRow()._row.modules.responsiveLayout;\n\n\tel.classList.add(\"tabulator-responsive-collapse-toggle\");\n\t\n\tel.innerHTML = `<svg class='tabulator-responsive-collapse-toggle-open' viewbox=\"0 0 24 24\">\n  <line x1=\"7\" y1=\"12\" x2=\"17\" y2=\"12\" fill=\"none\" stroke-width=\"3\" stroke-linecap=\"round\" />\n  <line y1=\"7\" x1=\"12\" y2=\"17\" x2=\"12\" fill=\"none\" stroke-width=\"3\" stroke-linecap=\"round\" />\n</svg>\n\n<svg class='tabulator-responsive-collapse-toggle-close' viewbox=\"0 0 24 24\">\n  <line x1=\"7\" y1=\"12\" x2=\"17\" y2=\"12\"  fill=\"none\" stroke-width=\"3\" stroke-linecap=\"round\" />\n</svg>`;\n\n\tcell.getElement().classList.add(\"tabulator-row-handle\");\n\n\tfunction toggleList(isOpen){\n\t\tvar collapseEl = config.element;\n\n\t\tconfig.open = isOpen;\n\n\t\tif(collapseEl){\n\n\t\t\tif(config.open){\n\t\t\t\tel.classList.add(\"open\");\n\t\t\t\tcollapseEl.style.display = '';\n\t\t\t}else {\n\t\t\t\tel.classList.remove(\"open\");\n\t\t\t\tcollapseEl.style.display = 'none';\n\t\t\t}\n\t\t}\n\t}\n\n\tel.addEventListener(\"click\", function(e){\n\t\te.stopImmediatePropagation();\n\t\ttoggleList(!config.open);\n\t\tcell.getTable().rowManager.adjustTableSize();\n\t});\n\n\ttoggleList(config.open);\n\n\treturn el;\n}\n\nvar extensions$2 = {\r\n\tformat:{\r\n\t\tformatters:{\r\n\t\t\tresponsiveCollapse:responsiveCollapse,\r\n\t\t}\r\n\t}\r\n};\n\nclass ResponsiveLayout extends Module{\n\n\tstatic moduleName = \"responsiveLayout\";\n\tstatic moduleExtensions = extensions$2;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.columns = [];\n\t\tthis.hiddenColumns = [];\n\t\tthis.mode = \"\";\n\t\tthis.index = 0;\n\t\tthis.collapseFormatter = [];\n\t\tthis.collapseStartOpen = true;\n\t\tthis.collapseHandleColumn = false;\n\n\t\tthis.registerTableOption(\"responsiveLayout\", false); //responsive layout flags\n\t\tthis.registerTableOption(\"responsiveLayoutCollapseStartOpen\", true); //start showing collapsed data\n\t\tthis.registerTableOption(\"responsiveLayoutCollapseUseFormatters\", true); //responsive layout collapse formatter\n\t\tthis.registerTableOption(\"responsiveLayoutCollapseFormatter\", false); //responsive layout collapse formatter\n\n\t\tthis.registerColumnOption(\"responsive\");\n\t}\n\n\t//generate responsive columns list\n\tinitialize(){\n\t\tif(this.table.options.responsiveLayout){\n\t\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\t\tthis.subscribe(\"column-show\", this.updateColumnVisibility.bind(this));\n\t\t\tthis.subscribe(\"column-hide\", this.updateColumnVisibility.bind(this));\n\t\t\tthis.subscribe(\"columns-loaded\", this.initializeResponsivity.bind(this));\n\t\t\tthis.subscribe(\"column-moved\", this.initializeResponsivity.bind(this));\n\t\t\tthis.subscribe(\"column-add\", this.initializeResponsivity.bind(this));\n\t\t\tthis.subscribe(\"column-delete\", this.initializeResponsivity.bind(this));\n\n\t\t\tthis.subscribe(\"table-redrawing\", this.tableRedraw.bind(this));\n\t\t\t\n\t\t\tif(this.table.options.responsiveLayout === \"collapse\"){\n\t\t\t\tthis.subscribe(\"row-data-changed\", this.generateCollapsedRowContent.bind(this));\n\t\t\t\tthis.subscribe(\"row-init\", this.initializeRow.bind(this));\n\t\t\t\tthis.subscribe(\"row-layout\", this.layoutRow.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\ttableRedraw(force){\n\t\tif([\"fitColumns\", \"fitDataStretch\"].indexOf(this.layoutMode()) === -1){\n\t\t\tif(!force){\n\t\t\t\tthis.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tinitializeResponsivity(){\n\t\tvar columns = [];\n\n\t\tthis.mode = this.table.options.responsiveLayout;\n\t\tthis.collapseFormatter = this.table.options.responsiveLayoutCollapseFormatter || this.formatCollapsedData;\n\t\tthis.collapseStartOpen = this.table.options.responsiveLayoutCollapseStartOpen;\n\t\tthis.hiddenColumns = [];\n\n\t\tif(this.collapseFormatter){\n\t\t\tthis.collapseFormatter = this.collapseFormatter.bind(this.table);\n\t\t}\n\n\t\t//determine level of responsivity for each column\n\t\tthis.table.columnManager.columnsByIndex.forEach((column, i) => {\n\t\t\tif(column.modules.responsive){\n\t\t\t\tif(column.modules.responsive.order && column.modules.responsive.visible){\n\t\t\t\t\tcolumn.modules.responsive.index = i;\n\t\t\t\t\tcolumns.push(column);\n\n\t\t\t\t\tif(!column.visible && this.mode === \"collapse\"){\n\t\t\t\t\t\tthis.hiddenColumns.push(column);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t//sort list by responsivity\n\t\tcolumns = columns.reverse();\n\t\tcolumns = columns.sort((a, b) => {\n\t\t\tvar diff = b.modules.responsive.order - a.modules.responsive.order;\n\t\t\treturn diff || (b.modules.responsive.index - a.modules.responsive.index);\n\t\t});\n\n\t\tthis.columns = columns;\n\n\t\tif(this.mode === \"collapse\"){\n\t\t\tthis.generateCollapsedContent();\n\t\t}\n\n\t\t//assign collapse column\n\t\tfor (let col of this.table.columnManager.columnsByIndex){\n\t\t\tif(col.definition.formatter == \"responsiveCollapse\"){\n\t\t\t\tthis.collapseHandleColumn = col;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(this.collapseHandleColumn){\n\t\t\tif(this.hiddenColumns.length){\n\t\t\t\tthis.collapseHandleColumn.show();\n\t\t\t}else {\n\t\t\t\tthis.collapseHandleColumn.hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t//define layout information\n\tinitializeColumn(column){\n\t\tvar def = column.getDefinition();\n\n\t\tcolumn.modules.responsive = {order: typeof def.responsive === \"undefined\" ? 1 : def.responsive, visible:def.visible === false ? false : true};\n\t}\n\n\tinitializeRow(row){\n\t\tvar el;\n\n\t\tif(row.type !== \"calc\"){\n\t\t\tel = document.createElement(\"div\");\n\t\t\tel.classList.add(\"tabulator-responsive-collapse\");\n\n\t\t\trow.modules.responsiveLayout = {\n\t\t\t\telement:el,\n\t\t\t\topen:this.collapseStartOpen,\n\t\t\t};\n\n\t\t\tif(!this.collapseStartOpen){\n\t\t\t\tel.style.display = 'none';\n\t\t\t}\n\t\t}\n\t}\n\n\tlayoutRow(row){\n\t\tvar rowEl = row.getElement();\n\n\t\tif(row.modules.responsiveLayout){\n\t\t\trowEl.appendChild(row.modules.responsiveLayout.element);\n\t\t\tthis.generateCollapsedRowContent(row);\n\t\t}\n\t}\n\n\t//update column visibility\n\tupdateColumnVisibility(column, responsiveToggle){\n\t\tif(!responsiveToggle && column.modules.responsive){\n\t\t\tcolumn.modules.responsive.visible = column.visible;\n\t\t\tthis.initializeResponsivity();\n\t\t}\n\t}\n\n\thideColumn(column){\n\t\tvar colCount = this.hiddenColumns.length;\n\n\t\tcolumn.hide(false, true);\n\n\t\tif(this.mode === \"collapse\"){\n\t\t\tthis.hiddenColumns.unshift(column);\n\t\t\tthis.generateCollapsedContent();\n\n\t\t\tif(this.collapseHandleColumn && !colCount){\n\t\t\t\tthis.collapseHandleColumn.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tshowColumn(column){\n\t\tvar index;\n\n\t\tcolumn.show(false, true);\n\t\t//set column width to prevent calculation loops on uninitialized columns\n\t\tcolumn.setWidth(column.getWidth());\n\n\t\tif(this.mode === \"collapse\"){\n\t\t\tindex = this.hiddenColumns.indexOf(column);\n\n\t\t\tif(index > -1){\n\t\t\t\tthis.hiddenColumns.splice(index, 1);\n\t\t\t}\n\n\t\t\tthis.generateCollapsedContent();\n\n\t\t\tif(this.collapseHandleColumn && !this.hiddenColumns.length){\n\t\t\t\tthis.collapseHandleColumn.hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t//redraw columns to fit space\n\tupdate(){\n\t\tvar working = true;\n\n\t\twhile(working){\n\n\t\t\tlet width = this.table.modules.layout.getMode() == \"fitColumns\" ? this.table.columnManager.getFlexBaseWidth() : this.table.columnManager.getWidth();\n\n\t\t\tlet diff = (this.table.options.headerVisible ? this.table.columnManager.element.clientWidth : this.table.element.clientWidth) - width;\n\n\t\t\tif(diff < 0){\n\t\t\t\t//table is too wide\n\t\t\t\tlet column = this.columns[this.index];\n\n\t\t\t\tif(column){\n\t\t\t\t\tthis.hideColumn(column);\n\t\t\t\t\tthis.index ++;\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\n\t\t\t}else {\n\n\t\t\t\t//table has spare space\n\t\t\t\tlet column = this.columns[this.index -1];\n\n\t\t\t\tif(column){\n\t\t\t\t\tif(diff > 0){\n\t\t\t\t\t\tif(diff >= column.getWidth()){\n\t\t\t\t\t\t\tthis.showColumn(column);\n\t\t\t\t\t\t\tthis.index --;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tworking = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tworking = false;\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!this.table.rowManager.activeRowsCount){\n\t\t\t\tthis.table.rowManager.renderEmptyScroll();\n\t\t\t}\n\t\t}\n\t}\n\n\tgenerateCollapsedContent(){\n\t\tvar rows = this.table.rowManager.getDisplayRows();\n\n\t\trows.forEach((row) => {\n\t\t\tthis.generateCollapsedRowContent(row);\n\t\t});\n\t}\n\n\tgenerateCollapsedRowContent(row){\n\t\tvar el, contents;\n\n\t\tif(row.modules.responsiveLayout){\n\t\t\tel = row.modules.responsiveLayout.element;\n\n\t\t\twhile(el.firstChild) el.removeChild(el.firstChild);\n\n\t\t\tcontents = this.collapseFormatter(this.generateCollapsedRowData(row));\n\t\t\tif(contents){\n\t\t\t\tel.appendChild(contents);\n\t\t\t}\n\t\t\trow.calcHeight(true);\n\t\t}\n\t}\n\n\tgenerateCollapsedRowData(row){\n\t\tvar data = row.getData(),\n\t\toutput = [],\n\t\tmockCellComponent;\n\n\t\tthis.hiddenColumns.forEach((column) => {\n\t\t\tvar value = column.getFieldValue(data);\n\n\t\t\tif(column.definition.title && column.field){\n\t\t\t\tif(column.modules.format && this.table.options.responsiveLayoutCollapseUseFormatters){\n\n\t\t\t\t\tmockCellComponent = {\n\t\t\t\t\t\tvalue:false,\n\t\t\t\t\t\tdata:{},\n\t\t\t\t\t\tgetValue:function(){\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetData:function(){\n\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetType:function(){\n\t\t\t\t\t\t\treturn \"cell\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetElement:function(){\n\t\t\t\t\t\t\treturn document.createElement(\"div\");\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetRow:function(){\n\t\t\t\t\t\t\treturn row.getComponent();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetColumn:function(){\n\t\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetTable:() => {\n\t\t\t\t\t\t\treturn this.table;\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\tfunction onRendered(callback){\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push({\n\t\t\t\t\t\tfield: column.field,\n\t\t\t\t\t\ttitle: column.definition.title,\n\t\t\t\t\t\tvalue: column.modules.format.formatter.call(this.table.modules.format, mockCellComponent, column.modules.format.params, onRendered)\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\toutput.push({\n\t\t\t\t\t\tfield: column.field,\n\t\t\t\t\t\ttitle: column.definition.title,\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\tformatCollapsedData(data){\n\t\tvar list = document.createElement(\"table\");\n\n\t\tdata.forEach((item) => {\n\t\t\tvar row = document.createElement(\"tr\");\n\t\t\tvar titleData = document.createElement(\"td\");\n\t\t\tvar valueData = document.createElement(\"td\");\n\t\t\tvar node_content;\n\n\t\t\tvar titleHighlight = document.createElement(\"strong\");\n\t\t\ttitleData.appendChild(titleHighlight);\n\t\t\t\n\t\t\tthis.modules.localize.bind(\"columns|\" + item.field, function(text){\n\t\t\t\ttitleHighlight.innerHTML = text || item.title;\n\t\t\t});\n\n\t\t\tif(item.value instanceof Node){\n\t\t\t\tnode_content = document.createElement(\"div\");\n\t\t\t\tnode_content.appendChild(item.value);\n\t\t\t\tvalueData.appendChild(node_content);\n\t\t\t}else {\n\t\t\t\tvalueData.innerHTML = item.value;\n\t\t\t}\n\n\t\t\trow.appendChild(titleData);\n\t\t\trow.appendChild(valueData);\n\t\t\tlist.appendChild(row);\n\t\t});\n\n\t\treturn Object.keys(data).length ? list : \"\";\n\t}\n}\n\nfunction rowSelection(cell, formatterParams, onRendered){\n\tvar checkbox = document.createElement(\"input\");\n\tvar blocked = false;\n\n\tcheckbox.type = 'checkbox';\n\n\tcheckbox.setAttribute(\"aria-label\", \"Select Row\");\n\t\n\tif(this.table.modExists(\"selectRow\", true)){\n\n\t\tcheckbox.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tif(typeof cell.getRow == 'function'){\n\t\t\tvar row = cell.getRow();\n\n\t\t\tif(row instanceof RowComponent){\n\n\t\t\t\tcheckbox.addEventListener(\"change\", (e) => {\n\t\t\t\t\tif(this.table.options.selectableRowsRangeMode === \"click\"){\n\t\t\t\t\t\tif(!blocked){\n\t\t\t\t\t\t\trow.toggleSelect();\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tblocked = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\trow.toggleSelect();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(this.table.options.selectableRowsRangeMode === \"click\"){\n\t\t\t\t\tcheckbox.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\tblocked = true;\n\t\t\t\t\t\tthis.table.modules.selectRow.handleComplexRowClick(row._row, e);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tcheckbox.checked = row.isSelected && row.isSelected();\n\t\t\t\tthis.table.modules.selectRow.registerRowSelectCheckbox(row, checkbox);\n\t\t\t}else {\n\t\t\t\tcheckbox = \"\";\n\t\t\t}\n\t\t}else {\n\t\t\tcheckbox.addEventListener(\"change\", (e) => {\n\t\t\t\tif(this.table.modules.selectRow.selectedRows.length){\n\t\t\t\t\tthis.table.deselectRow();\n\t\t\t\t}else {\n\t\t\t\t\tthis.table.selectRow(formatterParams.rowRange);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.table.modules.selectRow.registerHeaderSelectCheckbox(checkbox);\n\t\t}\n\t}\n\n\treturn checkbox;\n}\n\nvar extensions$1 = {\r\n\tformat:{\r\n\t\tformatters:{\r\n\t\t\trowSelection:rowSelection,\r\n\t\t}\r\n\t}\r\n};\n\nclass SelectRow extends Module{\n\n\tstatic moduleName = \"selectRow\";\n\tstatic moduleExtensions = extensions$1;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.selecting = false; //flag selecting in progress\n\t\tthis.lastClickedRow = false; //last clicked row\n\t\tthis.selectPrev = []; //hold previously selected element for drag drop selection\n\t\tthis.selectedRows = []; //hold selected rows\n\t\tthis.headerCheckboxElement = null; // hold header select element\n\t\t\n\t\tthis.registerTableOption(\"selectableRows\", \"highlight\"); //highlight rows on hover\n\t\tthis.registerTableOption(\"selectableRowsRangeMode\", \"drag\");  //highlight rows on hover\n\t\tthis.registerTableOption(\"selectableRowsRollingSelection\", true); //roll selection once maximum number of selectable rows is reached\n\t\tthis.registerTableOption(\"selectableRowsPersistence\", true); // maintain selection when table view is updated\n\t\tthis.registerTableOption(\"selectableRowsCheck\", function(data, row){return true;}); //check whether row is selectable\n\t\t\n\t\tthis.registerTableFunction(\"selectRow\", this.selectRows.bind(this));\n\t\tthis.registerTableFunction(\"deselectRow\", this.deselectRows.bind(this));\n\t\tthis.registerTableFunction(\"toggleSelectRow\", this.toggleRow.bind(this));\n\t\tthis.registerTableFunction(\"getSelectedRows\", this.getSelectedRows.bind(this));\n\t\tthis.registerTableFunction(\"getSelectedData\", this.getSelectedData.bind(this));\n\t\t\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"select\", this.selectRows.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"deselect\", this.deselectRows.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"toggleSelect\", this.toggleRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"isSelected\", this.isRowSelected.bind(this));\n\t}\n\t\n\tinitialize(){\n\n\t\tthis.deprecatedOptionsCheck();\n\n\t\tif(this.table.options.selectableRows === \"highlight\" && this.table.options.selectableRange){\n\t\t\tthis.table.options.selectableRows = false;\n\t\t}\n\n\t\tif(this.table.options.selectableRows !== false){\n\t\t\tthis.subscribe(\"row-init\", this.initializeRow.bind(this));\n\t\t\tthis.subscribe(\"row-deleting\", this.rowDeleted.bind(this));\n\t\t\tthis.subscribe(\"rows-wipe\", this.clearSelectionData.bind(this));\n\t\t\tthis.subscribe(\"rows-retrieve\", this.rowRetrieve.bind(this));\n\t\t\t\n\t\t\tif(this.table.options.selectableRows && !this.table.options.selectableRowsPersistence){\n\t\t\t\tthis.subscribe(\"data-refreshing\", this.deselectRows.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\tdeprecatedOptionsCheck(){\n\t\t// this.deprecationCheck(\"selectable\", \"selectableRows\", true);\n\t\t// this.deprecationCheck(\"selectableRollingSelection\", \"selectableRowsRollingSelection\", true);\n\t\t// this.deprecationCheck(\"selectableRangeMode\", \"selectableRowsRangeMode\", true);\n\t\t// this.deprecationCheck(\"selectablePersistence\", \"selectableRowsPersistence\", true);\n\t\t// this.deprecationCheck(\"selectableCheck\", \"selectableRowsCheck\", true);\n\t}\n\t\n\trowRetrieve(type, prevValue){\n\t\treturn type === \"selected\" ? this.selectedRows : prevValue;\n\t}\n\t\n\trowDeleted(row){\n\t\tthis._deselectRow(row, true);\n\t}\n\t\n\tclearSelectionData(silent){\n\t\tvar prevSelected = this.selectedRows.length;\n\n\t\tthis.selecting = false;\n\t\tthis.lastClickedRow = false;\n\t\tthis.selectPrev = [];\n\t\tthis.selectedRows = [];\n\t\t\n\t\tif(prevSelected && silent !== true){\n\t\t\tthis._rowSelectionChanged();\n\t\t}\n\t}\n\t\n\tinitializeRow(row){\n\t\tvar self = this,\n\t\tselectable = self.checkRowSelectability(row),\n\t\telement = row.getElement();\n\t\t\n\t\t// trigger end of row selection\n\t\tvar endSelect = function(){\n\t\t\t\n\t\t\tsetTimeout(function(){\n\t\t\t\tself.selecting = false;\n\t\t\t}, 50);\n\t\t\t\n\t\t\tdocument.body.removeEventListener(\"mouseup\", endSelect);\n\t\t};\n\t\t\n\t\trow.modules.select = {selected:false};\n\n\t\telement.classList.toggle(\"tabulator-selectable\", selectable);\n\t\telement.classList.toggle(\"tabulator-unselectable\", !selectable);\n\t\t\n\t\t//set row selection class\n\t\tif(self.checkRowSelectability(row)){\t\t\t\n\t\t\tif(self.table.options.selectableRows && self.table.options.selectableRows != \"highlight\"){\n\t\t\t\tif(self.table.options.selectableRowsRangeMode === \"click\"){\n\t\t\t\t\telement.addEventListener(\"click\", this.handleComplexRowClick.bind(this, row));\n\t\t\t\t}else {\n\t\t\t\t\telement.addEventListener(\"click\", function(e){\n\t\t\t\t\t\tif(!self.table.modExists(\"edit\") || !self.table.modules.edit.getCurrentCell()){\n\t\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(!self.selecting){\n\t\t\t\t\t\t\tself.toggleRow(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\telement.addEventListener(\"mousedown\", function(e){\n\t\t\t\t\t\tif(e.shiftKey){\n\t\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tself.selecting = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tself.selectPrev = [];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdocument.body.addEventListener(\"mouseup\", endSelect);\n\t\t\t\t\t\t\tdocument.body.addEventListener(\"keyup\", endSelect);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tself.toggleRow(row);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\telement.addEventListener(\"mouseenter\", function(e){\n\t\t\t\t\t\tif(self.selecting){\n\t\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\t\tself.toggleRow(row);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(self.selectPrev[1] == row){\n\t\t\t\t\t\t\t\tself.toggleRow(self.selectPrev[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\telement.addEventListener(\"mouseout\", function(e){\n\t\t\t\t\t\tif(self.selecting){\n\t\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\t\tself.selectPrev.unshift(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\thandleComplexRowClick(row, e){\n\t\tif(e.shiftKey){\n\t\t\tthis.table._clearSelection();\n\t\t\tthis.lastClickedRow = this.lastClickedRow || row;\n\t\t\t\n\t\t\tvar lastClickedRowIdx = this.table.rowManager.getDisplayRowIndex(this.lastClickedRow);\n\t\t\tvar rowIdx = this.table.rowManager.getDisplayRowIndex(row);\n\t\t\t\n\t\t\tvar fromRowIdx = lastClickedRowIdx <= rowIdx ? lastClickedRowIdx : rowIdx;\n\t\t\tvar toRowIdx = lastClickedRowIdx >= rowIdx ? lastClickedRowIdx : rowIdx;\n\t\t\t\n\t\t\tvar rows = this.table.rowManager.getDisplayRows().slice(0);\n\t\t\tvar toggledRows = rows.splice(fromRowIdx, toRowIdx - fromRowIdx + 1);\n\t\t\t\n\t\t\tif(e.ctrlKey || e.metaKey){\n\t\t\t\ttoggledRows.forEach((toggledRow)=>{\n\t\t\t\t\tif(toggledRow !== this.lastClickedRow){\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.table.options.selectableRows !== true && !this.isRowSelected(row)){\n\t\t\t\t\t\t\tif(this.selectedRows.length < this.table.options.selectableRows){\n\t\t\t\t\t\t\t\tthis.toggleRow(toggledRow);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tthis.toggleRow(toggledRow);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.lastClickedRow = row;\n\t\t\t}else {\n\t\t\t\tthis.deselectRows(undefined, true);\n\t\t\t\t\n\t\t\t\tif(this.table.options.selectableRows !== true){\n\t\t\t\t\tif(toggledRows.length > this.table.options.selectableRows){\n\t\t\t\t\t\ttoggledRows = toggledRows.slice(0, this.table.options.selectableRows);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.selectRows(toggledRows);\n\t\t\t}\n\t\t\tthis.table._clearSelection();\n\t\t}\n\t\telse if(e.ctrlKey || e.metaKey){\n\t\t\tthis.toggleRow(row);\n\t\t\tthis.lastClickedRow = row;\n\t\t}else {\n\t\t\tthis.deselectRows(undefined, true);\n\t\t\tthis.selectRows(row);\n\t\t\tthis.lastClickedRow = row;\n\t\t}\n\t}\n\n\tcheckRowSelectability(row){\n\t\tif(row && row.type === \"row\"){\n\t\t\treturn this.table.options.selectableRowsCheck.call(this.table, row.getComponent());\n\t\t}\n\n\t\treturn false;\n\t}\n\t\n\t//toggle row selection\n\ttoggleRow(row){\n\t\tif(this.checkRowSelectability(row)){\n\t\t\tif(row.modules.select && row.modules.select.selected){\n\t\t\t\tthis._deselectRow(row);\n\t\t\t}else {\n\t\t\t\tthis._selectRow(row);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//select a number of rows\n\tselectRows(rows){\n\t\tvar changes = [], \n\t\trowMatch, change;\n\t\t\n\t\tswitch(typeof rows){\n\t\t\tcase \"undefined\":\n\t\t\t\trowMatch = this.table.rowManager.rows;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"number\":\n\t\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase \"string\":\n\t\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\t\t\t\n\t\t\t\tif(!rowMatch){\n\t\t\t\t\trowMatch = this.table.rowManager.getRows(rows);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\trowMatch = rows;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif(Array.isArray(rowMatch)){\n\t\t\tif(rowMatch.length){\n\t\t\t\trowMatch.forEach((row) => {\n\t\t\t\t\tchange = this._selectRow(row, true, true);\n\n\t\t\t\t\tif(change){\n\t\t\t\t\t\tchanges.push(change);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis._rowSelectionChanged(false, changes);\n\t\t\t}\n\t\t}else {\n\t\t\tif(rowMatch){\n\t\t\t\tthis._selectRow(rowMatch, false, true);\n\t\t\t}\n\t\t}\t\n\t}\n\t\n\t//select an individual row\n\t_selectRow(rowInfo, silent, force){\n\t\t//handle max row count\n\t\tif(!isNaN(this.table.options.selectableRows) && this.table.options.selectableRows !== true && !force){\n\t\t\tif(this.selectedRows.length >= this.table.options.selectableRows){\n\t\t\t\tif(this.table.options.selectableRowsRollingSelection){\n\t\t\t\t\tthis._deselectRow(this.selectedRows[0]);\n\t\t\t\t}else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar row = this.table.rowManager.findRow(rowInfo);\n\t\t\n\t\tif(row){\n\t\t\tif(this.selectedRows.indexOf(row) == -1){\n\t\t\t\trow.getElement().classList.add(\"tabulator-selected\");\n\t\t\t\tif(!row.modules.select){\n\t\t\t\t\trow.modules.select = {};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trow.modules.select.selected = true;\n\t\t\t\tif(row.modules.select.checkboxEl){\n\t\t\t\t\trow.modules.select.checkboxEl.checked = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.selectedRows.push(row);\n\t\t\t\t\n\t\t\t\tif(this.table.options.dataTreeSelectPropagate){\n\t\t\t\t\tthis.childRowSelection(row, true);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.dispatchExternal(\"rowSelected\", row.getComponent());\n\t\t\t\t\n\t\t\t\tthis._rowSelectionChanged(silent, row);\n\n\t\t\t\treturn row;\n\t\t\t}\n\t\t}else {\n\t\t\tif(!silent){\n\t\t\t\tconsole.warn(\"Selection Error - No such row found, ignoring selection:\" + rowInfo);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tisRowSelected(row){\n\t\treturn this.selectedRows.indexOf(row) !== -1;\n\t}\n\t\n\t//deselect a number of rows\n\tdeselectRows(rows, silent){\n\t\tvar changes = [], \n\t\trowMatch, change;\n\t\t\n\t\tswitch(typeof rows){\n\t\t\tcase \"undefined\":\n\t\t\t\trowMatch = Object.assign([], this.selectedRows);\n\t\t\t\tbreak;\n\n\t\t\tcase \"number\":\n\t\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"string\":\n\t\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\t\t\t\n\t\t\t\tif(!rowMatch){\n\t\t\t\t\trowMatch = this.table.rowManager.getRows(rows);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\trowMatch = rows;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif(Array.isArray(rowMatch)){\n\t\t\tif(rowMatch.length){\n\t\t\t\trowMatch.forEach((row) => {\n\t\t\t\t\tchange = this._deselectRow(row, true, true);\n\n\t\t\t\t\tif(change){\n\t\t\t\t\t\tchanges.push(change);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis._rowSelectionChanged(silent, [], changes);\n\t\t\t}\n\t\t}else {\n\t\t\tif(rowMatch){\n\t\t\t\tthis._deselectRow(rowMatch, silent, true);\n\t\t\t}\n\t\t}\t\n\t}\n\t\n\t//deselect an individual row\n\t_deselectRow(rowInfo, silent){\n\t\tvar self = this,\n\t\trow = self.table.rowManager.findRow(rowInfo),\n\t\tindex, element;\n\t\t\n\t\tif(row){\n\t\t\tindex = self.selectedRows.findIndex(function(selectedRow){\n\t\t\t\treturn selectedRow == row;\n\t\t\t});\n\t\t\t\n\t\t\tif(index > -1){\n\n\t\t\t\telement = row.getElement();\n\t\t\t\t\n\t\t\t\tif(element){\n\t\t\t\t\telement.classList.remove(\"tabulator-selected\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(!row.modules.select){\n\t\t\t\t\trow.modules.select = {};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trow.modules.select.selected = false;\n\t\t\t\tif(row.modules.select.checkboxEl){\n\t\t\t\t\trow.modules.select.checkboxEl.checked = false;\n\t\t\t\t}\n\t\t\t\tself.selectedRows.splice(index, 1);\n\t\t\t\t\n\t\t\t\tif(this.table.options.dataTreeSelectPropagate){\n\t\t\t\t\tthis.childRowSelection(row, false);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.dispatchExternal(\"rowDeselected\", row.getComponent());\n\t\t\t\t\n\t\t\t\tself._rowSelectionChanged(silent, undefined, row);\n\n\t\t\t\treturn row;\n\t\t\t}\n\t\t}else {\n\t\t\tif(!silent){\n\t\t\t\tconsole.warn(\"Deselection Error - No such row found, ignoring selection:\" + rowInfo);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tgetSelectedData(){\n\t\tvar data = [];\n\t\t\n\t\tthis.selectedRows.forEach(function(row){\n\t\t\tdata.push(row.getData());\n\t\t});\n\t\t\n\t\treturn data;\n\t}\n\t\n\tgetSelectedRows(){\n\t\tvar rows = [];\n\t\t\n\t\tthis.selectedRows.forEach(function(row){\n\t\t\trows.push(row.getComponent());\n\t\t});\n\t\t\n\t\treturn rows;\n\t}\n\t\n\t_rowSelectionChanged(silent, selected = [], deselected = []){\n\t\tif(this.headerCheckboxElement){\n\t\t\tif(this.selectedRows.length === 0){\n\t\t\t\tthis.headerCheckboxElement.checked = false;\n\t\t\t\tthis.headerCheckboxElement.indeterminate = false;\n\t\t\t} else if(this.table.rowManager.rows.length === this.selectedRows.length){\n\t\t\t\tthis.headerCheckboxElement.checked = true;\n\t\t\t\tthis.headerCheckboxElement.indeterminate = false;\n\t\t\t} else {\n\t\t\t\tthis.headerCheckboxElement.indeterminate = true;\n\t\t\t\tthis.headerCheckboxElement.checked = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(!silent){\n\t\t\tif(!Array.isArray(selected)){\n\t\t\t\tselected = [selected];\n\t\t\t}\n\n\t\t\tselected = selected.map(row => row.getComponent());\n\n\t\t\tif(!Array.isArray(deselected)){\n\t\t\t\tdeselected = [deselected];\n\t\t\t}\n\n\t\t\tdeselected = deselected.map(row => row.getComponent());\n\n\t\t\tthis.dispatchExternal(\"rowSelectionChanged\", this.getSelectedData(), this.getSelectedRows(), selected, deselected);\n\t\t}\n\t}\n\t\n\tregisterRowSelectCheckbox (row, element) {\n\t\tif(!row._row.modules.select){\n\t\t\trow._row.modules.select = {};\n\t\t}\n\t\t\n\t\trow._row.modules.select.checkboxEl = element;\n\t}\n\t\n\tregisterHeaderSelectCheckbox (element) {\n\t\tthis.headerCheckboxElement = element;\n\t}\n\t\n\tchildRowSelection(row, select){\n\t\tvar children = this.table.modules.dataTree.getChildren(row, true, true);\n\t\t\n\t\tif(select){\n\t\t\tfor(let child of children){\n\t\t\t\tthis._selectRow(child, true);\n\t\t\t}\n\t\t}else {\n\t\t\tfor(let child of children){\n\t\t\t\tthis._deselectRow(child, true);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass RangeComponent {\n\tconstructor(range) {\n\t\tthis._range = range;\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function (target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t} else {\n\t\t\t\t\treturn target._range.table.componentFunctionBinder.handle(\"range\", target._range, name);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\tgetElement() {\n\t\treturn this._range.element;\n\t}\n\n\tgetData() {\n\t\treturn this._range.getData();\n\t}\n\n\tgetCells() {\n\t\treturn this._range.getCells(true, true);\n\t}\n\n\tgetStructuredCells() {\n\t\treturn this._range.getStructuredCells();\n\t}\n\n\tgetRows() {\n\t\treturn this._range.getRows().map((row) => row.getComponent());\n\t}\n\n\tgetColumns() {\n\t\treturn this._range.getColumns().map((column) => column.getComponent());\n\t}\n\t\n\tgetBounds() {\n\t\treturn this._range.getBounds();\n\t}\n\n\tgetTopEdge() {\n\t\treturn this._range.top;\n\t}\n\n\tgetBottomEdge() {\n\t\treturn this._range.bottom;\n\t}\n\n\tgetLeftEdge() {\n\t\treturn this._range.left;\n\t}\n\n\tgetRightEdge() {\n\t\treturn this._range.right;\n\t}\n\n\tsetBounds(start, end){\n\t\tif(this._range.destroyedGuard(\"setBounds\")){\n\t\t\tthis._range.setBounds(start ? start._cell : start, end ? end._cell : end);\n\t\t}\n\t}\n\n\tsetStartBound(start){\n\t\tif(this._range.destroyedGuard(\"setStartBound\")){\n\t\t\tthis._range.setEndBound(start ? start._cell : start);\n\t\t\tthis._range.rangeManager.layoutElement();\n\t\t}\n\t}\n\n\tsetEndBound(end){\n\t\tif(this._range.destroyedGuard(\"setEndBound\")){\n\t\t\tthis._range.setEndBound(end ? end._cell : end);\n\t\t\tthis._range.rangeManager.layoutElement();\n\t\t}\n\t}\n\n\tclearValues(){\n\t\tif(this._range.destroyedGuard(\"clearValues\")){\n\t\t\tthis._range.clearValues();\n\t\t}\n\t}\n\n\tremove(){\n\t\tif(this._range.destroyedGuard(\"remove\")){\n\t\t\tthis._range.destroy(true);\n\t\t}\n\t}\n}\n\nclass Range extends CoreFeature{\n\tconstructor(table, rangeManager, start, end) {\n\t\tsuper(table);\n\t\t\n\t\tthis.rangeManager = rangeManager;\n\t\tthis.element = null;\n\t\tthis.initialized = false;\n\t\tthis.initializing = {\n\t\t\tstart:false,\n\t\t\tend:false,\n\t\t};\n\t\tthis.destroyed = false;\n\t\t\n\t\tthis.top = 0;\n\t\tthis.bottom = 0;\n\t\tthis.left = 0;\n\t\tthis.right = 0;\n\t\t\n\t\tthis.table = table;\n\t\tthis.start = {row:0, col:0};\n\t\tthis.end = {row:0, col:0};\n\n\t\tif(this.rangeManager.rowHeader){\n\t\t\tthis.left = 1;\n\t\t\tthis.right = 1;\n\t\t\tthis.start.col = 1;\n\t\t\tthis.end.col = 1;\n\t\t}\n\t\t\n\t\tthis.initElement();\n\t\t\n\t\tsetTimeout(() => {\n\t\t\tthis.initBounds(start, end);\n\t\t});\n\t}\n\t\n\tinitElement(){\n\t\tthis.element = document.createElement(\"div\");\n\t\tthis.element.classList.add(\"tabulator-range\");\n\t}\n\t\n\tinitBounds(start, end){\n\t\tthis._updateMinMax();\n\t\t\n\t\tif(start){\n\t\t\tthis.setBounds(start, end || start);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t///////   Boundary Setup    ///////\n\t///////////////////////////////////\n\t\n\tsetStart(row, col) {\n\t\tif(this.start.row !== row || this.start.col !== col){\n\t\t\tthis.start.row = row;\n\t\t\tthis.start.col = col;\n\t\t\t\n\t\t\tthis.initializing.start = true;\n\t\t\tthis._updateMinMax();\n\t\t}\n\t}\n\t\n\tsetEnd(row, col) {\n\t\tif(this.end.row !== row || this.end.col !== col){\n\t\t\tthis.end.row = row;\n\t\t\tthis.end.col = col;\n\t\t\t\n\t\t\tthis.initializing.end = true;\n\t\t\tthis._updateMinMax();\n\t\t}\n\t}\n\t\n\tsetBounds(start, end, visibleRows){\n\t\tif(start){\n\t\t\tthis.setStartBound(start);\n\t\t}\n\t\t\n\t\tthis.setEndBound(end || start);\n\t\tthis.rangeManager.layoutElement(visibleRows);\n\t}\n\t\n\tsetStartBound(element){\n\t\tvar row, col;\n\t\t\n\t\tif (element.type === \"column\") {\n\t\t\tif(this.rangeManager.columnSelection){\n\t\t\t\tthis.setStart(0, element.getPosition() - 1);\n\t\t\t}\n\t\t}else {\n\t\t\trow = element.row.position - 1;\n\t\t\tcol = element.column.getPosition() - 1;\n\t\t\t\n\t\t\tif (element.column === this.rangeManager.rowHeader) {\n\t\t\t\tthis.setStart(row, 1);\n\t\t\t} else {\n\t\t\t\tthis.setStart(row, col);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tsetEndBound(element){\n\t\tvar rowsCount = this._getTableRows().length,\n\t\trow, col, isRowHeader;\n\t\t\n\t\tif (element.type === \"column\") {\n\t\t\tif(this.rangeManager.columnSelection){\n\t\t\t\tif (this.rangeManager.selecting === \"column\") {\n\t\t\t\t\tthis.setEnd(rowsCount - 1, element.getPosition() - 1);\n\t\t\t\t} else if (this.rangeManager.selecting === \"cell\") {\n\t\t\t\t\tthis.setEnd(0, element.getPosition() - 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\trow = element.row.position - 1;\n\t\t\tcol = element.column.getPosition() - 1;\n\t\t\tisRowHeader = element.column === this.rangeManager.rowHeader;\n\t\t\t\n\t\t\tif (this.rangeManager.selecting === \"row\") {\n\t\t\t\tthis.setEnd(row, this._getTableColumns().length - 1);\n\t\t\t} else if (this.rangeManager.selecting !== \"row\" && isRowHeader) {\n\t\t\t\tthis.setEnd(row, 0);\n\t\t\t} else if (this.rangeManager.selecting === \"column\") {\n\t\t\t\tthis.setEnd(rowsCount - 1, col);\n\t\t\t} else {\n\t\t\t\tthis.setEnd(row, col);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_updateMinMax() {\n\t\tthis.top = Math.min(this.start.row, this.end.row);\n\t\tthis.bottom = Math.max(this.start.row, this.end.row);\n\t\tthis.left = Math.min(this.start.col, this.end.col);\n\t\tthis.right = Math.max(this.start.col, this.end.col);\n\t\t\n\t\tif(this.initialized){\n\t\t\tthis.dispatchExternal(\"rangeChanged\", this.getComponent());\n\t\t}else {\n\t\t\tif(this.initializing.start && this.initializing.end){\n\t\t\t\tthis.initialized = true;\n\t\t\t\tthis.dispatchExternal(\"rangeAdded\", this.getComponent());\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_getTableColumns() {\n\t\treturn this.table.columnManager.getVisibleColumnsByIndex();\n\t}\n\t\n\t_getTableRows() {\n\t\treturn this.table.rowManager.getDisplayRows().filter(row=> row.type === \"row\");\n\t}\n\t\n\t///////////////////////////////////\n\t///////      Rendering      ///////\n\t///////////////////////////////////\n\t\n\tlayout() {\n\t\tvar _vDomTop = this.table.rowManager.renderer.vDomTop,\n\t\t_vDomBottom = this.table.rowManager.renderer.vDomBottom,\n\t\t_vDomLeft = this.table.columnManager.renderer.leftCol,\n\t\t_vDomRight = this.table.columnManager.renderer.rightCol,\t\t\n\t\ttop, bottom, left, right, topLeftCell, bottomRightCell, topLeftCellEl, bottomRightCellEl, topLeftRowEl, bottomRightRowEl;\n\n\t\tif(this.table.options.renderHorizontal === \"virtual\" && this.rangeManager.rowHeader) {\n\t\t\t_vDomRight += 1;\n\t\t}\n\t\t\n\t\tif (_vDomTop == null) {\n\t\t\t_vDomTop = 0;\n\t\t}\n\t\t\n\t\tif (_vDomBottom == null) {\n\t\t\t_vDomBottom = Infinity;\n\t\t}\n\t\t\n\t\tif (_vDomLeft == null) {\n\t\t\t_vDomLeft = 0;\n\t\t}\n\t\t\n\t\tif (_vDomRight == null) {\n\t\t\t_vDomRight = Infinity;\n\t\t}\n\t\t\n\t\tif (this.overlaps(_vDomLeft, _vDomTop, _vDomRight, _vDomBottom)) {\n\t\t\ttop = Math.max(this.top, _vDomTop);\n\t\t\tbottom = Math.min(this.bottom, _vDomBottom);\n\t\t\tleft = Math.max(this.left, _vDomLeft);\n\t\t\tright = Math.min(this.right, _vDomRight);\n\t\t\t\n\t\t\ttopLeftCell = this.rangeManager.getCell(top, left);\n\t\t\tbottomRightCell = this.rangeManager.getCell(bottom, right);\n\t\t\ttopLeftCellEl = topLeftCell.getElement();\n\t\t\tbottomRightCellEl = bottomRightCell.getElement();\n\t\t\ttopLeftRowEl = topLeftCell.row.getElement();\n\t\t\tbottomRightRowEl = bottomRightCell.row.getElement();\n\t\t\t\n\t\t\tthis.element.classList.add(\"tabulator-range-active\");\n\t\t\t// this.element.classList.toggle(\"tabulator-range-active\", this === this.rangeManager.activeRange);\n\n\t\t\tif(this.table.rtl){\n\t\t\t\tthis.element.style.right = topLeftRowEl.offsetWidth - topLeftCellEl.offsetLeft - topLeftCellEl.offsetWidth + \"px\";\n\t\t\t\tthis.element.style.width = topLeftCellEl.offsetLeft + topLeftCellEl.offsetWidth - bottomRightCellEl.offsetLeft + \"px\";\n\t\t\t}else {\n\t\t\t\tthis.element.style.left = topLeftRowEl.offsetLeft + topLeftCellEl.offsetLeft + \"px\";\n\t\t\t\tthis.element.style.width = bottomRightCellEl.offsetLeft + bottomRightCellEl.offsetWidth - topLeftCellEl.offsetLeft + \"px\";\n\t\t\t}\n\t\t\t\n\t\t\tthis.element.style.top = topLeftRowEl.offsetTop + \"px\";\n\t\t\tthis.element.style.height = bottomRightRowEl.offsetTop + bottomRightRowEl.offsetHeight - topLeftRowEl.offsetTop + \"px\";\n\t\t}\n\t}\n\t\n\tatTopLeft(cell) {\n\t\treturn cell.row.position - 1 === this.top && cell.column.getPosition() - 1 === this.left;\n\t}\n\t\n\tatBottomRight(cell) {\n\t\treturn cell.row.position - 1 === this.bottom && cell.column.getPosition() - 1 === this.right;\n\t}\n\t\n\toccupies(cell) {\n\t\treturn this.occupiesRow(cell.row) && this.occupiesColumn(cell.column);\n\t}\n\t\n\toccupiesRow(row) {\n\t\treturn this.top <= row.position - 1 && row.position - 1 <= this.bottom;\n\t}\n\t\n\toccupiesColumn(col) {\n\t\treturn this.left <= col.getPosition() - 1 && col.getPosition() - 1 <= this.right;\n\t}\n\t\n\toverlaps(left, top, right, bottom) {\n\t\tif ((this.left > right || left > this.right) || (this.top > bottom || top > this.bottom)){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\treturn true;\n\t}\n\t\n\tgetData() {\n\t\tvar data = [],\n\t\trows = this.getRows(),\n\t\tcolumns = this.getColumns();\n\t\t\n\t\trows.forEach((row) => {\n\t\t\tvar rowData = row.getData(),\n\t\t\tresult = {};\n\t\t\t\n\t\t\tcolumns.forEach((column) => {\n\t\t\t\tresult[column.field] = rowData[column.field];\n\t\t\t});\n\t\t\t\n\t\t\tdata.push(result);\n\t\t});\n\t\t\n\t\treturn data;\n\t}\n\t\n\tgetCells(structured, component) {\n\t\tvar cells = [],\n\t\trows = this.getRows(),\n\t\tcolumns = this.getColumns();\n\t\t\n\t\tif (structured) {\n\t\t\tcells = rows.map((row) => {\n\t\t\t\tvar arr = [];\n\t\t\t\t\n\t\t\t\trow.getCells().forEach((cell) => {\n\t\t\t\t\tif (columns.includes(cell.column)) {\n\t\t\t\t\t\tarr.push(component ? cell.getComponent() : cell);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn arr;\n\t\t\t});\n\t\t} else {\n\t\t\trows.forEach((row) => {\n\t\t\t\trow.getCells().forEach((cell) => {\n\t\t\t\t\tif (columns.includes(cell.column)) {\n\t\t\t\t\t\tcells.push(component ? cell.getComponent() : cell);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn cells;\n\t}\n\t\n\tgetStructuredCells() {\n\t\treturn this.getCells(true, true);\n\t}\n\t\n\tgetRows() {\n\t\treturn this._getTableRows().slice(this.top, this.bottom + 1);\n\t}\n\t\n\tgetColumns() {\n\t\treturn this._getTableColumns().slice(this.left, this.right + 1);\n\t}\n\t\n\tclearValues(){\n\t\tvar cells = this.getCells();\n\t\tvar clearValue = this.table.options.selectableRangeClearCellsValue;\n\t\t\n\t\tthis.table.blockRedraw();\n\t\t\n\t\tcells.forEach((cell) => {\n\t\t\tcell.setValue(clearValue);\n\t\t});\n\t\t\n\t\tthis.table.restoreRedraw();\n\t\t\n\t}\n\t\n\tgetBounds(component){\n\t\tvar cells = this.getCells(false, component),\n\t\toutput = {\n\t\t\tstart:null,\n\t\t\tend:null,\n\t\t};\n\t\t\n\t\tif(cells.length){\n\t\t\toutput.start = cells[0];\n\t\t\toutput.end = cells[cells.length - 1];\n\t\t}else {\n\t\t\tconsole.warn(\"No bounds defined on range\");\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetComponent() {\n\t\tif (!this.component) {\n\t\t\tthis.component = new RangeComponent(this);\n\t\t}\n\t\treturn this.component;\n\t}\n\t\n\tdestroy(notify) {\n\t\tthis.destroyed = true;\n\t\t\n\t\tthis.element.remove();\n\t\t\n\t\tif(notify){\n\t\t\tthis.rangeManager.rangeRemoved(this);\n\t\t}\n\t\t\n\t\tif(this.initialized){\n\t\t\tthis.dispatchExternal(\"rangeRemoved\", this.getComponent());\n\t\t}\n\t}\n\t\n\tdestroyedGuard(func){\n\t\tif(this.destroyed){\n\t\t\tconsole.warn(\"You cannot call the \"  + func + \" function on a destroyed range\");\n\t\t}\n\t\t\n\t\treturn !this.destroyed;\n\t}\n}\n\nvar bindings = {\r\n\trangeJumpUp:[\"ctrl + 38\", \"meta + 38\"],\r\n\trangeJumpDown:[\"ctrl + 40\", \"meta + 40\"],\r\n\trangeJumpLeft:[\"ctrl + 37\", \"meta + 37\"],\r\n\trangeJumpRight:[\"ctrl + 39\", \"meta + 39\"],\r\n\trangeExpandUp:\"shift + 38\",\r\n\trangeExpandDown:\"shift + 40\",\r\n\trangeExpandLeft:\"shift + 37\",\r\n\trangeExpandRight:\"shift + 39\",\r\n\trangeExpandJumpUp:[\"ctrl + shift + 38\", \"meta + shift + 38\"],\r\n\trangeExpandJumpDown:[\"ctrl + shift + 40\", \"meta + shift + 40\"],\r\n\trangeExpandJumpLeft:[\"ctrl + shift + 37\", \"meta + shift + 37\"],\r\n\trangeExpandJumpRight:[\"ctrl + shift + 39\", \"meta + shift + 39\"],\r\n};\n\nvar actions = {\r\n\trangeJumpLeft: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"left\", true, false);\r\n\t},\r\n\trangeJumpRight: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"right\", true, false);\r\n\t},\r\n\trangeJumpUp: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"up\", true, false);\r\n\t},\r\n\trangeJumpDown: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"down\", true, false);\r\n\t},\r\n\trangeExpandLeft: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"left\", false, true);\r\n\t},\r\n\trangeExpandRight: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"right\", false, true);\r\n\t},\r\n\trangeExpandUp: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"up\", false, true);\r\n\t},\r\n\trangeExpandDown: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"down\", false, true);\r\n\t},\r\n\trangeExpandJumpLeft: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"left\", true, true);\r\n\t},\r\n\trangeExpandJumpRight: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"right\", true, true);\r\n\t},\r\n\trangeExpandJumpUp: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"up\", true, true);\r\n\t},\r\n\trangeExpandJumpDown: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"down\", true, true);\r\n\t},\r\n};\n\nvar pasteActions = {\r\n\trange:function(data){\r\n\t\tvar rows = [],\r\n\t\trange = this.table.modules.selectRange.activeRange,\r\n\t\tsingleCell = false,\r\n\t\tbounds, startCell, startRow, rowWidth, dataLength;\r\n\r\n\t\tdataLength = data.length;\r\n\t\t\r\n\t\tif(range){\r\n\t\t\tbounds = range.getBounds();\r\n\t\t\tstartCell = bounds.start;\r\n\t\t\t\r\n\t\t\tif(bounds.start === bounds.end){\r\n\t\t\t\tsingleCell = true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(startCell){\r\n\t\t\t\trows = this.table.rowManager.activeRows.slice();\r\n\t\t\t\tstartRow = rows.indexOf(startCell.row);\r\n\r\n\t\t\t\tif(singleCell){\r\n\t\t\t\t\trowWidth = data.length;\r\n\t\t\t\t}else {\r\n\t\t\t\t\trowWidth = (rows.indexOf(bounds.end.row) - startRow) + 1;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tif(startRow >-1){\r\n\t\t\t\t\tthis.table.blockRedraw();\r\n\t\t\t\t\t\r\n\t\t\t\t\trows = rows.slice(startRow, startRow + rowWidth);\r\n\t\t\t\t\t\r\n\t\t\t\t\trows.forEach((row, i) => {\r\n\t\t\t\t\t\trow.updateData(data[i % dataLength]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.table.restoreRedraw();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn rows;\r\n\t}\r\n};\n\nvar pasteParsers = {\r\n\trange:function(clipboard){\r\n\t\tvar data = [],\r\n\t\trows = [],\r\n\t\trange = this.table.modules.selectRange.activeRange,\r\n\t\tsingleCell = false,\r\n\t\tbounds, startCell, colWidth, columnMap, startCol;\r\n\t\t\r\n\t\tif(range){\r\n\t\t\tbounds = range.getBounds();\r\n\t\t\tstartCell = bounds.start;\r\n\r\n\t\t\tif(bounds.start === bounds.end){\r\n\t\t\t\tsingleCell = true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(startCell){\r\n\t\t\t\t//get data from clipboard into array of columns and rows.\r\n\t\t\t\tclipboard = clipboard.split(\"\\n\");\r\n\t\t\t\t\r\n\t\t\t\tclipboard.forEach(function(row){\r\n\t\t\t\t\tdata.push(row.split(\"\\t\"));\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif(data.length){\r\n\t\t\t\t\tcolumnMap = this.table.columnManager.getVisibleColumnsByIndex();\r\n\t\t\t\t\tstartCol = columnMap.indexOf(startCell.column);\r\n\r\n\t\t\t\t\tif(startCol > -1){\r\n\t\t\t\t\t\tif(singleCell){\r\n\t\t\t\t\t\t\tcolWidth = data[0].length;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tcolWidth = (columnMap.indexOf(bounds.end.column) - startCol) + 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcolumnMap = columnMap.slice(startCol, startCol + colWidth);\r\n\r\n\t\t\t\t\t\tdata.forEach((item) => {\r\n\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\tvar itemLength = item.length;\r\n\r\n\t\t\t\t\t\t\tcolumnMap.forEach(function(col, i){\r\n\t\t\t\t\t\t\t\trow[col.field] = item[i % itemLength];\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\trows.push(row);\t\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\treturn rows;\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n};\n\nvar columnLookups = {\r\n\trange:function(){\r\n\t\tvar columns = this.modules.selectRange.selectedColumns();\r\n\r\n\t\tif(this.columnManager.rowHeader){\r\n\t\t\tcolumns.unshift(this.columnManager.rowHeader);\r\n\t\t}\r\n\r\n\t\treturn columns;\r\n\t},\r\n};\n\nvar rowLookups = {\r\n\trange:function(){\r\n\t\treturn this.modules.selectRange.selectedRows();\r\n\t},\r\n};\n\nvar extensions = {\r\n\tkeybindings:{\r\n\t\tbindings:bindings,\r\n\t\tactions:actions\r\n\t},\r\n\tclipboard:{\r\n\t\tpasteActions:pasteActions,\r\n\t\tpasteParsers:pasteParsers\r\n\t},\r\n\texport:{\r\n\t\tcolumnLookups:columnLookups,\r\n\t\trowLookups:rowLookups,\r\n\t}\r\n};\n\nclass SelectRange extends Module {\n\t\n\tstatic moduleName = \"selectRange\";\n\tstatic moduleInitOrder = 1;\n\tstatic moduleExtensions = extensions;\n\t\n\tconstructor(table) {\n\t\tsuper(table);\n\t\t\n\t\tthis.selecting = \"cell\";\n\t\tthis.mousedown = false;\n\t\tthis.ranges = [];\n\t\tthis.overlay = null;\n\t\tthis.rowHeader = null;\n\t\tthis.layoutChangeTimeout = null;\n\t\tthis.columnSelection = false;\n\t\tthis.rowSelection = false;\n\t\tthis.maxRanges = 0;\n\t\tthis.activeRange = false;\n\t\tthis.blockKeydown = false;\n\t\t\n\t\tthis.keyDownEvent = this._handleKeyDown.bind(this);\n\t\tthis.mouseUpEvent = this._handleMouseUp.bind(this);\n\t\t\n\t\tthis.registerTableOption(\"selectableRange\", false); //enable selectable range\n\t\tthis.registerTableOption(\"selectableRangeColumns\", false); //enable selectable range\n\t\tthis.registerTableOption(\"selectableRangeRows\", false); //enable selectable range\n\t\tthis.registerTableOption(\"selectableRangeClearCells\", false); //allow clearing of active range\n\t\tthis.registerTableOption(\"selectableRangeClearCellsValue\", undefined); //value for cleared active range\n\t\tthis.registerTableOption(\"selectableRangeAutoFocus\", true); //focus on a cell after resetRanges\n\t\t\n\t\tthis.registerTableFunction(\"getRangesData\", this.getRangesData.bind(this));\n\t\tthis.registerTableFunction(\"getRanges\", this.getRanges.bind(this));\n\t\tthis.registerTableFunction(\"addRange\", this.addRangeFromComponent.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"cell\", \"getRanges\", this.cellGetRanges.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"getRanges\", this.rowGetRanges.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"getRanges\", this.colGetRanges.bind(this));\n\t}\n\t\n\t///////////////////////////////////\n\t///////    Initialization   ///////\n\t///////////////////////////////////\n\t\n\tinitialize() {\n\t\tif (this.options(\"selectableRange\")) {\t\n\t\t\tif(!this.options(\"selectableRows\")){\n\t\t\t\tthis.maxRanges = this.options(\"selectableRange\");\n\t\t\t\t\n\t\t\t\tthis.initializeTable();\n\t\t\t\tthis.initializeWatchers();\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"SelectRange functionality cannot be used in conjunction with row selection\");\n\t\t\t}\n\n\t\t\tif(this.options('columns').findIndex((column) => column.frozen) > 0) {\n\t\t\t\tconsole.warn(\"Having frozen column in arbitrary position with selectRange option may result in unpredictable behavior.\");\n\t\t\t}\n\n\t\t\tif(this.options('columns').filter((column) => column.frozen) > 1) {\n\t\t\t\tconsole.warn(\"Having multiple frozen columns with selectRange option may result in unpredictable behavior.\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\tinitializeTable() {\t\t\n\t\tthis.overlay = document.createElement(\"div\");\n\t\tthis.overlay.classList.add(\"tabulator-range-overlay\");\n\t\t\n\t\tthis.rangeContainer = document.createElement(\"div\");\n\t\tthis.rangeContainer.classList.add(\"tabulator-range-container\");\n\t\t\n\t\tthis.activeRangeCellElement = document.createElement(\"div\");\n\t\tthis.activeRangeCellElement.classList.add(\"tabulator-range-cell-active\");\n\t\t\n\t\tthis.overlay.appendChild(this.rangeContainer);\n\t\tthis.overlay.appendChild(this.activeRangeCellElement);\n\t\t\n\t\tthis.table.rowManager.element.addEventListener(\"keydown\", this.keyDownEvent);\n\t\t\n\t\tthis.resetRanges();\n\t\t\n\t\tthis.table.rowManager.element.appendChild(this.overlay);\n\t\tthis.table.columnManager.element.setAttribute(\"tabindex\", 0);\n\t\tthis.table.element.classList.add(\"tabulator-ranges\");\n\t}\n\t\n\tinitializeWatchers() {\n\t\tthis.columnSelection = this.options(\"selectableRangeColumns\");\n\t\tthis.rowSelection = this.options(\"selectableRangeRows\");\n\t\t\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"column-mousedown\", this.handleColumnMouseDown.bind(this));\n\t\tthis.subscribe(\"column-mousemove\", this.handleColumnMouseMove.bind(this));\n\t\tthis.subscribe(\"column-resized\", this.handleColumnResized.bind(this));\n\t\tthis.subscribe(\"column-moving\", this.handleColumnMoving.bind(this));\n\t\tthis.subscribe(\"column-moved\", this.handleColumnMoved.bind(this));\n\t\tthis.subscribe(\"column-width\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"column-height\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"column-resized\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"columns-loaded\", this.updateHeaderColumn.bind(this));\n\t\t\n\t\tthis.subscribe(\"cell-height\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"cell-rendered\", this.renderCell.bind(this));\n\t\tthis.subscribe(\"cell-mousedown\", this.handleCellMouseDown.bind(this));\n\t\tthis.subscribe(\"cell-mousemove\", this.handleCellMouseMove.bind(this));\n\t\tthis.subscribe(\"cell-click\", this.handleCellClick.bind(this));\n\t\tthis.subscribe(\"cell-editing\", this.handleEditingCell.bind(this));\n\t\t\n\t\tthis.subscribe(\"page-changed\", this.redraw.bind(this));\n\t\t\n\t\tthis.subscribe(\"scroll-vertical\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"scroll-horizontal\", this.layoutChange.bind(this));\n\t\t\n\t\tthis.subscribe(\"data-destroy\", this.tableDestroyed.bind(this));\n\t\tthis.subscribe(\"data-processed\", this.resetRanges.bind(this));\n\t\t\n\t\tthis.subscribe(\"table-layout\", this.layoutElement.bind(this));\n\t\tthis.subscribe(\"table-redraw\", this.redraw.bind(this));\n\t\tthis.subscribe(\"table-destroy\", this.tableDestroyed.bind(this));\n\t\t\n\t\tthis.subscribe(\"edit-editor-clear\", this.finishEditingCell.bind(this));\n\t\tthis.subscribe(\"edit-blur\", this.restoreFocus.bind(this));\n\t\t\n\t\tthis.subscribe(\"keybinding-nav-prev\", this.keyNavigate.bind(this, \"left\"));\n\t\tthis.subscribe(\"keybinding-nav-next\", this.keyNavigate.bind(this, \"right\"));\n\t\tthis.subscribe(\"keybinding-nav-left\", this.keyNavigate.bind(this, \"left\"));\n\t\tthis.subscribe(\"keybinding-nav-right\", this.keyNavigate.bind(this, \"right\"));\n\t\tthis.subscribe(\"keybinding-nav-up\", this.keyNavigate.bind(this, \"up\"));\n\t\tthis.subscribe(\"keybinding-nav-down\", this.keyNavigate.bind(this, \"down\"));\n\t\tthis.subscribe(\"keybinding-nav-range\", this.keyNavigateRange.bind(this));\n\t}\n\t\n\t\n\tinitializeColumn(column) {\n\t\tif(this.columnSelection && column.definition.headerSort && this.options(\"headerSortClickElement\") !== \"icon\"){\n\t\t\tconsole.warn(\"Using column headerSort with selectableRangeColumns option may result in unpredictable behavior. Consider using headerSortClickElement: 'icon'.\");\n\t\t}\n\t\t\n\t\tif (column.modules.edit) ;\n\t}\n\t\n\tupdateHeaderColumn(){\n\t\tvar frozenCols;\n\n\t\tif(this.rowSelection){\n\t\t\tthis.rowHeader = this.table.columnManager.getVisibleColumnsByIndex()[0];\n\t\t\t\n\t\t\tif(this.rowHeader){\n\t\t\t\tthis.rowHeader.definition.cssClass = this.rowHeader.definition.cssClass + \" tabulator-range-row-header\";\n\t\t\t\t\n\t\t\t\tif(this.rowHeader.definition.headerSort){\n\t\t\t\t\tconsole.warn(\"Using column headerSort with selectableRangeRows option may result in unpredictable behavior\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.rowHeader.definition.editor){\n\t\t\t\t\tconsole.warn(\"Using column editor with selectableRangeRows option may result in unpredictable behavior\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//warn if invalid frozen column configuration detected\n\t\tif(this.table.modules.frozenColumns && this.table.modules.frozenColumns.active){\n\t\t\tfrozenCols = this.table.modules.frozenColumns.getFrozenColumns();\n\n\t\t\tif(frozenCols.length > 1 || (frozenCols.length === 1 && frozenCols[0] !== this.rowHeader)){\n\t\t\t\tconsole.warn(\"Using frozen columns that are not the range header in combination with the selectRange option may result in unpredictable behavior\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t///////   Table Functions   ///////\n\t///////////////////////////////////\n\t\n\tgetRanges(){\n\t\treturn this.ranges.map((range) => range.getComponent());\n\t}\n\t\n\tgetRangesData() {\n\t\treturn this.ranges.map((range) => range.getData());\n\t}\n\t\n\taddRangeFromComponent(start, end){\n\t\tstart = start ? start._cell : null;\n\t\tend = end ? end._cell : null;\n\t\t\n\t\treturn this.addRange(start, end);\n\t}\n\t\n\t///////////////////////////////////\n\t/////// Component Functions ///////\n\t///////////////////////////////////\n\t\n\tcellGetRanges(cell){\n\t\tvar ranges = [];\n\t\t\n\t\tif (cell.column === this.rowHeader) {\n\t\t\tranges = this.ranges.filter((range) => range.occupiesRow(cell.row));\n\t\t} else {\n\t\t\tranges = this.ranges.filter((range) => range.occupies(cell));\n\t\t}\n\t\t\n\t\treturn ranges.map((range) => range.getComponent());\n\t}\n\t\n\trowGetRanges(row){\n\t\tvar ranges = this.ranges.filter((range) => range.occupiesRow(row));\n\t\t\n\t\treturn ranges.map((range) => range.getComponent());\n\t}\n\t\n\tcolGetRanges(col){\n\t\tvar ranges = this.ranges.filter((range) => range.occupiesColumn(col));\n\t\t\n\t\treturn ranges.map((range) => range.getComponent());\n\t}\n\t\n\t///////////////////////////////////\n\t////////// Event Handlers /////////\n\t///////////////////////////////////\n\t\n\t_handleMouseUp(e){\n\t\tthis.mousedown = false;\n\t\tdocument.removeEventListener(\"mouseup\", this.mouseUpEvent);\n\t}\n\t\n\t_handleKeyDown(e) {\n\t\tif (!this.blockKeydown && (!this.table.modules.edit || (this.table.modules.edit && !this.table.modules.edit.currentCell))) {\n\t\t\tif (e.key === \"Enter\") {\n\t\t\t\t// is editing a cell?\n\t\t\t\tif (this.table.modules.edit && this.table.modules.edit.currentCell) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.table.modules.edit.editCell(this.getActiveCell());\n\t\t\t\t\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tif ((e.key === \"Backspace\" || e.key === \"Delete\") && this.options(\"selectableRangeClearCells\")) {\n\t\t\t\tif(this.activeRange){\n\t\t\t\t\tthis.activeRange.clearValues();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinitializeFocus(cell){\n\t\tvar range;\n\n\t\tthis.restoreFocus();\n\t\t\n\t\ttry{\n\t\t\tif (document.selection) { // IE\n\t\t\t\trange = document.body.createTextRange();\n\t\t\t\trange.moveToElementText(cell.getElement());\n\t\t\t\trange.select();\n\t\t\t} else if (window.getSelection) {\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.selectNode(cell.getElement());\n\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\twindow.getSelection().addRange(range);\n\t\t\t}\n\t\t}catch(e){}\n\t}\n\t\n\trestoreFocus(element){\n\t\tthis.table.rowManager.element.focus();\n\t\t\n\t\treturn true;\n\t}\n\t\n\t///////////////////////////////////\n\t////// Column Functionality ///////\n\t///////////////////////////////////\n\t\n\thandleColumnResized(column) {\n\t\tvar selected;\n\t\t\n\t\tif (this.selecting !== \"column\" && this.selecting !== \"all\") {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tselected = this.ranges.some((range) => range.occupiesColumn(column));\n\t\t\n\t\tif (!selected) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.ranges.forEach((range) => {\n\t\t\tvar selectedColumns = range.getColumns(true);\n\t\t\t\n\t\t\tselectedColumns.forEach((selectedColumn) => {\n\t\t\t\tif (selectedColumn !== column) {\n\t\t\t\t\tselectedColumn.setWidth(column.width);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\t\n\thandleColumnMoving(_event, column) {\n\t\tthis.resetRanges().setBounds(column);\n\t\tthis.overlay.style.visibility = \"hidden\";\n\t}\n\n\thandleColumnMoved(from, _to, _after) {\n\t\tthis.activeRange.setBounds(from);\n\t\tthis.layoutElement();\n\t}\n\n\thandleColumnMouseDown(event, column) {\n\t\tif (event.button === 2 && (this.selecting === \"column\" || this.selecting === \"all\") && this.activeRange.occupiesColumn(column)) {\n\t\t\treturn;\n\t\t}\n\n\t\t//If columns are movable, allow dragging columns only if they are not\n\t\t//selected. Dragging selected columns should move the columns instead.\n\t\tif(this.table.options.movableColumns && this.selecting === \"column\" && this.activeRange.occupiesColumn(column)){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.mousedown = true;\n\t\t\n\t\tdocument.addEventListener(\"mouseup\", this.mouseUpEvent);\n\t\t\n\t\tthis.newSelection(event, column);\n\t}\n\t\n\thandleColumnMouseMove(e, column) {\n\t\tif (column === this.rowHeader || !this.mousedown || this.selecting === 'all') {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.activeRange.setBounds(false, column, true);\n\t}\n\t\n\t///////////////////////////////////\n\t//////// Cell Functionality ///////\n\t///////////////////////////////////\n\t\n\trenderCell(cell) {\n\t\tvar el = cell.getElement(),\n\t\trangeIdx = this.ranges.findIndex((range) => range.occupies(cell));\n\t\t\n\t\tel.classList.toggle(\"tabulator-range-selected\", rangeIdx !== -1);\n\t\tel.classList.toggle(\"tabulator-range-only-cell-selected\", this.ranges.length === 1 && this.ranges[0].atTopLeft(cell) &&\tthis.ranges[0].atBottomRight(cell));\n\t\t\n\t\tel.dataset.range = rangeIdx;\n\t}\n\t\n\thandleCellMouseDown(event, cell) {\n\t\tif (event.button === 2 && (this.activeRange.occupies(cell) || ((this.selecting === \"row\" || this.selecting === \"all\") && this.activeRange.occupiesRow(cell.row)))) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.mousedown = true;\n\t\t\n\t\tdocument.addEventListener(\"mouseup\", this.mouseUpEvent);\n\t\t\n\t\tthis.newSelection(event, cell);\n\t}\n\t\n\thandleCellMouseMove(e, cell) {\n\t\tif (!this.mousedown || this.selecting === \"all\") {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.activeRange.setBounds(false, cell, true);\n\t}\n\t\n\thandleCellClick(e, cell){\n\t\tthis.initializeFocus(cell);\n\t}\n\t\n\thandleEditingCell(cell) {\n\t\tif(this.activeRange){\n\t\t\tthis.activeRange.setBounds(cell);\n\t\t}\n\t}\n\t\n\tfinishEditingCell() {\n\t\tthis.blockKeydown = true;\n\t\tthis.table.rowManager.element.focus();\n\t\t\n\t\tsetTimeout(() => {\n\t\t\tthis.blockKeydown = false;\n\t\t}, 10);\n\t}\n\t\n\t///////////////////////////////////\n\t///////     Navigation      ///////\n\t///////////////////////////////////\n\t\n\tkeyNavigate(dir, e){\n\t\tif(this.navigate(false, false, dir));\n\t\te.preventDefault();\n\t}\n\t\n\tkeyNavigateRange(e, dir, jump, expand){\n\t\tif(this.navigate(jump, expand, dir));\n\t\te.preventDefault();\n\t}\n\t\n\tnavigate(jump, expand, dir) {\n\t\tvar moved = false,\n\t\trange, rangeEdge, prevRect, nextRow, nextCol, row, column,\n\t\trowRect, rowManagerRect, columnRect, columnManagerRect;\n\t\t\n\t\t// Don't navigate while editing\n\t\tif (this.table.modules.edit && this.table.modules.edit.currentCell) {\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t// If there are more than 1 range, use the active range and destroy the others\n\t\tif (this.ranges.length > 1) {\n\t\t\tthis.ranges = this.ranges.filter((range) => {\n\t\t\t\tif (range === this.activeRange) {\n\t\t\t\t\trange.setEnd(range.start.row, range.start.col);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\trange.destroy();\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\t\n\t\trange = this.activeRange;\n\t\tprevRect = {\n\t\t\ttop: range.top,\n\t\t\tbottom: range.bottom,\n\t\t\tleft: range.left,\n\t\t\tright: range.right\n\t\t};\n\t\t\n\t\trangeEdge = expand ? range.end : range.start;\n\t\tnextRow = rangeEdge.row;\n\t\tnextCol = rangeEdge.col;\n\t\t\n\t\tif(jump){\n\t\t\tswitch(dir){\n\t\t\t\tcase \"left\":\n\t\t\t\t\tnextCol = this.findJumpCellLeft(range.start.row, rangeEdge.col);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tnextCol = this.findJumpCellRight(range.start.row, rangeEdge.col);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"up\":\n\t\t\t\t\tnextRow = this.findJumpCellUp(rangeEdge.row, range.start.col);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"down\":\n\t\t\t\t\tnextRow = this.findJumpCellDown(rangeEdge.row, range.start.col);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}else {\n\t\t\tif(expand){\n\t\t\t\tif ((this.selecting === 'row' && (dir === 'left' || dir === 'right')) || (this.selecting === 'column' && (dir === 'up' || dir === 'down'))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tswitch(dir){\n\t\t\t\tcase \"left\":\n\t\t\t\t\tnextCol = Math.max(nextCol - 1, 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tnextCol = Math.min(nextCol + 1, this.getTableColumns().length - 1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"up\":\n\t\t\t\t\tnextRow = Math.max(nextRow - 1, 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"down\":\n\t\t\t\t\tnextRow = Math.min(nextRow + 1, this.getTableRows().length - 1);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(this.rowHeader && nextCol === 0) {\n\t\t\tnextCol = 1;\n\t\t}\n\t\t\n\t\tif(!expand){\n\t\t\trange.setStart(nextRow, nextCol);\n\t\t}\n\t\t\n\t\trange.setEnd(nextRow, nextCol);\n\t\t\n\t\tif(!expand){\n\t\t\tthis.selecting = \"cell\";\n\t\t}\n\n\t\tmoved = prevRect.top !== range.top || prevRect.bottom !== range.bottom || prevRect.left !== range.left || prevRect.right !== range.right;\n\n\t\tif (moved) {\n\t\t\trow = this.getRowByRangePos(range.end.row);\n\t\t\tcolumn = this.getColumnByRangePos(range.end.col);\n\t\t\trowRect = row.getElement().getBoundingClientRect();\n\t\t\tcolumnRect = column.getElement().getBoundingClientRect();\n\t\t\trowManagerRect = this.table.rowManager.getElement().getBoundingClientRect();\n\t\t\tcolumnManagerRect = this.table.columnManager.getElement().getBoundingClientRect();\n\t\t\t\n\t\t\tif(!(rowRect.top >= rowManagerRect.top && rowRect.bottom <= rowManagerRect.bottom)){\n\t\t\t\tif(row.getElement().parentNode && column.getElement().parentNode){\n\t\t\t\t\t// Use faster autoScroll when the elements are on the DOM\n\t\t\t\t\tthis.autoScroll(range, row.getElement(), column.getElement());\n\t\t\t\t}else {\n\t\t\t\t\trow.getComponent().scrollTo(undefined, false);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!(columnRect.left >= columnManagerRect.left + this.getRowHeaderWidth() && columnRect.right <= columnManagerRect.right)){\n\t\t\t\tif(row.getElement().parentNode && column.getElement().parentNode){\n\t\t\t\t\t// Use faster autoScroll when the elements are on the DOM\n\t\t\t\t\tthis.autoScroll(range, row.getElement(), column.getElement());\n\t\t\t\t}else {\n\t\t\t\t\tcolumn.getComponent().scrollTo(undefined, false);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.layoutElement();\n\t\t\t\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\trangeRemoved(removed){\n\t\tthis.ranges = this.ranges.filter((range) => range !== removed);\n\t\t\n\t\tif(this.activeRange === removed){\n\t\t\tif(this.ranges.length){\n\t\t\t\tthis.activeRange = this.ranges[this.ranges.length - 1];\n\t\t\t}else {\n\t\t\t\tthis.addRange();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.layoutElement();\n\t}\n\t\n\tfindJumpRow(column, rows, reverse, emptyStart, emptySide){\n\t\tif(reverse){\n\t\t\trows = rows.reverse();\n\t\t}\n\n\t\treturn this.findJumpItem(emptyStart, emptySide, rows, function(row){return row.getData()[column.getField()];});\n\t}\n\t\n\tfindJumpCol(row, columns, reverse, emptyStart, emptySide){\n\t\tif(reverse){\n\t\t\tcolumns = columns.reverse();\n\t\t}\n\n\t\treturn this.findJumpItem(emptyStart, emptySide, columns, function(column){return row.getData()[column.getField()];});\n\t}\n\n\tfindJumpItem(emptyStart, emptySide, items, valueResolver){\n\t\tvar nextItem;\n\n\t\tfor(let currentItem of items){\n\t\t\tlet currentValue = valueResolver(currentItem);\n\t\t\t\n\t\t\tif(emptyStart){\n\t\t\t\tnextItem = currentItem;\n\t\t\t\tif(currentValue){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(emptySide){\n\t\t\t\t\tnextItem = currentItem;\n\t\t\t\t\t\n\t\t\t\t\tif(currentValue){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tif(currentValue){\n\t\t\t\t\t\tnextItem = currentItem;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn nextItem;\n\t}\n\n\tfindJumpCellLeft(rowPos, colPos){\n\t\tvar row = this.getRowByRangePos(rowPos),\n\t\tcolumns = this.getTableColumns(),\n\t\tisStartingCellEmpty = this.isEmpty(row.getData()[columns[colPos].getField()]),\n\t\tisLeftOfStartingCellEmpty = columns[colPos - 1] ? this.isEmpty(row.getData()[columns[colPos - 1].getField()]) : false,\n\t\ttargetCols = this.rowHeader ? columns.slice(1, colPos) : columns.slice(0, colPos),\n\t\tjumpCol = this.findJumpCol(row, targetCols, true, isStartingCellEmpty, isLeftOfStartingCellEmpty);\n\t\t\n\t\tif(jumpCol){\n\t\t\treturn jumpCol.getPosition() - 1;\n\t\t}\n\t\t\n\t\treturn colPos;\n\t}\n\t\n\tfindJumpCellRight(rowPos, colPos){\n\t\tvar row = this.getRowByRangePos(rowPos),\n\t\tcolumns = this.getTableColumns(),\n\t\tisStartingCellEmpty = this.isEmpty(row.getData()[columns[colPos].getField()]),\n\t\tisRightOfStartingCellEmpty = columns[colPos + 1] ? this.isEmpty(row.getData()[columns[colPos + 1].getField()]) : false,\n\t\tjumpCol = this.findJumpCol(row, columns.slice(colPos + 1, columns.length), false, isStartingCellEmpty, isRightOfStartingCellEmpty);\n\t\t\n\t\tif(jumpCol){\n\t\t\treturn jumpCol.getPosition() - 1;\n\t\t}\n\t\t\n\t\treturn colPos;\n\t}\n\t\n\tfindJumpCellUp(rowPos, colPos) {\n\t\tvar column = this.getColumnByRangePos(colPos),\n\t\trows = this.getTableRows(),\n\t\tisStartingCellEmpty = this.isEmpty(rows[rowPos].getData()[column.getField()]),\n\t\tisTopOfStartingCellEmpty = rows[rowPos - 1] ? this.isEmpty(rows[rowPos - 1].getData()[column.getField()]) : false,\n\t\tjumpRow = this.findJumpRow(column, rows.slice(0, rowPos), true, isStartingCellEmpty, isTopOfStartingCellEmpty);\n\t\t\n\t\tif(jumpRow){\n\t\t\treturn jumpRow.position - 1;\n\t\t}\n\t\t\n\t\treturn rowPos;\n\t}\n\t\n\tfindJumpCellDown(rowPos, colPos) {\n\t\tvar column = this.getColumnByRangePos(colPos),\n\t\trows = this.getTableRows(),\n\t\tisStartingCellEmpty = this.isEmpty(rows[rowPos].getData()[column.getField()]),\n\t\tisBottomOfStartingCellEmpty = rows[rowPos + 1] ? this.isEmpty(rows[rowPos + 1].getData()[column.getField()]) : false,\n\t\tjumpRow = this.findJumpRow(column, rows.slice(rowPos + 1, rows.length), false, isStartingCellEmpty, isBottomOfStartingCellEmpty);\n\t\t\n\t\tif(jumpRow){\n\t\t\treturn jumpRow.position - 1;\n\t\t}\n\t\t\n\t\treturn rowPos;\n\t}\n\t\n\t///////////////////////////////////\n\t///////      Selection      ///////\n\t///////////////////////////////////\n\tnewSelection(event, element) {\n\t\tvar range;\n\t\t\n\t\tif (element.type === \"column\") {\n\t\t\tif(!this.columnSelection){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tif (element === this.rowHeader) {\n\t\t\t\trange = this.resetRanges();\n\t\t\t\tthis.selecting = \"all\";\n\t\t\t\t\n\t\t\t\tvar topLeftCell, bottomRightCell = this.getCell(-1, -1);\n\t\t\t\t\n\t\t\t\tif(this.rowHeader){\n\t\t\t\t\ttopLeftCell = this.getCell(0, 1);\n\t\t\t\t}else {\n\t\t\t\t\ttopLeftCell = this.getCell(0, 0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trange.setBounds(topLeftCell, bottomRightCell);\t\t\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tthis.selecting = \"column\";\n\t\t\t}\n\t\t} else if (element.column === this.rowHeader) {\n\t\t\tthis.selecting = \"row\";\n\t\t} else {\n\t\t\tthis.selecting = \"cell\";\n\t\t}\n\t\t\n\t\tif (event.shiftKey) {\n\t\t\tthis.activeRange.setBounds(false, element);\n\t\t} else if (event.ctrlKey) {\n\t\t\tthis.addRange().setBounds(element);\n\t\t} else {\n\t\t\tthis.resetRanges().setBounds(element);\n\t\t}\n\t}\n\t\n\tautoScroll(range, row, column) {\n\t\tvar tableHolder = this.table.rowManager.element,\n\t\trect, view, withinHorizontalView, withinVerticalView;\n\t\t\n\t\tif (typeof row === 'undefined') {\n\t\t\trow = this.getRowByRangePos(range.end.row).getElement();\n\t\t}\n\t\t\n\t\tif (typeof column === 'undefined') {\n\t\t\tcolumn = this.getColumnByRangePos(range.end.col).getElement();\n\t\t}\n\t\t\n\t\trect = {\n\t\t\tleft: column.offsetLeft,\n\t\t\tright: column.offsetLeft + column.offsetWidth,\n\t\t\ttop: row.offsetTop,\n\t\t\tbottom: row.offsetTop + row.offsetHeight,\n\t\t};\n\t\t\n\t\tview = {\n\t\t\tleft: tableHolder.scrollLeft + this.getRowHeaderWidth(),\n\t\t\tright: Math.ceil(tableHolder.scrollLeft + tableHolder.clientWidth),\n\t\t\ttop: tableHolder.scrollTop,\n\t\t\tbottom:\ttableHolder.scrollTop +\ttableHolder.offsetHeight - this.table.rowManager.scrollbarWidth,\n\t\t};\n\t\t\n\t\twithinHorizontalView = view.left < rect.left &&\trect.left < view.right && view.left < rect.right &&\trect.right < view.right;\n\t\t\n\t\twithinVerticalView = view.top < rect.top &&\trect.top < view.bottom && view.top < rect.bottom &&\trect.bottom < view.bottom;\n\t\t\n\t\tif (!withinHorizontalView) {\n\t\t\tif (rect.left < view.left) {\n\t\t\t\ttableHolder.scrollLeft = rect.left - this.getRowHeaderWidth();\n\t\t\t} else if (rect.right > view.right) {\n\t\t\t\ttableHolder.scrollLeft = Math.min(rect.right - tableHolder.clientWidth, rect.left - this.getRowHeaderWidth());\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (!withinVerticalView) {\n\t\t\tif (rect.top < view.top) {\n\t\t\t\ttableHolder.scrollTop = rect.top;\n\t\t\t} else if (rect.bottom > view.bottom) {\n\t\t\t\ttableHolder.scrollTop = rect.bottom - tableHolder.clientHeight;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////       Layout        ///////\n\t///////////////////////////////////\n\t\n\tlayoutChange(){\n\t\tthis.overlay.style.visibility = \"hidden\";\n\t\tclearTimeout(this.layoutChangeTimeout);\n\t\tthis.layoutChangeTimeout = setTimeout(this.layoutRanges.bind(this), 200);\n\t}\n\t\n\tredraw(force) {\n\t\tif (force) {\n\t\t\tthis.selecting = 'cell';\n\t\t\tthis.resetRanges();\n\t\t\tthis.layoutElement();\n\t\t}\n\t}\n\t\n\tlayoutElement(visibleRows) {\n\t\tvar rows;\n\t\t\n\t\tif (visibleRows) {\n\t\t\trows = this.table.rowManager.getVisibleRows(true);\n\t\t} else {\n\t\t\trows = this.table.rowManager.getRows();\n\t\t}\n\t\t\n\t\trows.forEach((row) => {\n\t\t\tif (row.type === \"row\") {\n\t\t\t\tthis.layoutRow(row);\n\t\t\t\trow.cells.forEach((cell) => this.renderCell(cell));\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.getTableColumns().forEach((column) => {\n\t\t\tthis.layoutColumn(column);\n\t\t});\n\t\t\n\t\tthis.layoutRanges();\n\t}\n\t\n\tlayoutRow(row) {\n\t\tvar el = row.getElement(),\n\t\tselected = false,\n\t\toccupied = this.ranges.some((range) => range.occupiesRow(row));\n\t\t\n\t\tif (this.selecting === \"row\") {\n\t\t\tselected = occupied;\n\t\t} else if (this.selecting === \"all\") {\n\t\t\tselected = true;\n\t\t}\n\t\t\n\t\tel.classList.toggle(\"tabulator-range-selected\", selected);\n\t\tel.classList.toggle(\"tabulator-range-highlight\", occupied);\n\t}\n\t\n\tlayoutColumn(column) {\n\t\tvar el = column.getElement(),\t\t\n\t\tselected = false,\n\t\toccupied = this.ranges.some((range) => range.occupiesColumn(column));\n\t\t\n\t\tif (this.selecting === \"column\") {\n\t\t\tselected = occupied;\n\t\t} else if (this.selecting === \"all\") {\n\t\t\tselected = true;\n\t\t}\n\t\t\n\t\tel.classList.toggle(\"tabulator-range-selected\", selected);\n\t\tel.classList.toggle(\"tabulator-range-highlight\", occupied);\n\t}\n\t\n\tlayoutRanges() {\n\t\tvar activeCell, activeCellEl, activeRowEl;\n\t\t\n\t\tif (!this.table.initialized) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tactiveCell = this.getActiveCell();\n\t\t\n\t\tif (!activeCell) {\n\t\t\treturn;\n\t\t}\n\n\t\tactiveCellEl = activeCell.getElement();\n\t\tactiveRowEl = activeCell.row.getElement();\n\n\t\tif(this.table.rtl){\n\t\t\tthis.activeRangeCellElement.style.right = activeRowEl.offsetWidth - activeCellEl.offsetLeft - activeCellEl.offsetWidth + \"px\";\n\t\t}else {\n\t\t\tthis.activeRangeCellElement.style.left = activeRowEl.offsetLeft + activeCellEl.offsetLeft + \"px\";\n\t\t}\n\n\t\tthis.activeRangeCellElement.style.top =\tactiveRowEl.offsetTop + \"px\";\n\t\tthis.activeRangeCellElement.style.width = activeCellEl.offsetWidth + \"px\";\n\t\tthis.activeRangeCellElement.style.height =  activeRowEl.offsetHeight  + \"px\";\n\t\t\n\t\tthis.ranges.forEach((range) => range.layout());\n\t\t\n\t\tthis.overlay.style.visibility = \"visible\";\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////  Helper Functions   ///////\n\t///////////////////////////////////\t\n\t\n\tgetCell(rowIdx, colIdx) {\n\t\tvar row;\n\t\t\n\t\tif (colIdx < 0) {\n\t\t\tcolIdx = this.getTableColumns().length + colIdx;\n\t\t\tif (colIdx < 0) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (rowIdx < 0) {\n\t\t\trowIdx = this.getTableRows().length + rowIdx;\n\t\t}\n\t\t\n\t\trow = this.table.rowManager.getRowFromPosition(rowIdx + 1);\n\t\t\n\t\treturn row ? row.getCells(false, true).filter((cell) => cell.column.visible)[colIdx] : null;\n\t}\n\t\n\t\n\tgetActiveCell() {\n\t\treturn this.getCell(this.activeRange.start.row, this.activeRange.start.col);\n\t}\n\t\n\tgetRowByRangePos(pos) {\n\t\treturn this.getTableRows()[pos];\n\t}\n\t\n\tgetColumnByRangePos(pos) {\n\t\treturn this.getTableColumns()[pos];\n\t}\n\t\n\tgetTableRows() {\n\t\treturn this.table.rowManager.getDisplayRows().filter(row=> row.type === \"row\");\n\t}\n\t\n\tgetTableColumns() {\n\t\treturn this.table.columnManager.getVisibleColumnsByIndex();\n\t}\n\t\n\taddRange(start, end) {\n\t\tvar  range;\n\t\t\n\t\tif(this.maxRanges !== true && this.ranges.length >= this.maxRanges){\n\t\t\tthis.ranges.shift().destroy();\n\t\t}\n\t\t\n\t\trange = new Range(this.table, this, start, end);\n\t\t\n\t\tthis.activeRange = range;\n\t\tthis.ranges.push(range);\n\t\tthis.rangeContainer.appendChild(range.element);\n\t\t\n\t\treturn range;\n\t}\n\t\n\tresetRanges() {\n\t\tvar range, cell, visibleCells;\n\t\t\n\t\tthis.ranges.forEach((range) => range.destroy());\n\t\tthis.ranges = [];\n\t\t\n\t\trange = this.addRange();\n\t\t\n\t\tif(this.table.rowManager.activeRows.length){\n\t\t\tvisibleCells = this.table.rowManager.activeRows[0].cells.filter((cell) => cell.column.visible);\n\t\t\tcell = visibleCells[this.rowHeader ? 1 : 0];\n\n\t\t\tif(cell){\n\t\t\t\trange.setBounds(cell);\n\t\t\t\tif(this.options(\"selectableRangeAutoFocus\")){\n\t\t\t\t\tthis.initializeFocus(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn range;\n\t}\n\t\n\ttableDestroyed(){\n\t\tdocument.removeEventListener(\"mouseup\", this.mouseUpEvent);\n\t\tthis.table.rowManager.element.removeEventListener(\"keydown\", this.keyDownEvent);\n\t}\n\t\n\tselectedRows(component) {\n\t\treturn component ? this.activeRange.getRows().map((row) => row.getComponent()) : this.activeRange.getRows();\n\t}\n\t\n\tselectedColumns(component) {\n\t\treturn component ? this.activeRange.getColumns().map((col) => col.getComponent()) : this.activeRange.getColumns();\n\t}\n\n\tgetRowHeaderWidth(){\n\t\tif(!this.rowHeader){\n\t\t\treturn 0;\n\t\t}\n\t\treturn this.rowHeader.getElement().offsetWidth;\n\t}\n\n\tisEmpty(value) {\n\t\treturn value === null || value === undefined || value === \"\";\n\t}\n}\n\n//sort numbers\nfunction number(a, b, aRow, bRow, column, dir, params){\n\tvar alignEmptyValues = params.alignEmptyValues;\n\tvar decimal = params.decimalSeparator;\n\tvar thousand = params.thousandSeparator;\n\tvar emptyAlign = 0;\n\n\ta = String(a);\n\tb = String(b);\n\n\tif(thousand){\n\t\ta = a.split(thousand).join(\"\");\n\t\tb = b.split(thousand).join(\"\");\n\t}\n\n\tif(decimal){\n\t\ta = a.split(decimal).join(\".\");\n\t\tb = b.split(decimal).join(\".\");\n\t}\n\n\ta = parseFloat(a);\n\tb = parseFloat(b);\n\n\t//handle non numeric values\n\tif(isNaN(a)){\n\t\temptyAlign =  isNaN(b) ? 0 : -1;\n\t}else if(isNaN(b)){\n\t\temptyAlign =  1;\n\t}else {\n\t\t//compare valid values\n\t\treturn a - b;\n\t}\n\n\t//fix empty values in position\n\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\temptyAlign *= -1;\n\t}\n\n\treturn emptyAlign;\n}\n\n//sort strings\nfunction string(a, b, aRow, bRow, column, dir, params){\n\tvar alignEmptyValues = params.alignEmptyValues;\n\tvar emptyAlign = 0;\n\tvar locale;\n\n\t//handle empty values\n\tif(!a){\n\t\temptyAlign =  !b ? 0 : -1;\n\t}else if(!b){\n\t\temptyAlign =  1;\n\t}else {\n\t\t//compare valid values\n\t\tswitch(typeof params.locale){\n\t\t\tcase \"boolean\":\n\t\t\t\tif(params.locale){\n\t\t\t\t\tlocale = this.langLocale();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"string\":\n\t\t\t\tlocale = params.locale;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn String(a).toLowerCase().localeCompare(String(b).toLowerCase(), locale);\n\t}\n\n\t//fix empty values in position\n\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\temptyAlign *= -1;\n\t}\n\n\treturn emptyAlign;\n}\n\n//sort datetime\nfunction datetime(a, b, aRow, bRow, column, dir, params){\n\tvar DT = this.table.dependencyRegistry.lookup([\"luxon\", \"DateTime\"], \"DateTime\");\n\tvar format = params.format || \"dd/MM/yyyy HH:mm:ss\",\n\talignEmptyValues = params.alignEmptyValues,\n\temptyAlign = 0;\n\n\tif(typeof DT != \"undefined\"){\n\t\tif(!DT.isDateTime(a)){\n\t\t\tif(format === \"iso\"){\n\t\t\t\ta = DT.fromISO(String(a));\n\t\t\t}else {\n\t\t\t\ta = DT.fromFormat(String(a), format);\n\t\t\t}\n\t\t}\n\n\t\tif(!DT.isDateTime(b)){\n\t\t\tif(format === \"iso\"){\n\t\t\t\tb = DT.fromISO(String(b));\n\t\t\t}else {\n\t\t\t\tb = DT.fromFormat(String(b), format);\n\t\t\t}\n\t\t}\n\n\t\tif(!a.isValid){\n\t\t\temptyAlign = !b.isValid ? 0 : -1;\n\t\t}else if(!b.isValid){\n\t\t\temptyAlign =  1;\n\t\t}else {\n\t\t\t//compare valid values\n\t\t\treturn a - b;\n\t\t}\n\n\t\t//fix empty values in position\n\t\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\t\temptyAlign *= -1;\n\t\t}\n\n\t\treturn emptyAlign;\n\n\t}else {\n\t\tconsole.error(\"Sort Error - 'datetime' sorter is dependant on luxon.js\");\n\t}\n}\n\n//sort date\nfunction date(a, b, aRow, bRow, column, dir, params){\n\tif(!params.format){\n\t\tparams.format = \"dd/MM/yyyy\";\n\t}\n\n\treturn datetime.call(this, a, b, aRow, bRow, column, dir, params);\n}\n\n//sort times\nfunction time(a, b, aRow, bRow, column, dir, params){\n\tif(!params.format){\n\t\tparams.format = \"HH:mm\";\n\t}\n\n\treturn datetime.call(this, a, b, aRow, bRow, column, dir, params);\n}\n\n//sort booleans\nfunction boolean(a, b, aRow, bRow, column, dir, params){\n\tvar el1 = a === true || a === \"true\" || a === \"True\" || a === 1 ? 1 : 0;\n\tvar el2 = b === true || b === \"true\" || b === \"True\" || b === 1 ? 1 : 0;\n\n\treturn el1 - el2;\n}\n\n//sort if element contains any data\nfunction array(a, b, aRow, bRow, column, dir, params){\n\tvar type = params.type || \"length\",\n\talignEmptyValues = params.alignEmptyValues,\n\temptyAlign = 0,\n\ttable = this.table,\n\tvalueMap;\n\n\tif(params.valueMap){\n\t\tif(typeof params.valueMap === \"string\"){\n\t\t\tvalueMap = function(value){\n\t\t\t\treturn value.map((item) => {\n\t\t\t\t\treturn Helpers.retrieveNestedData(table.options.nestedFieldSeparator, params.valueMap, item);\n\t\t\t\t});\n\t\t\t};\n\t\t}else {\n\t\t\tvalueMap = params.valueMap;\n\t\t}\n\t}\n\n\tfunction calc(value){\n\t\tvar result;\n\t\t\n\t\tif(valueMap){\n\t\t\tvalue = valueMap(value);\n\t\t}\n\n\t\tswitch(type){\n\t\t\tcase \"length\":\n\t\t\t\tresult = value.length;\n\t\t\t\tbreak;\n\n\t\t\tcase \"sum\":\n\t\t\t\tresult = value.reduce(function(c, d){\n\t\t\t\t\treturn c + d;\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tcase \"max\":\n\t\t\t\tresult = Math.max.apply(null, value) ;\n\t\t\t\tbreak;\n\n\t\t\tcase \"min\":\n\t\t\t\tresult = Math.min.apply(null, value) ;\n\t\t\t\tbreak;\n\n\t\t\tcase \"avg\":\n\t\t\t\tresult = value.reduce(function(c, d){\n\t\t\t\t\treturn c + d;\n\t\t\t\t}) / value.length;\n\t\t\t\tbreak;\n\n\t\t\tcase \"string\":\n\t\t\t\tresult = value.join(\"\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t//handle non array values\n\tif(!Array.isArray(a)){\n\t\temptyAlign = !Array.isArray(b) ? 0 : -1;\n\t}else if(!Array.isArray(b)){\n\t\temptyAlign = 1;\n\t}else {\n\t\tif(type === \"string\"){\n\t\t\treturn String(calc(a)).toLowerCase().localeCompare(String(calc(b)).toLowerCase());\n\t\t}else {\n\t\t\treturn calc(b) - calc(a);\n\t\t}\n\t}\n\n\t//fix empty values in position\n\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\temptyAlign *= -1;\n\t}\n\n\treturn emptyAlign;\n}\n\n//sort if element contains any data\nfunction exists(a, b, aRow, bRow, column, dir, params){\n\tvar el1 = typeof a == \"undefined\" ? 0 : 1;\n\tvar el2 = typeof b == \"undefined\" ? 0 : 1;\n\n\treturn el1 - el2;\n}\n\n//sort alpha numeric strings\nfunction alphanum(as, bs, aRow, bRow, column, dir, params){\n\tvar a, b, a1, b1, i= 0, L, rx = /(\\d+)|(\\D+)/g, rd = /\\d/;\n\tvar alignEmptyValues = params.alignEmptyValues;\n\tvar emptyAlign = 0;\n\n\t//handle empty values\n\tif(!as && as!== 0){\n\t\temptyAlign =  !bs && bs!== 0 ? 0 : -1;\n\t}else if(!bs && bs!== 0){\n\t\temptyAlign =  1;\n\t}else {\n\n\t\tif(isFinite(as) && isFinite(bs)) return as - bs;\n\t\ta = String(as).toLowerCase();\n\t\tb = String(bs).toLowerCase();\n\t\tif(a === b) return 0;\n\t\tif(!(rd.test(a) && rd.test(b))) return a > b ? 1 : -1;\n\t\ta = a.match(rx);\n\t\tb = b.match(rx);\n\t\tL = a.length > b.length ? b.length : a.length;\n\t\twhile(i < L){\n\t\t\ta1= a[i];\n\t\t\tb1= b[i++];\n\t\t\tif(a1 !== b1){\n\t\t\t\tif(isFinite(a1) && isFinite(b1)){\n\t\t\t\t\tif(a1.charAt(0) === \"0\") a1 = \".\" + a1;\n\t\t\t\t\tif(b1.charAt(0) === \"0\") b1 = \".\" + b1;\n\t\t\t\t\treturn a1 - b1;\n\t\t\t\t}\n\t\t\t\telse return a1 > b1 ? 1 : -1;\n\t\t\t}\n\t\t}\n\n\t\treturn a.length > b.length;\n\t}\n\n\t//fix empty values in position\n\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\temptyAlign *= -1;\n\t}\n\n\treturn emptyAlign;\n}\n\nvar defaultSorters = {\n\tnumber:number,\n\tstring:string,\n\tdate:date,\n\ttime:time,\n\tdatetime:datetime,\n\tboolean:boolean,\n\tarray:array,\n\texists:exists,\n\talphanum:alphanum\n};\n\nclass Sort extends Module{\n\n\tstatic moduleName = \"sort\";\n\n\t//load defaults\n\tstatic sorters = defaultSorters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.sortList = []; //holder current sort\n\t\tthis.changed = false; //has the sort changed since last render\n\t\t\n\t\tthis.registerTableOption(\"sortMode\", \"local\"); //local or remote sorting\n\t\t\n\t\tthis.registerTableOption(\"initialSort\", false); //initial sorting criteria\n\t\tthis.registerTableOption(\"columnHeaderSortMulti\", true); //multiple or single column sorting\n\t\tthis.registerTableOption(\"sortOrderReverse\", false); //reverse internal sort ordering\n\t\tthis.registerTableOption(\"headerSortElement\", \"<div class='tabulator-arrow'></div>\"); //header sort element\n\t\tthis.registerTableOption(\"headerSortClickElement\", \"header\"); //element which triggers sort when clicked\n\t\t\n\t\tthis.registerColumnOption(\"sorter\");\n\t\tthis.registerColumnOption(\"sorterParams\");\n\t\t\n\t\tthis.registerColumnOption(\"headerSort\", true);\n\t\tthis.registerColumnOption(\"headerSortStartingDir\");\n\t\tthis.registerColumnOption(\"headerSortTristate\");\n\t\t\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"table-built\", this.tableBuilt.bind(this));\n\t\tthis.registerDataHandler(this.sort.bind(this), 20);\n\t\t\n\t\tthis.registerTableFunction(\"setSort\", this.userSetSort.bind(this));\n\t\tthis.registerTableFunction(\"getSorters\", this.getSort.bind(this));\n\t\tthis.registerTableFunction(\"clearSort\", this.clearSort.bind(this));\n\t\t\n\t\tif(this.table.options.sortMode === \"remote\"){\n\t\t\tthis.subscribe(\"data-params\", this.remoteSortParams.bind(this));\n\t\t}\n\t}\n\t\n\ttableBuilt(){\n\t\tif(this.table.options.initialSort){\n\t\t\tthis.setSort(this.table.options.initialSort);\n\t\t}\n\t}\n\t\n\tremoteSortParams(data, config, silent, params){\n\t\tvar sorters = this.getSort();\n\t\t\n\t\tsorters.forEach((item) => {\n\t\t\tdelete item.column;\n\t\t});\n\t\t\n\t\tparams.sort = sorters;\n\t\t\n\t\treturn params;\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\t\n\tuserSetSort(sortList, dir){\n\t\tthis.setSort(sortList, dir);\n\t\t// this.table.rowManager.sorterRefresh();\n\t\tthis.refreshSort();\n\t}\n\t\n\tclearSort(){\n\t\tthis.clear();\n\t\t// this.table.rowManager.sorterRefresh();\n\t\tthis.refreshSort();\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\t//initialize column header for sorting\n\tinitializeColumn(column){\n\t\tvar sorter = false,\n\t\tcolEl,\n\t\tarrowEl;\n\t\t\n\t\tswitch(typeof column.definition.sorter){\n\t\t\tcase \"string\":\n\t\t\t\tif(Sort.sorters[column.definition.sorter]){\n\t\t\t\t\tsorter = Sort.sorters[column.definition.sorter];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Sort Error - No such sorter found: \", column.definition.sorter);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"function\":\n\t\t\t\tsorter = column.definition.sorter;\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\tcolumn.modules.sort = {\n\t\t\tsorter:sorter, dir:\"none\",\n\t\t\tparams:column.definition.sorterParams || {},\n\t\t\tstartingDir:column.definition.headerSortStartingDir || \"asc\",\n\t\t\ttristate: column.definition.headerSortTristate,\n\t\t};\n\t\t\n\t\tif(column.definition.headerSort !== false){\n\t\t\t\n\t\t\tcolEl = column.getElement();\n\t\t\t\n\t\t\tcolEl.classList.add(\"tabulator-sortable\");\n\t\t\t\n\t\t\tarrowEl = document.createElement(\"div\");\n\t\t\tarrowEl.classList.add(\"tabulator-col-sorter\");\n\t\t\t\n\t\t\tswitch(this.table.options.headerSortClickElement){\n\t\t\t\tcase \"icon\":\n\t\t\t\t\tarrowEl.classList.add(\"tabulator-col-sorter-element\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"header\":\n\t\t\t\t\tcolEl.classList.add(\"tabulator-col-sorter-element\");\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tcolEl.classList.add(\"tabulator-col-sorter-element\");\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tswitch(this.table.options.headerSortElement){\n\t\t\t\tcase \"function\":\n\t\t\t\t//do nothing\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"object\":\n\t\t\t\t\tarrowEl.appendChild(this.table.options.headerSortElement);\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tdefault:\n\t\t\t\t\tarrowEl.innerHTML = this.table.options.headerSortElement;\n\t\t\t}\n\t\t\t\n\t\t\t//create sorter arrow\n\t\t\tcolumn.titleHolderElement.appendChild(arrowEl);\n\t\t\t\n\t\t\tcolumn.modules.sort.element = arrowEl;\n\t\t\t\n\t\t\tthis.setColumnHeaderSortIcon(column, \"none\");\n\t\t\t\n\t\t\tif(this.table.options.headerSortClickElement === \"icon\"){\n\t\t\t\tarrowEl.addEventListener(\"mousedown\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t//sort on click\n\t\t\t(this.table.options.headerSortClickElement === \"icon\" ? arrowEl : colEl).addEventListener(\"click\", (e) => {\n\t\t\t\tvar dir = \"\",\n\t\t\t\tsorters=[],\n\t\t\t\tmatch = false;\n\t\t\t\t\n\t\t\t\tif(column.modules.sort){\n\t\t\t\t\tif(column.modules.sort.tristate){\n\t\t\t\t\t\tif(column.modules.sort.dir == \"none\"){\n\t\t\t\t\t\t\tdir = column.modules.sort.startingDir;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tif(column.modules.sort.dir == column.modules.sort.startingDir){\n\t\t\t\t\t\t\t\tdir = column.modules.sort.dir == \"asc\" ? \"desc\" : \"asc\";\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tdir = \"none\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tswitch(column.modules.sort.dir){\n\t\t\t\t\t\t\tcase \"asc\":\n\t\t\t\t\t\t\t\tdir = \"desc\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcase \"desc\":\n\t\t\t\t\t\t\t\tdir = \"asc\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tdir = column.modules.sort.startingDir;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (this.table.options.columnHeaderSortMulti && (e.shiftKey || e.ctrlKey)) {\n\t\t\t\t\t\tsorters = this.getSort();\n\t\t\t\t\t\t\n\t\t\t\t\t\tmatch = sorters.findIndex((sorter) => {\n\t\t\t\t\t\t\treturn sorter.field === column.getField();\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(match > -1){\n\t\t\t\t\t\t\tsorters[match].dir = dir;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tmatch = sorters.splice(match, 1)[0];\n\t\t\t\t\t\t\tif(dir != \"none\"){\n\t\t\t\t\t\t\t\tsorters.push(match);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tif(dir != \"none\"){\n\t\t\t\t\t\t\t\tsorters.push({column:column, dir:dir});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//add to existing sort\n\t\t\t\t\t\tthis.setSort(sorters);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(dir == \"none\"){\n\t\t\t\t\t\t\tthis.clear();\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t//sort by column only\n\t\t\t\t\t\t\tthis.setSort(column, dir);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// this.table.rowManager.sorterRefresh(!this.sortList.length);\n\t\t\t\t\tthis.refreshSort();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\t\n\trefreshSort(){\n\t\tif(this.table.options.sortMode === \"remote\"){\n\t\t\tthis.reloadData(null, false, false);\n\t\t}else {\n\t\t\tthis.refreshData(true);\n\t\t}\n\t\t\n\t\t//TODO - Persist left position of row manager\n\t\t// left = this.scrollLeft;\n\t\t// this.scrollHorizontal(left);\n\t}\n\t\n\t//check if the sorters have changed since last use\n\thasChanged(){\n\t\tvar changed = this.changed;\n\t\tthis.changed = false;\n\t\treturn changed;\n\t}\n\t\n\t//return current sorters\n\tgetSort(){\n\t\tvar self = this,\n\t\tsorters = [];\n\t\t\n\t\tself.sortList.forEach(function(item){\n\t\t\tif(item.column){\n\t\t\t\tsorters.push({column:item.column.getComponent(), field:item.column.getField(), dir:item.dir});\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn sorters;\n\t}\n\t\n\t//change sort list and trigger sort\n\tsetSort(sortList, dir){\n\t\tvar self = this,\n\t\tnewSortList = [];\n\t\t\n\t\tif(!Array.isArray(sortList)){\n\t\t\tsortList = [{column: sortList, dir:dir}];\n\t\t}\n\t\t\n\t\tsortList.forEach(function(item){\n\t\t\tvar column;\n\t\t\t\n\t\t\tcolumn = self.table.columnManager.findColumn(item.column);\n\t\t\t\n\t\t\tif(column){\n\t\t\t\titem.column = column;\n\t\t\t\tnewSortList.push(item);\n\t\t\t\tself.changed = true;\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Sort Warning - Sort field does not exist and is being ignored: \", item.column);\n\t\t\t}\n\t\t\t\n\t\t});\n\t\t\n\t\tself.sortList = newSortList;\n\t\t\n\t\tthis.dispatch(\"sort-changed\");\n\t}\n\t\n\t//clear sorters\n\tclear(){\n\t\tthis.setSort([]);\n\t}\n\t\n\t//find appropriate sorter for column\n\tfindSorter(column){\n\t\tvar row = this.table.rowManager.activeRows[0],\n\t\tsorter = \"string\",\n\t\tfield, value;\n\t\t\n\t\tif(row){\n\t\t\trow = row.getData();\n\t\t\tfield = column.getField();\n\t\t\t\n\t\t\tif(field){\n\t\t\t\t\n\t\t\t\tvalue = column.getFieldValue(row);\n\t\t\t\t\n\t\t\t\tswitch(typeof value){\n\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\tsorter = \"string\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"boolean\":\n\t\t\t\t\t\tsorter = \"boolean\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!isNaN(value) && value !== \"\"){\n\t\t\t\t\t\t\tsorter = \"number\";\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tif(value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)){\n\t\t\t\t\t\t\t\tsorter = \"alphanum\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn Sort.sorters[sorter];\n\t}\n\t\n\t//work through sort list sorting data\n\tsort(data, sortOnly){\n\t\tvar self = this,\n\t\tsortList = this.table.options.sortOrderReverse ? self.sortList.slice().reverse() : self.sortList,\n\t\tsortListActual = [],\n\t\trowComponents = [];\n\t\t\n\t\tif(this.subscribedExternal(\"dataSorting\")){\n\t\t\tthis.dispatchExternal(\"dataSorting\", self.getSort());\n\t\t}\n\t\t\n\t\tif(!sortOnly) {\n\t\t\tself.clearColumnHeaders();\n\t\t}\n\t\t\n\t\tif(this.table.options.sortMode !== \"remote\"){\n\t\t\t\n\t\t\t//build list of valid sorters and trigger column specific callbacks before sort begins\n\t\t\tsortList.forEach(function(item, i){\n\t\t\t\tvar sortObj;\n\t\t\t\t\n\t\t\t\tif(item.column){\n\t\t\t\t\tsortObj = item.column.modules.sort;\n\t\t\t\t\t\n\t\t\t\t\tif(sortObj){\n\t\t\t\t\t\t\n\t\t\t\t\t\t//if no sorter has been defined, take a guess\n\t\t\t\t\t\tif(!sortObj.sorter){\n\t\t\t\t\t\t\tsortObj.sorter = self.findSorter(item.column);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\titem.params = typeof sortObj.params === \"function\" ? sortObj.params(item.column.getComponent(), item.dir) : sortObj.params;\n\t\t\t\t\t\t\n\t\t\t\t\t\tsortListActual.push(item);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(!sortOnly) {\n\t\t\t\t\t\tself.setColumnHeader(item.column, item.dir);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t//sort data\n\t\t\tif (sortListActual.length) {\n\t\t\t\tself._sortItems(data, sortListActual);\n\t\t\t}\n\t\t\t\n\t\t}else if(!sortOnly) {\n\t\t\tsortList.forEach(function(item, i){\n\t\t\t\tself.setColumnHeader(item.column, item.dir);\n\t\t\t});\n\t\t}\n\n\t\t\n\t\tif(this.subscribedExternal(\"dataSorted\")){\n\t\t\tdata.forEach((row) => {\n\t\t\t\trowComponents.push(row.getComponent());\n\t\t\t});\n\t\t\t\n\t\t\tthis.dispatchExternal(\"dataSorted\", self.getSort(), rowComponents);\n\t\t}\n\t\t\n\t\treturn data;\n\t}\n\t\n\t//clear sort arrows on columns\n\tclearColumnHeaders(){\n\t\tthis.table.columnManager.getRealColumns().forEach((column) => {\n\t\t\tif(column.modules.sort){\n\t\t\t\tcolumn.modules.sort.dir = \"none\";\n\t\t\t\tcolumn.getElement().setAttribute(\"aria-sort\", \"none\");\n\t\t\t\tthis.setColumnHeaderSortIcon(column, \"none\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//set the column header sort direction\n\tsetColumnHeader(column, dir){\n\t\tcolumn.modules.sort.dir = dir;\n\t\tcolumn.getElement().setAttribute(\"aria-sort\", dir === \"asc\" ? \"ascending\" : \"descending\");\n\t\tthis.setColumnHeaderSortIcon(column, dir);\n\t}\n\t\n\tsetColumnHeaderSortIcon(column, dir){\n\t\tvar sortEl = column.modules.sort.element,\n\t\tarrowEl;\n\t\t\n\t\tif(column.definition.headerSort && typeof this.table.options.headerSortElement === \"function\"){\n\t\t\twhile(sortEl.firstChild) sortEl.removeChild(sortEl.firstChild);\n\t\t\t\n\t\t\tarrowEl = this.table.options.headerSortElement.call(this.table, column.getComponent(), dir);\n\t\t\t\n\t\t\tif(typeof arrowEl === \"object\"){\n\t\t\t\tsortEl.appendChild(arrowEl);\n\t\t\t}else {\n\t\t\t\tsortEl.innerHTML = arrowEl;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//sort each item in sort list\n\t_sortItems(data, sortList){\n\t\tvar sorterCount = sortList.length - 1;\n\t\t\n\t\tdata.sort((a, b) => {\n\t\t\tvar result;\n\t\t\t\n\t\t\tfor(var i = sorterCount; i>= 0; i--){\n\t\t\t\tlet sortItem = sortList[i];\n\t\t\t\t\n\t\t\t\tresult = this._sortRow(a, b, sortItem.column, sortItem.dir, sortItem.params);\n\t\t\t\t\n\t\t\t\tif(result !== 0){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn result;\n\t\t});\n\t}\n\t\n\t//process individual rows for a sort function on active data\n\t_sortRow(a, b, column, dir, params){\n\t\tvar el1Comp, el2Comp;\n\t\t\n\t\t//switch elements depending on search direction\n\t\tvar el1 = dir == \"asc\" ? a : b;\n\t\tvar el2 = dir == \"asc\" ? b : a;\n\t\t\n\t\ta = column.getFieldValue(el1.getData());\n\t\tb = column.getFieldValue(el2.getData());\n\t\t\n\t\ta = typeof a !== \"undefined\" ? a : \"\";\n\t\tb = typeof b !== \"undefined\" ? b : \"\";\n\t\t\n\t\tel1Comp = el1.getComponent();\n\t\tel2Comp = el2.getComponent();\n\t\t\n\t\treturn column.modules.sort.sorter.call(this, a, b, el1Comp, el2Comp, column.getComponent(), dir, params);\n\t}\n}\n\nclass GridCalculator{\r\n\tconstructor(columns, rows){\r\n\t\tthis.columnCount = columns;\r\n\t\tthis.rowCount = rows;\r\n\r\n\t\tthis.columnString = [];\r\n\t\tthis.columns = [];\r\n\t\tthis.rows = [];\r\n\t}\r\n\r\n\tgenColumns(data){\r\n\t\tvar colCount = Math.max(this.columnCount, Math.max(...data.map(item => item.length)));\r\n\r\n\t\tthis.columnString = [];\r\n\t\tthis.columns = [];\r\n\r\n\t\tfor(let i = 1; i <= colCount; i++){\r\n\t\t\tthis.incrementChar(this.columnString.length - 1);\r\n\t\t\tthis.columns.push(this.columnString.join(\"\"));\r\n\t\t}\r\n\r\n\t\treturn this.columns;\r\n\t}\r\n\r\n\tgenRows(data){\r\n\t\tvar rowCount = Math.max(this.rowCount, data.length);\r\n\r\n\t\tthis.rows = [];\r\n\r\n\t\tfor(let i = 1; i <= rowCount; i++){\r\n\t\t\tthis.rows.push(i);\r\n\t\t}\r\n\t\t\r\n\t\treturn this.rows;\r\n\t}\r\n\r\n\tincrementChar(i){\r\n\t\tlet char = this.columnString[i];\r\n\r\n\t\tif(char){\r\n\t\t\tif(char !== \"Z\"){\r\n\t\t\t\tthis.columnString[i] = String.fromCharCode(this.columnString[i].charCodeAt(0) + 1);\r\n\t\t\t}else {\r\n\t\t\t\tthis.columnString[i] = \"A\";\r\n\t\t\t\t\r\n\t\t\t\tif(i){\r\n\t\t\t\t\tthis.incrementChar(i-1);\r\n\t\t\t\t}else {\r\n\t\t\t\t\tthis.columnString.push(\"A\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tthis.columnString.push(\"A\");\r\n\t\t}\r\n\t}\r\n\r\n\tsetRowCount(count){\r\n\t\tthis.rowCount = count;\r\n\t}\r\n\r\n\tsetColumnCount(count){\r\n\t\tthis.columnCount = count;\r\n\t}\r\n}\n\nclass SheetComponent {\r\n\tconstructor(sheet) {\r\n\t\tthis._sheet = sheet;\r\n\r\n\t\treturn new Proxy(this, {\r\n\t\t\tget: function (target, name, receiver) {\r\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\r\n\t\t\t\t\treturn target[name];\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn target._sheet.table.componentFunctionBinder.handle(\"sheet\", target._sheet, name);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\tgetTitle(){\r\n\t\treturn this._sheet.title;\r\n\t}\r\n\r\n\tgetKey(){\r\n\t\treturn this._sheet.key;\r\n\t}\r\n\r\n\tgetDefinition(){\r\n\t\treturn this._sheet.getDefinition();\r\n\t}\r\n\r\n\tgetData() {\r\n\t\treturn this._sheet.getData();\r\n\t}\r\n\r\n\tsetData(data) {\r\n\t\treturn this._sheet.setData(data);\r\n\t}\r\n\r\n\tclear(){\r\n\t\treturn this._sheet.clear();\r\n\t}\r\n\r\n\tremove(){\r\n\t\treturn this._sheet.remove();\r\n\t}\r\n\t\r\n\tactive(){\r\n\t\treturn this._sheet.active();\r\n\t}\r\n\r\n\tsetTitle(title){\r\n\t\treturn this._sheet.setTitle(title);\r\n\t}\r\n\r\n\tsetRows(rows){\r\n\t\treturn this._sheet.setRows(rows);\r\n\t}\r\n\r\n\tsetColumns(columns){\r\n\t\treturn this._sheet.setColumns(columns);\r\n\t}\r\n}\n\nclass Sheet extends CoreFeature{\r\n\tconstructor(spreadsheetManager, definition) {\r\n\t\tsuper(spreadsheetManager.table);\r\n\t\t\r\n\t\tthis.spreadsheetManager = spreadsheetManager;\r\n\t\tthis.definition = definition;\r\n\t\t\r\n\t\tthis.title = this.definition.title || \"\";\r\n\t\tthis.key = this.definition.key || this.definition.title;\r\n\t\tthis.rowCount = this.definition.rows;\r\n\t\tthis.columnCount = this.definition.columns;\r\n\t\tthis.data = this.definition.data || [];\r\n\t\tthis.element = null;\r\n\t\tthis.isActive = false;\r\n\t\t\r\n\t\tthis.grid = new GridCalculator(this.columnCount, this.rowCount);\r\n\t\t\r\n\t\tthis.defaultColumnDefinition = {width:100, headerHozAlign:\"center\", headerSort:false};\r\n\t\tthis.columnDefinition = Object.assign(this.defaultColumnDefinition, this.options(\"spreadsheetColumnDefinition\"));\r\n\t\t\r\n\t\tthis.columnDefs = [];\r\n\t\tthis.rowDefs = [];\r\n\t\tthis.columnFields = [];\r\n\t\tthis.columns = [];\r\n\t\tthis.rows = [];\r\n\t\t\r\n\t\tthis.scrollTop = null;\r\n\t\tthis.scrollLeft = null;\r\n\t\t\r\n\t\tthis.initialize();\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetAdded\", this.getComponent());\r\n\t}\r\n\t\r\n\t///////////////////////////////////\r\n\t///////// Initialization //////////\r\n\t///////////////////////////////////\r\n\t\r\n\tinitialize(){\r\n\t\tthis.initializeElement();\r\n\t\tthis.initializeColumns();\r\n\t\tthis.initializeRows();\r\n\t}\r\n\t\r\n\treinitialize(){\r\n\t\tthis.initializeColumns();\r\n\t\tthis.initializeRows();\r\n\t}\r\n\t\r\n\tinitializeElement(){\r\n\t\tthis.element = document.createElement(\"div\");\r\n\t\tthis.element.classList.add(\"tabulator-spreadsheet-tab\");\r\n\t\tthis.element.innerText = this.title;\r\n\t\t\r\n\t\tthis.element.addEventListener(\"click\", () => {\r\n\t\t\tthis.spreadsheetManager.loadSheet(this);\r\n\t\t});\r\n\t}\r\n\t\r\n\tinitializeColumns(){\r\n\t\tthis.grid.setColumnCount(this.columnCount);\r\n\t\tthis.columnFields = this.grid.genColumns(this.data);\r\n\t\t\r\n\t\tthis.columnDefs = [];\r\n\t\t\r\n\t\tthis.columnFields.forEach((ref) => {\r\n\t\t\tvar def = Object.assign({}, this.columnDefinition);\r\n\t\t\tdef.field = ref;\r\n\t\t\tdef.title = ref;\r\n\t\t\t\r\n\t\t\tthis.columnDefs.push(def);\r\n\t\t});\r\n\t}\r\n\t\r\n\tinitializeRows(){\r\n\t\tvar refs;\r\n\t\t\r\n\t\tthis.grid.setRowCount(this.rowCount);\r\n\t\t\r\n\t\trefs = this.grid.genRows(this.data);\r\n\t\t\r\n\t\tthis.rowDefs = [];\r\n\t\t\r\n\t\trefs.forEach((ref, i) => {\r\n\t\t\tvar def = {\"_id\":ref};\r\n\t\t\tvar data = this.data[i];\r\n\t\t\t\r\n\t\t\tif(data){\r\n\t\t\t\tdata.forEach((val, j) => {\r\n\t\t\t\t\tvar field = this.columnFields[j];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(field){\r\n\t\t\t\t\t\tdef[field] = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.rowDefs.push(def);\r\n\t\t});\r\n\t}\r\n\t\r\n\tunload(){\r\n\t\tthis.isActive = false;\r\n\t\tthis.scrollTop = this.table.rowManager.scrollTop;\r\n\t\tthis.scrollLeft = this.table.rowManager.scrollLeft;\r\n\t\tthis.data = this.getData(true);\r\n\t\tthis.element.classList.remove(\"tabulator-spreadsheet-tab-active\");\r\n\t}\r\n\t\r\n\tload(){\r\n\t\t\r\n\t\tvar wasInactive = !this.isActive;\r\n\t\t\r\n\t\tthis.isActive = true;\r\n\t\tthis.table.blockRedraw();\r\n\t\tthis.table.setData([]);\r\n\t\tthis.table.setColumns(this.columnDefs);\r\n\t\tthis.table.setData(this.rowDefs);\r\n\t\tthis.table.restoreRedraw();\r\n\t\t\r\n\t\tif(wasInactive && this.scrollTop !== null){\r\n\t\t\tthis.table.rowManager.element.scrollLeft = this.scrollLeft;\r\n\t\t\tthis.table.rowManager.element.scrollTop = this.scrollTop;\r\n\t\t}\r\n\t\t\r\n\t\tthis.element.classList.add(\"tabulator-spreadsheet-tab-active\");\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetLoaded\", this.getComponent());\r\n\t}\r\n\t\r\n\t///////////////////////////////////\r\n\t//////// Helper Functions /////////\r\n\t///////////////////////////////////\r\n\t\r\n\tgetComponent(){\r\n\t\treturn new SheetComponent(this);\r\n\t}\r\n\t\r\n\tgetDefinition(){\r\n\t\treturn {\r\n\t\t\ttitle:this.title,\r\n\t\t\tkey:this.key,\r\n\t\t\trows:this.rowCount,\r\n\t\t\tcolumns:this.columnCount,\r\n\t\t\tdata:this.getData(),\r\n\t\t};\r\n\t}\r\n\t\r\n\tgetData(full){\r\n\t\tvar output = [], \r\n\t\trowWidths,\r\n\t\toutputWidth, outputHeight;\r\n\t\t\r\n\t\t//map data to array format\r\n\t\tthis.rowDefs.forEach((rowData) => {\r\n\t\t\tvar row = [];\r\n\t\t\t\r\n\t\t\tthis.columnFields.forEach((field) => {\r\n\t\t\t\trow.push(rowData[field]);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\toutput.push(row);\r\n\t\t});\r\n\t\t\r\n\t\t//trim output\r\n\t\tif(!full && !this.options(\"spreadsheetOutputFull\")){\r\n\t\t\t\r\n\t\t\t//calculate used area of data\r\n\t\t\trowWidths = output.map(row => row.findLastIndex(val => typeof val !== 'undefined') + 1);\r\n\t\t\toutputWidth = Math.max(...rowWidths);\r\n\t\t\toutputHeight = rowWidths.findLastIndex(width => width > 0) + 1;\r\n\t\t\t\r\n\t\t\toutput = output.slice(0, outputHeight);\r\n\t\t\toutput = output.map(row => row.slice(0, outputWidth));\r\n\t\t}\r\n\t\t\r\n\t\treturn output;\r\n\t}\r\n\t\r\n\tsetData(data){\r\n\t\tthis.data = data;\r\n\t\tthis.reinitialize();\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetUpdated\", this.getComponent());\r\n\t\t\r\n\t\tif(this.isActive){\r\n\t\t\tthis.load();\r\n\t\t}\r\n\t}\r\n\t\r\n\tclear(){\r\n\t\tthis.setData([]);\r\n\t}\r\n\t\r\n\tsetTitle(title){\r\n\t\tthis.title = title;\r\n\t\tthis.element.innerText = title;\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetUpdated\", this.getComponent());\r\n\t}\r\n\t\r\n\tsetRows(rows){\r\n\t\tthis.rowCount = rows;\r\n\t\tthis.initializeRows();\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetUpdated\", this.getComponent());\r\n\t\t\r\n\t\tif(this.isActive){\r\n\t\t\tthis.load();\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetColumns(columns){\r\n\t\tthis.columnCount = columns;\r\n\t\tthis.reinitialize();\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetUpdated\", this.getComponent());\r\n\t\t\r\n\t\tif(this.isActive){\r\n\t\t\tthis.load();\r\n\t\t}\r\n\t}\r\n\t\r\n\tremove(){\r\n\t\tthis.spreadsheetManager.removeSheet(this);\r\n\t}\r\n\t\r\n\tdestroy(){\r\n\t\tif(this.element.parentNode){\r\n\t\t\tthis.element.parentNode.removeChild(this.element);\r\n\t\t}\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetRemoved\", this.getComponent());\r\n\t}\r\n\t\r\n\tactive(){\r\n\t\tthis.spreadsheetManager.loadSheet(this);\r\n\t}\r\n}\n\nclass Spreadsheet extends Module{\r\n\t\r\n\tstatic moduleName = \"spreadsheet\";\r\n\t\r\n\tconstructor(table){\r\n\t\tsuper(table);\r\n\t\t\r\n\t\tthis.sheets = [];\r\n\t\tthis.element = null;\r\n\t\t\r\n\t\tthis.registerTableOption(\"spreadsheet\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetRows\", 50); \r\n\t\tthis.registerTableOption(\"spreadsheetColumns\", 50); \r\n\t\tthis.registerTableOption(\"spreadsheetColumnDefinition\", {}); \r\n\t\tthis.registerTableOption(\"spreadsheetOutputFull\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetData\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetSheets\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetSheetTabs\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetSheetTabsElement\", false); \r\n\t\t\r\n\t\tthis.registerTableFunction(\"setSheets\", this.setSheets.bind(this));\r\n\t\tthis.registerTableFunction(\"addSheet\", this.addSheet.bind(this));\r\n\t\tthis.registerTableFunction(\"getSheets\", this.getSheets.bind(this));\r\n\t\tthis.registerTableFunction(\"getSheetDefinitions\", this.getSheetDefinitions.bind(this));\r\n\t\tthis.registerTableFunction(\"setSheetData\", this.setSheetData.bind(this));\r\n\t\tthis.registerTableFunction(\"getSheet\", this.getSheet.bind(this));\r\n\t\tthis.registerTableFunction(\"getSheetData\", this.getSheetData.bind(this));\r\n\t\tthis.registerTableFunction(\"clearSheet\", this.clearSheet.bind(this));\r\n\t\tthis.registerTableFunction(\"removeSheet\", this.removeSheetFunc.bind(this));\r\n\t\tthis.registerTableFunction(\"activeSheet\", this.activeSheetFunc.bind(this));\r\n\t}\r\n\t\r\n\t///////////////////////////////////\r\n\t////// Module Initialization //////\r\n\t///////////////////////////////////\r\n\t\r\n\t\r\n\tinitialize(){\r\n\t\tif(this.options(\"spreadsheet\")){\t\r\n\t\t\tthis.subscribe(\"table-initialized\", this.tableInitialized.bind(this));\r\n\t\t\tthis.subscribe(\"data-loaded\", this.loadRemoteData.bind(this));\r\n\t\t\t\r\n\t\t\tthis.table.options.index = \"_id\";\r\n\t\t\t\r\n\t\t\tif(this.options(\"spreadsheetData\") && this.options(\"spreadsheetSheets\")){\r\n\t\t\t\tconsole.warn(\"You cannot use spreadsheetData and spreadsheetSheets at the same time, ignoring spreadsheetData\");\r\n\t\t\t\t\r\n\t\t\t\tthis.table.options.spreadsheetData = false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.compatibilityCheck();\r\n\t\t\t\r\n\t\t\tif(this.options(\"spreadsheetSheetTabs\")){\r\n\t\t\t\tthis.initializeTabset();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tcompatibilityCheck(){\r\n\t\tif(this.options(\"data\")){\r\n\t\t\tconsole.warn(\"Do not use the data option when working with spreadsheets, use either spreadsheetData or spreadsheetSheets to pass data into the table\");\r\n\t\t}\r\n\t\t\r\n\t\tif(this.options(\"pagination\")){\r\n\t\t\tconsole.warn(\"The spreadsheet module is not compatible with the pagination module\");\r\n\t\t}\r\n\t\t\r\n\t\tif(this.options(\"groupBy\")){\r\n\t\t\tconsole.warn(\"The spreadsheet module is not compatible with the row grouping module\");\r\n\t\t}\r\n\t\t\r\n\t\tif(this.options(\"responsiveCollapse\")){\r\n\t\t\tconsole.warn(\"The spreadsheet module is not compatible with the responsive collapse module\");\r\n\t\t}\r\n\t}\r\n\tinitializeTabset(){\r\n\t\tthis.element = document.createElement(\"div\");\r\n\t\tthis.element.classList.add(\"tabulator-spreadsheet-tabs\");\r\n\t\tvar altContainer = this.options(\"spreadsheetSheetTabsElement\");\r\n\t\t\r\n\t\tif(altContainer && !(altContainer instanceof HTMLElement)){\r\n\t\t\taltContainer = document.querySelector(altContainer);\r\n\t\t\t\r\n\t\t\tif(!altContainer){\r\n\t\t\t\tconsole.warn(\"Unable to find element matching spreadsheetSheetTabsElement selector:\", this.options(\"spreadsheetSheetTabsElement\"));\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(altContainer){\r\n\t\t\taltContainer.appendChild(this.element);\r\n\t\t}else {\r\n\t\t\tthis.footerAppend(this.element);\r\n\t\t}\r\n\t}\r\n\t\r\n\ttableInitialized(){\r\n\t\tif(this.sheets.length){\r\n\t\t\tthis.loadSheet(this.sheets[0]);\r\n\t\t}else {\r\n\t\t\t\r\n\t\t\tif(this.options(\"spreadsheetSheets\")){\r\n\t\t\t\tthis.loadSheets(this.options(\"spreadsheetSheets\"));\r\n\t\t\t}else if(this.options(\"spreadsheetData\")){\r\n\t\t\t\tthis.loadData(this.options(\"spreadsheetData\"));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t///////////////////////////////////\r\n\t/////////// Ajax Parsing //////////\r\n\t///////////////////////////////////\r\n\r\n\tloadRemoteData(data, data1, data2){\r\n\t\tconsole.log(\"data\", data, data1, data2);\r\n\r\n\t\tif(Array.isArray(data)){\r\n\r\n\t\t\tthis.table.dataLoader.clearAlert();\r\n\t\t\tthis.dispatchExternal(\"dataLoaded\", data);\r\n\r\n\t\t\tif(!data.length || Array.isArray(data[0])){\r\n\t\t\t\tthis.loadData(data);\r\n\t\t\t}else {\r\n\t\t\t\tthis.loadSheets(data);\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tconsole.error(\"Spreadsheet Loading Error - Unable to process remote data due to invalid data type \\nExpecting: array \\nReceived: \", typeof data, \"\\nData:     \", data);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t///////////////////////////////////\r\n\t///////// Sheet Management ////////\r\n\t///////////////////////////////////\r\n\t\r\n\t\r\n\tloadData(data){\r\n\t\tvar def = {\r\n\t\t\tdata:data,\r\n\t\t};\r\n\t\t\r\n\t\tthis.loadSheet(this.newSheet(def));\r\n\t}\r\n\t\r\n\tdestroySheets(){\r\n\t\tthis.sheets.forEach((sheet) => {\r\n\t\t\tsheet.destroy();\r\n\t\t});\r\n\t\t\r\n\t\tthis.sheets = [];\r\n\t\tthis.activeSheet = null;\r\n\t}\r\n\t\r\n\tloadSheets(sheets){\t\r\n\t\tif(!Array.isArray(sheets)){\r\n\t\t\tsheets = [];\r\n\t\t}\r\n\t\t\r\n\t\tthis.destroySheets();\r\n\t\t\r\n\t\tsheets.forEach((def) => {\r\n\t\t\tthis.newSheet(def);\r\n\t\t});\r\n\t\t\r\n\t\tthis.loadSheet(this.sheets[0]);\r\n\t}\r\n\t\r\n\tloadSheet(sheet){\r\n\t\tif(this.activeSheet !== sheet){\r\n\t\t\tif(this.activeSheet){\r\n\t\t\t\tthis.activeSheet.unload();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.activeSheet = sheet;\r\n\t\t\t\r\n\t\t\tsheet.load();\r\n\t\t}\r\n\t}\r\n\t\r\n\tnewSheet(definition = {}){\r\n\t\tvar sheet;\r\n\t\t\r\n\t\tif(!definition.rows){\r\n\t\t\tdefinition.rows = this.options(\"spreadsheetRows\");\r\n\t\t}\r\n\t\t\r\n\t\tif(!definition.columns){\r\n\t\t\tdefinition.columns = this.options(\"spreadsheetColumns\");\r\n\t\t}\r\n\t\t\r\n\t\tsheet = new Sheet(this, definition);\r\n\t\t\r\n\t\tthis.sheets.push(sheet);\r\n\t\t\r\n\t\tif(this.element){\r\n\t\t\tthis.element.appendChild(sheet.element);\r\n\t\t}\r\n\t\t\r\n\t\treturn sheet;\r\n\t}\r\n\t\r\n\tremoveSheet(sheet){\r\n\t\tvar index = this.sheets.indexOf(sheet),\r\n\t\tprevSheet;\r\n\t\t\r\n\t\tif(this.sheets.length > 1){\r\n\t\t\tif(index > -1){\r\n\t\t\t\tthis.sheets.splice(index, 1);\r\n\t\t\t\tsheet.destroy();\r\n\t\t\t\t\r\n\t\t\t\tif(this.activeSheet === sheet){\r\n\t\t\t\t\t\r\n\t\t\t\t\tprevSheet = this.sheets[index - 1] || this.sheets[0];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(prevSheet){\r\n\t\t\t\t\t\tthis.loadSheet(prevSheet);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t\tthis.activeSheet = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tconsole.warn(\"Unable to remove sheet, at least one sheet must be active\");\r\n\t\t}\r\n\t}\r\n\t\r\n\tlookupSheet(key){\r\n\t\tif(!key){\r\n\t\t\treturn this.activeSheet;\r\n\t\t}else if(key instanceof Sheet){\r\n\t\t\treturn key;\r\n\t\t}else if(key instanceof SheetComponent){\r\n\t\t\treturn key._sheet;\r\n\t\t}else {\r\n\t\t\treturn this.sheets.find(sheet => sheet.key === key) || false;\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t///////////////////////////////////\r\n\t//////// Public Functions /////////\r\n\t///////////////////////////////////\r\n\t\r\n\tsetSheets(sheets){\r\n\t\tthis.loadSheets(sheets);\r\n\r\n\t\treturn this.getSheets();\r\n\t}\r\n\r\n\taddSheet(sheet){\r\n\t\treturn this.newSheet(sheet).getComponent();\r\n\t}\r\n\t\r\n\tgetSheetDefinitions(){\r\n\t\treturn this.sheets.map(sheet => sheet.getDefinition());\r\n\t}\r\n\t\r\n\tgetSheets(){\r\n\t\treturn this.sheets.map(sheet => sheet.getComponent());\r\n\t}\r\n\t\r\n\tgetSheet(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? sheet.getComponent() : false;\r\n\t}\r\n\t\r\n\tsetSheetData(key, data){\r\n\t\tif (key && !data){\r\n\t\t\tdata = key;\r\n\t\t\tkey = false;\r\n\t\t}\r\n\t\t\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? sheet.setData(data) : false;\t\r\n\t}\r\n\t\r\n\tgetSheetData(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? sheet.getData() : false;\t\r\n\t}\r\n\t\r\n\tclearSheet(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? sheet.clear() : false;\r\n\t}\r\n\t\r\n\tremoveSheetFunc(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\tif(sheet){\r\n\t\t\tthis.removeSheet(sheet);\r\n\t\t}\r\n\t}\r\n\t\r\n\tactiveSheetFunc(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? this.loadSheet(sheet) : false;\r\n\t}\r\n}\n\nclass Tooltip extends Module{\n\n\tstatic moduleName = \"tooltip\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.tooltipSubscriber = null,\n\t\tthis.headerSubscriber = null,\n\t\t\n\t\tthis.timeout = null;\n\t\tthis.popupInstance = null;\n\t\t\n\t\t// this.registerTableOption(\"tooltipGenerationMode\", undefined);  //deprecated\n\t\tthis.registerTableOption(\"tooltipDelay\", 300); \n\t\t\n\t\tthis.registerColumnOption(\"tooltip\");\n\t\tthis.registerColumnOption(\"headerTooltip\");\n\t}\n\t\n\tinitialize(){\n\t\tthis.deprecatedOptionsCheck();\n\t\t\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t}\n\t\n\tdeprecatedOptionsCheck(){\n\t\t// this.deprecationCheckMsg(\"tooltipGenerationMode\", \"This option is no longer needed as tooltips are always generated on hover now\");\n\t}\t\n\t\n\tinitializeColumn(column){\n\t\tif(column.definition.headerTooltip && !this.headerSubscriber){\n\t\t\tthis.headerSubscriber = true;\n\t\t\t\n\t\t\tthis.subscribe(\"column-mousemove\", this.mousemoveCheck.bind(this, \"headerTooltip\"));\n\t\t\tthis.subscribe(\"column-mouseout\", this.mouseoutCheck.bind(this, \"headerTooltip\"));\n\t\t}\n\t\t\n\t\tif(column.definition.tooltip && !this.tooltipSubscriber){\n\t\t\tthis.tooltipSubscriber = true;\n\t\t\t\n\t\t\tthis.subscribe(\"cell-mousemove\", this.mousemoveCheck.bind(this, \"tooltip\"));\n\t\t\tthis.subscribe(\"cell-mouseout\", this.mouseoutCheck.bind(this, \"tooltip\"));\n\t\t}\n\t}\n\t\n\tmousemoveCheck(action, e, component){\n\t\tvar tooltip = action === \"tooltip\" ? component.column.definition.tooltip : component.definition.headerTooltip;\n\t\t\n\t\tif(tooltip){\n\t\t\tthis.clearPopup();\n\t\t\tthis.timeout = setTimeout(this.loadTooltip.bind(this, e, component, tooltip), this.table.options.tooltipDelay);\n\t\t}\n\t}\n\n\tmouseoutCheck(action, e, component){\n\t\tif(!this.popupInstance){\n\t\t\tthis.clearPopup();\n\t\t}\n\t}\n\t\n\tclearPopup(action, e, component){\n\t\tclearTimeout(this.timeout);\n\t\tthis.timeout = null;\n\t\t\n\t\tif(this.popupInstance){\n\t\t\tthis.popupInstance.hide();\n\t\t}\n\t}\n\t\n\tloadTooltip(e, component, tooltip){\n\t\tvar contentsEl, renderedCallback, coords;\n\n\t\tfunction onRendered(callback){\n\t\t\trenderedCallback = callback;\n\t\t}\n\t\t\n\t\tif(typeof tooltip === \"function\"){\n\t\t\ttooltip = tooltip(e, component.getComponent(), onRendered);\n\t\t}\n\t\t\n\t\tif(tooltip instanceof HTMLElement){\n\t\t\tcontentsEl = tooltip;\n\t\t}else {\n\t\t\tcontentsEl = document.createElement(\"div\");\n\t\t\t\n\t\t\tif(tooltip === true){\n\t\t\t\tif(component instanceof Cell){\n\t\t\t\t\ttooltip = component.value;\n\t\t\t\t}else {\n\t\t\t\t\tif(component.definition.field){\n\t\t\t\t\t\tthis.langBind(\"columns|\" + component.definition.field, (value) => {\n\t\t\t\t\t\t\tcontentsEl.innerHTML = tooltip = value || component.definition.title;\n\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\ttooltip = component.definition.title;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tcontentsEl.innerHTML = tooltip;\n\t\t}\n\t\t\n\t\tif(tooltip || tooltip === 0 || tooltip === false){\n\t\t\tcontentsEl.classList.add(\"tabulator-tooltip\");\n\n\t\t\tcontentsEl.addEventListener(\"mousemove\", e => e.preventDefault());\n\t\t\t\n\t\t\tthis.popupInstance = this.popup(contentsEl);\n\t\t\t\n\t\t\tif(typeof renderedCallback === \"function\"){\n\t\t\t\tthis.popupInstance.renderCallback(renderedCallback);\n\t\t\t}\n\n\t\t\tcoords = this.popupInstance.containerEventCoords(e);\n\t\t\t\n\t\t\tthis.popupInstance.show(coords.x + 15, coords.y + 15).hideOnBlur(() => {\n\t\t\t\tthis.dispatchExternal(\"TooltipClosed\", component.getComponent());\n\t\t\t\tthis.popupInstance = null;\n\t\t\t});\n\t\t\t\n\t\t\tthis.dispatchExternal(\"TooltipOpened\", component.getComponent());\n\t\t}\n\t}\n}\n\nvar defaultValidators = {\n\t//is integer\n\tinteger: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\n\t\tvalue = Number(value);\n\n\t\treturn !isNaN(value) && isFinite(value) && Math.floor(value) === value;\n\t},\n\n\t//is float\n\tfloat: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\tvalue = Number(value);\n\n\t\treturn !isNaN(value) && isFinite(value) && value % 1 !== 0;\n\t},\n\n\t//must be a number\n\tnumeric: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn !isNaN(value);\n\t},\n\n\t//must be a string\n\tstring: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn isNaN(value);\n\t},\n\n\t//must be alphanumeric\n\talphanumeric: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\n\t\tvar reg = new RegExp(/^[a-z0-9]+$/i);\n\n\t\treturn reg.test(value);\n\t},\n\n\t//maximum value\n\tmax: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn parseFloat(value) <= parameters;\n\t},\n\n\t//minimum value\n\tmin: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn parseFloat(value) >= parameters;\n\t},\n\n\t//starts with  value\n\tstarts: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).toLowerCase().startsWith(String(parameters).toLowerCase());\n\t},\n\n\t//ends with  value\n\tends: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).toLowerCase().endsWith(String(parameters).toLowerCase());\n\t},\n\n\n\t//minimum string length\n\tminLength: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).length >= parameters;\n\t},\n\n\t//maximum string length\n\tmaxLength: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).length <= parameters;\n\t},\n\n\t//in provided value list\n\tin: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\n\t\tif(typeof parameters == \"string\"){\n\t\t\tparameters = parameters.split(\"|\");\n\t\t}\n\n\t\treturn parameters.indexOf(value) > -1;\n\t},\n\n\t//must match provided regex\n\tregex: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\tvar reg = new RegExp(parameters);\n\n\t\treturn reg.test(value);\n\t},\n\n\t//value must be unique in this column\n\tunique: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\tvar unique = true;\n\n\t\tvar cellData = cell.getData();\n\t\tvar column = cell.getColumn()._getSelf();\n\n\t\tthis.table.rowManager.rows.forEach(function(row){\n\t\t\tvar data = row.getData();\n\n\t\t\tif(data !== cellData){\n\t\t\t\tif(value == column.getFieldValue(data)){\n\t\t\t\t\tunique = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn unique;\n\t},\n\n\t//must have a value\n\trequired:function(cell, value, parameters){\n\t\treturn value !== \"\" && value !== null && typeof value !== \"undefined\";\n\t},\n};\n\nclass Validate extends Module{\n\n\tstatic moduleName = \"validate\";\n\n\t//load defaults\n\tstatic validators = defaultValidators;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.invalidCells = [];\n\t\t\n\t\tthis.registerTableOption(\"validationMode\", \"blocking\");\n\t\t\n\t\tthis.registerColumnOption(\"validator\");\n\t\t\n\t\tthis.registerTableFunction(\"getInvalidCells\", this.getInvalidCells.bind(this));\n\t\tthis.registerTableFunction(\"clearCellValidation\", this.userClearCellValidation.bind(this));\n\t\tthis.registerTableFunction(\"validate\", this.userValidate.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"cell\", \"isValid\", this.cellIsValid.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"clearValidation\", this.clearValidation.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"validate\", this.cellValidate.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"column\", \"validate\", this.columnValidate.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"validate\", this.rowValidate.bind(this));\n\t}\n\t\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"cell-delete\", this.clearValidation.bind(this));\n\t\tthis.subscribe(\"column-layout\", this.initializeColumnCheck.bind(this));\n\t\t\n\t\tthis.subscribe(\"edit-success\", this.editValidate.bind(this));\n\t\tthis.subscribe(\"edit-editor-clear\", this.editorClear.bind(this));\n\t\tthis.subscribe(\"edit-edited-clear\", this.editedClear.bind(this));\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Event Handling //////////\n\t///////////////////////////////////\n\t\n\teditValidate(cell, value, previousValue){\n\t\tvar valid = this.table.options.validationMode !== \"manual\" ? this.validate(cell.column.modules.validate, cell, value) : true;\n\t\t\n\t\t// allow time for editor to make render changes then style cell\n\t\tif(valid !== true){\n\t\t\tsetTimeout(() => {\n\t\t\t\tcell.getElement().classList.add(\"tabulator-validation-fail\");\n\t\t\t\tthis.dispatchExternal(\"validationFailed\", cell.getComponent(), value, valid);\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn valid;\n\t}\n\t\n\teditorClear(cell, cancelled){\n\t\tif(cancelled){\n\t\t\tif(cell.column.modules.validate){\n\t\t\t\tthis.cellValidate(cell);\n\t\t\t}\n\t\t}\n\n\t\tcell.getElement().classList.remove(\"tabulator-validation-fail\");\n\t}\n\t\n\teditedClear(cell){\n\t\tif(cell.modules.validate){\n\t\t\tcell.modules.validate.invalid = false;\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t////////// Cell Functions /////////\n\t///////////////////////////////////\n\t\n\tcellIsValid(cell){\n\t\treturn cell.modules.validate ? (cell.modules.validate.invalid || true) : true;\n\t}\n\t\n\tcellValidate(cell){\n\t\treturn this.validate(cell.column.modules.validate, cell, cell.getValue());\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Column Functions ////////\n\t///////////////////////////////////\n\t\n\tcolumnValidate(column){\n\t\tvar invalid = [];\n\t\t\n\t\tcolumn.cells.forEach((cell) => {\n\t\t\tif(this.cellValidate(cell) !== true){\n\t\t\t\tinvalid.push(cell.getComponent());\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn invalid.length ? invalid : true;\n\t}\n\t\n\t///////////////////////////////////\n\t////////// Row Functions //////////\n\t///////////////////////////////////\n\t\n\trowValidate(row){\n\t\tvar invalid = [];\n\t\t\n\t\trow.cells.forEach((cell) => {\n\t\t\tif(this.cellValidate(cell) !== true){\n\t\t\t\tinvalid.push(cell.getComponent());\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn invalid.length ? invalid : true;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\t\n\t\n\tuserClearCellValidation(cells){\n\t\tif(!cells){\n\t\t\tcells = this.getInvalidCells();\n\t\t}\n\t\t\n\t\tif(!Array.isArray(cells)){\n\t\t\tcells = [cells];\n\t\t}\n\t\t\n\t\tcells.forEach((cell) => {\n\t\t\tthis.clearValidation(cell._getSelf());\n\t\t});\n\t}\n\t\n\tuserValidate(cells){\n\t\tvar output = [];\n\t\t\n\t\t//clear row data\n\t\tthis.table.rowManager.rows.forEach((row) => {\n\t\t\trow = row.getComponent();\n\t\t\t\n\t\t\tvar valid = row.validate();\n\t\t\t\n\t\t\tif(valid !== true){\n\t\t\t\toutput = output.concat(valid);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn output.length ? output : true;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tinitializeColumnCheck(column){\n\t\tif(typeof column.definition.validator !== \"undefined\"){\n\t\t\tthis.initializeColumn(column);\n\t\t}\n\t}\n\t\n\t//validate\n\tinitializeColumn(column){\n\t\tvar self = this,\n\t\tconfig = [],\n\t\tvalidator;\n\t\t\n\t\tif(column.definition.validator){\n\t\t\t\n\t\t\tif(Array.isArray(column.definition.validator)){\n\t\t\t\tcolumn.definition.validator.forEach((item) => {\n\t\t\t\t\tvalidator = self._extractValidator(item);\n\t\t\t\t\t\n\t\t\t\t\tif(validator){\n\t\t\t\t\t\tconfig.push(validator);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tvalidator = this._extractValidator(column.definition.validator);\n\t\t\t\t\n\t\t\t\tif(validator){\n\t\t\t\t\tconfig.push(validator);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tcolumn.modules.validate = config.length ? config : false;\n\t\t}\n\t}\n\t\n\t_extractValidator(value){\n\t\tvar type, params, pos;\n\t\t\n\t\tswitch(typeof value){\n\t\t\tcase \"string\":\n\t\t\t\tpos = value.indexOf(':');\n\t\t\t\n\t\t\t\tif(pos > -1){\n\t\t\t\t\ttype = value.substring(0,pos);\n\t\t\t\t\tparams = value.substring(pos+1);\n\t\t\t\t}else {\n\t\t\t\t\ttype = value;\n\t\t\t\t}\n\t\t\t\n\t\t\t\treturn this._buildValidator(type, params);\n\t\t\t\n\t\t\tcase \"function\":\n\t\t\t\treturn this._buildValidator(value);\n\t\t\t\n\t\t\tcase \"object\":\n\t\t\t\treturn this._buildValidator(value.type, value.parameters);\n\t\t}\n\t}\n\t\n\t_buildValidator(type, params){\n\t\t\n\t\tvar func = typeof type == \"function\" ? type : Validate.validators[type];\n\t\t\n\t\tif(!func){\n\t\t\tconsole.warn(\"Validator Setup Error - No matching validator found:\", type);\n\t\t\treturn false;\n\t\t}else {\n\t\t\treturn {\n\t\t\t\ttype:typeof type == \"function\" ? \"function\" : type,\n\t\t\t\tfunc:func,\n\t\t\t\tparams:params,\n\t\t\t};\n\t\t}\n\t}\n\t\n\tvalidate(validators, cell, value){\n\t\tvar self = this,\n\t\tfailedValidators = [],\n\t\tinvalidIndex = this.invalidCells.indexOf(cell);\n\t\t\n\t\tif(validators){\n\t\t\tvalidators.forEach((item) => {\n\t\t\t\tif(!item.func.call(self, cell.getComponent(), value, item.params)){\n\t\t\t\t\tfailedValidators.push({\n\t\t\t\t\t\ttype:item.type,\n\t\t\t\t\t\tparameters:item.params\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(!cell.modules.validate){\n\t\t\tcell.modules.validate = {};\n\t\t}\n\t\t\n\t\tif(!failedValidators.length){\n\t\t\tcell.modules.validate.invalid = false;\n\t\t\tcell.getElement().classList.remove(\"tabulator-validation-fail\");\n\t\t\t\n\t\t\tif(invalidIndex > -1){\n\t\t\t\tthis.invalidCells.splice(invalidIndex, 1);\n\t\t\t}\n\t\t}else {\n\t\t\tcell.modules.validate.invalid = failedValidators;\n\t\t\t\n\t\t\tif(this.table.options.validationMode !== \"manual\"){\n\t\t\t\tcell.getElement().classList.add(\"tabulator-validation-fail\");\n\t\t\t}\n\t\t\t\n\t\t\tif(invalidIndex == -1){\n\t\t\t\tthis.invalidCells.push(cell);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn failedValidators.length ? failedValidators : true;\n\t}\n\t\n\tgetInvalidCells(){\n\t\tvar output = [];\n\t\t\n\t\tthis.invalidCells.forEach((cell) => {\n\t\t\toutput.push(cell.getComponent());\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tclearValidation(cell){\n\t\tvar invalidIndex;\n\t\t\n\t\tif(cell.modules.validate && cell.modules.validate.invalid){\n\t\t\t\n\t\t\tcell.getElement().classList.remove(\"tabulator-validation-fail\");\n\t\t\tcell.modules.validate.invalid = false;\n\t\t\t\n\t\t\tinvalidIndex = this.invalidCells.indexOf(cell);\n\t\t\t\n\t\t\tif(invalidIndex > -1){\n\t\t\t\tthis.invalidCells.splice(invalidIndex, 1);\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar allModules = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tAccessorModule: Accessor,\n\tAjaxModule: Ajax,\n\tClipboardModule: Clipboard,\n\tColumnCalcsModule: ColumnCalcs,\n\tDataTreeModule: DataTree,\n\tDownloadModule: Download,\n\tEditModule: Edit,\n\tExportModule: Export,\n\tFilterModule: Filter,\n\tFormatModule: Format,\n\tFrozenColumnsModule: FrozenColumns,\n\tFrozenRowsModule: FrozenRows,\n\tGroupRowsModule: GroupRows,\n\tHistoryModule: History,\n\tHtmlTableImportModule: HtmlTableImport,\n\tImportModule: Import,\n\tInteractionModule: Interaction,\n\tKeybindingsModule: Keybindings,\n\tMenuModule: Menu,\n\tMoveColumnsModule: MoveColumns,\n\tMoveRowsModule: MoveRows,\n\tMutatorModule: Mutator,\n\tPageModule: Page,\n\tPersistenceModule: Persistence,\n\tPopupModule: Popup,\n\tPrintModule: Print,\n\tReactiveDataModule: ReactiveData,\n\tResizeColumnsModule: ResizeColumns,\n\tResizeRowsModule: ResizeRows,\n\tResizeTableModule: ResizeTable,\n\tResponsiveLayoutModule: ResponsiveLayout,\n\tSelectRangeModule: SelectRange,\n\tSelectRowModule: SelectRow,\n\tSortModule: Sort,\n\tSpreadsheetModule: Spreadsheet,\n\tTooltipModule: Tooltip,\n\tValidateModule: Validate\n});\n\nvar defaultOptions = {\n\n\tdebugEventsExternal:false, //flag to console log events\n\tdebugEventsInternal:false, //flag to console log events\n\tdebugInvalidOptions:true, //allow toggling of invalid option warnings\n\tdebugInvalidComponentFuncs:true, //allow toggling of invalid component warnings\n\tdebugInitialization:true, //allow toggling of pre initialization function call warnings\n\tdebugDeprecation:true, //allow toggling of deprecation warnings\n\n\theight:false, //height of tabulator\n\tminHeight:false, //minimum height of tabulator\n\tmaxHeight:false, //maximum height of tabulator\n\n\tcolumnHeaderVertAlign:\"top\", //vertical alignment of column headers\n\n\tpopupContainer:false,\n\n\tcolumns:[],//store for colum header info\n\tcolumnDefaults:{}, //store column default props\n\trowHeader:false,\n\n\tdata:false, //default starting data\n\n\tautoColumns:false, //build columns from data row structure\n\tautoColumnsDefinitions:false,\n\n\tnestedFieldSeparator:\".\", //separator for nested data\n\n\tfooterElement:false, //hold footer element\n\n\tindex:\"id\", //filed for row index\n\n\ttextDirection:\"auto\",\n\n\taddRowPos:\"bottom\", //position to insert blank rows, top|bottom\n\n\theaderVisible:true, //hide header\n\n\trenderVertical:\"virtual\",\n\trenderHorizontal:\"basic\",\n\trenderVerticalBuffer:0, // set virtual DOM buffer size\n\n\tscrollToRowPosition:\"top\",\n\tscrollToRowIfVisible:true,\n\n\tscrollToColumnPosition:\"left\",\n\tscrollToColumnIfVisible:true,\n\n\trowFormatter:false,\n\trowFormatterPrint:null,\n\trowFormatterClipboard:null,\n\trowFormatterHtmlOutput:null,\n\n\trowHeight:null,\n\n\tplaceholder:false,\n\n\tdataLoader:true,\n\tdataLoaderLoading:false,\n\tdataLoaderError:false,\n\tdataLoaderErrorTimeout:3000,\n\tdataSendParams:{},\n\tdataReceiveParams:{},\n\n\tdependencies:{},\n};\n\nclass OptionsList {\n\tconstructor(table, msgType, defaults = {}){\n\t\tthis.table = table;\n\t\tthis.msgType = msgType;\n\t\tthis.registeredDefaults = Object.assign({}, defaults);\n\t}\n\t\n\tregister(option, value){\n\t\tthis.registeredDefaults[option] = value;\n\t}\n\t\n\tgenerate(defaultOptions, userOptions = {}){\n\t\tvar output = Object.assign({}, this.registeredDefaults),\n\t\twarn = this.table.options.debugInvalidOptions || userOptions.debugInvalidOptions === true;\n\t\t\n\t\tObject.assign(output, defaultOptions);\n\t\t\n\t\tfor (let key in userOptions){\n\t\t\tif(!output.hasOwnProperty(key)){\n\t\t\t\tif(warn){\n\t\t\t\t\tconsole.warn(\"Invalid \" + this.msgType + \" option:\", key);\n\t\t\t\t}\n\n\t\t\t\toutput[key] = userOptions.key;\n\t\t\t}\n\t\t}\n\t\n\t\t\n\t\tfor (let key in output){\n\t\t\tif(key in userOptions){\n\t\t\t\toutput[key] = userOptions[key];\n\t\t\t}else {\n\t\t\t\tif(Array.isArray(output[key])){\n\t\t\t\t\toutput[key] = Object.assign([], output[key]);\n\t\t\t\t}else if(typeof output[key] === \"object\" && output[key] !== null){\n\t\t\t\t\toutput[key] = Object.assign({}, output[key]);\n\t\t\t\t}else if (typeof output[key] === \"undefined\"){\n\t\t\t\t\tdelete output[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n}\n\nclass Renderer extends CoreFeature{\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.elementVertical = table.rowManager.element;\n\t\tthis.elementHorizontal = table.columnManager.element;\n\t\tthis.tableElement =  table.rowManager.tableElement;\n\n\t\tthis.verticalFillMode = \"fit\"; // used by row manager to determine how to size the render area (\"fit\" - fits container to the contents, \"fill\" - fills the container without resizing it)\n\t}\n\n\n\t///////////////////////////////////\n\t/////// Internal Bindings /////////\n\t///////////////////////////////////\n\n\tinitialize(){\n\t\t//initialize core functionality\n\t}\n\n\tclearRows(){\n\t\t//clear down existing rows layout\n\t}\n\n\tclearColumns(){\n\t\t//clear down existing columns layout\n\t}\n\n\n\treinitializeColumnWidths(columns){\n\t\t//resize columns to fit data\n\t}\n\n\n\trenderRows(){\n\t\t//render rows from a clean slate\n\t}\n\n\trenderColumns(){\n\t\t//render columns from a clean slate\n\t}\n\n\trerenderRows(callback){\n\t\t// rerender rows and keep position\n\t\tif(callback){\n\t\t\tcallback();\n\t\t}\n\t}\n\n\trerenderColumns(update, blockRedraw){\n\t\t//rerender columns\n\t}\n\n\trenderRowCells(row){\n\t\t//render the cells in a row\n\t}\n\n\trerenderRowCells(row, force){\n\t\t//rerender the cells in a row\n\t}\n\n\tscrollColumns(left, dir){\n\t\t//handle horizontal scrolling\n\t}\n\n\tscrollRows(top, dir){\n\t\t//handle vertical scrolling\n\t}\n\n\tresize(){\n\t\t//container has resized, carry out any needed recalculations (DO NOT RERENDER IN THIS FUNCTION)\n\t}\n\n\tscrollToRow(row){\n\t\t//scroll to a specific row\n\t}\n\n\tscrollToRowNearestTop(row){\n\t\t//determine weather the row is nearest the top or bottom of the table, return true for top or false for bottom\n\t}\n\n\tvisibleRows(includingBuffer){\n\t\t//return the visible rows\n\t\treturn [];\n\t}\n\n\t///////////////////////////////////\n\t//////// Helper Functions /////////\n\t///////////////////////////////////\n\n\trows(){\n\t\treturn this.table.rowManager.getDisplayRows();\n\t}\n\n\tstyleRow(row, index){\n\t\tvar rowEl = row.getElement();\n\n\t\tif(index % 2){\n\t\t\trowEl.classList.add(\"tabulator-row-even\");\n\t\t\trowEl.classList.remove(\"tabulator-row-odd\");\n\t\t}else {\n\t\t\trowEl.classList.add(\"tabulator-row-odd\");\n\t\t\trowEl.classList.remove(\"tabulator-row-even\");\n\t\t}\n\t}\n\n\t///////////////////////////////////\n\t/////// External Triggers /////////\n\t/////// (DO NOT OVERRIDE) /////////\n\t///////////////////////////////////\n\n\tclear(){\n\t\t//clear down existing layout\n\t\tthis.clearRows();\n\t\tthis.clearColumns();\n\t}\n\n\trender(){\n\t\t//render from a clean slate\n\t\tthis.renderRows();\n\t\tthis.renderColumns();\n\t}\n\n\trerender(callback){\n\t\t// rerender and keep position\n\t\tthis.rerenderRows();\n\t\tthis.rerenderColumns();\n\t}\n\n\tscrollToRowPosition(row, position, ifVisible){\n\t\tvar rowIndex = this.rows().indexOf(row),\n\t\trowEl = row.getElement(),\n\t\toffset = 0;\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(rowIndex > -1){\n\n\t\t\t\tif(typeof ifVisible === \"undefined\"){\n\t\t\t\t\tifVisible = this.table.options.scrollToRowIfVisible;\n\t\t\t\t}\n\n\t\t\t\t//check row visibility\n\t\t\t\tif(!ifVisible){\n\t\t\t\t\tif(Helpers.elVisible(rowEl)){\n\t\t\t\t\t\toffset = Helpers.elOffset(rowEl).top - Helpers.elOffset(this.elementVertical).top;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(offset > 0 && offset < this.elementVertical.clientHeight - rowEl.offsetHeight){\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(typeof position === \"undefined\"){\n\t\t\t\t\tposition = this.table.options.scrollToRowPosition;\n\t\t\t\t}\n\n\t\t\t\tif(position === \"nearest\"){\n\t\t\t\t\tposition = this.scrollToRowNearestTop(row) ? \"top\" : \"bottom\";\n\t\t\t\t}\n\n\t\t\t\t//scroll to row\n\t\t\t\tthis.scrollToRow(row);\n\n\t\t\t\t//align to correct position\n\t\t\t\tswitch(position){\n\t\t\t\t\tcase \"middle\":\n\t\t\t\t\tcase \"center\":\n\n\t\t\t\t\t\tif(this.elementVertical.scrollHeight - this.elementVertical.scrollTop == this.elementVertical.clientHeight){\n\t\t\t\t\t\t\tthis.elementVertical.scrollTop = this.elementVertical.scrollTop + (rowEl.offsetTop - this.elementVertical.scrollTop) - ((this.elementVertical.scrollHeight - rowEl.offsetTop) / 2);\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tthis.elementVertical.scrollTop = this.elementVertical.scrollTop - (this.elementVertical.clientHeight / 2);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"bottom\":\n\n\t\t\t\t\t\tif(this.elementVertical.scrollHeight - this.elementVertical.scrollTop == this.elementVertical.clientHeight){\n\t\t\t\t\t\t\tthis.elementVertical.scrollTop = this.elementVertical.scrollTop - (this.elementVertical.scrollHeight - rowEl.offsetTop) + rowEl.offsetHeight;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tthis.elementVertical.scrollTop = this.elementVertical.scrollTop - this.elementVertical.clientHeight + rowEl.offsetHeight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"top\":\n\t\t\t\t\t\tthis.elementVertical.scrollTop = rowEl.offsetTop;\t\t\t\t\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tresolve();\n\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Scroll Error - Row not visible\");\n\t\t\t\treject(\"Scroll Error - Row not visible\");\n\t\t\t}\n\t\t});\n\t}\n}\n\nclass BasicHorizontal extends Renderer{\n\tconstructor(table){\n\t\tsuper(table);\n\t}\n\t\n\trenderRowCells(row, inFragment) {\n\t\tconst rowFrag = document.createDocumentFragment();\n\t\trow.cells.forEach((cell) => {\n\t\t\trowFrag.appendChild(cell.getElement());\n\t\t});\n\t\trow.element.appendChild(rowFrag);\n\t\t\n\t\tif(!inFragment){\n\t\t\trow.cells.forEach((cell) => {\n\t\t\t\tcell.cellRendered();\n\t\t\t});\n\t\t}\n\t}\n\t\n\treinitializeColumnWidths(columns){\n\t\tcolumns.forEach(function(column){\n\t\t\tcolumn.reinitializeWidth();\n\t\t});\n\t}\n}\n\nclass VirtualDomHorizontal extends Renderer{\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.leftCol = 0;\n\t\tthis.rightCol = 0;\n\t\tthis.scrollLeft = 0;\n\t\t\n\t\tthis.vDomScrollPosLeft = 0;\n\t\tthis.vDomScrollPosRight = 0;\n\t\t\n\t\tthis.vDomPadLeft = 0;\n\t\tthis.vDomPadRight = 0;\n\t\t\n\t\tthis.fitDataColAvg = 0;\n\t\t\n\t\tthis.windowBuffer = 200; //pixel margin to make column visible before it is shown on screen\n\t\t\n\t\tthis.visibleRows = null;\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.isFitData = false;\n\t\t\n\t\tthis.columns = [];\n\t}\n\t\n\tinitialize(){\n\t\tthis.compatibilityCheck();\n\t\tthis.layoutCheck();\n\t\tthis.vertScrollListen();\n\t}\n\t\n\tcompatibilityCheck(){\t\t\n\t\tif(this.options(\"layout\") == \"fitDataTable\"){\n\t\t\tconsole.warn(\"Horizontal Virtual DOM is not compatible with fitDataTable layout mode\");\n\t\t}\n\t\t\n\t\tif(this.options(\"responsiveLayout\")){\n\t\t\tconsole.warn(\"Horizontal Virtual DOM is not compatible with responsive columns\");\n\t\t}\n\t\t\n\t\tif(this.options(\"rtl\")){\n\t\t\tconsole.warn(\"Horizontal Virtual DOM is not currently compatible with RTL text direction\");\n\t\t}\n\t}\n\t\n\tlayoutCheck(){\n\t\tthis.isFitData = this.options(\"layout\").startsWith('fitData');\n\t}\n\t\n\tvertScrollListen(){\n\t\tthis.subscribe(\"scroll-vertical\", this.clearVisRowCache.bind(this));\n\t\tthis.subscribe(\"data-refreshed\", this.clearVisRowCache.bind(this));\n\t}\n\t\n\tclearVisRowCache(){\n\t\tthis.visibleRows = null;\n\t}\n\t\n\t//////////////////////////////////////\n\t///////// Public Functions ///////////\n\t//////////////////////////////////////\n\t\n\trenderColumns(row, force){\n\t\tthis.dataChange();\n\t}\n\t\n\t\n\tscrollColumns(left, dir){\n\t\tif(this.scrollLeft != left){\n\t\t\tthis.scrollLeft = left;\n\t\t\t\n\t\t\tthis.scroll(left - (this.vDomScrollPosLeft + this.windowBuffer));\n\t\t}\n\t}\n\t\n\tcalcWindowBuffer(){\n\t\tvar buffer = this.elementVertical.clientWidth;\n\t\t\n\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\tif(column.visible){\n\t\t\t\tvar width = column.getWidth();\n\t\t\t\t\n\t\t\t\tif(width > buffer){\n\t\t\t\t\tbuffer = width;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.windowBuffer = buffer * 2;\n\t}\n\t\n\trerenderColumns(update, blockRedraw){\t\t\n\t\tvar old = {\n\t\t\tcols:this.columns,\n\t\t\tleftCol:this.leftCol,\n\t\t\trightCol:this.rightCol,\n\t\t},\n\t\tcolPos = 0;\n\t\t\n\t\tif(update && !this.initialized){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.clear();\n\t\t\n\t\tthis.calcWindowBuffer();\n\t\t\n\t\tthis.scrollLeft = this.elementVertical.scrollLeft;\n\t\t\n\t\tthis.vDomScrollPosLeft = this.scrollLeft - this.windowBuffer;\n\t\tthis.vDomScrollPosRight = this.scrollLeft + this.elementVertical.clientWidth + this.windowBuffer;\n\t\t\n\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\tvar config = {},\n\t\t\twidth;\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\tif(!column.modules.frozen){\t\t\t\n\t\t\t\t\twidth = column.getWidth();\n\t\t\t\t\t\n\t\t\t\t\tconfig.leftPos = colPos;\n\t\t\t\t\tconfig.rightPos = colPos + width;\n\t\t\t\t\t\n\t\t\t\t\tconfig.width = width;\n\t\t\t\t\t\n\t\t\t\t\tif (this.isFitData) {\n\t\t\t\t\t\tconfig.fitDataCheck = column.modules.vdomHoz ? column.modules.vdomHoz.fitDataCheck : true;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif((colPos + width > this.vDomScrollPosLeft) && (colPos < this.vDomScrollPosRight)){\n\t\t\t\t\t\t//column is visible\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.leftCol == -1){\n\t\t\t\t\t\t\tthis.leftCol = this.columns.length;\n\t\t\t\t\t\t\tthis.vDomPadLeft = colPos;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.rightCol = this.columns.length;\n\t\t\t\t\t}else {\n\t\t\t\t\t\t// column is hidden\n\t\t\t\t\t\tif(this.leftCol !== -1){\n\t\t\t\t\t\t\tthis.vDomPadRight += width;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.columns.push(column);\n\t\t\t\t\t\n\t\t\t\t\tcolumn.modules.vdomHoz = config;\n\t\t\t\t\t\n\t\t\t\t\tcolPos += width;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.tableElement.style.paddingLeft = this.vDomPadLeft + \"px\";\n\t\tthis.tableElement.style.paddingRight = this.vDomPadRight + \"px\";\n\t\t\n\t\tthis.initialized = true;\n\t\t\n\t\tif(!blockRedraw){\n\t\t\tif(!update || this.reinitChanged(old)){\n\t\t\t\tthis.reinitializeRows();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.elementVertical.scrollLeft = this.scrollLeft;\n\t}\n\t\n\trenderRowCells(row){\n\t\tif(this.initialized){\n\t\t\tthis.initializeRow(row);\n\t\t}else {\n\t\t\tconst rowFrag = document.createDocumentFragment();\n\t\t\trow.cells.forEach((cell) => {\n\t\t\t\trowFrag.appendChild(cell.getElement());\n\t\t\t});\n\t\t\trow.element.appendChild(rowFrag);\n\t\t\t\n\t\t\trow.cells.forEach((cell) => {\n\t\t\t\tcell.cellRendered();\n\t\t\t});\n\t\t}\n\t}\n\t\n\trerenderRowCells(row, force){\n\t\tthis.reinitializeRow(row, force);\n\t}\n\t\n\treinitializeColumnWidths(columns){\n\t\tfor(let i = this.leftCol; i <= this.rightCol; i++){\n\t\t\tlet col = this.columns[i];\n\t\t\t\n\t\t\tif(col){\n\t\t\t\tcol.reinitializeWidth();\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//////////////////////////////////////\n\t//////// Internal Rendering //////////\n\t//////////////////////////////////////\n\t\n\tdeinitialize(){\n\t\tthis.initialized = false;\n\t}\n\t\n\tclear(){\n\t\tthis.columns = [];\n\t\t\n\t\tthis.leftCol = -1;\n\t\tthis.rightCol = 0;\n\t\t\n\t\tthis.vDomScrollPosLeft = 0;\n\t\tthis.vDomScrollPosRight = 0;\n\t\tthis.vDomPadLeft = 0;\n\t\tthis.vDomPadRight = 0;\n\t}\n\t\n\tdataChange(){\n\t\tvar change = false,\n\t\trow, rowEl;\n\t\t\n\t\tif(this.isFitData){\n\t\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\t\tif(!column.definition.width && column.visible){\n\t\t\t\t\tchange = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(change && this.table.rowManager.getDisplayRows().length){\n\t\t\t\tthis.vDomScrollPosRight = this.scrollLeft + this.elementVertical.clientWidth + this.windowBuffer;\n\t\t\t\t\n\t\t\t\trow = this.chain(\"rows-sample\", [1], [], () => {\n\t\t\t\t\treturn this.table.rowManager.getDisplayRows();\n\t\t\t\t})[0];\n\t\t\t\t\n\t\t\t\tif(row){\n\t\t\t\t\trowEl = row.getElement();\n\t\t\t\t\t\n\t\t\t\t\trow.generateCells();\n\t\t\t\t\t\n\t\t\t\t\tthis.tableElement.appendChild(rowEl);\n\t\t\t\t\t\n\t\t\t\t\tfor(let colEnd = 0; colEnd < row.cells.length; colEnd++){\n\t\t\t\t\t\tlet cell = row.cells[colEnd];\n\t\t\t\t\t\trowEl.appendChild(cell.getElement());\n\t\t\t\t\t\t\n\t\t\t\t\t\tcell.column.reinitializeWidth();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t\t\t\n\t\t\t\t\tthis.rerenderColumns(false, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tif(this.options(\"layout\") === \"fitColumns\"){\n\t\t\t\tthis.layoutRefresh();\n\t\t\t\tthis.rerenderColumns(false, true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\treinitChanged(old){\n\t\tvar match = true;\n\t\t\n\t\tif(old.cols.length !== this.columns.length || old.leftCol !== this.leftCol || old.rightCol !== this.rightCol){\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\told.cols.forEach((col, i) => {\n\t\t\tif(col !== this.columns[i]){\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn !match;\n\t}\n\t\n\treinitializeRows(){\n\t\tvar visibleRows = this.getVisibleRows(),\n\t\totherRows = this.table.rowManager.getRows().filter(row => !visibleRows.includes(row));\n\t\t\n\t\tvisibleRows.forEach((row) => {\n\t\t\tthis.reinitializeRow(row, true);\n\t\t});\n\t\t\n\t\totherRows.forEach((row) =>{\n\t\t\trow.deinitialize();\n\t\t});\n\t}\n\t\n\tgetVisibleRows(){\n\t\tif (!this.visibleRows){\n\t\t\tthis.visibleRows = this.table.rowManager.getVisibleRows();\n\t\t}\n\t\t\n\t\treturn this.visibleRows;\t\n\t}\n\t\n\tscroll(diff){\n\t\tthis.vDomScrollPosLeft += diff;\n\t\tthis.vDomScrollPosRight += diff;\n\t\t\n\t\tif(Math.abs(diff) > (this.windowBuffer / 2)){\n\t\t\tthis.rerenderColumns();\n\t\t}else {\n\t\t\tif(diff > 0){\n\t\t\t\t//scroll right\n\t\t\t\tthis.addColRight();\n\t\t\t\tthis.removeColLeft();\n\t\t\t}else {\n\t\t\t\t//scroll left\n\t\t\t\tthis.addColLeft();\n\t\t\t\tthis.removeColRight();\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcolPositionAdjust (start, end, diff){\n\t\tfor(let i = start; i < end; i++){\n\t\t\tlet column = this.columns[i];\n\t\t\t\n\t\t\tcolumn.modules.vdomHoz.leftPos += diff;\n\t\t\tcolumn.modules.vdomHoz.rightPos += diff;\n\t\t}\n\t}\n\t\n\taddColRight(){\n\t\tvar changes = false,\n\t\tworking = true;\n\t\t\n\t\twhile(working){\n\t\t\t\n\t\t\tlet column = this.columns[this.rightCol + 1];\n\t\t\t\n\t\t\tif(column){\n\t\t\t\tif(column.modules.vdomHoz.leftPos <= this.vDomScrollPosRight){\n\t\t\t\t\tchanges = true;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\t\t\t\trow.getElement().insertBefore(cell.getElement(), row.getCell(this.columns[this.rightCol]).getElement().nextSibling);\n\t\t\t\t\t\t\tcell.cellRendered();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.fitDataColActualWidthCheck(column);\n\t\t\t\t\t\n\t\t\t\t\tthis.rightCol++; // Don't move this below the >= check below\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\trow.modules.vdomHoz.rightCol = this.rightCol;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif(this.rightCol >= (this.columns.length - 1)){\n\t\t\t\t\t\tthis.vDomPadRight = 0;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.vDomPadRight -= column.getWidth();\n\t\t\t\t\t}\t\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(changes){\n\t\t\tthis.tableElement.style.paddingRight = this.vDomPadRight + \"px\";\n\t\t}\n\t}\n\t\n\taddColLeft(){\n\t\tvar changes = false,\n\t\tworking = true;\n\t\t\n\t\twhile(working){\n\t\t\tlet column = this.columns[this.leftCol - 1];\n\t\t\t\n\t\t\tif(column){\n\t\t\t\tif(column.modules.vdomHoz.rightPos >= this.vDomScrollPosLeft){\n\t\t\t\t\tchanges = true;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\t\t\t\trow.getElement().insertBefore(cell.getElement(), row.getCell(this.columns[this.leftCol]).getElement());\n\t\t\t\t\t\t\tcell.cellRendered();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.leftCol--; // don't move this below the <= check below\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\trow.modules.vdomHoz.leftCol = this.leftCol;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif(this.leftCol <= 0){ // replicating logic in addColRight\n\t\t\t\t\t\tthis.vDomPadLeft = 0;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.vDomPadLeft -= column.getWidth();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlet diff = this.fitDataColActualWidthCheck(column);\n\t\t\t\t\t\n\t\t\t\t\tif(diff){\n\t\t\t\t\t\tthis.scrollLeft = this.elementVertical.scrollLeft = this.elementVertical.scrollLeft + diff;\n\t\t\t\t\t\tthis.vDomPadRight -= diff;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(changes){\n\t\t\tthis.tableElement.style.paddingLeft = this.vDomPadLeft + \"px\";\n\t\t}\n\t}\n\t\n\tremoveColRight(){\n\t\tvar changes = false,\n\t\tworking = true;\n\t\t\n\t\twhile(working){\n\t\t\tlet column = this.columns[this.rightCol];\n\t\t\t\n\t\t\tif(column){\n\t\t\t\tif(column.modules.vdomHoz.leftPos > this.vDomScrollPosRight){\n\t\t\t\t\tchanges = true;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\trow.getElement().removeChild(cell.getElement());\n\t\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\t\tconsole.warn(\"Could not removeColRight\", ex.message);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.vDomPadRight += column.getWidth();\n\t\t\t\t\tthis.rightCol --;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\trow.modules.vdomHoz.rightCol = this.rightCol;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(changes){\n\t\t\tthis.tableElement.style.paddingRight = this.vDomPadRight + \"px\";\n\t\t}\n\t}\n\t\n\tremoveColLeft(){\n\t\tvar changes = false,\n\t\tworking = true;\n\t\t\n\t\twhile(working){\n\t\t\tlet column = this.columns[this.leftCol];\n\t\t\t\n\t\t\tif(column){\n\t\t\t\tif(column.modules.vdomHoz.rightPos < this.vDomScrollPosLeft){\n\t\t\t\t\tchanges = true;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\t\t\t\t\t\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\trow.getElement().removeChild(cell.getElement());\n\t\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\t\tconsole.warn(\"Could not removeColLeft\", ex.message);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.vDomPadLeft += column.getWidth();\n\t\t\t\t\tthis.leftCol ++;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\trow.modules.vdomHoz.leftCol = this.leftCol;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(changes){\n\t\t\tthis.tableElement.style.paddingLeft = this.vDomPadLeft + \"px\";\n\t\t}\n\t}\n\t\n\tfitDataColActualWidthCheck(column){\n\t\tvar newWidth, widthDiff;\n\t\t\n\t\tif(column.modules.vdomHoz.fitDataCheck){\n\t\t\tcolumn.reinitializeWidth();\n\t\t\t\n\t\t\tnewWidth = column.getWidth();\n\t\t\twidthDiff = newWidth - column.modules.vdomHoz.width;\n\t\t\t\n\t\t\tif(widthDiff){\n\t\t\t\tcolumn.modules.vdomHoz.rightPos += widthDiff;\n\t\t\t\tcolumn.modules.vdomHoz.width = newWidth;\n\t\t\t\tthis.colPositionAdjust(this.columns.indexOf(column) + 1, this.columns.length, widthDiff);\n\t\t\t}\n\t\t\t\n\t\t\tcolumn.modules.vdomHoz.fitDataCheck = false;\n\t\t}\n\t\t\n\t\treturn widthDiff;\n\t}\n\t\n\tinitializeRow(row){\n\t\tif(row.type !== \"group\"){\n\t\t\trow.modules.vdomHoz = {\n\t\t\t\tleftCol:this.leftCol,\n\t\t\t\trightCol:this.rightCol,\n\t\t\t};\n\t\t\t\n\t\t\tif(this.table.modules.frozenColumns){\n\t\t\t\tthis.table.modules.frozenColumns.leftColumns.forEach((column) => {\n\t\t\t\t\tthis.appendCell(row, column);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tfor(let i = this.leftCol; i <= this.rightCol; i++){\n\t\t\t\tthis.appendCell(row, this.columns[i]);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.modules.frozenColumns){\n\t\t\t\tthis.table.modules.frozenColumns.rightColumns.forEach((column) => {\n\t\t\t\t\tthis.appendCell(row, column);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\t\n\tappendCell(row, column){\n\t\tif(column && column.visible){\n\t\t\tlet cell = row.getCell(column);\n\t\t\t\n\t\t\trow.getElement().appendChild(cell.getElement());\n\t\t\tcell.cellRendered();\n\t\t}\n\t}\n\t\n\treinitializeRow(row, force){\n\t\tif(row.type !== \"group\"){\n\t\t\tif(force || !row.modules.vdomHoz || row.modules.vdomHoz.leftCol !== this.leftCol || row.modules.vdomHoz.rightCol !== this.rightCol){\n\t\t\t\t\n\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\twhile(rowEl.firstChild) rowEl.removeChild(rowEl.firstChild);\n\t\t\t\t\n\t\t\t\tthis.initializeRow(row);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ColumnManager extends CoreFeature {\n\t\n\tconstructor (table){\n\t\tsuper(table);\n\t\t\n\t\tthis.blockHozScrollEvent = false;\n\t\tthis.headersElement = null;\n\t\tthis.contentsElement = null;\n\t\tthis.rowHeader = null;\n\t\tthis.element = null ; //containing element\n\t\tthis.columns = []; // column definition object\n\t\tthis.columnsByIndex = []; //columns by index\n\t\tthis.columnsByField = {}; //columns by field\n\t\tthis.scrollLeft = 0;\n\t\tthis.optionsList = new OptionsList(this.table, \"column definition\", defaultColumnOptions);\n\t\t\n\t\tthis.redrawBlock = false; //prevent redraws to allow multiple data manipulations before continuing\n\t\tthis.redrawBlockUpdate = null; //store latest redraw update only status\n\t\t\n\t\tthis.renderer = null;\n\t}\n\t\n\t////////////// Setup Functions /////////////////\n\t\n\tinitialize(){\n\t\tthis.initializeRenderer();\n\t\t\n\t\tthis.headersElement = this.createHeadersElement();\n\t\tthis.contentsElement = this.createHeaderContentsElement();\n\t\tthis.element = this.createHeaderElement();\n\t\t\n\t\tthis.contentsElement.insertBefore(this.headersElement, this.contentsElement.firstChild);\n\t\tthis.element.insertBefore(this.contentsElement, this.element.firstChild);\n\t\t\n\t\tthis.initializeScrollWheelWatcher();\n\t\t\n\t\tthis.subscribe(\"scroll-horizontal\", this.scrollHorizontal.bind(this));\n\t\tthis.subscribe(\"scrollbar-vertical\", this.padVerticalScrollbar.bind(this));\n\t}\n\t\n\tpadVerticalScrollbar(width){\n\t\tif(this.table.rtl){\n\t\t\tthis.headersElement.style.marginLeft = width + \"px\";\n\t\t}else {\n\t\t\tthis.headersElement.style.marginRight = width + \"px\";\n\t\t}\n\t}\n\t\n\tinitializeRenderer(){\n\t\tvar renderClass;\n\t\t\n\t\tvar renderers = {\n\t\t\t\"virtual\": VirtualDomHorizontal,\n\t\t\t\"basic\": BasicHorizontal,\n\t\t};\n\t\t\n\t\tif(typeof this.table.options.renderHorizontal === \"string\"){\n\t\t\trenderClass = renderers[this.table.options.renderHorizontal];\n\t\t}else {\n\t\t\trenderClass = this.table.options.renderHorizontal;\n\t\t}\n\t\t\n\t\tif(renderClass){\n\t\t\tthis.renderer = new renderClass(this.table, this.element, this.tableElement);\n\t\t\tthis.renderer.initialize();\n\t\t}else {\n\t\t\tconsole.error(\"Unable to find matching renderer:\", this.table.options.renderHorizontal);\n\t\t}\n\t}\n\t\n\t\n\tcreateHeadersElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-headers\");\n\t\tel.setAttribute(\"role\", \"row\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tcreateHeaderContentsElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-header-contents\");\n\t\tel.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tcreateHeaderElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-header\");\n\t\tel.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\tif(!this.table.options.headerVisible){\n\t\t\tel.classList.add(\"tabulator-header-hidden\");\n\t\t}\n\t\t\n\t\treturn el;\n\t}\n\t\n\t//return containing element\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\t\n\t//return containing contents element\n\tgetContentsElement(){\n\t\treturn this.contentsElement;\n\t}\n\t\n\t\n\t//return header containing element\n\tgetHeadersElement(){\n\t\treturn this.headersElement;\n\t}\n\t\n\t//scroll horizontally to match table body\n\tscrollHorizontal(left){\n\t\tthis.contentsElement.scrollLeft = left;\n\t\t\n\t\tthis.scrollLeft = left;\n\t\t\n\t\tthis.renderer.scrollColumns(left);\n\t}\n\t\n\tinitializeScrollWheelWatcher(){\n\t\tthis.contentsElement.addEventListener(\"wheel\", (e) => {\n\t\t\tvar left;\n\t\t\t\n\t\t\tif(e.deltaX){\n\t\t\t\tleft = this.contentsElement.scrollLeft + e.deltaX;\n\t\t\t\t\n\t\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\t\t\t\tthis.table.columnManager.scrollHorizontal(left);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t///////////// Column Setup Functions /////////////\n\tgenerateColumnsFromRowData(data){\n\t\tvar cols = [],\n\t\tcollProgress = {},\n\t\trowSample = this.table.options.autoColumns === \"full\" ? data : [data[0]],\n\t\tdefinitions = this.table.options.autoColumnsDefinitions;\n\t\t\n\t\tif(data && data.length){\n\t\t\t\n\t\t\trowSample.forEach((row) => {\n\t\t\t\t\n\t\t\t\tObject.keys(row).forEach((key, index) => {\n\t\t\t\t\tlet value = row[key],\n\t\t\t\t\tcol;\n\t\t\t\t\t\n\t\t\t\t\tif(!collProgress[key]){\n\t\t\t\t\t\tcol = {\n\t\t\t\t\t\t\tfield:key,\n\t\t\t\t\t\t\ttitle:key,\n\t\t\t\t\t\t\tsorter:this.calculateSorterFromValue(value),\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tcols.splice(index, 0, col);\n\t\t\t\t\t\tcollProgress[key] = typeof value === \"undefined\" ? col : true;\n\t\t\t\t\t}else if(collProgress[key] !== true){\n\t\t\t\t\t\tif(typeof value !== \"undefined\"){\n\t\t\t\t\t\t\tcollProgress[key].sorter = this.calculateSorterFromValue(value);\n\t\t\t\t\t\t\tcollProgress[key] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\t\n\t\t\tif(definitions){\n\t\t\t\t\n\t\t\t\tswitch(typeof definitions){\n\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\tthis.table.options.columns = definitions.call(this.table, cols);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\tif(Array.isArray(definitions)){\n\t\t\t\t\t\t\tcols.forEach((col) => {\n\t\t\t\t\t\t\t\tvar match = definitions.find((def) => {\n\t\t\t\t\t\t\t\t\treturn def.field === col.field;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(match){\n\t\t\t\t\t\t\t\t\tObject.assign(col, match);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tcols.forEach((col) => {\n\t\t\t\t\t\t\t\tif(definitions[col.field]){\n\t\t\t\t\t\t\t\t\tObject.assign(col, definitions[col.field]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.table.options.columns = cols;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.table.options.columns = cols;\n\t\t\t}\n\t\t\t\n\t\t\tthis.setColumns(this.table.options.columns);\n\t\t}\n\t}\n\t\n\tcalculateSorterFromValue(value){\n\t\tvar sorter;\n\t\t\n\t\tswitch(typeof value){\n\t\t\tcase \"undefined\":\n\t\t\t\tsorter = \"string\";\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"boolean\":\n\t\t\t\tsorter = \"boolean\";\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"number\":\n\t\t\t\tsorter = \"number\";\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"object\":\n\t\t\t\tif(Array.isArray(value)){\n\t\t\t\t\tsorter = \"array\";\n\t\t\t\t}else {\n\t\t\t\t\tsorter = \"string\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tif(!isNaN(value) && value !== \"\"){\n\t\t\t\t\tsorter = \"number\";\n\t\t\t\t}else {\n\t\t\t\t\tif(value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)){\n\t\t\t\t\t\tsorter = \"alphanum\";\n\t\t\t\t\t}else {\n\t\t\t\t\t\tsorter = \"string\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\treturn sorter;\n\t}\n\t\n\tsetColumns(cols, row){\n\t\twhile(this.headersElement.firstChild) this.headersElement.removeChild(this.headersElement.firstChild);\n\t\t\n\t\tthis.columns = [];\n\t\tthis.columnsByIndex = [];\n\t\tthis.columnsByField = {};\n\t\t\n\t\tthis.dispatch(\"columns-loading\");\n\t\tthis.dispatchExternal(\"columnsLoading\");\n\t\t\n\t\tif(this.table.options.rowHeader){\n\t\t\tthis.rowHeader = new Column(this.table.options.rowHeader === true ? {} : this.table.options.rowHeader, this, true);\n\t\t\tthis.columns.push(this.rowHeader);\n\t\t\tthis.headersElement.appendChild(this.rowHeader.getElement());\n\t\t\tthis.rowHeader.columnRendered();\n\t\t}\n\t\t\n\t\tcols.forEach((def, i) => {\n\t\t\tthis._addColumn(def);\n\t\t});\n\t\t\n\t\tthis._reIndexColumns();\n\t\t\n\t\tthis.dispatch(\"columns-loaded\");\n\n\t\tif(this.subscribedExternal(\"columnsLoaded\")){\n\t\t\tthis.dispatchExternal(\"columnsLoaded\", this.getComponents());\n\t\t}\n\t\t\n\t\tthis.rerenderColumns(false, true);\n\t\t\n\t\tthis.redraw(true);\n\t}\n\t\n\t_addColumn(definition, before, nextToColumn){\n\t\tvar column = new Column(definition, this),\n\t\tcolEl = column.getElement(),\n\t\tindex = nextToColumn ? this.findColumnIndex(nextToColumn) : nextToColumn;\n\t\t\n\t\t//prevent adding of rows in front of row header\n\t\tif(before && this.rowHeader && (!nextToColumn || nextToColumn === this.rowHeader)){\n\t\t\tbefore = false;\n\t\t\tnextToColumn = this.rowHeader;\n\t\t\tindex = 0;\n\t\t}\n\t\t\n\t\tif(nextToColumn && index > -1){\n\t\t\tvar topColumn = nextToColumn.getTopColumn();\n\t\t\tvar parentIndex = this.columns.indexOf(topColumn);\n\t\t\tvar nextEl = topColumn.getElement();\n\t\t\t\n\t\t\tif(before){\n\t\t\t\tthis.columns.splice(parentIndex, 0, column);\n\t\t\t\tnextEl.parentNode.insertBefore(colEl, nextEl);\n\t\t\t}else {\n\t\t\t\tthis.columns.splice(parentIndex + 1, 0, column);\n\t\t\t\tnextEl.parentNode.insertBefore(colEl, nextEl.nextSibling);\n\t\t\t}\n\t\t}else {\n\t\t\tif(before){\n\t\t\t\tthis.columns.unshift(column);\n\t\t\t\tthis.headersElement.insertBefore(column.getElement(), this.headersElement.firstChild);\n\t\t\t}else {\n\t\t\t\tthis.columns.push(column);\n\t\t\t\tthis.headersElement.appendChild(column.getElement());\n\t\t\t}\n\t\t}\n\t\t\n\t\tcolumn.columnRendered();\n\t\t\n\t\treturn column;\n\t}\n\t\n\tregisterColumnField(col){\n\t\tif(col.definition.field){\n\t\t\tthis.columnsByField[col.definition.field] = col;\n\t\t}\n\t}\n\t\n\tregisterColumnPosition(col){\n\t\tthis.columnsByIndex.push(col);\n\t}\n\t\n\t_reIndexColumns(){\n\t\tthis.columnsByIndex = [];\n\t\t\n\t\tthis.columns.forEach(function(column){\n\t\t\tcolumn.reRegisterPosition();\n\t\t});\n\t}\n\t\n\t//ensure column headers take up the correct amount of space in column groups\n\tverticalAlignHeaders(){\n\t\tvar minHeight = 0;\n\t\t\n\t\tif(!this.redrawBlock){\n\t\t\t\n\t\t\tthis.headersElement.style.height=\"\";\n\t\t\t\n\t\t\tthis.columns.forEach((column) => {\n\t\t\t\tcolumn.clearVerticalAlign();\n\t\t\t});\n\t\t\t\n\t\t\tthis.columns.forEach((column) => {\n\t\t\t\tvar height = column.getHeight();\n\t\t\t\t\n\t\t\t\tif(height > minHeight){\n\t\t\t\t\tminHeight = height;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.headersElement.style.height = minHeight + \"px\";\n\t\t\t\n\t\t\tthis.columns.forEach((column) => {\n\t\t\t\tcolumn.verticalAlign(this.table.options.columnHeaderVertAlign, minHeight);\n\t\t\t});\n\t\t\t\n\t\t\tthis.table.rowManager.adjustTableSize();\n\t\t}\n\t}\n\t\n\t//////////////// Column Details /////////////////\n\tfindColumn(subject){\n\t\tvar columns;\n\t\t\n\t\tif(typeof subject == \"object\"){\n\t\t\t\n\t\t\tif(subject instanceof Column){\n\t\t\t\t//subject is column element\n\t\t\t\treturn subject;\n\t\t\t}else if(subject instanceof ColumnComponent){\n\t\t\t\t//subject is public column component\n\t\t\t\treturn subject._getSelf() || false;\n\t\t\t}else if(typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement){\n\t\t\t\t\n\t\t\t\tcolumns = [];\n\t\t\t\t\n\t\t\t\tthis.columns.forEach((column) => {\n\t\t\t\t\tcolumns.push(column);\n\t\t\t\t\tcolumns = columns.concat(column.getColumns(true));\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t//subject is a HTML element of the column header\n\t\t\t\tlet match = columns.find((column) => {\n\t\t\t\t\treturn column.element === subject;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn match || false;\n\t\t\t}\n\t\t\t\n\t\t}else {\n\t\t\t//subject should be treated as the field name of the column\n\t\t\treturn this.columnsByField[subject] || false;\n\t\t}\n\t\t\n\t\t//catch all for any other type of input\n\t\treturn false;\n\t}\n\t\n\tgetColumnByField(field){\n\t\treturn this.columnsByField[field];\n\t}\n\t\n\tgetColumnsByFieldRoot(root){\n\t\tvar matches = [];\n\t\t\n\t\tObject.keys(this.columnsByField).forEach((field) => {\n\t\t\tvar fieldRoot = this.table.options.nestedFieldSeparator ? field.split(this.table.options.nestedFieldSeparator)[0] : field;\n\t\t\tif(fieldRoot === root){\n\t\t\t\tmatches.push(this.columnsByField[field]);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn matches;\n\t}\n\t\n\tgetColumnByIndex(index){\n\t\treturn this.columnsByIndex[index];\n\t}\n\t\n\tgetFirstVisibleColumn(){\n\t\tvar index = this.columnsByIndex.findIndex((col) => {\n\t\t\treturn col.visible;\n\t\t});\n\t\t\n\t\treturn index > -1 ? this.columnsByIndex[index] : false;\n\t}\n\t\n\tgetVisibleColumnsByIndex() {\n\t\treturn this.columnsByIndex.filter((col) => col.visible);\n\t}\n\t\n\tgetColumns(){\n\t\treturn this.columns;\n\t}\n\t\n\tfindColumnIndex(column){\n\t\treturn this.columnsByIndex.findIndex((col) => {\n\t\t\treturn column === col;\n\t\t});\n\t}\n\t\n\t//return all columns that are not groups\n\tgetRealColumns(){\n\t\treturn this.columnsByIndex;\n\t}\n\t\n\t//traverse across columns and call action\n\ttraverse(callback){\n\t\tthis.columnsByIndex.forEach((column,i) =>{\n\t\t\tcallback(column, i);\n\t\t});\n\t}\n\t\n\t//get definitions of actual columns\n\tgetDefinitions(active){\n\t\tvar output = [];\n\t\t\n\t\tthis.columnsByIndex.forEach((column) => {\n\t\t\tif(!active || (active && column.visible)){\n\t\t\t\toutput.push(column.getDefinition());\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\t//get full nested definition tree\n\tgetDefinitionTree(){\n\t\tvar output = [];\n\t\t\n\t\tthis.columns.forEach((column) => {\n\t\t\toutput.push(column.getDefinition(true));\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetComponents(structured){\n\t\tvar output = [],\n\t\tcolumns = structured ? this.columns : this.columnsByIndex;\n\t\t\n\t\tcolumns.forEach((column) => {\n\t\t\toutput.push(column.getComponent());\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetWidth(){\n\t\tvar width = 0;\n\t\t\n\t\tthis.columnsByIndex.forEach((column) => {\n\t\t\tif(column.visible){\n\t\t\t\twidth += column.getWidth();\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn width;\n\t}\n\t\n\tmoveColumn(from, to, after){\n\t\tto.element.parentNode.insertBefore(from.element, to.element);\n\t\t\n\t\tif(after){\n\t\t\tto.element.parentNode.insertBefore(to.element, from.element);\n\t\t}\n\t\t\n\t\tthis.moveColumnActual(from, to, after);\n\t\t\n\t\tthis.verticalAlignHeaders();\n\t\t\n\t\tthis.table.rowManager.reinitialize();\n\t}\n\t\n\tmoveColumnActual(from, to, after){\n\t\tif(from.parent.isGroup){\n\t\t\tthis._moveColumnInArray(from.parent.columns, from, to, after);\n\t\t}else {\n\t\t\tthis._moveColumnInArray(this.columns, from, to, after);\n\t\t}\n\t\t\n\t\tthis._moveColumnInArray(this.columnsByIndex, from, to, after, true);\n\t\t\n\t\tthis.rerenderColumns(true);\n\t\t\n\t\tthis.dispatch(\"column-moved\", from, to, after);\n\t\t\n\t\tif(this.subscribedExternal(\"columnMoved\")){\n\t\t\tthis.dispatchExternal(\"columnMoved\", from.getComponent(), this.table.columnManager.getComponents());\n\t\t}\n\t}\n\t\n\t_moveColumnInArray(columns, from, to, after, updateRows){\n\t\tvar\tfromIndex = columns.indexOf(from),\n\t\ttoIndex, rows = [];\n\t\t\n\t\tif (fromIndex > -1) {\n\t\t\t\n\t\t\tcolumns.splice(fromIndex, 1);\n\t\t\t\n\t\t\ttoIndex = columns.indexOf(to);\n\t\t\t\n\t\t\tif (toIndex > -1) {\n\t\t\t\t\n\t\t\t\tif(after){\n\t\t\t\t\ttoIndex = toIndex+1;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\ttoIndex = fromIndex;\n\t\t\t}\n\t\t\t\n\t\t\tcolumns.splice(toIndex, 0, from);\n\t\t\t\n\t\t\tif(updateRows){\n\t\t\t\t\n\t\t\t\trows = this.chain(\"column-moving-rows\", [from, to, after], null, []) || [];\n\t\t\t\t\n\t\t\t\trows = rows.concat(this.table.rowManager.rows);\n\t\t\t\t\n\t\t\t\trows.forEach(function(row){\n\t\t\t\t\tif(row.cells.length){\n\t\t\t\t\t\tvar cell = row.cells.splice(fromIndex, 1)[0];\n\t\t\t\t\t\trow.cells.splice(toIndex, 0, cell);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\t\n\tscrollToColumn(column, position, ifVisible){\n\t\tvar left = 0,\n\t\toffset = column.getLeftOffset(),\n\t\tadjust = 0,\n\t\tcolEl = column.getElement();\n\t\t\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t\n\t\t\tif(typeof position === \"undefined\"){\n\t\t\t\tposition = this.table.options.scrollToColumnPosition;\n\t\t\t}\n\t\t\t\n\t\t\tif(typeof ifVisible === \"undefined\"){\n\t\t\t\tifVisible = this.table.options.scrollToColumnIfVisible;\n\t\t\t}\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\t\n\t\t\t\t//align to correct position\n\t\t\t\tswitch(position){\n\t\t\t\t\tcase \"middle\":\n\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\tadjust = -this.element.clientWidth / 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\tadjust = colEl.clientWidth - this.headersElement.clientWidth;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//check column visibility\n\t\t\t\tif(!ifVisible){\n\t\t\t\t\tif(offset > 0 && offset + colEl.offsetWidth < this.element.clientWidth){\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//calculate scroll position\n\t\t\t\tleft = offset + adjust;\n\t\t\t\t\n\t\t\t\tleft = Math.max(Math.min(left, this.table.rowManager.element.scrollWidth - this.table.rowManager.element.clientWidth),0);\n\t\t\t\t\n\t\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\t\t\t\tthis.scrollHorizontal(left);\n\t\t\t\t\n\t\t\t\tresolve();\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Scroll Error - Column not visible\");\n\t\t\t\treject(\"Scroll Error - Column not visible\");\n\t\t\t}\n\t\t\t\n\t\t});\n\t}\n\t\n\t//////////////// Cell Management /////////////////\n\tgenerateCells(row){\n\t\tvar cells = [];\n\t\t\n\t\tthis.columnsByIndex.forEach((column) => {\n\t\t\tcells.push(column.generateCell(row));\n\t\t});\n\t\t\n\t\treturn cells;\n\t}\n\t\n\t//////////////// Column Management /////////////////\n\tgetFlexBaseWidth(){\n\t\tvar totalWidth = this.table.element.clientWidth, //table element width\n\t\tfixedWidth = 0;\n\t\t\n\t\t//adjust for vertical scrollbar if present\n\t\tif(this.table.rowManager.element.scrollHeight > this.table.rowManager.element.clientHeight){\n\t\t\ttotalWidth -= this.table.rowManager.element.offsetWidth - this.table.rowManager.element.clientWidth;\n\t\t}\n\t\t\n\t\tthis.columnsByIndex.forEach(function(column){\n\t\t\tvar width, minWidth, colWidth;\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\t\n\t\t\t\twidth = column.definition.width || 0;\n\t\t\t\t\n\t\t\t\tminWidth = parseInt(column.minWidth);\n\t\t\t\t\n\t\t\t\tif(typeof(width) == \"string\"){\n\t\t\t\t\tif(width.indexOf(\"%\") > -1){\n\t\t\t\t\t\tcolWidth = (totalWidth / 100) * parseInt(width) ;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tcolWidth = parseInt(width);\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tcolWidth = width;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfixedWidth += colWidth > minWidth ? colWidth : minWidth;\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn fixedWidth;\n\t}\n\t\n\taddColumn(definition, before, nextToColumn){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar column = this._addColumn(definition, before, nextToColumn);\n\t\t\t\n\t\t\tthis._reIndexColumns();\n\t\t\t\n\t\t\tthis.dispatch(\"column-add\", definition, before, nextToColumn);\n\t\t\t\n\t\t\tif(this.layoutMode() != \"fitColumns\"){\n\t\t\t\tcolumn.reinitializeWidth();\n\t\t\t}\n\t\t\t\n\t\t\tthis.redraw(true);\n\t\t\t\n\t\t\tthis.table.rowManager.reinitialize();\n\t\t\t\n\t\t\tthis.rerenderColumns();\n\t\t\t\n\t\t\tresolve(column);\n\t\t});\n\t}\n\t\n\t//remove column from system\n\tderegisterColumn(column){\n\t\tvar field = column.getField(),\n\t\tindex;\n\t\t\n\t\t//remove from field list\n\t\tif(field){\n\t\t\tdelete this.columnsByField[field];\n\t\t}\n\t\t\n\t\t//remove from index list\n\t\tindex = this.columnsByIndex.indexOf(column);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.columnsByIndex.splice(index, 1);\n\t\t}\n\t\t\n\t\t//remove from column list\n\t\tindex = this.columns.indexOf(column);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.columns.splice(index, 1);\n\t\t}\n\t\t\n\t\tthis.verticalAlignHeaders();\n\t\t\n\t\tthis.redraw();\n\t}\n\t\n\trerenderColumns(update, silent){\n\t\tif(!this.redrawBlock){\n\t\t\tthis.renderer.rerenderColumns(update, silent);\n\t\t}else {\n\t\t\tif(update === false || (update === true && this.redrawBlockUpdate === null)){\n\t\t\t\tthis.redrawBlockUpdate = update;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tblockRedraw(){\n\t\tthis.redrawBlock = true;\n\t\tthis.redrawBlockUpdate = null;\n\t}\n\t\n\trestoreRedraw(){\n\t\tthis.redrawBlock = false;\n\t\tthis.verticalAlignHeaders();\n\t\tthis.renderer.rerenderColumns(this.redrawBlockUpdate);\n\t\t\n\t}\n\t\n\t//redraw columns\n\tredraw(force){\n\t\tif(Helpers.elVisible(this.element)){\n\t\t\tthis.verticalAlignHeaders();\n\t\t}\n\t\t\n\t\tif(force){\n\t\t\tthis.table.rowManager.resetScroll();\n\t\t\tthis.table.rowManager.reinitialize();\n\t\t}\n\t\t\n\t\tif(!this.confirm(\"table-redrawing\", force)){\n\t\t\tthis.layoutRefresh(force);\n\t\t}\n\t\t\n\t\tthis.dispatch(\"table-redraw\", force);\n\t\t\n\t\tthis.table.footerManager.redraw();\n\t}\n}\n\nclass BasicVertical extends Renderer{\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.verticalFillMode = \"fill\";\n\t\t\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\t\t\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\t}\n\t\n\tclearRows(){\n\t\tvar element = this.tableElement;\n\t\t\n\t\t// element.children.detach();\n\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\t\t\n\t\telement.scrollTop = 0;\n\t\telement.scrollLeft = 0;\n\t\t\n\t\telement.style.minWidth = \"\";\n\t\telement.style.minHeight = \"\";\n\t\telement.style.display = \"\";\n\t\telement.style.visibility = \"\";\n\t}\n\t\n\trenderRows() {\n\t\tvar element = this.tableElement,\n\t\tonlyGroupHeaders = true,\n\t\ttableFrag = document.createDocumentFragment(),\n\t\trows = this.rows();\n\t\t\n\t\trows.forEach((row, index) => {\n\t\t\tthis.styleRow(row, index);\n\t\t\trow.initialize(false, true);\n\t\t\t\n\t\t\tif (row.type !== \"group\") {\n\t\t\t\tonlyGroupHeaders = false;\n\t\t\t}\n\t\t\t\n\t\t\ttableFrag.appendChild(row.getElement());\n\t\t});\n\t\t\n\t\telement.appendChild(tableFrag);\n\t\t\n\t\trows.forEach((row) => {\n\t\t\trow.rendered();\n\t\t\t\n\t\t\tif(!row.heightInitialized) {\n\t\t\t\trow.calcHeight(true);\n\t\t\t}\n\t\t});\n\t\t\n\t\trows.forEach((row) => {\n\t\t\tif(!row.heightInitialized) {\n\t\t\t\trow.setCellHeight();\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(onlyGroupHeaders){\n\t\t\telement.style.minWidth = this.table.columnManager.getWidth() + \"px\";\n\t\t}else {\n\t\t\telement.style.minWidth = \"\";\n\t\t}\n\t}\n\t\n\t\n\trerenderRows(callback){\t\n\t\tthis.clearRows();\n\t\t\n\t\tif(callback){\n\t\t\tcallback();\n\t\t}\n\t\t\n\t\tthis.renderRows();\n\n\t\tif(!this.rows().length){\n\t\t\tthis.table.rowManager.tableEmpty();\n\t\t}\n\t}\n\t\n\tscrollToRowNearestTop(row){\n\t\tvar rowTop = Helpers.elOffset(row.getElement()).top;\n\t\t\n\t\treturn !(Math.abs(this.elementVertical.scrollTop - rowTop) > Math.abs(this.elementVertical.scrollTop + this.elementVertical.clientHeight - rowTop));\n\t}\n\t\n\tscrollToRow(row){\n\t\tvar rowEl = row.getElement();\n\t\t\n\t\tthis.elementVertical.scrollTop = Helpers.elOffset(rowEl).top - Helpers.elOffset(this.elementVertical).top + this.elementVertical.scrollTop;\n\t}\n\t\n\tvisibleRows(includingBuffer){\n\t\treturn this.rows();\n\t}\n\t\n}\n\nclass VirtualDomVertical extends Renderer{\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.verticalFillMode = \"fill\";\n\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\n\t\tthis.vDomRowHeight = 20; //approximation of row heights for padding\n\n\t\tthis.vDomTop = 0; //hold position for first rendered row in the virtual DOM\n\t\tthis.vDomBottom = 0; //hold position for last rendered row in the virtual DOM\n\n\t\tthis.vDomScrollPosTop = 0; //last scroll position of the vDom top;\n\t\tthis.vDomScrollPosBottom = 0; //last scroll position of the vDom bottom;\n\n\t\tthis.vDomTopPad = 0; //hold value of padding for top of virtual DOM\n\t\tthis.vDomBottomPad = 0; //hold value of padding for bottom of virtual DOM\n\n\t\tthis.vDomMaxRenderChain = 90; //the maximum number of dom elements that can be rendered in 1 go\n\n\t\tthis.vDomWindowBuffer = 0; //window row buffer before removing elements, to smooth scrolling\n\n\t\tthis.vDomWindowMinTotalRows = 20; //minimum number of rows to be generated in virtual dom (prevent buffering issues on tables with tall rows)\n\t\tthis.vDomWindowMinMarginRows = 5; //minimum number of rows to be generated in virtual dom margin\n\n\t\tthis.vDomTopNewRows = []; //rows to normalize after appending to optimize render speed\n\t\tthis.vDomBottomNewRows = []; //rows to normalize after appending to optimize render speed\n\t}\n\n\t//////////////////////////////////////\n\t///////// Public Functions ///////////\n\t//////////////////////////////////////\n\n\tclearRows(){\n\t\tvar element = this.tableElement;\n\n\t\t// element.children.detach();\n\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\n\t\telement.style.paddingTop = \"\";\n\t\telement.style.paddingBottom = \"\";\n\t\telement.style.minHeight = \"\";\n\t\telement.style.display = \"\";\n\t\telement.style.visibility = \"\";\n\n\t\tthis.elementVertical.scrollTop = 0;\n\t\tthis.elementVertical.scrollLeft = 0;\n\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\n\t\tthis.vDomTop = 0;\n\t\tthis.vDomBottom = 0;\n\t\tthis.vDomTopPad = 0;\n\t\tthis.vDomBottomPad = 0;\n\t\tthis.vDomScrollPosTop = 0;\n\t\tthis.vDomScrollPosBottom = 0;\n\t}\n\n\trenderRows(){\n\t\tthis._virtualRenderFill();\n\t}\n\n\trerenderRows(callback){\n\t\tvar scrollTop = this.elementVertical.scrollTop;\n\t\tvar topRow = false;\n\t\tvar topOffset = false;\n\n\t\tvar left = this.table.rowManager.scrollLeft;\n\n\t\tvar rows = this.rows();\n\n\t\tfor(var i = this.vDomTop; i <= this.vDomBottom; i++){\n\n\t\t\tif(rows[i]){\n\t\t\t\tvar diff = scrollTop - rows[i].getElement().offsetTop;\n\n\t\t\t\tif(topOffset === false || Math.abs(diff) < topOffset){\n\t\t\t\t\ttopOffset = diff;\n\t\t\t\t\ttopRow = i;\n\t\t\t\t}else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trows.forEach((row) => {\n\t\t\trow.deinitializeHeight();\n\t\t});\n\n\t\tif(callback){\n\t\t\tcallback();\n\t\t}\n\n\t\tif(this.rows().length){\n\t\t\tthis._virtualRenderFill((topRow === false ? this.rows.length - 1 : topRow), true, topOffset || 0);\n\t\t}else {\n\t\t\tthis.clear();\n\t\t\tthis.table.rowManager.tableEmpty();\n\t\t}\n\n\t\tthis.scrollColumns(left);\n\t}\n\n\tscrollColumns(left){\n\t\tthis.table.rowManager.scrollHorizontal(left);\n\t}\n\n\tscrollRows(top, dir){\n\t\tvar topDiff = top - this.vDomScrollPosTop;\n\t\tvar bottomDiff = top - this.vDomScrollPosBottom;\n\t\tvar margin = this.vDomWindowBuffer * 2;\n\t\tvar rows = this.rows();\n\n\t\tthis.scrollTop = top;\n\n\t\tif(-topDiff > margin || bottomDiff > margin){\n\t\t\t//if big scroll redraw table;\n\t\t\tvar left = this.table.rowManager.scrollLeft;\n\t\t\tthis._virtualRenderFill(Math.floor((this.elementVertical.scrollTop / this.elementVertical.scrollHeight) * rows.length));\n\t\t\tthis.scrollColumns(left);\n\t\t}else {\n\n\t\t\tif(dir){\n\t\t\t\t//scrolling up\n\t\t\t\tif(topDiff < 0){\n\t\t\t\t\tthis._addTopRow(rows, -topDiff);\n\t\t\t\t}\n\n\t\t\t\tif(bottomDiff < 0){\n\t\t\t\t\t//hide bottom row if needed\n\t\t\t\t\tif(this.vDomScrollHeight - this.scrollTop > this.vDomWindowBuffer){\n\t\t\t\t\t\tthis._removeBottomRow(rows, -bottomDiff);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.vDomScrollPosBottom = this.scrollTop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\n\t\t\t\tif(bottomDiff >= 0){\n\t\t\t\t\tthis._addBottomRow(rows, bottomDiff);\n\t\t\t\t}\n\n\t\t\t\t//scrolling down\n\t\t\t\tif(topDiff >= 0){\n\t\t\t\t\t//hide top row if needed\n\t\t\t\t\tif(this.scrollTop > this.vDomWindowBuffer){\n\t\t\t\t\t\tthis._removeTopRow(rows, topDiff);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.vDomScrollPosTop = this.scrollTop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresize(){\n\t\tthis.vDomWindowBuffer = this.table.options.renderVerticalBuffer || this.elementVertical.clientHeight;\n\t}\n\n\tscrollToRowNearestTop(row){\n\t\tvar rowIndex = this.rows().indexOf(row);\n\n\t\treturn !(Math.abs(this.vDomTop - rowIndex) > Math.abs(this.vDomBottom - rowIndex));\n\t}\n\n\tscrollToRow(row){\n\t\tvar index = this.rows().indexOf(row);\n\n\t\tif(index > -1){\n\t\t\tthis._virtualRenderFill(index, true);\n\t\t}\n\t}\n\n\tvisibleRows(includingBuffer){\n\t\tvar topEdge = this.elementVertical.scrollTop,\n\t\tbottomEdge = this.elementVertical.clientHeight + topEdge,\n\t\ttopFound = false,\n\t\ttopRow = 0,\n\t\tbottomRow = 0,\n\t\trows = this.rows();\n\n\t\tif(includingBuffer){\n\t\t\ttopRow = this.vDomTop;\n\t\t\tbottomRow = this.vDomBottom;\n\t\t}else {\n\t\t\tfor(var i = this.vDomTop; i <= this.vDomBottom; i++){\n\t\t\t\tif(rows[i]){\n\t\t\t\t\tif(!topFound){\n\t\t\t\t\t\tif((topEdge - rows[i].getElement().offsetTop) >= 0){\n\t\t\t\t\t\t\ttopRow = i;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\ttopFound = true;\n\n\t\t\t\t\t\t\tif(bottomEdge - rows[i].getElement().offsetTop >= 0){\n\t\t\t\t\t\t\t\tbottomRow = i;\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(bottomEdge - rows[i].getElement().offsetTop >= 0){\n\t\t\t\t\t\t\tbottomRow = i;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn rows.slice(topRow, bottomRow + 1);\n\t}\n\n\t//////////////////////////////////////\n\t//////// Internal Rendering //////////\n\t//////////////////////////////////////\n\n\t//full virtual render\n\t_virtualRenderFill(position, forceMove, offset) {\n\t\tvar\telement = this.tableElement,\n\t\tholder = this.elementVertical,\n\t\ttopPad = 0,\n\t\trowsHeight = 0,\n\t\trowHeight = 0,\n\t\theightOccupied = 0,\n\t\ttopPadHeight = 0,\n\t\ti = 0,\n\t\trows = this.rows(),\n\t\trowsCount = rows.length,\n\t\tindex = 0,\n\t\trow,\n\t\trowFragment,\n\t\trenderedRows = [],\n\t\ttotalRowsRendered = 0,\n\t\trowsToRender = 0,\n\t\tfixedHeight = this.table.rowManager.fixedHeight,\n\t\tcontainerHeight = this.elementVertical.clientHeight, \n\t\tavgRowHeight = this.table.options.rowHeight, \n\t\tresized = true;\n\n\t\tposition = position || 0;\n\n\t\toffset = offset || 0;\n\n\t\tif(!position){\n\t\t\tthis.clear();\n\t\t}else {\n\t\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\n\t\t\t//check if position is too close to bottom of table\n\t\t\theightOccupied = (rowsCount - position + 1) * this.vDomRowHeight;\n\n\t\t\tif(heightOccupied < containerHeight){\n\t\t\t\tposition -= Math.ceil((containerHeight - heightOccupied) / this.vDomRowHeight);\n\t\t\t\tif(position < 0){\n\t\t\t\t\tposition = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//calculate initial pad\n\t\t\ttopPad = Math.min(Math.max(Math.floor(this.vDomWindowBuffer / this.vDomRowHeight),  this.vDomWindowMinMarginRows), position);\n\t\t\tposition -= topPad;\n\t\t}\n\n\t\tif(rowsCount && Helpers.elVisible(this.elementVertical)){\n\t\t\tthis.vDomTop = position;\n\t\t\tthis.vDomBottom = position -1;\n\n\t\t\tif(fixedHeight || this.table.options.maxHeight) {\n\t\t\t\tif(avgRowHeight) {\n\t\t\t\t\trowsToRender = (containerHeight / avgRowHeight) + (this.vDomWindowBuffer / avgRowHeight);\n\t\t\t\t}\n\t\t\t\trowsToRender = Math.max(this.vDomWindowMinTotalRows, Math.ceil(rowsToRender));\n\t\t\t}\n\t\t\telse {\n\t\t\t\trowsToRender = rowsCount;\n\t\t\t}\n\n\t\t\twhile(((rowsToRender == rowsCount || rowsHeight <= containerHeight + this.vDomWindowBuffer) || totalRowsRendered < this.vDomWindowMinTotalRows) && this.vDomBottom < rowsCount -1) {\n\t\t\t\trenderedRows = [];\n\t\t\t\trowFragment = document.createDocumentFragment();\n\n\t\t\t\ti = 0;\n\n\t\t\t\twhile ((i < rowsToRender) && this.vDomBottom < rowsCount -1) {\t\n\t\t\t\t\tindex = this.vDomBottom + 1,\n\t\t\t\t\trow = rows[index];\n\n\t\t\t\t\tthis.styleRow(row, index);\n\n\t\t\t\t\trow.initialize(false, true);\n\t\t\t\t\tif(!row.heightInitialized && !this.table.options.rowHeight){\n\t\t\t\t\t\trow.clearCellHeight();\n\t\t\t\t\t}\n\n\t\t\t\t\trowFragment.appendChild(row.getElement());\n\t\t\t\t\trenderedRows.push(row);\n\t\t\t\t\tthis.vDomBottom ++;\n\t\t\t\t\ti++;\n\t\t\t\t}\n\n\t\t\t\tif(!renderedRows.length){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\telement.appendChild(rowFragment);\n\t\t\t\t\n\t\t\t\t// NOTE: The next 3 loops are separate on purpose\n\t\t\t\t// This is to batch up the dom writes and reads which drastically improves performance \n\n\t\t\t\trenderedRows.forEach((row) => {\n\t\t\t\t\trow.rendered();\n\n\t\t\t\t\tif(!row.heightInitialized) {\n\t\t\t\t\t\trow.calcHeight(true);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trenderedRows.forEach((row) => {\n\t\t\t\t\tif(!row.heightInitialized) {\n\t\t\t\t\t\trow.setCellHeight();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trenderedRows.forEach((row) => {\n\t\t\t\t\trowHeight = row.getHeight();\n\t\t\t\t\t\n\t\t\t\t\tif(totalRowsRendered < topPad){\n\t\t\t\t\t\ttopPadHeight += rowHeight;\n\t\t\t\t\t}else {\n\t\t\t\t\t\trowsHeight += rowHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(rowHeight > this.vDomWindowBuffer){\n\t\t\t\t\t\tthis.vDomWindowBuffer = rowHeight * 2;\n\t\t\t\t\t}\n\t\t\t\t\ttotalRowsRendered++;\n\t\t\t\t});\n\n\t\t\t\tresized = this.table.rowManager.adjustTableSize();\n\t\t\t\tcontainerHeight = this.elementVertical.clientHeight;\n\t\t\t\tif(resized && (fixedHeight || this.table.options.maxHeight))\n\t\t\t\t{\n\t\t\t\t\tavgRowHeight = rowsHeight / totalRowsRendered;\n\t\t\t\t\trowsToRender = Math.max(this.vDomWindowMinTotalRows, Math.ceil((containerHeight / avgRowHeight) + (this.vDomWindowBuffer / avgRowHeight)));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!position){\n\t\t\t\tthis.vDomTopPad = 0;\n\t\t\t\t//adjust row height to match average of rendered elements\n\t\t\t\tthis.vDomRowHeight = Math.floor((rowsHeight + topPadHeight) / totalRowsRendered);\n\t\t\t\tthis.vDomBottomPad = this.vDomRowHeight * (rowsCount - this.vDomBottom -1);\n\n\t\t\t\tthis.vDomScrollHeight = topPadHeight + rowsHeight + this.vDomBottomPad - containerHeight;\n\t\t\t}else {\n\t\t\t\tthis.vDomTopPad = !forceMove ? this.scrollTop - topPadHeight : (this.vDomRowHeight * this.vDomTop) + offset;\n\t\t\t\tthis.vDomBottomPad = this.vDomBottom == rowsCount-1 ? 0 : Math.max(this.vDomScrollHeight - this.vDomTopPad - rowsHeight - topPadHeight, 0);\n\t\t\t}\n\t\t\t\n\t\t\telement.style.paddingTop = this.vDomTopPad+\"px\";\n\t\t\telement.style.paddingBottom = this.vDomBottomPad+\"px\";\n\n\t\t\tif(forceMove){\n\t\t\t\tthis.scrollTop = this.vDomTopPad + (topPadHeight) + offset - (this.elementVertical.scrollWidth > this.elementVertical.clientWidth ? this.elementVertical.offsetHeight - containerHeight : 0);\n\t\t\t}\n\n\t\t\tthis.scrollTop = Math.min(this.scrollTop, this.elementVertical.scrollHeight - containerHeight);\n\n\t\t\t//adjust for horizontal scrollbar if present (and not at top of table)\n\t\t\tif(this.elementVertical.scrollWidth > this.elementVertical.clientWidth && forceMove){\n\t\t\t\tthis.scrollTop += this.elementVertical.offsetHeight - containerHeight;\n\t\t\t}\n\n\t\t\tthis.vDomScrollPosTop = this.scrollTop;\n\t\t\tthis.vDomScrollPosBottom = this.scrollTop;\n\n\t\t\tholder.scrollTop = this.scrollTop;\n\n\t\t\tthis.dispatch(\"render-virtual-fill\");\n\t\t}\n\t}\n\n\t_addTopRow(rows, fillableSpace){\n\t\tvar table = this.tableElement,\n\t\taddedRows = [],\n\t\tpaddingAdjust = 0,\n\t\tindex = this.vDomTop -1,\n\t\ti = 0,\n\t\tworking = true;\n\n\t\twhile(working){\n\t\t\tif(this.vDomTop){\n\t\t\t\tlet row = rows[index],\n\t\t\t\trowHeight, initialized;\n\n\t\t\t\tif(row && i < this.vDomMaxRenderChain){\n\t\t\t\t\trowHeight = row.getHeight() || this.vDomRowHeight;\n\t\t\t\t\tinitialized = row.initialized;\n\n\t\t\t\t\tif(fillableSpace >= rowHeight){\n\n\t\t\t\t\t\tthis.styleRow(row, index);\n\t\t\t\t\t\ttable.insertBefore(row.getElement(), table.firstChild);\n\n\t\t\t\t\t\tif(!row.initialized || !row.heightInitialized){\n\t\t\t\t\t\t\taddedRows.push(row);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trow.initialize();\n\n\t\t\t\t\t\tif(!initialized){\n\t\t\t\t\t\t\trowHeight = row.getElement().offsetHeight;\n\n\t\t\t\t\t\t\tif(rowHeight > this.vDomWindowBuffer){\n\t\t\t\t\t\t\t\tthis.vDomWindowBuffer = rowHeight * 2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfillableSpace -= rowHeight;\n\t\t\t\t\t\tpaddingAdjust += rowHeight;\n\n\t\t\t\t\t\tthis.vDomTop--;\n\t\t\t\t\t\tindex--;\n\t\t\t\t\t\ti++;\n\n\t\t\t\t\t}else {\n\t\t\t\t\t\tworking = false;\n\t\t\t\t\t}\n\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let row of addedRows){\n\t\t\trow.clearCellHeight();\n\t\t}\n\n\t\tthis._quickNormalizeRowHeight(addedRows);\n\n\t\tif(paddingAdjust){\n\t\t\tthis.vDomTopPad -= paddingAdjust;\n\n\t\t\tif(this.vDomTopPad < 0){\n\t\t\t\tthis.vDomTopPad = index * this.vDomRowHeight;\n\t\t\t}\n\n\t\t\tif(index < 1){\n\t\t\t\tthis.vDomTopPad = 0;\n\t\t\t}\n\n\t\t\ttable.style.paddingTop = this.vDomTopPad + \"px\";\n\t\t\tthis.vDomScrollPosTop -= paddingAdjust;\n\t\t}\n\t}\n\n\t_removeTopRow(rows, fillableSpace){\n\t\tvar removableRows = [],\n\t\tpaddingAdjust = 0,\n\t\ti = 0,\n\t\tworking = true;\n\n\t\twhile(working){\n\t\t\tlet row = rows[this.vDomTop],\n\t\t\trowHeight;\n\n\t\t\tif(row && i < this.vDomMaxRenderChain){\n\t\t\t\trowHeight = row.getHeight() || this.vDomRowHeight;\n\n\t\t\t\tif(fillableSpace >= rowHeight){\n\t\t\t\t\tthis.vDomTop++;\n\n\t\t\t\t\tfillableSpace -= rowHeight;\n\t\t\t\t\tpaddingAdjust += rowHeight;\n\n\t\t\t\t\tremovableRows.push(row);\n\t\t\t\t\ti++;\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let row of removableRows){\n\t\t\tlet rowEl = row.getElement();\n\n\t\t\tif(rowEl.parentNode){\n\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t}\n\t\t}\n\n\t\tif(paddingAdjust){\n\t\t\tthis.vDomTopPad += paddingAdjust;\n\t\t\tthis.tableElement.style.paddingTop = this.vDomTopPad + \"px\";\n\t\t\tthis.vDomScrollPosTop += this.vDomTop ? paddingAdjust : paddingAdjust + this.vDomWindowBuffer;\n\t\t}\n\t}\n\n\t_addBottomRow(rows, fillableSpace){\n\t\tvar table = this.tableElement,\n\t\taddedRows = [],\n\t\tpaddingAdjust = 0,\n\t\tindex = this.vDomBottom + 1,\n\t\ti = 0,\n\t\tworking = true;\n\n\t\twhile(working){\n\t\t\tlet row = rows[index],\n\t\t\trowHeight, initialized;\n\n\t\t\tif(row && i < this.vDomMaxRenderChain){\n\t\t\t\trowHeight = row.getHeight() || this.vDomRowHeight;\n\t\t\t\tinitialized = row.initialized;\n\n\t\t\t\tif(fillableSpace >= rowHeight){\n\n\t\t\t\t\tthis.styleRow(row, index);\n\t\t\t\t\ttable.appendChild(row.getElement());\n\n\t\t\t\t\tif(!row.initialized || !row.heightInitialized){\n\t\t\t\t\t\taddedRows.push(row);\n\t\t\t\t\t}\n\n\t\t\t\t\trow.initialize();\n\n\t\t\t\t\tif(!initialized){\n\t\t\t\t\t\trowHeight = row.getElement().offsetHeight;\n\n\t\t\t\t\t\tif(rowHeight > this.vDomWindowBuffer){\n\t\t\t\t\t\t\tthis.vDomWindowBuffer = rowHeight * 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfillableSpace -= rowHeight;\n\t\t\t\t\tpaddingAdjust += rowHeight;\n\n\t\t\t\t\tthis.vDomBottom++;\n\t\t\t\t\tindex++;\n\t\t\t\t\ti++;\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let row of addedRows){\n\t\t\trow.clearCellHeight();\n\t\t}\n\n\t\tthis._quickNormalizeRowHeight(addedRows);\n\n\t\tif(paddingAdjust){\n\t\t\tthis.vDomBottomPad -= paddingAdjust;\n\n\t\t\tif(this.vDomBottomPad < 0 || index == rows.length -1){\n\t\t\t\tthis.vDomBottomPad = 0;\n\t\t\t}\n\n\t\t\ttable.style.paddingBottom = this.vDomBottomPad + \"px\";\n\t\t\tthis.vDomScrollPosBottom += paddingAdjust;\n\t\t}\n\t}\n\n\t_removeBottomRow(rows, fillableSpace){\n\t\tvar removableRows = [],\n\t\tpaddingAdjust = 0,\n\t\ti = 0,\n\t\tworking = true;\n\n\t\twhile(working){\n\t\t\tlet row = rows[this.vDomBottom],\n\t\t\trowHeight;\n\n\t\t\tif(row && i < this.vDomMaxRenderChain){\n\t\t\t\trowHeight = row.getHeight() || this.vDomRowHeight;\n\n\t\t\t\tif(fillableSpace >= rowHeight){\n\t\t\t\t\tthis.vDomBottom --;\n\n\t\t\t\t\tfillableSpace -= rowHeight;\n\t\t\t\t\tpaddingAdjust += rowHeight;\n\n\t\t\t\t\tremovableRows.push(row);\n\t\t\t\t\ti++;\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let row of removableRows){\n\t\t\tlet rowEl = row.getElement();\n\n\t\t\tif(rowEl.parentNode){\n\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t}\n\t\t}\n\n\t\tif(paddingAdjust){\n\t\t\tthis.vDomBottomPad += paddingAdjust;\n\n\t\t\tif(this.vDomBottomPad < 0){\n\t\t\t\tthis.vDomBottomPad = 0;\n\t\t\t}\n\n\t\t\tthis.tableElement.style.paddingBottom = this.vDomBottomPad + \"px\";\n\t\t\tthis.vDomScrollPosBottom -= paddingAdjust;\n\t\t}\n\t}\n\n\t_quickNormalizeRowHeight(rows){\n\t\tfor(let row of rows){\n\t\t\trow.calcHeight();\n\t\t}\n\n\t\tfor(let row of rows){\n\t\t\trow.setCellHeight();\n\t\t}\n\t}\n}\n\nclass RowManager extends CoreFeature{\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.element = this.createHolderElement(); //containing element\n\t\tthis.tableElement = this.createTableElement(); //table element\n\t\tthis.heightFixer = this.createTableElement(); //table element\n\t\tthis.placeholder = null; //placeholder element\n\t\tthis.placeholderContents = null; //placeholder element\n\t\t\n\t\tthis.firstRender = false; //handle first render\n\t\tthis.renderMode = \"virtual\"; //current rendering mode\n\t\tthis.fixedHeight = false; //current rendering mode\n\t\t\n\t\tthis.rows = []; //hold row data objects\n\t\tthis.activeRowsPipeline = []; //hold calculation of active rows\n\t\tthis.activeRows = []; //rows currently available to on display in the table\n\t\tthis.activeRowsCount = 0; //count of active rows\n\t\t\n\t\tthis.displayRows = []; //rows currently on display in the table\n\t\tthis.displayRowsCount = 0; //count of display rows\n\t\t\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\t\t\n\t\tthis.redrawBlock = false; //prevent redraws to allow multiple data manipulations before continuing\n\t\tthis.redrawBlockRestoreConfig = false; //store latest redraw function calls for when redraw is needed\n\t\tthis.redrawBlockRenderInPosition = false; //store latest redraw function calls for when redraw is needed\n\t\t\n\t\tthis.dataPipeline = []; //hold data pipeline tasks\n\t\tthis.displayPipeline = []; //hold data display pipeline tasks\n\t\t\n\t\tthis.scrollbarWidth = 0;\n\t\t\n\t\tthis.renderer = null;\n\t}\n\t\n\t//////////////// Setup Functions /////////////////\n\t\n\tcreateHolderElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-tableholder\");\n\t\tel.setAttribute(\"tabindex\", 0);\n\t\t// el.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tcreateTableElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-table\");\n\t\tel.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tinitializePlaceholder(){\n\t\tvar placeholder = this.table.options.placeholder;\n\t\t\n\t\tif(typeof placeholder === \"function\"){\n\t\t\tplaceholder = placeholder.call(this.table);\n\t\t}\n\t\t\n\t\tplaceholder = this.chain(\"placeholder\", [placeholder], placeholder, placeholder) || placeholder;\n\t\t\n\t\t//configure placeholder element\n\t\tif(placeholder){\t\n\t\t\tlet el = document.createElement(\"div\");\n\t\t\tel.classList.add(\"tabulator-placeholder\");\n\t\t\t\n\t\t\tif(typeof placeholder == \"string\"){\n\t\t\t\tlet contents = document.createElement(\"div\");\n\t\t\t\tcontents.classList.add(\"tabulator-placeholder-contents\");\n\t\t\t\tcontents.innerHTML = placeholder;\n\t\t\t\t\n\t\t\t\tel.appendChild(contents);\n\t\t\t\t\n\t\t\t\tthis.placeholderContents = contents;\n\t\t\t\t\n\t\t\t}else if(typeof HTMLElement !== \"undefined\" && placeholder instanceof HTMLElement){\n\t\t\t\t\n\t\t\t\tel.appendChild(placeholder);\n\t\t\t\tthis.placeholderContents = placeholder;\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Invalid placeholder provided, must be string or HTML Element\", placeholder);\n\t\t\t\t\n\t\t\t\tthis.el = null;\n\t\t\t}\n\t\t\t\n\t\t\tthis.placeholder = el;\n\t\t}\n\t}\n\t\n\t//return containing element\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\t\n\t//return table element\n\tgetTableElement(){\n\t\treturn this.tableElement;\n\t}\n\t\n\tinitialize(){\n\t\tthis.initializePlaceholder();\n\t\tthis.initializeRenderer();\n\t\t\n\t\t//initialize manager\n\t\tthis.element.appendChild(this.tableElement);\n\t\t\n\t\tthis.firstRender = true;\n\t\t\n\t\t//scroll header along with table body\n\t\tthis.element.addEventListener(\"scroll\", () => {\n\t\t\tvar left = this.element.scrollLeft,\n\t\t\tleftDir = this.scrollLeft > left,\n\t\t\ttop = this.element.scrollTop,\n\t\t\ttopDir = this.scrollTop > top;\n\t\t\t\n\t\t\t//handle horizontal scrolling\n\t\t\tif(this.scrollLeft != left){\n\t\t\t\tthis.scrollLeft = left;\n\t\t\t\t\n\t\t\t\tthis.dispatch(\"scroll-horizontal\", left, leftDir);\n\t\t\t\tthis.dispatchExternal(\"scrollHorizontal\", left, leftDir);\n\t\t\t\t\n\t\t\t\tthis._positionPlaceholder();\n\t\t\t}\n\t\t\t\n\t\t\t//handle vertical scrolling\n\t\t\tif(this.scrollTop != top){\n\t\t\t\tthis.scrollTop = top;\n\t\t\t\t\n\t\t\t\tthis.renderer.scrollRows(top, topDir);\n\t\t\t\t\n\t\t\t\tthis.dispatch(\"scroll-vertical\", top, topDir);\n\t\t\t\tthis.dispatchExternal(\"scrollVertical\", top, topDir);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t////////////////// Row Manipulation //////////////////\n\tfindRow(subject){\n\t\tif(typeof subject == \"object\"){\n\t\t\tif(subject instanceof Row){\n\t\t\t\t//subject is row element\n\t\t\t\treturn subject;\n\t\t\t}else if(subject instanceof RowComponent){\n\t\t\t\t//subject is public row component\n\t\t\t\treturn subject._getSelf() || false;\n\t\t\t}else if(typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement){\n\t\t\t\t//subject is a HTML element of the row\n\t\t\t\tlet match = this.rows.find((row) => {\n\t\t\t\t\treturn row.getElement() === subject;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn match || false;\n\t\t\t}else if(subject === null){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else if(typeof subject == \"undefined\"){\n\t\t\treturn false;\n\t\t}else {\n\t\t\t//subject should be treated as the index of the row\n\t\t\tlet match = this.rows.find((row) => {\n\t\t\t\treturn row.data[this.table.options.index] == subject;\n\t\t\t});\n\t\t\t\n\t\t\treturn match || false;\n\t\t}\n\t\t\n\t\t//catch all for any other type of input\n\t\treturn false;\n\t}\n\t\n\tgetRowFromDataObject(data){\n\t\tvar match = this.rows.find((row) => {\n\t\t\treturn row.data === data;\n\t\t});\n\t\t\n\t\treturn match || false;\n\t}\n\t\n\tgetRowFromPosition(position){\n\t\treturn this.getDisplayRows().find((row) => {\n\t\t\treturn row.type === \"row\" && row.getPosition() === position && row.isDisplayed();\n\t\t});\n\t}\n\t\n\tscrollToRow(row, position, ifVisible){\n\t\treturn this.renderer.scrollToRowPosition(row, position, ifVisible);\n\t}\n\t\n\t////////////////// Data Handling //////////////////\n\tsetData(data, renderInPosition, columnsChanged){\n\t\treturn new Promise((resolve, reject)=>{\n\t\t\tif(renderInPosition && this.getDisplayRows().length){\n\t\t\t\tif(this.table.options.pagination){\n\t\t\t\t\tthis._setDataActual(data, true);\n\t\t\t\t}else {\n\t\t\t\t\tthis.reRenderInPosition(() => {\n\t\t\t\t\t\tthis._setDataActual(data);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(this.table.options.autoColumns && columnsChanged && this.table.initialized){\n\t\t\t\t\tthis.table.columnManager.generateColumnsFromRowData(data);\n\t\t\t\t}\n\t\t\t\tthis.resetScroll();\n\t\t\t\t\n\t\t\t\tthis._setDataActual(data);\n\t\t\t}\n\t\t\t\n\t\t\tresolve();\n\t\t});\n\t}\n\t\n\t_setDataActual(data, renderInPosition){\n\t\tthis.dispatchExternal(\"dataProcessing\", data);\n\t\t\n\t\tthis._wipeElements();\n\t\t\n\t\tif(Array.isArray(data)){\n\t\t\tthis.dispatch(\"data-processing\", data);\n\t\t\t\n\t\t\tdata.forEach((def, i) => {\n\t\t\t\tif(def && typeof def === \"object\"){\n\t\t\t\t\tvar row = new Row(def, this);\n\t\t\t\t\tthis.rows.push(row);\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Data Loading Warning - Invalid row data detected and ignored, expecting object but received:\", def);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.refreshActiveData(false, false, renderInPosition);\n\t\t\t\n\t\t\tthis.dispatch(\"data-processed\", data);\n\t\t\tthis.dispatchExternal(\"dataProcessed\", data);\n\t\t}else {\n\t\t\tconsole.error(\"Data Loading Error - Unable to process data due to invalid data type \\nExpecting: array \\nReceived: \", typeof data, \"\\nData:     \", data);\n\t\t}\n\t}\n\t\n\t_wipeElements(){\n\t\tthis.dispatch(\"rows-wipe\");\n\t\t\n\t\tthis.destroy();\n\t\t\n\t\tthis.adjustTableSize();\n\t\t\n\t\tthis.dispatch(\"rows-wiped\");\n\t}\n\t\n\tdestroy(){\n\t\tthis.rows.forEach((row) => {\n\t\t\trow.wipe();\n\t\t});\n\t\t\n\t\tthis.rows = [];\n\t\tthis.activeRows = [];\n\t\tthis.activeRowsPipeline = [];\n\t\tthis.activeRowsCount = 0;\n\t\tthis.displayRows = [];\n\t\tthis.displayRowsCount = 0;\n\t}\n\t\n\tdeleteRow(row, blockRedraw){\n\t\tvar allIndex = this.rows.indexOf(row),\n\t\tactiveIndex = this.activeRows.indexOf(row);\n\t\t\n\t\tif(activeIndex > -1){\n\t\t\tthis.activeRows.splice(activeIndex, 1);\n\t\t}\n\t\t\n\t\tif(allIndex > -1){\n\t\t\tthis.rows.splice(allIndex, 1);\n\t\t}\n\t\t\n\t\tthis.setActiveRows(this.activeRows);\n\t\t\n\t\tthis.displayRowIterator((rows) => {\n\t\t\tvar displayIndex = rows.indexOf(row);\n\t\t\t\n\t\t\tif(displayIndex > -1){\n\t\t\t\trows.splice(displayIndex, 1);\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(!blockRedraw){\n\t\t\tthis.reRenderInPosition();\n\t\t}\n\t\t\n\t\tthis.regenerateRowPositions();\n\t\t\n\t\tthis.dispatchExternal(\"rowDeleted\", row.getComponent());\n\t\t\n\t\tif(!this.displayRowsCount){\n\t\t\tthis.tableEmpty();\n\t\t}\n\t\t\n\t\tif(this.subscribedExternal(\"dataChanged\")){\n\t\t\tthis.dispatchExternal(\"dataChanged\", this.getData());\n\t\t}\n\t}\n\t\n\taddRow(data, pos, index, blockRedraw){\n\t\tvar row = this.addRowActual(data, pos, index, blockRedraw);\n\t\treturn row;\n\t}\n\t\n\t//add multiple rows\n\taddRows(data, pos, index, refreshDisplayOnly){\n\t\tvar rows = [];\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tpos = this.findAddRowPos(pos);\n\t\t\t\n\t\t\tif(!Array.isArray(data)){\n\t\t\t\tdata = [data];\n\t\t\t}\n\t\t\t\n\t\t\tif((typeof index == \"undefined\" && pos) || (typeof index !== \"undefined\" && !pos)){\n\t\t\t\tdata.reverse();\n\t\t\t}\n\t\t\t\n\t\t\tdata.forEach((item, i) => {\n\t\t\t\tvar row = this.addRow(item, pos, index, true);\n\t\t\t\trows.push(row);\n\t\t\t\tthis.dispatch(\"row-added\", row, item, pos, index);\n\t\t\t});\n\t\t\t\n\t\t\tthis.refreshActiveData(refreshDisplayOnly ? \"displayPipeline\" : false, false, true);\n\t\t\t\n\t\t\tthis.regenerateRowPositions();\n\t\t\t\n\t\t\tif(this.displayRowsCount){\n\t\t\t\tthis._clearPlaceholder();\n\t\t\t}\n\t\t\t\n\t\t\tresolve(rows);\n\t\t});\n\t}\n\t\n\tfindAddRowPos(pos){\n\t\tif(typeof pos === \"undefined\"){\n\t\t\tpos = this.table.options.addRowPos;\n\t\t}\n\t\t\n\t\tif(pos === \"pos\"){\n\t\t\tpos = true;\n\t\t}\n\t\t\n\t\tif(pos === \"bottom\"){\n\t\t\tpos = false;\n\t\t}\n\t\t\n\t\treturn pos;\n\t}\n\t\n\taddRowActual(data, pos, index, blockRedraw){\n\t\tvar row = data instanceof Row ? data : new Row(data || {}, this),\n\t\ttop = this.findAddRowPos(pos),\n\t\tallIndex = -1,\n\t\tactiveIndex, chainResult;\n\t\t\n\t\tif(!index){\n\t\t\tchainResult = this.chain(\"row-adding-position\", [row, top], null, {index, top});\n\t\t\t\n\t\t\tindex = chainResult.index;\n\t\t\ttop = chainResult.top;\n\t\t}\n\t\t\n\t\tif(typeof index !== \"undefined\"){\n\t\t\tindex = this.findRow(index);\n\t\t}\n\t\t\n\t\tindex = this.chain(\"row-adding-index\", [row, index, top], null, index);\n\t\t\n\t\tif(index){\n\t\t\tallIndex = this.rows.indexOf(index);\n\t\t}\n\t\t\n\t\tif(index && allIndex > -1){\n\t\t\tactiveIndex = this.activeRows.indexOf(index);\n\t\t\t\n\t\t\tthis.displayRowIterator(function(rows){\n\t\t\t\tvar displayIndex = rows.indexOf(index);\n\t\t\t\t\n\t\t\t\tif(displayIndex > -1){\n\t\t\t\t\trows.splice((top ? displayIndex : displayIndex + 1), 0, row);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(activeIndex > -1){\n\t\t\t\tthis.activeRows.splice((top ? activeIndex : activeIndex + 1), 0, row);\n\t\t\t}\n\t\t\t\n\t\t\tthis.rows.splice((top ? allIndex : allIndex + 1), 0, row);\n\t\t\t\n\t\t}else {\n\t\t\t\n\t\t\tif(top){\n\t\t\t\t\n\t\t\t\tthis.displayRowIterator(function(rows){\n\t\t\t\t\trows.unshift(row);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.activeRows.unshift(row);\n\t\t\t\tthis.rows.unshift(row);\n\t\t\t}else {\n\t\t\t\tthis.displayRowIterator(function(rows){\n\t\t\t\t\trows.push(row);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.activeRows.push(row);\n\t\t\t\tthis.rows.push(row);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.setActiveRows(this.activeRows);\n\t\t\n\t\tthis.dispatchExternal(\"rowAdded\", row.getComponent());\n\t\t\n\t\tif(this.subscribedExternal(\"dataChanged\")){\n\t\t\tthis.dispatchExternal(\"dataChanged\", this.table.rowManager.getData());\n\t\t}\n\t\t\n\t\tif(!blockRedraw){\n\t\t\tthis.reRenderInPosition();\n\t\t}\n\t\t\n\t\treturn row;\n\t}\n\t\n\tmoveRow(from, to, after){\n\t\tthis.dispatch(\"row-move\", from, to, after);\n\t\t\n\t\tthis.moveRowActual(from, to, after);\n\t\t\n\t\tthis.regenerateRowPositions();\n\t\t\n\t\tthis.dispatch(\"row-moved\", from, to, after);\n\t\tthis.dispatchExternal(\"rowMoved\", from.getComponent());\n\t}\n\t\n\tmoveRowActual(from, to, after){\n\t\tthis.moveRowInArray(this.rows, from, to, after);\n\t\tthis.moveRowInArray(this.activeRows, from, to, after);\n\t\t\n\t\tthis.displayRowIterator((rows) => {\n\t\t\tthis.moveRowInArray(rows, from, to, after);\n\t\t});\n\t\t\n\t\tthis.dispatch(\"row-moving\", from, to, after);\n\t}\n\t\n\tmoveRowInArray(rows, from, to, after){\n\t\tvar\tfromIndex, toIndex, start, end;\n\t\t\n\t\tif(from !== to){\n\t\t\t\n\t\t\tfromIndex = rows.indexOf(from);\n\t\t\t\n\t\t\tif (fromIndex > -1) {\n\t\t\t\t\n\t\t\t\trows.splice(fromIndex, 1);\n\t\t\t\t\n\t\t\t\ttoIndex = rows.indexOf(to);\n\t\t\t\t\n\t\t\t\tif (toIndex > -1) {\n\t\t\t\t\t\n\t\t\t\t\tif(after){\n\t\t\t\t\t\trows.splice(toIndex+1, 0, from);\n\t\t\t\t\t}else {\n\t\t\t\t\t\trows.splice(toIndex, 0, from);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}else {\n\t\t\t\t\trows.splice(fromIndex, 0, from);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//restyle rows\n\t\t\tif(rows === this.getDisplayRows()){\n\t\t\t\t\n\t\t\t\tstart = fromIndex < toIndex ? fromIndex : toIndex;\n\t\t\t\tend = toIndex > fromIndex ? toIndex : fromIndex +1;\n\t\t\t\t\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tif(rows[i]){\n\t\t\t\t\t\tthis.styleRow(rows[i], i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tclearData(){\n\t\tthis.setData([]);\n\t}\n\t\n\tgetRowIndex(row){\n\t\treturn this.findRowIndex(row, this.rows);\n\t}\n\t\n\tgetDisplayRowIndex(row){\n\t\tvar index = this.getDisplayRows().indexOf(row);\n\t\treturn index > -1 ? index : false;\n\t}\n\t\n\tnextDisplayRow(row, rowOnly){\n\t\tvar index = this.getDisplayRowIndex(row),\n\t\tnextRow = false;\n\t\t\n\t\t\n\t\tif(index !== false && index < this.displayRowsCount -1){\n\t\t\tnextRow = this.getDisplayRows()[index+1];\n\t\t}\n\t\t\n\t\tif(nextRow && (!(nextRow instanceof Row) || nextRow.type != \"row\")){\n\t\t\treturn this.nextDisplayRow(nextRow, rowOnly);\n\t\t}\n\t\t\n\t\treturn nextRow;\n\t}\n\t\n\tprevDisplayRow(row, rowOnly){\n\t\tvar index = this.getDisplayRowIndex(row),\n\t\tprevRow = false;\n\t\t\n\t\tif(index){\n\t\t\tprevRow = this.getDisplayRows()[index-1];\n\t\t}\n\t\t\n\t\tif(rowOnly && prevRow && (!(prevRow instanceof Row) || prevRow.type != \"row\")){\n\t\t\treturn this.prevDisplayRow(prevRow, rowOnly);\n\t\t}\n\t\t\n\t\treturn prevRow;\n\t}\n\t\n\tfindRowIndex(row, list){\n\t\tvar rowIndex;\n\t\t\n\t\trow = this.findRow(row);\n\t\t\n\t\tif(row){\n\t\t\trowIndex = list.indexOf(row);\n\t\t\t\n\t\t\tif(rowIndex > -1){\n\t\t\t\treturn rowIndex;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tgetData(active, transform){\n\t\tvar output = [],\n\t\trows = this.getRows(active);\n\t\t\n\t\trows.forEach(function(row){\n\t\t\tif(row.type == \"row\"){\n\t\t\t\toutput.push(row.getData(transform || \"data\"));\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetComponents(active){\n\t\tvar\toutput = [],\n\t\trows = this.getRows(active);\n\t\t\n\t\trows.forEach(function(row){\n\t\t\toutput.push(row.getComponent());\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetDataCount(active){\n\t\tvar rows = this.getRows(active);\n\t\t\n\t\treturn rows.length;\n\t}\n\t\n\tscrollHorizontal(left){\n\t\tthis.scrollLeft = left;\n\t\tthis.element.scrollLeft = left;\n\t\t\n\t\tthis.dispatch(\"scroll-horizontal\", left);\n\t}\n\t\n\tregisterDataPipelineHandler(handler, priority){\n\t\tif(typeof priority !== \"undefined\"){\n\t\t\tthis.dataPipeline.push({handler, priority});\n\t\t\tthis.dataPipeline.sort((a, b) => {\n\t\t\t\treturn a.priority - b.priority;\n\t\t\t});\n\t\t}else {\n\t\t\tconsole.error(\"Data pipeline handlers must have a priority in order to be registered\");\n\t\t}\n\t}\n\t\n\tregisterDisplayPipelineHandler(handler, priority){\n\t\tif(typeof priority !== \"undefined\"){\n\t\t\tthis.displayPipeline.push({handler, priority});\n\t\t\tthis.displayPipeline.sort((a, b) => {\n\t\t\t\treturn a.priority - b.priority;\n\t\t\t});\n\t\t}else {\n\t\t\tconsole.error(\"Display pipeline handlers must have a priority in order to be registered\");\n\t\t}\n\t}\n\t\n\t//set active data set\n\trefreshActiveData(handler, skipStage, renderInPosition){\n\t\tvar table = this.table,\n\t\tstage = \"\",\n\t\tindex = 0,\n\t\tcascadeOrder = [\"all\", \"dataPipeline\", \"display\", \"displayPipeline\", \"end\"];\n\t\t\n\t\tif(!this.table.destroyed){\n\t\t\tif(typeof handler === \"function\"){\n\t\t\t\tindex = this.dataPipeline.findIndex((item) => {\n\t\t\t\t\treturn item.handler === handler;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(index > -1){\n\t\t\t\t\tstage = \"dataPipeline\";\n\t\t\t\t\t\n\t\t\t\t\tif(skipStage){\n\t\t\t\t\t\tif(index == this.dataPipeline.length - 1){\n\t\t\t\t\t\t\tstage = \"display\";\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tindex = this.displayPipeline.findIndex((item) => {\n\t\t\t\t\t\treturn item.handler === handler;\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif(index > -1){\n\t\t\t\t\t\tstage = \"displayPipeline\";\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(skipStage){\n\t\t\t\t\t\t\tif(index == this.displayPipeline.length - 1){\n\t\t\t\t\t\t\t\tstage = \"end\";\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.error(\"Unable to refresh data, invalid handler provided\", handler);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tstage = handler || \"all\";\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t\t\n\t\t\tif(this.redrawBlock){\n\t\t\t\tif(!this.redrawBlockRestoreConfig || (this.redrawBlockRestoreConfig && ((this.redrawBlockRestoreConfig.stage === stage && index < this.redrawBlockRestoreConfig.index) || (cascadeOrder.indexOf(stage) < cascadeOrder.indexOf(this.redrawBlockRestoreConfig.stage))))){\n\t\t\t\t\tthis.redrawBlockRestoreConfig = {\n\t\t\t\t\t\thandler: handler,\n\t\t\t\t\t\tskipStage: skipStage,\n\t\t\t\t\t\trenderInPosition: renderInPosition,\n\t\t\t\t\t\tstage:stage,\n\t\t\t\t\t\tindex:index,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn;\n\t\t\t}else {\n\t\t\t\tif(Helpers.elVisible(this.element)){\n\t\t\t\t\tif(renderInPosition){\n\t\t\t\t\t\tthis.reRenderInPosition(this.refreshPipelines.bind(this, handler, stage, index, renderInPosition));\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.refreshPipelines(handler, stage, index, renderInPosition);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(!handler){\n\t\t\t\t\t\t\tthis.table.columnManager.renderer.renderColumns();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.renderTable();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(table.options.layoutColumnsOnNewData){\n\t\t\t\t\t\t\tthis.table.columnManager.redraw(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tthis.refreshPipelines(handler, stage, index, renderInPosition);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.dispatch(\"data-refreshed\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\trefreshPipelines(handler, stage, index, renderInPosition){\n\t\tthis.dispatch(\"data-refreshing\");\n\t\t\n\t\tif(!handler || !this.activeRowsPipeline[0]){\n\t\t\tthis.activeRowsPipeline[0] = this.rows.slice(0);\n\t\t}\n\t\t\n\t\t//cascade through data refresh stages\n\t\tswitch(stage){\n\t\t\tcase \"all\":\n\t\t\t//handle case where all data needs refreshing\n\t\t\t\n\t\t\tcase \"dataPipeline\":\n\t\t\t\tfor(let i = index; i < this.dataPipeline.length; i++){\n\t\t\t\t\tlet result = this.dataPipeline[i].handler(this.activeRowsPipeline[i].slice(0));\n\t\t\t\t\n\t\t\t\t\tthis.activeRowsPipeline[i + 1] = result || this.activeRowsPipeline[i].slice(0);\n\t\t\t\t}\n\t\t\t\n\t\t\t\tthis.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);\n\t\t\t\n\t\t\tcase \"display\":\n\t\t\t\tindex = 0;\n\t\t\t\tthis.resetDisplayRows();\n\t\t\t\n\t\t\tcase \"displayPipeline\":\n\t\t\t\tfor(let i = index; i < this.displayPipeline.length; i++){\n\t\t\t\t\tlet result = this.displayPipeline[i].handler((i ? this.getDisplayRows(i - 1) : this.activeRows).slice(0), renderInPosition);\n\t\t\t\t\n\t\t\t\t\tthis.setDisplayRows(result || this.getDisplayRows(i - 1).slice(0), i);\n\t\t\t\t}\n\t\t\t\n\t\t\tcase \"end\":\n\t\t\t//case to handle scenario when trying to skip past end stage\n\t\t\t\tthis.regenerateRowPositions();\n\t\t}\n\t\t\n\t\tif(this.getDisplayRows().length){\n\t\t\tthis._clearPlaceholder();\n\t\t}\n\t}\n\t\n\t//regenerate row positions\n\tregenerateRowPositions(){\n\t\tvar rows = this.getDisplayRows();\n\t\tvar index = 1;\n\t\t\n\t\trows.forEach((row) => {\n\t\t\tif (row.type === \"row\"){\n\t\t\t\trow.setPosition(index);\n\t\t\t\tindex++;\n\t\t\t}\n\t\t});\n\t}\n\t\n\tsetActiveRows(activeRows){\n\t\tthis.activeRows = this.activeRows = Object.assign([], activeRows);\n\t\tthis.activeRowsCount = this.activeRows.length;\n\t}\n\t\n\t//reset display rows array\n\tresetDisplayRows(){\n\t\tthis.displayRows = [];\n\t\t\n\t\tthis.displayRows.push(this.activeRows.slice(0));\n\t\t\n\t\tthis.displayRowsCount = this.displayRows[0].length;\n\t}\n\t\n\t//set display row pipeline data\n\tsetDisplayRows(displayRows, index){\n\t\tthis.displayRows[index] = displayRows;\n\t\t\n\t\tif(index == this.displayRows.length -1){\n\t\t\tthis.displayRowsCount = this.displayRows[this.displayRows.length -1].length;\n\t\t}\n\t}\n\t\n\tgetDisplayRows(index){\n\t\tif(typeof index == \"undefined\"){\n\t\t\treturn this.displayRows.length ? this.displayRows[this.displayRows.length -1] : [];\n\t\t}else {\n\t\t\treturn this.displayRows[index] || [];\n\t\t}\n\t}\n\t\n\tgetVisibleRows(chain, viewable){\n\t\tvar rows =  Object.assign([], this.renderer.visibleRows(!viewable));\n\t\t\n\t\tif(chain){\n\t\t\trows = this.chain(\"rows-visible\", [viewable], rows, rows);\n\t\t}\n\t\t\n\t\treturn rows;\n\t}\n\t\n\t//repeat action across display rows\n\tdisplayRowIterator(callback){\n\t\tthis.activeRowsPipeline.forEach(callback);\n\t\tthis.displayRows.forEach(callback);\n\t\t\n\t\tthis.displayRowsCount = this.displayRows[this.displayRows.length -1].length;\n\t}\n\t\n\t//return only actual rows (not group headers etc)\n\tgetRows(type){\n\t\tvar rows = [];\n\t\t\n\t\tswitch(type){\n\t\t\tcase \"active\":\n\t\t\t\trows = this.activeRows;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"display\":\n\t\t\t\trows = this.table.rowManager.getDisplayRows();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"visible\":\n\t\t\t\trows = this.getVisibleRows(false, true);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\trows = this.chain(\"rows-retrieve\", type, null, this.rows) || this.rows;\n\t\t}\n\t\t\n\t\treturn rows;\n\t}\n\t\n\t///////////////// Table Rendering /////////////////\n\t//trigger rerender of table in current position\n\treRenderInPosition(callback){\n\t\tif(this.redrawBlock){\n\t\t\tif(callback){\n\t\t\t\tcallback();\n\t\t\t}else {\n\t\t\t\tthis.redrawBlockRenderInPosition = true;\n\t\t\t}\n\t\t}else {\n\t\t\tthis.dispatchExternal(\"renderStarted\");\n\t\t\t\n\t\t\tthis.renderer.rerenderRows(callback);\n\t\t\t\n\t\t\tif(!this.fixedHeight){\n\t\t\t\tthis.adjustTableSize();\n\t\t\t}\n\t\t\t\n\t\t\tthis.scrollBarCheck();\n\t\t\t\n\t\t\tthis.dispatchExternal(\"renderComplete\");\n\t\t}\n\t}\n\t\n\tscrollBarCheck(){\n\t\tvar scrollbarWidth = 0;\n\t\t\n\t\t//adjust for vertical scrollbar moving table when present\n\t\tif(this.element.scrollHeight > this.element.clientHeight){\n\t\t\tscrollbarWidth = this.element.offsetWidth - this.element.clientWidth;\n\t\t}\n\t\t\n\t\tif(scrollbarWidth !== this.scrollbarWidth){\n\t\t\tthis.scrollbarWidth = scrollbarWidth;\n\t\t\tthis.dispatch(\"scrollbar-vertical\", scrollbarWidth);\n\t\t}\n\t}\n\t\n\tinitializeRenderer(){\n\t\tvar renderClass;\n\t\t\n\t\tvar renderers = {\n\t\t\t\"virtual\": VirtualDomVertical,\n\t\t\t\"basic\": BasicVertical,\n\t\t};\n\t\t\n\t\tif(typeof this.table.options.renderVertical === \"string\"){\n\t\t\trenderClass = renderers[this.table.options.renderVertical];\n\t\t}else {\n\t\t\trenderClass = this.table.options.renderVertical;\n\t\t}\n\t\t\n\t\tif(renderClass){\n\t\t\tthis.renderMode = this.table.options.renderVertical;\n\t\t\t\n\t\t\tthis.renderer = new renderClass(this.table, this.element, this.tableElement);\n\t\t\tthis.renderer.initialize();\n\t\t\t\n\t\t\tif((this.table.element.clientHeight || this.table.options.height) && !(this.table.options.minHeight && this.table.options.maxHeight)){\n\t\t\t\tthis.fixedHeight = true;\n\t\t\t}else {\n\t\t\t\tthis.fixedHeight = false;\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.error(\"Unable to find matching renderer:\", this.table.options.renderVertical);\n\t\t}\n\t}\n\t\n\tgetRenderMode(){\n\t\treturn this.renderMode;\n\t}\n\t\n\trenderTable(){\n\t\tthis.dispatchExternal(\"renderStarted\");\n\t\t\n\t\tthis.element.scrollTop = 0;\n\t\t\n\t\tthis._clearTable();\n\t\t\n\t\tif(this.displayRowsCount){\n\t\t\tthis.renderer.renderRows();\n\t\t\t\n\t\t\tif(this.firstRender){\n\t\t\t\tthis.firstRender = false;\n\t\t\t\t\n\t\t\t\tif(!this.fixedHeight){\n\t\t\t\t\tthis.adjustTableSize();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.layoutRefresh(true);\n\t\t\t}\n\t\t}else {\n\t\t\tthis.renderEmptyScroll();\n\t\t}\n\t\t\n\t\tif(!this.fixedHeight){\n\t\t\tthis.adjustTableSize();\n\t\t}\n\t\t\n\t\tthis.dispatch(\"table-layout\");\n\t\t\n\t\tif(!this.displayRowsCount){\n\t\t\tthis._showPlaceholder();\n\t\t}\n\t\t\n\t\tthis.scrollBarCheck();\n\t\t\n\t\tthis.dispatchExternal(\"renderComplete\");\n\t}\n\t\n\t//show scrollbars on empty table div\n\trenderEmptyScroll(){\n\t\tif(this.placeholder){\n\t\t\tthis.tableElement.style.display = \"none\";\n\t\t}else {\n\t\t\tthis.tableElement.style.minWidth = this.table.columnManager.getWidth() + \"px\";\n\t\t\t// this.tableElement.style.minHeight = \"1px\";\n\t\t\t// this.tableElement.style.visibility = \"hidden\";\n\t\t}\n\t}\n\t\n\t_clearTable(){\t\n\t\tthis._clearPlaceholder();\n\t\t\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\t\t\n\t\tthis.renderer.clearRows();\n\t}\n\t\n\ttableEmpty(){\n\t\tthis.renderEmptyScroll();\n\t\tthis._showPlaceholder();\n\t}\n\n\tcheckPlaceholder(){\n\t\tif(this.displayRowsCount){\n\t\t\tthis._clearPlaceholder();\n\t\t}else {\n\t\t\tthis.tableEmpty();\n\t\t}\n\t}\n\t\n\t_showPlaceholder(){\n\t\tif(this.placeholder){\n\t\t\tif(this.placeholder && this.placeholder.parentNode){\n\t\t\t\tthis.placeholder.parentNode.removeChild(this.placeholder);\n\t\t\t}\n\t\t\t\n\t\t\tthis.initializePlaceholder();\n\t\t\t\n\t\t\tthis.placeholder.setAttribute(\"tabulator-render-mode\", this.renderMode);\n\t\t\t\n\t\t\tthis.getElement().appendChild(this.placeholder);\n\t\t\tthis._positionPlaceholder();\n\n\t\t\tthis.adjustTableSize();\n\t\t}\n\t}\n\t\n\t_clearPlaceholder(){\n\t\tif(this.placeholder && this.placeholder.parentNode){\n\t\t\tthis.placeholder.parentNode.removeChild(this.placeholder);\n\t\t}\n\t\t\n\t\t// clear empty table placeholder min\n\t\tthis.tableElement.style.minWidth = \"\";\n\t\tthis.tableElement.style.display = \"\";\n\t}\n\t\n\t_positionPlaceholder(){\n\t\tif(this.placeholder && this.placeholder.parentNode){\n\t\t\tthis.placeholder.style.width = this.table.columnManager.getWidth() + \"px\";\n\t\t\tthis.placeholderContents.style.width = this.table.rowManager.element.clientWidth + \"px\";\n\t\t\tthis.placeholderContents.style.marginLeft = this.scrollLeft + \"px\";\n\t\t}\n\t}\n\t\n\tstyleRow(row, index){\n\t\tvar rowEl = row.getElement();\n\t\t\n\t\tif(index % 2){\n\t\t\trowEl.classList.add(\"tabulator-row-even\");\n\t\t\trowEl.classList.remove(\"tabulator-row-odd\");\n\t\t}else {\n\t\t\trowEl.classList.add(\"tabulator-row-odd\");\n\t\t\trowEl.classList.remove(\"tabulator-row-even\");\n\t\t}\n\t}\n\t\n\t//normalize height of active rows\n\tnormalizeHeight(force){\n\t\tthis.activeRows.forEach(function(row){\n\t\t\trow.normalizeHeight(force);\n\t\t});\n\t}\n\t\n\t//adjust the height of the table holder to fit in the Tabulator element\n\tadjustTableSize(){\n\t\tlet initialHeight = this.element.clientHeight, minHeight;\n\t\tlet resized = false;\n\t\t\n\t\tif(this.renderer.verticalFillMode === \"fill\"){\n\t\t\tlet otherHeight =  Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height + (this.table.footerManager && this.table.footerManager.active && !this.table.footerManager.external ? this.table.footerManager.getElement().getBoundingClientRect().height : 0));\n\t\t\t\n\t\t\tif(this.fixedHeight){\n\t\t\t\tminHeight = isNaN(this.table.options.minHeight) ? this.table.options.minHeight : this.table.options.minHeight + \"px\";\n\t\t\t\t\n\t\t\t\tconst height = \"calc(100% - \" + otherHeight + \"px)\";\n\t\t\t\tthis.element.style.minHeight = minHeight || \"calc(100% - \" + otherHeight + \"px)\";\n\t\t\t\tthis.element.style.height = height;\n\t\t\t\tthis.element.style.maxHeight = height;\n\t\t\t} else {\n\t\t\t\tthis.element.style.height = \"\";\n\t\t\t\tthis.element.style.height =\n\t\t\t\tthis.table.element.clientHeight - otherHeight + \"px\";\n\t\t\t\tthis.element.scrollTop = this.scrollTop;\n\t\t\t}\n\t\t\t\n\t\t\tthis.renderer.resize();\n\t\t\t\n\t\t\t//check if the table has changed size when dealing with variable height tables\n\t\t\tif(!this.fixedHeight && initialHeight != this.element.clientHeight){\n\t\t\t\tresized = true;\n\t\t\t\tif(this.subscribed(\"table-resize\")){\n\t\t\t\t\tthis.dispatch(\"table-resize\");\n\t\t\t\t}else {\n\t\t\t\t\tthis.redraw();\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.scrollBarCheck();\n\t\t}\n\t\t\n\t\tthis._positionPlaceholder();\n\t\treturn resized;\n\t}\n\t\n\t//reinitialize all rows\n\treinitialize(){\n\t\tthis.rows.forEach(function(row){\n\t\t\trow.reinitialize(true);\n\t\t});\n\t}\n\t\n\t//prevent table from being redrawn\n\tblockRedraw (){\n\t\tthis.redrawBlock = true;\n\t\tthis.redrawBlockRestoreConfig = false;\n\t}\n\t\n\t//restore table redrawing\n\trestoreRedraw (){\n\t\tthis.redrawBlock = false;\n\t\t\n\t\tif(this.redrawBlockRestoreConfig){\n\t\t\tthis.refreshActiveData(this.redrawBlockRestoreConfig.handler, this.redrawBlockRestoreConfig.skipStage, this.redrawBlockRestoreConfig.renderInPosition);\n\t\t\t\n\t\t\tthis.redrawBlockRestoreConfig = false;\n\t\t}else {\n\t\t\tif(this.redrawBlockRenderInPosition){\n\t\t\t\tthis.reRenderInPosition();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.redrawBlockRenderInPosition = false;\n\t}\n\t\n\t//redraw table\n\tredraw (force){\n\t\tthis.adjustTableSize();\n\t\tthis.table.tableWidth = this.table.element.clientWidth;\n\t\t\n\t\tif(!force){\t\n\t\t\tthis.reRenderInPosition();\n\t\t\tthis.scrollHorizontal(this.scrollLeft);\n\t\t}else {\n\t\t\tthis.renderTable();\n\t\t}\n\t}\n\t\n\tresetScroll(){\n\t\tthis.element.scrollLeft = 0;\n\t\tthis.element.scrollTop = 0;\n\t\t\n\t\tif(this.table.browser === \"ie\"){\n\t\t\tvar event = document.createEvent(\"Event\");\n\t\t\tevent.initEvent(\"scroll\", false, true);\n\t\t\tthis.element.dispatchEvent(event);\n\t\t}else {\n\t\t\tthis.element.dispatchEvent(new Event('scroll'));\n\t\t}\n\t}\n}\n\nclass FooterManager extends CoreFeature{\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.active = false;\n\t\tthis.element = this.createElement(); //containing element\n\t\tthis.containerElement = this.createContainerElement(); //containing element\n\t\tthis.external = false;\n\t}\n\n\tinitialize(){\n\t\tthis.initializeElement();\n\t}\n\n\tcreateElement(){\n\t\tvar el = document.createElement(\"div\");\n\n\t\tel.classList.add(\"tabulator-footer\");\n\n\t\treturn el;\n\t}\n\n\t\n\tcreateContainerElement(){\n\t\tvar el = document.createElement(\"div\");\n\n\t\tel.classList.add(\"tabulator-footer-contents\");\n\n\t\tthis.element.appendChild(el);\n\n\t\treturn el;\n\t}\n\n\tinitializeElement(){\n\t\tif(this.table.options.footerElement){\n\n\t\t\tswitch(typeof this.table.options.footerElement){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tif(this.table.options.footerElement[0] === \"<\"){\n\t\t\t\t\t\tthis.containerElement.innerHTML = this.table.options.footerElement;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.external = true;\n\t\t\t\t\t\tthis.containerElement = document.querySelector(this.table.options.footerElement);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis.element = this.table.options.footerElement;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\n\tappend(element){\n\t\tthis.activate();\n\n\t\tthis.containerElement.appendChild(element);\n\t\tthis.table.rowManager.adjustTableSize();\n\t}\n\n\tprepend(element){\n\t\tthis.activate();\n\n\t\tthis.element.insertBefore(element, this.element.firstChild);\n\t\tthis.table.rowManager.adjustTableSize();\n\t}\n\n\tremove(element){\n\t\telement.parentNode.removeChild(element);\n\t\tthis.deactivate();\n\t}\n\n\tdeactivate(force){\n\t\tif(!this.element.firstChild || force){\n\t\t\tif(!this.external){\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t\tthis.active = false;\n\t\t}\n\t}\n\n\tactivate(){\n\t\tif(!this.active){\n\t\t\tthis.active = true;\n\t\t\tif(!this.external){\n\t\t\t\tthis.table.element.appendChild(this.getElement());\n\t\t\t\tthis.table.element.style.display = '';\n\t\t\t}\n\t\t}\n\t}\n\n\tredraw(){\n\t\tthis.dispatch(\"footer-redraw\");\n\t}\n}\n\nclass InteractionManager extends CoreFeature {\n\t\n\tconstructor (table){\n\t\tsuper(table);\n\t\t\n\t\tthis.el = null;\n\t\t\n\t\tthis.abortClasses = [\"tabulator-headers\", \"tabulator-table\"];\n\t\t\n\t\tthis.previousTargets = {};\n\t\t\n\t\tthis.listeners = [\n\t\t\t\"click\",\n\t\t\t\"dblclick\",\n\t\t\t\"contextmenu\",\n\t\t\t\"mouseenter\",\n\t\t\t\"mouseleave\",\n\t\t\t\"mouseover\",\n\t\t\t\"mouseout\",\n\t\t\t\"mousemove\",\n\t\t\t\"mouseup\",\n\t\t\t\"mousedown\",\n\t\t\t\"touchstart\",\n\t\t\t\"touchend\",\n\t\t];\n\t\t\n\t\tthis.componentMap = {\n\t\t\t\"tabulator-cell\":\"cell\",\n\t\t\t\"tabulator-row\":\"row\",\n\t\t\t\"tabulator-group\":\"group\",\n\t\t\t\"tabulator-col\":\"column\",\n\t\t};\n\t\t\n\t\tthis.pseudoTrackers = {\n\t\t\t\"row\":{\n\t\t\t\tsubscriber:null,\n\t\t\t\ttarget:null,\n\t\t\t},\n\t\t\t\"cell\":{\n\t\t\t\tsubscriber:null,\n\t\t\t\ttarget:null,\n\t\t\t},\n\t\t\t\"group\":{\n\t\t\t\tsubscriber:null,\n\t\t\t\ttarget:null,\n\t\t\t},\n\t\t\t\"column\":{\n\t\t\t\tsubscriber:null,\n\t\t\t\ttarget:null,\n\t\t\t},\n\t\t};\n\t\t\n\t\tthis.pseudoTracking = false;\n\t}\n\t\n\tinitialize(){\n\t\tthis.el = this.table.element;\n\t\t\n\t\tthis.buildListenerMap();\n\t\tthis.bindSubscriptionWatchers();\n\t}\n\t\n\tbuildListenerMap(){\n\t\tvar listenerMap = {};\n\t\t\n\t\tthis.listeners.forEach((listener) => {\n\t\t\tlistenerMap[listener] = {\n\t\t\t\thandler:null,\n\t\t\t\tcomponents:[],\n\t\t\t};\n\t\t});\n\t\t\n\t\tthis.listeners = listenerMap;\n\t}\n\t\n\tbindPseudoEvents(){\n\t\tObject.keys(this.pseudoTrackers).forEach((key) => {\n\t\t\tthis.pseudoTrackers[key].subscriber = this.pseudoMouseEnter.bind(this, key);\n\t\t\tthis.subscribe(key + \"-mouseover\", this.pseudoTrackers[key].subscriber);\n\t\t});\n\t\t\n\t\tthis.pseudoTracking = true;\n\t}\n\t\n\tpseudoMouseEnter(key, e, target){\n\t\tif(this.pseudoTrackers[key].target !== target){\n\t\t\t\n\t\t\tif(this.pseudoTrackers[key].target){\n\t\t\t\tthis.dispatch(key + \"-mouseleave\", e, this.pseudoTrackers[key].target);\n\t\t\t}\n\t\t\t\n\t\t\tthis.pseudoMouseLeave(key, e);\n\t\t\t\n\t\t\tthis.pseudoTrackers[key].target = target;\n\t\t\t\n\t\t\tthis.dispatch(key + \"-mouseenter\", e, target);\n\t\t}\n\t}\n\t\n\tpseudoMouseLeave(key, e){\n\t\tvar leaveList = Object.keys(this.pseudoTrackers),\n\t\tlinkedKeys = {\n\t\t\t\"row\":[\"cell\"],\n\t\t\t\"cell\":[\"row\"],\n\t\t};\n\t\t\n\t\tleaveList = leaveList.filter((item) => {\n\t\t\tvar links = linkedKeys[key];\n\t\t\treturn item !== key && (!links || (links && !links.includes(item)));\n\t\t});\n\t\t\n\t\t\n\t\tleaveList.forEach((key) => {\n\t\t\tvar target = this.pseudoTrackers[key].target;\n\t\t\t\n\t\t\tif(this.pseudoTrackers[key].target){\n\t\t\t\tthis.dispatch(key + \"-mouseleave\", e, target);\n\t\t\t\t\n\t\t\t\tthis.pseudoTrackers[key].target = null;\n\t\t\t}\n\t\t});\n\t}\n\t\n\t\n\tbindSubscriptionWatchers(){\n\t\tvar listeners = Object.keys(this.listeners),\n\t\tcomponents = Object.values(this.componentMap);\n\t\t\n\t\tfor(let comp of components){\n\t\t\tfor(let listener of listeners){\n\t\t\t\tlet key = comp + \"-\" + listener;\n\t\t\t\t\n\t\t\t\tthis.subscriptionChange(key, this.subscriptionChanged.bind(this, comp, listener));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.subscribe(\"table-destroy\", this.clearWatchers.bind(this));\n\t}\n\t\n\tsubscriptionChanged(component, key, added){\n\t\tvar listener = this.listeners[key].components,\n\t\tindex = listener.indexOf(component),\n\t\tchanged = false;\n\t\t\n\t\tif(added){\n\t\t\tif(index === -1){\n\t\t\t\tlistener.push(component);\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t}else {\n\t\t\tif(!this.subscribed(component + \"-\" + key)){\n\t\t\t\tif(index > -1){\n\t\t\t\t\tlistener.splice(index, 1);\n\t\t\t\t\tchanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif((key === \"mouseenter\" || key === \"mouseleave\") && !this.pseudoTracking){\n\t\t\tthis.bindPseudoEvents();\n\t\t}\n\t\t\n\t\tif(changed){\n\t\t\tthis.updateEventListeners();\n\t\t}\n\t}\n\t\n\tupdateEventListeners(){\n\t\tfor(let key in this.listeners){\n\t\t\tlet listener = this.listeners[key];\n\t\t\t\n\t\t\tif(listener.components.length){\n\t\t\t\tif(!listener.handler){\n\t\t\t\t\tlistener.handler = this.track.bind(this, key);\n\t\t\t\t\tthis.el.addEventListener(key, listener.handler);\n\t\t\t\t\t// this.el.addEventListener(key, listener.handler, {passive: true})\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(listener.handler){\n\t\t\t\t\tthis.el.removeEventListener(key, listener.handler);\n\t\t\t\t\tlistener.handler = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\ttrack(type, e){\n\t\tvar path = (e.composedPath && e.composedPath()) || e.path;\n\t\t\n\t\tvar targets = this.findTargets(path);\n\t\ttargets = this.bindComponents(type, targets);\n\t\t\n\t\tthis.triggerEvents(type, e, targets);\n\t\t\n\t\tif(this.pseudoTracking && (type == \"mouseover\" || type == \"mouseleave\") && !Object.keys(targets).length){\n\t\t\tthis.pseudoMouseLeave(\"none\", e);\n\t\t}\n\t}\n\t\n\tfindTargets(path){\n\t\tvar targets = {};\n\t\t\n\t\tlet componentMap = Object.keys(this.componentMap);\n\t\t\n\t\tfor (let el of path) {\n\t\t\tlet classList = el.classList ? [...el.classList] : [];\n\t\t\t\n\t\t\tlet abort = classList.filter((item) => {\n\t\t\t\treturn this.abortClasses.includes(item);\n\t\t\t});\n\t\t\t\n\t\t\tif(abort.length){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tlet elTargets = classList.filter((item) => {\n\t\t\t\treturn componentMap.includes(item);\n\t\t\t});\n\t\t\t\n\t\t\tfor (let target of elTargets) {\n\t\t\t\tif(!targets[this.componentMap[target]]){\n\t\t\t\t\ttargets[this.componentMap[target]] = el;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(targets.group && targets.group === targets.row){\n\t\t\tdelete targets.row;\n\t\t}\n\n\t\treturn targets;\n\t}\n\t\n\tbindComponents(type, targets){\n\t\t//ensure row component is looked up before cell\n\t\tvar keys = Object.keys(targets).reverse(),\n\t\tlistener = this.listeners[type],\n\t\tmatches = {},\n\t\toutput = {},\n\t\ttargetMatches = {};\n\t\n\t\tfor(let key of keys){\n\t\t\tlet component,\n\t\t\ttarget = targets[key],\n\t\t\tpreviousTarget = this.previousTargets[key];\n\t\t\t\n\t\t\tif(previousTarget && previousTarget.target === target){\n\t\t\t\tcomponent = previousTarget.component;\n\t\t\t}else {\n\t\t\t\tswitch(key){\n\t\t\t\t\tcase \"row\":\n\t\t\t\t\tcase \"group\":\n\t\t\t\t\t\tif(listener.components.includes(\"row\") || listener.components.includes(\"cell\") || listener.components.includes(\"group\")){\n\t\t\t\t\t\t\tlet rows = this.table.rowManager.getVisibleRows(true);\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tcomponent = rows.find((row) => {\n\t\t\t\t\t\t\t\treturn row.getElement() === target;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(targets[\"row\"] && targets[\"row\"].parentNode && targets[\"row\"].parentNode.closest(\".tabulator-row\")){\n\t\t\t\t\t\t\t\ttargets[key] = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"column\":\n\t\t\t\t\t\tif(listener.components.includes(\"column\")){\n\t\t\t\t\t\t\tcomponent = this.table.columnManager.findColumn(target);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"cell\":\n\t\t\t\t\t\tif(listener.components.includes(\"cell\")){\n\t\t\t\t\t\t\tif(matches[\"row\"] instanceof Row){\n\t\t\t\t\t\t\t\tcomponent = matches[\"row\"].findCell(target);\n\t\t\t\t\t\t\t}else {\t\n\t\t\t\t\t\t\t\tif(targets[\"row\"]){\n\t\t\t\t\t\t\t\t\tconsole.warn(\"Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(component){\n\t\t\t\tmatches[key] = component;\n\t\t\t\ttargetMatches[key] = {\n\t\t\t\t\ttarget:target,\n\t\t\t\t\tcomponent:component,\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.previousTargets = targetMatches;\n\n\t\t//reverse order keys are set in so events trigger in correct sequence\n\t\tObject.keys(targets).forEach((key) => {\n\t\t\tlet value = matches[key];\n\t\t\toutput[key] = value;\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\ttriggerEvents(type, e, targets){\n\t\tvar listener = this.listeners[type];\n\n\t\tfor(let key in targets){\n\t\t\tif(targets[key] && listener.components.includes(key)){\n\t\t\t\tthis.dispatch(key + \"-\" + type, e, targets[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tclearWatchers(){\n\t\tfor(let key in this.listeners){\n\t\t\tlet listener = this.listeners[key];\n\t\t\t\n\t\t\tif(listener.handler){\n\t\t\t\tthis.el.removeEventListener(key, listener.handler);\n\t\t\t\tlistener.handler = null;\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ComponentFunctionBinder{\n\n\tconstructor(table){\n\t\tthis.table = table;\n\n\t\tthis.bindings = {};\n\t}\n\n\tbind(type, funcName, handler){\n\t\tif(!this.bindings[type]){\n\t\t\tthis.bindings[type] = {};\n\t\t}\n\n\t\tif(this.bindings[type][funcName]){\n\t\t\tconsole.warn(\"Unable to bind component handler, a matching function name is already bound\", type, funcName, handler);\n\t\t}else {\n\t\t\tthis.bindings[type][funcName] = handler;\n\t\t}\n\t}\n\n\thandle(type, component, name){\n\t\tif(this.bindings[type] && this.bindings[type][name] && typeof this.bindings[type][name].bind === 'function'){\n\t\t\treturn this.bindings[type][name].bind(null, component);\n\t\t}else {\n\t\t\tif(name !== \"then\" && typeof name === \"string\" && !name.startsWith(\"_\")){\n\t\t\t\tif(this.table.options.debugInvalidComponentFuncs){\n\t\t\t\t\tconsole.error(\"The \" + type + \" component does not have a \" + name + \" function, have you checked that you have the correct Tabulator module installed?\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass DataLoader extends CoreFeature{\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.requestOrder = 0; //prevent requests coming out of sequence if overridden by another load request\n\t\tthis.loading = false;\n\t}\n\t\n\tinitialize(){}\n\t\n\tload(data, params, config, replace, silent, columnsChanged){\n\t\tvar requestNo = ++this.requestOrder;\n\n\t\tif(this.table.destroyed){\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\t\n\t\tthis.dispatchExternal(\"dataLoading\", data);\n\t\t\n\t\t//parse json data to array\n\t\tif (data && (data.indexOf(\"{\") == 0 || data.indexOf(\"[\") == 0)){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\t\n\t\tif(this.confirm(\"data-loading\", [data, params, config, silent])){\n\t\t\tthis.loading = true;\n\t\t\t\n\t\t\tif(!silent){\n\t\t\t\tthis.alertLoader();\n\t\t\t}\n\t\t\t\n\t\t\t//get params for request\n\t\t\tparams = this.chain(\"data-params\", [data, config, silent], params || {}, params || {});\n\t\t\t\n\t\t\tparams = this.mapParams(params, this.table.options.dataSendParams);\n\t\t\t\n\t\t\tvar result = this.chain(\"data-load\", [data, params, config, silent], false, Promise.resolve([]));\n\t\t\t\n\t\t\treturn result.then((response) => {\n\t\t\t\tif(!this.table.destroyed){\n\t\t\t\t\tif(!Array.isArray(response) && typeof response == \"object\"){\n\t\t\t\t\t\tresponse = this.mapParams(response, this.objectInvert(this.table.options.dataReceiveParams));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar rowData = this.chain(\"data-loaded\", [response], null, response);\n\t\t\t\t\t\n\t\t\t\t\tif(requestNo == this.requestOrder){\n\t\t\t\t\t\tthis.clearAlert();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(rowData !== false){\n\t\t\t\t\t\t\tthis.dispatchExternal(\"dataLoaded\", rowData);\n\t\t\t\t\t\t\tthis.table.rowManager.setData(rowData,  replace, typeof columnsChanged === \"undefined\" ? !replace : columnsChanged);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made\");\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Data Load Response Blocked - Table has been destroyed\");\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(\"Data Load Error: \", error);\n\t\t\t\tthis.dispatchExternal(\"dataLoadError\", error);\n\t\t\t\t\n\t\t\t\tif(!silent){\n\t\t\t\t\tthis.alertError();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.clearAlert();\n\t\t\t\t}, this.table.options.dataLoaderErrorTimeout);\n\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t});\n\t\t}else {\n\t\t\tthis.dispatchExternal(\"dataLoaded\", data);\n\t\t\t\n\t\t\tif(!data){\n\t\t\t\tdata = [];\n\t\t\t}\n\t\t\t\n\t\t\tthis.table.rowManager.setData(data, replace, typeof columnsChanged === \"undefined\" ? !replace : columnsChanged);\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\t\n\tmapParams(params, map){\n\t\tvar output = {};\n\t\t\n\t\tfor(let key in params){\n\t\t\toutput[map.hasOwnProperty(key) ? map[key] : key] = params[key];\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tobjectInvert(obj){\n\t\tvar output = {};\n\t\t\n\t\tfor(let key in obj){\n\t\t\toutput[obj[key]] = key;\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tblockActiveLoad(){\n\t\tthis.requestOrder++;\n\t}\n\t\n\talertLoader(){\n\t\tvar shouldLoad = typeof this.table.options.dataLoader === \"function\" ? this.table.options.dataLoader() : this.table.options.dataLoader;\n\t\t\n\t\tif(shouldLoad){\n\t\t\tthis.table.alertManager.alert(this.table.options.dataLoaderLoading || this.langText(\"data|loading\"));\n\t\t}\n\t}\n\t\n\talertError(){\n\t\tthis.table.alertManager.alert(this.table.options.dataLoaderError || this.langText(\"data|error\"), \"error\");\n\t}\n\t\n\tclearAlert(){\n\t\tthis.table.alertManager.clear();\n\t}\n}\n\nclass ExternalEventBus {\n\n\tconstructor(table, optionsList, debug){\n\t\tthis.table = table;\n\t\tthis.events = {};\n\t\tthis.optionsList = optionsList || {};\n\t\tthis.subscriptionNotifiers = {};\n\n\t\tthis.dispatch = debug ? this._debugDispatch.bind(this) : this._dispatch.bind(this);\n\t\tthis.debug = debug;\n\t}\n\n\tsubscriptionChange(key, callback){\n\t\tif(!this.subscriptionNotifiers[key]){\n\t\t\tthis.subscriptionNotifiers[key] = [];\n\t\t}\n\n\t\tthis.subscriptionNotifiers[key].push(callback);\n\n\t\tif(this.subscribed(key)){\n\t\t\tthis._notifySubscriptionChange(key, true);\n\t\t}\n\t}\n\n\tsubscribe(key, callback){\n\t\tif(!this.events[key]){\n\t\t\tthis.events[key] = [];\n\t\t}\n\n\t\tthis.events[key].push(callback);\n\n\t\tthis._notifySubscriptionChange(key, true);\n\t}\n\n\tunsubscribe(key, callback){\n\t\tvar index;\n\n\t\tif(this.events[key]){\n\t\t\tif(callback){\n\t\t\t\tindex = this.events[key].findIndex((item) => {\n\t\t\t\t\treturn item === callback;\n\t\t\t\t});\n\n\t\t\t\tif(index > -1){\n\t\t\t\t\tthis.events[key].splice(index, 1);\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Cannot remove event, no matching event found:\", key, callback);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tdelete this.events[key];\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Cannot remove event, no events set on:\", key);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._notifySubscriptionChange(key, false);\n\t}\n\n\tsubscribed(key){\n\t\treturn this.events[key] && this.events[key].length;\n\t}\n\n\t_notifySubscriptionChange(key, subscribed){\n\t\tvar notifiers = this.subscriptionNotifiers[key];\n\n\t\tif(notifiers){\n\t\t\tnotifiers.forEach((callback)=>{\n\t\t\t\tcallback(subscribed);\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatch(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args.shift(),\n\t\tresult;\n\n\t\tif(this.events[key]){\n\t\t\tthis.events[key].forEach((callback, i) => {\n\t\t\t\tlet callResult = callback.apply(this.table, args);\n\n\t\t\t\tif(!i){\n\t\t\t\t\tresult = callResult;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t_debugDispatch(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args[0];\n\n\t\targs[0] = \"ExternalEvent:\" + args[0];\n\n\t\tif(this.debug === true || this.debug.includes(key)){\n\t\t\tconsole.log(...args);\n\t\t}\n\n\t\treturn this._dispatch(...arguments);\n\t}\n}\n\nclass InternalEventBus {\n\n\tconstructor(debug){\n\t\tthis.events = {};\n\t\tthis.subscriptionNotifiers = {};\n\n\t\tthis.dispatch = debug ? this._debugDispatch.bind(this) : this._dispatch.bind(this);\n\t\tthis.chain = debug ? this._debugChain.bind(this) : this._chain.bind(this);\n\t\tthis.confirm = debug ? this._debugConfirm.bind(this) : this._confirm.bind(this);\n\t\tthis.debug = debug;\n\t}\n\n\tsubscriptionChange(key, callback){\n\t\tif(!this.subscriptionNotifiers[key]){\n\t\t\tthis.subscriptionNotifiers[key] = [];\n\t\t}\n\n\t\tthis.subscriptionNotifiers[key].push(callback);\n\n\t\tif(this.subscribed(key)){\n\t\t\tthis._notifySubscriptionChange(key, true);\n\t\t}\n\t}\n\n\tsubscribe(key, callback, priority = 10000){\n\t\tif(!this.events[key]){\n\t\t\tthis.events[key] = [];\n\t\t}\n\n\t\tthis.events[key].push({callback, priority});\n\n\t\tthis.events[key].sort((a, b) => {\n\t\t\treturn a.priority - b.priority;\n\t\t});\n\n\t\tthis._notifySubscriptionChange(key, true);\n\t}\n\n\tunsubscribe(key, callback){\n\t\tvar index;\n\n\t\tif(this.events[key]){\n\t\t\tif(callback){\n\t\t\t\tindex = this.events[key].findIndex((item) => {\n\t\t\t\t\treturn item.callback === callback;\n\t\t\t\t});\n\n\t\t\t\tif(index > -1){\n\t\t\t\t\tthis.events[key].splice(index, 1);\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Cannot remove event, no matching event found:\", key, callback);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Cannot remove event, no events set on:\", key);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._notifySubscriptionChange(key, false);\n\t}\n\n\tsubscribed(key){\n\t\treturn this.events[key] && this.events[key].length;\n\t}\n\n\t_chain(key, args, initialValue, fallback){\n\t\tvar value = initialValue;\n\n\t\tif(!Array.isArray(args)){\n\t\t\targs = [args];\n\t\t}\n\n\t\tif(this.subscribed(key)){\n\t\t\tthis.events[key].forEach((subscriber, i) => {\n\t\t\t\tvalue = subscriber.callback.apply(this, args.concat([value]));\n\t\t\t});\n\n\t\t\treturn value;\n\t\t}else {\n\t\t\treturn typeof fallback === \"function\" ? fallback() : fallback;\n\t\t}\n\t}\n\n\t_confirm(key, args){\n\t\tvar confirmed = false;\n\n\t\tif(!Array.isArray(args)){\n\t\t\targs = [args];\n\t\t}\n\n\t\tif(this.subscribed(key)){\n\t\t\tthis.events[key].forEach((subscriber, i) => {\n\t\t\t\tif(subscriber.callback.apply(this, args)){\n\t\t\t\t\tconfirmed = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn confirmed;\n\t}\n\n\t_notifySubscriptionChange(key, subscribed){\n\t\tvar notifiers = this.subscriptionNotifiers[key];\n\n\t\tif(notifiers){\n\t\t\tnotifiers.forEach((callback)=>{\n\t\t\t\tcallback(subscribed);\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatch(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args.shift();\n\n\t\tif(this.events[key]){\n\t\t\tthis.events[key].forEach((subscriber) => {\n\t\t\t\tsubscriber.callback.apply(this, args);\n\t\t\t});\n\t\t}\n\t}\n\n\t_debugDispatch(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args[0];\n\n\t\targs[0] = \"InternalEvent:\" + key;\n\n\t\tif(this.debug === true || this.debug.includes(key)){\n\t\t\tconsole.log(...args);\n\t\t}\n\n\t\treturn this._dispatch(...arguments);\n\t}\n\n\t_debugChain(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args[0];\n\n\t\targs[0] = \"InternalEvent:\" + key;\n\n\t\tif(this.debug === true || this.debug.includes(key)){\n\t\t\tconsole.log(...args);\n\t\t}\n\n\t\treturn this._chain(...arguments);\n\t}\n\n\t_debugConfirm(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args[0];\n\n\t\targs[0] = \"InternalEvent:\" + key;\n\n\t\tif(this.debug === true || this.debug.includes(key)){\n\t\t\tconsole.log(...args);\n\t\t}\n\n\t\treturn this._confirm(...arguments);\n\t}\n}\n\nclass DeprecationAdvisor extends CoreFeature{\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t}\n\t\n\t_warnUser(){\n\t\tif(this.options(\"debugDeprecation\")){\n\t\t\tconsole.warn(...arguments);\n\t\t}\n\t}\n\t\n\tcheck(oldOption, newOption, convert){\n\t\tvar msg = \"\";\n\t\t\n\t\tif(typeof this.options(oldOption) !== \"undefined\"){\n\t\t\tmsg = \"Deprecated Setup Option - Use of the %c\" + oldOption + \"%c option is now deprecated\";\n\t\t\t\n\t\t\tif(newOption){\n\t\t\t\tmsg = msg + \", Please use the %c\" + newOption + \"%c option instead\";\n\t\t\t\tthis._warnUser(msg, 'font-weight: bold;', 'font-weight: normal;', 'font-weight: bold;', 'font-weight: normal;');\n\n\t\t\t\tif(convert){\n\t\t\t\t\tthis.table.options[newOption] = this.table.options[oldOption];\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis._warnUser(msg, 'font-weight: bold;', 'font-weight: normal;');\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t}else {\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\tcheckMsg(oldOption, msg){\n\t\tif(typeof this.options(oldOption) !== \"undefined\"){\n\t\t\tthis._warnUser(\"%cDeprecated Setup Option - Use of the %c\" + oldOption + \" %c option is now deprecated, \" + msg, 'font-weight: normal;', 'font-weight: bold;', 'font-weight: normal;');\n\t\t\t\n\t\t\treturn false;\n\t\t}else {\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\tmsg(msg){\n\t\tthis._warnUser(msg);\n\t}\n}\n\nclass DependencyRegistry extends CoreFeature{\r\n\t\r\n\tconstructor(table){\r\n\t\tsuper(table);\r\n\t\t\r\n\t\tthis.deps = {};\r\n\t\t\r\n\t\tthis.props = {\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n\t\r\n\tinitialize(){\r\n\t\tthis.deps = Object.assign({}, this.options(\"dependencies\"));\r\n\t}\r\n\t\r\n\tlookup(key, prop, silent){\r\n\t\tif(Array.isArray(key)){\r\n\t\t\tfor (const item of key) {\r\n\t\t\t\tvar match = this.lookup(item, prop, true);\r\n\r\n\t\t\t\tif(match){\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(match){\r\n\t\t\t\treturn match;\r\n\t\t\t}else {\r\n\t\t\t\tthis.error(key);\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tif(prop){\r\n\t\t\t\treturn this.lookupProp(key, prop, silent);\r\n\t\t\t}else {\r\n\t\t\t\treturn this.lookupKey(key, silent);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tlookupProp(key, prop, silent){\r\n\t\tvar dependency;\r\n\t\t\r\n\t\tif(this.props[key] && this.props[key][prop]){\r\n\t\t\treturn this.props[key][prop];\r\n\t\t}else {\r\n\t\t\tdependency = this.lookupKey(key, silent);\r\n\t\t\t\r\n\t\t\tif(dependency){\r\n\t\t\t\tif(!this.props[key]){\r\n\t\t\t\t\tthis.props[key] = {};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.props[key][prop] = dependency[prop] || dependency;\r\n\t\t\t\treturn this.props[key][prop];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tlookupKey(key, silent){\r\n\t\tvar dependency;\r\n\t\t\r\n\t\tif(this.deps[key]){\r\n\t\t\tdependency = this.deps[key];\r\n\t\t}else if(window[key]){\r\n\t\t\tthis.deps[key] = window[key];\r\n\t\t\tdependency = this.deps[key];\r\n\t\t}else {\r\n\t\t\tif(!silent){\r\n\t\t\t\tthis.error(key);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn dependency;\r\n\t}\r\n\r\n\terror(key){\r\n\t\tconsole.error(\"Unable to find dependency\", key, \"Please check documentation and ensure you have imported the required library into your project\");\r\n\t}\r\n}\n\n//resize columns to fit data they contain\nfunction fitData(columns, forced){\n\tif(forced){\n\t\tthis.table.columnManager.renderer.reinitializeColumnWidths(columns);\n\t}\n\t\n\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\tthis.table.modules.responsiveLayout.update();\n\t}\n}\n\n//resize columns to fit data they contain and stretch row to fill table, also used for fitDataTable\nfunction fitDataGeneral(columns, forced){\n\tcolumns.forEach(function(column){\n\t\tcolumn.reinitializeWidth();\n\t});\n\n\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\tthis.table.modules.responsiveLayout.update();\n\t}\n}\n\n//resize columns to fit data the contain and stretch last column to fill table\nfunction fitDataStretch(columns, forced){\n\tvar colsWidth = 0,\n\ttableWidth = this.table.rowManager.element.clientWidth,\n\tgap = 0,\n\tlastCol = false;\n\n\tcolumns.forEach((column, i) => {\n\t\tif(!column.widthFixed){\n\t\t\tcolumn.reinitializeWidth();\n\t\t}\n\n\t\tif(this.table.options.responsiveLayout ? column.modules.responsive.visible : column.visible){\n\t\t\tlastCol = column;\n\t\t}\n\n\t\tif(column.visible){\n\t\t\tcolsWidth += column.getWidth();\n\t\t}\n\t});\n\n\tif(lastCol){\n\t\tgap = tableWidth - colsWidth + lastCol.getWidth();\n\n\t\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\t\tlastCol.setWidth(0);\n\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t}\n\n\t\tif(gap > 0){\n\t\t\tlastCol.setWidth(gap);\n\t\t}else {\n\t\t\tlastCol.reinitializeWidth();\n\t\t}\n\t}else {\n\t\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t}\n\t}\n}\n\n//resize columns to fit\nfunction fitColumns(columns, forced){\n\tvar totalWidth = this.table.rowManager.element.getBoundingClientRect().width; //table element width\n\tvar fixedWidth = 0; //total width of columns with a defined width\n\tvar flexWidth = 0; //total width available to flexible columns\n\tvar flexGrowUnits = 0; //total number of widthGrow blocks across all columns\n\tvar flexColWidth = 0; //desired width of flexible columns\n\tvar flexColumns = []; //array of flexible width columns\n\tvar fixedShrinkColumns = []; //array of fixed width columns that can shrink\n\tvar flexShrinkUnits = 0; //total number of widthShrink blocks across all columns\n\tvar overflowWidth = 0; //horizontal overflow width\n\tvar gapFill = 0; //number of pixels to be added to final column to close and half pixel gaps\n\n\tfunction calcWidth(width){\n\t\tvar colWidth;\n\n\t\tif(typeof(width) == \"string\"){\n\t\t\tif(width.indexOf(\"%\") > -1){\n\t\t\t\tcolWidth = (totalWidth / 100) * parseInt(width);\n\t\t\t}else {\n\t\t\t\tcolWidth = parseInt(width);\n\t\t\t}\n\t\t}else {\n\t\t\tcolWidth = width;\n\t\t}\n\n\t\treturn colWidth;\n\t}\n\n\t//ensure columns resize to take up the correct amount of space\n\tfunction scaleColumns(columns, freeSpace, colWidth, shrinkCols){\n\t\tvar oversizeCols = [],\n\t\toversizeSpace = 0,\n\t\tremainingSpace = 0,\n\t\tnextColWidth = 0,\n\t\tremainingFlexGrowUnits = flexGrowUnits,\n\t\tgap = 0,\n\t\tchangeUnits = 0,\n\t\tundersizeCols = [];\n\n\t\tfunction calcGrow(col){\n\t\t\treturn (colWidth * (col.column.definition.widthGrow || 1));\n\t\t}\n\n\t\tfunction calcShrink(col){\n\t\t\treturn  (calcWidth(col.width) - (colWidth * (col.column.definition.widthShrink || 0)));\n\t\t}\n\n\t\tcolumns.forEach(function(col, i){\n\t\t\tvar width = shrinkCols ? calcShrink(col) : calcGrow(col);\n\t\t\tif(col.column.minWidth >= width){\n\t\t\t\toversizeCols.push(col);\n\t\t\t}else {\n\t\t\t\tif(col.column.maxWidth && col.column.maxWidth < width){\n\t\t\t\t\tcol.width = col.column.maxWidth;\n\t\t\t\t\tfreeSpace -= col.column.maxWidth;\n\n\t\t\t\t\tremainingFlexGrowUnits -= shrinkCols ? (col.column.definition.widthShrink || 1) : (col.column.definition.widthGrow || 1);\n\n\t\t\t\t\tif(remainingFlexGrowUnits){\n\t\t\t\t\t\tcolWidth = Math.floor(freeSpace/remainingFlexGrowUnits);\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tundersizeCols.push(col);\n\t\t\t\t\tchangeUnits += shrinkCols ? (col.column.definition.widthShrink || 1) : (col.column.definition.widthGrow || 1);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(oversizeCols.length){\n\t\t\toversizeCols.forEach(function(col){\n\t\t\t\toversizeSpace += shrinkCols ?  col.width - col.column.minWidth : col.column.minWidth;\n\t\t\t\tcol.width = col.column.minWidth;\n\t\t\t});\n\n\t\t\tremainingSpace = freeSpace - oversizeSpace;\n\n\t\t\tnextColWidth = changeUnits ? Math.floor(remainingSpace/changeUnits) : remainingSpace;\n\n\t\t\tgap = scaleColumns(undersizeCols, remainingSpace, nextColWidth, shrinkCols);\n\t\t}else {\n\t\t\tgap = changeUnits ? freeSpace - (Math.floor(freeSpace/changeUnits) * changeUnits) : freeSpace;\n\n\t\t\tundersizeCols.forEach(function(column){\n\t\t\t\tcolumn.width = shrinkCols ? calcShrink(column) : calcGrow(column);\n\t\t\t});\n\t\t}\n\n\t\treturn gap;\n\t}\n\n\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\tthis.table.modules.responsiveLayout.update();\n\t}\n\n\t//adjust for vertical scrollbar if present\n\tif(this.table.rowManager.element.scrollHeight > this.table.rowManager.element.clientHeight){\n\t\ttotalWidth -= this.table.rowManager.element.offsetWidth - this.table.rowManager.element.clientWidth;\n\t}\n\n\tcolumns.forEach(function(column){\n\t\tvar width, minWidth, colWidth;\n\n\t\tif(column.visible){\n\n\t\t\twidth = column.definition.width;\n\t\t\tminWidth =  parseInt(column.minWidth);\n\n\t\t\tif(width){\n\n\t\t\t\tcolWidth = calcWidth(width);\n\n\t\t\t\tfixedWidth += colWidth > minWidth ? colWidth : minWidth;\n\n\t\t\t\tif(column.definition.widthShrink){\n\t\t\t\t\tfixedShrinkColumns.push({\n\t\t\t\t\t\tcolumn:column,\n\t\t\t\t\t\twidth:colWidth > minWidth ? colWidth : minWidth\n\t\t\t\t\t});\n\t\t\t\t\tflexShrinkUnits += column.definition.widthShrink;\n\t\t\t\t}\n\n\t\t\t}else {\n\t\t\t\tflexColumns.push({\n\t\t\t\t\tcolumn:column,\n\t\t\t\t\twidth:0,\n\t\t\t\t});\n\t\t\t\tflexGrowUnits += column.definition.widthGrow || 1;\n\t\t\t}\n\t\t}\n\t});\n\n\t//calculate available space\n\tflexWidth = totalWidth - fixedWidth;\n\n\t//calculate correct column size\n\tflexColWidth = Math.floor(flexWidth / flexGrowUnits);\n\n\t//generate column widths\n\tgapFill = scaleColumns(flexColumns, flexWidth, flexColWidth, false);\n\n\t//increase width of last column to account for rounding errors\n\tif(flexColumns.length && gapFill > 0){\n\t\tflexColumns[flexColumns.length-1].width += gapFill;\n\t}\n\n\t//calculate space for columns to be shrunk into\n\tflexColumns.forEach(function(col){\n\t\tflexWidth -= col.width;\n\t});\n\n\toverflowWidth = Math.abs(gapFill) + flexWidth;\n\n\t//shrink oversize columns if there is no available space\n\tif(overflowWidth > 0 && flexShrinkUnits){\n\t\tgapFill = scaleColumns(fixedShrinkColumns, overflowWidth, Math.floor(overflowWidth / flexShrinkUnits), true);\n\t}\n\n\t//decrease width of last column to account for rounding errors\n\tif(gapFill && fixedShrinkColumns.length){\n\t\tfixedShrinkColumns[fixedShrinkColumns.length-1].width -= gapFill;\n\t}\n\n\tflexColumns.forEach(function(col){\n\t\tcol.column.setWidth(col.width);\n\t});\n\n\tfixedShrinkColumns.forEach(function(col){\n\t\tcol.column.setWidth(col.width);\n\t});\n}\n\nvar defaultModes = {\n\tfitData:fitData,\n\tfitDataFill:fitDataGeneral,\n\tfitDataTable:fitDataGeneral,\n\tfitDataStretch:fitDataStretch,\n\tfitColumns:fitColumns ,\n};\n\nclass Layout extends Module{\n\n\tstatic moduleName = \"layout\";\n\n\t//load defaults\n\tstatic modes = defaultModes;\n\n\tconstructor(table){\n\t\tsuper(table, \"layout\");\n\n\t\tthis.mode = null;\n\n\t\tthis.registerTableOption(\"layout\", \"fitData\"); //layout type\n\t\tthis.registerTableOption(\"layoutColumnsOnNewData\", false); //update column widths on setData\n\n\t\tthis.registerColumnOption(\"widthGrow\");\n\t\tthis.registerColumnOption(\"widthShrink\");\n\t}\n\n\t//initialize layout system\n\tinitialize(){\n\t\tvar layout = this.table.options.layout;\n\n\t\tif(Layout.modes[layout]){\n\t\t\tthis.mode = layout;\n\t\t}else {\n\t\t\tconsole.warn(\"Layout Error - invalid mode set, defaulting to 'fitData' : \" + layout);\n\t\t\tthis.mode = 'fitData';\n\t\t}\n\n\t\tthis.table.element.setAttribute(\"tabulator-layout\", this.mode);\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t}\n\n\tinitializeColumn(column){\n\t\tif(column.definition.widthGrow){\n\t\t\tcolumn.definition.widthGrow = Number(column.definition.widthGrow);\n\t\t}\n\t\tif(column.definition.widthShrink){\n\t\t\tcolumn.definition.widthShrink = Number(column.definition.widthShrink);\n\t\t}\n\t}\n\n\tgetMode(){\n\t\treturn this.mode;\n\t}\n\n\t//trigger table layout\n\tlayout(dataChanged){\n\n\t\tvar variableHeight = this.table.columnManager.columnsByIndex.find((column) => column.definition.variableHeight || column.definition.formatter === \"textarea\");\n\t\t\n\t\tthis.dispatch(\"layout-refreshing\");\n\t\tLayout.modes[this.mode].call(this, this.table.columnManager.columnsByIndex, dataChanged);\n\n\t\tif(variableHeight){\n\t\t\tthis.table.rowManager.normalizeHeight(true);\n\t\t}\n\n\t\tthis.dispatch(\"layout-refreshed\");\n\t}\n}\n\nvar defaultLangs = {\n\t\"default\":{ //hold default locale text\n\t\t\"groups\":{\n\t\t\t\"item\":\"item\",\n\t\t\t\"items\":\"items\",\n\t\t},\n\t\t\"columns\":{\n\t\t},\n\t\t\"data\":{\n\t\t\t\"loading\":\"Loading\",\n\t\t\t\"error\":\"Error\",\n\t\t},\n\t\t\"pagination\":{\n\t\t\t\"page_size\":\"Page Size\",\n\t\t\t\"page_title\":\"Show Page\",\n\t\t\t\"first\":\"First\",\n\t\t\t\"first_title\":\"First Page\",\n\t\t\t\"last\":\"Last\",\n\t\t\t\"last_title\":\"Last Page\",\n\t\t\t\"prev\":\"Prev\",\n\t\t\t\"prev_title\":\"Prev Page\",\n\t\t\t\"next\":\"Next\",\n\t\t\t\"next_title\":\"Next Page\",\n\t\t\t\"all\":\"All\",\n\t\t\t\"counter\":{\n\t\t\t\t\"showing\": \"Showing\",\n\t\t\t\t\"of\": \"of\",\n\t\t\t\t\"rows\": \"rows\",\n\t\t\t\t\"pages\": \"pages\",\n\t\t\t}\n\t\t},\n\t\t\"headerFilters\":{\n\t\t\t\"default\":\"filter column...\",\n\t\t\t\"columns\":{}\n\t\t}\n\t},\n};\n\nclass Localize extends Module{\n\n\tstatic moduleName = \"localize\";\n\n\t//load defaults\n\tstatic langs = defaultLangs;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.locale = \"default\"; //current locale\n\t\tthis.lang = false; //current language\n\t\tthis.bindings = {}; //update events to call when locale is changed\n\t\tthis.langList = {};\n\n\t\tthis.registerTableOption(\"locale\", false); //current system language\n\t\tthis.registerTableOption(\"langs\", {});\n\t}\n\n\tinitialize(){\n\t\tthis.langList = Helpers.deepClone(Localize.langs);\n\n\t\tif(this.table.options.columnDefaults.headerFilterPlaceholder !== false){\n\t\t\tthis.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);\n\t\t}\n\n\t\tfor(let locale in this.table.options.langs){\n\t\t\tthis.installLang(locale, this.table.options.langs[locale]);\n\t\t}\n\n\t\tthis.setLocale(this.table.options.locale);\n\n\t\tthis.registerTableFunction(\"setLocale\", this.setLocale.bind(this));\n\t\tthis.registerTableFunction(\"getLocale\", this.getLocale.bind(this));\n\t\tthis.registerTableFunction(\"getLang\", this.getLang.bind(this));\n\t}\n\n\t//set header placeholder\n\tsetHeaderFilterPlaceholder(placeholder){\n\t\tthis.langList.default.headerFilters.default = placeholder;\n\t}\n\n\t//setup a lang description object\n\tinstallLang(locale, lang){\n\t\tif(this.langList[locale]){\n\t\t\tthis._setLangProp(this.langList[locale], lang);\n\t\t}else {\n\t\t\tthis.langList[locale] = lang;\n\t\t}\n\t}\n\n\t_setLangProp(lang, values){\n\t\tfor(let key in values){\n\t\t\tif(lang[key] && typeof lang[key] == \"object\"){\n\t\t\t\tthis._setLangProp(lang[key], values[key]);\n\t\t\t}else {\n\t\t\t\tlang[key] = values[key];\n\t\t\t}\n\t\t}\n\t}\n\n\t//set current locale\n\tsetLocale(desiredLocale){\n\t\tdesiredLocale = desiredLocale || \"default\";\n\n\t\t//fill in any matching language values\n\t\tfunction traverseLang(trans, path){\n\t\t\tfor(var prop in trans){\n\t\t\t\tif(typeof trans[prop] == \"object\"){\n\t\t\t\t\tif(!path[prop]){\n\t\t\t\t\t\tpath[prop] = {};\n\t\t\t\t\t}\n\t\t\t\t\ttraverseLang(trans[prop], path[prop]);\n\t\t\t\t}else {\n\t\t\t\t\tpath[prop] = trans[prop];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//determining correct locale to load\n\t\tif(desiredLocale === true && navigator.language){\n\t\t\t//get local from system\n\t\t\tdesiredLocale = navigator.language.toLowerCase();\n\t\t}\n\n\t\tif(desiredLocale){\n\t\t\t//if locale is not set, check for matching top level locale else use default\n\t\t\tif(!this.langList[desiredLocale]){\n\t\t\t\tlet prefix = desiredLocale.split(\"-\")[0];\n\n\t\t\t\tif(this.langList[prefix]){\n\t\t\t\t\tconsole.warn(\"Localization Error - Exact matching locale not found, using closest match: \", desiredLocale, prefix);\n\t\t\t\t\tdesiredLocale = prefix;\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Localization Error - Matching locale not found, using default: \", desiredLocale);\n\t\t\t\t\tdesiredLocale = \"default\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.locale = desiredLocale;\n\n\t\t//load default lang template\n\t\tthis.lang = Helpers.deepClone(this.langList.default || {});\n\n\t\tif(desiredLocale != \"default\"){\n\t\t\ttraverseLang(this.langList[desiredLocale], this.lang);\n\t\t}\n\n\t\tthis.dispatchExternal(\"localized\", this.locale, this.lang);\n\n\t\tthis._executeBindings();\n\t}\n\n\t//get current locale\n\tgetLocale(locale){\n\t\treturn this.locale;\n\t}\n\n\t//get lang object for given local or current if none provided\n\tgetLang(locale){\n\t\treturn locale ? this.langList[locale] : this.lang;\n\t}\n\n\t//get text for current locale\n\tgetText(path, value){\n\t\tvar fillPath = value ? path + \"|\" + value : path,\n\t\tpathArray = fillPath.split(\"|\"),\n\t\ttext = this._getLangElement(pathArray, this.locale);\n\n\t\t// if(text === false){\n\t\t// \tconsole.warn(\"Localization Error - Matching localized text not found for given path: \", path);\n\t\t// }\n\n\t\treturn text || \"\";\n\t}\n\n\t//traverse langs object and find localized copy\n\t_getLangElement(path, locale){\n\t\tvar root = this.lang;\n\n\t\tpath.forEach(function(level){\n\t\t\tvar rootPath;\n\n\t\t\tif(root){\n\t\t\t\trootPath = root[level];\n\n\t\t\t\tif(typeof rootPath != \"undefined\"){\n\t\t\t\t\troot = rootPath;\n\t\t\t\t}else {\n\t\t\t\t\troot = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn root;\n\t}\n\n\t//set update binding\n\tbind(path, callback){\n\t\tif(!this.bindings[path]){\n\t\t\tthis.bindings[path] = [];\n\t\t}\n\n\t\tthis.bindings[path].push(callback);\n\n\t\tcallback(this.getText(path), this.lang);\n\t}\n\n\t//iterate through bindings and trigger updates\n\t_executeBindings(){\n\t\tfor(let path in this.bindings){\n\t\t\tthis.bindings[path].forEach((binding) => {\n\t\t\t\tbinding(this.getText(path), this.lang);\n\t\t\t});\n\t\t}\n\t}\n}\n\nclass Comms extends Module{\n\n\tstatic moduleName = \"comms\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\t}\n\n\tinitialize(){\n\t\tthis.registerTableFunction(\"tableComms\", this.receive.bind(this));\n\t}\n\n\tgetConnections(selectors){\n\t\tvar connections = [],\n\t\tconnection;\n\n\t\tconnection = this.table.constructor.registry.lookupTable(selectors);\n\n\t\tconnection.forEach((con) =>{\n\t\t\tif(this.table !== con){\n\t\t\t\tconnections.push(con);\n\t\t\t}\n\t\t});\n\n\t\treturn connections;\n\t}\n\n\tsend(selectors, module, action, data){\n\t\tvar connections = this.getConnections(selectors);\n\n\t\tconnections.forEach((connection) => {\n\t\t\tconnection.tableComms(this.table.element, module, action, data);\n\t\t});\n\n\t\tif(!connections.length && selectors){\n\t\t\tconsole.warn(\"Table Connection Error - No tables matching selector found\", selectors);\n\t\t}\n\t}\n\n\treceive(table, module, action, data){\n\t\tif(this.table.modExists(module)){\n\t\t\treturn this.table.modules[module].commsReceived(table, action, data);\n\t\t}else {\n\t\t\tconsole.warn(\"Inter-table Comms Error - no such module:\", module);\n\t\t}\n\t}\n}\n\nvar coreModules = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tCommsModule: Comms,\n\tLayoutModule: Layout,\n\tLocalizeModule: Localize\n});\n\nclass TableRegistry {\n\tstatic registry = {\n\t\ttables:[],\n\t\t\n\t\tregister(table){\n\t\t\tTableRegistry.registry.tables.push(table);\n\t\t},\n\t\t\n\t\tderegister(table){\n\t\t\tvar index = TableRegistry.registry.tables.indexOf(table);\n\t\t\t\n\t\t\tif(index > -1){\n\t\t\t\tTableRegistry.registry.tables.splice(index, 1);\n\t\t\t}\n\t\t},\n\t\t\n\t\tlookupTable(query, silent){\n\t\t\tvar results = [],\n\t\t\tmatches, match;\n\t\t\t\n\t\t\tif(typeof query === \"string\"){\n\t\t\t\tmatches = document.querySelectorAll(query);\n\t\t\t\t\n\t\t\t\tif(matches.length){\n\t\t\t\t\tfor(var i = 0; i < matches.length; i++){\n\t\t\t\t\t\tmatch = TableRegistry.registry.matchElement(matches[i]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(match){\n\t\t\t\t\t\t\tresults.push(match);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else if((typeof HTMLElement !== \"undefined\" && query instanceof HTMLElement) || query instanceof TableRegistry){\n\t\t\t\tmatch = TableRegistry.registry.matchElement(query);\n\t\t\t\t\n\t\t\t\tif(match){\n\t\t\t\t\tresults.push(match);\n\t\t\t\t}\n\t\t\t}else if(Array.isArray(query)){\n\t\t\t\tquery.forEach(function(item){\n\t\t\t\t\tresults = results.concat(TableRegistry.registry.lookupTable(item));\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tif(!silent){\n\t\t\t\t\tconsole.warn(\"Table Connection Error - Invalid Selector\", query);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn results;\n\t\t},\n\t\t\n\t\tmatchElement(element){\n\t\t\treturn TableRegistry.registry.tables.find(function(table){\n\t\t\t\treturn element instanceof TableRegistry ? table === element : table.element === element;\n\t\t\t});\n\t\t}\n\t};\n\n\t\t\n\tstatic findTable(query){\n\t\tvar results = TableRegistry.registry.lookupTable(query, true);\n\t\treturn Array.isArray(results) && !results.length ? false : results;\n\t}\n}\n\nclass ModuleBinder extends TableRegistry {\n\t\n\tstatic moduleBindings = {};\n\tstatic moduleExtensions = {};\n\tstatic modulesRegistered = false;\n\t\n\tstatic defaultModules = false;\n\t\n\tconstructor(){\n\t\tsuper();\n\t}\n\t\n\tstatic initializeModuleBinder(defaultModules){\n\t\tif(!ModuleBinder.modulesRegistered){\n\t\t\tModuleBinder.modulesRegistered = true;\n\t\t\tModuleBinder._registerModules(coreModules, true);\n\t\t\t\n\t\t\tif(defaultModules){\n\t\t\t\tModuleBinder._registerModules(defaultModules);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tstatic _extendModule(name, property, values){\n\t\tif(ModuleBinder.moduleBindings[name]){\n\t\t\tvar source = ModuleBinder.moduleBindings[name][property];\n\t\t\t\n\t\t\tif(source){\n\t\t\t\tif(typeof values == \"object\"){\n\t\t\t\t\tfor(let key in values){\n\t\t\t\t\t\tsource[key] = values[key];\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Module Error - Invalid value type, it must be an object\");\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Module Error - property does not exist:\", property);\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Module Error - module does not exist:\", name);\n\t\t}\n\t}\n\t\n\tstatic _registerModules(modules, core){\n\t\tvar mods = Object.values(modules);\n\t\t\n\t\tif(core){\n\t\t\tmods.forEach((mod) => {\n\t\t\t\tmod.prototype.moduleCore = true;\n\t\t\t});\n\t\t}\n\t\t\n\t\tModuleBinder._registerModule(mods);\n\t}\n\t\n\tstatic _registerModule(modules){\n\t\tif(!Array.isArray(modules)){\n\t\t\tmodules = [modules];\n\t\t}\n\t\t\n\t\tmodules.forEach((mod) => {\n\t\t\tModuleBinder._registerModuleBinding(mod);\n\t\t\tModuleBinder._registerModuleExtensions(mod);\n\t\t});\n\t}\n\t\n\tstatic _registerModuleBinding(mod){\n\t\tif(mod.moduleName){\n\t\t\tModuleBinder.moduleBindings[mod.moduleName] = mod;\n\t\t}else {\n\t\t\tconsole.error(\"Unable to bind module, no moduleName defined\", mod.moduleName);\n\t\t}\n\t}\n\t\n\tstatic _registerModuleExtensions(mod){\n\t\tvar extensions = mod.moduleExtensions;\n\t\t\n\t\tif(mod.moduleExtensions){\n\t\t\tfor (let modKey in extensions) {\n\t\t\t\tlet ext = extensions[modKey];\n\t\t\t\t\n\t\t\t\tif(ModuleBinder.moduleBindings[modKey]){\n\t\t\t\t\tfor (let propKey in ext) {\n\t\t\t\t\t\tModuleBinder._extendModule(modKey, propKey, ext[propKey]);\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tif(!ModuleBinder.moduleExtensions[modKey]){\n\t\t\t\t\t\tModuleBinder.moduleExtensions[modKey] = {};\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tfor (let propKey in ext) {\n\t\t\t\t\t\tif(!ModuleBinder.moduleExtensions[modKey][propKey]){\n\t\t\t\t\t\t\tModuleBinder.moduleExtensions[modKey][propKey] = {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tObject.assign(ModuleBinder.moduleExtensions[modKey][propKey], ext[propKey]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tModuleBinder._extendModuleFromQueue(mod);\n\t}\n\t\n\tstatic _extendModuleFromQueue(mod){\n\t\tvar extensions = ModuleBinder.moduleExtensions[mod.moduleName];\n\t\t\n\t\tif(extensions){\n\t\t\tfor (let propKey in extensions) {\n\t\t\t\tModuleBinder._extendModule(mod.moduleName, propKey, extensions[propKey]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//ensure that module are bound to instantiated function\n\t_bindModules(){\n\t\tvar orderedStartMods = [],\n\t\torderedEndMods = [],\n\t\tunOrderedMods = [];\n\t\t\n\t\tthis.modules = {};\n\t\t\n\t\tfor(var name in ModuleBinder.moduleBindings){\n\t\t\tlet mod = ModuleBinder.moduleBindings[name];\n\t\t\tlet module = new mod(this);\n\t\t\t\n\t\t\tthis.modules[name] = module;\n\t\t\t\n\t\t\tif(mod.prototype.moduleCore){\n\t\t\t\tthis.modulesCore.push(module);\n\t\t\t}else {\n\t\t\t\tif(mod.moduleInitOrder){\n\t\t\t\t\tif(mod.moduleInitOrder < 0){\n\t\t\t\t\t\torderedStartMods.push(module);\n\t\t\t\t\t}else {\n\t\t\t\t\t\torderedEndMods.push(module);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}else {\n\t\t\t\t\tunOrderedMods.push(module);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\torderedStartMods.sort((a, b) => a.moduleInitOrder > b.moduleInitOrder ? 1 : -1);\n\t\torderedEndMods.sort((a, b) => a.moduleInitOrder > b.moduleInitOrder ? 1 : -1);\n\t\t\n\t\tthis.modulesRegular = orderedStartMods.concat(unOrderedMods.concat(orderedEndMods));\n\t}\n}\n\nclass Alert extends CoreFeature{\n\tconstructor(table){\n\t\tsuper(table);\n        \n\t\tthis.element = this._createAlertElement();\n\t\tthis.msgElement = this._createMsgElement();\n\t\tthis.type = null;\n        \n\t\tthis.element.appendChild(this.msgElement);\n\t}\n    \n\t_createAlertElement(){\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-alert\");\n\t\treturn el;\n\t}\n    \n\t_createMsgElement(){\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-alert-msg\");\n\t\tel.setAttribute(\"role\", \"alert\");\n\t\treturn el;\n\t}\n    \n\t_typeClass(){\n\t\treturn \"tabulator-alert-state-\" + this.type;\n\t}\n    \n\talert(content, type = \"msg\"){\n\t\tif(content){\n\t\t\tthis.clear();\n\n\t\t\tthis.dispatch(\"alert-show\", type);\n            \n\t\t\tthis.type = type;\n            \n\t\t\twhile(this.msgElement.firstChild) this.msgElement.removeChild(this.msgElement.firstChild);\n            \n\t\t\tthis.msgElement.classList.add(this._typeClass());\n            \n\t\t\tif(typeof content === \"function\"){\n\t\t\t\tcontent = content();\n\t\t\t}\n            \n\t\t\tif(content instanceof HTMLElement){\n\t\t\t\tthis.msgElement.appendChild(content);\n\t\t\t}else {\n\t\t\t\tthis.msgElement.innerHTML = content;\n\t\t\t}\n            \n\t\t\tthis.table.element.appendChild(this.element);\n\t\t}\n\t}\n    \n\tclear(){\n\t\tthis.dispatch(\"alert-hide\", this.type);\n\n\t\tif(this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n        \n\t\tthis.msgElement.classList.remove(this._typeClass());\n\t}\n}\n\nclass Tabulator extends ModuleBinder{\n\n\t//default setup options\n\tstatic defaultOptions = defaultOptions;\n\n\tstatic extendModule(){\n\t\tTabulator.initializeModuleBinder();\n\t\tTabulator._extendModule(...arguments);\n\t}\n\n\tstatic registerModule(){\n\t\tTabulator.initializeModuleBinder();\n\t\tTabulator._registerModule(...arguments);\n\t}\n\n\tconstructor(element, options, modules){\n\t\tsuper();\n\n\t\tTabulator.initializeModuleBinder(modules);\n\n\t\tthis.options = {};\n\t\t\n\t\tthis.columnManager = null; // hold Column Manager\n\t\tthis.rowManager = null; //hold Row Manager\n\t\tthis.footerManager = null; //holder Footer Manager\n\t\tthis.alertManager = null; //hold Alert Manager\n\t\tthis.vdomHoz  = null; //holder horizontal virtual dom\n\t\tthis.externalEvents = null; //handle external event messaging\n\t\tthis.eventBus = null; //handle internal event messaging\n\t\tthis.interactionMonitor = false; //track user interaction\n\t\tthis.browser = \"\"; //hold current browser type\n\t\tthis.browserSlow = false; //handle reduced functionality for slower browsers\n\t\tthis.browserMobile = false; //check if running on mobile, prevent resize cancelling edit on keyboard appearance\n\t\tthis.rtl = false; //check if the table is in RTL mode\n\t\tthis.originalElement = null; //hold original table element if it has been replaced\n\t\t\n\t\tthis.componentFunctionBinder = new ComponentFunctionBinder(this); //bind component functions\n\t\tthis.dataLoader = false; //bind component functions\n\t\t\n\t\tthis.modules = {}; //hold all modules bound to this table\n\t\tthis.modulesCore = []; //hold core modules bound to this table (for initialization purposes)\n\t\tthis.modulesRegular = []; //hold regular modules bound to this table (for initialization purposes)\n\t\t\n\t\tthis.deprecationAdvisor = new DeprecationAdvisor(this);\n\t\tthis.optionsList = new OptionsList(this, \"table constructor\");\n\n\t\tthis.dependencyRegistry = new DependencyRegistry(this);\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.destroyed = false;\n\t\t\n\t\tif(this.initializeElement(element)){\n\t\t\t\n\t\t\tthis.initializeCoreSystems(options);\n\t\t\t\n\t\t\t//delay table creation to allow event bindings immediately after the constructor\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._create();\n\t\t\t});\n\t\t}\n\t\t\n\t\tthis.constructor.registry.register(this); //register table for inter-device communication\n\t}\n\t\n\tinitializeElement(element){\n\t\tif(typeof HTMLElement !== \"undefined\" && element instanceof HTMLElement){\n\t\t\tthis.element = element;\n\t\t\treturn true;\n\t\t}else if(typeof element === \"string\"){\n\t\t\tthis.element = document.querySelector(element);\n\t\t\t\n\t\t\tif(this.element){\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tconsole.error(\"Tabulator Creation Error - no element found matching selector: \", element);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.error(\"Tabulator Creation Error - Invalid element provided:\", element);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tinitializeCoreSystems(options){\n\t\tthis.columnManager = new ColumnManager(this);\n\t\tthis.rowManager = new RowManager(this);\n\t\tthis.footerManager = new FooterManager(this);\n\t\tthis.dataLoader = new DataLoader(this);\n\t\tthis.alertManager = new Alert(this);\n\t\t\n\t\tthis._bindModules();\n\t\t\n\t\tthis.options = this.optionsList.generate(Tabulator.defaultOptions, options);\n\t\t\n\t\tthis._clearObjectPointers();\n\t\t\n\t\tthis._mapDeprecatedFunctionality();\n\t\t\n\t\tthis.externalEvents = new ExternalEventBus(this, this.options, this.options.debugEventsExternal);\n\t\tthis.eventBus = new InternalEventBus(this.options.debugEventsInternal);\n\t\t\n\t\tthis.interactionMonitor = new InteractionManager(this);\n\t\t\n\t\tthis.dataLoader.initialize();\n\t\tthis.footerManager.initialize();\n\n\t\tthis.dependencyRegistry.initialize();\n\t}\n\t\n\t//convert deprecated functionality to new functions\n\t_mapDeprecatedFunctionality(){\n\t\t//all previously deprecated functionality removed in the 6.0 release\n\t}\n\t\n\t_clearSelection(){\n\t\t\n\t\tthis.element.classList.add(\"tabulator-block-select\");\n\t\t\n\t\tif (window.getSelection) {\n\t\t\tif (window.getSelection().empty) {  // Chrome\n\t\t\t\twindow.getSelection().empty();\n\t\t\t} else if (window.getSelection().removeAllRanges) {  // Firefox\n\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t}\n\t\t} else if (document.selection) {  // IE?\n\t\t\tdocument.selection.empty();\n\t\t}\n\t\t\n\t\tthis.element.classList.remove(\"tabulator-block-select\");\n\t}\n\t\n\t//create table\n\t_create(){\n\t\tthis.externalEvents.dispatch(\"tableBuilding\");\n\t\tthis.eventBus.dispatch(\"table-building\");\n\t\t\n\t\tthis._rtlCheck();\n\t\t\n\t\tthis._buildElement();\n\t\t\n\t\tthis._initializeTable();\n\n\t\tthis.initialized = true;\n\t\t\n\t\tthis._loadInitialData()\n\t\t\t.finally(() => {\n\t\t\t\tthis.eventBus.dispatch(\"table-initialized\");\n\t\t\t\tthis.externalEvents.dispatch(\"tableBuilt\");\n\t\t\t});\t\n\t}\n\t\n\t_rtlCheck(){\n\t\tvar style = window.getComputedStyle(this.element);\n\t\t\n\t\tswitch(this.options.textDirection){\n\t\t\tcase\"auto\":\n\t\t\t\tif(style.direction !== \"rtl\"){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\n\t\t\tcase \"rtl\":\n\t\t\t\tthis.element.classList.add(\"tabulator-rtl\");\n\t\t\t\tthis.rtl = true;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"ltr\":\n\t\t\t\tthis.element.classList.add(\"tabulator-ltr\");\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tthis.rtl = false;\n\t\t}\n\t}\n\t\n\t//clear pointers to objects in default config object\n\t_clearObjectPointers(){\n\t\tthis.options.columns = this.options.columns.slice(0);\n\t\t\n\t\tif(Array.isArray(this.options.data) && !this.options.reactiveData){\n\t\t\tthis.options.data = this.options.data.slice(0);\n\t\t}\n\t}\n\t\n\t//build tabulator element\n\t_buildElement(){\n\t\tvar element = this.element,\n\t\toptions = this.options,\n\t\tnewElement;\n\t\t\n\t\tif(element.tagName === \"TABLE\"){\n\t\t\tthis.originalElement = this.element;\n\t\t\tnewElement = document.createElement(\"div\");\n\t\t\t\n\t\t\t//transfer attributes to new element\n\t\t\tvar attributes = element.attributes;\n\t\t\t\n\t\t\t// loop through attributes and apply them on div\n\t\t\tfor(var i in attributes){\n\t\t\t\tif(typeof attributes[i] == \"object\"){\n\t\t\t\t\tnewElement.setAttribute(attributes[i].name, attributes[i].value);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// replace table with div element\n\t\t\telement.parentNode.replaceChild(newElement, element);\n\t\t\t\n\t\t\tthis.element = element = newElement;\n\t\t}\n\t\t\n\t\telement.classList.add(\"tabulator\");\n\t\telement.setAttribute(\"role\", \"grid\");\n\t\t\n\t\t//empty element\n\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\t\t\n\t\t//set table height\n\t\tif(options.height){\n\t\t\toptions.height = isNaN(options.height) ? options.height : options.height + \"px\";\n\t\t\telement.style.height = options.height;\n\t\t}\n\t\t\n\t\t//set table min height\n\t\tif(options.minHeight !== false){\n\t\t\toptions.minHeight = isNaN(options.minHeight) ? options.minHeight : options.minHeight + \"px\";\n\t\t\telement.style.minHeight = options.minHeight;\n\t\t}\n\t\t\n\t\t//set table maxHeight\n\t\tif(options.maxHeight !== false){\n\t\t\toptions.maxHeight = isNaN(options.maxHeight) ? options.maxHeight : options.maxHeight + \"px\";\n\t\t\telement.style.maxHeight = options.maxHeight;\n\t\t}\n\t}\n\t\n\t//initialize core systems and modules\n\t_initializeTable(){\n\t\tvar element = this.element,\n\t\toptions = this.options;\n\t\t\n\t\tthis.interactionMonitor.initialize();\n\t\t\n\t\tthis.columnManager.initialize();\n\t\tthis.rowManager.initialize();\n\t\t\n\t\tthis._detectBrowser();\n\t\t\n\t\t//initialize core modules\n\t\tthis.modulesCore.forEach((mod) => {\n\t\t\tmod.initialize();\n\t\t});\n\t\t\n\t\t//build table elements\n\t\telement.appendChild(this.columnManager.getElement());\n\t\telement.appendChild(this.rowManager.getElement());\n\t\t\n\t\tif(options.footerElement){\n\t\t\tthis.footerManager.activate();\n\t\t}\n\t\t\n\t\tif(options.autoColumns && options.data){\n\t\t\t\n\t\t\tthis.columnManager.generateColumnsFromRowData(this.options.data);\n\t\t}\n\t\t\n\t\t//initialize regular modules\n\t\tthis.modulesRegular.forEach((mod) => {\n\t\t\tmod.initialize();\n\t\t});\n\t\t\n\t\tthis.columnManager.setColumns(options.columns);\n\t\t\n\t\tthis.eventBus.dispatch(\"table-built\");\n\t}\n\t\n\t_loadInitialData(){\n\t\treturn this.dataLoader.load(this.options.data)\n\t\t\t.finally(() => {\n\t\t\t\tthis.columnManager.verticalAlignHeaders();\n\t\t\t});\t\t\n\t}\n\t\n\t//deconstructor\n\tdestroy(){\n\t\tvar element = this.element;\n\t\t\n\t\tthis.destroyed = true;\n\t\t\n\t\tthis.constructor.registry.deregister(this); //deregister table from inter-device communication\n\t\t\n\t\tthis.eventBus.dispatch(\"table-destroy\");\n\t\t\n\t\t//clear row data\n\t\tthis.rowManager.destroy();\n\t\t\n\t\t//clear DOM\n\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\t\telement.classList.remove(\"tabulator\");\n\n\t\tthis.externalEvents.dispatch(\"tableDestroyed\");\n\t}\n\t\n\t_detectBrowser(){\n\t\tvar ua = navigator.userAgent||navigator.vendor||window.opera;\n\t\t\n\t\tif(ua.indexOf(\"Trident\") > -1){\n\t\t\tthis.browser = \"ie\";\n\t\t\tthis.browserSlow = true;\n\t\t}else if(ua.indexOf(\"Edge\") > -1){\n\t\t\tthis.browser = \"edge\";\n\t\t\tthis.browserSlow = true;\n\t\t}else if(ua.indexOf(\"Firefox\") > -1){\n\t\t\tthis.browser = \"firefox\";\n\t\t\tthis.browserSlow = false;\n\t\t}else if(ua.indexOf(\"Mac OS\") > -1){\n\t\t\tthis.browser = \"safari\";\n\t\t\tthis.browserSlow = false;\n\t\t}else {\n\t\t\tthis.browser = \"other\";\n\t\t\tthis.browserSlow = false;\n\t\t}\n\t\t\n\t\tthis.browserMobile = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(ua)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(ua.slice(0,4));\n\t}\n\t\n\tinitGuard(func, msg){\n\t\tvar stack, line;\n\t\t\n\t\tif(this.options.debugInitialization && !this.initialized){\n\t\t\tif(!func){\n\t\t\t\tstack = new Error().stack.split(\"\\n\");\n\t\t\t\t\n\t\t\t\tline = stack[0] == \"Error\" ? stack[2] : stack[1];\n\t\t\t\t\n\t\t\t\tif(line[0] == \" \"){\n\t\t\t\t\tfunc = line.trim().split(\" \")[1].split(\".\")[1];\n\t\t\t\t}else {\n\t\t\t\t\tfunc = line.trim().split(\"@\")[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconsole.warn(\"Table Not Initialized - Calling the \" + func + \" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function.\" + (msg ? \" \" + msg : \"\"));\n\t\t}\n\t\t\n\t\treturn this.initialized;\n\t}\n\t\n\t////////////////// Data Handling //////////////////\n\t//block table redrawing\n\tblockRedraw(){\n\t\tthis.initGuard();\n\n\t\tthis.eventBus.dispatch(\"redraw-blocking\");\n\t\t\n\t\tthis.rowManager.blockRedraw();\n\t\tthis.columnManager.blockRedraw();\n\n\t\tthis.eventBus.dispatch(\"redraw-blocked\");\n\t}\n\t\n\t//restore table redrawing\n\trestoreRedraw(){\n\t\tthis.initGuard();\n\n\t\tthis.eventBus.dispatch(\"redraw-restoring\");\n\n\t\tthis.rowManager.restoreRedraw();\n\t\tthis.columnManager.restoreRedraw();\n\n\t\tthis.eventBus.dispatch(\"redraw-restored\");\n\t}\n\t\n\t//load data\n\tsetData(data, params, config){\n\t\tthis.initGuard(false, \"To set initial data please use the 'data' property in the table constructor.\");\n\t\t\n\t\treturn this.dataLoader.load(data, params, config, false);\n\t}\n\t\n\t//clear data\n\tclearData(){\n\t\tthis.initGuard();\n\t\t\n\t\tthis.dataLoader.blockActiveLoad();\n\t\tthis.rowManager.clearData();\n\t}\n\t\n\t//get table data array\n\tgetData(active){\n\t\treturn this.rowManager.getData(active);\n\t}\n\t\n\t//get table data array count\n\tgetDataCount(active){\n\t\treturn this.rowManager.getDataCount(active);\n\t}\n\t\n\t//replace data, keeping table in position with same sort\n\treplaceData(data, params, config){\n\t\tthis.initGuard();\n\t\t\n\t\treturn this.dataLoader.load(data, params, config, true, true);\n\t}\n\t\n\t//update table data\n\tupdateData(data){\n\t\tvar responses = 0;\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.dataLoader.blockActiveLoad();\n\t\t\t\n\t\t\tif(typeof data === \"string\"){\n\t\t\t\tdata = JSON.parse(data);\n\t\t\t}\n\t\t\t\n\t\t\tif(data && data.length > 0){\n\t\t\t\tdata.forEach((item) => {\n\t\t\t\t\tvar row = this.rowManager.findRow(item[this.options.index]);\n\t\t\t\t\t\n\t\t\t\t\tif(row){\n\t\t\t\t\t\tresponses++;\n\t\t\t\t\t\t\n\t\t\t\t\t\trow.updateData(item)\n\t\t\t\t\t\t\t.then(()=>{\n\t\t\t\t\t\t\t\tresponses--;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(!responses){\n\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((e) => {\n\t\t\t\t\t\t\t\treject(\"Update Error - Unable to update row\", item, e);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\treject(\"Update Error - Unable to find row\", item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\t\treject(\"Update Error - No data provided\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\taddData(data, pos, index){\n\t\tthis.initGuard();\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.dataLoader.blockActiveLoad();\n\t\t\t\n\t\t\tif(typeof data === \"string\"){\n\t\t\t\tdata = JSON.parse(data);\n\t\t\t}\n\t\t\t\n\t\t\tif(data){\n\t\t\t\tthis.rowManager.addRows(data, pos, index)\n\t\t\t\t\t.then((rows) => {\n\t\t\t\t\t\tvar output = [];\n\t\t\t\t\t\n\t\t\t\t\t\trows.forEach(function(row){\n\t\t\t\t\t\t\toutput.push(row.getComponent());\n\t\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t\tresolve(output);\n\t\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\t\treject(\"Update Error - No data provided\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//update table data\n\tupdateOrAddData(data){\n\t\tvar rows = [],\n\t\tresponses = 0;\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.dataLoader.blockActiveLoad();\n\t\t\t\n\t\t\tif(typeof data === \"string\"){\n\t\t\t\tdata = JSON.parse(data);\n\t\t\t}\n\t\t\t\n\t\t\tif(data && data.length > 0){\n\t\t\t\tdata.forEach((item) => {\n\t\t\t\t\tvar row = this.rowManager.findRow(item[this.options.index]);\n\t\t\t\t\t\n\t\t\t\t\tresponses++;\n\t\t\t\t\t\n\t\t\t\t\tif(row){\n\t\t\t\t\t\trow.updateData(item)\n\t\t\t\t\t\t\t.then(()=>{\n\t\t\t\t\t\t\t\tresponses--;\n\t\t\t\t\t\t\t\trows.push(row.getComponent());\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(!responses){\n\t\t\t\t\t\t\t\t\tresolve(rows);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.rowManager.addRows(item)\n\t\t\t\t\t\t\t.then((newRows)=>{\n\t\t\t\t\t\t\t\tresponses--;\n\t\t\t\t\t\t\t\trows.push(newRows[0].getComponent());\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(!responses){\n\t\t\t\t\t\t\t\t\tresolve(rows);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\t\treject(\"Update Error - No data provided\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//get row object\n\tgetRow(index){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tif(row){\n\t\t\treturn row.getComponent();\n\t\t}else {\n\t\t\tconsole.warn(\"Find Error - No matching row found:\", index);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\t//get row object\n\tgetRowFromPosition(position){\n\t\tvar row = this.rowManager.getRowFromPosition(position);\n\t\t\n\t\tif(row){\n\t\t\treturn row.getComponent();\n\t\t}else {\n\t\t\tconsole.warn(\"Find Error - No matching row found:\", position);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\t//delete row from table\n\tdeleteRow(index){\n\t\tvar foundRows = [];\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(!Array.isArray(index)){\n\t\t\tindex = [index];\n\t\t}\n\t\t\n\t\t//find matching rows\n\t\tfor(let item of index){\n\t\t\tlet row = this.rowManager.findRow(item, true);\n\t\t\t\n\t\t\tif(row){\n\t\t\t\tfoundRows.push(row);\n\t\t\t}else {\n\t\t\t\tconsole.error(\"Delete Error - No matching row found:\", item);\n\t\t\t\treturn Promise.reject(\"Delete Error - No matching row found\");\n\t\t\t}\n\t\t}\n\t\t\n\t\t//sort rows into correct order to ensure smooth delete from table\n\t\tfoundRows.sort((a, b) => {\n\t\t\treturn this.rowManager.rows.indexOf(a) > this.rowManager.rows.indexOf(b) ? 1 : -1;\n\t\t});\n\t\t\n\t\t//delete rows\n\t\tfoundRows.forEach((row) =>{\n\t\t\trow.delete();\n\t\t});\n\t\t\n\t\tthis.rowManager.reRenderInPosition();\n\t\t\n\t\treturn Promise.resolve();\n\t}\n\t\n\t//add row to table\n\taddRow(data, pos, index){\n\t\tthis.initGuard();\n\t\t\n\t\tif(typeof data === \"string\"){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\t\n\t\treturn this.rowManager.addRows(data, pos, index, true)\n\t\t\t.then((rows)=>{\n\t\t\t\treturn rows[0].getComponent();\n\t\t\t});\n\t}\n\t\n\t//update a row if it exists otherwise create it\n\tupdateOrAddRow(index, data){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(typeof data === \"string\"){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\t\n\t\tif(row){\n\t\t\treturn row.updateData(data)\n\t\t\t\t.then(()=>{\n\t\t\t\t\treturn row.getComponent();\n\t\t\t\t});\n\t\t}else {\n\t\t\treturn this.rowManager.addRows(data)\n\t\t\t\t.then((rows)=>{\n\t\t\t\t\treturn rows[0].getComponent();\n\t\t\t\t});\n\t\t}\n\t}\n\t\n\t//update row data\n\tupdateRow(index, data){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(typeof data === \"string\"){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\t\n\t\tif(row){\n\t\t\treturn row.updateData(data)\n\t\t\t\t.then(()=>{\n\t\t\t\t\treturn Promise.resolve(row.getComponent());\n\t\t\t\t});\n\t\t}else {\n\t\t\tconsole.warn(\"Update Error - No matching row found:\", index);\n\t\t\treturn Promise.reject(\"Update Error - No matching row found\");\n\t\t}\n\t}\n\t\n\t//scroll to row in DOM\n\tscrollToRow(index, position, ifVisible){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tif(row){\n\t\t\treturn this.rowManager.scrollToRow(row, position, ifVisible);\n\t\t}else {\n\t\t\tconsole.warn(\"Scroll Error - No matching row found:\", index);\n\t\t\treturn Promise.reject(\"Scroll Error - No matching row found\");\n\t\t}\n\t}\n\t\n\tmoveRow(from, to, after){\n\t\tvar fromRow = this.rowManager.findRow(from);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(fromRow){\n\t\t\tfromRow.moveToRow(to, after);\n\t\t}else {\n\t\t\tconsole.warn(\"Move Error - No matching row found:\", from);\n\t\t}\n\t}\n\t\n\tgetRows(active){\n\t\treturn this.rowManager.getComponents(active);\t\n\t}\n\t\n\t//get position of row in table\n\tgetRowPosition(index){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tif(row){\n\t\t\treturn row.getPosition();\n\t\t}else {\n\t\t\tconsole.warn(\"Position Error - No matching row found:\", index);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\t/////////////// Column Functions  ///////////////\n\tsetColumns(definition){\n\t\tthis.initGuard(false, \"To set initial columns please use the 'columns' property in the table constructor\");\n\t\t\n\t\tthis.columnManager.setColumns(definition);\n\t}\n\t\n\tgetColumns(structured){\n\t\treturn this.columnManager.getComponents(structured);\n\t}\n\t\n\tgetColumn(field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tif(column){\n\t\t\treturn column.getComponent();\n\t\t}else {\n\t\t\tconsole.warn(\"Find Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tgetColumnDefinitions(){\n\t\treturn this.columnManager.getDefinitionTree();\n\t}\n\t\n\tshowColumn(field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\tcolumn.show();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Show Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\thideColumn(field){\n\t\tvar column = this.columnManager.findColumn(field); \n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\tcolumn.hide();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Hide Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\ttoggleColumn(field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\tif(column.visible){\n\t\t\t\tcolumn.hide();\n\t\t\t}else {\n\t\t\t\tcolumn.show();\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Column Visibility Toggle Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\taddColumn(definition, before, field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\treturn this.columnManager.addColumn(definition, before, column)\n\t\t\t.then((column) => {\n\t\t\t\treturn column.getComponent();\n\t\t\t});\n\t}\n\t\n\tdeleteColumn(field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\treturn column.delete();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Delete Error - No matching column found:\", field);\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\tupdateColumnDefinition(field, definition){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\treturn column.updateDefinition(definition);\n\t\t}else {\n\t\t\tconsole.warn(\"Column Update Error - No matching column found:\", field);\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\tmoveColumn(from, to, after){\n\t\tvar fromColumn = this.columnManager.findColumn(from),\n\t\ttoColumn = this.columnManager.findColumn(to);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(fromColumn){\n\t\t\tif(toColumn){\n\t\t\t\tthis.columnManager.moveColumn(fromColumn, toColumn, after);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Move Error - No matching column found:\", toColumn);\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Move Error - No matching column found:\", from);\n\t\t}\n\t}\n\t\n\t//scroll to column in DOM\n\tscrollToColumn(field, position, ifVisible){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar column = this.columnManager.findColumn(field);\n\t\t\t\n\t\t\tif(column){\n\t\t\t\treturn this.columnManager.scrollToColumn(column, position, ifVisible);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Scroll Error - No matching column found:\", field);\n\t\t\t\treturn Promise.reject(\"Scroll Error - No matching column found\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//////////// General Public Functions ////////////\n\t//redraw list without updating data\n\tredraw(force){\n\t\tthis.initGuard();\n\n\t\tthis.columnManager.redraw(force);\n\t\tthis.rowManager.redraw(force);\n\t}\n\t\n\tsetHeight(height){\n\t\tthis.options.height = isNaN(height) ? height : height + \"px\";\n\t\tthis.element.style.height = this.options.height;\n\t\tthis.rowManager.initializeRenderer();\n\t\tthis.rowManager.redraw(true);\n\t}\n\t\n\t//////////////////// Event Bus ///////////////////\n\t\n\ton(key, callback){\n\t\tthis.externalEvents.subscribe(key, callback);\n\t}\n\t\n\toff(key, callback){\n\t\tthis.externalEvents.unsubscribe(key, callback);\n\t}\n\t\n\tdispatchEvent(){\n\t\tvar args = Array.from(arguments);\n\t\targs.shift();\n\t\t\n\t\tthis.externalEvents.dispatch(...arguments);\n\t}\n\n\t//////////////////// Alerts ///////////////////\n\n\talert(contents, type){\n\t\tthis.initGuard();\n\n\t\tthis.alertManager.alert(contents, type);\n\t}\n\n\tclearAlert(){\n\t\tthis.initGuard();\n\n\t\tthis.alertManager.clear();\n\t}\n\t\n\t////////////// Extension Management //////////////\n\tmodExists(plugin, required){\n\t\tif(this.modules[plugin]){\n\t\t\treturn true;\n\t\t}else {\n\t\t\tif(required){\n\t\t\t\tconsole.error(\"Tabulator Module Not Installed: \" + plugin);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tmodule(key){\n\t\tvar mod = this.modules[key];\n\t\t\n\t\tif(!mod){\n\t\t\tconsole.error(\"Tabulator module not installed: \" + key);\n\t\t}\n\t\t\n\t\treturn mod;\n\t}\n}\n\nvar Tabulator$1 = Tabulator;\n\n//tabulator with all modules installed\n\nclass TabulatorFull extends Tabulator$1 {\n\tstatic extendModule(){\n\t\tTabulator$1.initializeModuleBinder(allModules);\n\t\tTabulator$1._extendModule(...arguments);\n\t}\n\n\tstatic registerModule(){\n\t\tTabulator$1.initializeModuleBinder(allModules);\n\t\tTabulator$1._registerModule(...arguments);\n\t}\n\n\tconstructor(element, options, modules){\n\t\tsuper(element, options, allModules);\n\t}\n}\n\nvar TabulatorFull$1 = TabulatorFull;\n\nclass PseudoRow {\n\n\tconstructor (type){\n\t\tthis.type = type;\n\t\tthis.element = this._createElement();\n\t}\n\n\t_createElement(){\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-row\");\n\t\treturn el;\n\t}\n\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\n\tgetComponent(){\n\t\treturn false;\n\t}\n\n\tgetData(){\n\t\treturn {};\n\t}\n\n\tgetHeight(){\n\t\treturn this.element.outerHeight;\n\t}\n\n\tinitialize(){}\n\n\treinitialize(){}\n\n\tnormalizeHeight(){}\n\n\tgenerateCells(){}\n\n\treinitializeHeight(){}\n\n\tcalcHeight(){}\n\n\tsetCellHeight(){}\n\n\tclearCellHeight(){}\n\n\trendered(){}\n}\n\n\n//# sourceMappingURL=tabulator_esm.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdGFidWxhdG9yLXRhYmxlcy9kaXN0L2pzL3RhYnVsYXRvcl9lc20uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUJBQWlCLFlBQVk7O0FBRTdCOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxzQkFBc0I7QUFDdEI7O0FBRUE7QUFDQSxxREFBcUQ7QUFDckQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7QUFDTCwwREFBMEQ7O0FBRTFELG1CQUFtQixjQUFjOztBQUVqQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLG9GQUFvRjs7QUFFcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EscURBQXFEO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsNkNBQTZDOztBQUU3QztBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRixlQUFlLHVCQUF1QjtBQUN0Qzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsUUFBUTtBQUNSLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRixlQUFlLHVCQUF1QjtBQUN0Qzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCLGlCQUFpQjtBQUNqQjtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQSwyQ0FBMkMsSUFBSTtBQUMvQyxpREFBaUQ7QUFDakQsdURBQXVEO0FBQ3ZELHNEQUFzRDtBQUN0RDtBQUNBLHlEQUF5RDtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCLGdDQUFnQzs7QUFFaEM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7O0FBRXZCLGdEQUFnRDtBQUNoRCx5REFBeUQ7QUFDekQsMERBQTBEO0FBQzFELDZEQUE2RDtBQUM3RCwrREFBK0Q7QUFDL0QsNkRBQTZEO0FBQzdELDhEQUE4RDs7QUFFOUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNOztBQUVOOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsdUJBQXVCOztBQUV2QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6Qix3QkFBd0I7QUFDeEIsd0JBQXdCO0FBQ3hCLHFCQUFxQjtBQUNyQixtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQSxpREFBaUQ7QUFDakQsc0JBQXNCO0FBQ3RCLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EscUJBQXFCO0FBQ3JCLHlCQUF5QjtBQUN6Qix3QkFBd0I7QUFDeEIsNEJBQTRCO0FBQzVCO0FBQ0Esd0JBQXdCO0FBQ3hCLDRCQUE0QjtBQUM1QiwyQkFBMkI7QUFDM0I7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RDtBQUN2RCxLQUFLO0FBQ0wsSUFBSTtBQUNKLDhDQUE4QztBQUM5QztBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxvRkFBb0Y7QUFDcEYsS0FBSztBQUNMLElBQUk7QUFDSiwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixZQUFZO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsWUFBWTtBQUM3QjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixlQUFlO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLE1BQU07QUFDTixJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxtQkFBbUI7QUFDbkIsMEJBQTBCO0FBQzFCLDZCQUE2QjtBQUM3Qix3QkFBd0I7QUFDeEIsNEJBQTRCO0FBQzVCLGtDQUFrQztBQUNsQyxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGVBQWU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixjQUFjO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFO0FBQ2xFO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQSxpREFBaUQ7QUFDakQsb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSw4REFBOEQ7QUFDOUQsdUVBQXVFO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsK0NBQStDO0FBQy9DLG9EQUFvRDtBQUNwRCxrREFBa0Q7QUFDbEQ7QUFDQSwwREFBMEQ7QUFDMUQsc0RBQXNEO0FBQ3RELDhEQUE4RDtBQUM5RCw2REFBNkQ7QUFDN0QsMkRBQTJEO0FBQzNEO0FBQ0EsOERBQThEO0FBQzlELDZEQUE2RDs7QUFFN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx5Q0FBeUM7O0FBRXpDOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLE1BQU07O0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7O0FBRUEsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGLGtDQUFrQztBQUNsQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQSxrQ0FBa0M7O0FBRWxDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLDJDQUEyQztBQUNwRjs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixXQUFXLElBQUksU0FBUyxNQUFNOztBQUU5QjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0JBQW9CLEdBQUcsUUFBUSxJQUFJLDBDQUEwQztBQUM3RTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjs7QUFFQTtBQUNBO0FBQ0EsY0FBYyxlQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixhQUFhO0FBQzdCO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSwyQkFBMkIsY0FBYztBQUN6QyxHQUFHLEdBQUc7QUFDTiwrQ0FBK0MsR0FBRztBQUNsRCwwREFBMEQ7O0FBRTFEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxxREFBcUQ7QUFDckQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOzs7QUFHRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCLG9CQUFvQjtBQUNwQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCLG9CQUFvQjtBQUNwQzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBOztBQUVBO0FBQ0EsNkJBQTZCO0FBQzdCOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZ0JBQWdCLG9CQUFvQjtBQUNwQzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isb0JBQW9CO0FBQ3BDO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isb0JBQW9CO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsMEJBQTBCO0FBQ3pDO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixvQkFBb0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSwwQkFBMEI7QUFDekM7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9CQUFvQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsMEJBQTBCO0FBQ3pDO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixvQkFBb0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxzREFBc0Q7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLFdBQVc7QUFDdEQsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGFBQWEsYUFBYTtBQUMxQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0U7QUFDeEU7QUFDQTtBQUNBLGlCQUFpQixvQkFBb0I7QUFDckM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRkFBb0Y7QUFDcEY7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIsMkJBQTJCO0FBQzNCLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQyxPQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQVE7QUFDUixtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0JBQXNCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsb0JBQW9CO0FBQ3pDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLG9CQUFvQjtBQUN6QztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0JBQW9CO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHFCQUFxQjtBQUMzQztBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVEO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7OztBQUlIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbUJBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGtCQUFrQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUEsMkNBQTJDOztBQUUzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHdCQUF3QjtBQUN4QiwyQkFBMkI7QUFDM0IsaUNBQWlDOztBQUVqQztBQUNBLHdDQUF3Qzs7QUFFeEMsd0JBQXdCO0FBQ3hCOztBQUVBLG1EQUFtRDs7QUFFbkQsb0RBQW9EO0FBQ3BELDBEQUEwRDtBQUMxRCxnRUFBZ0U7QUFDaEUsOERBQThEOztBQUU5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtDQUFrQztBQUNsQyxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGFBQWEsbURBQW1EO0FBQ2hFOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsYUFBYSxtREFBbUQ7QUFDaEU7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLCtDQUErQyxFQUFFO0FBQ2pEO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsNEdBQTRHO0FBQzVHO0FBQ0EsS0FBSztBQUNMO0FBQ0Esb0dBQW9HO0FBQ3BHO0FBQ0E7OztBQUdBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osWUFBWTs7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0JBQWdCLGtGQUFrRjtBQUNsRzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsb0NBQW9DO0FBQ2pEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDOztBQUV4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLG9DQUFvQztBQUNqRDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBOztBQUVBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKLEdBQUc7QUFDSDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7OztBQUdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxrQkFBa0IsRUFBRTs7QUFFcEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7QUFDRixnQkFBZ0I7QUFDaEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsYUFBYSxhQUFhO0FBQzFCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSw0Q0FBNEMsZUFBZTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZEO0FBQzdEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDhEQUE4RDtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsY0FBYztBQUNkLGNBQWM7QUFDZCxnQkFBZ0I7QUFDaEIsZUFBZTtBQUNmLGdCQUFnQjtBQUNoQixnQkFBZ0I7QUFDaEIsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUZBQWlGO0FBQ2pGO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixXQUFXO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EscURBQXFEO0FBQ3JELGlEQUFpRDtBQUNqRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixvQ0FBb0M7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0IsK0JBQStCLGNBQWMsR0FBRztBQUNoRCxxQ0FBcUMsV0FBVztBQUNoRCx1QkFBdUI7QUFDdkI7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUMsb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQSxrREFBa0Q7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxXQUFXO0FBQ2pELGdDQUFnQyxjQUFjLEdBQUc7QUFDakQ7QUFDQTtBQUNBLHdEQUF3RDtBQUN4RDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsOENBQThDO0FBQzlDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxnQ0FBZ0MsdUVBQXVFO0FBQ3ZHOztBQUVBO0FBQ0EsOEJBQThCLGdDQUFnQztBQUM5RDs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlDQUFpQyw0Q0FBNEM7QUFDN0U7O0FBRUE7QUFDQSxpQ0FBaUMsNENBQTRDO0FBQzdFOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0EscUJBQXFCLHFCQUFxQjtBQUMxQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0JBQWtCLGtCQUFrQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHFCQUFxQix3QkFBd0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSixXQUFXO0FBQ1g7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EscUJBQXFCLHdCQUF3QjtBQUM3QztBQUNBLFVBQVU7O0FBRVY7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHNCQUFzQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxXQUFXO0FBQ3ZEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNENBQTRDLEdBQUc7QUFDL0MsbURBQW1EO0FBQ25EOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0gscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qiw2QkFBNkI7QUFDN0IsMEJBQTBCO0FBQzFCLHVCQUF1QjtBQUN2QixzQkFBc0I7QUFDdEIsMkJBQTJCO0FBQzNCLG1CQUFtQjtBQUNuQiw4QkFBOEI7QUFDOUIsMkJBQTJCO0FBQzNCLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFEO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUcsR0FBRyxjQUFjO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsR0FBRyxjQUFjO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsNkJBQTZCO0FBQzdCLDZCQUE2QjtBQUM3QiwwQkFBMEI7QUFDMUIsdUJBQXVCO0FBQ3ZCLHNCQUFzQjtBQUN0QiwyQkFBMkI7QUFDM0IsMEJBQTBCO0FBQzFCLG1CQUFtQjtBQUNuQixtQkFBbUI7O0FBRW5CO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsa0RBQWtEO0FBQ2xELGlFQUFpRTtBQUNqRSxtRUFBbUU7QUFDbkU7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7O0FBR0g7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUk7QUFDSixHQUFHLEdBQUcsY0FBYztBQUNwQjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLG1FQUFtRTtBQUNuRTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHFEQUFxRDtBQUNyRDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQSxpREFBaUQ7QUFDakQsdURBQXVEO0FBQ3ZELHFEQUFxRDtBQUNyRCx3REFBd0Q7QUFDeEQseURBQXlEO0FBQ3pELGdFQUFnRTtBQUNoRSx5REFBeUQ7QUFDekQsNkRBQTZEO0FBQzdELHdEQUF3RDtBQUN4RCxzREFBc0QsR0FBRztBQUN6RCwwREFBMEQsR0FBRztBQUM3RCx3REFBd0Q7QUFDeEQsMkRBQTJEO0FBQzNEO0FBQ0Esc0RBQXNEO0FBQ3RELHVEQUF1RDtBQUN2RCw4REFBOEQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsR0FBRztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixPQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsVUFBVTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixTQUFTO0FBQy9COztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsMEJBQTBCOztBQUUxQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTs7QUFFQSxzRUFBc0U7QUFDdEU7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlEQUFpRDtBQUNqRCxxREFBcUQ7QUFDckQsNERBQTREO0FBQzVELDREQUE0RDtBQUM1RDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSCxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtEQUFrRDtBQUNsRCxxREFBcUQ7QUFDckQsa0RBQWtEO0FBQ2xELGtEQUFrRDtBQUNsRCxpREFBaUQ7QUFDakQsd0RBQXdEO0FBQ3hELDRDQUE0QyxHQUFHOztBQUUvQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOzs7QUFHQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsbURBQW1EO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELGNBQWM7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxjQUFjO0FBQ2pFO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsb0RBQW9EO0FBQ3BEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EscURBQXFELGNBQWM7O0FBRW5FO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDREQUE0RCxjQUFjOztBQUUxRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLHVCQUF1Qjs7QUFFdkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLG1EQUFtRCxjQUFjO0FBQ2pFO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx1REFBdUQ7QUFDdkQsdUVBQXVFO0FBQ3ZFLDJFQUEyRTtBQUMzRSx3RUFBd0U7O0FBRXhFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSwrQkFBK0I7QUFDL0I7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUEsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUIsK0JBQStCO0FBQy9CLHdCQUF3QjtBQUN4QiwwQkFBMEI7QUFDMUIscUNBQXFDO0FBQ3JDO0FBQ0EsMkRBQTJEO0FBQzNELGdFQUFnRTtBQUNoRSxvRUFBb0U7QUFDcEUsK0RBQStEO0FBQy9ELHNFQUFzRSxhQUFhLEdBQUc7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCOztBQUV4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixjQUFjOztBQUVkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSixJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQsNkRBQTZEO0FBQzdELDBEQUEwRDtBQUMxRCxnRUFBZ0U7QUFDaEUseUVBQXlFO0FBQ3pFLDhEQUE4RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsc0VBQXNFLHlDQUF5QztBQUMvRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNEVBQTRFLHlDQUF5QztBQUNySDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCLHdCQUF3QjtBQUN4QjtBQUNBLGlEQUFpRDtBQUNqRDtBQUNBLGtEQUFrRDtBQUNsRCwyREFBMkQ7QUFDM0QsdURBQXVEO0FBQ3ZELHdGQUF3RjtBQUN4RixnRUFBZ0U7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0Esc0JBQXNCLHVCQUF1QjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw4RUFBOEU7QUFDaEc7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMEJBQTBCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixPQUFPO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGVBQWU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGVBQWU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTREO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0U7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOzs7QUFHRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxrQkFBa0I7QUFDbEI7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLHFCQUFxQjs7QUFFckIsZ0JBQWdCO0FBQ2hCOztBQUVBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQSw0Q0FBNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsS0FBSztBQUNMLG1DQUFtQztBQUNuQyxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGlDQUFpQztBQUNqQzs7O0FBR0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvQkFBb0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsMkJBQTJCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLFNBQVM7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSw0QkFBNEI7QUFDNUI7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDZCQUE2QixvQkFBb0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QixxQkFBcUI7QUFDckIsNEJBQTRCO0FBQzVCLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDJCQUEyQjs7QUFFM0Isb0JBQW9CO0FBQ3BCLHVCQUF1Qjs7QUFFdkIsNkJBQTZCO0FBQzdCLGdDQUFnQzs7QUFFaEMsdUJBQXVCO0FBQ3ZCLDBCQUEwQjs7QUFFMUIsZ0NBQWdDOztBQUVoQyw2QkFBNkI7O0FBRTdCLG9DQUFvQztBQUNwQyxvQ0FBb0M7O0FBRXBDLDRCQUE0QjtBQUM1QiwrQkFBK0I7QUFDL0I7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsNEJBQTRCLHNCQUFzQjs7QUFFbEQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILDZCQUE2QixzQkFBc0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLE1BQU07QUFDTjtBQUNBOztBQUVBLEtBQUs7QUFDTDtBQUNBOztBQUVBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QztBQUM3QyxpREFBaUQ7QUFDakQsZ0RBQWdEO0FBQ2hELDJCQUEyQjtBQUMzQixtQ0FBbUM7QUFDbkM7QUFDQSw0QkFBNEI7QUFDNUIsK0JBQStCO0FBQy9CLDRCQUE0QjtBQUM1QjtBQUNBLGtCQUFrQjtBQUNsQixnQ0FBZ0M7QUFDaEMsd0JBQXdCO0FBQ3hCLDRCQUE0QjtBQUM1QjtBQUNBLHlCQUF5QjtBQUN6Qiw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIseUNBQXlDO0FBQ3pDLDRDQUE0QztBQUM1QztBQUNBLDBCQUEwQjtBQUMxQiw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsV0FBVztBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsVUFBVTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixrQkFBa0I7QUFDN0M7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGtCQUFrQjtBQUNoRDtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDhCQUE4QjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUNBQWlDO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSx1Q0FBdUM7QUFDdkMseURBQXlEO0FBQ3pEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsY0FBYztBQUN2RTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2QsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRSxjQUFjO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEseUJBQXlCLG1CQUFtQjs7QUFFNUM7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLHdCQUF3QixzQkFBc0Isd0JBQXdCOztBQUVqSDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osMkNBQTJDLHdCQUF3QjtBQUNuRTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUlBQXlJLHNCQUFzQix3QkFBd0I7QUFDdkw7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLCtFQUErRTtBQUMvRSxxQkFBcUI7QUFDckIsb0JBQW9CO0FBQ3BCLHdCQUF3QjtBQUN4Qix1QkFBdUI7QUFDdkIsdUJBQXVCO0FBQ3ZCLDhCQUE4QjtBQUM5QiwwQkFBMEI7QUFDMUIsd0JBQXdCO0FBQ3hCLGtCQUFrQjs7QUFFbEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7O0FBRUE7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQSxpREFBaUQ7QUFDakQsNkRBQTZEOztBQUU3RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLDJCQUEyQjtBQUMzQixxQkFBcUI7QUFDckIsc0JBQXNCO0FBQ3RCOztBQUVBLDZDQUE2QztBQUM3QyxzQ0FBc0M7QUFDdEM7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsMkRBQTJEOztBQUUzRDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isb0JBQW9CO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCLDBCQUEwQjtBQUMxQiw2QkFBNkI7QUFDN0IsNEJBQTRCO0FBQzVCLHdCQUF3QjtBQUN4Qiw4QkFBOEI7QUFDOUIsd0JBQXdCO0FBQ3hCLG1DQUFtQztBQUNuQyxxQkFBcUI7QUFDckIsNEJBQTRCO0FBQzVCLDhCQUE4QjtBQUM5QixvQkFBb0I7QUFDcEIsK0JBQStCO0FBQy9CO0FBQ0Esb0VBQW9FO0FBQ3BFLDJCQUEyQjtBQUMzQjtBQUNBLHFCQUFxQjtBQUNyQix5QkFBeUI7QUFDekIsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBLEtBQUssbURBQW1EO0FBQ3hEO0FBQ0E7QUFDQSxJQUFJLGdDQUFnQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLFFBQVE7QUFDUixNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxNQUFNO0FBQ04sSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFMHdDO0FBQzF3QyIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvdGFidWxhdG9yLXRhYmxlcy9kaXN0L2pzL3RhYnVsYXRvcl9lc20uanM/MjhlOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBUYWJ1bGF0b3IgdjYuMy4xIChjKSBPbGl2ZXIgRm9sa2VyZCAyMDI1ICovXG5jbGFzcyBDb3JlRmVhdHVyZXtcblxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0dGhpcy50YWJsZSA9IHRhYmxlO1xuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLyBEYXRhTG9hZCAvLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXHRyZWxvYWREYXRhKGRhdGEsIHNpbGVudCwgY29sdW1uc0NoYW5nZWQpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLmRhdGFMb2FkZXIubG9hZChkYXRhLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBzaWxlbnQsIGNvbHVtbnNDaGFuZ2VkKTtcblx0fVxuXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vIExvY2FsaXphdGlvbiAvLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblx0bGFuZ1RleHQoKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmdldFRleHQoLi4uYXJndW1lbnRzKTtcblx0fVxuXG5cdGxhbmdCaW5kKCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKC4uLmFyZ3VtZW50cyk7XG5cdH1cblxuXHRsYW5nTG9jYWxlKCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5nZXRMb2NhbGUoLi4uYXJndW1lbnRzKTtcblx0fVxuXG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8gSW50ZXIgVGFibGUgQ29tbXMgLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXHRjb21tc0Nvbm5lY3Rpb25zKCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUubW9kdWxlcy5jb21tcy5nZXRDb25uZWN0aW9ucyguLi5hcmd1bWVudHMpO1xuXHR9XG5cblx0Y29tbXNTZW5kKCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUubW9kdWxlcy5jb21tcy5zZW5kKC4uLmFyZ3VtZW50cyk7XG5cdH1cblxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLyBMYXlvdXQgIC8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdGxheW91dE1vZGUoKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5tb2R1bGVzLmxheW91dC5nZXRNb2RlKCk7XG5cdH1cblxuXHRsYXlvdXRSZWZyZXNoKGZvcmNlKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5tb2R1bGVzLmxheW91dC5sYXlvdXQoZm9yY2UpO1xuXHR9XG5cblxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vIEV2ZW50IEJ1cyAvLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdHN1YnNjcmliZSgpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLmV2ZW50QnVzLnN1YnNjcmliZSguLi5hcmd1bWVudHMpO1xuXHR9XG5cblx0dW5zdWJzY3JpYmUoKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5ldmVudEJ1cy51bnN1YnNjcmliZSguLi5hcmd1bWVudHMpO1xuXHR9XG5cblx0c3Vic2NyaWJlZChrZXkpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLmV2ZW50QnVzLnN1YnNjcmliZWQoa2V5KTtcblx0fVxuXG5cdHN1YnNjcmlwdGlvbkNoYW5nZSgpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLmV2ZW50QnVzLnN1YnNjcmlwdGlvbkNoYW5nZSguLi5hcmd1bWVudHMpO1xuXHR9XG5cblx0ZGlzcGF0Y2goKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5ldmVudEJ1cy5kaXNwYXRjaCguLi5hcmd1bWVudHMpO1xuXHR9XG5cblx0Y2hhaW4oKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5ldmVudEJ1cy5jaGFpbiguLi5hcmd1bWVudHMpO1xuXHR9XG5cblx0Y29uZmlybSgpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLmV2ZW50QnVzLmNvbmZpcm0oLi4uYXJndW1lbnRzKTtcblx0fVxuXG5cdGRpc3BhdGNoRXh0ZXJuYWwoKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5leHRlcm5hbEV2ZW50cy5kaXNwYXRjaCguLi5hcmd1bWVudHMpO1xuXHR9XG5cblx0c3Vic2NyaWJlZEV4dGVybmFsKGtleSl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuZXh0ZXJuYWxFdmVudHMuc3Vic2NyaWJlZChrZXkpO1xuXHR9XG5cblx0c3Vic2NyaXB0aW9uQ2hhbmdlRXh0ZXJuYWwoKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5leHRlcm5hbEV2ZW50cy5zdWJzY3JpcHRpb25DaGFuZ2UoLi4uYXJndW1lbnRzKTtcblx0fVxuXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vIE9wdGlvbnMgLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblx0b3B0aW9ucyhrZXkpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLm9wdGlvbnNba2V5XTtcblx0fVxuXG5cdHNldE9wdGlvbihrZXksIHZhbHVlKXtcblx0XHRpZih0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0dGhpcy50YWJsZS5vcHRpb25zW2tleV0gPSB2YWx1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy50YWJsZS5vcHRpb25zW2tleV07XG5cdH1cblxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8gRGVwcmVjYXRpb24gQ2hlY2tzIC8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdGRlcHJlY2F0aW9uQ2hlY2sob2xkT3B0aW9uLCBuZXdPcHRpb24sICBjb252ZXJ0KXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5kZXByZWNhdGlvbkFkdmlzb3IuY2hlY2sob2xkT3B0aW9uLCBuZXdPcHRpb24sICBjb252ZXJ0KTtcblx0fVxuXG5cdGRlcHJlY2F0aW9uQ2hlY2tNc2cob2xkT3B0aW9uLCBtc2cpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLmRlcHJlY2F0aW9uQWR2aXNvci5jaGVja01zZyhvbGRPcHRpb24sIG1zZyk7XG5cdH1cblxuXHRkZXByZWNhdGlvbk1zZyhtc2cpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLmRlcHJlY2F0aW9uQWR2aXNvci5tc2cobXNnKTtcblx0fVxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLyBNb2R1bGVzIC8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdG1vZHVsZShrZXkpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLm1vZHVsZShrZXkpO1xuXHR9XG59XG5cbmNsYXNzIEhlbHBlcnN7XG5cblx0c3RhdGljIGVsVmlzaWJsZShlbCl7XG5cdFx0cmV0dXJuICEoZWwub2Zmc2V0V2lkdGggPD0gMCAmJiBlbC5vZmZzZXRIZWlnaHQgPD0gMCk7XG5cdH1cblxuXHRzdGF0aWMgZWxPZmZzZXQoZWwpe1xuXHRcdHZhciBib3ggPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IGJveC50b3AgKyB3aW5kb3cucGFnZVlPZmZzZXQgLSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50VG9wLFxuXHRcdFx0bGVmdDogYm94LmxlZnQgKyB3aW5kb3cucGFnZVhPZmZzZXQgLSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50TGVmdFxuXHRcdH07XG5cdH1cblxuXHRzdGF0aWMgcmV0cmlldmVOZXN0ZWREYXRhKHNlcGFyYXRvciwgZmllbGQsIGRhdGEpe1xuXHRcdHZhciBzdHJ1Y3R1cmUgPSBzZXBhcmF0b3IgPyBmaWVsZC5zcGxpdChzZXBhcmF0b3IpIDogW2ZpZWxkXSxcblx0XHRsZW5ndGggPSBzdHJ1Y3R1cmUubGVuZ3RoLFxuXHRcdG91dHB1dDtcblxuXHRcdGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKyl7XG5cblx0XHRcdGRhdGEgPSBkYXRhW3N0cnVjdHVyZVtpXV07XG5cblx0XHRcdG91dHB1dCA9IGRhdGE7XG5cblx0XHRcdGlmKCFkYXRhKXtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXG5cdHN0YXRpYyBkZWVwQ2xvbmUob2JqLCBjbG9uZSwgbGlzdCA9IFtdKXtcblx0XHR2YXIgb2JqZWN0UHJvdG8gPSB7fS5fX3Byb3RvX18sXG5cdFx0YXJyYXlQcm90byA9IFtdLl9fcHJvdG9fXztcblxuXHRcdGlmICghY2xvbmUpe1xuXHRcdFx0Y2xvbmUgPSBPYmplY3QuYXNzaWduKEFycmF5LmlzQXJyYXkob2JqKSA/IFtdIDoge30sIG9iaik7XG5cdFx0fVxuXG5cdFx0Zm9yKHZhciBpIGluIG9iaikge1xuXHRcdFx0bGV0IHN1YmplY3QgPSBvYmpbaV0sXG5cdFx0XHRtYXRjaCwgY29weTtcblxuXHRcdFx0aWYoc3ViamVjdCAhPSBudWxsICYmIHR5cGVvZiBzdWJqZWN0ID09PSBcIm9iamVjdFwiICYmIChzdWJqZWN0Ll9fcHJvdG9fXyA9PT0gb2JqZWN0UHJvdG8gfHwgc3ViamVjdC5fX3Byb3RvX18gPT09IGFycmF5UHJvdG8pKXtcblx0XHRcdFx0bWF0Y2ggPSBsaXN0LmZpbmRJbmRleCgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdHJldHVybiBpdGVtLnN1YmplY3QgPT09IHN1YmplY3Q7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmKG1hdGNoID4gLTEpe1xuXHRcdFx0XHRcdGNsb25lW2ldID0gbGlzdFttYXRjaF0uY29weTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvcHkgPSBPYmplY3QuYXNzaWduKEFycmF5LmlzQXJyYXkoc3ViamVjdCkgPyBbXSA6IHt9LCBzdWJqZWN0KTtcblxuXHRcdFx0XHRcdGxpc3QudW5zaGlmdCh7c3ViamVjdCwgY29weX0pO1xuXG5cdFx0XHRcdFx0Y2xvbmVbaV0gPSB0aGlzLmRlZXBDbG9uZShzdWJqZWN0LCBjb3B5LCBsaXN0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBjbG9uZTtcblx0fVxufVxuXG5sZXQgUG9wdXAkMSA9IGNsYXNzIFBvcHVwIGV4dGVuZHMgQ29yZUZlYXR1cmV7XG5cdGNvbnN0cnVjdG9yKHRhYmxlLCBlbGVtZW50LCBwYXJlbnQpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuXHRcdHRoaXMuY29udGFpbmVyID0gdGhpcy5fbG9va3VwQ29udGFpbmVyKCk7XG5cdFx0XG5cdFx0dGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0XG5cdFx0dGhpcy5yZXZlcnNlZFggPSBmYWxzZTtcblx0XHR0aGlzLmNoaWxkUG9wdXAgPSBudWxsO1xuXHRcdHRoaXMuYmx1cmFibGUgPSBmYWxzZTtcblx0XHR0aGlzLmJsdXJDYWxsYmFjayA9IG51bGw7XG5cdFx0dGhpcy5ibHVyRXZlbnRzQm91bmQgPSBmYWxzZTtcblx0XHR0aGlzLnJlbmRlcmVkQ2FsbGJhY2sgPSBudWxsO1xuXHRcdFxuXHRcdHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuXHRcdHRoaXMuaGlkZWFibGUgPSB0cnVlO1xuXHRcdFxuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXBvcHVwLWNvbnRhaW5lclwiKTtcblx0XHRcblx0XHR0aGlzLmJsdXJFdmVudCA9IHRoaXMuaGlkZS5iaW5kKHRoaXMsIGZhbHNlKTtcblx0XHR0aGlzLmVzY0V2ZW50ID0gdGhpcy5fZXNjYXBlQ2hlY2suYmluZCh0aGlzKTtcblx0XHRcblx0XHR0aGlzLmRlc3Ryb3lCaW5kaW5nID0gdGhpcy50YWJsZURlc3Ryb3llZC5iaW5kKHRoaXMpO1xuXHRcdHRoaXMuZGVzdHJveWVkID0gZmFsc2U7XG5cdH1cblx0XG5cdHRhYmxlRGVzdHJveWVkKCl7XG5cdFx0dGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuXHRcdHRoaXMuaGlkZSh0cnVlKTtcblx0fVxuXHRcblx0X2xvb2t1cENvbnRhaW5lcigpe1xuXHRcdHZhciBjb250YWluZXIgPSB0aGlzLnRhYmxlLm9wdGlvbnMucG9wdXBDb250YWluZXI7XG5cdFx0XG5cdFx0aWYodHlwZW9mIGNvbnRhaW5lciA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHRjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lcik7XG5cdFx0XHRcblx0XHRcdGlmKCFjb250YWluZXIpe1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJNZW51IEVycm9yIC0gbm8gY29udGFpbmVyIGVsZW1lbnQgZm91bmQgbWF0Y2hpbmcgc2VsZWN0b3I6XCIsICB0aGlzLnRhYmxlLm9wdGlvbnMucG9wdXBDb250YWluZXIgLCBcIihkZWZhdWx0aW5nIHRvIGRvY3VtZW50IGJvZHkpXCIpO1xuXHRcdFx0fVxuXHRcdH1lbHNlIGlmIChjb250YWluZXIgPT09IHRydWUpe1xuXHRcdFx0Y29udGFpbmVyID0gdGhpcy50YWJsZS5lbGVtZW50O1xuXHRcdH1cblx0XHRcblx0XHRpZihjb250YWluZXIgJiYgIXRoaXMuX2NoZWNrQ29udGFpbmVySXNQYXJlbnQoY29udGFpbmVyKSl7XG5cdFx0XHRjb250YWluZXIgPSBmYWxzZTtcblx0XHRcdGNvbnNvbGUud2FybihcIk1lbnUgRXJyb3IgLSBjb250YWluZXIgZWxlbWVudCBkb2VzIG5vdCBjb250YWluIHRoaXMgdGFibGU6XCIsICB0aGlzLnRhYmxlLm9wdGlvbnMucG9wdXBDb250YWluZXIgLCBcIihkZWZhdWx0aW5nIHRvIGRvY3VtZW50IGJvZHkpXCIpO1xuXHRcdH1cblx0XHRcblx0XHRpZighY29udGFpbmVyKXtcblx0XHRcdGNvbnRhaW5lciA9IGRvY3VtZW50LmJvZHk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBjb250YWluZXI7XG5cdH1cblx0XG5cdF9jaGVja0NvbnRhaW5lcklzUGFyZW50KGNvbnRhaW5lciwgZWxlbWVudCA9IHRoaXMudGFibGUuZWxlbWVudCl7XG5cdFx0aWYoY29udGFpbmVyID09PSBlbGVtZW50KXtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJldHVybiBlbGVtZW50LnBhcmVudE5vZGUgPyB0aGlzLl9jaGVja0NvbnRhaW5lcklzUGFyZW50KGNvbnRhaW5lciwgZWxlbWVudC5wYXJlbnROb2RlKSA6IGZhbHNlO1xuXHRcdH1cblx0fVxuXHRcblx0cmVuZGVyQ2FsbGJhY2soY2FsbGJhY2spe1xuXHRcdHRoaXMucmVuZGVyZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHR9XG5cdFxuXHRjb250YWluZXJFdmVudENvb3JkcyhlKXtcblx0XHR2YXIgdG91Y2ggPSAhKGUgaW5zdGFuY2VvZiBNb3VzZUV2ZW50KTtcblx0XHRcblx0XHR2YXIgeCA9IHRvdWNoID8gZS50b3VjaGVzWzBdLnBhZ2VYIDogZS5wYWdlWDtcblx0XHR2YXIgeSA9IHRvdWNoID8gZS50b3VjaGVzWzBdLnBhZ2VZIDogZS5wYWdlWTtcblx0XHRcblx0XHRpZih0aGlzLmNvbnRhaW5lciAhPT0gZG9jdW1lbnQuYm9keSl7XG5cdFx0XHRsZXQgcGFyZW50T2Zmc2V0ID0gSGVscGVycy5lbE9mZnNldCh0aGlzLmNvbnRhaW5lcik7XG5cdFx0XHRcblx0XHRcdHggLT0gcGFyZW50T2Zmc2V0LmxlZnQ7XG5cdFx0XHR5IC09IHBhcmVudE9mZnNldC50b3A7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB7eCwgeX07XG5cdH1cblx0XG5cdGVsZW1lbnRQb3NpdGlvbkNvb3JkcyhlbGVtZW50LCBwb3NpdGlvbiA9IFwicmlnaHRcIil7XG5cdFx0dmFyIG9mZnNldCA9IEhlbHBlcnMuZWxPZmZzZXQoZWxlbWVudCksXG5cdFx0Y29udGFpbmVyT2Zmc2V0LCB4LCB5O1xuXHRcdFxuXHRcdGlmKHRoaXMuY29udGFpbmVyICE9PSBkb2N1bWVudC5ib2R5KXtcblx0XHRcdGNvbnRhaW5lck9mZnNldCA9IEhlbHBlcnMuZWxPZmZzZXQodGhpcy5jb250YWluZXIpO1xuXHRcdFx0XG5cdFx0XHRvZmZzZXQubGVmdCAtPSBjb250YWluZXJPZmZzZXQubGVmdDtcblx0XHRcdG9mZnNldC50b3AgLT0gY29udGFpbmVyT2Zmc2V0LnRvcDtcblx0XHR9XG5cdFx0XG5cdFx0c3dpdGNoKHBvc2l0aW9uKXtcblx0XHRcdGNhc2UgXCJyaWdodFwiOlxuXHRcdFx0XHR4ID0gb2Zmc2V0LmxlZnQgKyBlbGVtZW50Lm9mZnNldFdpZHRoO1xuXHRcdFx0XHR5ID0gb2Zmc2V0LnRvcCAtIDE7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwiYm90dG9tXCI6XG5cdFx0XHRcdHggPSBvZmZzZXQubGVmdDtcblx0XHRcdFx0eSA9IG9mZnNldC50b3AgKyBlbGVtZW50Lm9mZnNldEhlaWdodDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcblx0XHRcdGNhc2UgXCJsZWZ0XCI6XG5cdFx0XHRcdHggPSBvZmZzZXQubGVmdDtcblx0XHRcdFx0eSA9IG9mZnNldC50b3AgLSAxO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSBcInRvcFwiOlxuXHRcdFx0XHR4ID0gb2Zmc2V0LmxlZnQ7XG5cdFx0XHRcdHkgPSBvZmZzZXQudG9wO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSBcImNlbnRlclwiOlxuXHRcdFx0XHR4ID0gb2Zmc2V0LmxlZnQgKyAoZWxlbWVudC5vZmZzZXRXaWR0aCAvIDIpO1xuXHRcdFx0XHR5ID0gb2Zmc2V0LnRvcCArIChlbGVtZW50Lm9mZnNldEhlaWdodCAvIDIpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4ge3gsIHksIG9mZnNldH07XG5cdH1cblx0XG5cdHNob3cob3JpZ2luLCBwb3NpdGlvbil7XG5cdFx0dmFyIHgsIHksIHBhcmVudEVsLCBwYXJlbnRPZmZzZXQsIGNvb3Jkcztcblx0XHRcblx0XHRpZih0aGlzLmRlc3Ryb3llZCB8fCB0aGlzLnRhYmxlLmRlc3Ryb3llZCl7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdFx0XG5cdFx0aWYob3JpZ2luIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpe1xuXHRcdFx0cGFyZW50RWwgPSBvcmlnaW47XG5cdFx0XHRjb29yZHMgPSB0aGlzLmVsZW1lbnRQb3NpdGlvbkNvb3JkcyhvcmlnaW4sIHBvc2l0aW9uKTtcblx0XHRcdFxuXHRcdFx0cGFyZW50T2Zmc2V0ID0gY29vcmRzLm9mZnNldDtcblx0XHRcdHggPSBjb29yZHMueDtcblx0XHRcdHkgPSBjb29yZHMueTtcblx0XHRcdFxuXHRcdH1lbHNlIGlmKHR5cGVvZiBvcmlnaW4gPT09IFwibnVtYmVyXCIpe1xuXHRcdFx0cGFyZW50T2Zmc2V0ID0ge3RvcDowLCBsZWZ0OjB9O1xuXHRcdFx0eCA9IG9yaWdpbjtcblx0XHRcdHkgPSBwb3NpdGlvbjtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb29yZHMgPSB0aGlzLmNvbnRhaW5lckV2ZW50Q29vcmRzKG9yaWdpbik7XG5cdFx0XHRcblx0XHRcdHggPSBjb29yZHMueDtcblx0XHRcdHkgPSBjb29yZHMueTtcblx0XHRcdFxuXHRcdFx0dGhpcy5yZXZlcnNlZFggPSBmYWxzZTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IHkgKyBcInB4XCI7XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSB4ICsgXCJweFwiO1xuXHRcdFxuXHRcdHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCk7XG5cdFx0XG5cdFx0aWYodHlwZW9mIHRoaXMucmVuZGVyZWRDYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdHRoaXMucmVuZGVyZWRDYWxsYmFjaygpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLl9maXRUb1NjcmVlbih4LCB5LCBwYXJlbnRFbCwgcGFyZW50T2Zmc2V0LCBwb3NpdGlvbik7XG5cdFx0XG5cdFx0dGhpcy52aXNpYmxlID0gdHJ1ZTtcblx0XHRcblx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLWRlc3Ryb3lcIiwgdGhpcy5kZXN0cm95QmluZGluZyk7XG5cdFx0XG5cdFx0dGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblx0XG5cdF9maXRUb1NjcmVlbih4LCB5LCBwYXJlbnRFbCwgcGFyZW50T2Zmc2V0LCBwb3NpdGlvbil7XG5cdFx0dmFyIHNjcm9sbFRvcCA9IHRoaXMuY29udGFpbmVyID09PSBkb2N1bWVudC5ib2R5ID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA6IHRoaXMuY29udGFpbmVyLnNjcm9sbFRvcDtcblx0XHRcblx0XHQvL21vdmUgbWVudSB0byBzdGFydCBvbiByaWdodCBlZGdlIGlmIGl0IGlzIHRvbyBjbG9zZSB0byB0aGUgZWRnZSBvZiB0aGUgc2NyZWVuXG5cdFx0aWYoKHggKyB0aGlzLmVsZW1lbnQub2Zmc2V0V2lkdGgpID49IHRoaXMuY29udGFpbmVyLm9mZnNldFdpZHRoIHx8IHRoaXMucmV2ZXJzZWRYKXtcblx0XHRcdHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gXCJcIjtcblx0XHRcdFxuXHRcdFx0aWYocGFyZW50RWwpe1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUucmlnaHQgPSAodGhpcy5jb250YWluZXIub2Zmc2V0V2lkdGggLSBwYXJlbnRPZmZzZXQubGVmdCkgKyBcInB4XCI7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5zdHlsZS5yaWdodCA9ICh0aGlzLmNvbnRhaW5lci5vZmZzZXRXaWR0aCAtIHgpICsgXCJweFwiO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnJldmVyc2VkWCA9IHRydWU7XG5cdFx0fVxuXHRcdFxuXHRcdC8vbW92ZSBtZW51IHRvIHN0YXJ0IG9uIGJvdHRvbSBlZGdlIGlmIGl0IGlzIHRvbyBjbG9zZSB0byB0aGUgZWRnZSBvZiB0aGUgc2NyZWVuXG5cdFx0bGV0IG9mZnNldEhlaWdodCA9IE1hdGgubWF4KHRoaXMuY29udGFpbmVyLm9mZnNldEhlaWdodCwgc2Nyb2xsVG9wID8gdGhpcy5jb250YWluZXIuc2Nyb2xsSGVpZ2h0IDogMCk7XG5cdFx0aWYoKHkgKyB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0KSA+IG9mZnNldEhlaWdodCkge1xuXHRcdFx0aWYocGFyZW50RWwpe1xuXHRcdFx0XHRzd2l0Y2gocG9zaXRpb24pe1xuXHRcdFx0XHRcdGNhc2UgXCJib3R0b21cIjpcblx0XHRcdFx0XHRcdHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSAocGFyc2VJbnQodGhpcy5lbGVtZW50LnN0eWxlLnRvcCkgLSB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0IC0gcGFyZW50RWwub2Zmc2V0SGVpZ2h0IC0gMSkgKyBcInB4XCI7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IChwYXJzZUludCh0aGlzLmVsZW1lbnQuc3R5bGUudG9wKSAtIHRoaXMuZWxlbWVudC5vZmZzZXRIZWlnaHQgKyBwYXJlbnRFbC5vZmZzZXRIZWlnaHQgKyAxKSArIFwicHhcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IG9mZnNldEhlaWdodCArIFwicHhcIjtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGlzVmlzaWJsZSgpe1xuXHRcdHJldHVybiB0aGlzLnZpc2libGU7XG5cdH1cblx0XG5cdGhpZGVPbkJsdXIoY2FsbGJhY2spe1xuXHRcdHRoaXMuYmx1cmFibGUgPSB0cnVlO1xuXHRcdFxuXHRcdGlmKHRoaXMudmlzaWJsZSl7XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYodGhpcy52aXNpYmxlKXtcblx0XHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIHRoaXMuYmx1ckV2ZW50KTtcblx0XHRcdFx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtZWRpdGluZ1wiLCB0aGlzLmJsdXJFdmVudCk7XG5cdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5ibHVyRXZlbnQpO1xuXHRcdFx0XHRcdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuYmx1ckV2ZW50KTtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5ibHVyRXZlbnQpO1xuXHRcdFx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuYmx1ckV2ZW50KTtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuZXNjRXZlbnQpO1xuXG5cdFx0XHRcdFx0dGhpcy5ibHVyRXZlbnRzQm91bmQgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCAxMDApO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmJsdXJDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXHRcblx0X2VzY2FwZUNoZWNrKGUpe1xuXHRcdGlmKGUua2V5Q29kZSA9PSAyNyl7XG5cdFx0XHR0aGlzLmhpZGUoKTtcblx0XHR9XG5cdH1cblx0XG5cdGJsb2NrSGlkZSgpe1xuXHRcdHRoaXMuaGlkZWFibGUgPSBmYWxzZTtcblx0fVxuXHRcblx0cmVzdG9yZUhpZGUoKXtcblx0XHR0aGlzLmhpZGVhYmxlID0gdHJ1ZTtcblx0fVxuXHRcblx0aGlkZShzaWxlbnQgPSBmYWxzZSl7XG5cdFx0aWYodGhpcy52aXNpYmxlICYmIHRoaXMuaGlkZWFibGUpe1xuXHRcdFx0aWYodGhpcy5ibHVyYWJsZSAmJiB0aGlzLmJsdXJFdmVudHNCb3VuZCl7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5lc2NFdmVudCk7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuYmx1ckV2ZW50KTtcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgdGhpcy5ibHVyRXZlbnQpO1xuXHRcdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5ibHVyRXZlbnQpO1xuXHRcdFx0XHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLmJsdXJFdmVudCk7XG5cdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgdGhpcy5ibHVyRXZlbnQpO1xuXHRcdFx0XHR0aGlzLnVuc3Vic2NyaWJlKFwiY2VsbC1lZGl0aW5nXCIsIHRoaXMuYmx1ckV2ZW50KTtcblxuXHRcdFx0XHR0aGlzLmJsdXJFdmVudHNCb3VuZCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLmNoaWxkUG9wdXApe1xuXHRcdFx0XHR0aGlzLmNoaWxkUG9wdXAuaGlkZSgpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnBhcmVudCl7XG5cdFx0XHRcdHRoaXMucGFyZW50LmNoaWxkUG9wdXAgPSBudWxsO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSl7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLmJsdXJDYWxsYmFjayAmJiAhc2lsZW50KXtcblx0XHRcdFx0dGhpcy5ibHVyQ2FsbGJhY2soKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy51bnN1YnNjcmliZShcInRhYmxlLWRlc3Ryb3lcIiwgdGhpcy5kZXN0cm95QmluZGluZyk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cdFxuXHRjaGlsZChlbGVtZW50KXtcblx0XHRpZih0aGlzLmNoaWxkUG9wdXApe1xuXHRcdFx0dGhpcy5jaGlsZFBvcHVwLmhpZGUoKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jaGlsZFBvcHVwID0gbmV3IFBvcHVwKHRoaXMudGFibGUsIGVsZW1lbnQsIHRoaXMpO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmNoaWxkUG9wdXA7XG5cdH1cbn07XG5cbmNsYXNzIE1vZHVsZSBleHRlbmRzIENvcmVGZWF0dXJle1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUsIG5hbWUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLl9oYW5kbGVyID0gbnVsbDtcblx0fVxuXHRcblx0aW5pdGlhbGl6ZSgpe1xuXHRcdC8vIHNldHVwIG1vZHVsZSB3aGVuIHRhYmxlIGlzIGluaXRpYWxpemVkLCB0byBiZSBvdmVycmlkZGVuIGluIG1vZHVsZVxuXHR9XG5cdFxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vIE9wdGlvbnMgUmVnaXN0cmF0aW9uIC8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdHJlZ2lzdGVyVGFibGVPcHRpb24oa2V5LCB2YWx1ZSl7XG5cdFx0dGhpcy50YWJsZS5vcHRpb25zTGlzdC5yZWdpc3RlcihrZXksIHZhbHVlKTtcblx0fVxuXHRcblx0cmVnaXN0ZXJDb2x1bW5PcHRpb24oa2V5LCB2YWx1ZSl7XG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLm9wdGlvbnNMaXN0LnJlZ2lzdGVyKGtleSwgdmFsdWUpO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8gUHVibGljIEZ1bmN0aW9uIFJlZ2lzdHJhdGlvbiAvLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdHJlZ2lzdGVyVGFibGVGdW5jdGlvbihuYW1lLCBmdW5jKXtcblx0XHRpZih0eXBlb2YgdGhpcy50YWJsZVtuYW1lXSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHR0aGlzLnRhYmxlW25hbWVdID0gKC4uLmFyZ3MpID0+IHtcblx0XHRcdFx0dGhpcy50YWJsZS5pbml0R3VhcmQobmFtZSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gZnVuYyguLi5hcmdzKTtcblx0XHRcdH07XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiVW5hYmxlIHRvIGJpbmQgdGFibGUgZnVuY3Rpb24sIG5hbWUgYWxyZWFkeSBpbiB1c2VcIiwgbmFtZSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKGNvbXBvbmVudCwgZnVuYywgaGFuZGxlcil7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuY29tcG9uZW50RnVuY3Rpb25CaW5kZXIuYmluZChjb21wb25lbnQsIGZ1bmMsIGhhbmRsZXIpO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vIERhdGEgUGlwZWxpbmUgLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0cmVnaXN0ZXJEYXRhSGFuZGxlcihoYW5kbGVyLCBwcmlvcml0eSl7XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlZ2lzdGVyRGF0YVBpcGVsaW5lSGFuZGxlcihoYW5kbGVyLCBwcmlvcml0eSk7XG5cdFx0dGhpcy5faGFuZGxlciA9IGhhbmRsZXI7XG5cdH1cblx0XG5cdHJlZ2lzdGVyRGlzcGxheUhhbmRsZXIoaGFuZGxlciwgcHJpb3JpdHkpe1xuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZWdpc3RlckRpc3BsYXlQaXBlbGluZUhhbmRsZXIoaGFuZGxlciwgcHJpb3JpdHkpO1xuXHRcdHRoaXMuX2hhbmRsZXIgPSBoYW5kbGVyO1xuXHR9XG5cdFxuXHRkaXNwbGF5Um93cyhhZGp1c3Qpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMudGFibGUucm93TWFuYWdlci5kaXNwbGF5Um93cy5sZW5ndGggLSAxLCBcblx0XHRsb29rdXBJbmRleDtcblx0XHRcblx0XHRpZih0aGlzLl9oYW5kbGVyKXtcblx0XHRcdGxvb2t1cEluZGV4ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmRpc3BsYXlQaXBlbGluZS5maW5kSW5kZXgoKGl0ZW0pID0+IHtcblx0XHRcdFx0cmV0dXJuIGl0ZW0uaGFuZGxlciA9PT0gdGhpcy5faGFuZGxlcjtcblx0XHRcdH0pO1xuXG5cdFx0XHRpZihsb29rdXBJbmRleCA+IC0xKXtcblx0XHRcdFx0aW5kZXggPSBsb29rdXBJbmRleDtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYoYWRqdXN0KXtcblx0XHRcdGluZGV4ID0gaW5kZXggKyBhZGp1c3Q7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5faGFuZGxlcil7XG5cdFx0XHRpZihpbmRleCA+IC0xKXtcblx0XHRcdFx0cmV0dXJuIHRoaXMudGFibGUucm93TWFuYWdlci5nZXREaXNwbGF5Um93cyhpbmRleCk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmFjdGl2ZVJvd3MoKTtcblx0XHRcdH1cblx0XHR9XHRcblx0fVxuXHRcblx0YWN0aXZlUm93cygpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWN0aXZlUm93cztcblx0fVxuXHRcblx0cmVmcmVzaERhdGEocmVuZGVySW5Qb3NpdGlvbiwgaGFuZGxlcil7XG5cdFx0aWYoIWhhbmRsZXIpe1xuXHRcdFx0aGFuZGxlciA9IHRoaXMuX2hhbmRsZXI7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGhhbmRsZXIpe1xuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlZnJlc2hBY3RpdmVEYXRhKGhhbmRsZXIsIGZhbHNlLCByZW5kZXJJblBvc2l0aW9uKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vIEZvb3RlciBNYW5hZ2VtZW50IC8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRmb290ZXJBcHBlbmQoZWxlbWVudCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5hcHBlbmQoZWxlbWVudCk7XG5cdH1cblx0XG5cdGZvb3RlclByZXBlbmQoZWxlbWVudCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5wcmVwZW5kKGVsZW1lbnQpO1xuXHR9XG5cdFxuXHRmb290ZXJSZW1vdmUoZWxlbWVudCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5yZW1vdmUoZWxlbWVudCk7XG5cdH0gXG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLyBQb3B1cHMgTWFuYWdlbWVudCAvLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0cG9wdXAobWVudUVsLCBtZW51Q29udGFpbmVyKXtcblx0XHRyZXR1cm4gbmV3IFBvcHVwJDEodGhpcy50YWJsZSwgbWVudUVsLCBtZW51Q29udGFpbmVyKTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8gQWxlcnQgTWFuYWdlbWVudCAvLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0YWxlcnQoY29udGVudCwgdHlwZSl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuYWxlcnRNYW5hZ2VyLmFsZXJ0KGNvbnRlbnQsIHR5cGUpO1xuXHR9XG5cdFxuXHRjbGVhckFsZXJ0KCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuYWxlcnRNYW5hZ2VyLmNsZWFyKCk7XG5cdH1cblx0XG59XG5cbnZhciBkZWZhdWx0QWNjZXNzb3JzID0ge1xyXG5cdHJvd251bTpmdW5jdGlvbih2YWx1ZSwgZGF0YSwgdHlwZSwgcGFyYW1zLCBjb2x1bW4sIHJvdyl7XHJcblx0XHRyZXR1cm4gcm93LmdldFBvc2l0aW9uKCk7XHJcblx0fVxyXG59O1xuXG5jbGFzcyBBY2Nlc3NvciBleHRlbmRzIE1vZHVsZXtcblx0XG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJhY2Nlc3NvclwiO1xuXG5cdC8vbG9hZCBkZWZhdWx0c1xuXHRzdGF0aWMgYWNjZXNzb3JzID0gZGVmYXVsdEFjY2Vzc29ycztcblxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXG5cdFx0dGhpcy5hbGxvd2VkVHlwZXMgPSBbXCJcIiwgXCJkYXRhXCIsIFwiZG93bmxvYWRcIiwgXCJjbGlwYm9hcmRcIiwgXCJwcmludFwiLCBcImh0bWxPdXRwdXRcIl07IC8vbGlzdCBvZiBhY2Nlc3NvciB0eXBlc1xuXG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImFjY2Vzc29yXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJhY2Nlc3NvclBhcmFtc1wiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiYWNjZXNzb3JEYXRhXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJhY2Nlc3NvckRhdGFQYXJhbXNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImFjY2Vzc29yRG93bmxvYWRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImFjY2Vzc29yRG93bmxvYWRQYXJhbXNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImFjY2Vzc29yQ2xpcGJvYXJkXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJhY2Nlc3NvckNsaXBib2FyZFBhcmFtc1wiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiYWNjZXNzb3JQcmludFwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiYWNjZXNzb3JQcmludFBhcmFtc1wiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiYWNjZXNzb3JIdG1sT3V0cHV0XCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJhY2Nlc3Nvckh0bWxPdXRwdXRQYXJhbXNcIik7XG5cdH1cblxuXHRpbml0aWFsaXplKCl7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tbGF5b3V0XCIsIHRoaXMuaW5pdGlhbGl6ZUNvbHVtbi5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1kYXRhLXJldHJpZXZlXCIsIHRoaXMudHJhbnNmb3JtUm93LmJpbmQodGhpcykpO1xuXHR9XG5cblx0Ly9pbml0aWFsaXplIGNvbHVtbiBhY2Nlc3NvclxuXHRpbml0aWFsaXplQ29sdW1uKGNvbHVtbil7XG5cdFx0dmFyIG1hdGNoID0gZmFsc2UsXG5cdFx0Y29uZmlnID0ge307XG5cblx0XHR0aGlzLmFsbG93ZWRUeXBlcy5mb3JFYWNoKCh0eXBlKSA9PiB7XG5cdFx0XHR2YXIga2V5ID0gXCJhY2Nlc3NvclwiICsgKHR5cGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eXBlLnNsaWNlKDEpKSxcblx0XHRcdGFjY2Vzc29yO1xuXG5cdFx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbltrZXldKXtcblx0XHRcdFx0YWNjZXNzb3IgPSB0aGlzLmxvb2t1cEFjY2Vzc29yKGNvbHVtbi5kZWZpbml0aW9uW2tleV0pO1xuXG5cdFx0XHRcdGlmKGFjY2Vzc29yKXtcblx0XHRcdFx0XHRtYXRjaCA9IHRydWU7XG5cblx0XHRcdFx0XHRjb25maWdba2V5XSA9IHtcblx0XHRcdFx0XHRcdGFjY2Vzc29yOmFjY2Vzc29yLFxuXHRcdFx0XHRcdFx0cGFyYW1zOiBjb2x1bW4uZGVmaW5pdGlvbltrZXkgKyBcIlBhcmFtc1wiXSB8fCB7fSxcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZihtYXRjaCl7XG5cdFx0XHRjb2x1bW4ubW9kdWxlcy5hY2Nlc3NvciA9IGNvbmZpZztcblx0XHR9XG5cdH1cblxuXHRsb29rdXBBY2Nlc3Nvcih2YWx1ZSl7XG5cdFx0dmFyIGFjY2Vzc29yID0gZmFsc2U7XG5cblx0XHQvL3NldCBjb2x1bW4gYWNjZXNzb3Jcblx0XHRzd2l0Y2godHlwZW9mIHZhbHVlKXtcblx0XHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdFx0aWYoQWNjZXNzb3IuYWNjZXNzb3JzW3ZhbHVlXSl7XG5cdFx0XHRcdFx0YWNjZXNzb3IgPSBBY2Nlc3Nvci5hY2Nlc3NvcnNbdmFsdWVdO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiQWNjZXNzb3IgRXJyb3IgLSBObyBzdWNoIGFjY2Vzc29yIGZvdW5kLCBpZ25vcmluZzogXCIsIHZhbHVlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdGFjY2Vzc29yID0gdmFsdWU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdHJldHVybiBhY2Nlc3Nvcjtcblx0fVxuXG5cdC8vYXBwbHkgYWNjZXNzb3IgdG8gcm93XG5cdHRyYW5zZm9ybVJvdyhyb3csIHR5cGUpe1xuXHRcdHZhciBrZXkgPSBcImFjY2Vzc29yXCIgKyAodHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHR5cGUuc2xpY2UoMSkpLFxuXHRcdHJvd0NvbXBvbmVudCA9IHJvdy5nZXRDb21wb25lbnQoKTtcblxuXHRcdC8vY2xvbmUgZGF0YSBvYmplY3Qgd2l0aCBkZWVwIGNvcHkgdG8gaXNvbGF0ZSBpbnRlcm5hbCBkYXRhIGZyb20gcmV0dXJuZWQgcmVzdWx0XG5cdFx0dmFyIGRhdGEgPSBIZWxwZXJzLmRlZXBDbG9uZShyb3cuZGF0YSB8fCB7fSk7XG5cblx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIudHJhdmVyc2UoZnVuY3Rpb24oY29sdW1uKXtcblx0XHRcdHZhciB2YWx1ZSwgYWNjZXNzb3IsIHBhcmFtcywgY29sQ29tcG9uZW50O1xuXG5cdFx0XHRpZihjb2x1bW4ubW9kdWxlcy5hY2Nlc3Nvcil7XG5cblx0XHRcdFx0YWNjZXNzb3IgPSBjb2x1bW4ubW9kdWxlcy5hY2Nlc3NvcltrZXldIHx8IGNvbHVtbi5tb2R1bGVzLmFjY2Vzc29yLmFjY2Vzc29yIHx8IGZhbHNlO1xuXG5cdFx0XHRcdGlmKGFjY2Vzc29yKXtcblx0XHRcdFx0XHR2YWx1ZSA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpO1xuXG5cdFx0XHRcdFx0aWYodmFsdWUgIT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0XHRjb2xDb21wb25lbnQgPSBjb2x1bW4uZ2V0Q29tcG9uZW50KCk7XG5cdFx0XHRcdFx0XHRwYXJhbXMgPSB0eXBlb2YgYWNjZXNzb3IucGFyYW1zID09PSBcImZ1bmN0aW9uXCIgPyBhY2Nlc3Nvci5wYXJhbXModmFsdWUsIGRhdGEsIHR5cGUsIGNvbENvbXBvbmVudCwgcm93Q29tcG9uZW50KSA6IGFjY2Vzc29yLnBhcmFtcztcblx0XHRcdFx0XHRcdGNvbHVtbi5zZXRGaWVsZFZhbHVlKGRhdGEsIGFjY2Vzc29yLmFjY2Vzc29yKHZhbHVlLCBkYXRhLCB0eXBlLCBwYXJhbXMsIGNvbENvbXBvbmVudCwgcm93Q29tcG9uZW50KSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gZGF0YTtcblx0fVxufVxuXG52YXIgZGVmYXVsdENvbmZpZyA9IHtcblx0bWV0aG9kOiBcIkdFVFwiLFxufTtcblxuZnVuY3Rpb24gZ2VuZXJhdGVQYXJhbXNMaXN0JDEoZGF0YSwgcHJlZml4KXtcblx0dmFyIG91dHB1dCA9IFtdO1xuXG5cdHByZWZpeCA9IHByZWZpeCB8fCBcIlwiO1xuXG5cdGlmKEFycmF5LmlzQXJyYXkoZGF0YSkpe1xuXHRcdGRhdGEuZm9yRWFjaCgoaXRlbSwgaSkgPT4ge1xuXHRcdFx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdChnZW5lcmF0ZVBhcmFtc0xpc3QkMShpdGVtLCBwcmVmaXggPyBwcmVmaXggKyBcIltcIiArIGkgKyBcIl1cIiA6IGkpKTtcblx0XHR9KTtcblx0fWVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSBcIm9iamVjdFwiKXtcblx0XHRmb3IgKHZhciBrZXkgaW4gZGF0YSl7XG5cdFx0XHRvdXRwdXQgPSBvdXRwdXQuY29uY2F0KGdlbmVyYXRlUGFyYW1zTGlzdCQxKGRhdGFba2V5XSwgcHJlZml4ID8gcHJlZml4ICsgXCJbXCIgKyBrZXkgKyBcIl1cIiA6IGtleSkpO1xuXHRcdH1cblx0fWVsc2Uge1xuXHRcdG91dHB1dC5wdXNoKHtrZXk6cHJlZml4LCB2YWx1ZTpkYXRhfSk7XG5cdH1cblxuXHRyZXR1cm4gb3V0cHV0O1xufVxuXG5mdW5jdGlvbiBzZXJpYWxpemVQYXJhbXMocGFyYW1zKXtcblx0dmFyIG91dHB1dCA9IGdlbmVyYXRlUGFyYW1zTGlzdCQxKHBhcmFtcyksXG5cdGVuY29kZWQgPSBbXTtcblxuXHRvdXRwdXQuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcblx0XHRlbmNvZGVkLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGl0ZW0ua2V5KSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGl0ZW0udmFsdWUpKTtcblx0fSk7XG5cblx0cmV0dXJuIGVuY29kZWQuam9pbihcIiZcIik7XG59XG5cbmZ1bmN0aW9uIHVybEJ1aWxkZXIodXJsLCBjb25maWcsIHBhcmFtcyl7XG5cdGlmKHVybCl7XG5cdFx0aWYocGFyYW1zICYmIE9iamVjdC5rZXlzKHBhcmFtcykubGVuZ3RoKXtcblx0XHRcdGlmKCFjb25maWcubWV0aG9kIHx8IGNvbmZpZy5tZXRob2QudG9Mb3dlckNhc2UoKSA9PSBcImdldFwiKXtcblx0XHRcdFx0Y29uZmlnLm1ldGhvZCA9IFwiZ2V0XCI7XG5cblx0XHRcdFx0dXJsICs9ICh1cmwuaW5jbHVkZXMoXCI/XCIpID8gXCImXCIgOiBcIj9cIikgKyBzZXJpYWxpemVQYXJhbXMocGFyYW1zKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gdXJsO1xufVxuXG5mdW5jdGlvbiBkZWZhdWx0TG9hZGVyUHJvbWlzZSh1cmwsIGNvbmZpZywgcGFyYW1zKXtcblx0dmFyIGNvbnRlbnRUeXBlO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0Ly9zZXQgdXJsXG5cdFx0dXJsID0gdGhpcy51cmxHZW5lcmF0b3IuY2FsbCh0aGlzLnRhYmxlLCB1cmwsIGNvbmZpZywgcGFyYW1zKTtcblxuXHRcdC8vc2V0IGJvZHkgY29udGVudCBpZiBub3QgR0VUIHJlcXVlc3Rcblx0XHRpZihjb25maWcubWV0aG9kLnRvVXBwZXJDYXNlKCkgIT0gXCJHRVRcIil7XG5cdFx0XHRjb250ZW50VHlwZSA9IHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMuYWpheENvbnRlbnRUeXBlID09PSBcIm9iamVjdFwiID8gIHRoaXMudGFibGUub3B0aW9ucy5hamF4Q29udGVudFR5cGUgOiB0aGlzLmNvbnRlbnRUeXBlRm9ybWF0dGVyc1t0aGlzLnRhYmxlLm9wdGlvbnMuYWpheENvbnRlbnRUeXBlXTtcblx0XHRcdGlmKGNvbnRlbnRUeXBlKXtcblxuXHRcdFx0XHRmb3IodmFyIGtleSBpbiBjb250ZW50VHlwZS5oZWFkZXJzKXtcblx0XHRcdFx0XHRpZighY29uZmlnLmhlYWRlcnMpe1xuXHRcdFx0XHRcdFx0Y29uZmlnLmhlYWRlcnMgPSB7fTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZih0eXBlb2YgY29uZmlnLmhlYWRlcnNba2V5XSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0XHRjb25maWcuaGVhZGVyc1trZXldID0gY29udGVudFR5cGUuaGVhZGVyc1trZXldO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbmZpZy5ib2R5ID0gY29udGVudFR5cGUuYm9keS5jYWxsKHRoaXMsIHVybCwgY29uZmlnLCBwYXJhbXMpO1xuXG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkFqYXggRXJyb3IgLSBJbnZhbGlkIGFqYXhDb250ZW50VHlwZSB2YWx1ZTpcIiwgdGhpcy50YWJsZS5vcHRpb25zLmFqYXhDb250ZW50VHlwZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYodXJsKXtcblx0XHRcdC8vY29uZmlndXJlIGhlYWRlcnNcblx0XHRcdGlmKHR5cGVvZiBjb25maWcuaGVhZGVycyA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdGNvbmZpZy5oZWFkZXJzID0ge307XG5cdFx0XHR9XG5cblx0XHRcdGlmKHR5cGVvZiBjb25maWcuaGVhZGVycy5BY2NlcHQgPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0XHRjb25maWcuaGVhZGVycy5BY2NlcHQgPSBcImFwcGxpY2F0aW9uL2pzb25cIjtcblx0XHRcdH1cblxuXHRcdFx0aWYodHlwZW9mIGNvbmZpZy5oZWFkZXJzW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdGNvbmZpZy5oZWFkZXJzW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXSA9IFwiWE1MSHR0cFJlcXVlc3RcIjtcblx0XHRcdH1cblxuXHRcdFx0aWYodHlwZW9mIGNvbmZpZy5tb2RlID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdFx0Y29uZmlnLm1vZGUgPSBcImNvcnNcIjtcblx0XHRcdH1cblxuXHRcdFx0aWYoY29uZmlnLm1vZGUgPT0gXCJjb3JzXCIpe1xuXHRcdFx0XHRpZih0eXBlb2YgY29uZmlnLmhlYWRlcnNbXCJPcmlnaW5cIl0gPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0XHRcdGNvbmZpZy5oZWFkZXJzW1wiT3JpZ2luXCJdID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbjtcblx0XHRcdFx0fVxuICAgICAgICBcblx0XHRcdFx0aWYodHlwZW9mIGNvbmZpZy5jcmVkZW50aWFscyA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0Y29uZmlnLmNyZWRlbnRpYWxzID0gJ3NhbWUtb3JpZ2luJztcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRpZih0eXBlb2YgY29uZmlnLmNyZWRlbnRpYWxzID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdFx0XHRjb25maWcuY3JlZGVudGlhbHMgPSAnaW5jbHVkZSc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly9zZW5kIHJlcXVlc3Rcblx0XHRcdGZldGNoKHVybCwgY29uZmlnKVxuXHRcdFx0XHQudGhlbigocmVzcG9uc2UpPT57XG5cdFx0XHRcdFx0aWYocmVzcG9uc2Uub2spIHtcblx0XHRcdFx0XHRcdHJlc3BvbnNlLmpzb24oKVxuXHRcdFx0XHRcdFx0XHQudGhlbigoZGF0YSk9Pntcblx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHR9KS5jYXRjaCgoZXJyb3IpPT57XG5cdFx0XHRcdFx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJBamF4IExvYWQgRXJyb3IgLSBJbnZhbGlkIEpTT04gcmV0dXJuZWRcIiwgZXJyb3IpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwiQWpheCBMb2FkIEVycm9yIC0gQ29ubmVjdGlvbiBFcnJvcjogXCIgKyByZXNwb25zZS5zdGF0dXMsIHJlc3BvbnNlLnN0YXR1c1RleHQpO1xuXHRcdFx0XHRcdFx0cmVqZWN0KHJlc3BvbnNlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pXG5cdFx0XHRcdC5jYXRjaCgoZXJyb3IpPT57XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcihcIkFqYXggTG9hZCBFcnJvciAtIENvbm5lY3Rpb24gRXJyb3I6IFwiLCBlcnJvcik7XG5cdFx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiQWpheCBMb2FkIEVycm9yIC0gTm8gVVJMIFNldFwiKTtcblx0XHRcdHJlc29sdmUoW10pO1xuXHRcdH1cblx0fSk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlUGFyYW1zTGlzdChkYXRhLCBwcmVmaXgpe1xuXHR2YXIgb3V0cHV0ID0gW107XG5cblx0cHJlZml4ID0gcHJlZml4IHx8IFwiXCI7XG5cblx0aWYoQXJyYXkuaXNBcnJheShkYXRhKSl7XG5cdFx0ZGF0YS5mb3JFYWNoKChpdGVtLCBpKSA9PiB7XG5cdFx0XHRvdXRwdXQgPSBvdXRwdXQuY29uY2F0KGdlbmVyYXRlUGFyYW1zTGlzdChpdGVtLCBwcmVmaXggPyBwcmVmaXggKyBcIltcIiArIGkgKyBcIl1cIiA6IGkpKTtcblx0XHR9KTtcblx0fWVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSBcIm9iamVjdFwiKXtcblx0XHRmb3IgKHZhciBrZXkgaW4gZGF0YSl7XG5cdFx0XHRvdXRwdXQgPSBvdXRwdXQuY29uY2F0KGdlbmVyYXRlUGFyYW1zTGlzdChkYXRhW2tleV0sIHByZWZpeCA/IHByZWZpeCArIFwiW1wiICsga2V5ICsgXCJdXCIgOiBrZXkpKTtcblx0XHR9XG5cdH1lbHNlIHtcblx0XHRvdXRwdXQucHVzaCh7a2V5OnByZWZpeCwgdmFsdWU6ZGF0YX0pO1xuXHR9XG5cblx0cmV0dXJuIG91dHB1dDtcbn1cblxudmFyIGRlZmF1bHRDb250ZW50VHlwZUZvcm1hdHRlcnMgPSB7XG5cdFwianNvblwiOntcblx0XHRoZWFkZXJzOntcblx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0fSxcblx0XHRib2R5OmZ1bmN0aW9uKHVybCwgY29uZmlnLCBwYXJhbXMpe1xuXHRcdFx0cmV0dXJuIEpTT04uc3RyaW5naWZ5KHBhcmFtcyk7XG5cdFx0fSxcblx0fSxcblx0XCJmb3JtXCI6e1xuXHRcdGhlYWRlcnM6e1xuXHRcdH0sXG5cdFx0Ym9keTpmdW5jdGlvbih1cmwsIGNvbmZpZywgcGFyYW1zKXtcblxuXHRcdFx0dmFyIG91dHB1dCA9IGdlbmVyYXRlUGFyYW1zTGlzdChwYXJhbXMpLFxuXHRcdFx0Zm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xuXG5cdFx0XHRvdXRwdXQuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcblx0XHRcdFx0Zm9ybS5hcHBlbmQoaXRlbS5rZXksIGl0ZW0udmFsdWUpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiBmb3JtO1xuXHRcdH0sXG5cdH0sXG59O1xuXG5jbGFzcyBBamF4IGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJhamF4XCI7XG5cblx0Ly9sb2FkIGRlZmF1bHRzXG5cdHN0YXRpYyBkZWZhdWx0Q29uZmlnID0gZGVmYXVsdENvbmZpZztcblx0c3RhdGljIGRlZmF1bHRVUkxHZW5lcmF0b3IgPSB1cmxCdWlsZGVyO1xuXHRzdGF0aWMgZGVmYXVsdExvYWRlclByb21pc2UgPSBkZWZhdWx0TG9hZGVyUHJvbWlzZTtcblx0c3RhdGljIGNvbnRlbnRUeXBlRm9ybWF0dGVycyA9IGRlZmF1bHRDb250ZW50VHlwZUZvcm1hdHRlcnM7XG5cdFxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMuY29uZmlnID0ge307IC8vaG9sZCBjb25maWcgb2JqZWN0IGZvciBhamF4IHJlcXVlc3Rcblx0XHR0aGlzLnVybCA9IFwiXCI7IC8vcmVxdWVzdCBVUkxcblx0XHR0aGlzLnVybEdlbmVyYXRvciA9IGZhbHNlO1xuXHRcdHRoaXMucGFyYW1zID0gZmFsc2U7IC8vcmVxdWVzdCBwYXJhbWV0ZXJzXG5cdFx0XG5cdFx0dGhpcy5sb2FkZXJQcm9taXNlID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiYWpheFVSTFwiLCBmYWxzZSk7IC8vdXJsIGZvciBhamF4IGxvYWRpbmdcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJhamF4VVJMR2VuZXJhdG9yXCIsIGZhbHNlKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJhamF4UGFyYW1zXCIsIHt9KTsgIC8vcGFyYW1zIGZvciBhamF4IGxvYWRpbmdcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJhamF4Q29uZmlnXCIsIFwiZ2V0XCIpOyAvL2FqYXggcmVxdWVzdCB0eXBlXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiYWpheENvbnRlbnRUeXBlXCIsIFwiZm9ybVwiKTsgLy9hamF4IHJlcXVlc3QgdHlwZVxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImFqYXhSZXF1ZXN0RnVuY1wiLCBmYWxzZSk7IC8vcHJvbWlzZSBmdW5jdGlvblxuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImFqYXhSZXF1ZXN0aW5nXCIsIGZ1bmN0aW9uKCl7fSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiYWpheFJlc3BvbnNlXCIsIGZhbHNlKTtcblx0XHRcblx0XHR0aGlzLmNvbnRlbnRUeXBlRm9ybWF0dGVycyA9IEFqYXguY29udGVudFR5cGVGb3JtYXR0ZXJzO1xuXHR9XG5cdFxuXHQvL2luaXRpYWxpemUgc2V0dXAgb3B0aW9uc1xuXHRpbml0aWFsaXplKCl7XG5cdFx0dGhpcy5sb2FkZXJQcm9taXNlID0gdGhpcy50YWJsZS5vcHRpb25zLmFqYXhSZXF1ZXN0RnVuYyB8fCBBamF4LmRlZmF1bHRMb2FkZXJQcm9taXNlO1xuXHRcdHRoaXMudXJsR2VuZXJhdG9yID0gdGhpcy50YWJsZS5vcHRpb25zLmFqYXhVUkxHZW5lcmF0b3IgfHwgQWpheC5kZWZhdWx0VVJMR2VuZXJhdG9yO1xuXHRcdFxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5hamF4VVJMKXtcblx0XHRcdHRoaXMuc2V0VXJsKHRoaXMudGFibGUub3B0aW9ucy5hamF4VVJMKTtcblx0XHR9XG5cblxuXHRcdHRoaXMuc2V0RGVmYXVsdENvbmZpZyh0aGlzLnRhYmxlLm9wdGlvbnMuYWpheENvbmZpZyk7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRBamF4VXJsXCIsIHRoaXMuZ2V0VXJsLmJpbmQodGhpcykpO1xuXHRcdFxuXHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1sb2FkaW5nXCIsIHRoaXMucmVxdWVzdERhdGFDaGVjay5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImRhdGEtcGFyYW1zXCIsIHRoaXMucmVxdWVzdFBhcmFtcy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImRhdGEtbG9hZFwiLCB0aGlzLnJlcXVlc3REYXRhLmJpbmQodGhpcykpO1xuXHR9XG5cdFxuXHRyZXF1ZXN0UGFyYW1zKGRhdGEsIGNvbmZpZywgc2lsZW50LCBwYXJhbXMpe1xuXHRcdHZhciBhamF4UGFyYW1zID0gdGhpcy50YWJsZS5vcHRpb25zLmFqYXhQYXJhbXM7XG5cdFx0XG5cdFx0aWYoYWpheFBhcmFtcyl7XG5cdFx0XHRpZih0eXBlb2YgYWpheFBhcmFtcyA9PT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdFx0YWpheFBhcmFtcyA9IGFqYXhQYXJhbXMuY2FsbCh0aGlzLnRhYmxlKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cGFyYW1zID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBhamF4UGFyYW1zKSwgcGFyYW1zKTtcblx0XHR9XHRcdFxuXHRcdFxuXHRcdHJldHVybiBwYXJhbXM7XG5cdH1cblx0XG5cdHJlcXVlc3REYXRhQ2hlY2soZGF0YSwgcGFyYW1zLCBjb25maWcsIHNpbGVudCl7XG5cdFx0cmV0dXJuICEhKCghZGF0YSAmJiB0aGlzLnVybCkgfHwgdHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpO1xuXHR9XG5cdFxuXHRyZXF1ZXN0RGF0YSh1cmwsIHBhcmFtcywgY29uZmlnLCBzaWxlbnQsIHByZXZpb3VzRGF0YSl7XG5cdFx0dmFyIGFqYXhDb25maWc7XG5cdFx0XG5cdFx0aWYoIXByZXZpb3VzRGF0YSAmJiB0aGlzLnJlcXVlc3REYXRhQ2hlY2sodXJsKSl7XG5cdFx0XHRpZih1cmwpe1xuXHRcdFx0XHR0aGlzLnNldFVybCh1cmwpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRhamF4Q29uZmlnID0gdGhpcy5nZW5lcmF0ZUNvbmZpZyhjb25maWcpO1xuXHRcdFx0XG5cdFx0XHRyZXR1cm4gdGhpcy5zZW5kUmVxdWVzdCh0aGlzLnVybCwgcGFyYW1zLCBhamF4Q29uZmlnKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gcHJldmlvdXNEYXRhO1xuXHRcdH1cblx0fVxuXHRcblx0c2V0RGVmYXVsdENvbmZpZyhjb25maWcgPSB7fSl7XG5cdFx0dGhpcy5jb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBBamF4LmRlZmF1bHRDb25maWcpO1xuXG5cdFx0aWYodHlwZW9mIGNvbmZpZyA9PSBcInN0cmluZ1wiKXtcblx0XHRcdHRoaXMuY29uZmlnLm1ldGhvZCA9IGNvbmZpZztcblx0XHR9ZWxzZSB7XG5cdFx0XHRPYmplY3QuYXNzaWduKHRoaXMuY29uZmlnLCBjb25maWcpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9sb2FkIGNvbmZpZyBvYmplY3Rcblx0Z2VuZXJhdGVDb25maWcoY29uZmlnID0ge30pe1xuXHRcdHZhciBhamF4Q29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb25maWcpO1xuXHRcdFxuXHRcdGlmKHR5cGVvZiBjb25maWcgPT0gXCJzdHJpbmdcIil7XG5cdFx0XHRhamF4Q29uZmlnLm1ldGhvZCA9IGNvbmZpZztcblx0XHR9ZWxzZSB7XG5cdFx0XHRPYmplY3QuYXNzaWduKGFqYXhDb25maWcsIGNvbmZpZyk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBhamF4Q29uZmlnO1xuXHR9XG5cdFxuXHQvL3NldCByZXF1ZXN0IHVybFxuXHRzZXRVcmwodXJsKXtcblx0XHR0aGlzLnVybCA9IHVybDtcblx0fVxuXHRcblx0Ly9nZXQgcmVxdWVzdCB1cmxcblx0Z2V0VXJsKCl7XG5cdFx0cmV0dXJuIHRoaXMudXJsO1xuXHR9XG5cdFxuXHQvL3NlbmQgYWpheCByZXF1ZXN0XG5cdHNlbmRSZXF1ZXN0KHVybCwgcGFyYW1zLCBjb25maWcpe1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5hamF4UmVxdWVzdGluZy5jYWxsKHRoaXMudGFibGUsIHVybCwgcGFyYW1zKSAhPT0gZmFsc2Upe1xuXHRcdFx0cmV0dXJuIHRoaXMubG9hZGVyUHJvbWlzZSh1cmwsIGNvbmZpZywgcGFyYW1zKVxuXHRcdFx0XHQudGhlbigoZGF0YSk9Pntcblx0XHRcdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuYWpheFJlc3BvbnNlKXtcblx0XHRcdFx0XHRcdGRhdGEgPSB0aGlzLnRhYmxlLm9wdGlvbnMuYWpheFJlc3BvbnNlLmNhbGwodGhpcy50YWJsZSwgdXJsLCBwYXJhbXMsIGRhdGEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuXHRcdH1cblx0fVxufVxuXG52YXIgZGVmYXVsdFBhc3RlQWN0aW9ucyA9IHtcblx0cmVwbGFjZTpmdW5jdGlvbihkYXRhKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5zZXREYXRhKGRhdGEpO1xuXHR9LFxuXHR1cGRhdGU6ZnVuY3Rpb24oZGF0YSl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUudXBkYXRlT3JBZGREYXRhKGRhdGEpO1xuXHR9LFxuXHRpbnNlcnQ6ZnVuY3Rpb24oZGF0YSl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuYWRkRGF0YShkYXRhKTtcblx0fSxcbn07XG5cbnZhciBkZWZhdWx0UGFzdGVQYXJzZXJzID0ge1xuXHR0YWJsZTpmdW5jdGlvbihjbGlwYm9hcmQpe1xuXHRcdHZhciBkYXRhID0gW10sXG5cdFx0aGVhZGVyRmluZFN1Y2Nlc3MgPSB0cnVlLFxuXHRcdGNvbHVtbnMgPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1ucyxcblx0XHRjb2x1bW5NYXAgPSBbXSxcblx0XHRyb3dzID0gW107XG5cdFx0XG5cdFx0Ly9nZXQgZGF0YSBmcm9tIGNsaXBib2FyZCBpbnRvIGFycmF5IG9mIGNvbHVtbnMgYW5kIHJvd3MuXG5cdFx0Y2xpcGJvYXJkID0gY2xpcGJvYXJkLnNwbGl0KFwiXFxuXCIpO1xuXHRcdFxuXHRcdGNsaXBib2FyZC5mb3JFYWNoKGZ1bmN0aW9uKHJvdyl7XG5cdFx0XHRkYXRhLnB1c2gocm93LnNwbGl0KFwiXFx0XCIpKTtcblx0XHR9KTtcblx0XHRcblx0XHRpZihkYXRhLmxlbmd0aCAmJiAhKGRhdGEubGVuZ3RoID09PSAxICYmIGRhdGFbMF0ubGVuZ3RoIDwgMikpe1xuXHRcdFx0XG5cdFx0XHQvL2NoZWNrIGlmIGhlYWRlcnMgYXJlIHByZXNlbnQgYnkgdGl0bGVcblx0XHRcdGRhdGFbMF0uZm9yRWFjaChmdW5jdGlvbih2YWx1ZSl7XG5cdFx0XHRcdHZhciBjb2x1bW4gPSBjb2x1bW5zLmZpbmQoZnVuY3Rpb24oY29sdW1uKXtcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgY29sdW1uLmRlZmluaXRpb24udGl0bGUgJiYgdmFsdWUudHJpbSgpICYmIGNvbHVtbi5kZWZpbml0aW9uLnRpdGxlLnRyaW0oKSA9PT0gdmFsdWUudHJpbSgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGNvbHVtbil7XG5cdFx0XHRcdFx0Y29sdW1uTWFwLnB1c2goY29sdW1uKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGhlYWRlckZpbmRTdWNjZXNzID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvL2NoZWNrIGlmIGNvbHVtbiBoZWFkZXJzIGFyZSBwcmVzZW50IGJ5IGZpZWxkXG5cdFx0XHRpZighaGVhZGVyRmluZFN1Y2Nlc3Mpe1xuXHRcdFx0XHRoZWFkZXJGaW5kU3VjY2VzcyA9IHRydWU7XG5cdFx0XHRcdGNvbHVtbk1hcCA9IFtdO1xuXHRcdFx0XHRcblx0XHRcdFx0ZGF0YVswXS5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXtcblx0XHRcdFx0XHR2YXIgY29sdW1uID0gY29sdW1ucy5maW5kKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgY29sdW1uLmZpZWxkICYmIHZhbHVlLnRyaW0oKSAmJiBjb2x1bW4uZmllbGQudHJpbSgpID09PSB2YWx1ZS50cmltKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoY29sdW1uKXtcblx0XHRcdFx0XHRcdGNvbHVtbk1hcC5wdXNoKGNvbHVtbik7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0aGVhZGVyRmluZFN1Y2Nlc3MgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoIWhlYWRlckZpbmRTdWNjZXNzKXtcblx0XHRcdFx0XHRjb2x1bW5NYXAgPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly9yZW1vdmUgaGVhZGVyIHJvdyBpZiBmb3VuZFxuXHRcdFx0aWYoaGVhZGVyRmluZFN1Y2Nlc3Mpe1xuXHRcdFx0XHRkYXRhLnNoaWZ0KCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGRhdGEuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcblx0XHRcdFx0dmFyIHJvdyA9IHt9O1xuXHRcdFx0XHRcblx0XHRcdFx0aXRlbS5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBpKXtcblx0XHRcdFx0XHRpZihjb2x1bW5NYXBbaV0pe1xuXHRcdFx0XHRcdFx0cm93W2NvbHVtbk1hcFtpXS5maWVsZF0gPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cm93cy5wdXNoKHJvdyk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIHJvd3M7XG5cdFx0fWVsc2Uge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fSxcbn07XG5cbnZhciBiaW5kaW5ncyQyID0ge1xyXG5cdGNvcHlUb0NsaXBib2FyZDpbXCJjdHJsICsgNjdcIiwgXCJtZXRhICsgNjdcIl0sXHJcbn07XG5cbnZhciBhY3Rpb25zJDIgPSB7XHJcblx0Y29weVRvQ2xpcGJvYXJkOmZ1bmN0aW9uKGUpe1xyXG5cdFx0aWYoIXRoaXMudGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsKXtcclxuXHRcdFx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJjbGlwYm9hcmRcIiwgdHJ1ZSkpe1xyXG5cdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5jbGlwYm9hcmQuY29weShmYWxzZSwgdHJ1ZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9LFxyXG59O1xuXG52YXIgZXh0ZW5zaW9ucyQ0ID0ge1xyXG5cdGtleWJpbmRpbmdzOntcclxuXHRcdGJpbmRpbmdzOmJpbmRpbmdzJDIsXHJcblx0XHRhY3Rpb25zOmFjdGlvbnMkMlxyXG5cdH0sXHJcbn07XG5cbmNsYXNzIENsaXBib2FyZCBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwiY2xpcGJvYXJkXCI7XG5cdHN0YXRpYyBtb2R1bGVFeHRlbnNpb25zID0gZXh0ZW5zaW9ucyQ0O1xuXG5cdC8vbG9hZCBkZWZhdWx0c1xuXHRzdGF0aWMgcGFzdGVBY3Rpb25zID0gZGVmYXVsdFBhc3RlQWN0aW9ucztcblx0c3RhdGljIHBhc3RlUGFyc2VycyA9IGRlZmF1bHRQYXN0ZVBhcnNlcnM7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMubW9kZSA9IHRydWU7XG5cdFx0dGhpcy5wYXN0ZVBhcnNlciA9IGZ1bmN0aW9uKCl7fTtcblx0XHR0aGlzLnBhc3RlQWN0aW9uID0gZnVuY3Rpb24oKXt9O1xuXHRcdHRoaXMuY3VzdG9tU2VsZWN0aW9uID0gZmFsc2U7XG5cdFx0dGhpcy5yb3dSYW5nZSA9IGZhbHNlO1xuXHRcdHRoaXMuYmxvY2tlZCA9IHRydWU7IC8vYmxvY2sgY29weSBhY3Rpb25zIG5vdCBvcmlnaW5hdGluZyBmcm9tIHRoaXMgY29tbWFuZFxuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiY2xpcGJvYXJkXCIsIGZhbHNlKTsgLy9lbmFibGUgY2xpcGJvYXJkXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiY2xpcGJvYXJkQ29weVN0eWxlZFwiLCB0cnVlKTsgLy9mb3JtYXR0ZWQgdGFibGUgZGF0YVxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImNsaXBib2FyZENvcHlDb25maWdcIiwgZmFsc2UpOyAvL2NsaXBib2FyZCBjb25maWdcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJjbGlwYm9hcmRDb3B5Rm9ybWF0dGVyXCIsIGZhbHNlKTsgLy9ERVBSRUNBVEVEIC0gUkVNT1ZFIGluIDUuMFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImNsaXBib2FyZENvcHlSb3dSYW5nZVwiLCBcImFjdGl2ZVwiKTsgLy9yZXN0cmljdCBjbGlwYm9hcmQgdG8gdmlzaWJsZSByb3dzIG9ubHlcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJjbGlwYm9hcmRQYXN0ZVBhcnNlclwiLCBcInRhYmxlXCIpOyAvL2NvbnZlcnQgcGFzdGVkIGNsaXBib2FyZCBkYXRhIHRvIHJvd3Ncblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJjbGlwYm9hcmRQYXN0ZUFjdGlvblwiLCBcImluc2VydFwiKTsgLy9ob3cgdG8gaW5zZXJ0IHBhc3RlZCBkYXRhIGludG8gdGhlIHRhYmxlXG5cblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiY2xpcGJvYXJkXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJ0aXRsZUNsaXBib2FyZFwiKTtcblx0fVxuXG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLm1vZGUgPSB0aGlzLnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkO1xuXG5cdFx0dGhpcy5yb3dSYW5nZSA9IHRoaXMudGFibGUub3B0aW9ucy5jbGlwYm9hcmRDb3B5Um93UmFuZ2U7XG5cblx0XHRpZih0aGlzLm1vZGUgPT09IHRydWUgfHwgdGhpcy5tb2RlID09PSBcImNvcHlcIil7XG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvcHlcIiwgKGUpID0+IHtcblx0XHRcdFx0dmFyIHBsYWluLCBodG1sLCBsaXN0O1xuXG5cdFx0XHRcdGlmKCF0aGlzLmJsb2NrZWQpe1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHRcdGlmKHRoaXMuY3VzdG9tU2VsZWN0aW9uKXtcblx0XHRcdFx0XHRcdHBsYWluID0gdGhpcy5jdXN0b21TZWxlY3Rpb247XG5cblx0XHRcdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5jbGlwYm9hcmRDb3B5Rm9ybWF0dGVyKXtcblx0XHRcdFx0XHRcdFx0cGxhaW4gPSB0aGlzLnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkQ29weUZvcm1hdHRlcihcInBsYWluXCIsIHBsYWluKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9ZWxzZSB7XG5cblx0XHRcdFx0XHRcdGxpc3QgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZXhwb3J0LmdlbmVyYXRlRXhwb3J0TGlzdCh0aGlzLnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkQ29weUNvbmZpZywgdGhpcy50YWJsZS5vcHRpb25zLmNsaXBib2FyZENvcHlTdHlsZWQsIHRoaXMucm93UmFuZ2UsIFwiY2xpcGJvYXJkXCIpO1xuXG5cdFx0XHRcdFx0XHRodG1sID0gdGhpcy50YWJsZS5tb2R1bGVzLmV4cG9ydC5nZW5lcmF0ZUhUTUxUYWJsZShsaXN0KTtcblx0XHRcdFx0XHRcdHBsYWluID0gaHRtbCA/IHRoaXMuZ2VuZXJhdGVQbGFpbkNvbnRlbnQobGlzdCkgOiBcIlwiO1xuXG5cdFx0XHRcdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkQ29weUZvcm1hdHRlcil7XG5cdFx0XHRcdFx0XHRcdHBsYWluID0gdGhpcy50YWJsZS5vcHRpb25zLmNsaXBib2FyZENvcHlGb3JtYXR0ZXIoXCJwbGFpblwiLCBwbGFpbik7XG5cdFx0XHRcdFx0XHRcdGh0bWwgPSB0aGlzLnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkQ29weUZvcm1hdHRlcihcImh0bWxcIiwgaHRtbCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHdpbmRvdy5jbGlwYm9hcmREYXRhICYmIHdpbmRvdy5jbGlwYm9hcmREYXRhLnNldERhdGEpIHtcblx0XHRcdFx0XHRcdHdpbmRvdy5jbGlwYm9hcmREYXRhLnNldERhdGEoJ1RleHQnLCBwbGFpbik7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChlLmNsaXBib2FyZERhdGEgJiYgZS5jbGlwYm9hcmREYXRhLnNldERhdGEpIHtcblx0XHRcdFx0XHRcdGUuY2xpcGJvYXJkRGF0YS5zZXREYXRhKCd0ZXh0L3BsYWluJywgcGxhaW4pO1xuXHRcdFx0XHRcdFx0aWYoaHRtbCl7XG5cdFx0XHRcdFx0XHRcdGUuY2xpcGJvYXJkRGF0YS5zZXREYXRhKCd0ZXh0L2h0bWwnLCBodG1sKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2UgaWYgKGUub3JpZ2luYWxFdmVudCAmJiBlLm9yaWdpbmFsRXZlbnQuY2xpcGJvYXJkRGF0YS5zZXREYXRhKSB7XG5cdFx0XHRcdFx0XHRlLm9yaWdpbmFsRXZlbnQuY2xpcGJvYXJkRGF0YS5zZXREYXRhKCd0ZXh0L3BsYWluJywgcGxhaW4pO1xuXHRcdFx0XHRcdFx0aWYoaHRtbCl7XG5cdFx0XHRcdFx0XHRcdGUub3JpZ2luYWxFdmVudC5jbGlwYm9hcmREYXRhLnNldERhdGEoJ3RleHQvaHRtbCcsIGh0bWwpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImNsaXBib2FyZENvcGllZFwiLCBwbGFpbiwgaHRtbCk7XG5cblx0XHRcdFx0XHR0aGlzLnJlc2V0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmKHRoaXMubW9kZSA9PT0gdHJ1ZSB8fCB0aGlzLm1vZGUgPT09IFwicGFzdGVcIil7XG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBhc3RlXCIsIChlKSA9PiB7XG5cdFx0XHRcdHRoaXMucGFzdGUoZSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHR0aGlzLnNldFBhc3RlUGFyc2VyKHRoaXMudGFibGUub3B0aW9ucy5jbGlwYm9hcmRQYXN0ZVBhcnNlcik7XG5cdFx0dGhpcy5zZXRQYXN0ZUFjdGlvbih0aGlzLnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkUGFzdGVBY3Rpb24pO1xuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJjb3B5VG9DbGlwYm9hcmRcIiwgdGhpcy5jb3B5LmJpbmQodGhpcykpO1xuXHR9XG5cblx0cmVzZXQoKXtcblx0XHR0aGlzLmJsb2NrZWQgPSB0cnVlO1xuXHRcdHRoaXMuY3VzdG9tU2VsZWN0aW9uID0gZmFsc2U7XG5cdH1cblxuXHRnZW5lcmF0ZVBsYWluQ29udGVudCAobGlzdCkge1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblxuXHRcdGxpc3QuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHR2YXIgcm93RGF0YSA9IFtdO1xuXG5cdFx0XHRyb3cuY29sdW1ucy5mb3JFYWNoKChjb2wpID0+IHtcblx0XHRcdFx0dmFyIHZhbHVlID0gXCJcIjtcblxuXHRcdFx0XHRpZihjb2wpe1xuXG5cdFx0XHRcdFx0aWYocm93LnR5cGUgPT09IFwiZ3JvdXBcIil7XG5cdFx0XHRcdFx0XHRjb2wudmFsdWUgPSBjb2wuY29tcG9uZW50LmdldEtleSgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmKGNvbC52YWx1ZSA9PT0gbnVsbCl7XG5cdFx0XHRcdFx0XHR2YWx1ZSA9IFwiXCI7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0c3dpdGNoKHR5cGVvZiBjb2wudmFsdWUpe1xuXHRcdFx0XHRcdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBKU09OLnN0cmluZ2lmeShjb2wudmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IFwiXCI7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IGNvbC52YWx1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyb3dEYXRhLnB1c2godmFsdWUpO1xuXHRcdFx0fSk7XG5cblx0XHRcdG91dHB1dC5wdXNoKHJvd0RhdGEuam9pbihcIlxcdFwiKSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gb3V0cHV0LmpvaW4oXCJcXG5cIik7XG5cdH1cblxuXHRjb3B5IChyYW5nZSwgaW50ZXJuYWwpIHtcblx0XHR2YXIgc2VsLCB0ZXh0UmFuZ2U7XG5cdFx0dGhpcy5ibG9ja2VkID0gZmFsc2U7XG5cdFx0dGhpcy5jdXN0b21TZWxlY3Rpb24gPSBmYWxzZTtcblx0XG5cblx0XHRpZiAodGhpcy5tb2RlID09PSB0cnVlIHx8IHRoaXMubW9kZSA9PT0gXCJjb3B5XCIpIHtcblxuXHRcdFx0dGhpcy5yb3dSYW5nZSA9IHJhbmdlIHx8IHRoaXMudGFibGUub3B0aW9ucy5jbGlwYm9hcmRDb3B5Um93UmFuZ2U7XG5cblx0XHRcdGlmICh0eXBlb2Ygd2luZG93LmdldFNlbGVjdGlvbiAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVSYW5nZSAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcblx0XHRcdFx0cmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKHRoaXMudGFibGUuZWxlbWVudCk7XG5cdFx0XHRcdHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcblxuXHRcdFx0XHRpZiAoc2VsLnRvU3RyaW5nKCkgJiYgaW50ZXJuYWwpIHtcblx0XHRcdFx0XHR0aGlzLmN1c3RvbVNlbGVjdGlvbiA9IHNlbC50b1N0cmluZygpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0c2VsLnJlbW92ZUFsbFJhbmdlcygpO1xuXHRcdFx0XHRzZWwuYWRkUmFuZ2UocmFuZ2UpO1xuXHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQuc2VsZWN0aW9uICE9IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlICE9IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0dGV4dFJhbmdlID0gZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTtcblx0XHRcdFx0dGV4dFJhbmdlLm1vdmVUb0VsZW1lbnRUZXh0KHRoaXMudGFibGUuZWxlbWVudCk7XG5cdFx0XHRcdHRleHRSYW5nZS5zZWxlY3QoKTtcblx0XHRcdH1cblxuXHRcdFx0ZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2NvcHknKTtcblxuXHRcdFx0aWYgKHNlbCkge1xuXHRcdFx0XHRzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly9QQVNURSBFVkVOVCBIQU5ETElOR1xuXHRzZXRQYXN0ZUFjdGlvbihhY3Rpb24pe1xuXG5cdFx0c3dpdGNoKHR5cGVvZiBhY3Rpb24pe1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHR0aGlzLnBhc3RlQWN0aW9uID0gQ2xpcGJvYXJkLnBhc3RlQWN0aW9uc1thY3Rpb25dO1xuXG5cdFx0XHRcdGlmKCF0aGlzLnBhc3RlQWN0aW9uKXtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJDbGlwYm9hcmQgRXJyb3IgLSBObyBzdWNoIHBhc3RlIGFjdGlvbiBmb3VuZDpcIiwgYWN0aW9uKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdHRoaXMucGFzdGVBY3Rpb24gPSBhY3Rpb247XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxuXG5cdHNldFBhc3RlUGFyc2VyKHBhcnNlcil7XG5cdFx0c3dpdGNoKHR5cGVvZiBwYXJzZXIpe1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHR0aGlzLnBhc3RlUGFyc2VyID0gQ2xpcGJvYXJkLnBhc3RlUGFyc2Vyc1twYXJzZXJdO1xuXG5cdFx0XHRcdGlmKCF0aGlzLnBhc3RlUGFyc2VyKXtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJDbGlwYm9hcmQgRXJyb3IgLSBObyBzdWNoIHBhc3RlIHBhcnNlciBmb3VuZDpcIiwgcGFyc2VyKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdHRoaXMucGFzdGVQYXJzZXIgPSBwYXJzZXI7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxuXG5cdHBhc3RlKGUpe1xuXHRcdHZhciBkYXRhLCByb3dEYXRhLCByb3dzO1xuXG5cdFx0aWYodGhpcy5jaGVja1Bhc3RlT3JpZ2luKGUpKXtcblxuXHRcdFx0ZGF0YSA9IHRoaXMuZ2V0UGFzdGVEYXRhKGUpO1xuXG5cdFx0XHRyb3dEYXRhID0gdGhpcy5wYXN0ZVBhcnNlci5jYWxsKHRoaXMsIGRhdGEpO1xuXG5cdFx0XHRpZihyb3dEYXRhKXtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdGlmKHRoaXMudGFibGUubW9kRXhpc3RzKFwibXV0YXRvclwiKSl7XG5cdFx0XHRcdFx0cm93RGF0YSA9IHRoaXMubXV0YXRlRGF0YShyb3dEYXRhKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJvd3MgPSB0aGlzLnBhc3RlQWN0aW9uLmNhbGwodGhpcywgcm93RGF0YSk7XG5cblx0XHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiY2xpcGJvYXJkUGFzdGVkXCIsIGRhdGEsIHJvd0RhdGEsIHJvd3MpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJjbGlwYm9hcmRQYXN0ZUVycm9yXCIsIGRhdGEpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdG11dGF0ZURhdGEoZGF0YSl7XG5cdFx0dmFyIG91dHB1dCA9IFtdO1xuXG5cdFx0aWYoQXJyYXkuaXNBcnJheShkYXRhKSl7XG5cdFx0XHRkYXRhLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRvdXRwdXQucHVzaCh0aGlzLnRhYmxlLm1vZHVsZXMubXV0YXRvci50cmFuc2Zvcm1Sb3cocm93LCBcImNsaXBib2FyZFwiKSk7XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRvdXRwdXQgPSBkYXRhO1xuXHRcdH1cblxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblxuXG5cdGNoZWNrUGFzdGVPcmlnaW4oZSl7XG5cdFx0dmFyIHZhbGlkID0gdHJ1ZTtcblx0XHR2YXIgYmxvY2tlZCA9IHRoaXMuY29uZmlybShcImNsaXBib2FyZC1wYXN0ZVwiLCBbZV0pO1xuXG5cdFx0aWYoYmxvY2tlZCB8fCAhW1wiRElWXCIsIFwiU1BBTlwiXS5pbmNsdWRlcyhlLnRhcmdldC50YWdOYW1lKSl7XG5cdFx0XHR2YWxpZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdHJldHVybiB2YWxpZDtcblx0fVxuXG5cdGdldFBhc3RlRGF0YShlKXtcblx0XHR2YXIgZGF0YTtcblxuXHRcdGlmICh3aW5kb3cuY2xpcGJvYXJkRGF0YSAmJiB3aW5kb3cuY2xpcGJvYXJkRGF0YS5nZXREYXRhKSB7XG5cdFx0XHRkYXRhID0gd2luZG93LmNsaXBib2FyZERhdGEuZ2V0RGF0YSgnVGV4dCcpO1xuXHRcdH0gZWxzZSBpZiAoZS5jbGlwYm9hcmREYXRhICYmIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKSB7XG5cdFx0XHRkYXRhID0gZS5jbGlwYm9hcmREYXRhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcblx0XHR9IGVsc2UgaWYgKGUub3JpZ2luYWxFdmVudCAmJiBlLm9yaWdpbmFsRXZlbnQuY2xpcGJvYXJkRGF0YS5nZXREYXRhKSB7XG5cdFx0XHRkYXRhID0gZS5vcmlnaW5hbEV2ZW50LmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xuXHRcdH1cblxuXHRcdHJldHVybiBkYXRhO1xuXHR9XG59XG5cbmNsYXNzIENhbGNDb21wb25lbnR7XG5cdGNvbnN0cnVjdG9yIChyb3cpe1xuXHRcdHRoaXMuX3JvdyA9IHJvdztcblxuXHRcdHJldHVybiBuZXcgUHJveHkodGhpcywge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbih0YXJnZXQsIG5hbWUsIHJlY2VpdmVyKSB7XG5cdFx0XHRcdGlmICh0eXBlb2YgdGFyZ2V0W25hbWVdICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRhcmdldFtuYW1lXTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiB0YXJnZXQuX3Jvdy50YWJsZS5jb21wb25lbnRGdW5jdGlvbkJpbmRlci5oYW5kbGUoXCJyb3dcIiwgdGFyZ2V0Ll9yb3csIG5hbWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRnZXREYXRhKHRyYW5zZm9ybSl7XG5cdFx0cmV0dXJuIHRoaXMuX3Jvdy5nZXREYXRhKHRyYW5zZm9ybSk7XG5cdH1cblxuXHRnZXRFbGVtZW50KCl7XG5cdFx0cmV0dXJuIHRoaXMuX3Jvdy5nZXRFbGVtZW50KCk7XG5cdH1cblxuXHRnZXRUYWJsZSgpe1xuXHRcdHJldHVybiB0aGlzLl9yb3cudGFibGU7XG5cdH1cblxuXHRnZXRDZWxscygpe1xuXHRcdHZhciBjZWxscyA9IFtdO1xuXG5cdFx0dGhpcy5fcm93LmdldENlbGxzKCkuZm9yRWFjaChmdW5jdGlvbihjZWxsKXtcblx0XHRcdGNlbGxzLnB1c2goY2VsbC5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gY2VsbHM7XG5cdH1cblxuXHRnZXRDZWxsKGNvbHVtbil7XG5cdFx0dmFyIGNlbGwgPSB0aGlzLl9yb3cuZ2V0Q2VsbChjb2x1bW4pO1xuXHRcdHJldHVybiBjZWxsID8gY2VsbC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xuXHR9XG5cblx0X2dldFNlbGYoKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93O1xuXHR9XG59XG5cbi8vcHVibGljIGNlbGwgb2JqZWN0XG5jbGFzcyBDZWxsQ29tcG9uZW50IHtcblxuXHRjb25zdHJ1Y3RvciAoY2VsbCl7XG5cdFx0dGhpcy5fY2VsbCA9IGNlbGw7XG5cblx0XHRyZXR1cm4gbmV3IFByb3h5KHRoaXMsIHtcblx0XHRcdGdldDogZnVuY3Rpb24odGFyZ2V0LCBuYW1lLCByZWNlaXZlcikge1xuXHRcdFx0XHRpZiAodHlwZW9mIHRhcmdldFtuYW1lXSAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdHJldHVybiB0YXJnZXRbbmFtZV07XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gdGFyZ2V0Ll9jZWxsLnRhYmxlLmNvbXBvbmVudEZ1bmN0aW9uQmluZGVyLmhhbmRsZShcImNlbGxcIiwgdGFyZ2V0Ll9jZWxsLCBuYW1lKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0Z2V0VmFsdWUoKXtcblx0XHRyZXR1cm4gdGhpcy5fY2VsbC5nZXRWYWx1ZSgpO1xuXHR9XG5cblx0Z2V0T2xkVmFsdWUoKXtcblx0XHRyZXR1cm4gdGhpcy5fY2VsbC5nZXRPbGRWYWx1ZSgpO1xuXHR9XG5cblx0Z2V0SW5pdGlhbFZhbHVlKCl7XG5cdFx0cmV0dXJuIHRoaXMuX2NlbGwuaW5pdGlhbFZhbHVlO1xuXHR9XG5cblx0Z2V0RWxlbWVudCgpe1xuXHRcdHJldHVybiB0aGlzLl9jZWxsLmdldEVsZW1lbnQoKTtcblx0fVxuXG5cdGdldFJvdygpe1xuXHRcdHJldHVybiB0aGlzLl9jZWxsLnJvdy5nZXRDb21wb25lbnQoKTtcblx0fVxuXG5cdGdldERhdGEodHJhbnNmb3JtKXtcblx0XHRyZXR1cm4gdGhpcy5fY2VsbC5yb3cuZ2V0RGF0YSh0cmFuc2Zvcm0pO1xuXHR9XG5cdGdldFR5cGUoKXtcblx0XHRyZXR1cm4gXCJjZWxsXCI7XG5cdH1cblx0Z2V0RmllbGQoKXtcblx0XHRyZXR1cm4gdGhpcy5fY2VsbC5jb2x1bW4uZ2V0RmllbGQoKTtcblx0fVxuXG5cdGdldENvbHVtbigpe1xuXHRcdHJldHVybiB0aGlzLl9jZWxsLmNvbHVtbi5nZXRDb21wb25lbnQoKTtcblx0fVxuXG5cdHNldFZhbHVlKHZhbHVlLCBtdXRhdGUpe1xuXHRcdGlmKHR5cGVvZiBtdXRhdGUgPT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRtdXRhdGUgPSB0cnVlO1xuXHRcdH1cblxuXHRcdHRoaXMuX2NlbGwuc2V0VmFsdWUodmFsdWUsIG11dGF0ZSk7XG5cdH1cblxuXHRyZXN0b3JlT2xkVmFsdWUoKXtcblx0XHR0aGlzLl9jZWxsLnNldFZhbHVlQWN0dWFsKHRoaXMuX2NlbGwuZ2V0T2xkVmFsdWUoKSk7XG5cdH1cblxuXHRyZXN0b3JlSW5pdGlhbFZhbHVlKCl7XG5cdFx0dGhpcy5fY2VsbC5zZXRWYWx1ZUFjdHVhbCh0aGlzLl9jZWxsLmluaXRpYWxWYWx1ZSk7XG5cdH1cblxuXHRjaGVja0hlaWdodCgpe1xuXHRcdHRoaXMuX2NlbGwuY2hlY2tIZWlnaHQoKTtcblx0fVxuXG5cdGdldFRhYmxlKCl7XG5cdFx0cmV0dXJuIHRoaXMuX2NlbGwudGFibGU7XG5cdH1cblxuXHRfZ2V0U2VsZigpe1xuXHRcdHJldHVybiB0aGlzLl9jZWxsO1xuXHR9XG59XG5cbmNsYXNzIENlbGwgZXh0ZW5kcyBDb3JlRmVhdHVyZXtcblx0Y29uc3RydWN0b3IoY29sdW1uLCByb3cpe1xuXHRcdHN1cGVyKGNvbHVtbi50YWJsZSk7XG5cblx0XHR0aGlzLnRhYmxlID0gY29sdW1uLnRhYmxlO1xuXHRcdHRoaXMuY29sdW1uID0gY29sdW1uO1xuXHRcdHRoaXMucm93ID0gcm93O1xuXHRcdHRoaXMuZWxlbWVudCA9IG51bGw7XG5cdFx0dGhpcy52YWx1ZSA9IG51bGw7XG5cdFx0dGhpcy5pbml0aWFsVmFsdWU7XG5cdFx0dGhpcy5vbGRWYWx1ZSA9IG51bGw7XG5cdFx0dGhpcy5tb2R1bGVzID0ge307XG5cblx0XHR0aGlzLmhlaWdodCA9IG51bGw7XG5cdFx0dGhpcy53aWR0aCA9IG51bGw7XG5cdFx0dGhpcy5taW5XaWR0aCA9IG51bGw7XG5cblx0XHR0aGlzLmNvbXBvbmVudCA9IG51bGw7XG5cblx0XHR0aGlzLmxvYWRlZCA9IGZhbHNlOyAvL3RyYWNrIGlmIHRoZSBjZWxsIGhhcyBiZWVuIGFkZGVkIHRvIHRoZSBET00geWV0XG5cblx0XHR0aGlzLmJ1aWxkKCk7XG5cdH1cblxuXHQvLy8vLy8vLy8vLy8vLy8vIFNldHVwIEZ1bmN0aW9ucyAvLy8vLy8vLy8vLy8vLy8vL1xuXHQvL2dlbmVyYXRlIGVsZW1lbnRcblx0YnVpbGQoKXtcblx0XHR0aGlzLmdlbmVyYXRlRWxlbWVudCgpO1xuXG5cdFx0dGhpcy5zZXRXaWR0aCgpO1xuXG5cdFx0dGhpcy5fY29uZmlndXJlQ2VsbCgpO1xuXG5cdFx0dGhpcy5zZXRWYWx1ZUFjdHVhbCh0aGlzLmNvbHVtbi5nZXRGaWVsZFZhbHVlKHRoaXMucm93LmRhdGEpKTtcblxuXHRcdHRoaXMuaW5pdGlhbFZhbHVlID0gdGhpcy52YWx1ZTtcblx0fVxuXG5cdGdlbmVyYXRlRWxlbWVudCgpe1xuXHRcdHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdHRoaXMuZWxlbWVudC5jbGFzc05hbWUgPSBcInRhYnVsYXRvci1jZWxsXCI7XG5cdFx0dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJncmlkY2VsbFwiKTtcblxuXHRcdGlmKHRoaXMuY29sdW1uLmlzUm93SGVhZGVyKXtcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1oZWFkZXJcIik7XG5cdFx0fVxuXHR9XG5cblx0X2NvbmZpZ3VyZUNlbGwoKXtcblx0XHR2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcblx0XHRmaWVsZCA9IHRoaXMuY29sdW1uLmdldEZpZWxkKCksXG5cdFx0dmVydEFsaWducyA9IHtcblx0XHRcdHRvcDpcImZsZXgtc3RhcnRcIixcblx0XHRcdGJvdHRvbTpcImZsZXgtZW5kXCIsXG5cdFx0XHRtaWRkbGU6XCJjZW50ZXJcIixcblx0XHR9LFxuXHRcdGhvekFsaWducyA9IHtcblx0XHRcdGxlZnQ6XCJmbGV4LXN0YXJ0XCIsXG5cdFx0XHRyaWdodDpcImZsZXgtZW5kXCIsXG5cdFx0XHRjZW50ZXI6XCJjZW50ZXJcIixcblx0XHR9O1xuXG5cdFx0Ly9zZXQgdGV4dCBhbGlnbm1lbnRcblx0XHRlbGVtZW50LnN0eWxlLnRleHRBbGlnbiA9IHRoaXMuY29sdW1uLmhvekFsaWduO1xuXG5cdFx0aWYodGhpcy5jb2x1bW4udmVydEFsaWduKXtcblx0XHRcdGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWZsZXhcIjtcblxuXHRcdFx0ZWxlbWVudC5zdHlsZS5hbGlnbkl0ZW1zID0gdmVydEFsaWduc1t0aGlzLmNvbHVtbi52ZXJ0QWxpZ25dIHx8IFwiXCI7XG5cblx0XHRcdGlmKHRoaXMuY29sdW1uLmhvekFsaWduKXtcblx0XHRcdFx0ZWxlbWVudC5zdHlsZS5qdXN0aWZ5Q29udGVudCA9IGhvekFsaWduc1t0aGlzLmNvbHVtbi5ob3pBbGlnbl0gfHwgXCJcIjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZihmaWVsZCl7XG5cdFx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZShcInRhYnVsYXRvci1maWVsZFwiLCBmaWVsZCk7XG5cdFx0fVxuXG5cdFx0Ly9hZGQgY2xhc3MgdG8gY2VsbCBpZiBuZWVkZWRcblx0XHRpZih0aGlzLmNvbHVtbi5kZWZpbml0aW9uLmNzc0NsYXNzKXtcblx0XHRcdHZhciBjbGFzc05hbWVzID0gdGhpcy5jb2x1bW4uZGVmaW5pdGlvbi5jc3NDbGFzcy5zcGxpdChcIiBcIik7XG5cdFx0XHRjbGFzc05hbWVzLmZvckVhY2goKGNsYXNzTmFtZSkgPT4ge1xuXHRcdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjZWxsLWluaXRcIiwgdGhpcyk7XG5cblx0XHQvL2hpZGUgY2VsbCBpZiBub3QgdmlzaWJsZVxuXHRcdGlmKCF0aGlzLmNvbHVtbi52aXNpYmxlKXtcblx0XHRcdHRoaXMuaGlkZSgpO1xuXHRcdH1cblx0fVxuXG5cdC8vZ2VuZXJhdGUgY2VsbCBjb250ZW50c1xuXHRfZ2VuZXJhdGVDb250ZW50cygpe1xuXHRcdHZhciB2YWw7XG5cblx0XHR2YWwgPSB0aGlzLmNoYWluKFwiY2VsbC1mb3JtYXRcIiwgdGhpcywgbnVsbCwgKCkgPT4ge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLnZhbHVlO1xuXHRcdH0pO1xuXG5cdFx0c3dpdGNoKHR5cGVvZiB2YWwpe1xuXHRcdFx0Y2FzZSBcIm9iamVjdFwiOlxuXHRcdFx0XHRpZih2YWwgaW5zdGFuY2VvZiBOb2RlKXtcblxuXHRcdFx0XHRcdC8vY2xlYXIgcHJldmlvdXMgY2VsbCBjb250ZW50c1xuXHRcdFx0XHRcdHdoaWxlKHRoaXMuZWxlbWVudC5maXJzdENoaWxkKSB0aGlzLmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpO1xuXG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHZhbCk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gXCJcIjtcblxuXHRcdFx0XHRcdGlmKHZhbCAhPSBudWxsKXtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkZvcm1hdCBFcnJvciAtIEZvcm1hdHRlciBoYXMgcmV0dXJuZWQgYSB0eXBlIG9mIG9iamVjdCwgdGhlIG9ubHkgdmFsaWQgZm9ybWF0dGVyIG9iamVjdCByZXR1cm4gaXMgYW4gaW5zdGFuY2Ugb2YgTm9kZSwgdGhlIGZvcm1hdHRlciByZXR1cm5lZDpcIiwgdmFsKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwidW5kZWZpbmVkXCI6XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSB2YWw7XG5cdFx0fVxuXHR9XG5cblx0Y2VsbFJlbmRlcmVkKCl7XG5cdFx0dGhpcy5kaXNwYXRjaChcImNlbGwtcmVuZGVyZWRcIiwgdGhpcyk7XG5cdH1cblxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLyBHZXR0ZXJzIC8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdGdldEVsZW1lbnQoY29udGFpbmVyT25seSl7XG5cdFx0aWYoIXRoaXMubG9hZGVkKXtcblx0XHRcdHRoaXMubG9hZGVkID0gdHJ1ZTtcblx0XHRcdGlmKCFjb250YWluZXJPbmx5KXtcblx0XHRcdFx0dGhpcy5sYXlvdXRFbGVtZW50KCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fVxuXG5cdGdldFZhbHVlKCl7XG5cdFx0cmV0dXJuIHRoaXMudmFsdWU7XG5cdH1cblxuXHRnZXRPbGRWYWx1ZSgpe1xuXHRcdHJldHVybiB0aGlzLm9sZFZhbHVlO1xuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8gQWN0aW9ucyAvLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRzZXRWYWx1ZSh2YWx1ZSwgbXV0YXRlLCBmb3JjZSl7XG5cdFx0dmFyIGNoYW5nZWQgPSB0aGlzLnNldFZhbHVlUHJvY2Vzc0RhdGEodmFsdWUsIG11dGF0ZSwgZm9yY2UpO1xuXG5cdFx0aWYoY2hhbmdlZCl7XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwiY2VsbC12YWx1ZS11cGRhdGVkXCIsIHRoaXMpO1xuXG5cdFx0XHR0aGlzLmNlbGxSZW5kZXJlZCgpO1xuXG5cdFx0XHRpZih0aGlzLmNvbHVtbi5kZWZpbml0aW9uLmNlbGxFZGl0ZWQpe1xuXHRcdFx0XHR0aGlzLmNvbHVtbi5kZWZpbml0aW9uLmNlbGxFZGl0ZWQuY2FsbCh0aGlzLnRhYmxlLCB0aGlzLmdldENvbXBvbmVudCgpKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiY2VsbEVkaXRlZFwiLCB0aGlzLmdldENvbXBvbmVudCgpKTtcblxuXHRcdFx0aWYodGhpcy5zdWJzY3JpYmVkRXh0ZXJuYWwoXCJkYXRhQ2hhbmdlZFwiKSl7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImRhdGFDaGFuZ2VkXCIsIHRoaXMudGFibGUucm93TWFuYWdlci5nZXREYXRhKCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHNldFZhbHVlUHJvY2Vzc0RhdGEodmFsdWUsIG11dGF0ZSwgZm9yY2Upe1xuXHRcdHZhciBjaGFuZ2VkID0gZmFsc2U7XG5cblx0XHRpZih0aGlzLnZhbHVlICE9PSB2YWx1ZSB8fCBmb3JjZSl7XG5cblx0XHRcdGNoYW5nZWQgPSB0cnVlO1xuXG5cdFx0XHRpZihtdXRhdGUpe1xuXHRcdFx0XHR2YWx1ZSA9IHRoaXMuY2hhaW4oXCJjZWxsLXZhbHVlLWNoYW5naW5nXCIsIFt0aGlzLCB2YWx1ZV0sIG51bGwsIHZhbHVlKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLnNldFZhbHVlQWN0dWFsKHZhbHVlKTtcblxuXHRcdGlmKGNoYW5nZWQpe1xuXHRcdFx0dGhpcy5kaXNwYXRjaChcImNlbGwtdmFsdWUtY2hhbmdlZFwiLCB0aGlzKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY2hhbmdlZDtcblx0fVxuXG5cdHNldFZhbHVlQWN0dWFsKHZhbHVlKXtcblx0XHR0aGlzLm9sZFZhbHVlID0gdGhpcy52YWx1ZTtcblxuXHRcdHRoaXMudmFsdWUgPSB2YWx1ZTtcblxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjZWxsLXZhbHVlLXNhdmUtYmVmb3JlXCIsIHRoaXMpO1xuXG5cdFx0dGhpcy5jb2x1bW4uc2V0RmllbGRWYWx1ZSh0aGlzLnJvdy5kYXRhLCB2YWx1ZSk7XG5cblx0XHR0aGlzLmRpc3BhdGNoKFwiY2VsbC12YWx1ZS1zYXZlLWFmdGVyXCIsIHRoaXMpO1xuXG5cdFx0aWYodGhpcy5sb2FkZWQpe1xuXHRcdFx0dGhpcy5sYXlvdXRFbGVtZW50KCk7XG5cdFx0fVxuXHR9XG5cblx0bGF5b3V0RWxlbWVudCgpe1xuXHRcdHRoaXMuX2dlbmVyYXRlQ29udGVudHMoKTtcblxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjZWxsLWxheW91dFwiLCB0aGlzKTtcblx0fVxuXG5cdHNldFdpZHRoKCl7XG5cdFx0dGhpcy53aWR0aCA9IHRoaXMuY29sdW1uLndpZHRoO1xuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMuY29sdW1uLndpZHRoU3R5bGVkO1xuXHR9XG5cblx0Y2xlYXJXaWR0aCgpe1xuXHRcdHRoaXMud2lkdGggPSBcIlwiO1xuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IFwiXCI7XG5cdH1cblxuXHRnZXRXaWR0aCgpe1xuXHRcdHJldHVybiB0aGlzLndpZHRoIHx8IHRoaXMuZWxlbWVudC5vZmZzZXRXaWR0aDtcblx0fVxuXG5cdHNldE1pbldpZHRoKCl7XG5cdFx0dGhpcy5taW5XaWR0aCA9IHRoaXMuY29sdW1uLm1pbldpZHRoO1xuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS5taW5XaWR0aCA9IHRoaXMuY29sdW1uLm1pbldpZHRoU3R5bGVkO1xuXHR9XG5cblx0c2V0TWF4V2lkdGgoKXtcblx0XHR0aGlzLm1heFdpZHRoID0gdGhpcy5jb2x1bW4ubWF4V2lkdGg7XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLm1heFdpZHRoID0gdGhpcy5jb2x1bW4ubWF4V2lkdGhTdHlsZWQ7XG5cdH1cblxuXHRjaGVja0hlaWdodCgpe1xuXHRcdC8vIHZhciBoZWlnaHQgPSB0aGlzLmVsZW1lbnQuY3NzKFwiaGVpZ2h0XCIpO1xuXHRcdHRoaXMucm93LnJlaW5pdGlhbGl6ZUhlaWdodCgpO1xuXHR9XG5cblx0Y2xlYXJIZWlnaHQoKXtcblx0XHR0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gXCJcIjtcblx0XHR0aGlzLmhlaWdodCA9IG51bGw7XG5cblx0XHR0aGlzLmRpc3BhdGNoKFwiY2VsbC1oZWlnaHRcIiwgdGhpcywgXCJcIik7XG5cdH1cblxuXHRzZXRIZWlnaHQoKXtcblx0XHR0aGlzLmhlaWdodCA9IHRoaXMucm93LmhlaWdodDtcblx0XHR0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gdGhpcy5yb3cuaGVpZ2h0U3R5bGVkO1xuXG5cdFx0dGhpcy5kaXNwYXRjaChcImNlbGwtaGVpZ2h0XCIsIHRoaXMsIHRoaXMucm93LmhlaWdodFN0eWxlZCk7XG5cdH1cblxuXHRnZXRIZWlnaHQoKXtcblx0XHRyZXR1cm4gdGhpcy5oZWlnaHQgfHwgdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodDtcblx0fVxuXG5cdHNob3coKXtcblx0XHR0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IHRoaXMuY29sdW1uLnZlcnRBbGlnbiA/IFwiaW5saW5lLWZsZXhcIiA6IFwiXCI7XG5cdH1cblxuXHRoaWRlKCl7XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0fVxuXG5cdGRlbGV0ZSgpe1xuXHRcdHRoaXMuZGlzcGF0Y2goXCJjZWxsLWRlbGV0ZVwiLCB0aGlzKTtcblxuXHRcdGlmKCF0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVkcmF3QmxvY2sgJiYgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUpe1xuXHRcdFx0dGhpcy5lbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KTtcblx0XHR9XG5cblx0XHR0aGlzLmVsZW1lbnQgPSBmYWxzZTtcblx0XHR0aGlzLmNvbHVtbi5kZWxldGVDZWxsKHRoaXMpO1xuXHRcdHRoaXMucm93LmRlbGV0ZUNlbGwodGhpcyk7XG5cdFx0dGhpcy5jYWxjcyA9IHt9O1xuXHR9XG5cblx0Z2V0SW5kZXgoKXtcblx0XHRyZXR1cm4gdGhpcy5yb3cuZ2V0Q2VsbEluZGV4KHRoaXMpO1xuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLyBPYmplY3QgR2VuZXJhdGlvbiAvLy8vLy8vLy8vLy8vLy8vL1xuXHRnZXRDb21wb25lbnQoKXtcblx0XHRpZighdGhpcy5jb21wb25lbnQpe1xuXHRcdFx0dGhpcy5jb21wb25lbnQgPSBuZXcgQ2VsbENvbXBvbmVudCh0aGlzKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5jb21wb25lbnQ7XG5cdH1cbn1cblxuLy9wdWJsaWMgY29sdW1uIG9iamVjdFxuY2xhc3MgQ29sdW1uQ29tcG9uZW50IHtcblx0Y29uc3RydWN0b3IgKGNvbHVtbil7XG5cdFx0dGhpcy5fY29sdW1uID0gY29sdW1uO1xuXHRcdHRoaXMudHlwZSA9IFwiQ29sdW1uQ29tcG9uZW50XCI7XG5cblx0XHRyZXR1cm4gbmV3IFByb3h5KHRoaXMsIHtcblx0XHRcdGdldDogZnVuY3Rpb24odGFyZ2V0LCBuYW1lLCByZWNlaXZlcikge1xuXHRcdFx0XHRpZiAodHlwZW9mIHRhcmdldFtuYW1lXSAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdHJldHVybiB0YXJnZXRbbmFtZV07XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gdGFyZ2V0Ll9jb2x1bW4udGFibGUuY29tcG9uZW50RnVuY3Rpb25CaW5kZXIuaGFuZGxlKFwiY29sdW1uXCIsIHRhcmdldC5fY29sdW1uLCBuYW1lKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0Z2V0RWxlbWVudCgpe1xuXHRcdHJldHVybiB0aGlzLl9jb2x1bW4uZ2V0RWxlbWVudCgpO1xuXHR9XG5cblx0Z2V0RGVmaW5pdGlvbigpe1xuXHRcdHJldHVybiB0aGlzLl9jb2x1bW4uZ2V0RGVmaW5pdGlvbigpO1xuXHR9XG5cblx0Z2V0RmllbGQoKXtcblx0XHRyZXR1cm4gdGhpcy5fY29sdW1uLmdldEZpZWxkKCk7XG5cdH1cblxuXHRnZXRUaXRsZURvd25sb2FkKCkge1xuXHRcdHJldHVybiB0aGlzLl9jb2x1bW4uZ2V0VGl0bGVEb3dubG9hZCgpO1xuXHR9XG5cblx0Z2V0Q2VsbHMoKXtcblx0XHR2YXIgY2VsbHMgPSBbXTtcblxuXHRcdHRoaXMuX2NvbHVtbi5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uKGNlbGwpe1xuXHRcdFx0Y2VsbHMucHVzaChjZWxsLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblxuXHRcdHJldHVybiBjZWxscztcblx0fVxuXG5cdGlzVmlzaWJsZSgpe1xuXHRcdHJldHVybiB0aGlzLl9jb2x1bW4udmlzaWJsZTtcblx0fVxuXG5cdHNob3coKXtcblx0XHRpZih0aGlzLl9jb2x1bW4uaXNHcm91cCl7XG5cdFx0XHR0aGlzLl9jb2x1bW4uY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRcdGNvbHVtbi5zaG93KCk7XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLl9jb2x1bW4uc2hvdygpO1xuXHRcdH1cblx0fVxuXG5cdGhpZGUoKXtcblx0XHRpZih0aGlzLl9jb2x1bW4uaXNHcm91cCl7XG5cdFx0XHR0aGlzLl9jb2x1bW4uY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRcdGNvbHVtbi5oaWRlKCk7XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLl9jb2x1bW4uaGlkZSgpO1xuXHRcdH1cblx0fVxuXG5cdHRvZ2dsZSgpe1xuXHRcdGlmKHRoaXMuX2NvbHVtbi52aXNpYmxlKXtcblx0XHRcdHRoaXMuaGlkZSgpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuc2hvdygpO1xuXHRcdH1cblx0fVxuXG5cdGRlbGV0ZSgpe1xuXHRcdHJldHVybiB0aGlzLl9jb2x1bW4uZGVsZXRlKCk7XG5cdH1cblxuXHRnZXRTdWJDb2x1bW5zKCl7XG5cdFx0dmFyIG91dHB1dCA9IFtdO1xuXG5cdFx0aWYodGhpcy5fY29sdW1uLmNvbHVtbnMubGVuZ3RoKXtcblx0XHRcdHRoaXMuX2NvbHVtbi5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24oY29sdW1uKXtcblx0XHRcdFx0b3V0cHV0LnB1c2goY29sdW1uLmdldENvbXBvbmVudCgpKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblxuXHRnZXRQYXJlbnRDb2x1bW4oKXtcblx0XHRyZXR1cm4gdGhpcy5fY29sdW1uLmdldFBhcmVudENvbXBvbmVudCgpO1xuXHR9XG5cblx0X2dldFNlbGYoKXtcblx0XHRyZXR1cm4gdGhpcy5fY29sdW1uO1xuXHR9XG5cblx0c2Nyb2xsVG8ocG9zaXRpb24sIGlmVmlzaWJsZSl7XG5cdFx0cmV0dXJuIHRoaXMuX2NvbHVtbi50YWJsZS5jb2x1bW5NYW5hZ2VyLnNjcm9sbFRvQ29sdW1uKHRoaXMuX2NvbHVtbiwgcG9zaXRpb24sIGlmVmlzaWJsZSk7XG5cdH1cblxuXHRnZXRUYWJsZSgpe1xuXHRcdHJldHVybiB0aGlzLl9jb2x1bW4udGFibGU7XG5cdH1cblxuXHRtb3ZlKHRvLCBhZnRlcil7XG5cdFx0dmFyIHRvQ29sdW1uID0gdGhpcy5fY29sdW1uLnRhYmxlLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbih0byk7XG5cblx0XHRpZih0b0NvbHVtbil7XG5cdFx0XHR0aGlzLl9jb2x1bW4udGFibGUuY29sdW1uTWFuYWdlci5tb3ZlQ29sdW1uKHRoaXMuX2NvbHVtbiwgdG9Db2x1bW4sIGFmdGVyKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJNb3ZlIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCB0b0NvbHVtbik7XG5cdFx0fVxuXHR9XG5cblx0Z2V0TmV4dENvbHVtbigpe1xuXHRcdHZhciBuZXh0Q29sID0gdGhpcy5fY29sdW1uLm5leHRDb2x1bW4oKTtcblxuXHRcdHJldHVybiBuZXh0Q29sID8gbmV4dENvbC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xuXHR9XG5cblx0Z2V0UHJldkNvbHVtbigpe1xuXHRcdHZhciBwcmV2Q29sID0gdGhpcy5fY29sdW1uLnByZXZDb2x1bW4oKTtcblxuXHRcdHJldHVybiBwcmV2Q29sID8gcHJldkNvbC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xuXHR9XG5cblx0dXBkYXRlRGVmaW5pdGlvbih1cGRhdGVzKXtcblx0XHRyZXR1cm4gdGhpcy5fY29sdW1uLnVwZGF0ZURlZmluaXRpb24odXBkYXRlcyk7XG5cdH1cblxuXHRnZXRXaWR0aCgpe1xuXHRcdHJldHVybiB0aGlzLl9jb2x1bW4uZ2V0V2lkdGgoKTtcblx0fVxuXG5cdHNldFdpZHRoKHdpZHRoKXtcblx0XHR2YXIgcmVzdWx0O1xuXG5cdFx0aWYod2lkdGggPT09IHRydWUpe1xuXHRcdFx0cmVzdWx0ID0gIHRoaXMuX2NvbHVtbi5yZWluaXRpYWxpemVXaWR0aCh0cnVlKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXN1bHQgPSAgdGhpcy5fY29sdW1uLnNldFdpZHRoKHdpZHRoKTtcblx0XHR9XG5cblx0XHR0aGlzLl9jb2x1bW4udGFibGUuY29sdW1uTWFuYWdlci5yZXJlbmRlckNvbHVtbnModHJ1ZSk7XG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9XG59XG5cbnZhciBkZWZhdWx0Q29sdW1uT3B0aW9ucyA9IHtcblx0XCJ0aXRsZVwiOiB1bmRlZmluZWQsXG5cdFwiZmllbGRcIjogdW5kZWZpbmVkLFxuXHRcImNvbHVtbnNcIjogdW5kZWZpbmVkLFxuXHRcInZpc2libGVcIjogdW5kZWZpbmVkLFxuXHRcImhvekFsaWduXCI6IHVuZGVmaW5lZCxcblx0XCJ2ZXJ0QWxpZ25cIjogdW5kZWZpbmVkLFxuXHRcIndpZHRoXCI6IHVuZGVmaW5lZCxcblx0XCJtaW5XaWR0aFwiOiA0MCxcblx0XCJtYXhXaWR0aFwiOiB1bmRlZmluZWQsXG5cdFwibWF4SW5pdGlhbFdpZHRoXCI6IHVuZGVmaW5lZCxcblx0XCJjc3NDbGFzc1wiOiB1bmRlZmluZWQsXG5cdFwidmFyaWFibGVIZWlnaHRcIjogdW5kZWZpbmVkLFxuXHRcImhlYWRlclZlcnRpY2FsXCI6IHVuZGVmaW5lZCxcblx0XCJoZWFkZXJIb3pBbGlnblwiOiB1bmRlZmluZWQsXG5cdFwiaGVhZGVyV29yZFdyYXBcIjogZmFsc2UsXG5cdFwiZWRpdGFibGVUaXRsZVwiOiB1bmRlZmluZWQsXG59O1xuXG5jbGFzcyBDb2x1bW4gZXh0ZW5kcyBDb3JlRmVhdHVyZXtcblx0XG5cdHN0YXRpYyBkZWZhdWx0T3B0aW9uTGlzdCA9IGRlZmF1bHRDb2x1bW5PcHRpb25zO1xuXHRcblx0Y29uc3RydWN0b3IoZGVmLCBwYXJlbnQsIHJvd0hlYWRlcil7XG5cdFx0c3VwZXIocGFyZW50LnRhYmxlKTtcblx0XHRcblx0XHR0aGlzLmRlZmluaXRpb24gPSBkZWY7IC8vY29sdW1uIGRlZmluaXRpb25cblx0XHR0aGlzLnBhcmVudCA9IHBhcmVudDsgLy9ob2xkIHBhcmVudCBvYmplY3Rcblx0XHR0aGlzLnR5cGUgPSBcImNvbHVtblwiOyAvL3R5cGUgb2YgZWxlbWVudFxuXHRcdHRoaXMuY29sdW1ucyA9IFtdOyAvL2NoaWxkIGNvbHVtbnNcblx0XHR0aGlzLmNlbGxzID0gW107IC8vY2VsbHMgYm91bmQgdG8gdGhpcyBjb2x1bW5cblx0XHR0aGlzLmlzR3JvdXAgPSBmYWxzZTtcblx0XHR0aGlzLmlzUm93SGVhZGVyID0gcm93SGVhZGVyO1xuXHRcdHRoaXMuZWxlbWVudCA9IHRoaXMuY3JlYXRlRWxlbWVudCgpOyAvL2NvbHVtbiBoZWFkZXIgZWxlbWVudFxuXHRcdHRoaXMuY29udGVudEVsZW1lbnQgPSBmYWxzZTtcblx0XHR0aGlzLnRpdGxlSG9sZGVyRWxlbWVudCA9IGZhbHNlO1xuXHRcdHRoaXMudGl0bGVFbGVtZW50ID0gZmFsc2U7XG5cdFx0dGhpcy5ncm91cEVsZW1lbnQgPSB0aGlzLmNyZWF0ZUdyb3VwRWxlbWVudCgpOyAvL2NvbHVtbiBncm91cCBob2xkZXIgZWxlbWVudFxuXHRcdHRoaXMuaG96QWxpZ24gPSBcIlwiOyAvL2hvcml6b250YWwgdGV4dCBhbGlnbm1lbnRcblx0XHR0aGlzLnZlcnRBbGlnbiA9IFwiXCI7IC8vdmVydCB0ZXh0IGFsaWdubWVudFxuXHRcdFxuXHRcdC8vbXVsdGkgZGltZW5zaW9uYWwgZmlsZWQgaGFuZGxpbmdcblx0XHR0aGlzLmZpZWxkID1cIlwiO1xuXHRcdHRoaXMuZmllbGRTdHJ1Y3R1cmUgPSBcIlwiO1xuXHRcdHRoaXMuZ2V0RmllbGRWYWx1ZSA9IFwiXCI7XG5cdFx0dGhpcy5zZXRGaWVsZFZhbHVlID0gXCJcIjtcblx0XHRcblx0XHR0aGlzLnRpdGxlRG93bmxvYWQgPSBudWxsO1xuXHRcdHRoaXMudGl0bGVGb3JtYXR0ZXJSZW5kZXJlZCA9IGZhbHNlO1xuXHRcdFxuXHRcdHRoaXMubWFwRGVmaW5pdGlvbnMoKTtcblx0XHRcblx0XHR0aGlzLnNldEZpZWxkKHRoaXMuZGVmaW5pdGlvbi5maWVsZCk7XG5cdFx0XG5cdFx0dGhpcy5tb2R1bGVzID0ge307IC8vaG9sZCBtb2R1bGUgdmFyaWFibGVzO1xuXHRcdFxuXHRcdHRoaXMud2lkdGggPSBudWxsOyAvL2NvbHVtbiB3aWR0aFxuXHRcdHRoaXMud2lkdGhTdHlsZWQgPSBcIlwiOyAvL2NvbHVtbiB3aWR0aCBwcmUtc3R5bGVkIHRvIGltcHJvdmUgcmVuZGVyIGVmZmljaWVuY3lcblx0XHR0aGlzLm1heFdpZHRoID0gbnVsbDsgLy9jb2x1bW4gbWF4aW11bSB3aWR0aFxuXHRcdHRoaXMubWF4V2lkdGhTdHlsZWQgPSBcIlwiOyAvL2NvbHVtbiBtYXhpbXVtIHByZS1zdHlsZWQgdG8gaW1wcm92ZSByZW5kZXIgZWZmaWNpZW5jeVxuXHRcdHRoaXMubWF4SW5pdGlhbFdpZHRoID0gbnVsbDtcblx0XHR0aGlzLm1pbldpZHRoID0gbnVsbDsgLy9jb2x1bW4gbWluaW11bSB3aWR0aFxuXHRcdHRoaXMubWluV2lkdGhTdHlsZWQgPSBcIlwiOyAvL2NvbHVtbiBtaW5pbXVtIHByZS1zdHlsZWQgdG8gaW1wcm92ZSByZW5kZXIgZWZmaWNpZW5jeVxuXHRcdHRoaXMud2lkdGhGaXhlZCA9IGZhbHNlOyAvL3VzZXIgaGFzIHNwZWNpZmllZCBhIHdpZHRoIGZvciB0aGlzIGNvbHVtblxuXHRcdFxuXHRcdHRoaXMudmlzaWJsZSA9IHRydWU7IC8vZGVmYXVsdCB2aXNpYmxlIHN0YXRlXG5cdFx0XG5cdFx0dGhpcy5jb21wb25lbnQgPSBudWxsO1xuXHRcdFxuXHRcdC8vaW5pdGlhbGl6ZSBjb2x1bW5cblx0XHRpZih0aGlzLmRlZmluaXRpb24uY29sdW1ucyl7XG5cdFx0XHRcblx0XHRcdHRoaXMuaXNHcm91cCA9IHRydWU7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGVmaW5pdGlvbi5jb2x1bW5zLmZvckVhY2goKGRlZiwgaSkgPT4ge1xuXHRcdFx0XHR2YXIgbmV3Q29sID0gbmV3IENvbHVtbihkZWYsIHRoaXMpO1xuXHRcdFx0XHR0aGlzLmF0dGFjaENvbHVtbihuZXdDb2wpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMuY2hlY2tDb2x1bW5WaXNpYmlsaXR5KCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0cGFyZW50LnJlZ2lzdGVyQ29sdW1uRmllbGQodGhpcyk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuX2luaXRpYWxpemUoKTtcblx0fVxuXHRcblx0Y3JlYXRlRWxlbWVudCAoKXtcblx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFxuXHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItY29sXCIpO1xuXHRcdGVsLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJjb2x1bW5oZWFkZXJcIik7XG5cdFx0ZWwuc2V0QXR0cmlidXRlKFwiYXJpYS1zb3J0XCIsIFwibm9uZVwiKTtcblxuXHRcdGlmKHRoaXMuaXNSb3dIZWFkZXIpe1xuXHRcdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1yb3ctaGVhZGVyXCIpO1xuXHRcdH1cblx0XHRcblx0XHRzd2l0Y2godGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkhlYWRlclZlcnRBbGlnbil7XG5cdFx0XHRjYXNlIFwibWlkZGxlXCI6XG5cdFx0XHRcdGVsLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gXCJjZW50ZXJcIjtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYm90dG9tXCI6XG5cdFx0XHRcdGVsLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gXCJmbGV4LWVuZFwiO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGVsO1xuXHR9XG5cdFxuXHRjcmVhdGVHcm91cEVsZW1lbnQgKCl7XG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbC1ncm91cC1jb2xzXCIpO1xuXHRcdFxuXHRcdHJldHVybiBlbDtcblx0fVxuXHRcblx0bWFwRGVmaW5pdGlvbnMoKXtcblx0XHR2YXIgZGVmYXVsdHMgPSB0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1uRGVmYXVsdHM7XG5cdFx0XG5cdFx0Ly9tYXAgY29sdW1uRGVmYXVsdHMgb250byBjb2x1bW4gZGVmaW5pdGlvbnNcblx0XHRpZihkZWZhdWx0cyl7XG5cdFx0XHRmb3IobGV0IGtleSBpbiBkZWZhdWx0cyl7XG5cdFx0XHRcdGlmKHR5cGVvZiB0aGlzLmRlZmluaXRpb25ba2V5XSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0dGhpcy5kZWZpbml0aW9uW2tleV0gPSBkZWZhdWx0c1trZXldO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZGVmaW5pdGlvbiA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5vcHRpb25zTGlzdC5nZW5lcmF0ZShDb2x1bW4uZGVmYXVsdE9wdGlvbkxpc3QsIHRoaXMuZGVmaW5pdGlvbik7XG5cdH1cblx0XG5cdGNoZWNrRGVmaW5pdGlvbigpe1xuXHRcdE9iamVjdC5rZXlzKHRoaXMuZGVmaW5pdGlvbikuZm9yRWFjaCgoa2V5KSA9PiB7XG5cdFx0XHRpZihDb2x1bW4uZGVmYXVsdE9wdGlvbkxpc3QuaW5kZXhPZihrZXkpID09PSAtMSl7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkludmFsaWQgY29sdW1uIGRlZmluaXRpb24gb3B0aW9uIGluICdcIiArICh0aGlzLmZpZWxkIHx8IHRoaXMuZGVmaW5pdGlvbi50aXRsZSkgKyBcIicgY29sdW1uOlwiLCBrZXkpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0c2V0RmllbGQoZmllbGQpe1xuXHRcdHRoaXMuZmllbGQgPSBmaWVsZDtcblx0XHR0aGlzLmZpZWxkU3RydWN0dXJlID0gZmllbGQgPyAodGhpcy50YWJsZS5vcHRpb25zLm5lc3RlZEZpZWxkU2VwYXJhdG9yID8gZmllbGQuc3BsaXQodGhpcy50YWJsZS5vcHRpb25zLm5lc3RlZEZpZWxkU2VwYXJhdG9yKSA6IFtmaWVsZF0pIDogW107XG5cdFx0dGhpcy5nZXRGaWVsZFZhbHVlID0gdGhpcy5maWVsZFN0cnVjdHVyZS5sZW5ndGggPiAxID8gdGhpcy5fZ2V0TmVzdGVkRGF0YSA6IHRoaXMuX2dldEZsYXREYXRhO1xuXHRcdHRoaXMuc2V0RmllbGRWYWx1ZSA9IHRoaXMuZmllbGRTdHJ1Y3R1cmUubGVuZ3RoID4gMSA/IHRoaXMuX3NldE5lc3RlZERhdGEgOiB0aGlzLl9zZXRGbGF0RGF0YTtcblx0fVxuXHRcblx0Ly9yZWdpc3RlciBjb2x1bW4gcG9zaXRpb24gd2l0aCBjb2x1bW4gbWFuYWdlclxuXHRyZWdpc3RlckNvbHVtblBvc2l0aW9uKGNvbHVtbil7XG5cdFx0dGhpcy5wYXJlbnQucmVnaXN0ZXJDb2x1bW5Qb3NpdGlvbihjb2x1bW4pO1xuXHR9XG5cdFxuXHQvL3JlZ2lzdGVyIGNvbHVtbiBwb3NpdGlvbiB3aXRoIGNvbHVtbiBtYW5hZ2VyXG5cdHJlZ2lzdGVyQ29sdW1uRmllbGQoY29sdW1uKXtcblx0XHR0aGlzLnBhcmVudC5yZWdpc3RlckNvbHVtbkZpZWxkKGNvbHVtbik7XG5cdH1cblx0XG5cdC8vdHJpZ2dlciBwb3NpdGlvbiByZWdpc3RyYXRpb25cblx0cmVSZWdpc3RlclBvc2l0aW9uKCl7XG5cdFx0aWYodGhpcy5pc0dyb3VwKXtcblx0XHRcdHRoaXMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRcdGNvbHVtbi5yZVJlZ2lzdGVyUG9zaXRpb24oKTtcblx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5Qb3NpdGlvbih0aGlzKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vYnVpbGQgaGVhZGVyIGVsZW1lbnRcblx0X2luaXRpYWxpemUoKXtcblx0XHR2YXIgZGVmID0gdGhpcy5kZWZpbml0aW9uO1xuXHRcdFxuXHRcdHdoaWxlKHRoaXMuZWxlbWVudC5maXJzdENoaWxkKSB0aGlzLmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdFxuXHRcdGlmKGRlZi5oZWFkZXJWZXJ0aWNhbCl7XG5cdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtdmVydGljYWxcIik7XG5cdFx0XHRcblx0XHRcdGlmKGRlZi5oZWFkZXJWZXJ0aWNhbCA9PT0gXCJmbGlwXCIpe1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtdmVydGljYWwtZmxpcFwiKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jb250ZW50RWxlbWVudCA9IHRoaXMuX2J1aWxkQ29sdW1uSGVhZGVyQ29udGVudCgpO1xuXHRcdFxuXHRcdHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRlbnRFbGVtZW50KTtcblx0XHRcblx0XHRpZih0aGlzLmlzR3JvdXApe1xuXHRcdFx0dGhpcy5fYnVpbGRHcm91cEhlYWRlcigpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuX2J1aWxkQ29sdW1uSGVhZGVyKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjb2x1bW4taW5pdFwiLCB0aGlzKTtcblx0fVxuXHRcblx0Ly9idWlsZCBoZWFkZXIgZWxlbWVudCBmb3IgaGVhZGVyXG5cdF9idWlsZENvbHVtbkhlYWRlcigpe1xuXHRcdHZhciBkZWYgPSB0aGlzLmRlZmluaXRpb247XG5cdFx0XG5cdFx0dGhpcy5kaXNwYXRjaChcImNvbHVtbi1sYXlvdXRcIiwgdGhpcyk7XG5cdFx0XG5cdFx0Ly9zZXQgY29sdW1uIHZpc2liaWxpdHlcblx0XHRpZih0eXBlb2YgZGVmLnZpc2libGUgIT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRpZihkZWYudmlzaWJsZSl7XG5cdFx0XHRcdHRoaXMuc2hvdyh0cnVlKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5oaWRlKHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvL2Fzc2lnbiBhZGRpdGlvbmFsIGNzcyBjbGFzc2VzIHRvIGNvbHVtbiBoZWFkZXJcblx0XHRpZihkZWYuY3NzQ2xhc3Mpe1xuXHRcdFx0dmFyIGNsYXNzTmFtZXMgPSBkZWYuY3NzQ2xhc3Muc3BsaXQoXCIgXCIpO1xuXHRcdFx0Y2xhc3NOYW1lcy5mb3JFYWNoKChjbGFzc05hbWUpID0+IHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0XHRpZihkZWYuZmllbGQpe1xuXHRcdFx0dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcInRhYnVsYXRvci1maWVsZFwiLCBkZWYuZmllbGQpO1xuXHRcdH1cblx0XHRcblx0XHQvL3NldCBtaW4gd2lkdGggaWYgcHJlc2VudFxuXHRcdHRoaXMuc2V0TWluV2lkdGgocGFyc2VJbnQoZGVmLm1pbldpZHRoKSk7XG5cdFx0XG5cdFx0aWYgKGRlZi5tYXhJbml0aWFsV2lkdGgpIHtcblx0XHRcdHRoaXMubWF4SW5pdGlhbFdpZHRoID0gcGFyc2VJbnQoZGVmLm1heEluaXRpYWxXaWR0aCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGRlZi5tYXhXaWR0aCl7XG5cdFx0XHR0aGlzLnNldE1heFdpZHRoKHBhcnNlSW50KGRlZi5tYXhXaWR0aCkpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnJlaW5pdGlhbGl6ZVdpZHRoKCk7XG5cdFx0XG5cdFx0Ly9zZXQgaG9yaXpvbnRhbCB0ZXh0IGFsaWdubWVudFxuXHRcdHRoaXMuaG96QWxpZ24gPSB0aGlzLmRlZmluaXRpb24uaG96QWxpZ247XG5cdFx0dGhpcy52ZXJ0QWxpZ24gPSB0aGlzLmRlZmluaXRpb24udmVydEFsaWduO1xuXHRcdFxuXHRcdHRoaXMudGl0bGVFbGVtZW50LnN0eWxlLnRleHRBbGlnbiA9IHRoaXMuZGVmaW5pdGlvbi5oZWFkZXJIb3pBbGlnbjtcblx0fVxuXHRcblx0X2J1aWxkQ29sdW1uSGVhZGVyQ29udGVudCgpe1xuXHRcdHZhciBjb250ZW50RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Y29udGVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtY29udGVudFwiKTtcblx0XHRcblx0XHR0aGlzLnRpdGxlSG9sZGVyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0dGhpcy50aXRsZUhvbGRlckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtdGl0bGUtaG9sZGVyXCIpO1xuXHRcdFxuXHRcdGNvbnRlbnRFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMudGl0bGVIb2xkZXJFbGVtZW50KTtcblx0XHRcblx0XHR0aGlzLnRpdGxlRWxlbWVudCA9IHRoaXMuX2J1aWxkQ29sdW1uSGVhZGVyVGl0bGUoKTtcblx0XHRcblx0XHR0aGlzLnRpdGxlSG9sZGVyRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLnRpdGxlRWxlbWVudCk7XG5cdFx0XG5cdFx0cmV0dXJuIGNvbnRlbnRFbGVtZW50O1xuXHR9XG5cdFxuXHQvL2J1aWxkIHRpdGxlIGVsZW1lbnQgb2YgY29sdW1uXG5cdF9idWlsZENvbHVtbkhlYWRlclRpdGxlKCl7XG5cdFx0dmFyIGRlZiA9IHRoaXMuZGVmaW5pdGlvbjtcblx0XHRcblx0XHR2YXIgdGl0bGVIb2xkZXJFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aXRsZUhvbGRlckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtdGl0bGVcIik7XG5cdFx0XG5cdFx0aWYoZGVmLmhlYWRlcldvcmRXcmFwKXtcblx0XHRcdHRpdGxlSG9sZGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbC10aXRsZS13cmFwXCIpO1xuXHRcdH1cblx0XHRcblx0XHRpZihkZWYuZWRpdGFibGVUaXRsZSl7XG5cdFx0XHR2YXIgdGl0bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuXHRcdFx0dGl0bGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItdGl0bGUtZWRpdG9yXCIpO1xuXHRcdFx0XG5cdFx0XHR0aXRsZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdHRpdGxlRWxlbWVudC5mb2N1cygpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRpdGxlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGl0bGVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKCkgPT4ge1xuXHRcdFx0XHRkZWYudGl0bGUgPSB0aXRsZUVsZW1lbnQudmFsdWU7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImNvbHVtblRpdGxlQ2hhbmdlZFwiLCB0aGlzLmdldENvbXBvbmVudCgpKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aXRsZUhvbGRlckVsZW1lbnQuYXBwZW5kQ2hpbGQodGl0bGVFbGVtZW50KTtcblx0XHRcdFxuXHRcdFx0aWYoZGVmLmZpZWxkKXtcblx0XHRcdFx0dGhpcy5sYW5nQmluZChcImNvbHVtbnN8XCIgKyBkZWYuZmllbGQsICh0ZXh0KSA9PiB7XG5cdFx0XHRcdFx0dGl0bGVFbGVtZW50LnZhbHVlID0gdGV4dCB8fCAoZGVmLnRpdGxlIHx8IFwiJm5ic3A7XCIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGl0bGVFbGVtZW50LnZhbHVlICA9IGRlZi50aXRsZSB8fCBcIiZuYnNwO1wiO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYoZGVmLmZpZWxkKXtcblx0XHRcdFx0dGhpcy5sYW5nQmluZChcImNvbHVtbnN8XCIgKyBkZWYuZmllbGQsICh0ZXh0KSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5fZm9ybWF0Q29sdW1uSGVhZGVyVGl0bGUodGl0bGVIb2xkZXJFbGVtZW50LCB0ZXh0IHx8IChkZWYudGl0bGUgfHwgXCImbmJzcDtcIikpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5fZm9ybWF0Q29sdW1uSGVhZGVyVGl0bGUodGl0bGVIb2xkZXJFbGVtZW50LCBkZWYudGl0bGUgfHwgXCImbmJzcDtcIik7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0aXRsZUhvbGRlckVsZW1lbnQ7XG5cdH1cblx0XG5cdF9mb3JtYXRDb2x1bW5IZWFkZXJUaXRsZShlbCwgdGl0bGUpe1xuXHRcdHZhciBjb250ZW50cyA9IHRoaXMuY2hhaW4oXCJjb2x1bW4tZm9ybWF0XCIsIFt0aGlzLCB0aXRsZSwgZWxdLCBudWxsLCAoKSA9PiB7XG5cdFx0XHRyZXR1cm4gdGl0bGU7XG5cdFx0fSk7XG5cdFx0XG5cdFx0c3dpdGNoKHR5cGVvZiBjb250ZW50cyl7XG5cdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdGlmKGNvbnRlbnRzIGluc3RhbmNlb2YgTm9kZSl7XG5cdFx0XHRcdFx0ZWwuYXBwZW5kQ2hpbGQoY29udGVudHMpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJGb3JtYXQgRXJyb3IgLSBUaXRsZSBmb3JtYXR0ZXIgaGFzIHJldHVybmVkIGEgdHlwZSBvZiBvYmplY3QsIHRoZSBvbmx5IHZhbGlkIGZvcm1hdHRlciBvYmplY3QgcmV0dXJuIGlzIGFuIGluc3RhbmNlIG9mIE5vZGUsIHRoZSBmb3JtYXR0ZXIgcmV0dXJuZWQ6XCIsIGNvbnRlbnRzKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRlbC5pbm5lckhUTUwgPSBjb250ZW50cztcblx0XHR9XG5cdH1cblx0XG5cdC8vYnVpbGQgaGVhZGVyIGVsZW1lbnQgZm9yIGNvbHVtbiBncm91cFxuXHRfYnVpbGRHcm91cEhlYWRlcigpe1xuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbC1ncm91cFwiKTtcblx0XHR0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImNvbHVtbmdyb3VwXCIpO1xuXHRcdHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXRpdGxlXCIsIHRoaXMuZGVmaW5pdGlvbi50aXRsZSk7XG5cdFx0XG5cdFx0Ly9hc2lnbiBhZGRpdGlvbmFsIGNzcyBjbGFzc2VzIHRvIGNvbHVtbiBoZWFkZXJcblx0XHRpZih0aGlzLmRlZmluaXRpb24uY3NzQ2xhc3Mpe1xuXHRcdFx0dmFyIGNsYXNzTmFtZXMgPSB0aGlzLmRlZmluaXRpb24uY3NzQ2xhc3Muc3BsaXQoXCIgXCIpO1xuXHRcdFx0Y2xhc3NOYW1lcy5mb3JFYWNoKChjbGFzc05hbWUpID0+IHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnRpdGxlRWxlbWVudC5zdHlsZS50ZXh0QWxpZ24gPSB0aGlzLmRlZmluaXRpb24uaGVhZGVySG96QWxpZ247XG5cdFx0XG5cdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuZ3JvdXBFbGVtZW50KTtcblx0fVxuXHRcblx0Ly9mbGF0IGZpZWxkIGxvb2t1cFxuXHRfZ2V0RmxhdERhdGEoZGF0YSl7XG5cdFx0cmV0dXJuIGRhdGFbdGhpcy5maWVsZF07XG5cdH1cblx0XG5cdC8vbmVzdGVkIGZpZWxkIGxvb2t1cFxuXHRfZ2V0TmVzdGVkRGF0YShkYXRhKXtcblx0XHR2YXIgZGF0YU9iaiA9IGRhdGEsXG5cdFx0c3RydWN0dXJlID0gdGhpcy5maWVsZFN0cnVjdHVyZSxcblx0XHRsZW5ndGggPSBzdHJ1Y3R1cmUubGVuZ3RoLFxuXHRcdG91dHB1dDtcblx0XHRcblx0XHRmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspe1xuXHRcdFx0XG5cdFx0XHRkYXRhT2JqID0gZGF0YU9ialtzdHJ1Y3R1cmVbaV1dO1xuXHRcdFx0XG5cdFx0XHRvdXRwdXQgPSBkYXRhT2JqO1xuXHRcdFx0XG5cdFx0XHRpZighZGF0YU9iail7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cdFxuXHQvL2ZsYXQgZmllbGQgc2V0XG5cdF9zZXRGbGF0RGF0YShkYXRhLCB2YWx1ZSl7XG5cdFx0aWYodGhpcy5maWVsZCl7XG5cdFx0XHRkYXRhW3RoaXMuZmllbGRdID0gdmFsdWU7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL25lc3RlZCBmaWVsZCBzZXRcblx0X3NldE5lc3RlZERhdGEoZGF0YSwgdmFsdWUpe1xuXHRcdHZhciBkYXRhT2JqID0gZGF0YSxcblx0XHRzdHJ1Y3R1cmUgPSB0aGlzLmZpZWxkU3RydWN0dXJlLFxuXHRcdGxlbmd0aCA9IHN0cnVjdHVyZS5sZW5ndGg7XG5cdFx0XG5cdFx0Zm9yKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKXtcblx0XHRcdFxuXHRcdFx0aWYoaSA9PSBsZW5ndGggLTEpe1xuXHRcdFx0XHRkYXRhT2JqW3N0cnVjdHVyZVtpXV0gPSB2YWx1ZTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYoIWRhdGFPYmpbc3RydWN0dXJlW2ldXSl7XG5cdFx0XHRcdFx0aWYodHlwZW9mIHZhbHVlICE9PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdFx0XHRcdGRhdGFPYmpbc3RydWN0dXJlW2ldXSA9IHt9O1xuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0ZGF0YU9iaiA9IGRhdGFPYmpbc3RydWN0dXJlW2ldXTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8vYXR0YWNoIGNvbHVtbiB0byB0aGlzIGdyb3VwXG5cdGF0dGFjaENvbHVtbihjb2x1bW4pe1xuXHRcdGlmKHRoaXMuZ3JvdXBFbGVtZW50KXtcblx0XHRcdHRoaXMuY29sdW1ucy5wdXNoKGNvbHVtbik7XG5cdFx0XHR0aGlzLmdyb3VwRWxlbWVudC5hcHBlbmRDaGlsZChjb2x1bW4uZ2V0RWxlbWVudCgpKTtcblx0XHRcdFxuXHRcdFx0Y29sdW1uLmNvbHVtblJlbmRlcmVkKCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIFdhcm5pbmcgLSBDb2x1bW4gYmVpbmcgYXR0YWNoZWQgdG8gYW5vdGhlciBjb2x1bW4gaW5zdGVhZCBvZiBjb2x1bW4gZ3JvdXBcIik7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3ZlcnRpY2FsbHkgYWxpZ24gaGVhZGVyIGluIGNvbHVtblxuXHR2ZXJ0aWNhbEFsaWduKGFsaWdubWVudCwgaGVpZ2h0KXtcblx0XHRcblx0XHQvL2NhbGN1bGF0ZSBoZWlnaHQgb2YgY29sdW1uIGhlYWRlciBhbmQgZ3JvdXAgaG9sZGVyIGVsZW1lbnRcblx0XHR2YXIgcGFyZW50SGVpZ2h0ID0gdGhpcy5wYXJlbnQuaXNHcm91cCA/IHRoaXMucGFyZW50LmdldEdyb3VwRWxlbWVudCgpLmNsaWVudEhlaWdodCA6IChoZWlnaHQgfHwgdGhpcy5wYXJlbnQuZ2V0SGVhZGVyc0VsZW1lbnQoKS5jbGllbnRIZWlnaHQpO1xuXHRcdC8vIHZhciBwYXJlbnRIZWlnaHQgPSB0aGlzLnBhcmVudC5pc0dyb3VwID8gdGhpcy5wYXJlbnQuZ2V0R3JvdXBFbGVtZW50KCkuY2xpZW50SGVpZ2h0IDogdGhpcy5wYXJlbnQuZ2V0SGVhZGVyc0VsZW1lbnQoKS5jbGllbnRIZWlnaHQ7XG5cdFx0XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IHBhcmVudEhlaWdodCArIFwicHhcIjtcblx0XHRcblx0XHR0aGlzLmRpc3BhdGNoKFwiY29sdW1uLWhlaWdodFwiLCB0aGlzLCB0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0KTtcblx0XHRcblx0XHRpZih0aGlzLmlzR3JvdXApe1xuXHRcdFx0dGhpcy5ncm91cEVsZW1lbnQuc3R5bGUubWluSGVpZ2h0ID0gKHBhcmVudEhlaWdodCAtIHRoaXMuY29udGVudEVsZW1lbnQub2Zmc2V0SGVpZ2h0KSArIFwicHhcIjtcblx0XHR9XG5cdFx0XG5cdFx0Ly92ZXJ0aWNhbGx5IGFsaWduIGNlbGwgY29udGVudHNcblx0XHQvLyBpZighdGhpcy5pc0dyb3VwICYmIGFsaWdubWVudCAhPT0gXCJ0b3BcIil7XG5cdFx0Ly8gXHRpZihhbGlnbm1lbnQgPT09IFwiYm90dG9tXCIpe1xuXHRcdC8vIFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUucGFkZGluZ1RvcCA9ICh0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gdGhpcy5jb250ZW50RWxlbWVudC5vZmZzZXRIZWlnaHQpICsgXCJweFwiO1xuXHRcdC8vIFx0fWVsc2V7XG5cdFx0Ly8gXHRcdHRoaXMuZWxlbWVudC5zdHlsZS5wYWRkaW5nVG9wID0gKCh0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gdGhpcy5jb250ZW50RWxlbWVudC5vZmZzZXRIZWlnaHQpIC8gMikgKyBcInB4XCI7XG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfVxuXHRcdFxuXHRcdHRoaXMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRjb2x1bW4udmVydGljYWxBbGlnbihhbGlnbm1lbnQpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHQvL2NsZWFyIHZlcnRpY2FsIGFsaWdubWVudFxuXHRjbGVhclZlcnRpY2FsQWxpZ24oKXtcblx0XHR0aGlzLmVsZW1lbnQuc3R5bGUucGFkZGluZ1RvcCA9IFwiXCI7XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiXCI7XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9IFwiXCI7XG5cdFx0dGhpcy5ncm91cEVsZW1lbnQuc3R5bGUubWluSGVpZ2h0ID0gXCJcIjtcblx0XHRcblx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdFx0Y29sdW1uLmNsZWFyVmVydGljYWxBbGlnbigpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjb2x1bW4taGVpZ2h0XCIsIHRoaXMsIFwiXCIpO1xuXHR9XG5cdFxuXHQvLy8vIFJldHJpZXZlIENvbHVtbiBJbmZvcm1hdGlvbiAvLy8vXG5cdC8vcmV0dXJuIGNvbHVtbiBoZWFkZXIgZWxlbWVudFxuXHRnZXRFbGVtZW50KCl7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fVxuXHRcblx0Ly9yZXR1cm4gY29sdW1uIGdyb3VwIGVsZW1lbnRcblx0Z2V0R3JvdXBFbGVtZW50KCl7XG5cdFx0cmV0dXJuIHRoaXMuZ3JvdXBFbGVtZW50O1xuXHR9XG5cdFxuXHQvL3JldHVybiBmaWVsZCBuYW1lXG5cdGdldEZpZWxkKCl7XG5cdFx0cmV0dXJuIHRoaXMuZmllbGQ7XG5cdH1cblx0XG5cdGdldFRpdGxlRG93bmxvYWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGl0bGVEb3dubG9hZDtcblx0fVxuXHRcblx0Ly9yZXR1cm4gdGhlIGZpcnN0IGNvbHVtbiBpbiBhIGdyb3VwXG5cdGdldEZpcnN0Q29sdW1uKCl7XG5cdFx0aWYoIXRoaXMuaXNHcm91cCl7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZih0aGlzLmNvbHVtbnMubGVuZ3RoKXtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY29sdW1uc1swXS5nZXRGaXJzdENvbHVtbigpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3JldHVybiB0aGUgbGFzdCBjb2x1bW4gaW4gYSBncm91cFxuXHRnZXRMYXN0Q29sdW1uKCl7XG5cdFx0aWYoIXRoaXMuaXNHcm91cCl7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZih0aGlzLmNvbHVtbnMubGVuZ3RoKXtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY29sdW1uc1t0aGlzLmNvbHVtbnMubGVuZ3RoIC0xXS5nZXRMYXN0Q29sdW1uKCk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8vcmV0dXJuIGFsbCBjb2x1bW5zIGluIGEgZ3JvdXBcblx0Z2V0Q29sdW1ucyh0cmF2ZXJzZSl7XG5cdFx0dmFyIGNvbHVtbnMgPSBbXTtcblx0XHRcblx0XHRpZih0cmF2ZXJzZSl7XG5cdFx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdGNvbHVtbnMucHVzaChjb2x1bW4pO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29sdW1ucyA9IGNvbHVtbnMuY29uY2F0KGNvbHVtbi5nZXRDb2x1bW5zKHRydWUpKTtcblx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbHVtbnMgPSB0aGlzLmNvbHVtbnM7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBjb2x1bW5zO1xuXHR9XG5cdFxuXHQvL3JldHVybiBhbGwgY29sdW1ucyBpbiBhIGdyb3VwXG5cdGdldENlbGxzKCl7XG5cdFx0cmV0dXJuIHRoaXMuY2VsbHM7XG5cdH1cblx0XG5cdC8vcmV0cmlldmUgdGhlIHRvcCBjb2x1bW4gaW4gYSBncm91cCBvZiBjb2x1bW5zXG5cdGdldFRvcENvbHVtbigpe1xuXHRcdGlmKHRoaXMucGFyZW50LmlzR3JvdXApe1xuXHRcdFx0cmV0dXJuIHRoaXMucGFyZW50LmdldFRvcENvbHVtbigpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9yZXR1cm4gY29sdW1uIGRlZmluaXRpb24gb2JqZWN0XG5cdGdldERlZmluaXRpb24odXBkYXRlQnJhbmNoZXMpe1xuXHRcdHZhciBjb2xEZWZzID0gW107XG5cdFx0XG5cdFx0aWYodGhpcy5pc0dyb3VwICYmIHVwZGF0ZUJyYW5jaGVzKXtcblx0XHRcdHRoaXMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRcdGNvbERlZnMucHVzaChjb2x1bW4uZ2V0RGVmaW5pdGlvbih0cnVlKSk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5kZWZpbml0aW9uLmNvbHVtbnMgPSBjb2xEZWZzO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gdGhpcy5kZWZpbml0aW9uO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLyBBY3Rpb25zIC8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdGNoZWNrQ29sdW1uVmlzaWJpbGl0eSgpe1xuXHRcdHZhciB2aXNpYmxlID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24oY29sdW1uKXtcblx0XHRcdGlmKGNvbHVtbi52aXNpYmxlKXtcblx0XHRcdFx0dmlzaWJsZSA9IHRydWU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0aWYodmlzaWJsZSl7XG5cdFx0XHR0aGlzLnNob3coKTtcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImNvbHVtblZpc2liaWxpdHlDaGFuZ2VkXCIsIHRoaXMuZ2V0Q29tcG9uZW50KCksIGZhbHNlKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLmhpZGUoKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vc2hvdyBjb2x1bW5cblx0c2hvdyhzaWxlbnQsIHJlc3BvbnNpdmVUb2dnbGUpe1xuXHRcdGlmKCF0aGlzLnZpc2libGUpe1xuXHRcdFx0dGhpcy52aXNpYmxlID0gdHJ1ZTtcblx0XHRcdFxuXHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnBhcmVudC5pc0dyb3VwKXtcblx0XHRcdFx0dGhpcy5wYXJlbnQuY2hlY2tDb2x1bW5WaXNpYmlsaXR5KCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMuY2VsbHMuZm9yRWFjaChmdW5jdGlvbihjZWxsKXtcblx0XHRcdFx0Y2VsbC5zaG93KCk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0aWYoIXRoaXMuaXNHcm91cCAmJiB0aGlzLndpZHRoID09PSBudWxsKXtcblx0XHRcdFx0dGhpcy5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIudmVydGljYWxBbGlnbkhlYWRlcnMoKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5kaXNwYXRjaChcImNvbHVtbi1zaG93XCIsIHRoaXMsIHJlc3BvbnNpdmVUb2dnbGUpO1xuXHRcdFx0XG5cdFx0XHRpZighc2lsZW50KXtcblx0XHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiY29sdW1uVmlzaWJpbGl0eUNoYW5nZWRcIiwgdGhpcy5nZXRDb21wb25lbnQoKSwgdHJ1ZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMucGFyZW50LmlzR3JvdXApe1xuXHRcdFx0XHR0aGlzLnBhcmVudC5tYXRjaENoaWxkV2lkdGhzKCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKCF0aGlzLnNpbGVudCl7XG5cdFx0XHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5yZXJlbmRlckNvbHVtbnMoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8vaGlkZSBjb2x1bW5cblx0aGlkZShzaWxlbnQsIHJlc3BvbnNpdmVUb2dnbGUpe1xuXHRcdGlmKHRoaXMudmlzaWJsZSl7XG5cdFx0XHR0aGlzLnZpc2libGUgPSBmYWxzZTtcblx0XHRcdFxuXHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0XHRcdFxuXHRcdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLnZlcnRpY2FsQWxpZ25IZWFkZXJzKCk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMucGFyZW50LmlzR3JvdXApe1xuXHRcdFx0XHR0aGlzLnBhcmVudC5jaGVja0NvbHVtblZpc2liaWxpdHkoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uKGNlbGwpe1xuXHRcdFx0XHRjZWxsLmhpZGUoKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwiY29sdW1uLWhpZGVcIiwgdGhpcywgcmVzcG9uc2l2ZVRvZ2dsZSk7XG5cdFx0XHRcblx0XHRcdGlmKCFzaWxlbnQpe1xuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJjb2x1bW5WaXNpYmlsaXR5Q2hhbmdlZFwiLCB0aGlzLmdldENvbXBvbmVudCgpLCBmYWxzZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMucGFyZW50LmlzR3JvdXApe1xuXHRcdFx0XHR0aGlzLnBhcmVudC5tYXRjaENoaWxkV2lkdGhzKCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKCF0aGlzLnNpbGVudCl7XG5cdFx0XHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5yZXJlbmRlckNvbHVtbnMoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdG1hdGNoQ2hpbGRXaWR0aHMoKXtcblx0XHR2YXIgY2hpbGRXaWR0aCA9IDA7XG5cdFx0XG5cdFx0aWYodGhpcy5jb250ZW50RWxlbWVudCAmJiB0aGlzLmNvbHVtbnMubGVuZ3RoKXtcblx0XHRcdHRoaXMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRcdGlmKGNvbHVtbi52aXNpYmxlKXtcblx0XHRcdFx0XHRjaGlsZFdpZHRoICs9IGNvbHVtbi5nZXRXaWR0aCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5jb250ZW50RWxlbWVudC5zdHlsZS5tYXhXaWR0aCA9IChjaGlsZFdpZHRoIC0gMSkgKyBcInB4XCI7XG5cdFx0XHRpZiAodGhpcy50YWJsZS5pbml0aWFsaXplZCkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUud2lkdGggPSBjaGlsZFdpZHRoICsgXCJweFwiO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnBhcmVudC5pc0dyb3VwKXtcblx0XHRcdFx0dGhpcy5wYXJlbnQubWF0Y2hDaGlsZFdpZHRocygpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0cmVtb3ZlQ2hpbGQoY2hpbGQpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMuY29sdW1ucy5pbmRleE9mKGNoaWxkKTtcblx0XHRcblx0XHRpZihpbmRleCA+IC0xKXtcblx0XHRcdHRoaXMuY29sdW1ucy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdH1cblx0XHRcblx0XHRpZighdGhpcy5jb2x1bW5zLmxlbmd0aCl7XG5cdFx0XHR0aGlzLmRlbGV0ZSgpO1xuXHRcdH1cblx0fVxuXHRcblx0c2V0V2lkdGgod2lkdGgpe1xuXHRcdHRoaXMud2lkdGhGaXhlZCA9IHRydWU7XG5cdFx0dGhpcy5zZXRXaWR0aEFjdHVhbCh3aWR0aCk7XG5cdH1cblx0XG5cdHNldFdpZHRoQWN0dWFsKHdpZHRoKXtcblx0XHRpZihpc05hTih3aWR0aCkpe1xuXHRcdFx0d2lkdGggPSBNYXRoLmZsb29yKCh0aGlzLnRhYmxlLmVsZW1lbnQuY2xpZW50V2lkdGgvMTAwKSAqIHBhcnNlSW50KHdpZHRoKSk7XG5cdFx0fVxuXHRcdFxuXHRcdHdpZHRoID0gTWF0aC5tYXgodGhpcy5taW5XaWR0aCwgd2lkdGgpO1xuXHRcdFxuXHRcdGlmKHRoaXMubWF4V2lkdGgpe1xuXHRcdFx0d2lkdGggPSBNYXRoLm1pbih0aGlzLm1heFdpZHRoLCB3aWR0aCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMud2lkdGggPSB3aWR0aDtcblx0XHR0aGlzLndpZHRoU3R5bGVkID0gd2lkdGggPyB3aWR0aCArIFwicHhcIiA6IFwiXCI7XG5cdFx0XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLndpZHRoID0gdGhpcy53aWR0aFN0eWxlZDtcblx0XHRcblx0XHRpZighdGhpcy5pc0dyb3VwKXtcblx0XHRcdHRoaXMuY2VsbHMuZm9yRWFjaChmdW5jdGlvbihjZWxsKXtcblx0XHRcdFx0Y2VsbC5zZXRXaWR0aCgpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMucGFyZW50LmlzR3JvdXApe1xuXHRcdFx0dGhpcy5wYXJlbnQubWF0Y2hDaGlsZFdpZHRocygpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmRpc3BhdGNoKFwiY29sdW1uLXdpZHRoXCIsIHRoaXMpO1xuXHRcdFxuXHRcdGlmKHRoaXMuc3Vic2NyaWJlZEV4dGVybmFsKFwiY29sdW1uV2lkdGhcIikpe1xuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiY29sdW1uV2lkdGhcIiwgdGhpcy5nZXRDb21wb25lbnQoKSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRjaGVja0NlbGxIZWlnaHRzKCl7XG5cdFx0dmFyIHJvd3MgPSBbXTtcblx0XHRcblx0XHR0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24oY2VsbCl7XG5cdFx0XHRpZihjZWxsLnJvdy5oZWlnaHRJbml0aWFsaXplZCl7XG5cdFx0XHRcdGlmKGNlbGwucm93LmdldEVsZW1lbnQoKS5vZmZzZXRQYXJlbnQgIT09IG51bGwpe1xuXHRcdFx0XHRcdHJvd3MucHVzaChjZWxsLnJvdyk7XG5cdFx0XHRcdFx0Y2VsbC5yb3cuY2xlYXJDZWxsSGVpZ2h0KCk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRjZWxsLnJvdy5oZWlnaHRJbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0cm93cy5mb3JFYWNoKGZ1bmN0aW9uKHJvdyl7XG5cdFx0XHRyb3cuY2FsY0hlaWdodCgpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdFx0cm93LnNldENlbGxIZWlnaHQoKTtcblx0XHR9KTtcblx0fVxuXHRcblx0Z2V0V2lkdGgoKXtcblx0XHR2YXIgd2lkdGggPSAwO1xuXHRcdFxuXHRcdGlmKHRoaXMuaXNHcm91cCl7XG5cdFx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdFx0XHRpZihjb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRcdFx0d2lkdGggKz0gY29sdW1uLmdldFdpZHRoKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdHdpZHRoID0gdGhpcy53aWR0aDtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHdpZHRoO1xuXHR9XG5cdFxuXHRnZXRMZWZ0T2Zmc2V0KCl7XG5cdFx0dmFyIG9mZnNldCA9IHRoaXMuZWxlbWVudC5vZmZzZXRMZWZ0O1xuXHRcdFxuXHRcdGlmKHRoaXMucGFyZW50LmlzR3JvdXApe1xuXHRcdFx0b2Zmc2V0ICs9IHRoaXMucGFyZW50LmdldExlZnRPZmZzZXQoKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG9mZnNldDtcblx0fVxuXHRcblx0Z2V0SGVpZ2h0KCl7XG5cdFx0cmV0dXJuIE1hdGguY2VpbCh0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KTtcblx0fVxuXHRcblx0c2V0TWluV2lkdGgobWluV2lkdGgpe1xuXHRcdGlmKHRoaXMubWF4V2lkdGggJiYgbWluV2lkdGggPiB0aGlzLm1heFdpZHRoKXtcblx0XHRcdG1pbldpZHRoID0gdGhpcy5tYXhXaWR0aDtcblx0XHRcdFxuXHRcdFx0Y29uc29sZS53YXJuKFwidGhlIG1pbldpZHRoIChcIisgbWluV2lkdGggKyBcInB4KSBmb3IgY29sdW1uICdcIiArIHRoaXMuZmllbGQgKyBcIicgY2Fubm90IGJlIGJpZ2dlciB0aGF0IGl0cyBtYXhXaWR0aCAoXCIrIHRoaXMubWF4V2lkdGhTdHlsZWQgKyBcIilcIik7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMubWluV2lkdGggPSBtaW5XaWR0aDtcblx0XHR0aGlzLm1pbldpZHRoU3R5bGVkID0gbWluV2lkdGggPyBtaW5XaWR0aCArIFwicHhcIiA6IFwiXCI7XG5cdFx0XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLm1pbldpZHRoID0gdGhpcy5taW5XaWR0aFN0eWxlZDtcblx0XHRcblx0XHR0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24oY2VsbCl7XG5cdFx0XHRjZWxsLnNldE1pbldpZHRoKCk7XG5cdFx0fSk7XG5cdH1cblx0XG5cdHNldE1heFdpZHRoKG1heFdpZHRoKXtcblx0XHRpZih0aGlzLm1pbldpZHRoICYmIG1heFdpZHRoIDwgdGhpcy5taW5XaWR0aCl7XG5cdFx0XHRtYXhXaWR0aCA9IHRoaXMubWluV2lkdGg7XG5cdFx0XHRcblx0XHRcdGNvbnNvbGUud2FybihcInRoZSBtYXhXaWR0aCAoXCIrIG1heFdpZHRoICsgXCJweCkgZm9yIGNvbHVtbiAnXCIgKyB0aGlzLmZpZWxkICsgXCInIGNhbm5vdCBiZSBzbWFsbGVyIHRoYXQgaXRzIG1pbldpZHRoIChcIisgdGhpcy5taW5XaWR0aFN0eWxlZCArIFwiKVwiKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5tYXhXaWR0aCA9IG1heFdpZHRoO1xuXHRcdHRoaXMubWF4V2lkdGhTdHlsZWQgPSBtYXhXaWR0aCA/IG1heFdpZHRoICsgXCJweFwiIDogXCJcIjtcblx0XHRcblx0XHR0aGlzLmVsZW1lbnQuc3R5bGUubWF4V2lkdGggPSB0aGlzLm1heFdpZHRoU3R5bGVkO1xuXHRcdFxuXHRcdHRoaXMuY2VsbHMuZm9yRWFjaChmdW5jdGlvbihjZWxsKXtcblx0XHRcdGNlbGwuc2V0TWF4V2lkdGgoKTtcblx0XHR9KTtcblx0fVxuXHRcblx0ZGVsZXRlKCl7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdGlmKHRoaXMuaXNHcm91cCl7XG5cdFx0XHRcdHRoaXMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRcdFx0Y29sdW1uLmRlbGV0ZSgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5kaXNwYXRjaChcImNvbHVtbi1kZWxldGVcIiwgdGhpcyk7XG5cdFx0XHRcblx0XHRcdHZhciBjZWxsQ291bnQgPSB0aGlzLmNlbGxzLmxlbmd0aDtcblx0XHRcdFxuXHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IGNlbGxDb3VudDsgaSsrKXtcblx0XHRcdFx0dGhpcy5jZWxsc1swXS5kZWxldGUoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYodGhpcy5lbGVtZW50LnBhcmVudE5vZGUpe1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLmVsZW1lbnQgPSBmYWxzZTtcblx0XHRcdHRoaXMuY29udGVudEVsZW1lbnQgPSBmYWxzZTtcblx0XHRcdHRoaXMudGl0bGVFbGVtZW50ID0gZmFsc2U7XG5cdFx0XHR0aGlzLmdyb3VwRWxlbWVudCA9IGZhbHNlO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnBhcmVudC5pc0dyb3VwKXtcblx0XHRcdFx0dGhpcy5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5kZXJlZ2lzdGVyQ29sdW1uKHRoaXMpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIucmVyZW5kZXJDb2x1bW5zKHRydWUpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwiY29sdW1uLWRlbGV0ZWRcIiwgdGhpcyk7XG5cdFx0XHRcblx0XHRcdHJlc29sdmUoKTtcblx0XHR9KTtcblx0fVxuXHRcblx0Y29sdW1uUmVuZGVyZWQoKXtcblx0XHRpZih0aGlzLnRpdGxlRm9ybWF0dGVyUmVuZGVyZWQpe1xuXHRcdFx0dGhpcy50aXRsZUZvcm1hdHRlclJlbmRlcmVkKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjb2x1bW4tcmVuZGVyZWRcIiwgdGhpcyk7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8gQ2VsbCBNYW5hZ2VtZW50IC8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vZ2VuZXJhdGUgY2VsbCBmb3IgdGhpcyBjb2x1bW5cblx0Z2VuZXJhdGVDZWxsKHJvdyl7XG5cdFx0dmFyIGNlbGwgPSBuZXcgQ2VsbCh0aGlzLCByb3cpO1xuXHRcdFxuXHRcdHRoaXMuY2VsbHMucHVzaChjZWxsKTtcblx0XHRcblx0XHRyZXR1cm4gY2VsbDtcblx0fVxuXHRcblx0bmV4dENvbHVtbigpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uSW5kZXgodGhpcyk7XG5cdFx0cmV0dXJuIGluZGV4ID4gLTEgPyB0aGlzLl9uZXh0VmlzaWJsZUNvbHVtbihpbmRleCArIDEpIDogZmFsc2U7XG5cdH1cblx0XG5cdF9uZXh0VmlzaWJsZUNvbHVtbihpbmRleCl7XG5cdFx0dmFyIGNvbHVtbiA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5CeUluZGV4KGluZGV4KTtcblx0XHRyZXR1cm4gIWNvbHVtbiB8fCBjb2x1bW4udmlzaWJsZSA/IGNvbHVtbiA6IHRoaXMuX25leHRWaXNpYmxlQ29sdW1uKGluZGV4ICsgMSk7XG5cdH1cblx0XG5cdHByZXZDb2x1bW4oKXtcblx0XHR2YXIgaW5kZXggPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbkluZGV4KHRoaXMpO1xuXHRcdHJldHVybiBpbmRleCA+IC0xID8gdGhpcy5fcHJldlZpc2libGVDb2x1bW4oaW5kZXggLSAxKSA6IGZhbHNlO1xuXHR9XG5cdFxuXHRfcHJldlZpc2libGVDb2x1bW4oaW5kZXgpe1xuXHRcdHZhciBjb2x1bW4gPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29sdW1uQnlJbmRleChpbmRleCk7XG5cdFx0cmV0dXJuICFjb2x1bW4gfHwgY29sdW1uLnZpc2libGUgPyBjb2x1bW4gOiB0aGlzLl9wcmV2VmlzaWJsZUNvbHVtbihpbmRleCAtIDEpO1xuXHR9XG5cdFxuXHRyZWluaXRpYWxpemVXaWR0aChmb3JjZSl7XG5cdFx0dGhpcy53aWR0aEZpeGVkID0gZmFsc2U7XG5cdFx0XG5cdFx0Ly9zZXQgd2lkdGggaWYgcHJlc2VudFxuXHRcdGlmKHR5cGVvZiB0aGlzLmRlZmluaXRpb24ud2lkdGggIT09IFwidW5kZWZpbmVkXCIgJiYgIWZvcmNlKXtcblx0XHRcdC8vIG1heEluaXRpYWxXaWR0aCBpZ25vcmVkIGhlcmUgYXMgd2lkdGggc3BlY2lmaWVkXG5cdFx0XHR0aGlzLnNldFdpZHRoKHRoaXMuZGVmaW5pdGlvbi53aWR0aCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjb2x1bW4td2lkdGgtZml0LWJlZm9yZVwiLCB0aGlzKTtcblx0XHRcblx0XHR0aGlzLmZpdFRvRGF0YShmb3JjZSk7XG5cdFx0XG5cdFx0dGhpcy5kaXNwYXRjaChcImNvbHVtbi13aWR0aC1maXQtYWZ0ZXJcIiwgdGhpcyk7XG5cdH1cblx0XG5cdC8vc2V0IGNvbHVtbiB3aWR0aCB0byBtYXhpbXVtIGNlbGwgd2lkdGggZm9yIG5vbiBncm91cCBjb2x1bW5zXG5cdGZpdFRvRGF0YShmb3JjZSl7XG5cdFx0aWYodGhpcy5pc0dyb3VwKXtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0aWYoIXRoaXMud2lkdGhGaXhlZCl7XG5cdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUud2lkdGggPSBcIlwiO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcblx0XHRcdFx0Y2VsbC5jbGVhcldpZHRoKCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0dmFyIG1heFdpZHRoID0gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoO1xuXHRcdFxuXHRcdGlmKCF0aGlzLndpZHRoIHx8ICF0aGlzLndpZHRoRml4ZWQpe1xuXHRcdFx0dGhpcy5jZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG5cdFx0XHRcdHZhciB3aWR0aCA9IGNlbGwuZ2V0V2lkdGgoKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHdpZHRoID4gbWF4V2lkdGgpe1xuXHRcdFx0XHRcdG1heFdpZHRoID0gd2lkdGg7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRpZihtYXhXaWR0aCl7XG5cdFx0XHRcdHZhciBzZXRUbyA9IG1heFdpZHRoICsgMTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGZvcmNlKXtcblx0XHRcdFx0XHR0aGlzLnNldFdpZHRoKHNldFRvKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGlmICh0aGlzLm1heEluaXRpYWxXaWR0aCAmJiAhZm9yY2UpIHtcblx0XHRcdFx0XHRcdHNldFRvID0gTWF0aC5taW4oc2V0VG8sIHRoaXMubWF4SW5pdGlhbFdpZHRoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5zZXRXaWR0aEFjdHVhbChzZXRUbyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdHVwZGF0ZURlZmluaXRpb24odXBkYXRlcyl7XG5cdFx0dmFyIGRlZmluaXRpb247XG5cdFx0XG5cdFx0aWYoIXRoaXMuaXNHcm91cCl7XG5cdFx0XHRpZighdGhpcy5wYXJlbnQuaXNHcm91cCl7XG5cdFx0XHRcdGRlZmluaXRpb24gPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmdldERlZmluaXRpb24oKSk7XG5cdFx0XHRcdGRlZmluaXRpb24gPSBPYmplY3QuYXNzaWduKGRlZmluaXRpb24sIHVwZGF0ZXMpO1xuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5hZGRDb2x1bW4oZGVmaW5pdGlvbiwgZmFsc2UsIHRoaXMpXG5cdFx0XHRcdFx0LnRoZW4oKGNvbHVtbikgPT4ge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYoZGVmaW5pdGlvbi5maWVsZCA9PSB0aGlzLmZpZWxkKXtcblx0XHRcdFx0XHRcdFx0dGhpcy5maWVsZCA9IGZhbHNlOyAvL2NsZWFyIGZpZWxkIG5hbWUgdG8gcHJldmVudCBkZWxldGlvbiBvZiBkdXBsaWNhdGUgY29sdW1uIGZyb20gYXJyYXlzXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcy5kZWxldGUoKVxuXHRcdFx0XHRcdFx0XHQudGhlbigoKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRDb21wb25lbnQoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJDb2x1bW4gVXBkYXRlIEVycm9yIC0gVGhlIHVwZGF0ZURlZmluaXRpb24gZnVuY3Rpb24gaXMgb25seSBhdmFpbGFibGUgb24gdW5ncm91cGVkIGNvbHVtbnNcIik7XG5cdFx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChcIkNvbHVtbiBVcGRhdGUgRXJyb3IgLSBUaGUgdXBkYXRlRGVmaW5pdGlvbiBmdW5jdGlvbiBpcyBvbmx5IGF2YWlsYWJsZSBvbiBjb2x1bW5zLCBub3QgY29sdW1uIGdyb3Vwc1wiKTtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiQ29sdW1uIFVwZGF0ZSBFcnJvciAtIFRoZSB1cGRhdGVEZWZpbml0aW9uIGZ1bmN0aW9uIGlzIG9ubHkgYXZhaWxhYmxlIG9uIHVuZ3JvdXBlZCBjb2x1bW5zXCIpO1xuXHRcdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KFwiQ29sdW1uIFVwZGF0ZSBFcnJvciAtIFRoZSB1cGRhdGVEZWZpbml0aW9uIGZ1bmN0aW9uIGlzIG9ubHkgYXZhaWxhYmxlIG9uIGNvbHVtbnMsIG5vdCBjb2x1bW4gZ3JvdXBzXCIpO1xuXHRcdH1cblx0fVxuXHRcblx0ZGVsZXRlQ2VsbChjZWxsKXtcblx0XHR2YXIgaW5kZXggPSB0aGlzLmNlbGxzLmluZGV4T2YoY2VsbCk7XG5cdFx0XG5cdFx0aWYoaW5kZXggPiAtMSl7XG5cdFx0XHR0aGlzLmNlbGxzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0fVxuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vIE9iamVjdCBHZW5lcmF0aW9uIC8vLy8vLy8vLy8vLy8vLy8vXG5cdGdldENvbXBvbmVudCgpe1xuXHRcdGlmKCF0aGlzLmNvbXBvbmVudCl7XG5cdFx0XHR0aGlzLmNvbXBvbmVudCA9IG5ldyBDb2x1bW5Db21wb25lbnQodGhpcyk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0aGlzLmNvbXBvbmVudDtcblx0fVxuXHRcblx0Z2V0UG9zaXRpb24oKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldFZpc2libGVDb2x1bW5zQnlJbmRleCgpLmluZGV4T2YodGhpcykgKyAxO1xuXHR9XG5cdFxuXHRnZXRQYXJlbnRDb21wb25lbnQoKXtcblx0XHRyZXR1cm4gdGhpcy5wYXJlbnQgaW5zdGFuY2VvZiBDb2x1bW4gPyB0aGlzLnBhcmVudC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xuXHR9XG59XG5cbi8vcHVibGljIHJvdyBvYmplY3RcbmNsYXNzIFJvd0NvbXBvbmVudCB7XG5cblx0Y29uc3RydWN0b3IgKHJvdyl7XG5cdFx0dGhpcy5fcm93ID0gcm93O1xuXG5cdFx0cmV0dXJuIG5ldyBQcm94eSh0aGlzLCB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKHRhcmdldCwgbmFtZSwgcmVjZWl2ZXIpIHtcblx0XHRcdFx0aWYgKHR5cGVvZiB0YXJnZXRbbmFtZV0gIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gdGFyZ2V0W25hbWVdO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRhcmdldC5fcm93LnRhYmxlLmNvbXBvbmVudEZ1bmN0aW9uQmluZGVyLmhhbmRsZShcInJvd1wiLCB0YXJnZXQuX3JvdywgbmFtZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdGdldERhdGEodHJhbnNmb3JtKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93LmdldERhdGEodHJhbnNmb3JtKTtcblx0fVxuXG5cdGdldEVsZW1lbnQoKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93LmdldEVsZW1lbnQoKTtcblx0fVxuXG5cdGdldENlbGxzKCl7XG5cdFx0dmFyIGNlbGxzID0gW107XG5cblx0XHR0aGlzLl9yb3cuZ2V0Q2VsbHMoKS5mb3JFYWNoKGZ1bmN0aW9uKGNlbGwpe1xuXHRcdFx0Y2VsbHMucHVzaChjZWxsLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblxuXHRcdHJldHVybiBjZWxscztcblx0fVxuXG5cdGdldENlbGwoY29sdW1uKXtcblx0XHR2YXIgY2VsbCA9IHRoaXMuX3Jvdy5nZXRDZWxsKGNvbHVtbik7XG5cdFx0cmV0dXJuIGNlbGwgPyBjZWxsLmdldENvbXBvbmVudCgpIDogZmFsc2U7XG5cdH1cblxuXHRnZXRJbmRleCgpe1xuXHRcdHJldHVybiB0aGlzLl9yb3cuZ2V0RGF0YShcImRhdGFcIilbdGhpcy5fcm93LnRhYmxlLm9wdGlvbnMuaW5kZXhdO1xuXHR9XG5cblx0Z2V0UG9zaXRpb24oKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93LmdldFBvc2l0aW9uKCk7XG5cdH1cblxuXHR3YXRjaFBvc2l0aW9uKGNhbGxiYWNrKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93LndhdGNoUG9zaXRpb24oY2FsbGJhY2spO1xuXHR9XG5cblx0ZGVsZXRlKCl7XG5cdFx0cmV0dXJuIHRoaXMuX3Jvdy5kZWxldGUoKTtcblx0fVxuXG5cdHNjcm9sbFRvKHBvc2l0aW9uLCBpZlZpc2libGUpe1xuXHRcdHJldHVybiB0aGlzLl9yb3cudGFibGUucm93TWFuYWdlci5zY3JvbGxUb1Jvdyh0aGlzLl9yb3csIHBvc2l0aW9uLCBpZlZpc2libGUpO1xuXHR9XG5cblx0bW92ZSh0bywgYWZ0ZXIpe1xuXHRcdHRoaXMuX3Jvdy5tb3ZlVG9Sb3codG8sIGFmdGVyKTtcblx0fVxuXG5cdHVwZGF0ZShkYXRhKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93LnVwZGF0ZURhdGEoZGF0YSk7XG5cdH1cblxuXHRub3JtYWxpemVIZWlnaHQoKXtcblx0XHR0aGlzLl9yb3cubm9ybWFsaXplSGVpZ2h0KHRydWUpO1xuXHR9XG5cblx0X2dldFNlbGYoKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93O1xuXHR9XG5cblx0cmVmb3JtYXQoKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93LnJlaW5pdGlhbGl6ZSgpO1xuXHR9XG5cblx0Z2V0VGFibGUoKXtcblx0XHRyZXR1cm4gdGhpcy5fcm93LnRhYmxlO1xuXHR9XG5cblx0Z2V0TmV4dFJvdygpe1xuXHRcdHZhciByb3cgPSB0aGlzLl9yb3cubmV4dFJvdygpO1xuXHRcdHJldHVybiByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiByb3c7XG5cdH1cblxuXHRnZXRQcmV2Um93KCl7XG5cdFx0dmFyIHJvdyA9IHRoaXMuX3Jvdy5wcmV2Um93KCk7XG5cdFx0cmV0dXJuIHJvdyA/IHJvdy5nZXRDb21wb25lbnQoKSA6IHJvdztcblx0fVxufVxuXG5jbGFzcyBSb3cgZXh0ZW5kcyBDb3JlRmVhdHVyZXtcblx0Y29uc3RydWN0b3IgKGRhdGEsIHBhcmVudCwgdHlwZSA9IFwicm93XCIpe1xuXHRcdHN1cGVyKHBhcmVudC50YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0dGhpcy5kYXRhID0ge307XG5cdFx0dGhpcy50eXBlID0gdHlwZTsgLy90eXBlIG9mIGVsZW1lbnRcblx0XHR0aGlzLmVsZW1lbnQgPSBmYWxzZTtcblx0XHR0aGlzLm1vZHVsZXMgPSB7fTsgLy9ob2xkIG1vZHVsZSB2YXJpYWJsZXM7XG5cdFx0dGhpcy5jZWxscyA9IFtdO1xuXHRcdHRoaXMuaGVpZ2h0ID0gMDsgLy9ob2xkIGVsZW1lbnQgaGVpZ2h0XG5cdFx0dGhpcy5oZWlnaHRTdHlsZWQgPSBcIlwiOyAvL2hvbGQgZWxlbWVudCBoZWlnaHQgcHJlLXN0eWxlZCB0byBpbXByb3ZlIHJlbmRlciBlZmZpY2llbmN5XG5cdFx0dGhpcy5tYW51YWxIZWlnaHQgPSBmYWxzZTsgLy91c2VyIGhhcyBtYW51YWxseSBzZXQgcm93IGhlaWdodFxuXHRcdHRoaXMub3V0ZXJIZWlnaHQgPSAwOyAvL2hvbGQgZWxlbWVudHMgb3V0ZXIgaGVpZ2h0XG5cdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlOyAvL2VsZW1lbnQgaGFzIGJlZW4gcmVuZGVyZWRcblx0XHR0aGlzLmhlaWdodEluaXRpYWxpemVkID0gZmFsc2U7IC8vZWxlbWVudCBoYXMgcmVzaXplZCBjZWxscyB0byBmaXRcblx0XHR0aGlzLnBvc2l0aW9uID0gMDsgLy9zdG9yZSBwb3NpdGlvbiBvZiBlbGVtZW50IGluIHJvdyBsaXN0XG5cdFx0dGhpcy5wb3NpdGlvbldhdGNoZXJzID0gW107XG5cdFx0XG5cdFx0dGhpcy5jb21wb25lbnQgPSBudWxsO1xuXHRcdFxuXHRcdHRoaXMuY3JlYXRlZCA9IGZhbHNlO1xuXHRcdFxuXHRcdHRoaXMuc2V0RGF0YShkYXRhKTtcblx0fVxuXHRcblx0Y3JlYXRlKCl7XG5cdFx0aWYoIXRoaXMuY3JlYXRlZCl7XG5cdFx0XHR0aGlzLmNyZWF0ZWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5nZW5lcmF0ZUVsZW1lbnQoKTtcblx0XHR9XG5cdH1cblx0XG5cdGNyZWF0ZUVsZW1lbnQgKCl7XG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvd1wiKTtcblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwicm93XCIpO1xuXHRcdFxuXHRcdHRoaXMuZWxlbWVudCA9IGVsO1xuXHR9XG5cdFxuXHRnZXRFbGVtZW50KCl7XG5cdFx0dGhpcy5jcmVhdGUoKTtcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50O1xuXHR9XG5cdFxuXHRkZXRhY2hFbGVtZW50KCl7XG5cdFx0aWYgKHRoaXMuZWxlbWVudCAmJiB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSl7XG5cdFx0XHR0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdH1cblx0fVxuXHRcblx0Z2VuZXJhdGVFbGVtZW50KCl7XG5cdFx0dGhpcy5jcmVhdGVFbGVtZW50KCk7XG5cdFx0dGhpcy5kaXNwYXRjaChcInJvdy1pbml0XCIsIHRoaXMpO1xuXHR9XG5cdFxuXHRnZW5lcmF0ZUNlbGxzKCl7XG5cdFx0dGhpcy5jZWxscyA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZW5lcmF0ZUNlbGxzKHRoaXMpO1xuXHR9XG5cdFxuXHQvL2Z1bmN0aW9ucyB0byBzZXR1cCBvbiBmaXJzdCByZW5kZXJcblx0aW5pdGlhbGl6ZShmb3JjZSwgaW5GcmFnbWVudCl7XG5cdFx0dGhpcy5jcmVhdGUoKTtcblx0XHRcblx0XHRpZighdGhpcy5pbml0aWFsaXplZCB8fCBmb3JjZSl7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGVsZXRlQ2VsbHMoKTtcblx0XHRcdFxuXHRcdFx0d2hpbGUodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpIHRoaXMuZWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGlzcGF0Y2goXCJyb3ctbGF5b3V0LWJlZm9yZVwiLCB0aGlzKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5nZW5lcmF0ZUNlbGxzKCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIucmVuZGVyZXIucmVuZGVyUm93Q2VsbHModGhpcywgaW5GcmFnbWVudCk7XG5cdFx0XHRcblx0XHRcdGlmKGZvcmNlKXtcblx0XHRcdFx0dGhpcy5ub3JtYWxpemVIZWlnaHQoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5kaXNwYXRjaChcInJvdy1sYXlvdXRcIiwgdGhpcyk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5yb3dGb3JtYXR0ZXIpe1xuXHRcdFx0XHR0aGlzLnRhYmxlLm9wdGlvbnMucm93Rm9ybWF0dGVyKHRoaXMuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwicm93LWxheW91dC1hZnRlclwiLCB0aGlzKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIucmVuZGVyZXIucmVyZW5kZXJSb3dDZWxscyh0aGlzLCBpbkZyYWdtZW50KTtcblx0XHR9XG5cdH1cblxuXHRyZW5kZXJlZCgpe1xuXHRcdHRoaXMuY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuXHRcdFx0Y2VsbC5jZWxsUmVuZGVyZWQoKTtcblx0XHR9KTtcblx0fVxuXHRcblx0cmVpbml0aWFsaXplSGVpZ2h0KCl7XG5cdFx0dGhpcy5oZWlnaHRJbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdFxuXHRcdGlmKHRoaXMuZWxlbWVudCAmJiB0aGlzLmVsZW1lbnQub2Zmc2V0UGFyZW50ICE9PSBudWxsKXtcblx0XHRcdHRoaXMubm9ybWFsaXplSGVpZ2h0KHRydWUpO1xuXHRcdH1cblx0fVxuXG5cdGRlaW5pdGlhbGl6ZSgpe1xuXHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0fVxuXHRcblx0ZGVpbml0aWFsaXplSGVpZ2h0KCl7XG5cdFx0dGhpcy5oZWlnaHRJbml0aWFsaXplZCA9IGZhbHNlO1xuXHR9XG5cdFxuXHRyZWluaXRpYWxpemUoY2hpbGRyZW4pe1xuXHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR0aGlzLmhlaWdodEluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XG5cdFx0aWYoIXRoaXMubWFudWFsSGVpZ2h0KXtcblx0XHRcdHRoaXMuaGVpZ2h0ID0gMDtcblx0XHRcdHRoaXMuaGVpZ2h0U3R5bGVkID0gXCJcIjtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy5lbGVtZW50ICYmIHRoaXMuZWxlbWVudC5vZmZzZXRQYXJlbnQgIT09IG51bGwpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplKHRydWUpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmRpc3BhdGNoKFwicm93LXJlbGF5b3V0XCIsIHRoaXMpO1xuXHR9XG5cdFxuXHQvL2dldCBoZWlnaHRzIHdoZW4gZG9pbmcgYnVsayByb3cgc3R5bGUgY2FsY3MgaW4gdmlydHVhbCBET01cblx0Y2FsY0hlaWdodChmb3JjZSl7XG5cdFx0dmFyIG1heEhlaWdodCA9IDAsIG1pbkhlaWdodCAgPSAwO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJvd0hlaWdodCl7XG5cdFx0XHR0aGlzLmhlaWdodCA9IHRoaXMudGFibGUub3B0aW9ucy5yb3dIZWlnaHQ7XG5cdFx0fWVsc2Uge1xuXHRcdFx0bWluSGVpZ2h0ID0gdGhpcy5jYWxjTWluSGVpZ2h0KCk7XG5cdFx0XHRtYXhIZWlnaHQgPSB0aGlzLmNhbGNNYXhIZWlnaHQoKTtcblx0XHRcdFxuXHRcdFx0aWYoZm9yY2Upe1xuXHRcdFx0XHR0aGlzLmhlaWdodCA9IE1hdGgubWF4KG1heEhlaWdodCwgbWluSGVpZ2h0KTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5oZWlnaHQgPSB0aGlzLm1hbnVhbEhlaWdodCA/IHRoaXMuaGVpZ2h0IDogTWF0aC5tYXgobWF4SGVpZ2h0LCBtaW5IZWlnaHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0aGlzLmhlaWdodFN0eWxlZCA9IHRoaXMuaGVpZ2h0ID8gdGhpcy5oZWlnaHQgKyBcInB4XCIgOiBcIlwiO1xuXHRcdHRoaXMub3V0ZXJIZWlnaHQgPSB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuXHR9XG5cblx0Y2FsY01pbkhlaWdodCgpe1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLm9wdGlvbnMucmVzaXphYmxlUm93cyA/IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQgOiAwO1xuXHR9XG5cblx0Y2FsY01heEhlaWdodCgpe1xuXHRcdHZhciBtYXhIZWlnaHQgPSAwO1xuXG5cdFx0dGhpcy5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uKGNlbGwpe1xuXHRcdFx0dmFyIGhlaWdodCA9IGNlbGwuZ2V0SGVpZ2h0KCk7XG5cblx0XHRcdGlmKGhlaWdodCA+IG1heEhlaWdodCl7XG5cdFx0XHRcdG1heEhlaWdodCA9IGhlaWdodDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBtYXhIZWlnaHQ7XG5cdH1cblx0XG5cdC8vc2V0IG9mIGNlbGxzXG5cdHNldENlbGxIZWlnaHQoKXtcblx0XHR0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24oY2VsbCl7XG5cdFx0XHRjZWxsLnNldEhlaWdodCgpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMuaGVpZ2h0SW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHR9XG5cdFxuXHRjbGVhckNlbGxIZWlnaHQoKXtcblx0XHR0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24oY2VsbCl7XG5cdFx0XHRjZWxsLmNsZWFySGVpZ2h0KCk7XG5cdFx0fSk7XG5cdH1cblx0XG5cdC8vbm9ybWFsaXplIHRoZSBoZWlnaHQgb2YgZWxlbWVudHMgaW4gdGhlIHJvd1xuXHRub3JtYWxpemVIZWlnaHQoZm9yY2Upe1xuXHRcdGlmKGZvcmNlICYmICF0aGlzLnRhYmxlLm9wdGlvbnMucm93SGVpZ2h0KXtcblx0XHRcdHRoaXMuY2xlYXJDZWxsSGVpZ2h0KCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuY2FsY0hlaWdodChmb3JjZSk7XG5cdFx0XG5cdFx0dGhpcy5zZXRDZWxsSGVpZ2h0KCk7XG5cdH1cblx0XG5cdC8vc2V0IGhlaWdodCBvZiByb3dzXG5cdHNldEhlaWdodChoZWlnaHQsIGZvcmNlKXtcblx0XHRpZih0aGlzLmhlaWdodCAhPSBoZWlnaHQgfHwgZm9yY2Upe1xuXHRcdFx0XG5cdFx0XHR0aGlzLm1hbnVhbEhlaWdodCA9IHRydWU7XG5cdFx0XHRcblx0XHRcdHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXHRcdFx0dGhpcy5oZWlnaHRTdHlsZWQgPSBoZWlnaHQgPyBoZWlnaHQgKyBcInB4XCIgOiBcIlwiO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnNldENlbGxIZWlnaHQoKTtcblx0XHRcdFxuXHRcdFx0Ly8gdGhpcy5vdXRlckhlaWdodCA9IHRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpO1xuXHRcdFx0dGhpcy5vdXRlckhlaWdodCA9IHRoaXMuZWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cblx0XHRcdGlmKHRoaXMuc3Vic2NyaWJlZEV4dGVybmFsKFwicm93SGVpZ2h0XCIpKXtcblx0XHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwicm93SGVpZ2h0XCIsIHRoaXMuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0Ly9yZXR1cm4gcm93cyBvdXRlciBoZWlnaHRcblx0Z2V0SGVpZ2h0KCl7XG5cdFx0cmV0dXJuIHRoaXMub3V0ZXJIZWlnaHQ7XG5cdH1cblx0XG5cdC8vcmV0dXJuIHJvd3Mgb3V0ZXIgV2lkdGhcblx0Z2V0V2lkdGgoKXtcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vIENlbGwgTWFuYWdlbWVudCAvLy8vLy8vLy8vLy8vLy8vL1xuXHRkZWxldGVDZWxsKGNlbGwpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMuY2VsbHMuaW5kZXhPZihjZWxsKTtcblx0XHRcblx0XHRpZihpbmRleCA+IC0xKXtcblx0XHRcdHRoaXMuY2VsbHMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8gRGF0YSBNYW5hZ2VtZW50IC8vLy8vLy8vLy8vLy8vLy8vXG5cdHNldERhdGEoZGF0YSl7XG5cdFx0dGhpcy5kYXRhID0gdGhpcy5jaGFpbihcInJvdy1kYXRhLWluaXQtYmVmb3JlXCIsIFt0aGlzLCBkYXRhXSwgdW5kZWZpbmVkLCBkYXRhKTtcblx0XHRcblx0XHR0aGlzLmRpc3BhdGNoKFwicm93LWRhdGEtaW5pdC1hZnRlclwiLCB0aGlzKTtcblx0fVxuXHRcblx0Ly91cGRhdGUgdGhlIHJvd3MgZGF0YVxuXHR1cGRhdGVEYXRhKHVwZGF0ZWREYXRhKXtcblx0XHR2YXIgdmlzaWJsZSA9IHRoaXMuZWxlbWVudCAmJiBIZWxwZXJzLmVsVmlzaWJsZSh0aGlzLmVsZW1lbnQpLFxuXHRcdHRlbXBEYXRhID0ge30sXG5cdFx0bmV3Um93RGF0YTtcblx0XHRcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XG5cdFx0XHRpZih0eXBlb2YgdXBkYXRlZERhdGEgPT09IFwic3RyaW5nXCIpe1xuXHRcdFx0XHR1cGRhdGVkRGF0YSA9IEpTT04ucGFyc2UodXBkYXRlZERhdGEpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwicm93LWRhdGEtc2F2ZS1iZWZvcmVcIiwgdGhpcyk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMuc3Vic2NyaWJlZChcInJvdy1kYXRhLWNoYW5naW5nXCIpKXtcblx0XHRcdFx0dGVtcERhdGEgPSBPYmplY3QuYXNzaWduKHRlbXBEYXRhLCB0aGlzLmRhdGEpO1xuXHRcdFx0XHR0ZW1wRGF0YSA9IE9iamVjdC5hc3NpZ24odGVtcERhdGEsIHVwZGF0ZWREYXRhKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bmV3Um93RGF0YSA9IHRoaXMuY2hhaW4oXCJyb3ctZGF0YS1jaGFuZ2luZ1wiLCBbdGhpcywgdGVtcERhdGEsIHVwZGF0ZWREYXRhXSwgbnVsbCwgdXBkYXRlZERhdGEpO1xuXHRcdFx0XG5cdFx0XHQvL3NldCBkYXRhXG5cdFx0XHRmb3IgKGxldCBhdHRybmFtZSBpbiBuZXdSb3dEYXRhKSB7XG5cdFx0XHRcdHRoaXMuZGF0YVthdHRybmFtZV0gPSBuZXdSb3dEYXRhW2F0dHJuYW1lXTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5kaXNwYXRjaChcInJvdy1kYXRhLXNhdmUtYWZ0ZXJcIiwgdGhpcyk7XG5cdFx0XHRcblx0XHRcdC8vdXBkYXRlIGFmZmVjdGVkIGNlbGxzIG9ubHlcblx0XHRcdGZvciAobGV0IGF0dHJuYW1lIGluIHVwZGF0ZWREYXRhKSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRsZXQgY29sdW1ucyA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5zQnlGaWVsZFJvb3QoYXR0cm5hbWUpO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcblx0XHRcdFx0XHRsZXQgY2VsbCA9IHRoaXMuZ2V0Q2VsbChjb2x1bW4uZ2V0RmllbGQoKSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoY2VsbCl7XG5cdFx0XHRcdFx0XHRsZXQgdmFsdWUgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShuZXdSb3dEYXRhKTtcblx0XHRcdFx0XHRcdGlmKGNlbGwuZ2V0VmFsdWUoKSAhPT0gdmFsdWUpe1xuXHRcdFx0XHRcdFx0XHRjZWxsLnNldFZhbHVlUHJvY2Vzc0RhdGEodmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0aWYodmlzaWJsZSl7XG5cdFx0XHRcdFx0XHRcdFx0Y2VsbC5jZWxsUmVuZGVyZWQoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vUGFydGlhbCByZWluaXRpYWxpemF0aW9uIGlmIHZpc2libGVcblx0XHRcdGlmKHZpc2libGUpe1xuXHRcdFx0XHR0aGlzLm5vcm1hbGl6ZUhlaWdodCh0cnVlKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5yb3dGb3JtYXR0ZXIpe1xuXHRcdFx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5yb3dGb3JtYXR0ZXIodGhpcy5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLmhlaWdodCA9IDA7XG5cdFx0XHRcdHRoaXMuaGVpZ2h0U3R5bGVkID0gXCJcIjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5kaXNwYXRjaChcInJvdy1kYXRhLWNoYW5nZWRcIiwgdGhpcywgdmlzaWJsZSwgdXBkYXRlZERhdGEpO1xuXHRcdFx0XG5cdFx0XHQvL3RoaXMucmVpbml0aWFsaXplKCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInJvd1VwZGF0ZWRcIiwgdGhpcy5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMuc3Vic2NyaWJlZEV4dGVybmFsKFwiZGF0YUNoYW5nZWRcIikpe1xuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhQ2hhbmdlZFwiLCB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGF0YSgpKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cmVzb2x2ZSgpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRnZXREYXRhKHRyYW5zZm9ybSl7XG5cdFx0aWYodHJhbnNmb3JtKXtcblx0XHRcdHJldHVybiB0aGlzLmNoYWluKFwicm93LWRhdGEtcmV0cmlldmVcIiwgW3RoaXMsIHRyYW5zZm9ybV0sIG51bGwsIHRoaXMuZGF0YSk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0aGlzLmRhdGE7XG5cdH1cblx0XG5cdGdldENlbGwoY29sdW1uKXtcblx0XHR2YXIgbWF0Y2ggPSBmYWxzZTtcblx0XHRcblx0XHRjb2x1bW4gPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihjb2x1bW4pO1xuXHRcdFxuXHRcdGlmKCF0aGlzLmluaXRpYWxpemVkICYmIHRoaXMuY2VsbHMubGVuZ3RoID09PSAwKXtcblx0XHRcdHRoaXMuZ2VuZXJhdGVDZWxscygpO1xuXHRcdH1cblx0XHRcblx0XHRtYXRjaCA9IHRoaXMuY2VsbHMuZmluZChmdW5jdGlvbihjZWxsKXtcblx0XHRcdHJldHVybiBjZWxsLmNvbHVtbiA9PT0gY29sdW1uO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBtYXRjaDtcblx0fVxuXHRcblx0Z2V0Q2VsbEluZGV4KGZpbmRDZWxsKXtcblx0XHRyZXR1cm4gdGhpcy5jZWxscy5maW5kSW5kZXgoZnVuY3Rpb24oY2VsbCl7XG5cdFx0XHRyZXR1cm4gY2VsbCA9PT0gZmluZENlbGw7XG5cdFx0fSk7XG5cdH1cblx0XG5cdGZpbmRDZWxsKHN1YmplY3Qpe1xuXHRcdHJldHVybiB0aGlzLmNlbGxzLmZpbmQoKGNlbGwpID0+IHtcblx0XHRcdHJldHVybiBjZWxsLmVsZW1lbnQgPT09IHN1YmplY3Q7XG5cdFx0fSk7XG5cdH1cblx0XG5cdGdldENlbGxzKCl7XG5cdFx0aWYoIXRoaXMuaW5pdGlhbGl6ZWQgJiYgdGhpcy5jZWxscy5sZW5ndGggPT09IDApe1xuXHRcdFx0dGhpcy5nZW5lcmF0ZUNlbGxzKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0aGlzLmNlbGxzO1xuXHR9XG5cdFxuXHRuZXh0Um93KCl7XG5cdFx0dmFyIHJvdyA9IHRoaXMudGFibGUucm93TWFuYWdlci5uZXh0RGlzcGxheVJvdyh0aGlzLCB0cnVlKTtcblx0XHRyZXR1cm4gcm93IHx8IGZhbHNlO1xuXHR9XG5cdFxuXHRwcmV2Um93KCl7XG5cdFx0dmFyIHJvdyA9IHRoaXMudGFibGUucm93TWFuYWdlci5wcmV2RGlzcGxheVJvdyh0aGlzLCB0cnVlKTtcblx0XHRyZXR1cm4gcm93IHx8IGZhbHNlO1xuXHR9XG5cdFxuXHRtb3ZlVG9Sb3codG8sIGJlZm9yZSl7XG5cdFx0dmFyIHRvUm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpbmRSb3codG8pO1xuXHRcdFxuXHRcdGlmKHRvUm93KXtcblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5tb3ZlUm93QWN0dWFsKHRoaXMsIHRvUm93LCAhYmVmb3JlKTtcblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcImRpc3BsYXlcIiwgZmFsc2UsIHRydWUpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIk1vdmUgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmQ6XCIsIHRvKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLyBBY3Rpb25zICAvLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0ZGVsZXRlKCl7XG5cdFx0dGhpcy5kaXNwYXRjaChcInJvdy1kZWxldGVcIiwgdGhpcyk7XG5cdFx0XG5cdFx0dGhpcy5kZWxldGVBY3R1YWwoKTtcblx0XHRcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdH1cblx0XG5cdGRlbGV0ZUFjdHVhbChibG9ja1JlZHJhdyl7XG5cdFx0dGhpcy5kZXRhY2hNb2R1bGVzKCk7XG5cdFx0XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmRlbGV0ZVJvdyh0aGlzLCBibG9ja1JlZHJhdyk7XG5cdFx0XG5cdFx0dGhpcy5kZWxldGVDZWxscygpO1xuXHRcdFxuXHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR0aGlzLmhlaWdodEluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0dGhpcy5lbGVtZW50ID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5kaXNwYXRjaChcInJvdy1kZWxldGVkXCIsIHRoaXMpO1xuXHR9XG5cdFxuXHRkZXRhY2hNb2R1bGVzKCl7XG5cdFx0dGhpcy5kaXNwYXRjaChcInJvdy1kZWxldGluZ1wiLCB0aGlzKTtcblx0fVxuXHRcblx0ZGVsZXRlQ2VsbHMoKXtcblx0XHR2YXIgY2VsbENvdW50ID0gdGhpcy5jZWxscy5sZW5ndGg7XG5cdFx0XG5cdFx0Zm9yKGxldCBpID0gMDsgaSA8IGNlbGxDb3VudDsgaSsrKXtcblx0XHRcdHRoaXMuY2VsbHNbMF0uZGVsZXRlKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHR3aXBlKCl7XG5cdFx0dGhpcy5kZXRhY2hNb2R1bGVzKCk7XG5cdFx0dGhpcy5kZWxldGVDZWxscygpO1xuXHRcdFxuXHRcdGlmKHRoaXMuZWxlbWVudCl7XG5cdFx0XHR3aGlsZSh0aGlzLmVsZW1lbnQuZmlyc3RDaGlsZCkgdGhpcy5lbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudC5maXJzdENoaWxkKTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy5lbGVtZW50LnBhcmVudE5vZGUpe1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0aGlzLmVsZW1lbnQgPSBmYWxzZTtcblx0XHR0aGlzLm1vZHVsZXMgPSB7fTtcblx0fVxuXG5cdGlzRGlzcGxheWVkKCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUucm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpLmluY2x1ZGVzKHRoaXMpO1xuXHR9XG5cblx0Z2V0UG9zaXRpb24oKXtcblx0XHRyZXR1cm4gdGhpcy5pc0Rpc3BsYXllZCgpID8gdGhpcy5wb3NpdGlvbiA6IGZhbHNlO1xuXHR9XG5cblx0c2V0UG9zaXRpb24ocG9zaXRpb24pe1xuXHRcdGlmKHBvc2l0aW9uICE9IHRoaXMucG9zaXRpb24pe1xuXHRcdFx0dGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuXG5cdFx0XHR0aGlzLnBvc2l0aW9uV2F0Y2hlcnMuZm9yRWFjaCgoY2FsbGJhY2spID0+IHtcblx0XHRcdFx0Y2FsbGJhY2sodGhpcy5wb3NpdGlvbik7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHR3YXRjaFBvc2l0aW9uKGNhbGxiYWNrKXtcblx0XHR0aGlzLnBvc2l0aW9uV2F0Y2hlcnMucHVzaChjYWxsYmFjayk7XG5cblx0XHRjYWxsYmFjayh0aGlzLnBvc2l0aW9uKTtcblx0fVxuXHRcblx0Z2V0R3JvdXAoKXtcblx0XHRyZXR1cm4gdGhpcy5tb2R1bGVzLmdyb3VwIHx8IGZhbHNlO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vIE9iamVjdCBHZW5lcmF0aW9uIC8vLy8vLy8vLy8vLy8vLy8vXG5cdGdldENvbXBvbmVudCgpe1xuXHRcdGlmKCF0aGlzLmNvbXBvbmVudCl7XG5cdFx0XHR0aGlzLmNvbXBvbmVudCA9IG5ldyBSb3dDb21wb25lbnQodGhpcyk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0aGlzLmNvbXBvbmVudDtcblx0fVxufVxuXG52YXIgZGVmYXVsdENhbGN1bGF0aW9ucyA9IHtcblx0XCJhdmdcIjpmdW5jdGlvbih2YWx1ZXMsIGRhdGEsIGNhbGNQYXJhbXMpe1xuXHRcdHZhciBvdXRwdXQgPSAwLFxuXHRcdHByZWNpc2lvbiA9IHR5cGVvZiBjYWxjUGFyYW1zLnByZWNpc2lvbiAhPT0gXCJ1bmRlZmluZWRcIiA/IGNhbGNQYXJhbXMucHJlY2lzaW9uIDogMjtcblxuXHRcdGlmKHZhbHVlcy5sZW5ndGgpe1xuXHRcdFx0b3V0cHV0ID0gdmFsdWVzLnJlZHVjZShmdW5jdGlvbihzdW0sIHZhbHVlKXtcblx0XHRcdFx0cmV0dXJuIE51bWJlcihzdW0pICsgTnVtYmVyKHZhbHVlKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRvdXRwdXQgPSBvdXRwdXQgLyB2YWx1ZXMubGVuZ3RoO1xuXG5cdFx0XHRvdXRwdXQgPSBwcmVjaXNpb24gIT09IGZhbHNlID8gb3V0cHV0LnRvRml4ZWQocHJlY2lzaW9uKSA6IG91dHB1dDtcblx0XHR9XG5cblx0XHRyZXR1cm4gcGFyc2VGbG9hdChvdXRwdXQpLnRvU3RyaW5nKCk7XG5cdH0sXG5cdFwibWF4XCI6ZnVuY3Rpb24odmFsdWVzLCBkYXRhLCBjYWxjUGFyYW1zKXtcblx0XHR2YXIgb3V0cHV0ID0gbnVsbCxcblx0XHRwcmVjaXNpb24gPSB0eXBlb2YgY2FsY1BhcmFtcy5wcmVjaXNpb24gIT09IFwidW5kZWZpbmVkXCIgPyBjYWxjUGFyYW1zLnByZWNpc2lvbiA6IGZhbHNlO1xuXG5cdFx0dmFsdWVzLmZvckVhY2goZnVuY3Rpb24odmFsdWUpe1xuXG5cdFx0XHR2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XG5cblx0XHRcdGlmKHZhbHVlID4gb3V0cHV0IHx8IG91dHB1dCA9PT0gbnVsbCl7XG5cdFx0XHRcdG91dHB1dCA9IHZhbHVlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIG91dHB1dCAhPT0gbnVsbCA/IChwcmVjaXNpb24gIT09IGZhbHNlID8gb3V0cHV0LnRvRml4ZWQocHJlY2lzaW9uKSA6IG91dHB1dCkgOiBcIlwiO1xuXHR9LFxuXHRcIm1pblwiOmZ1bmN0aW9uKHZhbHVlcywgZGF0YSwgY2FsY1BhcmFtcyl7XG5cdFx0dmFyIG91dHB1dCA9IG51bGwsXG5cdFx0cHJlY2lzaW9uID0gdHlwZW9mIGNhbGNQYXJhbXMucHJlY2lzaW9uICE9PSBcInVuZGVmaW5lZFwiID8gY2FsY1BhcmFtcy5wcmVjaXNpb24gOiBmYWxzZTtcblxuXHRcdHZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXtcblxuXHRcdFx0dmFsdWUgPSBOdW1iZXIodmFsdWUpO1xuXG5cdFx0XHRpZih2YWx1ZSA8IG91dHB1dCB8fCBvdXRwdXQgPT09IG51bGwpe1xuXHRcdFx0XHRvdXRwdXQgPSB2YWx1ZTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBvdXRwdXQgIT09IG51bGwgPyAocHJlY2lzaW9uICE9PSBmYWxzZSA/IG91dHB1dC50b0ZpeGVkKHByZWNpc2lvbikgOiBvdXRwdXQpIDogXCJcIjtcblx0fSxcblx0XCJzdW1cIjpmdW5jdGlvbih2YWx1ZXMsIGRhdGEsIGNhbGNQYXJhbXMpe1xuXHRcdHZhciBvdXRwdXQgPSAwLFxuXHRcdHByZWNpc2lvbiA9IHR5cGVvZiBjYWxjUGFyYW1zLnByZWNpc2lvbiAhPT0gXCJ1bmRlZmluZWRcIiA/IGNhbGNQYXJhbXMucHJlY2lzaW9uIDogZmFsc2U7XG5cblx0XHRpZih2YWx1ZXMubGVuZ3RoKXtcblx0XHRcdHZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXtcblx0XHRcdFx0dmFsdWUgPSBOdW1iZXIodmFsdWUpO1xuXG5cdFx0XHRcdG91dHB1dCArPSAhaXNOYU4odmFsdWUpID8gTnVtYmVyKHZhbHVlKSA6IDA7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gcHJlY2lzaW9uICE9PSBmYWxzZSA/IG91dHB1dC50b0ZpeGVkKHByZWNpc2lvbikgOiBvdXRwdXQ7XG5cdH0sXG5cdFwiY29uY2F0XCI6ZnVuY3Rpb24odmFsdWVzLCBkYXRhLCBjYWxjUGFyYW1zKXtcblx0XHR2YXIgb3V0cHV0ID0gMDtcblxuXHRcdGlmKHZhbHVlcy5sZW5ndGgpe1xuXHRcdFx0b3V0cHV0ID0gdmFsdWVzLnJlZHVjZShmdW5jdGlvbihzdW0sIHZhbHVlKXtcblx0XHRcdFx0cmV0dXJuIFN0cmluZyhzdW0pICsgU3RyaW5nKHZhbHVlKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH0sXG5cdFwiY291bnRcIjpmdW5jdGlvbih2YWx1ZXMsIGRhdGEsIGNhbGNQYXJhbXMpe1xuXHRcdHZhciBvdXRwdXQgPSAwO1xuXG5cdFx0aWYodmFsdWVzLmxlbmd0aCl7XG5cdFx0XHR2YWx1ZXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSl7XG5cdFx0XHRcdGlmKHZhbHVlKXtcblx0XHRcdFx0XHRvdXRwdXQgKys7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH0sXG5cdFwidW5pcXVlXCI6ZnVuY3Rpb24odmFsdWVzLCBkYXRhLCBjYWxjUGFyYW1zKXtcblx0XHR2YXIgdW5pcXVlID0gdmFsdWVzLmZpbHRlcigodmFsdWUsIGluZGV4KSA9PiB7XG5cdFx0XHRyZXR1cm4gKHZhbHVlcyB8fCB2YWx1ZSA9PT0gMCkgJiYgdmFsdWVzLmluZGV4T2YodmFsdWUpID09PSBpbmRleDtcblx0XHR9KTtcblxuXHRcdHJldHVybiB1bmlxdWUubGVuZ3RoO1xuXHR9LFxufTtcblxuY2xhc3MgQ29sdW1uQ2FsY3MgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcImNvbHVtbkNhbGNzXCI7XG5cblx0Ly9sb2FkIGRlZmF1bHRzXG5cdHN0YXRpYyBjYWxjdWxhdGlvbnMgPSBkZWZhdWx0Q2FsY3VsYXRpb25zO1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLnRvcENhbGNzID0gW107XG5cdFx0dGhpcy5ib3RDYWxjcyA9IFtdO1xuXHRcdHRoaXMuZ2VuQ29sdW1uID0gZmFsc2U7XG5cdFx0dGhpcy50b3BFbGVtZW50ID0gdGhpcy5jcmVhdGVFbGVtZW50KCk7XG5cdFx0dGhpcy5ib3RFbGVtZW50ID0gdGhpcy5jcmVhdGVFbGVtZW50KCk7XG5cdFx0dGhpcy50b3BSb3cgPSBmYWxzZTtcblx0XHR0aGlzLmJvdFJvdyA9IGZhbHNlO1xuXHRcdHRoaXMudG9wSW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR0aGlzLmJvdEluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5ibG9ja2VkID0gZmFsc2U7XG5cdFx0dGhpcy5yZWNhbGNBZnRlckJsb2NrID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiY29sdW1uQ2FsY3NcIiwgdHJ1ZSk7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInRvcENhbGNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInRvcENhbGNQYXJhbXNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInRvcENhbGNGb3JtYXR0ZXJcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInRvcENhbGNGb3JtYXR0ZXJQYXJhbXNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImJvdHRvbUNhbGNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImJvdHRvbUNhbGNQYXJhbXNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImJvdHRvbUNhbGNGb3JtYXR0ZXJcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImJvdHRvbUNhbGNGb3JtYXR0ZXJQYXJhbXNcIik7XG5cdH1cblx0XG5cdGNyZWF0ZUVsZW1lbnQgKCl7XG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNhbGNzLWhvbGRlclwiKTtcblx0XHRyZXR1cm4gZWw7XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLmdlbkNvbHVtbiA9IG5ldyBDb2x1bW4oe2ZpZWxkOlwidmFsdWVcIn0sIHRoaXMpO1xuXHRcdFxuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC12YWx1ZS1jaGFuZ2VkXCIsIHRoaXMuY2VsbFZhbHVlQ2hhbmdlZC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1pbml0XCIsIHRoaXMuaW5pdGlhbGl6ZUNvbHVtbkNoZWNrLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWRlbGV0ZWRcIiwgdGhpcy5yb3dzVXBkYXRlZC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInNjcm9sbC1ob3Jpem9udGFsXCIsIHRoaXMuc2Nyb2xsSG9yaXpvbnRhbC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1hZGRlZFwiLCB0aGlzLnJvd3NVcGRhdGVkLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLW1vdmVkXCIsIHRoaXMucmVjYWxjQWN0aXZlUm93cy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1hZGRcIiwgdGhpcy5yZWNhbGNBY3RpdmVSb3dzLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1yZWZyZXNoZWRcIiwgdGhpcy5yZWNhbGNBY3RpdmVSb3dzUmVmcmVzaC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLXJlZHJhd1wiLCB0aGlzLnRhYmxlUmVkcmF3LmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwicm93cy12aXNpYmxlXCIsIHRoaXMudmlzaWJsZVJvd3MuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJzY3JvbGxiYXItdmVydGljYWxcIiwgdGhpcy5hZGp1c3RGb3JTY3JvbGxiYXIuYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJyZWRyYXctYmxvY2tlZFwiLCB0aGlzLmJsb2NrUmVkcmF3LmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwicmVkcmF3LXJlc3RvcmVkXCIsIHRoaXMucmVzdG9yZVJlZHJhdy5iaW5kKHRoaXMpKTtcblxuXHRcdHRoaXMuc3Vic2NyaWJlKFwidGFibGUtcmVkcmF3aW5nXCIsIHRoaXMucmVzaXplSG9sZGVyV2lkdGguYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tcmVzaXplZFwiLCB0aGlzLnJlc2l6ZUhvbGRlcldpZHRoLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLXNob3dcIiwgdGhpcy5yZXNpemVIb2xkZXJXaWR0aC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1oaWRlXCIsIHRoaXMucmVzaXplSG9sZGVyV2lkdGguYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRDYWxjUmVzdWx0c1wiLCB0aGlzLmdldFJlc3VsdHMuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJyZWNhbGNcIiwgdGhpcy51c2VyUmVjYWxjLmJpbmQodGhpcykpO1xuXG5cblx0XHR0aGlzLnJlc2l6ZUhvbGRlcldpZHRoKCk7XG5cdH1cblxuXHRyZXNpemVIb2xkZXJXaWR0aCgpe1xuXHRcdHRoaXMudG9wRWxlbWVudC5zdHlsZS5taW5XaWR0aCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5oZWFkZXJzRWxlbWVudC5vZmZzZXRXaWR0aCArIFwicHhcIjtcblx0fVxuXG5cdFxuXHR0YWJsZVJlZHJhdyhmb3JjZSl7XG5cdFx0dGhpcy5yZWNhbGModGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFjdGl2ZVJvd3MpO1xuXHRcdFxuXHRcdGlmKGZvcmNlKXtcblx0XHRcdHRoaXMucmVkcmF3KCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRibG9ja1JlZHJhdygpe1xuXHRcdHRoaXMuYmxvY2tlZCA9IHRydWU7XG5cdFx0dGhpcy5yZWNhbGNBZnRlckJsb2NrID0gZmFsc2U7XG5cdH1cblx0XG5cdFxuXHRyZXN0b3JlUmVkcmF3KCl7XG5cdFx0dGhpcy5ibG9ja2VkID0gZmFsc2U7XG5cdFx0XG5cdFx0aWYodGhpcy5yZWNhbGNBZnRlckJsb2NrKXtcblx0XHRcdHRoaXMucmVjYWxjQWZ0ZXJCbG9jayA9IGZhbHNlO1xuXHRcdFx0dGhpcy5yZWNhbGNBY3RpdmVSb3dzUmVmcmVzaCgpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIFRhYmxlIEZ1bmN0aW9ucyAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0dXNlclJlY2FsYygpe1xuXHRcdHRoaXMucmVjYWxjKHRoaXMudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIEludGVybmFsIExvZ2ljIC8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdGJsb2NrQ2hlY2soKXtcblx0XHRpZih0aGlzLmJsb2NrZWQpe1xuXHRcdFx0dGhpcy5yZWNhbGNBZnRlckJsb2NrID0gdHJ1ZTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuYmxvY2tlZDtcblx0fVxuXHRcblx0dmlzaWJsZVJvd3Modmlld2FibGUsIHJvd3Mpe1xuXHRcdGlmKHRoaXMudG9wUm93KXtcblx0XHRcdHJvd3MudW5zaGlmdCh0aGlzLnRvcFJvdyk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMuYm90Um93KXtcblx0XHRcdHJvd3MucHVzaCh0aGlzLmJvdFJvdyk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiByb3dzO1xuXHR9XG5cdFxuXHRyb3dzVXBkYXRlZChyb3cpe1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5KXtcblx0XHRcdHRoaXMucmVjYWxjUm93R3JvdXAocm93KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLnJlY2FsY0FjdGl2ZVJvd3MoKTtcblx0XHR9XG5cdH1cblx0XG5cdHJlY2FsY0FjdGl2ZVJvd3NSZWZyZXNoKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkgJiYgdGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlU3RhcnRFeHBhbmRlZCAmJiB0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUpe1xuXHRcdFx0dGhpcy5yZWNhbGNBbGwoKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLnJlY2FsY0FjdGl2ZVJvd3MoKTtcblx0XHR9XG5cdH1cblx0XG5cdHJlY2FsY0FjdGl2ZVJvd3MoKXtcblx0XHR0aGlzLnJlY2FsYyh0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWN0aXZlUm93cyk7XG5cdH1cblx0XG5cdGNlbGxWYWx1ZUNoYW5nZWQoY2VsbCl7XG5cdFx0aWYoY2VsbC5jb2x1bW4uZGVmaW5pdGlvbi50b3BDYWxjIHx8IGNlbGwuY29sdW1uLmRlZmluaXRpb24uYm90dG9tQ2FsYyl7XG5cdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSl7XG5cdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyA9PSBcInRhYmxlXCIgfHwgdGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzID09IFwiYm90aFwiKXtcblx0XHRcdFx0XHR0aGlzLnJlY2FsY0FjdGl2ZVJvd3MoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwidGFibGVcIil7XG5cdFx0XHRcdFx0dGhpcy5yZWNhbGNSb3dHcm91cChjZWxsLnJvdyk7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5yZWNhbGNBY3RpdmVSb3dzKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRpbml0aWFsaXplQ29sdW1uQ2hlY2soY29sdW1uKXtcblx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi50b3BDYWxjIHx8IGNvbHVtbi5kZWZpbml0aW9uLmJvdHRvbUNhbGMpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQ29sdW1uKGNvbHVtbik7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL2luaXRpYWxpemUgY29sdW1uIGNhbGNzXG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHR2YXIgZGVmID0gY29sdW1uLmRlZmluaXRpb247XG5cdFx0XG5cdFx0dmFyIGNvbmZpZyA9IHtcblx0XHRcdHRvcENhbGNQYXJhbXM6ZGVmLnRvcENhbGNQYXJhbXMgfHwge30sXG5cdFx0XHRib3RDYWxjUGFyYW1zOmRlZi5ib3R0b21DYWxjUGFyYW1zIHx8IHt9LFxuXHRcdH07XG5cdFx0XG5cdFx0aWYoZGVmLnRvcENhbGMpe1xuXHRcdFx0XG5cdFx0XHRzd2l0Y2godHlwZW9mIGRlZi50b3BDYWxjKXtcblx0XHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRcdGlmKENvbHVtbkNhbGNzLmNhbGN1bGF0aW9uc1tkZWYudG9wQ2FsY10pe1xuXHRcdFx0XHRcdFx0Y29uZmlnLnRvcENhbGMgPSBDb2x1bW5DYWxjcy5jYWxjdWxhdGlvbnNbZGVmLnRvcENhbGNdO1xuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBDYWxjIEVycm9yIC0gTm8gc3VjaCBjYWxjdWxhdGlvbiBmb3VuZCwgaWdub3Jpbmc6IFwiLCBkZWYudG9wQ2FsYyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcblx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdFx0Y29uZmlnLnRvcENhbGMgPSBkZWYudG9wQ2FsYztcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKGNvbmZpZy50b3BDYWxjKXtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuY29sdW1uQ2FsY3MgPSBjb25maWc7XG5cdFx0XHRcdHRoaXMudG9wQ2FsY3MucHVzaChjb2x1bW4pO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwiZ3JvdXBcIil7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplVG9wUm93KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdH1cblx0XHRcblx0XHRpZihkZWYuYm90dG9tQ2FsYyl7XG5cdFx0XHRzd2l0Y2godHlwZW9mIGRlZi5ib3R0b21DYWxjKXtcblx0XHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRcdGlmKENvbHVtbkNhbGNzLmNhbGN1bGF0aW9uc1tkZWYuYm90dG9tQ2FsY10pe1xuXHRcdFx0XHRcdFx0Y29uZmlnLmJvdENhbGMgPSBDb2x1bW5DYWxjcy5jYWxjdWxhdGlvbnNbZGVmLmJvdHRvbUNhbGNdO1xuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBDYWxjIEVycm9yIC0gTm8gc3VjaCBjYWxjdWxhdGlvbiBmb3VuZCwgaWdub3Jpbmc6IFwiLCBkZWYuYm90dG9tQ2FsYyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcblx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdFx0Y29uZmlnLmJvdENhbGMgPSBkZWYuYm90dG9tQ2FsYztcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKGNvbmZpZy5ib3RDYWxjKXtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuY29sdW1uQ2FsY3MgPSBjb25maWc7XG5cdFx0XHRcdHRoaXMuYm90Q2FsY3MucHVzaChjb2x1bW4pO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwiZ3JvdXBcIil7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplQm90dG9tUm93KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdH1cblx0XG5cdC8vZHVtbXkgZnVuY3Rpb25zIHRvIGhhbmRsZSBiZWluZyBtb2NrIGNvbHVtbiBtYW5hZ2VyXG5cdHJlZ2lzdGVyQ29sdW1uRmllbGQoKXt9XG5cdFxuXHRyZW1vdmVDYWxjcygpe1xuXHRcdHZhciBjaGFuZ2VkID0gZmFsc2U7XG5cdFx0XG5cdFx0aWYodGhpcy50b3BJbml0aWFsaXplZCl7XG5cdFx0XHR0aGlzLnRvcEluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR0aGlzLnRvcEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnRvcEVsZW1lbnQpO1xuXHRcdFx0Y2hhbmdlZCA9IHRydWU7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMuYm90SW5pdGlhbGl6ZWQpe1xuXHRcdFx0dGhpcy5ib3RJbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdFx0dGhpcy5mb290ZXJSZW1vdmUodGhpcy5ib3RFbGVtZW50KTtcblx0XHRcdGNoYW5nZWQgPSB0cnVlO1xuXHRcdH1cblx0XHRcblx0XHRpZihjaGFuZ2VkKXtcblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5hZGp1c3RUYWJsZVNpemUoKTtcblx0XHR9XG5cdH1cblx0XG5cdHJlaW5pdGlhbGl6ZUNhbGNzKCl7XG5cdFx0aWYodGhpcy50b3BDYWxjcy5sZW5ndGgpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplVG9wUm93KCk7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5ib3RDYWxjcy5sZW5ndGgpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQm90dG9tUm93KCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRpbml0aWFsaXplVG9wUm93KCl7XG5cdFx0dmFyXHRmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblx0XHRcblx0XHRpZighdGhpcy50b3BJbml0aWFsaXplZCl7XG5cblx0XHRcdGZyYWdtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSk7XG5cdFx0XHRmcmFnbWVudC5hcHBlbmRDaGlsZCh0aGlzLnRvcEVsZW1lbnQpO1xuXG5cdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29udGVudHNFbGVtZW50KCkuaW5zZXJ0QmVmb3JlKGZyYWdtZW50LCB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuaGVhZGVyc0VsZW1lbnQubmV4dFNpYmxpbmcpO1xuXHRcdFx0dGhpcy50b3BJbml0aWFsaXplZCA9IHRydWU7XG5cdFx0fVxuXHR9XG5cdFxuXHRpbml0aWFsaXplQm90dG9tUm93KCl7XG5cdFx0aWYoIXRoaXMuYm90SW5pdGlhbGl6ZWQpe1xuXHRcdFx0dGhpcy5mb290ZXJQcmVwZW5kKHRoaXMuYm90RWxlbWVudCk7XG5cdFx0XHR0aGlzLmJvdEluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHR9XG5cdH1cblx0XG5cdHNjcm9sbEhvcml6b250YWwobGVmdCl7XG5cdFx0aWYodGhpcy5ib3RJbml0aWFsaXplZCAmJiB0aGlzLmJvdFJvdyl7XG5cdFx0XHR0aGlzLmJvdEVsZW1lbnQuc2Nyb2xsTGVmdCA9IGxlZnQ7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZWNhbGMocm93cyl7XG5cdFx0dmFyIGRhdGEsIHJvdztcblx0XHRcblx0XHRpZighdGhpcy5ibG9ja0NoZWNrKCkpe1xuXHRcdFx0aWYodGhpcy50b3BJbml0aWFsaXplZCB8fCB0aGlzLmJvdEluaXRpYWxpemVkKXtcblx0XHRcdFx0ZGF0YSA9IHRoaXMucm93c1RvRGF0YShyb3dzKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHRoaXMudG9wSW5pdGlhbGl6ZWQpe1xuXHRcdFx0XHRcdGlmKHRoaXMudG9wUm93KXtcblx0XHRcdFx0XHRcdHRoaXMudG9wUm93LmRlbGV0ZUNlbGxzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJvdyA9IHRoaXMuZ2VuZXJhdGVSb3coXCJ0b3BcIiwgZGF0YSk7XG5cdFx0XHRcdFx0dGhpcy50b3BSb3cgPSByb3c7XG5cdFx0XHRcdFx0d2hpbGUodGhpcy50b3BFbGVtZW50LmZpcnN0Q2hpbGQpIHRoaXMudG9wRWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLnRvcEVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdFx0XHRcdFx0dGhpcy50b3BFbGVtZW50LmFwcGVuZENoaWxkKHJvdy5nZXRFbGVtZW50KCkpO1xuXHRcdFx0XHRcdHJvdy5pbml0aWFsaXplKHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLmJvdEluaXRpYWxpemVkKXtcblx0XHRcdFx0XHRpZih0aGlzLmJvdFJvdyl7XG5cdFx0XHRcdFx0XHR0aGlzLmJvdFJvdy5kZWxldGVDZWxscygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRyb3cgPSB0aGlzLmdlbmVyYXRlUm93KFwiYm90dG9tXCIsIGRhdGEpO1xuXHRcdFx0XHRcdHRoaXMuYm90Um93ID0gcm93O1xuXHRcdFx0XHRcdHdoaWxlKHRoaXMuYm90RWxlbWVudC5maXJzdENoaWxkKSB0aGlzLmJvdEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5ib3RFbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdFx0XHRcdHRoaXMuYm90RWxlbWVudC5hcHBlbmRDaGlsZChyb3cuZ2V0RWxlbWVudCgpKTtcblx0XHRcdFx0XHRyb3cuaW5pdGlhbGl6ZSh0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFkanVzdFRhYmxlU2l6ZSgpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly9zZXQgcmVzaXphYmxlIGhhbmRsZXNcblx0XHRcdFx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJmcm96ZW5Db2x1bW5zXCIpKXtcblx0XHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZnJvemVuQ29sdW1ucy5sYXlvdXQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0cmVjYWxjUm93R3JvdXAocm93KXtcblx0XHR0aGlzLnJlY2FsY0dyb3VwKHRoaXMudGFibGUubW9kdWxlcy5ncm91cFJvd3MuZ2V0Um93R3JvdXAocm93KSk7XG5cdH1cblx0XG5cdHJlY2FsY0FsbCgpe1xuXHRcdGlmKHRoaXMudG9wQ2FsY3MubGVuZ3RoIHx8IHRoaXMuYm90Q2FsY3MubGVuZ3RoKXtcblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPT0gXCJncm91cFwiKXtcblx0XHRcdFx0dGhpcy5yZWNhbGNBY3RpdmVSb3dzKCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5ICYmIHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPT0gXCJ0YWJsZVwiKXtcblx0XHRcdFx0XG5cdFx0XHRcdHZhciBncm91cHMgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLmdldENoaWxkR3JvdXBzKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRncm91cHMuZm9yRWFjaCgoZ3JvdXApID0+IHtcblx0XHRcdFx0XHR0aGlzLnJlY2FsY0dyb3VwKGdyb3VwKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRyZWNhbGNHcm91cChncm91cCl7XG5cdFx0dmFyIGRhdGEsIHJvd0RhdGE7XG5cdFx0XG5cdFx0aWYoIXRoaXMuYmxvY2tDaGVjaygpKXtcblx0XHRcdGlmKGdyb3VwKXtcblx0XHRcdFx0aWYoZ3JvdXAuY2FsY3Mpe1xuXHRcdFx0XHRcdGlmKGdyb3VwLmNhbGNzLmJvdHRvbSl7XG5cdFx0XHRcdFx0XHRkYXRhID0gdGhpcy5yb3dzVG9EYXRhKGdyb3VwLnJvd3MpO1xuXHRcdFx0XHRcdFx0cm93RGF0YSA9IHRoaXMuZ2VuZXJhdGVSb3dEYXRhKFwiYm90dG9tXCIsIGRhdGEpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRncm91cC5jYWxjcy5ib3R0b20udXBkYXRlRGF0YShyb3dEYXRhKTtcblx0XHRcdFx0XHRcdGdyb3VwLmNhbGNzLmJvdHRvbS5yZWluaXRpYWxpemUoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoZ3JvdXAuY2FsY3MudG9wKXtcblx0XHRcdFx0XHRcdGRhdGEgPSB0aGlzLnJvd3NUb0RhdGEoZ3JvdXAucm93cyk7XG5cdFx0XHRcdFx0XHRyb3dEYXRhID0gdGhpcy5nZW5lcmF0ZVJvd0RhdGEoXCJ0b3BcIiwgZGF0YSk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGdyb3VwLmNhbGNzLnRvcC51cGRhdGVEYXRhKHJvd0RhdGEpO1xuXHRcdFx0XHRcdFx0Z3JvdXAuY2FsY3MudG9wLnJlaW5pdGlhbGl6ZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0Ly9nZW5lcmF0ZSB0b3Agc3RhdHMgcm93XG5cdGdlbmVyYXRlVG9wUm93KHJvd3Mpe1xuXHRcdHJldHVybiB0aGlzLmdlbmVyYXRlUm93KFwidG9wXCIsIHRoaXMucm93c1RvRGF0YShyb3dzKSk7XG5cdH1cblx0Ly9nZW5lcmF0ZSBib3R0b20gc3RhdHMgcm93XG5cdGdlbmVyYXRlQm90dG9tUm93KHJvd3Mpe1xuXHRcdHJldHVybiB0aGlzLmdlbmVyYXRlUm93KFwiYm90dG9tXCIsIHRoaXMucm93c1RvRGF0YShyb3dzKSk7XG5cdH1cblx0XG5cdHJvd3NUb0RhdGEocm93cyl7XG5cdFx0dmFyIGRhdGEgPSBbXSxcblx0XHRoYXNEYXRhVHJlZUNvbHVtbkNhbGNzID0gdGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlICYmIHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZUNoaWxkQ29sdW1uQ2FsY3MsXG5cdFx0ZGF0YVRyZWUgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZGF0YVRyZWU7XG5cblx0XHRyb3dzLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0ZGF0YS5wdXNoKHJvdy5nZXREYXRhKCkpO1xuXG5cdFx0XHRpZihoYXNEYXRhVHJlZUNvbHVtbkNhbGNzICYmIHJvdy5tb2R1bGVzLmRhdGFUcmVlPy5vcGVuKXtcblx0XHRcdFx0dGhpcy5yb3dzVG9EYXRhKGRhdGFUcmVlLmdldEZpbHRlcmVkVHJlZUNoaWxkcmVuKHJvdykpLmZvckVhY2goZGF0YVJvdyA9Pntcblx0XHRcdFx0XHRkYXRhLnB1c2gocm93KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIGRhdGE7XG5cdH1cblx0XG5cdC8vZ2VuZXJhdGUgc3RhdHMgcm93XG5cdGdlbmVyYXRlUm93KHBvcywgZGF0YSl7XG5cdFx0dmFyIHJvd0RhdGEgPSB0aGlzLmdlbmVyYXRlUm93RGF0YShwb3MsIGRhdGEpLFxuXHRcdHJvdztcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm1vZEV4aXN0cyhcIm11dGF0b3JcIikpe1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLm11dGF0b3IuZGlzYWJsZSgpO1xuXHRcdH1cblx0XHRcblx0XHRyb3cgPSBuZXcgUm93KHJvd0RhdGEsIHRoaXMsIFwiY2FsY1wiKTtcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm1vZEV4aXN0cyhcIm11dGF0b3JcIikpe1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLm11dGF0b3IuZW5hYmxlKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHJvdy5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jYWxjc1wiLCBcInRhYnVsYXRvci1jYWxjcy1cIiArIHBvcyk7XG5cdFx0XG5cdFx0cm93LmNvbXBvbmVudCA9IGZhbHNlO1xuXHRcdFxuXHRcdHJvdy5nZXRDb21wb25lbnQgPSAoKSA9PiB7XG5cdFx0XHRpZighcm93LmNvbXBvbmVudCl7XG5cdFx0XHRcdHJvdy5jb21wb25lbnQgPSBuZXcgQ2FsY0NvbXBvbmVudChyb3cpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRyZXR1cm4gcm93LmNvbXBvbmVudDtcblx0XHR9O1xuXHRcdFxuXHRcdHJvdy5nZW5lcmF0ZUNlbGxzID0gKCkgPT4ge1xuXHRcdFx0XG5cdFx0XHR2YXIgY2VsbHMgPSBbXTtcblx0XHRcdFxuXHRcdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZvckVhY2goKGNvbHVtbikgPT4ge1xuXHRcdFx0XHRcblx0XHRcdFx0Ly9zZXQgZmllbGQgbmFtZSBvZiBtb2NrIGNvbHVtblxuXHRcdFx0XHR0aGlzLmdlbkNvbHVtbi5zZXRGaWVsZChjb2x1bW4uZ2V0RmllbGQoKSk7XG5cdFx0XHRcdHRoaXMuZ2VuQ29sdW1uLmhvekFsaWduID0gY29sdW1uLmhvekFsaWduO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoY29sdW1uLmRlZmluaXRpb25bcG9zICsgXCJDYWxjRm9ybWF0dGVyXCJdICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiZm9ybWF0XCIpKXtcblx0XHRcdFx0XHR0aGlzLmdlbkNvbHVtbi5tb2R1bGVzLmZvcm1hdCA9IHtcblx0XHRcdFx0XHRcdGZvcm1hdHRlcjogdGhpcy50YWJsZS5tb2R1bGVzLmZvcm1hdC5sb29rdXBGb3JtYXR0ZXIoY29sdW1uLmRlZmluaXRpb25bcG9zICsgXCJDYWxjRm9ybWF0dGVyXCJdKSxcblx0XHRcdFx0XHRcdHBhcmFtczogY29sdW1uLmRlZmluaXRpb25bcG9zICsgXCJDYWxjRm9ybWF0dGVyUGFyYW1zXCJdIHx8IHt9LFxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHR0aGlzLmdlbkNvbHVtbi5tb2R1bGVzLmZvcm1hdCA9IHtcblx0XHRcdFx0XHRcdGZvcm1hdHRlcjogdGhpcy50YWJsZS5tb2R1bGVzLmZvcm1hdC5sb29rdXBGb3JtYXR0ZXIoXCJwbGFpbnRleHRcIiksXG5cdFx0XHRcdFx0XHRwYXJhbXM6e31cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvL2Vuc3VyZSBjc3MgY2xhc3MgZGVmaW5pdGlvbiBpcyByZXBsaWNhdGVkIHRvIGNhbGN1bGF0aW9uIGNlbGxcblx0XHRcdFx0dGhpcy5nZW5Db2x1bW4uZGVmaW5pdGlvbi5jc3NDbGFzcyA9IGNvbHVtbi5kZWZpbml0aW9uLmNzc0NsYXNzO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly9nZW5lcmF0ZSBjZWxsIGFuZCBhc3NpZ24gdG8gY29ycmVjdCBjb2x1bW5cblx0XHRcdFx0dmFyIGNlbGwgPSBuZXcgQ2VsbCh0aGlzLmdlbkNvbHVtbiwgcm93KTtcblx0XHRcdFx0Y2VsbC5nZXRFbGVtZW50KCk7XG5cdFx0XHRcdGNlbGwuY29sdW1uID0gY29sdW1uO1xuXHRcdFx0XHRjZWxsLnNldFdpZHRoKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb2x1bW4uY2VsbHMucHVzaChjZWxsKTtcblx0XHRcdFx0Y2VsbHMucHVzaChjZWxsKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKCFjb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRcdFx0Y2VsbC5oaWRlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRyb3cuY2VsbHMgPSBjZWxscztcblx0XHR9O1xuXHRcdFxuXHRcdHJldHVybiByb3c7XG5cdH1cblx0XG5cdC8vZ2VuZXJhdGUgc3RhdHMgcm93XG5cdGdlbmVyYXRlUm93RGF0YShwb3MsIGRhdGEpe1xuXHRcdHZhciByb3dEYXRhID0ge30sXG5cdFx0Y2FsY3MgPSBwb3MgPT0gXCJ0b3BcIiA/IHRoaXMudG9wQ2FsY3MgOiB0aGlzLmJvdENhbGNzLFxuXHRcdHR5cGUgPSBwb3MgPT0gXCJ0b3BcIiA/IFwidG9wQ2FsY1wiIDogXCJib3RDYWxjXCIsXG5cdFx0cGFyYW1zLCBwYXJhbUtleTtcblx0XHRcblx0XHRjYWxjcy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHR2YXIgdmFsdWVzID0gW107XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbi5tb2R1bGVzLmNvbHVtbkNhbGNzICYmIGNvbHVtbi5tb2R1bGVzLmNvbHVtbkNhbGNzW3R5cGVdKXtcblx0XHRcdFx0ZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuXHRcdFx0XHRcdHZhbHVlcy5wdXNoKGNvbHVtbi5nZXRGaWVsZFZhbHVlKGl0ZW0pKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRwYXJhbUtleSA9IHR5cGUgKyBcIlBhcmFtc1wiO1xuXHRcdFx0XHRwYXJhbXMgPSB0eXBlb2YgY29sdW1uLm1vZHVsZXMuY29sdW1uQ2FsY3NbcGFyYW1LZXldID09PSBcImZ1bmN0aW9uXCIgPyBjb2x1bW4ubW9kdWxlcy5jb2x1bW5DYWxjc1twYXJhbUtleV0odmFsdWVzLCBkYXRhKSA6IGNvbHVtbi5tb2R1bGVzLmNvbHVtbkNhbGNzW3BhcmFtS2V5XTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbHVtbi5zZXRGaWVsZFZhbHVlKHJvd0RhdGEsIGNvbHVtbi5tb2R1bGVzLmNvbHVtbkNhbGNzW3R5cGVdKHZhbHVlcywgZGF0YSwgcGFyYW1zKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIHJvd0RhdGE7XG5cdH1cblx0XG5cdGhhc1RvcENhbGNzKCl7XG5cdFx0cmV0dXJuXHQhISh0aGlzLnRvcENhbGNzLmxlbmd0aCk7XG5cdH1cblx0XG5cdGhhc0JvdHRvbUNhbGNzKCl7XG5cdFx0cmV0dXJuXHQhISh0aGlzLmJvdENhbGNzLmxlbmd0aCk7XG5cdH1cblx0XG5cdC8vaGFuZGxlIHRhYmxlIHJlZHJhd1xuXHRyZWRyYXcoKXtcblx0XHRpZih0aGlzLnRvcFJvdyl7XG5cdFx0XHR0aGlzLnRvcFJvdy5ub3JtYWxpemVIZWlnaHQodHJ1ZSk7XG5cdFx0fVxuXHRcdGlmKHRoaXMuYm90Um93KXtcblx0XHRcdHRoaXMuYm90Um93Lm5vcm1hbGl6ZUhlaWdodCh0cnVlKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vcmV0dXJuIHRoZSBjYWxjdWxhdGVkXG5cdGdldFJlc3VsdHMoKXtcblx0XHR2YXIgcmVzdWx0cyA9IHt9LFxuXHRcdGdyb3Vwcztcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSl7XG5cdFx0XHRncm91cHMgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLmdldEdyb3Vwcyh0cnVlKTtcblx0XHRcdFxuXHRcdFx0Z3JvdXBzLmZvckVhY2goKGdyb3VwKSA9PiB7XG5cdFx0XHRcdHJlc3VsdHNbZ3JvdXAuZ2V0S2V5KCldID0gdGhpcy5nZXRHcm91cFJlc3VsdHMoZ3JvdXApO1xuXHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0cmVzdWx0cyA9IHtcblx0XHRcdFx0dG9wOiB0aGlzLnRvcFJvdyA/IHRoaXMudG9wUm93LmdldERhdGEoKSA6IHt9LFxuXHRcdFx0XHRib3R0b206IHRoaXMuYm90Um93ID8gdGhpcy5ib3RSb3cuZ2V0RGF0YSgpIDoge30sXG5cdFx0XHR9O1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gcmVzdWx0cztcblx0fVxuXHRcblx0Ly9nZXQgcmVzdWx0cyBmcm9tIGEgZ3JvdXBcblx0Z2V0R3JvdXBSZXN1bHRzKGdyb3VwKXtcblx0XHR2YXIgZ3JvdXBPYmogPSBncm91cC5fZ2V0U2VsZigpLFxuXHRcdHN1Ykdyb3VwcyA9IGdyb3VwLmdldFN1Ykdyb3VwcygpLFxuXHRcdHN1Ykdyb3VwUmVzdWx0cyA9IHt9LFxuXHRcdHJlc3VsdHMgPSB7fTtcblx0XHRcblx0XHRzdWJHcm91cHMuZm9yRWFjaCgoc3ViZ3JvdXApID0+IHtcblx0XHRcdHN1Ykdyb3VwUmVzdWx0c1tzdWJncm91cC5nZXRLZXkoKV0gPSB0aGlzLmdldEdyb3VwUmVzdWx0cyhzdWJncm91cCk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmVzdWx0cyA9IHtcblx0XHRcdHRvcDogZ3JvdXBPYmouY2FsY3MudG9wID8gZ3JvdXBPYmouY2FsY3MudG9wLmdldERhdGEoKSA6IHt9LFxuXHRcdFx0Ym90dG9tOiBncm91cE9iai5jYWxjcy5ib3R0b20gPyBncm91cE9iai5jYWxjcy5ib3R0b20uZ2V0RGF0YSgpIDoge30sXG5cdFx0XHRncm91cHM6IHN1Ykdyb3VwUmVzdWx0cyxcblx0XHR9O1xuXHRcdFxuXHRcdHJldHVybiByZXN1bHRzO1xuXHR9XG5cdFxuXHRhZGp1c3RGb3JTY3JvbGxiYXIod2lkdGgpe1xuXHRcdGlmKHRoaXMuYm90Um93KXtcblx0XHRcdGlmKHRoaXMudGFibGUucnRsKXtcblx0XHRcdFx0dGhpcy5ib3RFbGVtZW50LnN0eWxlLnBhZGRpbmdMZWZ0ID0gd2lkdGggKyBcInB4XCI7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMuYm90RWxlbWVudC5zdHlsZS5wYWRkaW5nUmlnaHQgPSB3aWR0aCArIFwicHhcIjtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxuY2xhc3MgRGF0YVRyZWUgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcImRhdGFUcmVlXCI7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMuaW5kZW50ID0gMTA7XG5cdFx0dGhpcy5maWVsZCA9IFwiXCI7XG5cdFx0dGhpcy5jb2xsYXBzZUVsID0gbnVsbDtcblx0XHR0aGlzLmV4cGFuZEVsID0gbnVsbDtcblx0XHR0aGlzLmJyYW5jaEVsID0gbnVsbDtcblx0XHR0aGlzLmVsZW1lbnRGaWVsZCA9IGZhbHNlO1xuXG5cdFx0dGhpcy5zdGFydE9wZW4gPSBmdW5jdGlvbigpe307XG5cblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJkYXRhVHJlZVwiLCBmYWxzZSk7IC8vZW5hYmxlIGRhdGEgdHJlZVxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImRhdGFUcmVlRmlsdGVyXCIsIHRydWUpOyAvL2ZpbHRlciBjaGlsZCByb3dzXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZGF0YVRyZWVTb3J0XCIsIHRydWUpOyAvL3NvcnQgY2hpbGQgcm93c1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImRhdGFUcmVlRWxlbWVudENvbHVtblwiLCBmYWxzZSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZGF0YVRyZWVCcmFuY2hFbGVtZW50XCIsIHRydWUpOy8vc2hvdyBkYXRhIHRyZWUgYnJhbmNoIGVsZW1lbnRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJkYXRhVHJlZUNoaWxkSW5kZW50XCIsIDkpOyAvL2RhdGEgdHJlZSBjaGlsZCBpbmRlbnQgaW4gcHhcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJkYXRhVHJlZUNoaWxkRmllbGRcIiwgXCJfY2hpbGRyZW5cIik7Ly9kYXRhIHRyZSBjb2x1bW4gZmllbGQgdG8gbG9vayBmb3IgY2hpbGQgcm93c1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImRhdGFUcmVlQ29sbGFwc2VFbGVtZW50XCIsIGZhbHNlKTsvL2RhdGEgdHJlZSByb3cgY29sbGFwc2UgZWxlbWVudFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImRhdGFUcmVlRXhwYW5kRWxlbWVudFwiLCBmYWxzZSk7Ly9kYXRhIHRyZWUgcm93IGV4cGFuZCBlbGVtZW50XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZGF0YVRyZWVTdGFydEV4cGFuZGVkXCIsIGZhbHNlKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJkYXRhVHJlZUNoaWxkQ29sdW1uQ2FsY3NcIiwgZmFsc2UpOy8vaW5jbHVkZSB2aXNpYmxlIGRhdGEgdHJlZSByb3dzIGluIGNvbHVtbiBjYWxjdWxhdGlvbnNcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJkYXRhVHJlZVNlbGVjdFByb3BhZ2F0ZVwiLCBmYWxzZSk7Ly9zZWxlY3RpbmcgYSBwYXJlbnQgcm93IHNlbGVjdHMgaXRzIGNoaWxkcmVuXG5cblx0XHQvL3JlZ2lzdGVyIGNvbXBvbmVudCBmdW5jdGlvbnNcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJyb3dcIiwgXCJ0cmVlQ29sbGFwc2VcIiwgdGhpcy5jb2xsYXBzZVJvdy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJyb3dcIiwgXCJ0cmVlRXhwYW5kXCIsIHRoaXMuZXhwYW5kUm93LmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcInJvd1wiLCBcInRyZWVUb2dnbGVcIiwgdGhpcy50b2dnbGVSb3cuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwicm93XCIsIFwiZ2V0VHJlZVBhcmVudFwiLCB0aGlzLmdldFRyZWVQYXJlbnQuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwicm93XCIsIFwiZ2V0VHJlZUNoaWxkcmVuXCIsIHRoaXMuZ2V0Um93Q2hpbGRyZW4uYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwicm93XCIsIFwiYWRkVHJlZUNoaWxkXCIsIHRoaXMuYWRkVHJlZUNoaWxkUm93LmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcInJvd1wiLCBcImlzVHJlZUV4cGFuZGVkXCIsIHRoaXMuaXNSb3dFeHBhbmRlZC5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdGluaXRpYWxpemUoKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUpe1xuXHRcdFx0dmFyIGR1bW15RWwgPSBudWxsLFxuXHRcdFx0b3B0aW9ucyA9IHRoaXMudGFibGUub3B0aW9ucztcblxuXHRcdFx0dGhpcy5maWVsZCA9IG9wdGlvbnMuZGF0YVRyZWVDaGlsZEZpZWxkO1xuXHRcdFx0dGhpcy5pbmRlbnQgPSBvcHRpb25zLmRhdGFUcmVlQ2hpbGRJbmRlbnQ7XG5cblx0XHRcdGlmKHRoaXMub3B0aW9ucyhcIm1vdmFibGVSb3dzXCIpKXtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiVGhlIG1vdmFibGVSb3dzIG9wdGlvbiBpcyBub3QgYXZhaWxhYmxlIHdpdGggZGF0YVRyZWUgZW5hYmxlZCwgbW92aW5nIG9mIGNoaWxkIHJvd3MgY291bGQgcmVzdWx0IGluIHVucHJlZGljdGFibGUgYmVoYXZpb3JcIik7XG5cdFx0XHR9XG5cblx0XHRcdGlmKG9wdGlvbnMuZGF0YVRyZWVCcmFuY2hFbGVtZW50KXtcblxuXHRcdFx0XHRpZihvcHRpb25zLmRhdGFUcmVlQnJhbmNoRWxlbWVudCA9PT0gdHJ1ZSl7XG5cdFx0XHRcdFx0dGhpcy5icmFuY2hFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRcdFx0dGhpcy5icmFuY2hFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWRhdGEtdHJlZS1icmFuY2hcIik7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRpZih0eXBlb2Ygb3B0aW9ucy5kYXRhVHJlZUJyYW5jaEVsZW1lbnQgPT09IFwic3RyaW5nXCIpe1xuXHRcdFx0XHRcdFx0ZHVtbXlFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRcdFx0XHRkdW1teUVsLmlubmVySFRNTCA9IG9wdGlvbnMuZGF0YVRyZWVCcmFuY2hFbGVtZW50O1xuXHRcdFx0XHRcdFx0dGhpcy5icmFuY2hFbCA9IGR1bW15RWwuZmlyc3RDaGlsZDtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLmJyYW5jaEVsID0gb3B0aW9ucy5kYXRhVHJlZUJyYW5jaEVsZW1lbnQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMuYnJhbmNoRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0XHR0aGlzLmJyYW5jaEVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZGF0YS10cmVlLWJyYW5jaC1lbXB0eVwiKTtcblx0XHRcdH1cblxuXHRcdFx0aWYob3B0aW9ucy5kYXRhVHJlZUNvbGxhcHNlRWxlbWVudCl7XG5cdFx0XHRcdGlmKHR5cGVvZiBvcHRpb25zLmRhdGFUcmVlQ29sbGFwc2VFbGVtZW50ID09PSBcInN0cmluZ1wiKXtcblx0XHRcdFx0XHRkdW1teUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdFx0XHRkdW1teUVsLmlubmVySFRNTCA9IG9wdGlvbnMuZGF0YVRyZWVDb2xsYXBzZUVsZW1lbnQ7XG5cdFx0XHRcdFx0dGhpcy5jb2xsYXBzZUVsID0gZHVtbXlFbC5maXJzdENoaWxkO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5jb2xsYXBzZUVsID0gb3B0aW9ucy5kYXRhVHJlZUNvbGxhcHNlRWxlbWVudDtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmNvbGxhcHNlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0XHR0aGlzLmNvbGxhcHNlRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1kYXRhLXRyZWUtY29udHJvbFwiKTtcblx0XHRcdFx0dGhpcy5jb2xsYXBzZUVsLnRhYkluZGV4ID0gMDtcblx0XHRcdFx0dGhpcy5jb2xsYXBzZUVsLmlubmVySFRNTCA9IFwiPGRpdiBjbGFzcz0ndGFidWxhdG9yLWRhdGEtdHJlZS1jb250cm9sLWNvbGxhcHNlJz48L2Rpdj5cIjtcblx0XHRcdH1cblxuXHRcdFx0aWYob3B0aW9ucy5kYXRhVHJlZUV4cGFuZEVsZW1lbnQpe1xuXHRcdFx0XHRpZih0eXBlb2Ygb3B0aW9ucy5kYXRhVHJlZUV4cGFuZEVsZW1lbnQgPT09IFwic3RyaW5nXCIpe1xuXHRcdFx0XHRcdGR1bW15RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0XHRcdGR1bW15RWwuaW5uZXJIVE1MID0gb3B0aW9ucy5kYXRhVHJlZUV4cGFuZEVsZW1lbnQ7XG5cdFx0XHRcdFx0dGhpcy5leHBhbmRFbCA9IGR1bW15RWwuZmlyc3RDaGlsZDtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuZXhwYW5kRWwgPSBvcHRpb25zLmRhdGFUcmVlRXhwYW5kRWxlbWVudDtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmV4cGFuZEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdFx0dGhpcy5leHBhbmRFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWRhdGEtdHJlZS1jb250cm9sXCIpO1xuXHRcdFx0XHR0aGlzLmV4cGFuZEVsLnRhYkluZGV4ID0gMDtcblx0XHRcdFx0dGhpcy5leHBhbmRFbC5pbm5lckhUTUwgPSBcIjxkaXYgY2xhc3M9J3RhYnVsYXRvci1kYXRhLXRyZWUtY29udHJvbC1leHBhbmQnPjwvZGl2PlwiO1xuXHRcdFx0fVxuXG5cblx0XHRcdHN3aXRjaCh0eXBlb2Ygb3B0aW9ucy5kYXRhVHJlZVN0YXJ0RXhwYW5kZWQpe1xuXHRcdFx0XHRjYXNlIFwiYm9vbGVhblwiOlxuXHRcdFx0XHRcdHRoaXMuc3RhcnRPcGVuID0gZnVuY3Rpb24ocm93LCBpbmRleCl7XG5cdFx0XHRcdFx0XHRyZXR1cm4gb3B0aW9ucy5kYXRhVHJlZVN0YXJ0RXhwYW5kZWQ7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0XHR0aGlzLnN0YXJ0T3BlbiA9IG9wdGlvbnMuZGF0YVRyZWVTdGFydEV4cGFuZGVkO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0dGhpcy5zdGFydE9wZW4gPSBmdW5jdGlvbihyb3csIGluZGV4KXtcblx0XHRcdFx0XHRcdHJldHVybiBvcHRpb25zLmRhdGFUcmVlU3RhcnRFeHBhbmRlZFtpbmRleF07XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctaW5pdFwiLCB0aGlzLmluaXRpYWxpemVSb3cuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1sYXlvdXQtYWZ0ZXJcIiwgdGhpcy5sYXlvdXRSb3cuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1kZWxldGluZ1wiLCB0aGlzLnJvd0RlbGV0aW5nLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctZGVsZXRlZFwiLCB0aGlzLnJvd0RlbGV0ZS5iaW5kKHRoaXMpLDApO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctZGF0YS1jaGFuZ2VkXCIsIHRoaXMucm93RGF0YUNoYW5nZWQuYmluZCh0aGlzKSwgMTApO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLXZhbHVlLXVwZGF0ZWRcIiwgdGhpcy5jZWxsVmFsdWVDaGFuZ2VkLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJlZGl0LWNhbmNlbGxlZFwiLCB0aGlzLmNlbGxWYWx1ZUNoYW5nZWQuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1tb3Zpbmctcm93c1wiLCB0aGlzLmNvbHVtbk1vdmluZy5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwidGFibGUtYnVpbHRcIiwgdGhpcy5pbml0aWFsaXplRWxlbWVudEZpZWxkLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1yZWRyYXdpbmdcIiwgdGhpcy50YWJsZVJlZHJhd2luZy5iaW5kKHRoaXMpKTtcblxuXHRcdFx0dGhpcy5yZWdpc3RlckRpc3BsYXlIYW5kbGVyKHRoaXMuZ2V0Um93cy5iaW5kKHRoaXMpLCAzMCk7XG5cdFx0fVxuXHR9XG5cblx0dGFibGVSZWRyYXdpbmcoZm9yY2Upe1xuXHRcdHZhciByb3dzO1xuXG5cdFx0aWYoZm9yY2Upe1xuXHRcdFx0cm93cyA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRSb3dzKCk7XG5cdFx0XHRcblx0XHRcdHJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdHRoaXMucmVpbml0aWFsaXplUm93Q2hpbGRyZW4ocm93KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdGluaXRpYWxpemVFbGVtZW50RmllbGQoKXtcblx0XHR2YXIgZmlyc3RDb2wgPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Rmlyc3RWaXNpYmxlQ29sdW1uKCk7XG5cblx0XHR0aGlzLmVsZW1lbnRGaWVsZCA9IHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZUVsZW1lbnRDb2x1bW4gfHwgKGZpcnN0Q29sID8gZmlyc3RDb2wuZmllbGQgOiBmYWxzZSk7XG5cdH1cblx0XG5cdGdldFJvd0NoaWxkcmVuKHJvdyl7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0VHJlZUNoaWxkcmVuKHJvdywgdHJ1ZSk7XG5cdH1cblxuXHRjb2x1bW5Nb3ZpbmcoKXtcblx0XHR2YXIgcm93cyA9IFtdO1xuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRyb3dzID0gcm93cy5jb25jYXQodGhpcy5nZXRUcmVlQ2hpbGRyZW4ocm93LCBmYWxzZSwgdHJ1ZSkpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHJvd3M7XG5cdH1cblxuXHRyb3dEYXRhQ2hhbmdlZChyb3csIHZpc2libGUsIHVwZGF0ZWREYXRhKXtcblx0XHRpZih0aGlzLnJlZHJhd05lZWRlZCh1cGRhdGVkRGF0YSkpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplUm93KHJvdyk7XG5cblx0XHRcdGlmKHZpc2libGUpe1xuXHRcdFx0XHR0aGlzLmxheW91dFJvdyhyb3cpO1xuXHRcdFx0XHR0aGlzLnJlZnJlc2hEYXRhKHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGNlbGxWYWx1ZUNoYW5nZWQoY2VsbCl7XG5cdFx0dmFyIGZpZWxkID0gY2VsbC5jb2x1bW4uZ2V0RmllbGQoKTtcblxuXHRcdGlmKGZpZWxkID09PSB0aGlzLmVsZW1lbnRGaWVsZCl7XG5cdFx0XHR0aGlzLmxheW91dFJvdyhjZWxsLnJvdyk7XG5cdFx0fVxuXHR9XG5cblx0aW5pdGlhbGl6ZVJvdyhyb3cpe1xuXHRcdHZhciBjaGlsZEFycmF5ID0gcm93LmdldERhdGEoKVt0aGlzLmZpZWxkXTtcblx0XHR2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoY2hpbGRBcnJheSk7XG5cblx0XHR2YXIgY2hpbGRyZW4gPSBpc0FycmF5IHx8ICghaXNBcnJheSAmJiB0eXBlb2YgY2hpbGRBcnJheSA9PT0gXCJvYmplY3RcIiAmJiBjaGlsZEFycmF5ICE9PSBudWxsKTtcblxuXHRcdGlmKCFjaGlsZHJlbiAmJiByb3cubW9kdWxlcy5kYXRhVHJlZSAmJiByb3cubW9kdWxlcy5kYXRhVHJlZS5icmFuY2hFbCl7XG5cdFx0XHRyb3cubW9kdWxlcy5kYXRhVHJlZS5icmFuY2hFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvdy5tb2R1bGVzLmRhdGFUcmVlLmJyYW5jaEVsKTtcblx0XHR9XG5cblx0XHRpZighY2hpbGRyZW4gJiYgcm93Lm1vZHVsZXMuZGF0YVRyZWUgJiYgcm93Lm1vZHVsZXMuZGF0YVRyZWUuY29udHJvbEVsKXtcblx0XHRcdHJvdy5tb2R1bGVzLmRhdGFUcmVlLmNvbnRyb2xFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvdy5tb2R1bGVzLmRhdGFUcmVlLmNvbnRyb2xFbCk7XG5cdFx0fVxuXG5cdFx0cm93Lm1vZHVsZXMuZGF0YVRyZWUgPSB7XG5cdFx0XHRpbmRleDogcm93Lm1vZHVsZXMuZGF0YVRyZWUgPyByb3cubW9kdWxlcy5kYXRhVHJlZS5pbmRleCA6IDAsXG5cdFx0XHRvcGVuOiBjaGlsZHJlbiA/IChyb3cubW9kdWxlcy5kYXRhVHJlZSA/IHJvdy5tb2R1bGVzLmRhdGFUcmVlLm9wZW4gOiB0aGlzLnN0YXJ0T3Blbihyb3cuZ2V0Q29tcG9uZW50KCksIDApKSA6IGZhbHNlLFxuXHRcdFx0Y29udHJvbEVsOiByb3cubW9kdWxlcy5kYXRhVHJlZSAmJiBjaGlsZHJlbiA/IHJvdy5tb2R1bGVzLmRhdGFUcmVlLmNvbnRyb2xFbCA6IGZhbHNlLFxuXHRcdFx0YnJhbmNoRWw6IHJvdy5tb2R1bGVzLmRhdGFUcmVlICYmIGNoaWxkcmVuID8gcm93Lm1vZHVsZXMuZGF0YVRyZWUuYnJhbmNoRWwgOiBmYWxzZSxcblx0XHRcdHBhcmVudDogcm93Lm1vZHVsZXMuZGF0YVRyZWUgPyByb3cubW9kdWxlcy5kYXRhVHJlZS5wYXJlbnQgOiBmYWxzZSxcblx0XHRcdGNoaWxkcmVuOmNoaWxkcmVuLFxuXHRcdH07XG5cdH1cblxuXHRyZWluaXRpYWxpemVSb3dDaGlsZHJlbihyb3cpe1xuXHRcdHZhciBjaGlsZHJlbiA9IHRoaXMuZ2V0VHJlZUNoaWxkcmVuKHJvdywgZmFsc2UsIHRydWUpO1xuXG5cdFx0Y2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihjaGlsZCl7XG5cdFx0XHRjaGlsZC5yZWluaXRpYWxpemUodHJ1ZSk7XG5cdFx0fSk7XG5cdH1cblxuXHRsYXlvdXRSb3cocm93KXtcblx0XHR2YXIgY2VsbCA9IHRoaXMuZWxlbWVudEZpZWxkID8gcm93LmdldENlbGwodGhpcy5lbGVtZW50RmllbGQpIDogcm93LmdldENlbGxzKClbMF0sXG5cdFx0ZWwgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0XHRjb25maWcgPSByb3cubW9kdWxlcy5kYXRhVHJlZTtcblxuXHRcdGlmKGNvbmZpZy5icmFuY2hFbCl7XG5cdFx0XHRpZihjb25maWcuYnJhbmNoRWwucGFyZW50Tm9kZSl7XG5cdFx0XHRcdGNvbmZpZy5icmFuY2hFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNvbmZpZy5icmFuY2hFbCk7XG5cdFx0XHR9XG5cdFx0XHRjb25maWcuYnJhbmNoRWwgPSBmYWxzZTtcblx0XHR9XG5cblx0XHRpZihjb25maWcuY29udHJvbEVsKXtcblx0XHRcdGlmKGNvbmZpZy5jb250cm9sRWwucGFyZW50Tm9kZSl7XG5cdFx0XHRcdGNvbmZpZy5jb250cm9sRWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjb25maWcuY29udHJvbEVsKTtcblx0XHRcdH1cblx0XHRcdGNvbmZpZy5jb250cm9sRWwgPSBmYWxzZTtcblx0XHR9XG5cblx0XHR0aGlzLmdlbmVyYXRlQ29udHJvbEVsZW1lbnQocm93LCBlbCk7XG5cblx0XHRyb3cuZ2V0RWxlbWVudCgpLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItdHJlZS1sZXZlbC1cIiArIGNvbmZpZy5pbmRleCk7XG5cblx0XHRpZihjb25maWcuaW5kZXgpe1xuXHRcdFx0aWYodGhpcy5icmFuY2hFbCl7XG5cdFx0XHRcdGNvbmZpZy5icmFuY2hFbCA9IHRoaXMuYnJhbmNoRWwuY2xvbmVOb2RlKHRydWUpO1xuXHRcdFx0XHRlbC5pbnNlcnRCZWZvcmUoY29uZmlnLmJyYW5jaEVsLCBlbC5maXJzdENoaWxkKTtcblxuXHRcdFx0XHRpZih0aGlzLnRhYmxlLnJ0bCl7XG5cdFx0XHRcdFx0Y29uZmlnLmJyYW5jaEVsLnN0eWxlLm1hcmdpblJpZ2h0ID0gKCgoY29uZmlnLmJyYW5jaEVsLm9mZnNldFdpZHRoICsgY29uZmlnLmJyYW5jaEVsLnN0eWxlLm1hcmdpbkxlZnQpICogKGNvbmZpZy5pbmRleCAtIDEpKSArIChjb25maWcuaW5kZXggKiB0aGlzLmluZGVudCkpICsgXCJweFwiO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0Y29uZmlnLmJyYW5jaEVsLnN0eWxlLm1hcmdpbkxlZnQgPSAoKChjb25maWcuYnJhbmNoRWwub2Zmc2V0V2lkdGggKyBjb25maWcuYnJhbmNoRWwuc3R5bGUubWFyZ2luUmlnaHQpICogKGNvbmZpZy5pbmRleCAtIDEpKSArIChjb25maWcuaW5kZXggKiB0aGlzLmluZGVudCkpICsgXCJweFwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cblx0XHRcdFx0aWYodGhpcy50YWJsZS5ydGwpe1xuXHRcdFx0XHRcdGVsLnN0eWxlLnBhZGRpbmdSaWdodCA9IHBhcnNlSW50KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLXJpZ2h0JykpICsgKGNvbmZpZy5pbmRleCAqIHRoaXMuaW5kZW50KSArIFwicHhcIjtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGVsLnN0eWxlLnBhZGRpbmdMZWZ0ID0gcGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwsIG51bGwpLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctbGVmdCcpKSArIChjb25maWcuaW5kZXggKiB0aGlzLmluZGVudCkgKyBcInB4XCI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRnZW5lcmF0ZUNvbnRyb2xFbGVtZW50KHJvdywgZWwpe1xuXHRcdHZhciBjb25maWcgPSByb3cubW9kdWxlcy5kYXRhVHJlZSxcblx0XHRvbGRDb250cm9sID0gY29uZmlnLmNvbnRyb2xFbDtcblxuXHRcdGVsID0gZWwgfHwgcm93LmdldENlbGxzKClbMF0uZ2V0RWxlbWVudCgpO1xuXG5cdFx0aWYoY29uZmlnLmNoaWxkcmVuICE9PSBmYWxzZSl7XG5cblx0XHRcdGlmKGNvbmZpZy5vcGVuKXtcblx0XHRcdFx0Y29uZmlnLmNvbnRyb2xFbCA9IHRoaXMuY29sbGFwc2VFbC5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0XHRcdGNvbmZpZy5jb250cm9sRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHR0aGlzLmNvbGxhcHNlUm93KHJvdyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25maWcuY29udHJvbEVsID0gdGhpcy5leHBhbmRFbC5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0XHRcdGNvbmZpZy5jb250cm9sRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHR0aGlzLmV4cGFuZFJvdyhyb3cpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0Y29uZmlnLmNvbnRyb2xFbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYob2xkQ29udHJvbCAmJiBvbGRDb250cm9sLnBhcmVudE5vZGUgPT09IGVsKXtcblx0XHRcdFx0b2xkQ29udHJvbC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChjb25maWcuY29udHJvbEVsLG9sZENvbnRyb2wpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRlbC5pbnNlcnRCZWZvcmUoY29uZmlnLmNvbnRyb2xFbCwgZWwuZmlyc3RDaGlsZCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Z2V0Um93cyhyb3dzKXtcblx0XHR2YXIgb3V0cHV0ID0gW107XG5cblx0XHRyb3dzLmZvckVhY2goKHJvdywgaSkgPT4ge1xuXHRcdFx0dmFyIGNvbmZpZywgY2hpbGRyZW47XG5cblx0XHRcdG91dHB1dC5wdXNoKHJvdyk7XG5cblx0XHRcdGlmKHJvdyBpbnN0YW5jZW9mIFJvdyl7XG5cblx0XHRcdFx0cm93LmNyZWF0ZSgpO1xuXG5cdFx0XHRcdGNvbmZpZyA9IHJvdy5tb2R1bGVzLmRhdGFUcmVlO1xuXG5cdFx0XHRcdGlmKCFjb25maWcuaW5kZXggJiYgY29uZmlnLmNoaWxkcmVuICE9PSBmYWxzZSl7XG5cdFx0XHRcdFx0Y2hpbGRyZW4gPSB0aGlzLmdldENoaWxkcmVuKHJvdywgZmFsc2UsIHRydWUpO1xuXG5cdFx0XHRcdFx0Y2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcblx0XHRcdFx0XHRcdGNoaWxkLmNyZWF0ZSgpO1xuXHRcdFx0XHRcdFx0b3V0cHV0LnB1c2goY2hpbGQpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cblx0Z2V0Q2hpbGRyZW4ocm93LCBhbGxDaGlsZHJlbiwgc29ydE9ubHkpe1xuXHRcdHZhciBjb25maWcgPSByb3cubW9kdWxlcy5kYXRhVHJlZSxcblx0XHRjaGlsZHJlbiA9IFtdLFxuXHRcdG91dHB1dCA9IFtdO1xuXG5cdFx0aWYoY29uZmlnLmNoaWxkcmVuICE9PSBmYWxzZSAmJiAoY29uZmlnLm9wZW4gfHwgYWxsQ2hpbGRyZW4pKXtcblx0XHRcdGlmKCFBcnJheS5pc0FycmF5KGNvbmZpZy5jaGlsZHJlbikpe1xuXHRcdFx0XHRjb25maWcuY2hpbGRyZW4gPSB0aGlzLmdlbmVyYXRlQ2hpbGRyZW4ocm93KTtcblx0XHRcdH1cblxuXHRcdFx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJmaWx0ZXJcIikgJiYgdGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlRmlsdGVyKXtcblx0XHRcdFx0Y2hpbGRyZW4gPSB0aGlzLnRhYmxlLm1vZHVsZXMuZmlsdGVyLmZpbHRlcihjb25maWcuY2hpbGRyZW4pO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjaGlsZHJlbiA9IGNvbmZpZy5jaGlsZHJlbjtcblx0XHRcdH1cblxuXHRcdFx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJzb3J0XCIpICYmIHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZVNvcnQpe1xuXHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuc29ydC5zb3J0KGNoaWxkcmVuLCBzb3J0T25seSk7XG5cdFx0XHR9XG5cblx0XHRcdGNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG5cdFx0XHRcdG91dHB1dC5wdXNoKGNoaWxkKTtcblxuXHRcdFx0XHR2YXIgc3ViQ2hpbGRyZW4gPSB0aGlzLmdldENoaWxkcmVuKGNoaWxkLCBmYWxzZSwgdHJ1ZSk7XG5cblx0XHRcdFx0c3ViQ2hpbGRyZW4uZm9yRWFjaCgoc3ViKSA9PiB7XG5cdFx0XHRcdFx0b3V0cHV0LnB1c2goc3ViKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cblx0Z2VuZXJhdGVDaGlsZHJlbihyb3cpe1xuXHRcdHZhciBjaGlsZHJlbiA9IFtdO1xuXG5cdFx0dmFyIGNoaWxkQXJyYXkgPSByb3cuZ2V0RGF0YSgpW3RoaXMuZmllbGRdO1xuXG5cdFx0aWYoIUFycmF5LmlzQXJyYXkoY2hpbGRBcnJheSkpe1xuXHRcdFx0Y2hpbGRBcnJheSA9IFtjaGlsZEFycmF5XTtcblx0XHR9XG5cblx0XHRjaGlsZEFycmF5LmZvckVhY2goKGNoaWxkRGF0YSkgPT4ge1xuXHRcdFx0dmFyIGNoaWxkUm93ID0gbmV3IFJvdyhjaGlsZERhdGEgfHwge30sIHRoaXMudGFibGUucm93TWFuYWdlcik7XG5cblx0XHRcdGNoaWxkUm93LmNyZWF0ZSgpO1xuXG5cdFx0XHRjaGlsZFJvdy5tb2R1bGVzLmRhdGFUcmVlLmluZGV4ID0gcm93Lm1vZHVsZXMuZGF0YVRyZWUuaW5kZXggKyAxO1xuXHRcdFx0Y2hpbGRSb3cubW9kdWxlcy5kYXRhVHJlZS5wYXJlbnQgPSByb3c7XG5cblx0XHRcdGlmKGNoaWxkUm93Lm1vZHVsZXMuZGF0YVRyZWUuY2hpbGRyZW4pe1xuXHRcdFx0XHRjaGlsZFJvdy5tb2R1bGVzLmRhdGFUcmVlLm9wZW4gPSB0aGlzLnN0YXJ0T3BlbihjaGlsZFJvdy5nZXRDb21wb25lbnQoKSwgY2hpbGRSb3cubW9kdWxlcy5kYXRhVHJlZS5pbmRleCk7XG5cdFx0XHR9XG5cdFx0XHRjaGlsZHJlbi5wdXNoKGNoaWxkUm93KTtcblx0XHR9KTtcblxuXHRcdHJldHVybiBjaGlsZHJlbjtcblx0fVxuXG5cdGV4cGFuZFJvdyhyb3csIHNpbGVudCl7XG5cdFx0dmFyIGNvbmZpZyA9IHJvdy5tb2R1bGVzLmRhdGFUcmVlO1xuXG5cdFx0aWYoY29uZmlnLmNoaWxkcmVuICE9PSBmYWxzZSl7XG5cdFx0XHRjb25maWcub3BlbiA9IHRydWU7XG5cblx0XHRcdHJvdy5yZWluaXRpYWxpemUoKTtcblxuXHRcdFx0dGhpcy5yZWZyZXNoRGF0YSh0cnVlKTtcblxuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiZGF0YVRyZWVSb3dFeHBhbmRlZFwiLCByb3cuZ2V0Q29tcG9uZW50KCksIHJvdy5tb2R1bGVzLmRhdGFUcmVlLmluZGV4KTtcblx0XHR9XG5cdH1cblxuXHRjb2xsYXBzZVJvdyhyb3cpe1xuXHRcdHZhciBjb25maWcgPSByb3cubW9kdWxlcy5kYXRhVHJlZTtcblxuXHRcdGlmKGNvbmZpZy5jaGlsZHJlbiAhPT0gZmFsc2Upe1xuXHRcdFx0Y29uZmlnLm9wZW4gPSBmYWxzZTtcblxuXHRcdFx0cm93LnJlaW5pdGlhbGl6ZSgpO1xuXG5cdFx0XHR0aGlzLnJlZnJlc2hEYXRhKHRydWUpO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhVHJlZVJvd0NvbGxhcHNlZFwiLCByb3cuZ2V0Q29tcG9uZW50KCksIHJvdy5tb2R1bGVzLmRhdGFUcmVlLmluZGV4KTtcblx0XHR9XG5cdH1cblxuXHR0b2dnbGVSb3cocm93KXtcblx0XHR2YXIgY29uZmlnID0gcm93Lm1vZHVsZXMuZGF0YVRyZWU7XG5cblx0XHRpZihjb25maWcuY2hpbGRyZW4gIT09IGZhbHNlKXtcblx0XHRcdGlmKGNvbmZpZy5vcGVuKXtcblx0XHRcdFx0dGhpcy5jb2xsYXBzZVJvdyhyb3cpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmV4cGFuZFJvdyhyb3cpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlzUm93RXhwYW5kZWQocm93KXtcblx0XHRyZXR1cm4gcm93Lm1vZHVsZXMuZGF0YVRyZWUub3Blbjtcblx0fVxuXG5cdGdldFRyZWVQYXJlbnQocm93KXtcblx0XHRyZXR1cm4gcm93Lm1vZHVsZXMuZGF0YVRyZWUucGFyZW50ID8gcm93Lm1vZHVsZXMuZGF0YVRyZWUucGFyZW50LmdldENvbXBvbmVudCgpIDogZmFsc2U7XG5cdH1cblxuXHRnZXRUcmVlUGFyZW50Um9vdChyb3cpe1xuXHRcdHJldHVybiByb3cubW9kdWxlcy5kYXRhVHJlZSAmJiByb3cubW9kdWxlcy5kYXRhVHJlZS5wYXJlbnQgPyB0aGlzLmdldFRyZWVQYXJlbnRSb290KHJvdy5tb2R1bGVzLmRhdGFUcmVlLnBhcmVudCkgOiByb3c7XG5cdH1cblxuXHRnZXRGaWx0ZXJlZFRyZWVDaGlsZHJlbihyb3cpe1xuXHRcdHZhciBjb25maWcgPSByb3cubW9kdWxlcy5kYXRhVHJlZSxcblx0XHRvdXRwdXQgPSBbXSwgY2hpbGRyZW47XG5cblx0XHRpZihjb25maWcuY2hpbGRyZW4pe1xuXG5cdFx0XHRpZighQXJyYXkuaXNBcnJheShjb25maWcuY2hpbGRyZW4pKXtcblx0XHRcdFx0Y29uZmlnLmNoaWxkcmVuID0gdGhpcy5nZW5lcmF0ZUNoaWxkcmVuKHJvdyk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZmlsdGVyXCIpICYmIHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZUZpbHRlcil7XG5cdFx0XHRcdGNoaWxkcmVuID0gdGhpcy50YWJsZS5tb2R1bGVzLmZpbHRlci5maWx0ZXIoY29uZmlnLmNoaWxkcmVuKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y2hpbGRyZW4gPSBjb25maWcuY2hpbGRyZW47XG5cdFx0XHR9XG5cblx0XHRcdGNoaWxkcmVuLmZvckVhY2goKGNoaWxkUm93KSA9PiB7XG5cdFx0XHRcdGlmKGNoaWxkUm93IGluc3RhbmNlb2YgUm93KXtcblx0XHRcdFx0XHRvdXRwdXQucHVzaChjaGlsZFJvdyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblxuXHRyb3dEZWxldGluZyhyb3cpe1xuXHRcdHZhciBjb25maWcgPSByb3cubW9kdWxlcy5kYXRhVHJlZTtcblxuXHRcdGlmIChjb25maWcgJiYgY29uZmlnLmNoaWxkcmVuICYmIEFycmF5LmlzQXJyYXkoY29uZmlnLmNoaWxkcmVuKSl7XG5cdFx0XHRjb25maWcuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGRSb3cpID0+IHtcblx0XHRcdFx0aWYoY2hpbGRSb3cgaW5zdGFuY2VvZiBSb3cpe1xuXHRcdFx0XHRcdGNoaWxkUm93LndpcGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cblx0cm93RGVsZXRlKHJvdyl7XG5cdFx0dmFyIHBhcmVudCA9IHJvdy5tb2R1bGVzLmRhdGFUcmVlLnBhcmVudCxcblx0XHRjaGlsZEluZGV4O1xuXG5cdFx0aWYocGFyZW50KXtcblx0XHRcdGNoaWxkSW5kZXggPSB0aGlzLmZpbmRDaGlsZEluZGV4KHJvdywgcGFyZW50KTtcblxuXHRcdFx0aWYoY2hpbGRJbmRleCAhPT0gZmFsc2Upe1xuXHRcdFx0XHRwYXJlbnQuZGF0YVt0aGlzLmZpZWxkXS5zcGxpY2UoY2hpbGRJbmRleCwgMSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKCFwYXJlbnQuZGF0YVt0aGlzLmZpZWxkXS5sZW5ndGgpe1xuXHRcdFx0XHRkZWxldGUgcGFyZW50LmRhdGFbdGhpcy5maWVsZF07XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuaW5pdGlhbGl6ZVJvdyhwYXJlbnQpO1xuXHRcdFx0dGhpcy5sYXlvdXRSb3cocGFyZW50KTtcblx0XHR9XG5cblx0XHR0aGlzLnJlZnJlc2hEYXRhKHRydWUpO1xuXHR9XG5cblx0YWRkVHJlZUNoaWxkUm93KHJvdywgZGF0YSwgdG9wLCBpbmRleCl7XG5cdFx0dmFyIGNoaWxkSW5kZXggPSBmYWxzZTtcblxuXHRcdGlmKHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiKXtcblx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdH1cblxuXHRcdGlmKCFBcnJheS5pc0FycmF5KHJvdy5kYXRhW3RoaXMuZmllbGRdKSl7XG5cdFx0XHRyb3cuZGF0YVt0aGlzLmZpZWxkXSA9IFtdO1xuXG5cdFx0XHRyb3cubW9kdWxlcy5kYXRhVHJlZS5vcGVuID0gdGhpcy5zdGFydE9wZW4ocm93LmdldENvbXBvbmVudCgpLCByb3cubW9kdWxlcy5kYXRhVHJlZS5pbmRleCk7XG5cdFx0fVxuXG5cdFx0aWYodHlwZW9mIGluZGV4ICE9PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdGNoaWxkSW5kZXggPSB0aGlzLmZpbmRDaGlsZEluZGV4KGluZGV4LCByb3cpO1xuXG5cdFx0XHRpZihjaGlsZEluZGV4ICE9PSBmYWxzZSl7XG5cdFx0XHRcdHJvdy5kYXRhW3RoaXMuZmllbGRdLnNwbGljZSgodG9wID8gY2hpbGRJbmRleCA6IGNoaWxkSW5kZXggKyAxKSwgMCwgZGF0YSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYoY2hpbGRJbmRleCA9PT0gZmFsc2Upe1xuXHRcdFx0aWYodG9wKXtcblx0XHRcdFx0cm93LmRhdGFbdGhpcy5maWVsZF0udW5zaGlmdChkYXRhKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0cm93LmRhdGFbdGhpcy5maWVsZF0ucHVzaChkYXRhKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLmluaXRpYWxpemVSb3cocm93KTtcblx0XHR0aGlzLmxheW91dFJvdyhyb3cpO1xuXG5cdFx0dGhpcy5yZWZyZXNoRGF0YSh0cnVlKTtcblx0fVxuXG5cdGZpbmRDaGlsZEluZGV4KHN1YmplY3QsIHBhcmVudCl7XG5cdFx0dmFyIG1hdGNoID0gZmFsc2U7XG5cblx0XHRpZih0eXBlb2Ygc3ViamVjdCA9PSBcIm9iamVjdFwiKXtcblxuXHRcdFx0aWYoc3ViamVjdCBpbnN0YW5jZW9mIFJvdyl7XG5cdFx0XHRcdC8vc3ViamVjdCBpcyByb3cgZWxlbWVudFxuXHRcdFx0XHRtYXRjaCA9IHN1YmplY3QuZGF0YTtcblx0XHRcdH1lbHNlIGlmKHN1YmplY3QgaW5zdGFuY2VvZiBSb3dDb21wb25lbnQpe1xuXHRcdFx0XHQvL3N1YmplY3QgaXMgcHVibGljIHJvdyBjb21wb25lbnRcblx0XHRcdFx0bWF0Y2ggPSBzdWJqZWN0Ll9nZXRTZWxmKCkuZGF0YTtcblx0XHRcdH1lbHNlIGlmKHR5cGVvZiBIVE1MRWxlbWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzdWJqZWN0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpe1xuXHRcdFx0XHRpZihwYXJlbnQubW9kdWxlcy5kYXRhVHJlZSl7XG5cdFx0XHRcdFx0bWF0Y2ggPSBwYXJlbnQubW9kdWxlcy5kYXRhVHJlZS5jaGlsZHJlbi5maW5kKChjaGlsZFJvdykgPT4ge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGNoaWxkUm93IGluc3RhbmNlb2YgUm93ID8gY2hpbGRSb3cuZWxlbWVudCA9PT0gc3ViamVjdCA6IGZhbHNlO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0aWYobWF0Y2gpe1xuXHRcdFx0XHRcdFx0bWF0Y2ggPSBtYXRjaC5kYXRhO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fWVsc2UgaWYoc3ViamVjdCA9PT0gbnVsbCl7XG5cdFx0XHRcdG1hdGNoID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHR9ZWxzZSBpZih0eXBlb2Ygc3ViamVjdCA9PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdG1hdGNoID0gZmFsc2U7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Ly9zdWJqZWN0IHNob3VsZCBiZSB0cmVhdGVkIGFzIHRoZSBpbmRleCBvZiB0aGUgcm93XG5cdFx0XHRtYXRjaCA9IHBhcmVudC5kYXRhW3RoaXMuZmllbGRdLmZpbmQoKHJvdykgPT4ge1xuXHRcdFx0XHRyZXR1cm4gcm93LmRhdGFbdGhpcy50YWJsZS5vcHRpb25zLmluZGV4XSA9PSBzdWJqZWN0O1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYobWF0Y2gpe1xuXG5cdFx0XHRpZihBcnJheS5pc0FycmF5KHBhcmVudC5kYXRhW3RoaXMuZmllbGRdKSl7XG5cdFx0XHRcdG1hdGNoID0gcGFyZW50LmRhdGFbdGhpcy5maWVsZF0uaW5kZXhPZihtYXRjaCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKG1hdGNoID09IC0xKXtcblx0XHRcdFx0bWF0Y2ggPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL2NhdGNoIGFsbCBmb3IgYW55IG90aGVyIHR5cGUgb2YgaW5wdXRcblxuXHRcdHJldHVybiBtYXRjaDtcblx0fVxuXG5cdGdldFRyZWVDaGlsZHJlbihyb3csIGNvbXBvbmVudCwgcmVjdXJzZSl7XG5cdFx0dmFyIGNvbmZpZyA9IHJvdy5tb2R1bGVzLmRhdGFUcmVlLFxuXHRcdG91dHB1dCA9IFtdO1xuXG5cdFx0aWYoY29uZmlnICYmIGNvbmZpZy5jaGlsZHJlbil7XG5cblx0XHRcdGlmKCFBcnJheS5pc0FycmF5KGNvbmZpZy5jaGlsZHJlbikpe1xuXHRcdFx0XHRjb25maWcuY2hpbGRyZW4gPSB0aGlzLmdlbmVyYXRlQ2hpbGRyZW4ocm93KTtcblx0XHRcdH1cblxuXHRcdFx0Y29uZmlnLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkUm93KSA9PiB7XG5cdFx0XHRcdGlmKGNoaWxkUm93IGluc3RhbmNlb2YgUm93KXtcblx0XHRcdFx0XHRvdXRwdXQucHVzaChjb21wb25lbnQgPyBjaGlsZFJvdy5nZXRDb21wb25lbnQoKSA6IGNoaWxkUm93KTtcblxuXHRcdFx0XHRcdGlmKHJlY3Vyc2Upe1xuXHRcdFx0XHRcdFx0dGhpcy5nZXRUcmVlQ2hpbGRyZW4oY2hpbGRSb3csIGNvbXBvbmVudCwgcmVjdXJzZSkuZm9yRWFjaChjaGlsZCA9PiB7XG5cdFx0XHRcdFx0XHRcdG91dHB1dC5wdXNoKGNoaWxkKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXG5cdGdldENoaWxkRmllbGQoKXtcblx0XHRyZXR1cm4gdGhpcy5maWVsZDtcblx0fVxuXG5cdHJlZHJhd05lZWRlZChkYXRhKXtcblx0XHRyZXR1cm4gKHRoaXMuZmllbGQgPyB0eXBlb2YgZGF0YVt0aGlzLmZpZWxkXSAhPT0gXCJ1bmRlZmluZWRcIiA6IGZhbHNlKSB8fCAodGhpcy5lbGVtZW50RmllbGQgPyB0eXBlb2YgZGF0YVt0aGlzLmVsZW1lbnRGaWVsZF0gIT09IFwidW5kZWZpbmVkXCIgOiBmYWxzZSk7XG5cdH1cbn1cblxuZnVuY3Rpb24gY3N2JDEobGlzdCwgb3B0aW9ucyA9IHt9LCBzZXRGaWxlQ29udGVudHMpe1xuXHR2YXIgZGVsaW1pdGVyID0gb3B0aW9ucy5kZWxpbWl0ZXIgPyBvcHRpb25zLmRlbGltaXRlciA6IFwiLFwiLFxuXHRmaWxlQ29udGVudHMgPSBbXSxcblx0aGVhZGVycyA9IFtdO1xuXG5cdGxpc3QuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0dmFyIGl0ZW0gPSBbXTtcblxuXHRcdHN3aXRjaChyb3cudHlwZSl7XG5cdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiRG93bmxvYWQgV2FybmluZyAtIENTViBkb3dubG9hZGVyIGNhbm5vdCBwcm9jZXNzIHJvdyBncm91cHNcIik7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwiY2FsY1wiOlxuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJEb3dubG9hZCBXYXJuaW5nIC0gQ1NWIGRvd25sb2FkZXIgY2Fubm90IHByb2Nlc3MgY29sdW1uIGNhbGN1bGF0aW9uc1wiKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJoZWFkZXJcIjpcblx0XHRcdFx0cm93LmNvbHVtbnMuZm9yRWFjaCgoY29sLCBpKSA9PiB7XG5cdFx0XHRcdFx0aWYoY29sICYmIGNvbC5kZXB0aCA9PT0gMSl7XG5cdFx0XHRcdFx0XHRoZWFkZXJzW2ldID0gdHlwZW9mIGNvbC52YWx1ZSA9PSBcInVuZGVmaW5lZFwiICB8fCBjb2wudmFsdWUgPT09IG51bGwgPyBcIlwiIDogKCdcIicgKyBTdHJpbmcoY29sLnZhbHVlKS5zcGxpdCgnXCInKS5qb2luKCdcIlwiJykgKyAnXCInKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcInJvd1wiOlxuXHRcdFx0XHRyb3cuY29sdW1ucy5mb3JFYWNoKChjb2wpID0+IHtcblxuXHRcdFx0XHRcdGlmKGNvbCl7XG5cblx0XHRcdFx0XHRcdHN3aXRjaCh0eXBlb2YgY29sLnZhbHVlKXtcblx0XHRcdFx0XHRcdFx0Y2FzZSBcIm9iamVjdFwiOlxuXHRcdFx0XHRcdFx0XHRcdGNvbC52YWx1ZSA9IGNvbC52YWx1ZSAhPT0gbnVsbCA/IEpTT04uc3RyaW5naWZ5KGNvbC52YWx1ZSkgOiBcIlwiO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0XHRcdFx0XHRjb2wudmFsdWUgPSBcIlwiO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpdGVtLnB1c2goJ1wiJyArIFN0cmluZyhjb2wudmFsdWUpLnNwbGl0KCdcIicpLmpvaW4oJ1wiXCInKSArICdcIicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0ZmlsZUNvbnRlbnRzLnB1c2goaXRlbS5qb2luKGRlbGltaXRlcikpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH0pO1xuXG5cdGlmKGhlYWRlcnMubGVuZ3RoKXtcblx0XHRmaWxlQ29udGVudHMudW5zaGlmdChoZWFkZXJzLmpvaW4oZGVsaW1pdGVyKSk7XG5cdH1cblxuXHRmaWxlQ29udGVudHMgPSBmaWxlQ29udGVudHMuam9pbihcIlxcblwiKTtcblxuXHRpZihvcHRpb25zLmJvbSl7XG5cdFx0ZmlsZUNvbnRlbnRzID0gXCJcXHVmZWZmXCIgKyBmaWxlQ29udGVudHM7XG5cdH1cblxuXHRzZXRGaWxlQ29udGVudHMoZmlsZUNvbnRlbnRzLCBcInRleHQvY3N2XCIpO1xufVxuXG5mdW5jdGlvbiBqc29uJDIobGlzdCwgb3B0aW9ucywgc2V0RmlsZUNvbnRlbnRzKXtcblx0dmFyIGZpbGVDb250ZW50cyA9IFtdO1xuXG5cdGxpc3QuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0dmFyIGl0ZW0gPSB7fTtcblxuXHRcdHN3aXRjaChyb3cudHlwZSl7XG5cdFx0XHRjYXNlIFwiaGVhZGVyXCI6XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiRG93bmxvYWQgV2FybmluZyAtIEpTT04gZG93bmxvYWRlciBjYW5ub3QgcHJvY2VzcyByb3cgZ3JvdXBzXCIpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImNhbGNcIjpcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiRG93bmxvYWQgV2FybmluZyAtIEpTT04gZG93bmxvYWRlciBjYW5ub3QgcHJvY2VzcyBjb2x1bW4gY2FsY3VsYXRpb25zXCIpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcInJvd1wiOlxuXHRcdFx0XHRyb3cuY29sdW1ucy5mb3JFYWNoKChjb2wpID0+IHtcblx0XHRcdFx0XHRpZihjb2wpe1xuXHRcdFx0XHRcdFx0aXRlbVtjb2wuY29tcG9uZW50LmdldFRpdGxlRG93bmxvYWQoKSB8fCBjb2wuY29tcG9uZW50LmdldEZpZWxkKCldID0gY29sLnZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0ZmlsZUNvbnRlbnRzLnB1c2goaXRlbSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSk7XG5cblx0ZmlsZUNvbnRlbnRzID0gSlNPTi5zdHJpbmdpZnkoZmlsZUNvbnRlbnRzLCBudWxsLCAnXFx0Jyk7XG5cblx0c2V0RmlsZUNvbnRlbnRzKGZpbGVDb250ZW50cywgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xufVxuXG5mdW5jdGlvbiBwZGYobGlzdCwgb3B0aW9ucyA9IHt9LCBzZXRGaWxlQ29udGVudHMpe1xuXHR2YXIgaGVhZGVyID0gW10sXG5cdGJvZHkgPSBbXSxcblx0YXV0b1RhYmxlUGFyYW1zID0ge30sXG5cdHJvd0dyb3VwU3R5bGVzID0gb3B0aW9ucy5yb3dHcm91cFN0eWxlcyB8fCB7XG5cdFx0Zm9udFN0eWxlOiBcImJvbGRcIixcblx0XHRmb250U2l6ZTogMTIsXG5cdFx0Y2VsbFBhZGRpbmc6IDYsXG5cdFx0ZmlsbENvbG9yOiAyMjAsXG5cdH0sXG5cdHJvd0NhbGNTdHlsZXMgPSBvcHRpb25zLnJvd0NhbGNTdHlsZXMgfHwge1xuXHRcdGZvbnRTdHlsZTogXCJib2xkXCIsXG5cdFx0Zm9udFNpemU6IDEwLFxuXHRcdGNlbGxQYWRkaW5nOiA0LFxuXHRcdGZpbGxDb2xvcjogMjMyLFxuXHR9LFxuXHRqc1BERlBhcmFtcyA9IG9wdGlvbnMuanNQREYgfHwge30sXG5cdHRpdGxlID0gb3B0aW9ucy50aXRsZSA/IG9wdGlvbnMudGl0bGUgOiBcIlwiLFxuXHRqc3BkZkxpYiwgZG9jO1xuXG5cdGlmKCFqc1BERlBhcmFtcy5vcmllbnRhdGlvbil7XG5cdFx0anNQREZQYXJhbXMub3JpZW50YXRpb24gPSBvcHRpb25zLm9yaWVudGF0aW9uIHx8IFwibGFuZHNjYXBlXCI7XG5cdH1cblxuXHRpZighanNQREZQYXJhbXMudW5pdCl7XG5cdFx0anNQREZQYXJhbXMudW5pdCA9IFwicHRcIjtcblx0fVxuXG5cdC8vcGFyc2Ugcm93IGxpc3Rcblx0bGlzdC5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRzd2l0Y2gocm93LnR5cGUpe1xuXHRcdFx0Y2FzZSBcImhlYWRlclwiOlxuXHRcdFx0XHRoZWFkZXIucHVzaChwYXJzZVJvdyhyb3cpKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJncm91cFwiOlxuXHRcdFx0XHRib2R5LnB1c2gocGFyc2VSb3cocm93LCByb3dHcm91cFN0eWxlcykpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImNhbGNcIjpcblx0XHRcdFx0Ym9keS5wdXNoKHBhcnNlUm93KHJvdywgcm93Q2FsY1N0eWxlcykpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcInJvd1wiOlxuXHRcdFx0XHRib2R5LnB1c2gocGFyc2VSb3cocm93KSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSk7XG5cblx0ZnVuY3Rpb24gcGFyc2VSb3cocm93LCBzdHlsZXMpe1xuXHRcdHZhciByb3dEYXRhID0gW107XG5cblx0XHRyb3cuY29sdW1ucy5mb3JFYWNoKChjb2wpID0+e1xuXHRcdFx0dmFyIGNlbGw7XG5cblx0XHRcdGlmKGNvbCl7XG5cdFx0XHRcdHN3aXRjaCh0eXBlb2YgY29sLnZhbHVlKXtcblx0XHRcdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdFx0XHRjb2wudmFsdWUgPSBjb2wudmFsdWUgIT09IG51bGwgPyBKU09OLnN0cmluZ2lmeShjb2wudmFsdWUpIDogXCJcIjtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRcdFx0Y29sLnZhbHVlID0gXCJcIjtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y2VsbCA9IHtcblx0XHRcdFx0XHRjb250ZW50OmNvbC52YWx1ZSxcblx0XHRcdFx0XHRjb2xTcGFuOmNvbC53aWR0aCxcblx0XHRcdFx0XHRyb3dTcGFuOmNvbC5oZWlnaHQsXG5cdFx0XHRcdH07XG5cblx0XHRcdFx0aWYoc3R5bGVzKXtcblx0XHRcdFx0XHRjZWxsLnN0eWxlcyA9IHN0eWxlcztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJvd0RhdGEucHVzaChjZWxsKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiByb3dEYXRhO1xuXHR9XG5cblxuXHQvL2NvbmZpZ3VyZSBQREZcblx0anNwZGZMaWIgPSB0aGlzLmRlcGVuZGVuY3lSZWdpc3RyeS5sb29rdXAoXCJqc3BkZlwiLCBcImpzUERGXCIpO1xuXHRkb2MgPSBuZXcganNwZGZMaWIoanNQREZQYXJhbXMpOyAvL3NldCBkb2N1bWVudCB0byBsYW5kc2NhcGUsIGJldHRlciBmb3IgbW9zdCB0YWJsZXNcblxuXHRpZihvcHRpb25zLmF1dG9UYWJsZSl7XG5cdFx0aWYodHlwZW9mIG9wdGlvbnMuYXV0b1RhYmxlID09PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0YXV0b1RhYmxlUGFyYW1zID0gb3B0aW9ucy5hdXRvVGFibGUoZG9jKSB8fCB7fTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRhdXRvVGFibGVQYXJhbXMgPSBvcHRpb25zLmF1dG9UYWJsZTtcblx0XHR9XG5cdH1cblxuXHRpZih0aXRsZSl7XG5cdFx0YXV0b1RhYmxlUGFyYW1zLmRpZERyYXdQYWdlID0gZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0ZG9jLnRleHQodGl0bGUsIDQwLCAzMCk7XG5cdFx0fTtcblx0fVxuXG5cdGF1dG9UYWJsZVBhcmFtcy5oZWFkID0gaGVhZGVyO1xuXHRhdXRvVGFibGVQYXJhbXMuYm9keSA9IGJvZHk7XG5cblx0ZG9jLmF1dG9UYWJsZShhdXRvVGFibGVQYXJhbXMpO1xuXG5cdGlmKG9wdGlvbnMuZG9jdW1lbnRQcm9jZXNzaW5nKXtcblx0XHRvcHRpb25zLmRvY3VtZW50UHJvY2Vzc2luZyhkb2MpO1xuXHR9XG5cblx0c2V0RmlsZUNvbnRlbnRzKGRvYy5vdXRwdXQoXCJhcnJheWJ1ZmZlclwiKSwgXCJhcHBsaWNhdGlvbi9wZGZcIik7XG59XG5cbmZ1bmN0aW9uIHhsc3gkMShsaXN0LCBvcHRpb25zLCBzZXRGaWxlQ29udGVudHMpe1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdHNoZWV0TmFtZSA9IG9wdGlvbnMuc2hlZXROYW1lIHx8IFwiU2hlZXQxXCIsXG5cdFhMU1hMaWIgPSB0aGlzLmRlcGVuZGVuY3lSZWdpc3RyeS5sb29rdXAoXCJYTFNYXCIpLFxuXHR3b3JrYm9vayA9IFhMU1hMaWIudXRpbHMuYm9va19uZXcoKSxcblx0dGFibGVGZWF0dXJlcyA9IG5ldyBDb3JlRmVhdHVyZSh0aGlzKSxcblx0Y29tcHJlc3Npb24gPSAgJ2NvbXByZXNzJyBpbiBvcHRpb25zID8gb3B0aW9ucy5jb21wcmVzcyA6IHRydWUsXG5cdHdyaXRlT3B0aW9ucyA9IG9wdGlvbnMud3JpdGVPcHRpb25zIHx8IHtib29rVHlwZToneGxzeCcsIGJvb2tTU1Q6dHJ1ZSwgY29tcHJlc3Npb259LFxuXHRvdXRwdXQ7XG5cblx0d3JpdGVPcHRpb25zLnR5cGUgPSAnYmluYXJ5JztcblxuXHR3b3JrYm9vay5TaGVldE5hbWVzID0gW107XG5cdHdvcmtib29rLlNoZWV0cyA9IHt9O1xuXG5cdGZ1bmN0aW9uIGdlbmVyYXRlU2hlZXQoKXtcblx0XHR2YXIgcm93cyA9IFtdLFxuXHRcdG1lcmdlcyA9IFtdLFxuXHRcdHdvcmtzaGVldCA9IHt9LFxuXHRcdHJhbmdlID0ge3M6IHtjOjAsIHI6MH0sIGU6IHtjOihsaXN0WzBdID8gbGlzdFswXS5jb2x1bW5zLnJlZHVjZSgoYSwgYikgPT4gYSArIChiICYmIGIud2lkdGggPyBiLndpZHRoIDogMSksIDApIDogMCksIHI6bGlzdC5sZW5ndGggfX07XG5cblx0XHQvL3BhcnNlIHJvdyBsaXN0XG5cdFx0bGlzdC5mb3JFYWNoKChyb3csIGkpID0+IHtcblx0XHRcdHZhciByb3dEYXRhID0gW107XG5cblx0XHRcdHJvdy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24oY29sLCBqKXtcblxuXHRcdFx0XHRpZihjb2wpe1xuXHRcdFx0XHRcdHJvd0RhdGEucHVzaCghKGNvbC52YWx1ZSBpbnN0YW5jZW9mIERhdGUpICYmIHR5cGVvZiBjb2wudmFsdWUgPT09IFwib2JqZWN0XCIgPyBKU09OLnN0cmluZ2lmeShjb2wudmFsdWUpIDogY29sLnZhbHVlKTtcblxuXHRcdFx0XHRcdGlmKGNvbC53aWR0aCA+IDEgfHwgY29sLmhlaWdodCA+IC0xKXtcblx0XHRcdFx0XHRcdGlmKGNvbC5oZWlnaHQgPiAxIHx8IGNvbC53aWR0aCA+IDEpe1xuXHRcdFx0XHRcdFx0XHRtZXJnZXMucHVzaCh7czp7cjppLGM6an0sZTp7cjppICsgY29sLmhlaWdodCAtIDEsYzpqICsgY29sLndpZHRoIC0gMX19KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRyb3dEYXRhLnB1c2goXCJcIik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRyb3dzLnB1c2gocm93RGF0YSk7XG5cdFx0fSk7XG5cblx0XHQvL2NvbnZlcnQgcm93cyB0byB3b3Jrc2hlZXRcblx0XHRYTFNYTGliLnV0aWxzLnNoZWV0X2FkZF9hb2Eod29ya3NoZWV0LCByb3dzKTtcblxuXHRcdHdvcmtzaGVldFsnIXJlZiddID0gWExTWExpYi51dGlscy5lbmNvZGVfcmFuZ2UocmFuZ2UpO1xuXG5cdFx0aWYobWVyZ2VzLmxlbmd0aCl7XG5cdFx0XHR3b3Jrc2hlZXRbXCIhbWVyZ2VzXCJdID0gbWVyZ2VzO1xuXHRcdH1cblxuXHRcdHJldHVybiB3b3Jrc2hlZXQ7XG5cdH1cblxuXHRpZihvcHRpb25zLnNoZWV0T25seSl7XG5cdFx0c2V0RmlsZUNvbnRlbnRzKGdlbmVyYXRlU2hlZXQoKSk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0aWYob3B0aW9ucy5zaGVldHMpe1xuXHRcdGZvcih2YXIgc2hlZXQgaW4gb3B0aW9ucy5zaGVldHMpe1xuXG5cdFx0XHRpZihvcHRpb25zLnNoZWV0c1tzaGVldF0gPT09IHRydWUpe1xuXHRcdFx0XHR3b3JrYm9vay5TaGVldE5hbWVzLnB1c2goc2hlZXQpO1xuXHRcdFx0XHR3b3JrYm9vay5TaGVldHNbc2hlZXRdID0gZ2VuZXJhdGVTaGVldCgpO1xuXHRcdFx0fWVsc2Uge1xuXG5cdFx0XHRcdHdvcmtib29rLlNoZWV0TmFtZXMucHVzaChzaGVldCk7XG5cblx0XHRcdFx0dGFibGVGZWF0dXJlcy5jb21tc1NlbmQob3B0aW9ucy5zaGVldHNbc2hlZXRdLCBcImRvd25sb2FkXCIsIFwiaW50ZXJjZXB0XCIse1xuXHRcdFx0XHRcdHR5cGU6XCJ4bHN4XCIsXG5cdFx0XHRcdFx0b3B0aW9uczp7c2hlZXRPbmx5OnRydWV9LFxuXHRcdFx0XHRcdGFjdGl2ZTpzZWxmLmFjdGl2ZSxcblx0XHRcdFx0XHRpbnRlcmNlcHQ6ZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHRcdFx0XHR3b3JrYm9vay5TaGVldHNbc2hlZXRdID0gZGF0YTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fWVsc2Uge1xuXHRcdHdvcmtib29rLlNoZWV0TmFtZXMucHVzaChzaGVldE5hbWUpO1xuXHRcdHdvcmtib29rLlNoZWV0c1tzaGVldE5hbWVdID0gZ2VuZXJhdGVTaGVldCgpO1xuXHR9XG5cblx0aWYob3B0aW9ucy5kb2N1bWVudFByb2Nlc3Npbmcpe1xuXHRcdHdvcmtib29rID0gb3B0aW9ucy5kb2N1bWVudFByb2Nlc3Npbmcod29ya2Jvb2spO1xuXHR9XG5cblx0Ly9jb252ZXJ0IHdvcmtib29rIHRvIGJpbmFyeSBhcnJheVxuXHRmdW5jdGlvbiBzMmFiKHMpIHtcblx0XHR2YXIgYnVmID0gbmV3IEFycmF5QnVmZmVyKHMubGVuZ3RoKTtcblx0XHR2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zik7XG5cdFx0Zm9yICh2YXIgaT0wOyBpIT1zLmxlbmd0aDsgKytpKSB2aWV3W2ldID0gcy5jaGFyQ29kZUF0KGkpICYgMHhGRjtcblx0XHRyZXR1cm4gYnVmO1xuXHR9XG5cblx0b3V0cHV0ID0gWExTWExpYi53cml0ZSh3b3JrYm9vaywgd3JpdGVPcHRpb25zKTtcblxuXHRzZXRGaWxlQ29udGVudHMoczJhYihvdXRwdXQpLCBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiKTtcbn1cblxuZnVuY3Rpb24gaHRtbCQxKGxpc3QsIG9wdGlvbnMsIHNldEZpbGVDb250ZW50cyl7XG5cdGlmKHRoaXMubW9kRXhpc3RzKFwiZXhwb3J0XCIsIHRydWUpKXtcblx0XHRzZXRGaWxlQ29udGVudHModGhpcy5tb2R1bGVzLmV4cG9ydC5nZW5lcmF0ZUhUTUxUYWJsZShsaXN0KSwgXCJ0ZXh0L2h0bWxcIik7XG5cdH1cbn1cblxuZnVuY3Rpb24ganNvbkxpbmVzIChsaXN0LCBvcHRpb25zLCBzZXRGaWxlQ29udGVudHMpIHtcblx0Y29uc3QgZmlsZUNvbnRlbnRzID0gW107XG5cblx0bGlzdC5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRjb25zdCBpdGVtID0ge307XG5cblx0XHRzd2l0Y2ggKHJvdy50eXBlKSB7XG5cdFx0XHRjYXNlIFwiaGVhZGVyXCI6XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiRG93bmxvYWQgV2FybmluZyAtIEpTT04gZG93bmxvYWRlciBjYW5ub3QgcHJvY2VzcyByb3cgZ3JvdXBzXCIpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImNhbGNcIjpcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiRG93bmxvYWQgV2FybmluZyAtIEpTT04gZG93bmxvYWRlciBjYW5ub3QgcHJvY2VzcyBjb2x1bW4gY2FsY3VsYXRpb25zXCIpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcInJvd1wiOlxuXHRcdFx0XHRyb3cuY29sdW1ucy5mb3JFYWNoKChjb2wpID0+IHtcblx0XHRcdFx0XHRpZiAoY29sKSB7XG5cdFx0XHRcdFx0XHRpdGVtW2NvbC5jb21wb25lbnQuZ2V0VGl0bGVEb3dubG9hZCgpIHx8IGNvbC5jb21wb25lbnQuZ2V0RmllbGQoKV0gPSBjb2wudmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRmaWxlQ29udGVudHMucHVzaChKU09OLnN0cmluZ2lmeShpdGVtKSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSk7XG5cblx0c2V0RmlsZUNvbnRlbnRzKGZpbGVDb250ZW50cy5qb2luKFwiXFxuXCIpLCBcImFwcGxpY2F0aW9uL3gtbmRqc29uXCIpO1xufVxuXG52YXIgZGVmYXVsdERvd25sb2FkZXJzID0ge1xuXHRjc3Y6Y3N2JDEsXG5cdGpzb246anNvbiQyLFxuXHRqc29uTGluZXM6anNvbkxpbmVzLFxuXHRwZGY6cGRmLFxuXHR4bHN4Onhsc3gkMSxcblx0aHRtbDpodG1sJDEsXG59O1xuXG5jbGFzcyBEb3dubG9hZCBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwiZG93bmxvYWRcIjtcblxuXHQvL2xvYWQgZGVmYXVsdHNcblx0c3RhdGljIGRvd25sb2FkZXJzID0gZGVmYXVsdERvd25sb2FkZXJzO1xuXG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJkb3dubG9hZEVuY29kZXJcIiwgZnVuY3Rpb24oZGF0YSwgbWltZVR5cGUpe1xuXHRcdFx0cmV0dXJuIG5ldyBCbG9iKFtkYXRhXSx7dHlwZTptaW1lVHlwZX0pO1xuXHRcdH0pOyAvL2Z1bmN0aW9uIHRvIG1hbmlwdWxhdGUgZG93bmxvYWQgZGF0YVxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImRvd25sb2FkQ29uZmlnXCIsIHt9KTsgLy9kb3dubG9hZCBjb25maWdcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJkb3dubG9hZFJvd1JhbmdlXCIsIFwiYWN0aXZlXCIpOyAvL3Jlc3RyaWN0IGRvd25sb2FkIHRvIGFjdGl2ZSByb3dzIG9ubHlcblxuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJkb3dubG9hZFwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwidGl0bGVEb3dubG9hZFwiKTtcblx0fVxuXG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLmRlcHJlY2F0ZWRPcHRpb25zQ2hlY2soKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZG93bmxvYWRcIiwgdGhpcy5kb3dubG9hZC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImRvd25sb2FkVG9UYWJcIiwgdGhpcy5kb3dubG9hZFRvVGFiLmJpbmQodGhpcykpO1xuXHR9XG5cblx0ZGVwcmVjYXRlZE9wdGlvbnNDaGVjaygpe1xuXG5cdH1cdFxuXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBUYWJsZSBGdW5jdGlvbnMgLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblx0ZG93bmxvYWRUb1RhYih0eXBlLCBmaWxlbmFtZSwgb3B0aW9ucywgYWN0aXZlKXtcblx0XHR0aGlzLmRvd25sb2FkKHR5cGUsIGZpbGVuYW1lLCBvcHRpb25zLCBhY3RpdmUsIHRydWUpO1xuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIEludGVybmFsIExvZ2ljIC8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXHQvL3RyaWdnZXIgZmlsZSBkb3dubG9hZFxuXHRkb3dubG9hZCh0eXBlLCBmaWxlbmFtZSwgb3B0aW9ucywgcmFuZ2UsIGludGVyY2VwdENhbGxiYWNrKXtcblx0XHR2YXIgZG93bmxvYWRGdW5jID0gZmFsc2U7XG5cblx0XHRmdW5jdGlvbiBidWlsZExpbmsoZGF0YSwgbWltZSl7XG5cdFx0XHRpZihpbnRlcmNlcHRDYWxsYmFjayl7XG5cdFx0XHRcdGlmKGludGVyY2VwdENhbGxiYWNrID09PSB0cnVlKXtcblx0XHRcdFx0XHR0aGlzLnRyaWdnZXJEb3dubG9hZChkYXRhLCBtaW1lLCB0eXBlLCBmaWxlbmFtZSwgdHJ1ZSk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRpbnRlcmNlcHRDYWxsYmFjayhkYXRhKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMudHJpZ2dlckRvd25sb2FkKGRhdGEsIG1pbWUsIHR5cGUsIGZpbGVuYW1lKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZih0eXBlb2YgdHlwZSA9PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0ZG93bmxvYWRGdW5jID0gdHlwZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZihEb3dubG9hZC5kb3dubG9hZGVyc1t0eXBlXSl7XG5cdFx0XHRcdGRvd25sb2FkRnVuYyA9IERvd25sb2FkLmRvd25sb2FkZXJzW3R5cGVdO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJEb3dubG9hZCBFcnJvciAtIE5vIHN1Y2ggZG93bmxvYWQgdHlwZSBmb3VuZDogXCIsIHR5cGUpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmKGRvd25sb2FkRnVuYyl7XG5cdFx0XHR2YXIgbGlzdCA9IHRoaXMuZ2VuZXJhdGVFeHBvcnRMaXN0KHJhbmdlKTtcblxuXHRcdFx0ZG93bmxvYWRGdW5jLmNhbGwodGhpcy50YWJsZSwgbGlzdCAsIG9wdGlvbnMgfHwge30sIGJ1aWxkTGluay5iaW5kKHRoaXMpKTtcblx0XHR9XG5cdH1cblxuXHRnZW5lcmF0ZUV4cG9ydExpc3QocmFuZ2Upe1xuXHRcdHZhciBsaXN0ID0gdGhpcy50YWJsZS5tb2R1bGVzLmV4cG9ydC5nZW5lcmF0ZUV4cG9ydExpc3QodGhpcy50YWJsZS5vcHRpb25zLmRvd25sb2FkQ29uZmlnLCBmYWxzZSwgcmFuZ2UgfHwgdGhpcy50YWJsZS5vcHRpb25zLmRvd25sb2FkUm93UmFuZ2UsIFwiZG93bmxvYWRcIik7XG5cblx0XHQvL2Fzc2lnbiBncm91cCBoZWFkZXIgZm9ybWF0dGVyXG5cdFx0dmFyIGdyb3VwSGVhZGVyID0gdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwSGVhZGVyRG93bmxvYWQ7XG5cblx0XHRpZihncm91cEhlYWRlciAmJiAhQXJyYXkuaXNBcnJheShncm91cEhlYWRlcikpe1xuXHRcdFx0Z3JvdXBIZWFkZXIgPSBbZ3JvdXBIZWFkZXJdO1xuXHRcdH1cblxuXHRcdGxpc3QuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHR2YXIgZ3JvdXA7XG5cblx0XHRcdGlmKHJvdy50eXBlID09PSBcImdyb3VwXCIpe1xuXHRcdFx0XHRncm91cCA9IHJvdy5jb2x1bW5zWzBdO1xuXG5cdFx0XHRcdGlmKGdyb3VwSGVhZGVyICYmIGdyb3VwSGVhZGVyW3Jvdy5pbmRlbnRdKXtcblx0XHRcdFx0XHRncm91cC52YWx1ZSA9IGdyb3VwSGVhZGVyW3Jvdy5pbmRlbnRdKGdyb3VwLnZhbHVlLCByb3cuY29tcG9uZW50Ll9ncm91cC5nZXRSb3dDb3VudCgpLCByb3cuY29tcG9uZW50Ll9ncm91cC5nZXREYXRhKCksIHJvdy5jb21wb25lbnQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gbGlzdDtcblx0fVxuXG5cdHRyaWdnZXJEb3dubG9hZChkYXRhLCBtaW1lLCB0eXBlLCBmaWxlbmFtZSwgbmV3VGFiKXtcblx0XHR2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSxcblx0XHRibG9iID0gdGhpcy50YWJsZS5vcHRpb25zLmRvd25sb2FkRW5jb2RlcihkYXRhLCBtaW1lKTtcblxuXHRcdGlmKGJsb2Ipe1xuXHRcdFx0aWYobmV3VGFiKXtcblx0XHRcdFx0d2luZG93Lm9wZW4od2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYikpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRmaWxlbmFtZSA9IGZpbGVuYW1lIHx8IFwiVGFidWxhdG9yLlwiICsgKHR5cGVvZiB0eXBlID09PSBcImZ1bmN0aW9uXCIgPyBcInR4dFwiIDogdHlwZSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYil7XG5cdFx0XHRcdFx0bmF2aWdhdG9yLm1zU2F2ZU9yT3BlbkJsb2IoYmxvYiwgZmlsZW5hbWUpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKSk7XG5cblx0XHRcdFx0XHQvL3NldCBmaWxlIHRpdGxlXG5cdFx0XHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZW5hbWUpO1xuXG5cdFx0XHRcdFx0Ly90cmlnZ2VyIGRvd25sb2FkXG5cdFx0XHRcdFx0ZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG5cdFx0XHRcdFx0ZWxlbWVudC5jbGljaygpO1xuXG5cdFx0XHRcdFx0Ly9yZW1vdmUgdGVtcG9yYXJ5IGxpbmsgZWxlbWVudFxuXHRcdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiZG93bmxvYWRDb21wbGV0ZVwiKTtcblx0XHR9XG5cdH1cblxuXHRjb21tc1JlY2VpdmVkKHRhYmxlLCBhY3Rpb24sIGRhdGEpe1xuXHRcdHN3aXRjaChhY3Rpb24pe1xuXHRcdFx0Y2FzZSBcImludGVyY2VwdFwiOlxuXHRcdFx0XHR0aGlzLmRvd25sb2FkKGRhdGEudHlwZSwgXCJcIiwgZGF0YS5vcHRpb25zLCBkYXRhLmFjdGl2ZSwgZGF0YS5pbnRlcmNlcHQpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gbWFza0lucHV0KGVsLCBvcHRpb25zKXtcblx0dmFyIG1hc2sgPSBvcHRpb25zLm1hc2ssXG5cdG1hc2tMZXR0ZXIgPSB0eXBlb2Ygb3B0aW9ucy5tYXNrTGV0dGVyQ2hhciAhPT0gXCJ1bmRlZmluZWRcIiA/IG9wdGlvbnMubWFza0xldHRlckNoYXIgOiBcIkFcIixcblx0bWFza051bWJlciA9IHR5cGVvZiBvcHRpb25zLm1hc2tOdW1iZXJDaGFyICE9PSBcInVuZGVmaW5lZFwiID8gb3B0aW9ucy5tYXNrTnVtYmVyQ2hhciA6IFwiOVwiLFxuXHRtYXNrV2lsZGNhcmQgPSB0eXBlb2Ygb3B0aW9ucy5tYXNrV2lsZGNhcmRDaGFyICE9PSBcInVuZGVmaW5lZFwiID8gb3B0aW9ucy5tYXNrV2lsZGNhcmRDaGFyIDogXCIqXCI7XG5cblx0ZnVuY3Rpb24gZmlsbFN5bWJvbHMoaW5kZXgpe1xuXHRcdHZhciBzeW1ib2wgPSBtYXNrW2luZGV4XTtcblx0XHRpZih0eXBlb2Ygc3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIHN5bWJvbCAhPT0gbWFza1dpbGRjYXJkICYmIHN5bWJvbCAhPT0gbWFza0xldHRlciAmJiBzeW1ib2wgIT09IG1hc2tOdW1iZXIpe1xuXHRcdFx0ZWwudmFsdWUgPSBlbC52YWx1ZSArIFwiXCIgKyBzeW1ib2w7XG5cdFx0XHRmaWxsU3ltYm9scyhpbmRleCsxKTtcblx0XHR9XG5cdH1cblxuXHRlbC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xuXHRcdHZhciBpbmRleCA9IGVsLnZhbHVlLmxlbmd0aCxcblx0XHRjaGFyID0gZS5rZXk7XG5cblx0XHRpZihlLmtleUNvZGUgPiA0NiAmJiAhZS5jdHJsS2V5ICYmICFlLm1ldGFLZXkpe1xuXHRcdFx0aWYoaW5kZXggPj0gbWFzay5sZW5ndGgpe1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0c3dpdGNoKG1hc2tbaW5kZXhdKXtcblx0XHRcdFx0XHRjYXNlIG1hc2tMZXR0ZXI6XG5cdFx0XHRcdFx0XHRpZihjaGFyLnRvVXBwZXJDYXNlKCkgPT0gY2hhci50b0xvd2VyQ2FzZSgpKXtcblx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgbWFza051bWJlcjpcblx0XHRcdFx0XHRcdGlmKGlzTmFOKGNoYXIpKXtcblx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgbWFza1dpbGRjYXJkOlxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0aWYoY2hhciAhPT0gbWFza1tpbmRleF0pe1xuXHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybjtcblx0fSk7XG5cblx0ZWwuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIChlKSA9PiB7XG5cdFx0aWYoZS5rZXlDb2RlID4gNDYpe1xuXHRcdFx0aWYob3B0aW9ucy5tYXNrQXV0b0ZpbGwpe1xuXHRcdFx0XHRmaWxsU3ltYm9scyhlbC52YWx1ZS5sZW5ndGgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblxuXHRpZighZWwucGxhY2Vob2xkZXIpe1xuXHRcdGVsLnBsYWNlaG9sZGVyID0gbWFzaztcblx0fVxuXG5cdGlmKG9wdGlvbnMubWFza0F1dG9GaWxsKXtcblx0XHRmaWxsU3ltYm9scyhlbC52YWx1ZS5sZW5ndGgpO1xuXHR9XG59XG5cbi8vaW5wdXQgZWxlbWVudFxuZnVuY3Rpb24gaW5wdXQoY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpe1xuXHQvL2NyZWF0ZSBhbmQgc3R5bGUgaW5wdXRcblx0dmFyIGNlbGxWYWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKSxcblx0aW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG5cblx0aW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBlZGl0b3JQYXJhbXMuc2VhcmNoID8gXCJzZWFyY2hcIiA6IFwidGV4dFwiKTtcblxuXHRpbnB1dC5zdHlsZS5wYWRkaW5nID0gXCI0cHhcIjtcblx0aW5wdXQuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcblx0aW5wdXQuc3R5bGUuYm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XG5cblx0aWYoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzICYmIHR5cGVvZiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgPT0gXCJvYmplY3RcIil7XG5cdFx0Zm9yIChsZXQga2V5IGluIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyl7XG5cdFx0XHRpZihrZXkuY2hhckF0KDApID09IFwiK1wiKXtcblx0XHRcdFx0a2V5ID0ga2V5LnNsaWNlKDEpO1xuXHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBpbnB1dC5nZXRBdHRyaWJ1dGUoa2V5KSArIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1tcIitcIiArIGtleV0pO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aW5wdXQudmFsdWUgPSB0eXBlb2YgY2VsbFZhbHVlICE9PSBcInVuZGVmaW5lZFwiID8gY2VsbFZhbHVlIDogXCJcIjtcblxuXHRvblJlbmRlcmVkKGZ1bmN0aW9uKCl7XG5cdFx0aWYoY2VsbC5nZXRUeXBlKCkgPT09IFwiY2VsbFwiKXtcblx0XHRcdGlucHV0LmZvY3VzKHtwcmV2ZW50U2Nyb2xsOiB0cnVlfSk7XG5cdFx0XHRpbnB1dC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblxuXHRcdFx0aWYoZWRpdG9yUGFyYW1zLnNlbGVjdENvbnRlbnRzKXtcblx0XHRcdFx0aW5wdXQuc2VsZWN0KCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRmdW5jdGlvbiBvbkNoYW5nZShlKXtcblx0XHRpZigoKGNlbGxWYWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgY2VsbFZhbHVlID09PSBcInVuZGVmaW5lZFwiKSAmJiBpbnB1dC52YWx1ZSAhPT0gXCJcIikgfHwgaW5wdXQudmFsdWUgIT09IGNlbGxWYWx1ZSl7XG5cdFx0XHRpZihzdWNjZXNzKGlucHV0LnZhbHVlKSl7XG5cdFx0XHRcdGNlbGxWYWx1ZSA9IGlucHV0LnZhbHVlOyAvL3BlcnNpc3QgdmFsdWUgaWYgc3VjY2Vzc2Z1bGx5IHZhbGlkYXRlZCBpbmNhc2UgZWRpdG9yIGlzIHVzZWQgYXMgaGVhZGVyIGZpbHRlclxuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNhbmNlbCgpO1xuXHRcdH1cblx0fVxuXG5cdC8vc3VibWl0IG5ldyB2YWx1ZSBvbiBibHVyIG9yIGNoYW5nZVxuXHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIG9uQ2hhbmdlKTtcblx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgb25DaGFuZ2UpO1xuXG5cdC8vc3VibWl0IG5ldyB2YWx1ZSBvbiBlbnRlclxuXHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihlKXtcblx0XHRzd2l0Y2goZS5rZXlDb2RlKXtcblx0XHRcdC8vIGNhc2UgOTpcblx0XHRcdGNhc2UgMTM6XG5cdFx0XHRcdG9uQ2hhbmdlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDI3OlxuXHRcdFx0XHRjYW5jZWwoKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMzU6XG5cdFx0XHRjYXNlIDM2OlxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH0pO1xuXG5cdGlmKGVkaXRvclBhcmFtcy5tYXNrKXtcblx0XHRtYXNrSW5wdXQoaW5wdXQsIGVkaXRvclBhcmFtcyk7XG5cdH1cblxuXHRyZXR1cm4gaW5wdXQ7XG59XG5cbi8vcmVzaXphYmxlIHRleHQgYXJlYSBlbGVtZW50XG5mdW5jdGlvbiB0ZXh0YXJlYSQxKGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKXtcblx0dmFyIGNlbGxWYWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKSxcblx0dmVydE5hdiA9IGVkaXRvclBhcmFtcy52ZXJ0aWNhbE5hdmlnYXRpb24gfHwgXCJoeWJyaWRcIixcblx0dmFsdWUgPSBTdHJpbmcoY2VsbFZhbHVlICE9PSBudWxsICYmIHR5cGVvZiBjZWxsVmFsdWUgIT09IFwidW5kZWZpbmVkXCIgID8gY2VsbFZhbHVlIDogXCJcIiksXG5cdGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpLFxuXHRzY3JvbGxIZWlnaHQgPSAwO1xuXG5cdC8vY3JlYXRlIGFuZCBzdHlsZSBpbnB1dFxuXHRpbnB1dC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuXHRpbnB1dC5zdHlsZS5wYWRkaW5nID0gXCIycHhcIjtcblx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdGlucHV0LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cdGlucHV0LnN0eWxlLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXHRpbnB1dC5zdHlsZS53aGl0ZVNwYWNlID0gXCJwcmUtd3JhcFwiO1xuXHRpbnB1dC5zdHlsZS5yZXNpemUgPSBcIm5vbmVcIjtcblxuXHRpZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgdHlwZW9mIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyA9PSBcIm9iamVjdFwiKXtcblx0XHRmb3IgKGxldCBrZXkgaW4gZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKXtcblx0XHRcdGlmKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpe1xuXHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGlucHV0LmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1trZXldKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpbnB1dC52YWx1ZSA9IHZhbHVlO1xuXG5cdG9uUmVuZGVyZWQoZnVuY3Rpb24oKXtcblx0XHRpZihjZWxsLmdldFR5cGUoKSA9PT0gXCJjZWxsXCIpe1xuXHRcdFx0aW5wdXQuZm9jdXMoe3ByZXZlbnRTY3JvbGw6IHRydWV9KTtcblx0XHRcdGlucHV0LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuXG5cdFx0XHRpbnB1dC5zY3JvbGxIZWlnaHQ7XG5cdFx0XHRpbnB1dC5zdHlsZS5oZWlnaHQgPSBpbnB1dC5zY3JvbGxIZWlnaHQgKyBcInB4XCI7XG5cdFx0XHRjZWxsLmdldFJvdygpLm5vcm1hbGl6ZUhlaWdodCgpO1xuXG5cdFx0XHRpZihlZGl0b3JQYXJhbXMuc2VsZWN0Q29udGVudHMpe1xuXHRcdFx0XHRpbnB1dC5zZWxlY3QoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIG9uQ2hhbmdlKGUpe1xuXG5cdFx0aWYoKChjZWxsVmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIGNlbGxWYWx1ZSA9PT0gXCJ1bmRlZmluZWRcIikgJiYgaW5wdXQudmFsdWUgIT09IFwiXCIpIHx8IGlucHV0LnZhbHVlICE9PSBjZWxsVmFsdWUpe1xuXG5cdFx0XHRpZihzdWNjZXNzKGlucHV0LnZhbHVlKSl7XG5cdFx0XHRcdGNlbGxWYWx1ZSA9IGlucHV0LnZhbHVlOyAvL3BlcnNpc3QgdmFsdWUgaWYgc3VjY2Vzc2Z1bGx5IHZhbGlkYXRlZCBpbmNhc2UgZWRpdG9yIGlzIHVzZWQgYXMgaGVhZGVyIGZpbHRlclxuXHRcdFx0fVxuXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdGNlbGwuZ2V0Um93KCkubm9ybWFsaXplSGVpZ2h0KCk7XG5cdFx0XHR9LDMwMCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y2FuY2VsKCk7XG5cdFx0fVxuXHR9XG5cblx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGJsdXIgb3IgY2hhbmdlXG5cdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgb25DaGFuZ2UpO1xuXHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBvbkNoYW5nZSk7XG5cblx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGZ1bmN0aW9uKCl7XG5cblx0XHRpbnB1dC5zdHlsZS5oZWlnaHQgPSBcIlwiO1xuXG5cdFx0dmFyIGhlaWdodE5vdyA9IGlucHV0LnNjcm9sbEhlaWdodDtcblxuXHRcdGlucHV0LnN0eWxlLmhlaWdodCA9IGhlaWdodE5vdyArIFwicHhcIjtcblxuXHRcdGlmKGhlaWdodE5vdyAhPSBzY3JvbGxIZWlnaHQpe1xuXHRcdFx0c2Nyb2xsSGVpZ2h0ID0gaGVpZ2h0Tm93O1xuXHRcdFx0Y2VsbC5nZXRSb3coKS5ub3JtYWxpemVIZWlnaHQoKTtcblx0XHR9XG5cdH0pO1xuXG5cdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpe1xuXG5cdFx0c3dpdGNoKGUua2V5Q29kZSl7XG5cblx0XHRcdGNhc2UgMTM6XG5cdFx0XHRcdGlmKGUuc2hpZnRLZXkgJiYgZWRpdG9yUGFyYW1zLnNoaWZ0RW50ZXJTdWJtaXQpe1xuXHRcdFx0XHRcdG9uQ2hhbmdlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMjc6XG5cdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAzODogLy91cCBhcnJvd1xuXHRcdFx0XHRpZih2ZXJ0TmF2ID09IFwiZWRpdG9yXCIgfHwgKHZlcnROYXYgPT0gXCJoeWJyaWRcIiAmJiBpbnB1dC5zZWxlY3Rpb25TdGFydCkpe1xuXHRcdFx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDQwOiAvL2Rvd24gYXJyb3dcblx0XHRcdFx0aWYodmVydE5hdiA9PSBcImVkaXRvclwiIHx8ICh2ZXJ0TmF2ID09IFwiaHlicmlkXCIgJiYgaW5wdXQuc2VsZWN0aW9uU3RhcnQgIT09IGlucHV0LnZhbHVlLmxlbmd0aCkpe1xuXHRcdFx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAzNTpcblx0XHRcdGNhc2UgMzY6XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSk7XG5cblx0aWYoZWRpdG9yUGFyYW1zLm1hc2spe1xuXHRcdG1hc2tJbnB1dChpbnB1dCwgZWRpdG9yUGFyYW1zKTtcblx0fVxuXG5cdHJldHVybiBpbnB1dDtcbn1cblxuLy9pbnB1dCBlbGVtZW50IHdpdGggdHlwZSBvZiBudW1iZXJcbmZ1bmN0aW9uIG51bWJlciQxKGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKXtcblx0dmFyIGNlbGxWYWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKSxcblx0dmVydE5hdiA9IGVkaXRvclBhcmFtcy52ZXJ0aWNhbE5hdmlnYXRpb24gfHwgXCJlZGl0b3JcIixcblx0aW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG5cblx0aW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcIm51bWJlclwiKTtcblxuXHRpZih0eXBlb2YgZWRpdG9yUGFyYW1zLm1heCAhPSBcInVuZGVmaW5lZFwiKXtcblx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoXCJtYXhcIiwgZWRpdG9yUGFyYW1zLm1heCk7XG5cdH1cblxuXHRpZih0eXBlb2YgZWRpdG9yUGFyYW1zLm1pbiAhPSBcInVuZGVmaW5lZFwiKXtcblx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgZWRpdG9yUGFyYW1zLm1pbik7XG5cdH1cblxuXHRpZih0eXBlb2YgZWRpdG9yUGFyYW1zLnN0ZXAgIT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwic3RlcFwiLCBlZGl0b3JQYXJhbXMuc3RlcCk7XG5cdH1cblxuXHQvL2NyZWF0ZSBhbmQgc3R5bGUgaW5wdXRcblx0aW5wdXQuc3R5bGUucGFkZGluZyA9IFwiNHB4XCI7XG5cdGlucHV0LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cdGlucHV0LnN0eWxlLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXG5cdGlmKGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyAmJiB0eXBlb2YgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzID09IFwib2JqZWN0XCIpe1xuXHRcdGZvciAobGV0IGtleSBpbiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpe1xuXHRcdFx0aWYoa2V5LmNoYXJBdCgwKSA9PSBcIitcIil7XG5cdFx0XHRcdGtleSA9IGtleS5zbGljZSgxKTtcblx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgaW5wdXQuZ2V0QXR0cmlidXRlKGtleSkgKyBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNbXCIrXCIgKyBrZXldKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW2tleV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlucHV0LnZhbHVlID0gY2VsbFZhbHVlO1xuXG5cdHZhciBibHVyRnVuYyA9IGZ1bmN0aW9uKGUpe1xuXHRcdG9uQ2hhbmdlKCk7XG5cdH07XG5cblx0b25SZW5kZXJlZChmdW5jdGlvbiAoKSB7XG5cdFx0aWYoY2VsbC5nZXRUeXBlKCkgPT09IFwiY2VsbFwiKXtcblx0XHRcdC8vc3VibWl0IG5ldyB2YWx1ZSBvbiBibHVyXG5cdFx0XHRpbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmx1clwiLCBibHVyRnVuYyk7XG5cblx0XHRcdGlucHV0LmZvY3VzKHtwcmV2ZW50U2Nyb2xsOiB0cnVlfSk7XG5cdFx0XHRpbnB1dC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblxuXHRcdFx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGJsdXJcblx0XHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGJsdXJGdW5jKTtcblxuXHRcdFx0aWYoZWRpdG9yUGFyYW1zLnNlbGVjdENvbnRlbnRzKXtcblx0XHRcdFx0aW5wdXQuc2VsZWN0KCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRmdW5jdGlvbiBvbkNoYW5nZSgpe1xuXHRcdHZhciB2YWx1ZSA9IGlucHV0LnZhbHVlO1xuXG5cdFx0aWYoIWlzTmFOKHZhbHVlKSAmJiB2YWx1ZSAhPT1cIlwiKXtcblx0XHRcdHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcblx0XHR9XG5cblx0XHRpZih2YWx1ZSAhPT0gY2VsbFZhbHVlKXtcblx0XHRcdGlmKHN1Y2Nlc3ModmFsdWUpKXtcblx0XHRcdFx0Y2VsbFZhbHVlID0gdmFsdWU7IC8vcGVyc2lzdCB2YWx1ZSBpZiBzdWNjZXNzZnVsbHkgdmFsaWRhdGVkIGluY2FzZSBlZGl0b3IgaXMgdXNlZCBhcyBoZWFkZXIgZmlsdGVyXG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y2FuY2VsKCk7XG5cdFx0fVxuXHR9XG5cblx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGVudGVyXG5cdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdHN3aXRjaChlLmtleUNvZGUpe1xuXHRcdFx0Y2FzZSAxMzpcblx0XHRcdC8vIGNhc2UgOTpcblx0XHRcdFx0b25DaGFuZ2UoKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMjc6XG5cdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAzODogLy91cCBhcnJvd1xuXHRcdFx0Y2FzZSA0MDogLy9kb3duIGFycm93XG5cdFx0XHRcdGlmKHZlcnROYXYgPT0gXCJlZGl0b3JcIil7XG5cdFx0XHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDM1OlxuXHRcdFx0Y2FzZSAzNjpcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9KTtcblxuXHRpZihlZGl0b3JQYXJhbXMubWFzayl7XG5cdFx0bWFza0lucHV0KGlucHV0LCBlZGl0b3JQYXJhbXMpO1xuXHR9XG5cblx0cmV0dXJuIGlucHV0O1xufVxuXG4vL2lucHV0IGVsZW1lbnQgd2l0aCB0eXBlIG9mIG51bWJlclxuZnVuY3Rpb24gcmFuZ2UoY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpe1xuXHR2YXIgY2VsbFZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcblx0XG5cdGlucHV0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJyYW5nZVwiKTtcblx0XG5cdGlmICh0eXBlb2YgZWRpdG9yUGFyYW1zLm1heCAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwibWF4XCIsIGVkaXRvclBhcmFtcy5tYXgpO1xuXHR9XG5cdFxuXHRpZiAodHlwZW9mIGVkaXRvclBhcmFtcy5taW4gIT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdGlucHV0LnNldEF0dHJpYnV0ZShcIm1pblwiLCBlZGl0b3JQYXJhbXMubWluKTtcblx0fVxuXHRcblx0aWYgKHR5cGVvZiBlZGl0b3JQYXJhbXMuc3RlcCAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwic3RlcFwiLCBlZGl0b3JQYXJhbXMuc3RlcCk7XG5cdH1cblx0XG5cdC8vY3JlYXRlIGFuZCBzdHlsZSBpbnB1dFxuXHRpbnB1dC5zdHlsZS5wYWRkaW5nID0gXCI0cHhcIjtcblx0aW5wdXQuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcblx0aW5wdXQuc3R5bGUuYm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XG5cdFxuXHRpZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgdHlwZW9mIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyA9PSBcIm9iamVjdFwiKXtcblx0XHRmb3IgKGxldCBrZXkgaW4gZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKXtcblx0XHRcdGlmKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpe1xuXHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGlucHV0LmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1trZXldKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGlucHV0LnZhbHVlID0gY2VsbFZhbHVlO1xuXHRcblx0b25SZW5kZXJlZChmdW5jdGlvbiAoKSB7XG5cdFx0aWYoY2VsbC5nZXRUeXBlKCkgPT09IFwiY2VsbFwiKXtcblx0XHRcdGlucHV0LmZvY3VzKHtwcmV2ZW50U2Nyb2xsOiB0cnVlfSk7XG5cdFx0XHRpbnB1dC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblx0XHR9XG5cdH0pO1xuXHRcblx0ZnVuY3Rpb24gb25DaGFuZ2UoKXtcblx0XHR2YXIgdmFsdWUgPSBpbnB1dC52YWx1ZTtcblx0XHRcblx0XHRpZighaXNOYU4odmFsdWUpICYmIHZhbHVlICE9PVwiXCIpe1xuXHRcdFx0dmFsdWUgPSBOdW1iZXIodmFsdWUpO1xuXHRcdH1cblx0XHRcblx0XHRpZih2YWx1ZSAhPSBjZWxsVmFsdWUpe1xuXHRcdFx0aWYoc3VjY2Vzcyh2YWx1ZSkpe1xuXHRcdFx0XHRjZWxsVmFsdWUgPSB2YWx1ZTsgLy9wZXJzaXN0IHZhbHVlIGlmIHN1Y2Nlc3NmdWxseSB2YWxpZGF0ZWQgaW5jYXNlIGVkaXRvciBpcyB1c2VkIGFzIGhlYWRlciBmaWx0ZXJcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRjYW5jZWwoKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vc3VibWl0IG5ldyB2YWx1ZSBvbiBibHVyXG5cdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdG9uQ2hhbmdlKCk7XG5cdH0pO1xuXHRcblx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGVudGVyXG5cdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdHN3aXRjaChlLmtleUNvZGUpe1xuXHRcdFx0Y2FzZSAxMzpcblx0XHRcdC8vIGNhc2UgOTpcblx0XHRcdFx0b25DaGFuZ2UoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcblx0XHRcdGNhc2UgMjc6XG5cdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH0pO1xuXHRcblx0cmV0dXJuIGlucHV0O1xufVxuXG4vL2lucHV0IGVsZW1lbnRcbmZ1bmN0aW9uIGRhdGUkMShjZWxsLCBvblJlbmRlcmVkLCBzdWNjZXNzLCBjYW5jZWwsIGVkaXRvclBhcmFtcyl7XG5cdHZhciBpbnB1dEZvcm1hdCA9IGVkaXRvclBhcmFtcy5mb3JtYXQsXG5cdHZlcnROYXYgPSBlZGl0b3JQYXJhbXMudmVydGljYWxOYXZpZ2F0aW9uIHx8IFwiZWRpdG9yXCIsXG5cdERUID0gaW5wdXRGb3JtYXQgPyAod2luZG93LkRhdGVUaW1lIHx8IGx1eG9uLkRhdGVUaW1lKSA6IG51bGw7XG5cdFxuXHQvL2NyZWF0ZSBhbmQgc3R5bGUgaW5wdXRcblx0dmFyIGNlbGxWYWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKSxcblx0aW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG5cdFxuXHRmdW5jdGlvbiBjb252ZXJ0RGF0ZSh2YWx1ZSl7XG5cdFx0dmFyIG5ld0RhdGV0aW1lO1xuXHRcdFxuXHRcdGlmKERULmlzRGF0ZVRpbWUodmFsdWUpKXtcblx0XHRcdG5ld0RhdGV0aW1lID0gdmFsdWU7XG5cdFx0fWVsc2UgaWYoaW5wdXRGb3JtYXQgPT09IFwiaXNvXCIpe1xuXHRcdFx0bmV3RGF0ZXRpbWUgPSBEVC5mcm9tSVNPKFN0cmluZyh2YWx1ZSkpO1xuXHRcdH1lbHNlIHtcblx0XHRcdG5ld0RhdGV0aW1lID0gRFQuZnJvbUZvcm1hdChTdHJpbmcodmFsdWUpLCBpbnB1dEZvcm1hdCk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBuZXdEYXRldGltZS50b0Zvcm1hdChcInl5eXktTU0tZGRcIik7XG5cdH1cblx0XG5cdGlucHV0LnR5cGUgPSBcImRhdGVcIjtcblx0aW5wdXQuc3R5bGUucGFkZGluZyA9IFwiNHB4XCI7XG5cdGlucHV0LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cdGlucHV0LnN0eWxlLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXG5cdGlmKGVkaXRvclBhcmFtcy5tYXgpe1xuXHRcdGlucHV0LnNldEF0dHJpYnV0ZShcIm1heFwiLCBpbnB1dEZvcm1hdCA/IGNvbnZlcnREYXRlKGVkaXRvclBhcmFtcy5tYXgpIDogZWRpdG9yUGFyYW1zLm1heCk7XG5cdH1cblxuXHRpZihlZGl0b3JQYXJhbXMubWluKXtcblx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgaW5wdXRGb3JtYXQgPyBjb252ZXJ0RGF0ZShlZGl0b3JQYXJhbXMubWluKSA6IGVkaXRvclBhcmFtcy5taW4pO1xuXHR9XG5cdFxuXHRpZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgdHlwZW9mIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyA9PSBcIm9iamVjdFwiKXtcblx0XHRmb3IgKGxldCBrZXkgaW4gZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKXtcblx0XHRcdGlmKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpe1xuXHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGlucHV0LmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1trZXldKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGNlbGxWYWx1ZSA9IHR5cGVvZiBjZWxsVmFsdWUgIT09IFwidW5kZWZpbmVkXCIgPyBjZWxsVmFsdWUgOiBcIlwiO1xuXHRcblx0aWYoaW5wdXRGb3JtYXQpe1xuXHRcdGlmKERUKXtcdFx0XG5cdFx0XHRjZWxsVmFsdWUgPSBjb252ZXJ0RGF0ZShjZWxsVmFsdWUpO1x0XHRcdFxuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJFZGl0b3IgRXJyb3IgLSAnZGF0ZScgZWRpdG9yICdmb3JtYXQnIHBhcmFtIGlzIGRlcGVuZGFudCBvbiBsdXhvbi5qc1wiKTtcblx0XHR9XG5cdH1cblx0XG5cdGlucHV0LnZhbHVlID0gY2VsbFZhbHVlO1xuXHRcblx0b25SZW5kZXJlZChmdW5jdGlvbigpe1xuXHRcdGlmKGNlbGwuZ2V0VHlwZSgpID09PSBcImNlbGxcIil7XG5cdFx0XHRpbnB1dC5mb2N1cyh7cHJldmVudFNjcm9sbDogdHJ1ZX0pO1xuXHRcdFx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdFx0XHRcblx0XHRcdGlmKGVkaXRvclBhcmFtcy5zZWxlY3RDb250ZW50cyl7XG5cdFx0XHRcdGlucHV0LnNlbGVjdCgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cdFxuXHRmdW5jdGlvbiBvbkNoYW5nZSgpe1xuXHRcdHZhciB2YWx1ZSA9IGlucHV0LnZhbHVlLFxuXHRcdGx1eERhdGU7XG5cdFx0XG5cdFx0aWYoKChjZWxsVmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIGNlbGxWYWx1ZSA9PT0gXCJ1bmRlZmluZWRcIikgJiYgdmFsdWUgIT09IFwiXCIpIHx8IHZhbHVlICE9PSBjZWxsVmFsdWUpe1xuXHRcdFx0XG5cdFx0XHRpZih2YWx1ZSAmJiBpbnB1dEZvcm1hdCl7XG5cdFx0XHRcdGx1eERhdGUgPSBEVC5mcm9tRm9ybWF0KFN0cmluZyh2YWx1ZSksIFwieXl5eS1NTS1kZFwiKTtcblxuXHRcdFx0XHRzd2l0Y2goaW5wdXRGb3JtYXQpe1xuXHRcdFx0XHRcdGNhc2UgdHJ1ZTpcblx0XHRcdFx0XHRcdHZhbHVlID0gbHV4RGF0ZTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0Y2FzZSBcImlzb1wiOlxuXHRcdFx0XHRcdFx0dmFsdWUgPSBsdXhEYXRlLnRvSVNPKCk7XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHR2YWx1ZSA9IGx1eERhdGUudG9Gb3JtYXQoaW5wdXRGb3JtYXQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKHN1Y2Nlc3ModmFsdWUpKXtcblx0XHRcdFx0Y2VsbFZhbHVlID0gaW5wdXQudmFsdWU7IC8vcGVyc2lzdCB2YWx1ZSBpZiBzdWNjZXNzZnVsbHkgdmFsaWRhdGVkIGluY2FzZSBlZGl0b3IgaXMgdXNlZCBhcyBoZWFkZXIgZmlsdGVyXG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y2FuY2VsKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gYmx1clxuXHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbihlKSB7XG5cdFx0aWYgKGUucmVsYXRlZFRhcmdldCB8fCBlLnJhbmdlUGFyZW50IHx8IGUuZXhwbGljaXRPcmlnaW5hbFRhcmdldCAhPT0gaW5wdXQpIHtcblx0XHRcdG9uQ2hhbmdlKCk7IC8vIG9ubHkgb24gYSBcInRydWVcIiBibHVyOyBub3Qgd2hlbiBmb2N1c2luZyBicm93c2VyJ3MgZGF0ZS90aW1lIHBpY2tlclxuXHRcdH1cblx0fSk7XG5cdFxuXHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gZW50ZXJcblx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24oZSl7XG5cdFx0c3dpdGNoKGUua2V5Q29kZSl7XG5cdFx0XHQvLyBjYXNlIDk6XG5cdFx0XHRjYXNlIDEzOlxuXHRcdFx0XHRvbkNoYW5nZSgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSAyNzpcblx0XHRcdFx0Y2FuY2VsKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIDM1OlxuXHRcdFx0Y2FzZSAzNjpcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcblx0XHRcdGNhc2UgMzg6IC8vdXAgYXJyb3dcblx0XHRcdGNhc2UgNDA6IC8vZG93biBhcnJvd1xuXHRcdFx0XHRpZih2ZXJ0TmF2ID09IFwiZWRpdG9yXCIpe1xuXHRcdFx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH0pO1xuXHRcblx0cmV0dXJuIGlucHV0O1xufVxuXG4vL2lucHV0IGVsZW1lbnRcbmZ1bmN0aW9uIHRpbWUkMShjZWxsLCBvblJlbmRlcmVkLCBzdWNjZXNzLCBjYW5jZWwsIGVkaXRvclBhcmFtcyl7XG5cdHZhciBpbnB1dEZvcm1hdCA9IGVkaXRvclBhcmFtcy5mb3JtYXQsXG5cdHZlcnROYXYgPSBlZGl0b3JQYXJhbXMudmVydGljYWxOYXZpZ2F0aW9uIHx8IFwiZWRpdG9yXCIsXG5cdERUID0gaW5wdXRGb3JtYXQgPyAod2luZG93LkRhdGVUaW1lIHx8IGx1eG9uLkRhdGVUaW1lKSA6IG51bGwsIFxuXHRuZXdEYXRldGltZTtcblx0XG5cdC8vY3JlYXRlIGFuZCBzdHlsZSBpbnB1dFxuXHR2YXIgY2VsbFZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcblx0XG5cdGlucHV0LnR5cGUgPSBcInRpbWVcIjtcblx0aW5wdXQuc3R5bGUucGFkZGluZyA9IFwiNHB4XCI7XG5cdGlucHV0LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cdGlucHV0LnN0eWxlLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXHRcblx0aWYoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzICYmIHR5cGVvZiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgPT0gXCJvYmplY3RcIil7XG5cdFx0Zm9yIChsZXQga2V5IGluIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyl7XG5cdFx0XHRpZihrZXkuY2hhckF0KDApID09IFwiK1wiKXtcblx0XHRcdFx0a2V5ID0ga2V5LnNsaWNlKDEpO1xuXHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBpbnB1dC5nZXRBdHRyaWJ1dGUoa2V5KSArIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1tcIitcIiArIGtleV0pO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRjZWxsVmFsdWUgPSB0eXBlb2YgY2VsbFZhbHVlICE9PSBcInVuZGVmaW5lZFwiID8gY2VsbFZhbHVlIDogXCJcIjtcblx0XG5cdGlmKGlucHV0Rm9ybWF0KXtcblx0XHRpZihEVCl7XG5cdFx0XHRpZihEVC5pc0RhdGVUaW1lKGNlbGxWYWx1ZSkpe1xuXHRcdFx0XHRuZXdEYXRldGltZSA9IGNlbGxWYWx1ZTtcblx0XHRcdH1lbHNlIGlmKGlucHV0Rm9ybWF0ID09PSBcImlzb1wiKXtcblx0XHRcdFx0bmV3RGF0ZXRpbWUgPSBEVC5mcm9tSVNPKFN0cmluZyhjZWxsVmFsdWUpKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0bmV3RGF0ZXRpbWUgPSBEVC5mcm9tRm9ybWF0KFN0cmluZyhjZWxsVmFsdWUpLCBpbnB1dEZvcm1hdCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGNlbGxWYWx1ZSA9IG5ld0RhdGV0aW1lLnRvRm9ybWF0KFwiSEg6bW1cIik7XG5cdFx0XHRcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiRWRpdG9yIEVycm9yIC0gJ2RhdGUnIGVkaXRvciAnZm9ybWF0JyBwYXJhbSBpcyBkZXBlbmRhbnQgb24gbHV4b24uanNcIik7XG5cdFx0fVxuXHR9XG5cdFxuXHRpbnB1dC52YWx1ZSA9IGNlbGxWYWx1ZTtcblx0XG5cdG9uUmVuZGVyZWQoZnVuY3Rpb24oKXtcblx0XHRpZihjZWxsLmdldFR5cGUoKSA9PSBcImNlbGxcIil7XG5cdFx0XHRpbnB1dC5mb2N1cyh7cHJldmVudFNjcm9sbDogdHJ1ZX0pO1xuXHRcdFx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdFx0XHRcblx0XHRcdGlmKGVkaXRvclBhcmFtcy5zZWxlY3RDb250ZW50cyl7XG5cdFx0XHRcdGlucHV0LnNlbGVjdCgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cdFxuXHRmdW5jdGlvbiBvbkNoYW5nZSgpe1xuXHRcdHZhciB2YWx1ZSA9IGlucHV0LnZhbHVlLFxuXHRcdGx1eFRpbWU7XG5cdFx0XG5cdFx0aWYoKChjZWxsVmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIGNlbGxWYWx1ZSA9PT0gXCJ1bmRlZmluZWRcIikgJiYgdmFsdWUgIT09IFwiXCIpIHx8IHZhbHVlICE9PSBjZWxsVmFsdWUpe1xuXHRcdFx0XG5cdFx0XHRpZih2YWx1ZSAmJiBpbnB1dEZvcm1hdCl7XG5cdFx0XHRcdGx1eFRpbWUgPSBEVC5mcm9tRm9ybWF0KFN0cmluZyh2YWx1ZSksIFwiaGg6bW1cIik7XG5cblx0XHRcdFx0c3dpdGNoKGlucHV0Rm9ybWF0KXtcblx0XHRcdFx0XHRjYXNlIHRydWU6XG5cdFx0XHRcdFx0XHR2YWx1ZSA9IGx1eFRpbWU7XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgXCJpc29cIjpcblx0XHRcdFx0XHRcdHZhbHVlID0gbHV4VGltZS50b0lTTygpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0dmFsdWUgPSBsdXhUaW1lLnRvRm9ybWF0KGlucHV0Rm9ybWF0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihzdWNjZXNzKHZhbHVlKSl7XG5cdFx0XHRcdGNlbGxWYWx1ZSA9IGlucHV0LnZhbHVlOyAvL3BlcnNpc3QgdmFsdWUgaWYgc3VjY2Vzc2Z1bGx5IHZhbGlkYXRlZCBpbmNhc2UgZWRpdG9yIGlzIHVzZWQgYXMgaGVhZGVyIGZpbHRlclxuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNhbmNlbCgpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGJsdXJcblx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgZnVuY3Rpb24oZSkge1xuXHRcdGlmIChlLnJlbGF0ZWRUYXJnZXQgfHwgZS5yYW5nZVBhcmVudCB8fCBlLmV4cGxpY2l0T3JpZ2luYWxUYXJnZXQgIT09IGlucHV0KSB7XG5cdFx0XHRvbkNoYW5nZSgpOyAvLyBvbmx5IG9uIGEgXCJ0cnVlXCIgYmx1cjsgbm90IHdoZW4gZm9jdXNpbmcgYnJvd3NlcidzIGRhdGUvdGltZSBwaWNrZXJcblx0XHR9XG5cdH0pO1xuXHRcblx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGVudGVyXG5cdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdHN3aXRjaChlLmtleUNvZGUpe1xuXHRcdFx0Ly8gY2FzZSA5OlxuXHRcdFx0Y2FzZSAxMzpcblx0XHRcdFx0b25DaGFuZ2UoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcblx0XHRcdGNhc2UgMjc6XG5cdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSAzNTpcblx0XHRcdGNhc2UgMzY6XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDM4OiAvL3VwIGFycm93XG5cdFx0XHRjYXNlIDQwOiAvL2Rvd24gYXJyb3dcblx0XHRcdFx0aWYodmVydE5hdiA9PSBcImVkaXRvclwiKXtcblx0XHRcdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9KTtcblx0XG5cdHJldHVybiBpbnB1dDtcbn1cblxuLy9pbnB1dCBlbGVtZW50XG5mdW5jdGlvbiBkYXRldGltZSQyKGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKXtcblx0dmFyIGlucHV0Rm9ybWF0ID0gZWRpdG9yUGFyYW1zLmZvcm1hdCxcblx0dmVydE5hdiA9IGVkaXRvclBhcmFtcy52ZXJ0aWNhbE5hdmlnYXRpb24gfHwgXCJlZGl0b3JcIixcblx0RFQgPSBpbnB1dEZvcm1hdCA/ICh0aGlzLnRhYmxlLmRlcGVuZGVuY3lSZWdpc3RyeS5sb29rdXAoW1wibHV4b25cIiwgXCJEYXRlVGltZVwiXSwgXCJEYXRlVGltZVwiKSkgOiBudWxsLCBcblx0bmV3RGF0ZXRpbWU7XG5cdFxuXHQvL2NyZWF0ZSBhbmQgc3R5bGUgaW5wdXRcblx0dmFyIGNlbGxWYWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKSxcblx0aW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG5cdFxuXHRpbnB1dC50eXBlID0gXCJkYXRldGltZS1sb2NhbFwiO1xuXHRpbnB1dC5zdHlsZS5wYWRkaW5nID0gXCI0cHhcIjtcblx0aW5wdXQuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcblx0aW5wdXQuc3R5bGUuYm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XG5cdFxuXHRpZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgdHlwZW9mIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyA9PSBcIm9iamVjdFwiKXtcblx0XHRmb3IgKGxldCBrZXkgaW4gZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKXtcblx0XHRcdGlmKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpe1xuXHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGlucHV0LmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1trZXldKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGNlbGxWYWx1ZSA9IHR5cGVvZiBjZWxsVmFsdWUgIT09IFwidW5kZWZpbmVkXCIgPyBjZWxsVmFsdWUgOiBcIlwiO1xuXHRcblx0aWYoaW5wdXRGb3JtYXQpe1xuXHRcdGlmKERUKXtcblx0XHRcdGlmKERULmlzRGF0ZVRpbWUoY2VsbFZhbHVlKSl7XG5cdFx0XHRcdG5ld0RhdGV0aW1lID0gY2VsbFZhbHVlO1xuXHRcdFx0fWVsc2UgaWYoaW5wdXRGb3JtYXQgPT09IFwiaXNvXCIpe1xuXHRcdFx0XHRuZXdEYXRldGltZSA9IERULmZyb21JU08oU3RyaW5nKGNlbGxWYWx1ZSkpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRuZXdEYXRldGltZSA9IERULmZyb21Gb3JtYXQoU3RyaW5nKGNlbGxWYWx1ZSksIGlucHV0Rm9ybWF0KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Y2VsbFZhbHVlID0gbmV3RGF0ZXRpbWUudG9Gb3JtYXQoXCJ5eXl5LU1NLWRkXCIpICArIFwiVFwiICsgbmV3RGF0ZXRpbWUudG9Gb3JtYXQoXCJISDptbVwiKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiRWRpdG9yIEVycm9yIC0gJ2RhdGUnIGVkaXRvciAnZm9ybWF0JyBwYXJhbSBpcyBkZXBlbmRhbnQgb24gbHV4b24uanNcIik7XG5cdFx0fVxuXHR9XG5cdFxuXHRpbnB1dC52YWx1ZSA9IGNlbGxWYWx1ZTtcblx0XG5cdG9uUmVuZGVyZWQoZnVuY3Rpb24oKXtcblx0XHRpZihjZWxsLmdldFR5cGUoKSA9PT0gXCJjZWxsXCIpe1xuXHRcdFx0aW5wdXQuZm9jdXMoe3ByZXZlbnRTY3JvbGw6IHRydWV9KTtcblx0XHRcdGlucHV0LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuXHRcdFx0XG5cdFx0XHRpZihlZGl0b3JQYXJhbXMuc2VsZWN0Q29udGVudHMpe1xuXHRcdFx0XHRpbnB1dC5zZWxlY3QoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXHRcblx0ZnVuY3Rpb24gb25DaGFuZ2UoKXtcblx0XHR2YXIgdmFsdWUgPSBpbnB1dC52YWx1ZSxcblx0XHRsdXhEYXRlVGltZTtcblx0XHRcblx0XHRpZigoKGNlbGxWYWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgY2VsbFZhbHVlID09PSBcInVuZGVmaW5lZFwiKSAmJiB2YWx1ZSAhPT0gXCJcIikgfHwgdmFsdWUgIT09IGNlbGxWYWx1ZSl7XG5cblx0XHRcdGlmKHZhbHVlICYmIGlucHV0Rm9ybWF0KXtcblx0XHRcdFx0bHV4RGF0ZVRpbWUgPSBEVC5mcm9tSVNPKFN0cmluZyh2YWx1ZSkpO1xuXG5cdFx0XHRcdHN3aXRjaChpbnB1dEZvcm1hdCl7XG5cdFx0XHRcdFx0Y2FzZSB0cnVlOlxuXHRcdFx0XHRcdFx0dmFsdWUgPSBsdXhEYXRlVGltZTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0Y2FzZSBcImlzb1wiOlxuXHRcdFx0XHRcdFx0dmFsdWUgPSBsdXhEYXRlVGltZS50b0lTTygpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0dmFsdWUgPSBsdXhEYXRlVGltZS50b0Zvcm1hdChpbnB1dEZvcm1hdCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoc3VjY2Vzcyh2YWx1ZSkpe1xuXHRcdFx0XHRjZWxsVmFsdWUgPSBpbnB1dC52YWx1ZTsgLy9wZXJzaXN0IHZhbHVlIGlmIHN1Y2Nlc3NmdWxseSB2YWxpZGF0ZWQgaW5jYXNlIGVkaXRvciBpcyB1c2VkIGFzIGhlYWRlciBmaWx0ZXJcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRjYW5jZWwoKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vc3VibWl0IG5ldyB2YWx1ZSBvbiBibHVyXG5cdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGZ1bmN0aW9uKGUpIHtcblx0XHRpZiAoZS5yZWxhdGVkVGFyZ2V0IHx8IGUucmFuZ2VQYXJlbnQgfHwgZS5leHBsaWNpdE9yaWdpbmFsVGFyZ2V0ICE9PSBpbnB1dCkge1xuXHRcdFx0b25DaGFuZ2UoKTsgLy8gb25seSBvbiBhIFwidHJ1ZVwiIGJsdXI7IG5vdCB3aGVuIGZvY3VzaW5nIGJyb3dzZXIncyBkYXRlL3RpbWUgcGlja2VyXG5cdFx0fVxuXHR9KTtcblx0XG5cdC8vc3VibWl0IG5ldyB2YWx1ZSBvbiBlbnRlclxuXHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihlKXtcblx0XHRzd2l0Y2goZS5rZXlDb2RlKXtcblx0XHRcdC8vIGNhc2UgOTpcblx0XHRcdGNhc2UgMTM6XG5cdFx0XHRcdG9uQ2hhbmdlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIDI3OlxuXHRcdFx0XHRjYW5jZWwoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcblx0XHRcdGNhc2UgMzU6XG5cdFx0XHRjYXNlIDM2OlxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAzODogLy91cCBhcnJvd1xuXHRcdFx0Y2FzZSA0MDogLy9kb3duIGFycm93XG5cdFx0XHRcdGlmKHZlcnROYXYgPT0gXCJlZGl0b3JcIil7XG5cdFx0XHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSk7XG5cdFxuXHRyZXR1cm4gaW5wdXQ7XG59XG5cbmxldCBFZGl0JDEgPSBjbGFzcyBFZGl0e1xuXHRjb25zdHJ1Y3RvcihlZGl0b3IsIGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKXtcblx0XHR0aGlzLmVkaXQgPSBlZGl0b3I7XG5cdFx0dGhpcy50YWJsZSA9IGVkaXRvci50YWJsZTtcblx0XHR0aGlzLmNlbGwgPSBjZWxsO1xuXHRcdHRoaXMucGFyYW1zID0gdGhpcy5faW5pdGlhbGl6ZVBhcmFtcyhlZGl0b3JQYXJhbXMpO1xuXHRcdFxuXHRcdHRoaXMuZGF0YSA9IFtdO1xuXHRcdHRoaXMuZGlzcGxheUl0ZW1zID0gW107XG5cdFx0dGhpcy5jdXJyZW50SXRlbXMgPSBbXTtcblx0XHR0aGlzLmZvY3VzZWRJdGVtID0gbnVsbDtcblx0XHRcblx0XHR0aGlzLmlucHV0ID0gdGhpcy5fY3JlYXRlSW5wdXRFbGVtZW50KCk7XG5cdFx0dGhpcy5saXN0RWwgPSB0aGlzLl9jcmVhdGVMaXN0RWxlbWVudCgpO1xuXHRcdFxuXHRcdHRoaXMuaW5pdGlhbFZhbHVlcyA9IG51bGw7IFxuXHRcdFxuXHRcdHRoaXMuaXNGaWx0ZXIgPSBjZWxsLmdldFR5cGUoKSA9PT0gXCJoZWFkZXJcIjtcblx0XHRcblx0XHR0aGlzLmZpbHRlclRpbWVvdXQgPSBudWxsO1xuXHRcdHRoaXMuZmlsdGVyZWQgPSBmYWxzZTtcblx0XHR0aGlzLnR5cGluZyA9IGZhbHNlO1xuXHRcdFxuXHRcdHRoaXMudmFsdWVzID0gW107IFxuXHRcdHRoaXMucG9wdXAgPSBudWxsOyAgXG5cdFx0XG5cdFx0dGhpcy5saXN0SXRlcmF0aW9uID0gMDtcblx0XHRcblx0XHR0aGlzLmxhc3RBY3Rpb249XCJcIjtcblx0XHR0aGlzLmZpbHRlclRlcm09XCJcIjtcblx0XHRcblx0XHR0aGlzLmJsdXJhYmxlID0gdHJ1ZTtcblx0XHRcblx0XHR0aGlzLmFjdGlvbnMgPSB7XG5cdFx0XHRzdWNjZXNzOnN1Y2Nlc3MsXG5cdFx0XHRjYW5jZWw6Y2FuY2VsXG5cdFx0fTtcblx0XHRcblx0XHR0aGlzLl9kZXByZWNhdGVkT3B0aW9uc0NoZWNrKCk7XG5cdFx0dGhpcy5faW5pdGlhbGl6ZVZhbHVlKCk7XG5cdFx0XG5cdFx0b25SZW5kZXJlZCh0aGlzLl9vblJlbmRlcmVkLmJpbmQodGhpcykpO1xuXHR9XG5cdFxuXHRfZGVwcmVjYXRlZE9wdGlvbnNDaGVjaygpe1xuXHRcdC8vIGlmKHRoaXMucGFyYW1zLmxpc3RJdGVtRm9ybWF0dGVyKXtcblx0XHQvLyBcdHRoaXMuY2VsbC5nZXRUYWJsZSgpLmRlcHJlY2F0aW9uQWR2aXNvci5tc2coXCJUaGUgbGlzdEl0ZW1Gb3JtYXR0ZXIgZWRpdG9yIHBhcmFtIGhhcyBiZWVuIGRlcHJlY2F0ZWQsIHBsZWFzZSBzZWUgdGhlIGxhdGVzdCBlZGl0b3IgZG9jdW1lbnRhdGlvbiBmb3IgdXBkYXRlZCBvcHRpb25zXCIpO1xuXHRcdC8vIH1cblx0XHRcblx0XHQvLyBpZih0aGlzLnBhcmFtcy5zb3J0VmFsdWVzTGlzdCl7XG5cdFx0Ly8gXHR0aGlzLmNlbGwuZ2V0VGFibGUoKS5kZXByZWNhdGlvbkFkdmlzb3IubXNnKFwiVGhlIHNvcnRWYWx1ZXNMaXN0IGVkaXRvciBwYXJhbSBoYXMgYmVlbiBkZXByZWNhdGVkLCBwbGVhc2Ugc2VlIHRoZSBsYXRlc3QgZWRpdG9yIGRvY3VtZW50YXRpb24gZm9yIHVwZGF0ZWQgb3B0aW9uc1wiKTtcblx0XHQvLyB9XG5cdFx0XG5cdFx0Ly8gaWYodGhpcy5wYXJhbXMuc2VhcmNoRnVuYyl7XG5cdFx0Ly8gXHR0aGlzLmNlbGwuZ2V0VGFibGUoKS5kZXByZWNhdGlvbkFkdmlzb3IubXNnKFwiVGhlIHNlYXJjaEZ1bmMgZWRpdG9yIHBhcmFtIGhhcyBiZWVuIGRlcHJlY2F0ZWQsIHBsZWFzZSBzZWUgdGhlIGxhdGVzdCBlZGl0b3IgZG9jdW1lbnRhdGlvbiBmb3IgdXBkYXRlZCBvcHRpb25zXCIpO1xuXHRcdC8vIH1cblx0XHRcblx0XHQvLyBpZih0aGlzLnBhcmFtcy5zZWFyY2hpbmdQbGFjZWhvbGRlcil7XG5cdFx0Ly8gXHR0aGlzLmNlbGwuZ2V0VGFibGUoKS5kZXByZWNhdGlvbkFkdmlzb3IubXNnKFwiVGhlIHNlYXJjaGluZ1BsYWNlaG9sZGVyIGVkaXRvciBwYXJhbSBoYXMgYmVlbiBkZXByZWNhdGVkLCBwbGVhc2Ugc2VlIHRoZSBsYXRlc3QgZWRpdG9yIGRvY3VtZW50YXRpb24gZm9yIHVwZGF0ZWQgb3B0aW9uc1wiKTtcblx0XHQvLyB9XG5cdH1cblx0XG5cdF9pbml0aWFsaXplVmFsdWUoKXtcblx0XHR2YXIgaW5pdGlhbFZhbHVlID0gdGhpcy5jZWxsLmdldFZhbHVlKCk7XG5cdFx0XG5cdFx0aWYodHlwZW9mIGluaXRpYWxWYWx1ZSA9PT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgdGhpcy5wYXJhbXMuZGVmYXVsdFZhbHVlICE9PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdGluaXRpYWxWYWx1ZSA9IHRoaXMucGFyYW1zLmRlZmF1bHRWYWx1ZTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5pbml0aWFsVmFsdWVzID0gdGhpcy5wYXJhbXMubXVsdGlzZWxlY3QgPyBpbml0aWFsVmFsdWUgOiBbaW5pdGlhbFZhbHVlXTtcblx0XHRcblx0XHRpZih0aGlzLmlzRmlsdGVyKXtcblx0XHRcdHRoaXMuaW5wdXQudmFsdWUgPSB0aGlzLmluaXRpYWxWYWx1ZXMgPyB0aGlzLmluaXRpYWxWYWx1ZXMuam9pbihcIixcIikgOiBcIlwiO1xuXHRcdFx0dGhpcy5oZWFkZXJGaWx0ZXJJbml0aWFsTGlzdEdlbigpOyAgICAgICAgICAgIFxuXHRcdH1cblx0fVxuXHRcblx0X29uUmVuZGVyZWQoKXtcblx0XHR2YXIgY2VsbEVsID0gdGhpcy5jZWxsLmdldEVsZW1lbnQoKTtcblx0XHRcblx0XHRmdW5jdGlvbiBjbGlja1N0b3AoZSl7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdH1cdFxuXHRcdFxuXHRcdGlmKCF0aGlzLmlzRmlsdGVyKXtcblx0XHRcdHRoaXMuaW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdFx0XHR0aGlzLmlucHV0LmZvY3VzKHtwcmV2ZW50U2Nyb2xsOiB0cnVlfSk7XG5cdFx0fVxuXHRcdFxuXHRcdFxuXHRcdGNlbGxFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2tTdG9wKTtcblx0XHRcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGNlbGxFbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2tTdG9wKTtcblx0XHR9LCAxMDAwKTtcblx0XHRcblx0XHR0aGlzLmlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5fcHJldmVudFBvcHVwQmx1ci5iaW5kKHRoaXMpKTtcblx0fVxuXHRcblx0X2NyZWF0ZUxpc3RFbGVtZW50KCl7XG5cdFx0dmFyIGxpc3RFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0bGlzdEVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZWRpdC1saXN0XCIpO1xuXHRcdFxuXHRcdGxpc3RFbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX3ByZXZlbnRCbHVyLmJpbmQodGhpcykpO1xuXHRcdGxpc3RFbC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9pbnB1dEtleURvd24uYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0cmV0dXJuIGxpc3RFbDtcblx0fVxuXHRcblx0X3NldExpc3RXaWR0aCgpe1xuXHRcdHZhciBlbGVtZW50ID0gdGhpcy5pc0ZpbHRlciA/IHRoaXMuaW5wdXQgOiB0aGlzLmNlbGwuZ2V0RWxlbWVudCgpO1xuXHRcdFxuXHRcdHRoaXMubGlzdEVsLnN0eWxlLm1pbldpZHRoID0gZWxlbWVudC5vZmZzZXRXaWR0aCArIFwicHhcIjtcblx0XHRcblx0XHRpZih0aGlzLnBhcmFtcy5tYXhXaWR0aCl7XG5cdFx0XHRpZih0aGlzLnBhcmFtcy5tYXhXaWR0aCA9PT0gdHJ1ZSl7XG5cdFx0XHRcdHRoaXMubGlzdEVsLnN0eWxlLm1heFdpZHRoID0gZWxlbWVudC5vZmZzZXRXaWR0aCArIFwicHhcIjtcblx0XHRcdH1lbHNlIGlmKHR5cGVvZiB0aGlzLnBhcmFtcy5tYXhXaWR0aCA9PT0gXCJudW1iZXJcIil7XG5cdFx0XHRcdHRoaXMubGlzdEVsLnN0eWxlLm1heFdpZHRoID0gdGhpcy5wYXJhbXMubWF4V2lkdGggKyBcInB4XCI7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMubGlzdEVsLnN0eWxlLm1heFdpZHRoID0gdGhpcy5wYXJhbXMubWF4V2lkdGg7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHR9XG5cdFxuXHRfY3JlYXRlSW5wdXRFbGVtZW50KCl7XG5cdFx0dmFyIGF0dHJpYnMgPSB0aGlzLnBhcmFtcy5lbGVtZW50QXR0cmlidXRlcztcblx0XHR2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG5cdFx0XG5cdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCB0aGlzLnBhcmFtcy5jbGVhcmFibGUgPyBcInNlYXJjaFwiIDogXCJ0ZXh0XCIpO1xuXHRcdFxuXHRcdGlucHV0LnN0eWxlLnBhZGRpbmcgPSBcIjRweFwiO1xuXHRcdGlucHV0LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cdFx0aW5wdXQuc3R5bGUuYm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XG5cdFx0XG5cdFx0aWYoIXRoaXMucGFyYW1zLmF1dG9jb21wbGV0ZSl7XG5cdFx0XHRpbnB1dC5zdHlsZS5jdXJzb3IgPSBcImRlZmF1bHRcIjtcblx0XHRcdGlucHV0LnN0eWxlLmNhcmV0Q29sb3IgPSBcInRyYW5zcGFyZW50XCI7XG5cdFx0XHQvLyBpbnB1dC5yZWFkT25seSA9ICh0aGlzLmVkaXQuY3VycmVudENlbGwgIT0gZmFsc2UpO1xuXHRcdH1cblx0XHRcblx0XHRpZihhdHRyaWJzICYmIHR5cGVvZiBhdHRyaWJzID09IFwib2JqZWN0XCIpe1xuXHRcdFx0Zm9yIChsZXQga2V5IGluIGF0dHJpYnMpe1xuXHRcdFx0XHRpZihrZXkuY2hhckF0KDApID09IFwiK1wiKXtcblx0XHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgaW5wdXQuZ2V0QXR0cmlidXRlKGtleSkgKyBhdHRyaWJzW1wiK1wiICsga2V5XSk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyaWJzW2tleV0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMucGFyYW1zLm1hc2spe1xuXHRcdFx0bWFza0lucHV0KGlucHV0LCB0aGlzLnBhcmFtcyk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuX2JpbmRJbnB1dEV2ZW50cyhpbnB1dCk7XG5cdFx0XG5cdFx0cmV0dXJuIGlucHV0O1xuXHR9XG5cdFxuXHRfaW5pdGlhbGl6ZVBhcmFtcyhwYXJhbXMpe1xuXHRcdHZhciB2YWx1ZUtleXMgPSBbXCJ2YWx1ZXNcIiwgXCJ2YWx1ZXNVUkxcIiwgXCJ2YWx1ZXNMb29rdXBcIl0sXG5cdFx0dmFsdWVDaGVjaztcblx0XHRcblx0XHRwYXJhbXMgPSBPYmplY3QuYXNzaWduKHt9LCBwYXJhbXMpO1xuXHRcdFxuXHRcdHBhcmFtcy52ZXJ0aWNhbE5hdmlnYXRpb24gPSBwYXJhbXMudmVydGljYWxOYXZpZ2F0aW9uIHx8IFwiZWRpdG9yXCI7XG5cdFx0cGFyYW1zLnBsYWNlaG9sZGVyTG9hZGluZyA9IHR5cGVvZiBwYXJhbXMucGxhY2Vob2xkZXJMb2FkaW5nID09PSBcInVuZGVmaW5lZFwiID8gXCJTZWFyY2hpbmcgLi4uXCIgOiBwYXJhbXMucGxhY2Vob2xkZXJMb2FkaW5nO1xuXHRcdHBhcmFtcy5wbGFjZWhvbGRlckVtcHR5ID0gdHlwZW9mIHBhcmFtcy5wbGFjZWhvbGRlckVtcHR5ID09PSBcInVuZGVmaW5lZFwiID8gXCJObyBSZXN1bHRzIEZvdW5kXCIgOiBwYXJhbXMucGxhY2Vob2xkZXJFbXB0eTtcblx0XHRwYXJhbXMuZmlsdGVyRGVsYXkgPSB0eXBlb2YgcGFyYW1zLmZpbHRlckRlbGF5ID09PSBcInVuZGVmaW5lZFwiID8gMzAwIDogcGFyYW1zLmZpbHRlckRlbGF5O1xuXHRcdFxuXHRcdHBhcmFtcy5lbXB0eVZhbHVlID0gT2JqZWN0LmtleXMocGFyYW1zKS5pbmNsdWRlcyhcImVtcHR5VmFsdWVcIikgPyBwYXJhbXMuZW1wdHlWYWx1ZSA6IFwiXCI7XG5cdFx0XG5cdFx0dmFsdWVDaGVjayA9IE9iamVjdC5rZXlzKHBhcmFtcykuZmlsdGVyKGtleSA9PiB2YWx1ZUtleXMuaW5jbHVkZXMoa2V5KSkubGVuZ3RoO1xuXHRcdFxuXHRcdGlmKCF2YWx1ZUNoZWNrKXtcblx0XHRcdGNvbnNvbGUud2FybihcImxpc3QgZWRpdG9yIGNvbmZpZyBlcnJvciAtIGVpdGhlciB0aGUgdmFsdWVzLCB2YWx1ZXNVUkwsIG9yIHZhbHVlc0xvb2t1cCBvcHRpb24gbXVzdCBiZSBzZXRcIik7XG5cdFx0fWVsc2UgaWYodmFsdWVDaGVjayA+IDEpe1xuXHRcdFx0Y29uc29sZS53YXJuKFwibGlzdCBlZGl0b3IgY29uZmlnIGVycm9yIC0gb25seSBvbmUgb2YgdGhlIHZhbHVlcywgdmFsdWVzVVJMLCBvciB2YWx1ZXNMb29rdXAgb3B0aW9ucyBjYW4gYmUgc2V0IG9uIHRoZSBzYW1lIGVkaXRvclwiKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYocGFyYW1zLmF1dG9jb21wbGV0ZSl7XG5cdFx0XHRpZihwYXJhbXMubXVsdGlzZWxlY3Qpe1xuXHRcdFx0XHRwYXJhbXMubXVsdGlzZWxlY3QgPSBmYWxzZTtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwibGlzdCBlZGl0b3IgY29uZmlnIGVycm9yIC0gbXVsdGlzZWxlY3Qgb3B0aW9uIGlzIG5vdCBhdmFpbGFibGUgd2hlbiBhdXRvY29tcGxldGUgaXMgZW5hYmxlZFwiKTtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRpZihwYXJhbXMuZnJlZXRleHQpe1xuXHRcdFx0XHRwYXJhbXMuZnJlZXRleHQgPSBmYWxzZTtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwibGlzdCBlZGl0b3IgY29uZmlnIGVycm9yIC0gZnJlZXRleHQgb3B0aW9uIGlzIG9ubHkgYXZhaWxhYmxlIHdoZW4gYXV0b2NvbXBsZXRlIGlzIGVuYWJsZWRcIik7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKHBhcmFtcy5maWx0ZXJGdW5jKXtcblx0XHRcdFx0cGFyYW1zLmZpbHRlckZ1bmMgPSBmYWxzZTtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwibGlzdCBlZGl0b3IgY29uZmlnIGVycm9yIC0gZmlsdGVyRnVuYyBvcHRpb24gaXMgb25seSBhdmFpbGFibGUgd2hlbiBhdXRvY29tcGxldGUgaXMgZW5hYmxlZFwiKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYocGFyYW1zLmZpbHRlclJlbW90ZSl7XG5cdFx0XHRcdHBhcmFtcy5maWx0ZXJSZW1vdGUgPSBmYWxzZTtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwibGlzdCBlZGl0b3IgY29uZmlnIGVycm9yIC0gZmlsdGVyUmVtb3RlIG9wdGlvbiBpcyBvbmx5IGF2YWlsYWJsZSB3aGVuIGF1dG9jb21wbGV0ZSBpcyBlbmFibGVkXCIpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihwYXJhbXMubWFzayl7XG5cdFx0XHRcdHBhcmFtcy5tYXNrID0gZmFsc2U7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcImxpc3QgZWRpdG9yIGNvbmZpZyBlcnJvciAtIG1hc2sgb3B0aW9uIGlzIG9ubHkgYXZhaWxhYmxlIHdoZW4gYXV0b2NvbXBsZXRlIGlzIGVuYWJsZWRcIik7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKHBhcmFtcy5hbGxvd0VtcHR5KXtcblx0XHRcdFx0cGFyYW1zLmFsbG93RW1wdHkgPSBmYWxzZTtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwibGlzdCBlZGl0b3IgY29uZmlnIGVycm9yIC0gYWxsb3dFbXB0eSBvcHRpb24gaXMgb25seSBhdmFpbGFibGUgd2hlbiBhdXRvY29tcGxldGUgaXMgZW5hYmxlZFwiKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYocGFyYW1zLmxpc3RPbkVtcHR5KXtcblx0XHRcdFx0cGFyYW1zLmxpc3RPbkVtcHR5ID0gZmFsc2U7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcImxpc3QgZWRpdG9yIGNvbmZpZyBlcnJvciAtIGxpc3RPbkVtcHR5IG9wdGlvbiBpcyBvbmx5IGF2YWlsYWJsZSB3aGVuIGF1dG9jb21wbGV0ZSBpcyBlbmFibGVkXCIpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZihwYXJhbXMuZmlsdGVyUmVtb3RlICYmICEodHlwZW9mIHBhcmFtcy52YWx1ZXNMb29rdXAgPT09IFwiZnVuY3Rpb25cIiB8fCBwYXJhbXMudmFsdWVzVVJMKSl7XG5cdFx0XHRwYXJhbXMuZmlsdGVyUmVtb3RlID0gZmFsc2U7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJsaXN0IGVkaXRvciBjb25maWcgZXJyb3IgLSBmaWx0ZXJSZW1vdGUgb3B0aW9uIHNob3VsZCBvbmx5IGJlIHVzZWQgd2hlbiB2YWx1ZXMgbGlzdCBpcyBwb3B1bGF0ZWQgZnJvbSBhIHJlbW90ZSBzb3VyY2VcIik7XG5cdFx0fVxuXHRcdHJldHVybiBwYXJhbXM7XG5cdH1cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLyBFdmVudCBIYW5kbGluZyAvLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdF9iaW5kSW5wdXRFdmVudHMoaW5wdXQpe1xuXHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCB0aGlzLl9pbnB1dEZvY3VzLmJpbmQodGhpcykpO1xuXHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9pbnB1dENsaWNrLmJpbmQodGhpcykpO1xuXHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIHRoaXMuX2lucHV0Qmx1ci5iaW5kKHRoaXMpKTtcblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9pbnB1dEtleURvd24uYmluZCh0aGlzKSk7XG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcInNlYXJjaFwiLCB0aGlzLl9pbnB1dFNlYXJjaC5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHRpZih0aGlzLnBhcmFtcy5hdXRvY29tcGxldGUpe1xuXHRcdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2lucHV0S2V5VXAuYmluZCh0aGlzKSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRcblx0X2lucHV0Rm9jdXMoZSl7XG5cdFx0dGhpcy5yZWJ1aWxkT3B0aW9uc0xpc3QoKTtcblx0fVxuXHRcblx0X2ZpbHRlcigpe1xuXHRcdGlmKHRoaXMucGFyYW1zLmZpbHRlclJlbW90ZSl7XG5cdFx0XHRjbGVhclRpbWVvdXQodGhpcy5maWx0ZXJUaW1lb3V0KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5maWx0ZXJUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMucmVidWlsZE9wdGlvbnNMaXN0KCk7XG5cdFx0XHR9LCB0aGlzLnBhcmFtcy5maWx0ZXJEZWxheSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5fZmlsdGVyTGlzdCgpO1xuXHRcdH1cblx0fVxuXHRcblx0X2lucHV0Q2xpY2soZSl7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0fVxuXHRcblx0X2lucHV0Qmx1cihlKXtcblx0XHRpZih0aGlzLmJsdXJhYmxlKXtcblx0XHRcdGlmKHRoaXMucG9wdXApe1xuXHRcdFx0XHR0aGlzLnBvcHVwLmhpZGUoKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5fcmVzb2x2ZVZhbHVlKHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0X2lucHV0U2VhcmNoKCl7XG5cdFx0dGhpcy5fY2xlYXJDaG9pY2VzKCk7XG5cdH1cblx0XG5cdF9pbnB1dEtleURvd24oZSl7XG5cdFx0c3dpdGNoKGUua2V5Q29kZSl7XG5cdFx0XHRcblx0XHRcdGNhc2UgMzg6IC8vdXAgYXJyb3dcblx0XHRcdFx0dGhpcy5fa2V5VXAoZSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIDQwOiAvL2Rvd24gYXJyb3dcblx0XHRcdFx0dGhpcy5fa2V5RG93bihlKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcblx0XHRcdGNhc2UgMzc6IC8vbGVmdCBhcnJvd1xuXHRcdFx0Y2FzZSAzOTogLy9yaWdodCBhcnJvd1xuXHRcdFx0XHR0aGlzLl9rZXlTaWRlKGUpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSAxMzogLy9lbnRlclxuXHRcdFx0XHR0aGlzLl9rZXlFbnRlcigpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSAyNzogLy9lc2NhcGVcblx0XHRcdFx0dGhpcy5fa2V5RXNjKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIDM2OiAvL2hvbWVcblx0XHRcdGNhc2UgMzU6IC8vZW5kXG5cdFx0XHRcdHRoaXMuX2tleUhvbWVFbmQoZSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIDk6IC8vdGFiXG5cdFx0XHRcdHRoaXMuX2tleVRhYihlKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHRoaXMuX2tleVNlbGVjdExldHRlcihlKTtcblx0XHR9XG5cdH1cblx0XG5cdF9pbnB1dEtleVVwKGUpe1xuXHRcdHN3aXRjaChlLmtleUNvZGUpe1xuXHRcdFx0Y2FzZSAzODogLy91cCBhcnJvd1xuXHRcdFx0Y2FzZSAzNzogLy9sZWZ0IGFycm93XG5cdFx0XHRjYXNlIDM5OiAvL3VwIGFycm93XG5cdFx0XHRjYXNlIDQwOiAvL3JpZ2h0IGFycm93XG5cdFx0XHRjYXNlIDEzOiAvL2VudGVyXG5cdFx0XHRjYXNlIDI3OiAvL2VzY2FwZVxuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0dGhpcy5fa2V5QXV0b0NvbXBMZXR0ZXIoZSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRfcHJldmVudFBvcHVwQmx1cigpe1xuXHRcdGlmKHRoaXMucG9wdXApe1xuXHRcdFx0dGhpcy5wb3B1cC5ibG9ja0hpZGUoKTtcblx0XHR9XG5cdFx0XG5cdFx0c2V0VGltZW91dCgoKSA9Pntcblx0XHRcdGlmKHRoaXMucG9wdXApe1xuXHRcdFx0XHR0aGlzLnBvcHVwLnJlc3RvcmVIaWRlKCk7XG5cdFx0XHR9XG5cdFx0fSwgMTApO1xuXHR9XG5cdFxuXHRfcHJldmVudEJsdXIoKXtcblx0XHR0aGlzLmJsdXJhYmxlID0gZmFsc2U7XG5cdFx0XG5cdFx0c2V0VGltZW91dCgoKSA9Pntcblx0XHRcdHRoaXMuYmx1cmFibGUgPSB0cnVlO1xuXHRcdH0sIDEwKTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8gS2V5Ym9hcmQgTmF2aWdhdGlvbiAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdF9rZXlUYWIoZSl7XG5cdFx0aWYodGhpcy5wYXJhbXMuYXV0b2NvbXBsZXRlICYmIHRoaXMubGFzdEFjdGlvbiA9PT0gXCJ0eXBpbmdcIil7XG5cdFx0XHR0aGlzLl9yZXNvbHZlVmFsdWUodHJ1ZSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYodGhpcy5mb2N1c2VkSXRlbSl7XG5cdFx0XHRcdHRoaXMuX2Nob29zZUl0ZW0odGhpcy5mb2N1c2VkSXRlbSwgdHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRfa2V5VXAoZSl7XG5cdFx0dmFyIGluZGV4ID0gdGhpcy5kaXNwbGF5SXRlbXMuaW5kZXhPZih0aGlzLmZvY3VzZWRJdGVtKTtcblx0XHRcblx0XHRpZih0aGlzLnBhcmFtcy52ZXJ0aWNhbE5hdmlnYXRpb24gPT0gXCJlZGl0b3JcIiB8fCAodGhpcy5wYXJhbXMudmVydGljYWxOYXZpZ2F0aW9uID09IFwiaHlicmlkXCIgJiYgaW5kZXgpKXtcblx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XG5cdFx0XHRpZihpbmRleCA+IDApe1xuXHRcdFx0XHR0aGlzLl9mb2N1c0l0ZW0odGhpcy5kaXNwbGF5SXRlbXNbaW5kZXggLSAxXSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRfa2V5RG93bihlKXtcblx0XHR2YXIgaW5kZXggPSB0aGlzLmRpc3BsYXlJdGVtcy5pbmRleE9mKHRoaXMuZm9jdXNlZEl0ZW0pO1xuXHRcdFxuXHRcdGlmKHRoaXMucGFyYW1zLnZlcnRpY2FsTmF2aWdhdGlvbiA9PSBcImVkaXRvclwiIHx8ICh0aGlzLnBhcmFtcy52ZXJ0aWNhbE5hdmlnYXRpb24gPT0gXCJoeWJyaWRcIiAmJiBpbmRleCA8IHRoaXMuZGlzcGxheUl0ZW1zLmxlbmd0aCAtIDEpKXtcblx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XG5cdFx0XHRpZihpbmRleCA8IHRoaXMuZGlzcGxheUl0ZW1zLmxlbmd0aCAtIDEpe1xuXHRcdFx0XHRpZihpbmRleCA9PSAtMSl7XG5cdFx0XHRcdFx0dGhpcy5fZm9jdXNJdGVtKHRoaXMuZGlzcGxheUl0ZW1zWzBdKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuX2ZvY3VzSXRlbSh0aGlzLmRpc3BsYXlJdGVtc1tpbmRleCArIDFdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0X2tleVNpZGUoZSl7XG5cdFx0aWYoIXRoaXMucGFyYW1zLmF1dG9jb21wbGV0ZSl7XG5cdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHR9XG5cdH1cblx0XG5cdF9rZXlFbnRlcihlKXtcblx0XHRpZih0aGlzLnBhcmFtcy5hdXRvY29tcGxldGUgJiYgdGhpcy5sYXN0QWN0aW9uID09PSBcInR5cGluZ1wiKXtcblx0XHRcdHRoaXMuX3Jlc29sdmVWYWx1ZSh0cnVlKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZih0aGlzLmZvY3VzZWRJdGVtKXtcblx0XHRcdFx0dGhpcy5fY2hvb3NlSXRlbSh0aGlzLmZvY3VzZWRJdGVtKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdF9rZXlFc2MoZSl7XG5cdFx0dGhpcy5fY2FuY2VsKCk7XG5cdH1cblx0XG5cdF9rZXlIb21lRW5kKGUpe1xuXHRcdGlmKHRoaXMucGFyYW1zLmF1dG9jb21wbGV0ZSl7XG5cdFx0XHQvL3ByZXZlbnQgdGFibGUgbmF2aWdhdGlvbiB3aGlsZSB1c2luZyBpbnB1dCBlbGVtZW50XG5cdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdH1cblx0fVxuXHRcblx0X2tleVNlbGVjdExldHRlcihlKXtcblx0XHRpZighdGhpcy5wYXJhbXMuYXV0b2NvbXBsZXRlKXtcblx0XHRcdC8vIGlmKHRoaXMuZWRpdC5jdXJyZW50Q2VsbCA9PT0gZmFsc2Upe1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Ly8gfVxuXHRcdFx0XG5cdFx0XHRpZihlLmtleUNvZGUgPj0gMzggJiYgZS5rZXlDb2RlIDw9IDkwKXtcblx0XHRcdFx0dGhpcy5fc2Nyb2xsVG9WYWx1ZShlLmtleUNvZGUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0X2tleUF1dG9Db21wTGV0dGVyKGUpe1xuXHRcdHRoaXMuX2ZpbHRlcigpO1xuXHRcdHRoaXMubGFzdEFjdGlvbiA9IFwidHlwaW5nXCI7XG5cdFx0dGhpcy50eXBpbmcgPSB0cnVlO1xuXHR9XG5cdFxuXHRcblx0X3Njcm9sbFRvVmFsdWUoY2hhcil7XG5cdFx0Y2xlYXJUaW1lb3V0KHRoaXMuZmlsdGVyVGltZW91dCk7XG5cdFx0XG5cdFx0dmFyIGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhcikudG9Mb3dlckNhc2UoKTtcblx0XHR0aGlzLmZpbHRlclRlcm0gKz0gY2hhcmFjdGVyLnRvTG93ZXJDYXNlKCk7XG5cdFx0XG5cdFx0dmFyIG1hdGNoID0gdGhpcy5kaXNwbGF5SXRlbXMuZmluZCgoaXRlbSkgPT4ge1xuXHRcdFx0cmV0dXJuIHR5cGVvZiBpdGVtLmxhYmVsICE9PSBcInVuZGVmaW5lZFwiICYmIGl0ZW0ubGFiZWwudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKHRoaXMuZmlsdGVyVGVybSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0aWYobWF0Y2gpe1xuXHRcdFx0dGhpcy5fZm9jdXNJdGVtKG1hdGNoKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5maWx0ZXJUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0aGlzLmZpbHRlclRlcm0gPSBcIlwiO1xuXHRcdH0sIDgwMCk7XG5cdH1cblx0XG5cdF9mb2N1c0l0ZW0oaXRlbSl7XG5cdFx0dGhpcy5sYXN0QWN0aW9uID0gXCJmb2N1c1wiO1xuXHRcdFxuXHRcdGlmKHRoaXMuZm9jdXNlZEl0ZW0gJiYgdGhpcy5mb2N1c2VkSXRlbS5lbGVtZW50KXtcblx0XHRcdHRoaXMuZm9jdXNlZEl0ZW0uZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZm9jdXNlZFwiKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5mb2N1c2VkSXRlbSA9IGl0ZW07XG5cdFx0XG5cdFx0aWYoaXRlbSAmJiBpdGVtLmVsZW1lbnQpe1xuXHRcdFx0aXRlbS5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJmb2N1c2VkXCIpO1xuXHRcdFx0aXRlbS5lbGVtZW50LnNjcm9sbEludG9WaWV3KHtiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnbmVhcmVzdCcsIGlubGluZTogJ3N0YXJ0J30pO1xuXHRcdH1cblx0fVxuXHRcblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8gRGF0YSBMaXN0IEdlbmVyYXRpb24gLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdGhlYWRlckZpbHRlckluaXRpYWxMaXN0R2VuKCl7XG5cdFx0dGhpcy5fZ2VuZXJhdGVPcHRpb25zKHRydWUpO1xuXHR9XG5cdFxuXHRyZWJ1aWxkT3B0aW9uc0xpc3QoKXtcblx0XHR0aGlzLl9nZW5lcmF0ZU9wdGlvbnMoKVxuXHRcdFx0LnRoZW4odGhpcy5fc29ydE9wdGlvbnMuYmluZCh0aGlzKSlcblx0XHRcdC50aGVuKHRoaXMuX2J1aWxkTGlzdC5iaW5kKHRoaXMpKVxuXHRcdFx0LnRoZW4odGhpcy5fc2hvd0xpc3QuYmluZCh0aGlzKSlcblx0XHRcdC5jYXRjaCgoZSkgPT4ge1xuXHRcdFx0XHRpZighTnVtYmVyLmlzSW50ZWdlcihlKSl7XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcihcIkxpc3QgZ2VuZXJhdGlvbiBlcnJvclwiLCBlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdH1cblx0XG5cdF9maWx0ZXJMaXN0KCl7XG5cdFx0dGhpcy5fYnVpbGRMaXN0KHRoaXMuX2ZpbHRlck9wdGlvbnMoKSk7XG5cdFx0dGhpcy5fc2hvd0xpc3QoKTtcblx0fVxuXHRcblx0X2dlbmVyYXRlT3B0aW9ucyhzaWxlbnQpe1xuXHRcdHZhciB2YWx1ZXMgPSBbXTtcblx0XHR2YXIgaXRlcmF0aW9uID0gKysgdGhpcy5saXN0SXRlcmF0aW9uO1xuXHRcdFxuXHRcdHRoaXMuZmlsdGVyZWQgPSBmYWxzZTtcblx0XHRcblx0XHRpZih0aGlzLnBhcmFtcy52YWx1ZXMpe1xuXHRcdFx0dmFsdWVzID0gdGhpcy5wYXJhbXMudmFsdWVzO1xuXHRcdH1lbHNlIGlmICh0aGlzLnBhcmFtcy52YWx1ZXNVUkwpe1xuXHRcdFx0dmFsdWVzID0gdGhpcy5fYWpheFJlcXVlc3QodGhpcy5wYXJhbXMudmFsdWVzVVJMLCB0aGlzLmlucHV0LnZhbHVlKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZih0eXBlb2YgdGhpcy5wYXJhbXMudmFsdWVzTG9va3VwID09PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0XHR2YWx1ZXMgPSB0aGlzLnBhcmFtcy52YWx1ZXNMb29rdXAodGhpcy5jZWxsLCB0aGlzLmlucHV0LnZhbHVlKTtcblx0XHRcdH1lbHNlIGlmKHRoaXMucGFyYW1zLnZhbHVlc0xvb2t1cCl7XG5cdFx0XHRcdHZhbHVlcyA9IHRoaXMuX3VuaXF1ZUNvbHVtblZhbHVlcyh0aGlzLnBhcmFtcy52YWx1ZXNMb29rdXBGaWVsZCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHZhbHVlcyBpbnN0YW5jZW9mIFByb21pc2Upe1xuXHRcdFx0aWYoIXNpbGVudCl7XG5cdFx0XHRcdHRoaXMuX2FkZFBsYWNlaG9sZGVyKHRoaXMucGFyYW1zLnBsYWNlaG9sZGVyTG9hZGluZyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiB2YWx1ZXMudGhlbigpXG5cdFx0XHRcdC50aGVuKChyZXNwb25zZVZhbHVlcykgPT4ge1xuXHRcdFx0XHRcdGlmKHRoaXMubGlzdEl0ZXJhdGlvbiA9PT0gaXRlcmF0aW9uKXtcblx0XHRcdFx0XHRcdHJldHVybiB0aGlzLl9wYXJzZUxpc3QocmVzcG9uc2VWYWx1ZXMpO1xuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChpdGVyYXRpb24pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9wYXJzZUxpc3QodmFsdWVzKSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRfYWRkUGxhY2Vob2xkZXIoY29udGVudHMpe1xuXHRcdHZhciBwbGFjZWhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XG5cdFx0aWYodHlwZW9mIGNvbnRlbnRzID09PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0Y29udGVudHMgPSBjb250ZW50cyh0aGlzLmNlbGwuZ2V0Q29tcG9uZW50KCksIHRoaXMubGlzdEVsKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoY29udGVudHMpe1xuXHRcdFx0dGhpcy5fY2xlYXJMaXN0KCk7XG5cdFx0XHRcblx0XHRcdGlmKGNvbnRlbnRzIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpe1xuXHRcdFx0XHRwbGFjZWhvbGRlciA9IGNvbnRlbnRzO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRwbGFjZWhvbGRlci5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWVkaXQtbGlzdC1wbGFjZWhvbGRlclwiKTtcblx0XHRcdFx0cGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gY29udGVudHM7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMubGlzdEVsLmFwcGVuZENoaWxkKHBsYWNlaG9sZGVyKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5fc2hvd0xpc3QoKTtcblx0XHR9XG5cdH1cblx0XG5cdF9hamF4UmVxdWVzdCh1cmwsIHRlcm0pe1xuXHRcdHZhciBwYXJhbXMgPSB0aGlzLnBhcmFtcy5maWx0ZXJSZW1vdGUgPyB7dGVybTp0ZXJtfSA6IHt9O1xuXHRcdHVybCA9IHVybEJ1aWxkZXIodXJsLCB7fSwgcGFyYW1zKTtcblx0XHRcblx0XHRyZXR1cm4gZmV0Y2godXJsKVxuXHRcdFx0LnRoZW4oKHJlc3BvbnNlKT0+e1xuXHRcdFx0XHRpZihyZXNwb25zZS5vaykge1xuXHRcdFx0XHRcdHJldHVybiByZXNwb25zZS5qc29uKClcblx0XHRcdFx0XHRcdC5jYXRjaCgoZXJyb3IpPT57XG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkxpc3QgQWpheCBMb2FkIEVycm9yIC0gSW52YWxpZCBKU09OIHJldHVybmVkXCIsIGVycm9yKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcihcIkxpc3QgQWpheCBMb2FkIEVycm9yIC0gQ29ubmVjdGlvbiBFcnJvcjogXCIgKyByZXNwb25zZS5zdGF0dXMsIHJlc3BvbnNlLnN0YXR1c1RleHQpO1xuXHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwb25zZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0XHQuY2F0Y2goKGVycm9yKT0+e1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwiTGlzdCBBamF4IExvYWQgRXJyb3IgLSBDb25uZWN0aW9uIEVycm9yOiBcIiwgZXJyb3IpO1xuXHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuXHRcdFx0fSk7XG5cdH1cblx0XG5cdF91bmlxdWVDb2x1bW5WYWx1ZXMoZmllbGQpe1xuXHRcdHZhciBvdXRwdXQgPSB7fSxcblx0XHRkYXRhID0gdGhpcy50YWJsZS5nZXREYXRhKHRoaXMucGFyYW1zLnZhbHVlc0xvb2t1cCksXG5cdFx0Y29sdW1uO1xuXHRcdFxuXHRcdGlmKGZpZWxkKXtcblx0XHRcdGNvbHVtbiA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5CeUZpZWxkKGZpZWxkKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb2x1bW4gPSB0aGlzLmNlbGwuZ2V0Q29sdW1uKCkuX2dldFNlbGYoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoY29sdW1uKXtcblx0XHRcdGRhdGEuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdHZhciB2YWwgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShyb3cpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoIXRoaXMuX2VtcHR5VmFsdWVDaGVjayh2YWwpKXtcblx0XHRcdFx0XHRpZih0aGlzLnBhcmFtcy5tdWx0aXNlbGVjdCAmJiBBcnJheS5pc0FycmF5KHZhbCkpe1xuXHRcdFx0XHRcdFx0dmFsLmZvckVhY2goKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRcdFx0aWYoIXRoaXMuX2VtcHR5VmFsdWVDaGVjayhpdGVtKSl7XG5cdFx0XHRcdFx0XHRcdFx0b3V0cHV0W2l0ZW1dID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0b3V0cHV0W3ZhbF0gPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwidW5hYmxlIHRvIGZpbmQgbWF0Y2hpbmcgY29sdW1uIHRvIGNyZWF0ZSBzZWxlY3QgbG9va3VwIGxpc3Q6XCIsIGZpZWxkKTtcblx0XHRcdG91dHB1dCA9IFtdO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gT2JqZWN0LmtleXMob3V0cHV0KTtcblx0fVxuXG5cdF9lbXB0eVZhbHVlQ2hlY2sodmFsdWUpe1xuXHRcdHJldHVybiB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIgfHwgdmFsdWUgPT09IFwiXCI7XG5cdH1cblx0XG5cdF9wYXJzZUxpc3QoaW5wdXRWYWx1ZXMpe1xuXHRcdHZhciBkYXRhID0gW107XG5cdFx0XG5cdFx0aWYoIUFycmF5LmlzQXJyYXkoaW5wdXRWYWx1ZXMpKXtcblx0XHRcdGlucHV0VmFsdWVzID0gT2JqZWN0LmVudHJpZXMoaW5wdXRWYWx1ZXMpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0bGFiZWw6dmFsdWUsXG5cdFx0XHRcdFx0dmFsdWU6a2V5LFxuXHRcdFx0XHR9O1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlucHV0VmFsdWVzLmZvckVhY2goKHZhbHVlKSA9PiB7XG5cdFx0XHRpZih0eXBlb2YgdmFsdWUgIT09IFwib2JqZWN0XCIpe1xuXHRcdFx0XHR2YWx1ZSA9IHtcblx0XHRcdFx0XHRsYWJlbDp2YWx1ZSxcblx0XHRcdFx0XHR2YWx1ZTp2YWx1ZSxcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5fcGFyc2VMaXN0SXRlbSh2YWx1ZSwgZGF0YSwgMCk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0aWYoIXRoaXMuY3VycmVudEl0ZW1zLmxlbmd0aCAmJiB0aGlzLnBhcmFtcy5mcmVldGV4dCl7XG5cdFx0XHR0aGlzLmlucHV0LnZhbHVlID0gdGhpcy5pbml0aWFsVmFsdWVzO1xuXHRcdFx0dGhpcy50eXBpbmcgPSB0cnVlO1xuXHRcdFx0dGhpcy5sYXN0QWN0aW9uID0gXCJ0eXBpbmdcIjtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5kYXRhID0gZGF0YTtcblx0XHRcblx0XHRyZXR1cm4gZGF0YTsgICAgXG5cdH1cblx0XG5cdF9wYXJzZUxpc3RJdGVtKG9wdGlvbiwgZGF0YSwgbGV2ZWwpe1xuXHRcdHZhciBpdGVtID0ge307XG5cdFx0XG5cdFx0aWYob3B0aW9uLm9wdGlvbnMpe1xuXHRcdFx0aXRlbSA9IHRoaXMuX3BhcnNlTGlzdEdyb3VwKG9wdGlvbiwgbGV2ZWwgKyAxKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpdGVtID0ge1xuXHRcdFx0XHRsYWJlbDpvcHRpb24ubGFiZWwsXG5cdFx0XHRcdHZhbHVlOm9wdGlvbi52YWx1ZSxcblx0XHRcdFx0aXRlbVBhcmFtczpvcHRpb24uaXRlbVBhcmFtcyxcblx0XHRcdFx0ZWxlbWVudEF0dHJpYnV0ZXM6IG9wdGlvbi5lbGVtZW50QXR0cmlidXRlcyxcblx0XHRcdFx0ZWxlbWVudDpmYWxzZSxcblx0XHRcdFx0c2VsZWN0ZWQ6ZmFsc2UsXG5cdFx0XHRcdHZpc2libGU6dHJ1ZSxcblx0XHRcdFx0bGV2ZWw6bGV2ZWwsXG5cdFx0XHRcdG9yaWdpbmFsOm9wdGlvbixcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMuaW5pdGlhbFZhbHVlcyAmJiB0aGlzLmluaXRpYWxWYWx1ZXMuaW5kZXhPZihvcHRpb24udmFsdWUpID4gLTEpe1xuXHRcdFx0XHR0aGlzLl9jaG9vc2VJdGVtKGl0ZW0sIHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRkYXRhLnB1c2goaXRlbSk7XG5cdH1cblx0XG5cdF9wYXJzZUxpc3RHcm91cChvcHRpb24sIGxldmVsKXtcblx0XHR2YXIgaXRlbSA9IHtcblx0XHRcdGxhYmVsOm9wdGlvbi5sYWJlbCxcblx0XHRcdGdyb3VwOnRydWUsXG5cdFx0XHRpdGVtUGFyYW1zOm9wdGlvbi5pdGVtUGFyYW1zLFxuXHRcdFx0ZWxlbWVudEF0dHJpYnV0ZXM6b3B0aW9uLmVsZW1lbnRBdHRyaWJ1dGVzLFxuXHRcdFx0ZWxlbWVudDpmYWxzZSxcblx0XHRcdHZpc2libGU6dHJ1ZSxcblx0XHRcdGxldmVsOmxldmVsLFxuXHRcdFx0b3B0aW9uczpbXSxcblx0XHRcdG9yaWdpbmFsOm9wdGlvbixcblx0XHR9O1xuXHRcdFxuXHRcdG9wdGlvbi5vcHRpb25zLmZvckVhY2goKGNoaWxkKSA9PiB7XG5cdFx0XHR0aGlzLl9wYXJzZUxpc3RJdGVtKGNoaWxkLCBpdGVtLm9wdGlvbnMsIGxldmVsKTtcblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gaXRlbTtcblx0fVxuXHRcblx0X3NvcnRPcHRpb25zKG9wdGlvbnMpe1xuXHRcdHZhciBzb3J0ZXI7XG5cdFx0XG5cdFx0aWYodGhpcy5wYXJhbXMuc29ydCl7XG5cdFx0XHRzb3J0ZXIgPSB0eXBlb2YgdGhpcy5wYXJhbXMuc29ydCA9PT0gXCJmdW5jdGlvblwiID8gdGhpcy5wYXJhbXMuc29ydCA6IHRoaXMuX2RlZmF1bHRTb3J0RnVuY3Rpb24uYmluZCh0aGlzKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5fc29ydEdyb3VwKHNvcnRlciwgb3B0aW9ucyk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBvcHRpb25zO1xuXHR9XG5cdFxuXHRfc29ydEdyb3VwKHNvcnRlciwgb3B0aW9ucyl7XG5cdFx0b3B0aW9ucy5zb3J0KChhLGIpID0+IHtcblx0XHRcdHJldHVybiBzb3J0ZXIoYS5sYWJlbCwgYi5sYWJlbCwgYS52YWx1ZSwgYi52YWx1ZSwgYS5vcmlnaW5hbCwgYi5vcmlnaW5hbCk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0b3B0aW9ucy5mb3JFYWNoKChvcHRpb24pID0+IHtcblx0XHRcdGlmKG9wdGlvbi5ncm91cCl7XG5cdFx0XHRcdHRoaXMuX3NvcnRHcm91cChzb3J0ZXIsIG9wdGlvbi5vcHRpb25zKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0X2RlZmF1bHRTb3J0RnVuY3Rpb24oYXMsIGJzKXtcblx0XHR2YXIgYSwgYiwgYTEsIGIxLCBpPSAwLCBMLCByeCA9IC8oXFxkKyl8KFxcRCspL2csIHJkID0gL1xcZC87XG5cdFx0dmFyIGVtcHR5QWxpZ24gPSAwO1xuXHRcdFxuXHRcdGlmKHRoaXMucGFyYW1zLnNvcnQgPT09IFwiZGVzY1wiKXtcblx0XHRcdFthcywgYnNdID0gW2JzLCBhc107XG5cdFx0fVxuXHRcdFxuXHRcdC8vaGFuZGxlIGVtcHR5IHZhbHVlc1xuXHRcdGlmKCFhcyAmJiBhcyE9PSAwKXtcblx0XHRcdGVtcHR5QWxpZ24gPSAgIWJzICYmIGJzIT09IDAgPyAwIDogLTE7XG5cdFx0fWVsc2UgaWYoIWJzICYmIGJzIT09IDApe1xuXHRcdFx0ZW1wdHlBbGlnbiA9ICAxO1xuXHRcdH1lbHNlIHtcblx0XHRcdGlmKGlzRmluaXRlKGFzKSAmJiBpc0Zpbml0ZShicykpIHJldHVybiBhcyAtIGJzO1xuXHRcdFx0YSA9IFN0cmluZyhhcykudG9Mb3dlckNhc2UoKTtcblx0XHRcdGIgPSBTdHJpbmcoYnMpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRpZihhID09PSBiKSByZXR1cm4gMDtcblx0XHRcdGlmKCEocmQudGVzdChhKSAmJiByZC50ZXN0KGIpKSkgcmV0dXJuIGEgPiBiID8gMSA6IC0xO1xuXHRcdFx0YSA9IGEubWF0Y2gocngpO1xuXHRcdFx0YiA9IGIubWF0Y2gocngpO1xuXHRcdFx0TCA9IGEubGVuZ3RoID4gYi5sZW5ndGggPyBiLmxlbmd0aCA6IGEubGVuZ3RoO1xuXHRcdFx0d2hpbGUoaSA8IEwpe1xuXHRcdFx0XHRhMT0gYVtpXTtcblx0XHRcdFx0YjE9IGJbaSsrXTtcblx0XHRcdFx0aWYoYTEgIT09IGIxKXtcblx0XHRcdFx0XHRpZihpc0Zpbml0ZShhMSkgJiYgaXNGaW5pdGUoYjEpKXtcblx0XHRcdFx0XHRcdGlmKGExLmNoYXJBdCgwKSA9PT0gXCIwXCIpIGExID0gXCIuXCIgKyBhMTtcblx0XHRcdFx0XHRcdGlmKGIxLmNoYXJBdCgwKSA9PT0gXCIwXCIpIGIxID0gXCIuXCIgKyBiMTtcblx0XHRcdFx0XHRcdHJldHVybiBhMSAtIGIxO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIHJldHVybiBhMSA+IGIxID8gMSA6IC0xO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiBhLmxlbmd0aCA+IGIubGVuZ3RoO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gZW1wdHlBbGlnbjtcblx0fVxuXHRcblx0X2ZpbHRlck9wdGlvbnMoKXtcblx0XHR2YXIgZmlsdGVyRnVuYyA9IHRoaXMucGFyYW1zLmZpbHRlckZ1bmMgfHwgdGhpcy5fZGVmYXVsdEZpbHRlckZ1bmMsXG5cdFx0dGVybSA9IHRoaXMuaW5wdXQudmFsdWU7XG5cdFx0XG5cdFx0aWYodGVybSl7XG5cdFx0XHR0aGlzLmZpbHRlcmVkID0gdHJ1ZTtcblx0XHRcdFxuXHRcdFx0dGhpcy5kYXRhLmZvckVhY2goKGl0ZW0pID0+IHtcblx0XHRcdFx0dGhpcy5fZmlsdGVySXRlbShmaWx0ZXJGdW5jLCB0ZXJtLCBpdGVtKTtcblx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuZmlsdGVyZWQgPSBmYWxzZTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuZGF0YTtcblx0fVxuXHRcblx0X2ZpbHRlckl0ZW0oZnVuYywgdGVybSwgaXRlbSl7XG5cdFx0dmFyIG1hdGNoZXMgPSBmYWxzZTtcblx0XHRcblx0XHRpZighaXRlbS5ncm91cCl7XG5cdFx0XHRpdGVtLnZpc2libGUgPSBmdW5jKHRlcm0sIGl0ZW0ubGFiZWwsIGl0ZW0udmFsdWUsIGl0ZW0ub3JpZ2luYWwpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGl0ZW0ub3B0aW9ucy5mb3JFYWNoKChvcHRpb24pID0+IHtcblx0XHRcdFx0aWYodGhpcy5fZmlsdGVySXRlbShmdW5jLCB0ZXJtLCBvcHRpb24pKXtcblx0XHRcdFx0XHRtYXRjaGVzID0gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdGl0ZW0udmlzaWJsZSA9IG1hdGNoZXM7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBpdGVtLnZpc2libGU7XG5cdH1cblx0XG5cdF9kZWZhdWx0RmlsdGVyRnVuYyh0ZXJtLCBsYWJlbCwgdmFsdWUsIGl0ZW0pe1xuXHRcdHRlcm0gPSBTdHJpbmcodGVybSkudG9Mb3dlckNhc2UoKTtcblx0XHRcblx0XHRpZihsYWJlbCAhPT0gbnVsbCAmJiB0eXBlb2YgbGFiZWwgIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0aWYoU3RyaW5nKGxhYmVsKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGVybSkgPiAtMSB8fCBTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0ZXJtKSA+IC0xKXtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8gRGlzcGxheSBMaXN0IC8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdF9jbGVhckxpc3QoKXtcblx0XHR3aGlsZSh0aGlzLmxpc3RFbC5maXJzdENoaWxkKSB0aGlzLmxpc3RFbC5yZW1vdmVDaGlsZCh0aGlzLmxpc3RFbC5maXJzdENoaWxkKTtcblx0XHRcblx0XHR0aGlzLmRpc3BsYXlJdGVtcyA9IFtdO1xuXHR9XG5cdFxuXHRfYnVpbGRMaXN0KGRhdGEpe1xuXHRcdHRoaXMuX2NsZWFyTGlzdCgpO1xuXHRcdFxuXHRcdGRhdGEuZm9yRWFjaCgob3B0aW9uKSA9PiB7XG5cdFx0XHR0aGlzLl9idWlsZEl0ZW0ob3B0aW9uKTtcblx0XHR9KTtcblx0XHRcblx0XHRpZighdGhpcy5kaXNwbGF5SXRlbXMubGVuZ3RoKXtcblx0XHRcdHRoaXMuX2FkZFBsYWNlaG9sZGVyKHRoaXMucGFyYW1zLnBsYWNlaG9sZGVyRW1wdHkpO1xuXHRcdH0gIFxuXHR9XG5cdFxuXHRfYnVpbGRJdGVtKGl0ZW0pe1xuXHRcdHZhciBlbCA9IGl0ZW0uZWxlbWVudCxcblx0XHRjb250ZW50cztcblx0XHRcblx0XHRpZighdGhpcy5maWx0ZXJlZCB8fCBpdGVtLnZpc2libGUpe1xuXHRcdFx0XG5cdFx0XHRpZighZWwpe1xuXHRcdFx0XHRlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRcdGVsLnRhYkluZGV4ID0gMDtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbnRlbnRzID0gdGhpcy5wYXJhbXMuaXRlbUZvcm1hdHRlciA/IHRoaXMucGFyYW1zLml0ZW1Gb3JtYXR0ZXIoaXRlbS5sYWJlbCwgaXRlbS52YWx1ZSwgaXRlbS5vcmlnaW5hbCwgZWwpIDogaXRlbS5sYWJlbDtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGNvbnRlbnRzIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpe1xuXHRcdFx0XHRcdGVsLmFwcGVuZENoaWxkKGNvbnRlbnRzKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGVsLmlubmVySFRNTCA9IGNvbnRlbnRzO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihpdGVtLmdyb3VwKXtcblx0XHRcdFx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWVkaXQtbGlzdC1ncm91cFwiKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZWRpdC1saXN0LWl0ZW1cIik7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZWRpdC1saXN0LWdyb3VwLWxldmVsLVwiICsgaXRlbS5sZXZlbCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihpdGVtLmVsZW1lbnRBdHRyaWJ1dGVzICYmIHR5cGVvZiBpdGVtLmVsZW1lbnRBdHRyaWJ1dGVzID09IFwib2JqZWN0XCIpe1xuXHRcdFx0XHRcdGZvciAobGV0IGtleSBpbiBpdGVtLmVsZW1lbnRBdHRyaWJ1dGVzKXtcblx0XHRcdFx0XHRcdGlmKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpe1xuXHRcdFx0XHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdFx0XHRcdGVsLnNldEF0dHJpYnV0ZShrZXksIHRoaXMuaW5wdXQuZ2V0QXR0cmlidXRlKGtleSkgKyBpdGVtLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGVsLnNldEF0dHJpYnV0ZShrZXksIGl0ZW0uZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihpdGVtLmdyb3VwKXtcblx0XHRcdFx0XHRlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fZ3JvdXBDbGljay5iaW5kKHRoaXMsIGl0ZW0pKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9pdGVtQ2xpY2suYmluZCh0aGlzLCBpdGVtKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5fcHJldmVudEJsdXIuYmluZCh0aGlzKSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpdGVtLmVsZW1lbnQgPSBlbDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5fc3R5bGVJdGVtKGl0ZW0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmxpc3RFbC5hcHBlbmRDaGlsZChlbCk7XG5cdFx0XHRcblx0XHRcdGlmKGl0ZW0uZ3JvdXApe1xuXHRcdFx0XHRpdGVtLm9wdGlvbnMuZm9yRWFjaCgob3B0aW9uKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5fYnVpbGRJdGVtKG9wdGlvbik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmRpc3BsYXlJdGVtcy5wdXNoKGl0ZW0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0X3Nob3dMaXN0KCl7XG5cdFx0dmFyIHN0YXJ0VmlzID0gdGhpcy5wb3B1cCAmJiB0aGlzLnBvcHVwLmlzVmlzaWJsZSgpO1xuXHRcdFxuXHRcdGlmKHRoaXMuaW5wdXQucGFyZW50Tm9kZSl7XG5cdFx0XHRpZih0aGlzLnBhcmFtcy5hdXRvY29tcGxldGUgJiYgdGhpcy5pbnB1dC52YWx1ZSA9PT0gXCJcIiAmJiAhdGhpcy5wYXJhbXMubGlzdE9uRW1wdHkpe1xuXHRcdFx0XHRpZih0aGlzLnBvcHVwKXtcblx0XHRcdFx0XHR0aGlzLnBvcHVwLmhpZGUodHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLl9zZXRMaXN0V2lkdGgoKTtcblx0XHRcdFxuXHRcdFx0aWYoIXRoaXMucG9wdXApe1xuXHRcdFx0XHR0aGlzLnBvcHVwID0gdGhpcy5lZGl0LnBvcHVwKHRoaXMubGlzdEVsKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5wb3B1cC5zaG93KHRoaXMuY2VsbC5nZXRFbGVtZW50KCksIFwiYm90dG9tXCIpO1xuXHRcdFx0XG5cdFx0XHRpZighc3RhcnRWaXMpe1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBvcHVwLmhpZGVPbkJsdXIodGhpcy5fcmVzb2x2ZVZhbHVlLmJpbmQodGhpcywgdHJ1ZSkpO1xuXHRcdFx0XHR9LCAxMCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRfc3R5bGVJdGVtKGl0ZW0pe1xuXHRcdGlmKGl0ZW0gJiYgaXRlbS5lbGVtZW50KXtcblx0XHRcdGlmKGl0ZW0uc2VsZWN0ZWQpe1xuXHRcdFx0XHRpdGVtLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aXRlbS5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gVXNlciBJbnRlcmFjdGlvbiAvLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0X2l0ZW1DbGljayhpdGVtLCBlKXtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFxuXHRcdHRoaXMuX2Nob29zZUl0ZW0oaXRlbSk7XG5cdH1cblx0XG5cdF9ncm91cENsaWNrKGl0ZW0sIGUpe1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdH1cblx0XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8gQ3VycmVudCBJdGVtIE1hbmFnZW1lbnQgLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0X2NhbmNlbCgpe1xuXHRcdHRoaXMucG9wdXAuaGlkZSh0cnVlKTtcblx0XHR0aGlzLmFjdGlvbnMuY2FuY2VsKCk7XG5cdH1cblx0XG5cdF9jbGVhckNob2ljZXMoKXtcblx0XHR0aGlzLnR5cGluZyA9IHRydWU7XG5cdFx0XG5cdFx0dGhpcy5jdXJyZW50SXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXHRcdFx0aXRlbS5zZWxlY3RlZCA9IGZhbHNlO1xuXHRcdFx0dGhpcy5fc3R5bGVJdGVtKGl0ZW0pO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMuY3VycmVudEl0ZW1zID0gW107XG5cdFx0XG5cdFx0dGhpcy5mb2N1c2VkSXRlbSA9IG51bGw7XG5cdH1cblx0XG5cdF9jaG9vc2VJdGVtKGl0ZW0sIHNpbGVudCl7XG5cdFx0dmFyIGluZGV4O1xuXHRcdFxuXHRcdHRoaXMudHlwaW5nID0gZmFsc2U7XG5cdFx0XG5cdFx0aWYodGhpcy5wYXJhbXMubXVsdGlzZWxlY3Qpe1xuXHRcdFx0aW5kZXggPSB0aGlzLmN1cnJlbnRJdGVtcy5pbmRleE9mKGl0ZW0pO1xuXHRcdFx0XG5cdFx0XHRpZihpbmRleCA+IC0xKXtcblx0XHRcdFx0dGhpcy5jdXJyZW50SXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0aXRlbS5zZWxlY3RlZCA9IGZhbHNlO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRJdGVtcy5wdXNoKGl0ZW0pO1xuXHRcdFx0XHRpdGVtLnNlbGVjdGVkID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5pbnB1dC52YWx1ZSA9IHRoaXMuY3VycmVudEl0ZW1zLm1hcChpdGVtID0+IGl0ZW0ubGFiZWwpLmpvaW4oXCIsXCIpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLl9zdHlsZUl0ZW0oaXRlbSk7XG5cdFx0XHRcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRJdGVtcyA9IFtpdGVtXTtcblx0XHRcdGl0ZW0uc2VsZWN0ZWQgPSB0cnVlO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmlucHV0LnZhbHVlID0gaXRlbS5sYWJlbDtcblx0XHRcdFxuXHRcdFx0dGhpcy5fc3R5bGVJdGVtKGl0ZW0pO1xuXHRcdFx0XG5cdFx0XHRpZighc2lsZW50KXtcblx0XHRcdFx0dGhpcy5fcmVzb2x2ZVZhbHVlKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuX2ZvY3VzSXRlbShpdGVtKTtcblx0fVxuXHRcblx0X3Jlc29sdmVWYWx1ZShibHVyKXtcblx0XHR2YXIgb3V0cHV0LCBpbml0aWFsVmFsdWU7XG5cdFx0XG5cdFx0aWYodGhpcy5wb3B1cCl7XG5cdFx0XHR0aGlzLnBvcHVwLmhpZGUodHJ1ZSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMucGFyYW1zLm11bHRpc2VsZWN0KXtcblx0XHRcdG91dHB1dCA9IHRoaXMuY3VycmVudEl0ZW1zLm1hcChpdGVtID0+IGl0ZW0udmFsdWUpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGlmKGJsdXIgJiYgdGhpcy5wYXJhbXMuYXV0b2NvbXBsZXRlICYmIHRoaXMudHlwaW5nKXtcblx0XHRcdFx0aWYodGhpcy5wYXJhbXMuZnJlZXRleHQgfHwgKHRoaXMucGFyYW1zLmFsbG93RW1wdHkgJiYgdGhpcy5pbnB1dC52YWx1ZSA9PT0gXCJcIikpe1xuXHRcdFx0XHRcdG91dHB1dCA9IHRoaXMuaW5wdXQudmFsdWU7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHR0aGlzLmFjdGlvbnMuY2FuY2VsKCk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKHRoaXMuY3VycmVudEl0ZW1zWzBdKXtcblx0XHRcdFx0XHRvdXRwdXQgPSB0aGlzLmN1cnJlbnRJdGVtc1swXS52YWx1ZTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGluaXRpYWxWYWx1ZSA9IEFycmF5LmlzQXJyYXkodGhpcy5pbml0aWFsVmFsdWVzKSA/IHRoaXMuaW5pdGlhbFZhbHVlc1swXSA6IHRoaXMuaW5pdGlhbFZhbHVlcztcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihpbml0aWFsVmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIGluaXRpYWxWYWx1ZSA9PT0gXCJ1bmRlZmluZWRcIiB8fCBpbml0aWFsVmFsdWUgPT09IFwiXCIpe1xuXHRcdFx0XHRcdFx0b3V0cHV0ID0gaW5pdGlhbFZhbHVlO1xuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdG91dHB1dCA9IHRoaXMucGFyYW1zLmVtcHR5VmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZihvdXRwdXQgPT09IFwiXCIpe1xuXHRcdFx0b3V0cHV0ID0gdGhpcy5wYXJhbXMuZW1wdHlWYWx1ZTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5hY3Rpb25zLnN1Y2Nlc3Mob3V0cHV0KTtcblx0XHRcblx0XHRpZih0aGlzLmlzRmlsdGVyKXtcblx0XHRcdHRoaXMuaW5pdGlhbFZhbHVlcyA9IG91dHB1dCAmJiAhQXJyYXkuaXNBcnJheShvdXRwdXQpID8gW291dHB1dF0gOiBvdXRwdXQ7XG5cdFx0XHR0aGlzLmN1cnJlbnRJdGVtcyA9IFtdO1xuXHRcdH1cblx0fVxuXHRcbn07XG5cbmZ1bmN0aW9uIGxpc3QoY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpe1xuXHR2YXIgbGlzdCA9IG5ldyBFZGl0JDEodGhpcywgY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpO1xuXG5cdHJldHVybiBsaXN0LmlucHV0O1xufVxuXG4vL3N0YXIgcmF0aW5nXG5mdW5jdGlvbiBzdGFyJDEoY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpe1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdGVsZW1lbnQgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0dmFsdWUgPSBjZWxsLmdldFZhbHVlKCksXG5cdG1heFN0YXJzID0gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInN2Z1wiKS5sZW5ndGggfHwgNSxcblx0c2l6ZSA9IGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdmdcIilbMF0gPyBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3ZnXCIpWzBdLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpIDogMTQsXG5cdHN0YXJzID0gW10sXG5cdHN0YXJzSG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcblx0c3RhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBcInN2Z1wiKTtcblxuXG5cdC8vY2hhbmdlIHN0YXIgdHlwZVxuXHRmdW5jdGlvbiBzdGFyQ2hhbmdlKHZhbCl7XG5cdFx0c3RhcnMuZm9yRWFjaChmdW5jdGlvbihzdGFyLCBpKXtcblx0XHRcdGlmKGkgPCB2YWwpe1xuXHRcdFx0XHRpZihzZWxmLnRhYmxlLmJyb3dzZXIgPT0gXCJpZVwiKXtcblx0XHRcdFx0XHRzdGFyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwidGFidWxhdG9yLXN0YXItYWN0aXZlXCIpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0c3Rhci5jbGFzc0xpc3QucmVwbGFjZShcInRhYnVsYXRvci1zdGFyLWluYWN0aXZlXCIsIFwidGFidWxhdG9yLXN0YXItYWN0aXZlXCIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0c3Rhci5pbm5lckhUTUwgPSAnPHBvbHlnb24gZmlsbD1cIiM0ODhDRTlcIiBzdHJva2U9XCIjMDE0QUFFXCIgc3Ryb2tlLXdpZHRoPVwiMzcuNjE1MlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS1taXRlcmxpbWl0PVwiMTBcIiBwb2ludHM9XCIyNTkuMjE2LDI5Ljk0MiAzMzAuMjcsMTczLjkxOSA0ODkuMTYsMTk3LjAwNyAzNzQuMTg1LDMwOS4wOCA0MDEuMzMsNDY3LjMxIDI1OS4yMTYsMzkyLjYxMiAxMTcuMTA0LDQ2Ny4zMSAxNDQuMjUsMzA5LjA4IDI5LjI3NCwxOTcuMDA3IDE4OC4xNjUsMTczLjkxOSBcIi8+Jztcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYoc2VsZi50YWJsZS5icm93c2VyID09IFwiaWVcIil7XG5cdFx0XHRcdFx0c3Rhci5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRhYnVsYXRvci1zdGFyLWluYWN0aXZlXCIpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0c3Rhci5jbGFzc0xpc3QucmVwbGFjZShcInRhYnVsYXRvci1zdGFyLWFjdGl2ZVwiLCBcInRhYnVsYXRvci1zdGFyLWluYWN0aXZlXCIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0c3Rhci5pbm5lckhUTUwgPSAnPHBvbHlnb24gZmlsbD1cIiMwMTAxNTVcIiBzdHJva2U9XCIjNjg2ODY4XCIgc3Ryb2tlLXdpZHRoPVwiMzcuNjE1MlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS1taXRlcmxpbWl0PVwiMTBcIiBwb2ludHM9XCIyNTkuMjE2LDI5Ljk0MiAzMzAuMjcsMTczLjkxOSA0ODkuMTYsMTk3LjAwNyAzNzQuMTg1LDMwOS4wOCA0MDEuMzMsNDY3LjMxIDI1OS4yMTYsMzkyLjYxMiAxMTcuMTA0LDQ2Ny4zMSAxNDQuMjUsMzA5LjA4IDI5LjI3NCwxOTcuMDA3IDE4OC4xNjUsMTczLjkxOSBcIi8+Jztcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8vYnVpbGQgc3RhcnNcblx0ZnVuY3Rpb24gYnVpbGRTdGFyKGkpe1xuXG5cdFx0dmFyIHN0YXJIb2xkZXIgPSAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0dmFyIG5leHRTdGFyID0gc3Rhci5jbG9uZU5vZGUodHJ1ZSk7XG5cblx0XHRzdGFycy5wdXNoKG5leHRTdGFyKTtcblxuXHRcdHN0YXJIb2xkZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24oZSl7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdHN0YXJDaGFuZ2UoaSk7XG5cdFx0fSk7XG5cblx0XHRzdGFySG9sZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24oZSl7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHR9KTtcblxuXHRcdHN0YXJIb2xkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRzdWNjZXNzKGkpO1xuXHRcdFx0ZWxlbWVudC5ibHVyKCk7XG5cdFx0fSk7XG5cblx0XHRzdGFySG9sZGVyLmFwcGVuZENoaWxkKG5leHRTdGFyKTtcblx0XHRzdGFyc0hvbGRlci5hcHBlbmRDaGlsZChzdGFySG9sZGVyKTtcblxuXHR9XG5cblx0Ly9oYW5kbGUga2V5Ym9hcmQgbmF2aWdhdGlvbiB2YWx1ZSBjaGFuZ2Vcblx0ZnVuY3Rpb24gY2hhbmdlVmFsdWUodmFsKXtcblx0XHR2YWx1ZSA9IHZhbDtcblx0XHRzdGFyQ2hhbmdlKHZhbCk7XG5cdH1cblxuXHQvL3N0eWxlIGNlbGxcblx0ZWxlbWVudC5zdHlsZS53aGl0ZVNwYWNlID0gXCJub3dyYXBcIjtcblx0ZWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG5cdGVsZW1lbnQuc3R5bGUudGV4dE92ZXJmbG93ID0gXCJlbGxpcHNpc1wiO1xuXG5cdC8vc3R5bGUgaG9sZGluZyBlbGVtZW50XG5cdHN0YXJzSG9sZGVyLnN0eWxlLnZlcnRpY2FsQWxpZ24gPSBcIm1pZGRsZVwiO1xuXHRzdGFyc0hvbGRlci5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmUtYmxvY2tcIjtcblx0c3RhcnNIb2xkZXIuc3R5bGUucGFkZGluZyA9IFwiNHB4XCI7XG5cblx0Ly9zdHlsZSBzdGFyXG5cdHN0YXIuc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgc2l6ZSk7XG5cdHN0YXIuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsIHNpemUpO1xuXHRzdGFyLnNldEF0dHJpYnV0ZShcInZpZXdCb3hcIiwgXCIwIDAgNTEyIDUxMlwiKTtcblx0c3Rhci5zZXRBdHRyaWJ1dGUoXCJ4bWw6c3BhY2VcIiwgXCJwcmVzZXJ2ZVwiKTtcblx0c3Rhci5zdHlsZS5wYWRkaW5nID0gXCIwIDFweFwiO1xuXG5cdGlmKGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyAmJiB0eXBlb2YgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzID09IFwib2JqZWN0XCIpe1xuXHRcdGZvciAobGV0IGtleSBpbiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpe1xuXHRcdFx0aWYoa2V5LmNoYXJBdCgwKSA9PSBcIitcIil7XG5cdFx0XHRcdGtleSA9IGtleS5zbGljZSgxKTtcblx0XHRcdFx0c3RhcnNIb2xkZXIuc2V0QXR0cmlidXRlKGtleSwgc3RhcnNIb2xkZXIuZ2V0QXR0cmlidXRlKGtleSkgKyBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNbXCIrXCIgKyBrZXldKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0c3RhcnNIb2xkZXIuc2V0QXR0cmlidXRlKGtleSwgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW2tleV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vY3JlYXRlIGNvcnJlY3QgbnVtYmVyIG9mIHN0YXJzXG5cdGZvcih2YXIgaT0xO2k8PSBtYXhTdGFycztpKyspe1xuXHRcdGJ1aWxkU3RhcihpKTtcblx0fVxuXG5cdC8vZW5zdXJlIHZhbHVlIGRvZXMgbm90IGV4Y2VlZCBudW1iZXIgb2Ygc3RhcnNcblx0dmFsdWUgPSBNYXRoLm1pbihwYXJzZUludCh2YWx1ZSksIG1heFN0YXJzKTtcblxuXHQvLyBzZXQgaW5pdGlhbCBzdHlsaW5nIG9mIHN0YXJzXG5cdHN0YXJDaGFuZ2UodmFsdWUpO1xuXG5cdHN0YXJzSG9sZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24oZSl7XG5cdFx0c3RhckNoYW5nZSgwKTtcblx0fSk7XG5cblx0c3RhcnNIb2xkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdHN1Y2Nlc3MoMCk7XG5cdH0pO1xuXG5cdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgZnVuY3Rpb24oZSl7XG5cdFx0Y2FuY2VsKCk7XG5cdH0pO1xuXG5cdC8vYWxsb3cga2V5IGJhc2VkIG5hdmlnYXRpb25cblx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihlKXtcblx0XHRzd2l0Y2goZS5rZXlDb2RlKXtcblx0XHRcdGNhc2UgMzk6IC8vcmlnaHQgYXJyb3dcblx0XHRcdFx0Y2hhbmdlVmFsdWUodmFsdWUgKyAxKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMzc6IC8vbGVmdCBhcnJvd1xuXHRcdFx0XHRjaGFuZ2VWYWx1ZSh2YWx1ZSAtIDEpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAxMzogLy9lbnRlclxuXHRcdFx0XHRzdWNjZXNzKHZhbHVlKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMjc6IC8vZXNjYXBlXG5cdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBzdGFyc0hvbGRlcjtcbn1cblxuLy9kcmFnZ2FibGUgcHJvZ3Jlc3MgYmFyXG5mdW5jdGlvbiBwcm9ncmVzcyQxKGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKXtcblx0dmFyIGVsZW1lbnQgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0bWF4ID0gdHlwZW9mIGVkaXRvclBhcmFtcy5tYXggPT09IFwidW5kZWZpbmVkXCIgPyAoKGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJkaXZcIilbMF0gJiYgZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImRpdlwiKVswXS5nZXRBdHRyaWJ1dGUoXCJtYXhcIikpIHx8IDEwMCkgOiBlZGl0b3JQYXJhbXMubWF4LFxuXHRtaW4gPSB0eXBlb2YgZWRpdG9yUGFyYW1zLm1pbiA9PT0gXCJ1bmRlZmluZWRcIiA/ICgoZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImRpdlwiKVswXSAmJiBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiZGl2XCIpWzBdLmdldEF0dHJpYnV0ZShcIm1pblwiKSkgfHwgMCkgOiBlZGl0b3JQYXJhbXMubWluLFxuXHRwZXJjZW50ID0gKG1heCAtIG1pbikgLyAxMDAsXG5cdHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpIHx8IDAsXG5cdGhhbmRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdGJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdG1vdXNlRHJhZywgbW91c2VEcmFnV2lkdGg7XG5cblx0Ly9zZXQgbmV3IHZhbHVlXG5cdGZ1bmN0aW9uIHVwZGF0ZVZhbHVlKCl7XG5cdFx0dmFyIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgbnVsbCk7XG5cblx0XHR2YXIgY2FsY1ZhbCA9IChwZXJjZW50ICogTWF0aC5yb3VuZChiYXIub2Zmc2V0V2lkdGggLyAoKGVsZW1lbnQuY2xpZW50V2lkdGggLSBwYXJzZUludChzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwicGFkZGluZy1sZWZ0XCIpKSAtIHBhcnNlSW50KHN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJwYWRkaW5nLXJpZ2h0XCIpKSkvMTAwKSkpICsgbWluO1xuXHRcdHN1Y2Nlc3MoY2FsY1ZhbCk7XG5cdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXZhbHVlbm93XCIsIGNhbGNWYWwpO1xuXHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCB2YWx1ZSk7XG5cdH1cblxuXHQvL3N0eWxlIGhhbmRsZVxuXHRoYW5kbGUuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cdGhhbmRsZS5zdHlsZS5yaWdodCA9IFwiMFwiO1xuXHRoYW5kbGUuc3R5bGUudG9wID0gXCIwXCI7XG5cdGhhbmRsZS5zdHlsZS5ib3R0b20gPSBcIjBcIjtcblx0aGFuZGxlLnN0eWxlLndpZHRoID0gXCI1cHhcIjtcblx0aGFuZGxlLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJvZ3Jlc3MtaGFuZGxlXCIpO1xuXG5cdC8vc3R5bGUgYmFyXG5cdGJhci5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmUtYmxvY2tcIjtcblx0YmFyLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuXHQvLyBiYXIuc3R5bGUudG9wID0gXCI4cHhcIjtcblx0Ly8gYmFyLnN0eWxlLmJvdHRvbSA9IFwiOHB4XCI7XG5cdC8vIGJhci5zdHlsZS5sZWZ0ID0gXCI0cHhcIjtcblx0Ly8gYmFyLnN0eWxlLm1hcmdpblJpZ2h0ID0gXCI0cHhcIjtcblx0YmFyLnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuXHRiYXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjNDg4Q0U5XCI7XG5cdGJhci5zdHlsZS5tYXhXaWR0aCA9IFwiMTAwJVwiO1xuXHRiYXIuc3R5bGUubWluV2lkdGggPSBcIjAlXCI7XG5cblx0aWYoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzICYmIHR5cGVvZiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgPT0gXCJvYmplY3RcIil7XG5cdFx0Zm9yIChsZXQga2V5IGluIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyl7XG5cdFx0XHRpZihrZXkuY2hhckF0KDApID09IFwiK1wiKXtcblx0XHRcdFx0a2V5ID0ga2V5LnNsaWNlKDEpO1xuXHRcdFx0XHRiYXIuc2V0QXR0cmlidXRlKGtleSwgYmFyLmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGJhci5zZXRBdHRyaWJ1dGUoa2V5LCBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly9zdHlsZSBjZWxsXG5cdGVsZW1lbnQuc3R5bGUucGFkZGluZyA9IFwiNHB4IDRweFwiO1xuXG5cdC8vbWFrZSBzdXJlIHZhbHVlIGlzIGluIHJhbmdlXG5cdHZhbHVlID0gTWF0aC5taW4ocGFyc2VGbG9hdCh2YWx1ZSksIG1heCk7XG5cdHZhbHVlID0gTWF0aC5tYXgocGFyc2VGbG9hdCh2YWx1ZSksIG1pbik7XG5cblx0Ly93b3Jrb3V0IHBlcmNlbnRhZ2Vcblx0dmFsdWUgPSBNYXRoLnJvdW5kKCh2YWx1ZSAtIG1pbikgLyBwZXJjZW50KTtcblx0Ly8gYmFyLnN0eWxlLnJpZ2h0ID0gdmFsdWUgKyBcIiVcIjtcblx0YmFyLnN0eWxlLndpZHRoID0gdmFsdWUgKyBcIiVcIjtcblxuXHRlbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtdmFsdWVtaW5cIiwgbWluKTtcblx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXZhbHVlbWF4XCIsIG1heCk7XG5cblx0YmFyLmFwcGVuZENoaWxkKGhhbmRsZSk7XG5cblx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZSl7XG5cdFx0bW91c2VEcmFnID0gZS5zY3JlZW5YO1xuXHRcdG1vdXNlRHJhZ1dpZHRoID0gYmFyLm9mZnNldFdpZHRoO1xuXHR9KTtcblxuXHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbigpe1xuXHRcdGhhbmRsZS5zdHlsZS5jdXJzb3IgPSBcImV3LXJlc2l6ZVwiO1xuXHR9KTtcblxuXHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24oZSl7XG5cdFx0aWYobW91c2VEcmFnKXtcblx0XHRcdGJhci5zdHlsZS53aWR0aCA9IChtb3VzZURyYWdXaWR0aCArIGUuc2NyZWVuWCAtIG1vdXNlRHJhZykgKyBcInB4XCI7XG5cdFx0fVxuXHR9KTtcblxuXHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdGlmKG1vdXNlRHJhZyl7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuXHRcdFx0bW91c2VEcmFnID0gZmFsc2U7XG5cdFx0XHRtb3VzZURyYWdXaWR0aCA9IGZhbHNlO1xuXG5cdFx0XHR1cGRhdGVWYWx1ZSgpO1xuXHRcdH1cblx0fSk7XG5cblx0Ly9hbGxvdyBrZXkgYmFzZWQgbmF2aWdhdGlvblxuXHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdHN3aXRjaChlLmtleUNvZGUpe1xuXHRcdFx0Y2FzZSAzOTogLy9yaWdodCBhcnJvd1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGJhci5zdHlsZS53aWR0aCA9IChiYXIuY2xpZW50V2lkdGggKyBlbGVtZW50LmNsaWVudFdpZHRoLzEwMCkgKyBcInB4XCI7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDM3OiAvL2xlZnQgYXJyb3dcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRiYXIuc3R5bGUud2lkdGggPSAoYmFyLmNsaWVudFdpZHRoIC0gZWxlbWVudC5jbGllbnRXaWR0aC8xMDApICsgXCJweFwiO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSA5OiAvL3RhYlxuXHRcdFx0Y2FzZSAxMzogLy9lbnRlclxuXHRcdFx0XHR1cGRhdGVWYWx1ZSgpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAyNzogLy9lc2NhcGVcblx0XHRcdFx0Y2FuY2VsKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0fVxuXHR9KTtcblxuXHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGZ1bmN0aW9uKCl7XG5cdFx0Y2FuY2VsKCk7XG5cdH0pO1xuXG5cdHJldHVybiBiYXI7XG59XG5cbi8vY2hlY2tib3hcbmZ1bmN0aW9uIHRpY2tDcm9zcyQxKGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKXtcblx0dmFyIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxcblx0dHJpc3RhdGUgPSBlZGl0b3JQYXJhbXMudHJpc3RhdGUsXG5cdGluZGV0ZXJtVmFsdWUgPSB0eXBlb2YgZWRpdG9yUGFyYW1zLmluZGV0ZXJtaW5hdGVWYWx1ZSA9PT0gXCJ1bmRlZmluZWRcIiA/IG51bGwgOiBlZGl0b3JQYXJhbXMuaW5kZXRlcm1pbmF0ZVZhbHVlLFxuXHRpbmRldGVybVN0YXRlID0gZmFsc2UsXG5cdHRydWVWYWx1ZVNldCA9IE9iamVjdC5rZXlzKGVkaXRvclBhcmFtcykuaW5jbHVkZXMoXCJ0cnVlVmFsdWVcIiksXG5cdGZhbHNlVmFsdWVTZXQgPSBPYmplY3Qua2V5cyhlZGl0b3JQYXJhbXMpLmluY2x1ZGVzKFwiZmFsc2VWYWx1ZVwiKTtcblx0XG5cdGlucHV0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJjaGVja2JveFwiKTtcblx0aW5wdXQuc3R5bGUubWFyZ2luVG9wID0gXCI1cHhcIjtcblx0aW5wdXQuc3R5bGUuYm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XG5cdFxuXHRpZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgdHlwZW9mIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyA9PSBcIm9iamVjdFwiKXtcblx0XHRmb3IgKGxldCBrZXkgaW4gZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKXtcblx0XHRcdGlmKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpe1xuXHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGlucHV0LmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1trZXldKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGlucHV0LnZhbHVlID0gdmFsdWU7XG5cdFxuXHRpZih0cmlzdGF0ZSAmJiAodHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiIHx8IHZhbHVlID09PSBpbmRldGVybVZhbHVlIHx8IHZhbHVlID09PSBcIlwiKSl7XG5cdFx0aW5kZXRlcm1TdGF0ZSA9IHRydWU7XG5cdFx0aW5wdXQuaW5kZXRlcm1pbmF0ZSA9IHRydWU7XG5cdH1cblx0XG5cdGlmKHRoaXMudGFibGUuYnJvd3NlciAhPSBcImZpcmVmb3hcIiAmJiB0aGlzLnRhYmxlLmJyb3dzZXIgIT0gXCJzYWZhcmlcIil7IC8vcHJldmVudCBibHVyIGlzc3VlIG9uIG1hYyBmaXJlZm94XG5cdFx0b25SZW5kZXJlZChmdW5jdGlvbigpe1xuXHRcdFx0aWYoY2VsbC5nZXRUeXBlKCkgPT09IFwiY2VsbFwiKXtcblx0XHRcdFx0aW5wdXQuZm9jdXMoe3ByZXZlbnRTY3JvbGw6IHRydWV9KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0aW5wdXQuY2hlY2tlZCA9IHRydWVWYWx1ZVNldCA/IHZhbHVlID09PSBlZGl0b3JQYXJhbXMudHJ1ZVZhbHVlIDogKHZhbHVlID09PSB0cnVlIHx8IHZhbHVlID09PSBcInRydWVcIiB8fCB2YWx1ZSA9PT0gXCJUcnVlXCIgfHwgdmFsdWUgPT09IDEpO1xuXHRcblx0ZnVuY3Rpb24gc2V0VmFsdWUoYmx1cil7XG5cdFx0dmFyIGNoZWNrZWRWYWx1ZSA9IGlucHV0LmNoZWNrZWQ7XG5cdFx0XG5cdFx0aWYodHJ1ZVZhbHVlU2V0ICYmIGNoZWNrZWRWYWx1ZSl7XG5cdFx0XHRjaGVja2VkVmFsdWUgPSBlZGl0b3JQYXJhbXMudHJ1ZVZhbHVlO1xuXHRcdH1lbHNlIGlmKGZhbHNlVmFsdWVTZXQgJiYgIWNoZWNrZWRWYWx1ZSl7XG5cdFx0XHRjaGVja2VkVmFsdWUgPSBlZGl0b3JQYXJhbXMuZmFsc2VWYWx1ZTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodHJpc3RhdGUpe1xuXHRcdFx0aWYoIWJsdXIpe1xuXHRcdFx0XHRpZihpbnB1dC5jaGVja2VkICYmICFpbmRldGVybVN0YXRlKXtcblx0XHRcdFx0XHRpbnB1dC5jaGVja2VkID0gZmFsc2U7XG5cdFx0XHRcdFx0aW5wdXQuaW5kZXRlcm1pbmF0ZSA9IHRydWU7XG5cdFx0XHRcdFx0aW5kZXRlcm1TdGF0ZSA9IHRydWU7XG5cdFx0XHRcdFx0cmV0dXJuIGluZGV0ZXJtVmFsdWU7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRpbmRldGVybVN0YXRlID0gZmFsc2U7XG5cdFx0XHRcdFx0cmV0dXJuIGNoZWNrZWRWYWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRpZihpbmRldGVybVN0YXRlKXtcblx0XHRcdFx0XHRyZXR1cm4gaW5kZXRlcm1WYWx1ZTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiBjaGVja2VkVmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gY2hlY2tlZFZhbHVlO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGJsdXJcblx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbihlKXtcblx0XHRzdWNjZXNzKHNldFZhbHVlKCkpO1xuXHR9KTtcblxuXHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbihlKXtcblx0XHRzdWNjZXNzKHNldFZhbHVlKHRydWUpKTtcblx0fSk7XG5cdFxuXHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gZW50ZXJcblx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24oZSl7XG5cdFx0aWYoZS5rZXlDb2RlID09IDEzKXtcblx0XHRcdHN1Y2Nlc3Moc2V0VmFsdWUoKSk7XG5cdFx0fVxuXHRcdGlmKGUua2V5Q29kZSA9PSAyNyl7XG5cdFx0XHRjYW5jZWwoKTtcblx0XHR9XG5cdH0pO1xuXHRcblx0cmV0dXJuIGlucHV0O1xufVxuXG5mdW5jdGlvbiBhZGFwdGFibGUkMShjZWxsLCBvblJlbmRlcmVkLCBzdWNjZXNzLCBjYW5jZWwsIHBhcmFtcyl7XHJcblx0dmFyIGNvbHVtbiA9IGNlbGwuX2dldFNlbGYoKS5jb2x1bW4sXHJcblx0bG9va3VwLCBlZGl0b3JGdW5jLCBlZGl0b3JQYXJhbXM7XHJcbiAgICBcclxuXHRmdW5jdGlvbiBkZWZhdWx0TG9va3VwKGNlbGwpe1xyXG5cdFx0dmFyIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxyXG5cdFx0ZWRpdG9yID0gXCJpbnB1dFwiO1xyXG4gICAgICAgIFxyXG5cdFx0c3dpdGNoKHR5cGVvZiB2YWx1ZSl7XHJcblx0XHRcdGNhc2UgXCJudW1iZXJcIjpcclxuXHRcdFx0XHRlZGl0b3IgPSBcIm51bWJlclwiO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG4gICAgICAgICAgICBcclxuXHRcdFx0Y2FzZSBcImJvb2xlYW5cIjpcclxuXHRcdFx0XHRlZGl0b3IgPSBcInRpY2tDcm9zc1wiO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG4gICAgICAgICAgICBcclxuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxyXG5cdFx0XHRcdGlmKHZhbHVlLmluY2x1ZGVzKFwiXFxuXCIpKXtcclxuXHRcdFx0XHRcdGVkaXRvciA9IFwidGV4dGFyZWFcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcbiAgICAgICAgXHJcblx0XHRyZXR1cm4gZWRpdG9yO1xyXG5cdH1cclxuICAgIFxyXG5cdGxvb2t1cCA9IHBhcmFtcy5lZGl0b3JMb29rdXAgPyBwYXJhbXMuZWRpdG9yTG9va3VwKGNlbGwpIDogZGVmYXVsdExvb2t1cChjZWxsKTtcclxuXHJcblx0aWYocGFyYW1zLnBhcmFtc0xvb2t1cCl7XHJcblx0XHRlZGl0b3JQYXJhbXMgPSB0eXBlb2YgcGFyYW1zLnBhcmFtc0xvb2t1cCA9PT0gXCJmdW5jdGlvblwiID8gcGFyYW1zLnBhcmFtc0xvb2t1cChsb29rdXAsIGNlbGwpIDogcGFyYW1zLnBhcmFtc0xvb2t1cFtsb29rdXBdO1xyXG5cdH1cclxuXHJcblx0ZWRpdG9yRnVuYyA9IHRoaXMudGFibGUubW9kdWxlcy5lZGl0Lmxvb2t1cEVkaXRvcihsb29rdXAsIGNvbHVtbik7XHJcbiAgICBcclxuXHRyZXR1cm4gIGVkaXRvckZ1bmMuY2FsbCh0aGlzLCBjZWxsLCBvblJlbmRlcmVkLCBzdWNjZXNzLCBjYW5jZWwsIGVkaXRvclBhcmFtcyB8fCB7fSk7XHJcbn1cblxudmFyIGRlZmF1bHRFZGl0b3JzID0ge1xuXHRpbnB1dDppbnB1dCxcblx0dGV4dGFyZWE6dGV4dGFyZWEkMSxcblx0bnVtYmVyOm51bWJlciQxLFxuXHRyYW5nZTpyYW5nZSxcblx0ZGF0ZTpkYXRlJDEsXG5cdHRpbWU6dGltZSQxLFxuXHRkYXRldGltZTpkYXRldGltZSQyLFxuXHRsaXN0Omxpc3QsXG5cdHN0YXI6c3RhciQxLFxuXHRwcm9ncmVzczpwcm9ncmVzcyQxLFxuXHR0aWNrQ3Jvc3M6dGlja0Nyb3NzJDEsXG5cdGFkYXB0YWJsZTphZGFwdGFibGUkMSxcbn07XG5cbmNsYXNzIEVkaXQgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcImVkaXRcIjtcblxuXHQvL2xvYWQgZGVmYXVsdHNcblx0c3RhdGljIGVkaXRvcnMgPSBkZWZhdWx0RWRpdG9ycztcblx0XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy5jdXJyZW50Q2VsbCA9IGZhbHNlOyAvL2hvbGQgY3VycmVudGx5IGVkaXRpbmcgY2VsbFxuXHRcdHRoaXMubW91c2VDbGljayA9IGZhbHNlOyAvL2hvbGQgbW91c2Vkb3duIHN0YXRlIHRvIHByZXZlbnQgY2xpY2sgYmluZGluZyBiZWluZyBvdmVycmlkZGVuIGJ5IGVkaXRvciBvcGVuaW5nXG5cdFx0dGhpcy5yZWN1cnNpb25CbG9jayA9IGZhbHNlOyAvL3ByZXZlbnQgZm9jdXMgcmVjdXJzaW9uXG5cdFx0dGhpcy5pbnZhbGlkRWRpdCA9IGZhbHNlO1xuXHRcdHRoaXMuZWRpdGVkQ2VsbHMgPSBbXTtcblx0XHR0aGlzLmNvbnZlcnRFbXB0eVZhbHVlcyA9IGZhbHNlO1xuXHRcdFxuXHRcdHRoaXMuZWRpdG9ycyA9IEVkaXQuZWRpdG9ycztcblx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZWRpdFRyaWdnZXJFdmVudFwiLCBcImZvY3VzXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImVkaXRvckVtcHR5VmFsdWVcIik7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZWRpdG9yRW1wdHlWYWx1ZUZ1bmNcIiwgdGhpcy5lbXB0eVZhbHVlQ2hlY2suYmluZCh0aGlzKSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiZWRpdGFibGVcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImVkaXRvclwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiZWRpdG9yUGFyYW1zXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJlZGl0b3JFbXB0eVZhbHVlXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJlZGl0b3JFbXB0eVZhbHVlRnVuY1wiKTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiY2VsbEVkaXRpbmdcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImNlbGxFZGl0ZWRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImNlbGxFZGl0Q2FuY2VsbGVkXCIpO1xuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0RWRpdGVkQ2VsbHNcIiwgdGhpcy5nZXRFZGl0ZWRDZWxscy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImNsZWFyQ2VsbEVkaXRlZFwiLCB0aGlzLmNsZWFyQ2VsbEVkaXRlZC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcIm5hdmlnYXRlUHJldlwiLCB0aGlzLm5hdmlnYXRlUHJldi5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcIm5hdmlnYXRlTmV4dFwiLCB0aGlzLm5hdmlnYXRlTmV4dC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcIm5hdmlnYXRlTGVmdFwiLCB0aGlzLm5hdmlnYXRlTGVmdC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcIm5hdmlnYXRlUmlnaHRcIiwgdGhpcy5uYXZpZ2F0ZVJpZ2h0LmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwibmF2aWdhdGVVcFwiLCB0aGlzLm5hdmlnYXRlVXAuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJuYXZpZ2F0ZURvd25cIiwgdGhpcy5uYXZpZ2F0ZURvd24uYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiY2VsbFwiLCBcImlzRWRpdGVkXCIsIHRoaXMuY2VsbElzRWRpdGVkLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNlbGxcIiwgXCJjbGVhckVkaXRlZFwiLCB0aGlzLmNsZWFyRWRpdGVkLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNlbGxcIiwgXCJlZGl0XCIsIHRoaXMuZWRpdENlbGwuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiY2VsbFwiLCBcImNhbmNlbEVkaXRcIiwgdGhpcy5jZWxsQ2FuY2VsRWRpdC5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJjZWxsXCIsIFwibmF2aWdhdGVQcmV2XCIsIHRoaXMubmF2aWdhdGVQcmV2LmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNlbGxcIiwgXCJuYXZpZ2F0ZU5leHRcIiwgdGhpcy5uYXZpZ2F0ZU5leHQuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiY2VsbFwiLCBcIm5hdmlnYXRlTGVmdFwiLCB0aGlzLm5hdmlnYXRlTGVmdC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJjZWxsXCIsIFwibmF2aWdhdGVSaWdodFwiLCB0aGlzLm5hdmlnYXRlUmlnaHQuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiY2VsbFwiLCBcIm5hdmlnYXRlVXBcIiwgdGhpcy5uYXZpZ2F0ZVVwLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNlbGxcIiwgXCJuYXZpZ2F0ZURvd25cIiwgdGhpcy5uYXZpZ2F0ZURvd24uYmluZCh0aGlzKSk7XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtaW5pdFwiLCB0aGlzLmJpbmRFZGl0b3IuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLWRlbGV0ZVwiLCB0aGlzLmNsZWFyRWRpdGVkLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC12YWx1ZS1jaGFuZ2VkXCIsIHRoaXMudXBkYXRlQ2VsbENsYXNzLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWxheW91dFwiLCB0aGlzLmluaXRpYWxpemVDb2x1bW5DaGVjay5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1kZWxldGVcIiwgdGhpcy5jb2x1bW5EZWxldGVDaGVjay5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1kZWxldGluZ1wiLCB0aGlzLnJvd0RlbGV0ZUNoZWNrLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWxheW91dFwiLCB0aGlzLnJvd0VkaXRhYmxlQ2hlY2suYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJkYXRhLXJlZnJlc2hpbmdcIiwgdGhpcy5jYW5jZWxFZGl0LmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY2xpcGJvYXJkLXBhc3RlXCIsIHRoaXMucGFzdGVCbG9ja2VyLmJpbmQodGhpcykpO1xuXHRcdFxuXHRcdHRoaXMuc3Vic2NyaWJlKFwia2V5YmluZGluZy1uYXYtcHJldlwiLCB0aGlzLm5hdmlnYXRlUHJldi5iaW5kKHRoaXMsIHVuZGVmaW5lZCkpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwia2V5YmluZGluZy1uYXYtbmV4dFwiLCB0aGlzLmtleWJpbmRpbmdOYXZpZ2F0ZU5leHQuYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0Ly8gdGhpcy5zdWJzY3JpYmUoXCJrZXliaW5kaW5nLW5hdi1sZWZ0XCIsIHRoaXMubmF2aWdhdGVMZWZ0LmJpbmQodGhpcywgdW5kZWZpbmVkKSk7XG5cdFx0Ly8gdGhpcy5zdWJzY3JpYmUoXCJrZXliaW5kaW5nLW5hdi1yaWdodFwiLCB0aGlzLm5hdmlnYXRlUmlnaHQuYmluZCh0aGlzLCB1bmRlZmluZWQpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImtleWJpbmRpbmctbmF2LXVwXCIsIHRoaXMubmF2aWdhdGVVcC5iaW5kKHRoaXMsIHVuZGVmaW5lZCkpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwia2V5YmluZGluZy1uYXYtZG93blwiLCB0aGlzLm5hdmlnYXRlRG93bi5iaW5kKHRoaXMsIHVuZGVmaW5lZCkpO1xuXG5cdFx0aWYoT2JqZWN0LmtleXModGhpcy50YWJsZS5vcHRpb25zKS5pbmNsdWRlcyhcImVkaXRvckVtcHR5VmFsdWVcIikpe1xuXHRcdFx0dGhpcy5jb252ZXJ0RW1wdHlWYWx1ZXMgPSB0cnVlO1xuXHRcdH1cblx0fVxuXHRcblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBQYXN0ZSBOZWdhdGlvbiAvLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRwYXN0ZUJsb2NrZXIoZSl7XG5cdFx0aWYodGhpcy5jdXJyZW50Q2VsbCl7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8gS2V5YmluZGluZyBGdW5jdGlvbnMgLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0a2V5YmluZGluZ05hdmlnYXRlTmV4dChlKXtcblx0XHR2YXIgY2VsbCA9IHRoaXMuY3VycmVudENlbGwsXG5cdFx0bmV3Um93ID0gdGhpcy5vcHRpb25zKFwidGFiRW5kTmV3Um93XCIpO1xuXG5cdFx0aWYoY2VsbCl7XG5cdFx0XHRpZighdGhpcy5uYXZpZ2F0ZU5leHQoY2VsbCwgZSkpe1xuXHRcdFx0XHRpZihuZXdSb3cpe1xuXHRcdFx0XHRcdGNlbGwuZ2V0RWxlbWVudCgpLmZpcnN0Q2hpbGQuYmx1cigpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKCF0aGlzLmludmFsaWRFZGl0KXtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYobmV3Um93ID09PSB0cnVlKXtcblx0XHRcdFx0XHRcdFx0bmV3Um93ID0gdGhpcy50YWJsZS5hZGRSb3coe30pO1xuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpZih0eXBlb2YgbmV3Um93ID09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdFx0XHRcdFx0bmV3Um93ID0gdGhpcy50YWJsZS5hZGRSb3cobmV3Um93KGNlbGwucm93LmdldENvbXBvbmVudCgpKSk7XG5cdFx0XHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRuZXdSb3cgPSB0aGlzLnRhYmxlLmFkZFJvdyhPYmplY3QuYXNzaWduKHt9LCBuZXdSb3cpKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRuZXdSb3cudGhlbigoKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdGNlbGwuZ2V0Q29tcG9uZW50KCkubmF2aWdhdGVOZXh0KCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gQ2VsbCBGdW5jdGlvbnMgLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0Y2VsbElzRWRpdGVkKGNlbGwpe1xuXHRcdHJldHVybiAhISBjZWxsLm1vZHVsZXMuZWRpdCAmJiBjZWxsLm1vZHVsZXMuZWRpdC5lZGl0ZWQ7XG5cdH1cblx0XG5cdGNlbGxDYW5jZWxFZGl0KGNlbGwpe1xuXHRcdGlmKGNlbGwgPT09IHRoaXMuY3VycmVudENlbGwpe1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmVkaXQuY2FuY2VsRWRpdCgpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNhbmNlbCBFZGl0b3IgRXJyb3IgLSBUaGlzIGNlbGwgaXMgbm90IGN1cnJlbnRseSBiZWluZyBlZGl0ZWQgXCIpO1xuXHRcdH1cblx0fVxuXHRcblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBUYWJsZSBGdW5jdGlvbnMgLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdHVwZGF0ZUNlbGxDbGFzcyhjZWxsKXtcblx0XHRpZih0aGlzLmFsbG93RWRpdChjZWxsKSkge1xuXHRcdFx0Y2VsbC5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1lZGl0YWJsZVwiKTtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRjZWxsLmdldEVsZW1lbnQoKS5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWVkaXRhYmxlXCIpO1xuXHRcdH1cblx0fVxuXHRcblx0Y2xlYXJDZWxsRWRpdGVkKGNlbGxzKXtcblx0XHRpZighY2VsbHMpe1xuXHRcdFx0Y2VsbHMgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5nZXRFZGl0ZWRDZWxscygpO1xuXHRcdH1cblx0XHRcblx0XHRpZighQXJyYXkuaXNBcnJheShjZWxscykpe1xuXHRcdFx0Y2VsbHMgPSBbY2VsbHNdO1xuXHRcdH1cblx0XHRcblx0XHRjZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5jbGVhckVkaXRlZChjZWxsLl9nZXRTZWxmKCkpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRuYXZpZ2F0ZVByZXYoY2VsbCA9IHRoaXMuY3VycmVudENlbGwsIGUpe1xuXHRcdHZhciBuZXh0Q2VsbCwgcHJldlJvdztcblx0XHRcblx0XHRpZihjZWxsKXtcblx0XHRcdFxuXHRcdFx0aWYoZSl7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bmV4dENlbGwgPSB0aGlzLm5hdmlnYXRlTGVmdCgpO1xuXHRcdFx0XG5cdFx0XHRpZihuZXh0Q2VsbCl7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRwcmV2Um93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnByZXZEaXNwbGF5Um93KGNlbGwucm93LCB0cnVlKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHByZXZSb3cpe1xuXHRcdFx0XHRcdG5leHRDZWxsID0gdGhpcy5maW5kUHJldkVkaXRhYmxlQ2VsbChwcmV2Um93LCBwcmV2Um93LmNlbGxzLmxlbmd0aCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYobmV4dENlbGwpe1xuXHRcdFx0XHRcdFx0bmV4dENlbGwuZ2V0Q29tcG9uZW50KCkuZWRpdCgpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRcblx0bmF2aWdhdGVOZXh0KGNlbGwgPSB0aGlzLmN1cnJlbnRDZWxsLCBlKXtcblx0XHR2YXIgbmV4dENlbGwsIG5leHRSb3c7XG5cdFx0XG5cdFx0aWYoY2VsbCl7XG5cdFx0XHRcblx0XHRcdGlmKGUpe1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdG5leHRDZWxsID0gdGhpcy5uYXZpZ2F0ZVJpZ2h0KCk7XG5cdFx0XHRcblx0XHRcdGlmKG5leHRDZWxsKXtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdG5leHRSb3cgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIubmV4dERpc3BsYXlSb3coY2VsbC5yb3csIHRydWUpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYobmV4dFJvdyl7XG5cdFx0XHRcdFx0bmV4dENlbGwgPSB0aGlzLmZpbmROZXh0RWRpdGFibGVDZWxsKG5leHRSb3csIC0xKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihuZXh0Q2VsbCl7XG5cdFx0XHRcdFx0XHRuZXh0Q2VsbC5nZXRDb21wb25lbnQoKS5lZGl0KCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cdFxuXHRuYXZpZ2F0ZUxlZnQoY2VsbCA9IHRoaXMuY3VycmVudENlbGwsIGUpe1xuXHRcdHZhciBpbmRleCwgbmV4dENlbGw7XG5cdFx0XG5cdFx0aWYoY2VsbCl7XG5cdFx0XHRcblx0XHRcdGlmKGUpe1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGluZGV4ID0gY2VsbC5nZXRJbmRleCgpO1xuXHRcdFx0bmV4dENlbGwgPSB0aGlzLmZpbmRQcmV2RWRpdGFibGVDZWxsKGNlbGwucm93LCBpbmRleCk7XG5cdFx0XHRcblx0XHRcdGlmKG5leHRDZWxsKXtcblx0XHRcdFx0bmV4dENlbGwuZ2V0Q29tcG9uZW50KCkuZWRpdCgpO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cdFxuXHRuYXZpZ2F0ZVJpZ2h0KGNlbGwgPSB0aGlzLmN1cnJlbnRDZWxsLCBlKXtcblx0XHR2YXIgaW5kZXgsIG5leHRDZWxsO1xuXHRcdFxuXHRcdGlmKGNlbGwpe1xuXHRcdFx0XG5cdFx0XHRpZihlKXtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpbmRleCA9IGNlbGwuZ2V0SW5kZXgoKTtcblx0XHRcdG5leHRDZWxsID0gdGhpcy5maW5kTmV4dEVkaXRhYmxlQ2VsbChjZWxsLnJvdywgaW5kZXgpO1xuXHRcdFx0XG5cdFx0XHRpZihuZXh0Q2VsbCl7XG5cdFx0XHRcdG5leHRDZWxsLmdldENvbXBvbmVudCgpLmVkaXQoKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRcblx0bmF2aWdhdGVVcChjZWxsID0gdGhpcy5jdXJyZW50Q2VsbCwgZSl7XG5cdFx0dmFyIGluZGV4LCBuZXh0Um93O1xuXHRcdFxuXHRcdGlmKGNlbGwpe1xuXHRcdFx0XG5cdFx0XHRpZihlKXtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpbmRleCA9IGNlbGwuZ2V0SW5kZXgoKTtcblx0XHRcdG5leHRSb3cgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIucHJldkRpc3BsYXlSb3coY2VsbC5yb3csIHRydWUpO1xuXHRcdFx0XG5cdFx0XHRpZihuZXh0Um93KXtcblx0XHRcdFx0bmV4dFJvdy5jZWxsc1tpbmRleF0uZ2V0Q29tcG9uZW50KCkuZWRpdCgpO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cdFxuXHRuYXZpZ2F0ZURvd24oY2VsbCA9IHRoaXMuY3VycmVudENlbGwsIGUpe1xuXHRcdHZhciBpbmRleCwgbmV4dFJvdztcblx0XHRcblx0XHRpZihjZWxsKXtcblx0XHRcdFxuXHRcdFx0aWYoZSl7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aW5kZXggPSBjZWxsLmdldEluZGV4KCk7XG5cdFx0XHRuZXh0Um93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLm5leHREaXNwbGF5Um93KGNlbGwucm93LCB0cnVlKTtcblx0XHRcdFxuXHRcdFx0aWYobmV4dFJvdyl7XG5cdFx0XHRcdG5leHRSb3cuY2VsbHNbaW5kZXhdLmdldENvbXBvbmVudCgpLmVkaXQoKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRcblx0ZmluZE5leHRFZGl0YWJsZUNlbGwocm93LCBpbmRleCl7XG5cdFx0dmFyIG5leHRDZWxsID0gZmFsc2U7XG5cdFx0XG5cdFx0aWYoaW5kZXggPCByb3cuY2VsbHMubGVuZ3RoLTEpe1xuXHRcdFx0Zm9yKHZhciBpID0gaW5kZXgrMTsgaSA8IHJvdy5jZWxscy5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdGxldCBjZWxsID0gcm93LmNlbGxzW2ldO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0ICYmIEhlbHBlcnMuZWxWaXNpYmxlKGNlbGwuZ2V0RWxlbWVudCgpKSl7XG5cdFx0XHRcdFx0bGV0IGFsbG93RWRpdCA9IHRoaXMuYWxsb3dFZGl0KGNlbGwpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKGFsbG93RWRpdCl7XG5cdFx0XHRcdFx0XHRuZXh0Q2VsbCA9IGNlbGw7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG5leHRDZWxsO1xuXHR9XG5cdFxuXHRmaW5kUHJldkVkaXRhYmxlQ2VsbChyb3csIGluZGV4KXtcblx0XHR2YXIgcHJldkNlbGwgPSBmYWxzZTtcblx0XHRcblx0XHRpZihpbmRleCA+IDApe1xuXHRcdFx0Zm9yKHZhciBpID0gaW5kZXgtMTsgaSA+PSAwOyBpLS0pe1xuXHRcdFx0XHRsZXQgY2VsbCA9IHJvdy5jZWxsc1tpXTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGNlbGwuY29sdW1uLm1vZHVsZXMuZWRpdCAmJiBIZWxwZXJzLmVsVmlzaWJsZShjZWxsLmdldEVsZW1lbnQoKSkpe1xuXHRcdFx0XHRcdGxldCBhbGxvd0VkaXQgPSB0aGlzLmFsbG93RWRpdChjZWxsKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihhbGxvd0VkaXQpe1xuXHRcdFx0XHRcdFx0cHJldkNlbGwgPSBjZWxsO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBwcmV2Q2VsbDtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIEludGVybmFsIExvZ2ljIC8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdGluaXRpYWxpemVDb2x1bW5DaGVjayhjb2x1bW4pe1xuXHRcdGlmKHR5cGVvZiBjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3IgIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQ29sdW1uKGNvbHVtbik7XG5cdFx0fVxuXHR9XG5cdFxuXHRjb2x1bW5EZWxldGVDaGVjayhjb2x1bW4pe1xuXHRcdGlmKHRoaXMuY3VycmVudENlbGwgJiYgdGhpcy5jdXJyZW50Q2VsbC5jb2x1bW4gPT09IGNvbHVtbil7XG5cdFx0XHR0aGlzLmNhbmNlbEVkaXQoKTtcblx0XHR9XG5cdH1cblx0XG5cdHJvd0RlbGV0ZUNoZWNrKHJvdyl7XG5cdFx0aWYodGhpcy5jdXJyZW50Q2VsbCAmJiB0aGlzLmN1cnJlbnRDZWxsLnJvdyA9PT0gcm93KXtcblx0XHRcdHRoaXMuY2FuY2VsRWRpdCgpO1xuXHRcdH1cblx0fVxuXHRcblx0cm93RWRpdGFibGVDaGVjayhyb3cpe1xuXHRcdHJvdy5nZXRDZWxscygpLmZvckVhY2goKGNlbGwpID0+IHtcblx0XHRcdGlmKGNlbGwuY29sdW1uLm1vZHVsZXMuZWRpdCAmJiB0eXBlb2YgY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LmNoZWNrID09PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0XHR0aGlzLnVwZGF0ZUNlbGxDbGFzcyhjZWxsKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0Ly9pbml0aWFsaXplIGNvbHVtbiBlZGl0b3Jcblx0aW5pdGlhbGl6ZUNvbHVtbihjb2x1bW4pe1xuXHRcdHZhciBjb252ZXJ0RW1wdHkgPSBPYmplY3Qua2V5cyhjb2x1bW4uZGVmaW5pdGlvbikuaW5jbHVkZXMoXCJlZGl0b3JFbXB0eVZhbHVlXCIpO1xuXG5cdFx0dmFyIGNvbmZpZyA9IHtcblx0XHRcdGVkaXRvcjpmYWxzZSxcblx0XHRcdGJsb2NrZWQ6ZmFsc2UsXG5cdFx0XHRjaGVjazpjb2x1bW4uZGVmaW5pdGlvbi5lZGl0YWJsZSxcblx0XHRcdHBhcmFtczpjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3JQYXJhbXMgfHwge30sXG5cdFx0XHRjb252ZXJ0RW1wdHlWYWx1ZXM6Y29udmVydEVtcHR5LFxuXHRcdFx0ZWRpdG9yRW1wdHlWYWx1ZTpjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3JFbXB0eVZhbHVlLFxuXHRcdFx0ZWRpdG9yRW1wdHlWYWx1ZUZ1bmM6Y29sdW1uLmRlZmluaXRpb24uZWRpdG9yRW1wdHlWYWx1ZUZ1bmMsXG5cdFx0fTtcblx0XHRcblx0XHQvL3NldCBjb2x1bW4gZWRpdG9yXG5cdFx0Y29uZmlnLmVkaXRvciA9IHRoaXMubG9va3VwRWRpdG9yKGNvbHVtbi5kZWZpbml0aW9uLmVkaXRvciwgY29sdW1uKTtcblx0XHRcblx0XHRpZihjb25maWcuZWRpdG9yKXtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmVkaXQgPSBjb25maWc7XG5cdFx0fVxuXHR9XG5cblx0bG9va3VwRWRpdG9yKGVkaXRvciwgY29sdW1uKXtcblx0XHR2YXIgZWRpdG9yRnVuYztcblxuXHRcdHN3aXRjaCh0eXBlb2YgZWRpdG9yKXtcblx0XHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdFx0aWYodGhpcy5lZGl0b3JzW2VkaXRvcl0pe1xuXHRcdFx0XHRcdGVkaXRvckZ1bmMgPSB0aGlzLmVkaXRvcnNbZWRpdG9yXTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkVkaXRvciBFcnJvciAtIE5vIHN1Y2ggZWRpdG9yIGZvdW5kOiBcIiwgZWRpdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdGVkaXRvckZ1bmMgPSBlZGl0b3I7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwiYm9vbGVhblwiOlxuXHRcdFx0XHRpZihlZGl0b3IgPT09IHRydWUpe1xuXHRcdFx0XHRcdGlmKHR5cGVvZiBjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXIgIT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdFx0XHRpZih0aGlzLmVkaXRvcnNbY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyXSl7XG5cdFx0XHRcdFx0XHRcdGVkaXRvckZ1bmMgPSB0aGlzLmVkaXRvcnNbY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyXTtcblx0XHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdFx0ZWRpdG9yRnVuYyA9IHRoaXMuZWRpdG9yc1tcImlucHV0XCJdO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkVkaXRvciBFcnJvciAtIENhbm5vdCBhdXRvIGxvb2t1cCBlZGl0b3IgZm9yIGEgY3VzdG9tIGZvcm1hdHRlcjogXCIsIGNvbHVtbi5kZWZpbml0aW9uLmZvcm1hdHRlcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdHJldHVybiBlZGl0b3JGdW5jO1xuXHR9XG5cdFxuXHRnZXRDdXJyZW50Q2VsbCgpe1xuXHRcdHJldHVybiB0aGlzLmN1cnJlbnRDZWxsID8gdGhpcy5jdXJyZW50Q2VsbC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xuXHR9XG5cdFxuXHRjbGVhckVkaXRvcihjYW5jZWwpe1xuXHRcdHZhciBjZWxsID0gdGhpcy5jdXJyZW50Q2VsbCxcblx0XHRjZWxsRWw7XG5cdFx0XG5cdFx0dGhpcy5pbnZhbGlkRWRpdCA9IGZhbHNlO1xuXHRcdFxuXHRcdGlmKGNlbGwpe1xuXHRcdFx0dGhpcy5jdXJyZW50Q2VsbCA9IGZhbHNlO1xuXHRcdFx0XG5cdFx0XHRjZWxsRWwgPSBjZWxsLmdldEVsZW1lbnQoKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5kaXNwYXRjaChcImVkaXQtZWRpdG9yLWNsZWFyXCIsIGNlbGwsIGNhbmNlbCk7XG5cdFx0XHRcblx0XHRcdGNlbGxFbC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWVkaXRpbmdcIik7XG5cdFx0XHRcblx0XHRcdHdoaWxlKGNlbGxFbC5maXJzdENoaWxkKSBjZWxsRWwucmVtb3ZlQ2hpbGQoY2VsbEVsLmZpcnN0Q2hpbGQpO1xuXHRcdFx0XG5cdFx0XHRjZWxsLnJvdy5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1lZGl0aW5nXCIpO1xuXHRcdFx0XG5cdFx0XHRjZWxsLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1lZGl0aW5nXCIpO1xuXHRcdH1cblx0fVxuXHRcblx0Y2FuY2VsRWRpdCgpe1xuXHRcdGlmKHRoaXMuY3VycmVudENlbGwpe1xuXHRcdFx0dmFyIGNlbGwgPSB0aGlzLmN1cnJlbnRDZWxsO1xuXHRcdFx0dmFyIGNvbXBvbmVudCA9IHRoaXMuY3VycmVudENlbGwuZ2V0Q29tcG9uZW50KCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuY2xlYXJFZGl0b3IodHJ1ZSk7XG5cdFx0XHRjZWxsLnNldFZhbHVlQWN0dWFsKGNlbGwuZ2V0VmFsdWUoKSk7XG5cdFx0XHRjZWxsLmNlbGxSZW5kZXJlZCgpO1xuXHRcdFx0XG5cdFx0XHRpZihjZWxsLmNvbHVtbi5kZWZpbml0aW9uLmVkaXRvciA9PSBcInRleHRhcmVhXCIgfHwgY2VsbC5jb2x1bW4uZGVmaW5pdGlvbi52YXJpYWJsZUhlaWdodCl7XG5cdFx0XHRcdGNlbGwucm93Lm5vcm1hbGl6ZUhlaWdodCh0cnVlKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoY2VsbC5jb2x1bW4uZGVmaW5pdGlvbi5jZWxsRWRpdENhbmNlbGxlZCl7XG5cdFx0XHRcdGNlbGwuY29sdW1uLmRlZmluaXRpb24uY2VsbEVkaXRDYW5jZWxsZWQuY2FsbCh0aGlzLnRhYmxlLCBjb21wb25lbnQpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwiZWRpdC1jYW5jZWxsZWRcIiwgY2VsbCk7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJjZWxsRWRpdENhbmNlbGxlZFwiLCBjb21wb25lbnQpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9yZXR1cm4gYSBmb3JtYXR0ZWQgdmFsdWUgZm9yIGEgY2VsbFxuXHRiaW5kRWRpdG9yKGNlbGwpe1xuXHRcdGlmKGNlbGwuY29sdW1uLm1vZHVsZXMuZWRpdCl7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRlbGVtZW50ID0gY2VsbC5nZXRFbGVtZW50KHRydWUpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnVwZGF0ZUNlbGxDbGFzcyhjZWxsKTtcblx0XHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgMCk7XG5cdFx0XHRcblx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0aWYgKGUuYnV0dG9uID09PSAyKSB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0c2VsZi5tb3VzZUNsaWNrID0gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmKHRoaXMub3B0aW9ucyhcImVkaXRUcmlnZ2VyRXZlbnRcIikgPT09IFwiZGJsY2xpY2tcIil7XG5cdFx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHRcdGlmKCFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcInRhYnVsYXRvci1lZGl0aW5nXCIpKXtcblx0XHRcdFx0XHRcdGVsZW1lbnQuZm9jdXMoe3ByZXZlbnRTY3JvbGw6IHRydWV9KTtcblx0XHRcdFx0XHRcdHNlbGYuZWRpdChjZWxsLCBlLCBmYWxzZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLm9wdGlvbnMoXCJlZGl0VHJpZ2dlckV2ZW50XCIpID09PSBcImZvY3VzXCIgfHwgdGhpcy5vcHRpb25zKFwiZWRpdFRyaWdnZXJFdmVudFwiKSA9PT0gXCJjbGlja1wiKXtcblx0XHRcdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSl7XG5cdFx0XHRcdFx0aWYoIWVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidGFidWxhdG9yLWVkaXRpbmdcIikpe1xuXHRcdFx0XHRcdFx0ZWxlbWVudC5mb2N1cyh7cHJldmVudFNjcm9sbDogdHJ1ZX0pO1xuXHRcdFx0XHRcdFx0c2VsZi5lZGl0KGNlbGwsIGUsIGZhbHNlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLm9wdGlvbnMoXCJlZGl0VHJpZ2dlckV2ZW50XCIpID09PSBcImZvY3VzXCIpe1xuXHRcdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0XHRpZighc2VsZi5yZWN1cnNpb25CbG9jayl7XG5cdFx0XHRcdFx0XHRzZWxmLmVkaXQoY2VsbCwgZSwgZmFsc2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRmb2N1c0NlbGxOb0V2ZW50KGNlbGwsIGJsb2NrKXtcblx0XHR0aGlzLnJlY3Vyc2lvbkJsb2NrID0gdHJ1ZTtcblx0XHRcblx0XHRpZighKGJsb2NrICYmIHRoaXMudGFibGUuYnJvd3NlciA9PT0gXCJpZVwiKSl7XG5cdFx0XHRjZWxsLmdldEVsZW1lbnQoKS5mb2N1cyh7cHJldmVudFNjcm9sbDogdHJ1ZX0pO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnJlY3Vyc2lvbkJsb2NrID0gZmFsc2U7XG5cdH1cblx0XG5cdGVkaXRDZWxsKGNlbGwsIGZvcmNlRWRpdCl7XG5cdFx0dGhpcy5mb2N1c0NlbGxOb0V2ZW50KGNlbGwpO1xuXHRcdHRoaXMuZWRpdChjZWxsLCBmYWxzZSwgZm9yY2VFZGl0KTtcblx0fVxuXHRcblx0Zm9jdXNTY3JvbGxBZGp1c3QoY2VsbCl7XG5cdFx0aWYodGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFJlbmRlck1vZGUoKSA9PSBcInZpcnR1YWxcIil7XG5cdFx0XHR2YXIgdG9wRWRnZSA9IHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbFRvcCxcblx0XHRcdGJvdHRvbUVkZ2UgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRIZWlnaHQgKyB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxUb3AsXG5cdFx0XHRyb3dFbCA9IGNlbGwucm93LmdldEVsZW1lbnQoKTtcblx0XHRcdFxuXHRcdFx0aWYocm93RWwub2Zmc2V0VG9wIDwgdG9wRWRnZSl7XG5cdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbFRvcCAtPSAodG9wRWRnZSAtIHJvd0VsLm9mZnNldFRvcCk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKHJvd0VsLm9mZnNldFRvcCArIHJvd0VsLm9mZnNldEhlaWdodCAgPiBib3R0b21FZGdlKXtcblx0XHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxUb3AgKz0gKHJvd0VsLm9mZnNldFRvcCArIHJvd0VsLm9mZnNldEhlaWdodCAtIGJvdHRvbUVkZ2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHZhciBsZWZ0RWRnZSA9IHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbExlZnQsXG5cdFx0XHRyaWdodEVkZ2UgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRXaWR0aCArIHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbExlZnQsXG5cdFx0XHRjZWxsRWwgPSBjZWxsLmdldEVsZW1lbnQoKTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJmcm96ZW5Db2x1bW5zXCIpKXtcblx0XHRcdFx0bGVmdEVkZ2UgKz0gcGFyc2VJbnQodGhpcy50YWJsZS5tb2R1bGVzLmZyb3plbkNvbHVtbnMubGVmdE1hcmdpbiB8fCAwKTtcblx0XHRcdFx0cmlnaHRFZGdlIC09IHBhcnNlSW50KHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLnJpZ2h0TWFyZ2luIHx8IDApO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucmVuZGVySG9yaXpvbnRhbCA9PT0gXCJ2aXJ0dWFsXCIpe1xuXHRcdFx0XHRsZWZ0RWRnZSAtPSBwYXJzZUludCh0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIucmVuZGVyZXIudkRvbVBhZExlZnQpO1xuXHRcdFx0XHRyaWdodEVkZ2UgLT0gcGFyc2VJbnQodGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLnJlbmRlcmVyLnZEb21QYWRMZWZ0KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoY2VsbEVsLm9mZnNldExlZnQgPCBsZWZ0RWRnZSl7XG5cdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbExlZnQgLT0gKGxlZnRFZGdlIC0gY2VsbEVsLm9mZnNldExlZnQpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRpZihjZWxsRWwub2Zmc2V0TGVmdCArIGNlbGxFbC5vZmZzZXRXaWR0aCAgPiByaWdodEVkZ2Upe1xuXHRcdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbExlZnQgKz0gKGNlbGxFbC5vZmZzZXRMZWZ0ICsgY2VsbEVsLm9mZnNldFdpZHRoIC0gcmlnaHRFZGdlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0YWxsb3dFZGl0KGNlbGwpIHtcblx0XHR2YXIgY2hlY2sgPSBjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQgPyB0cnVlIDogZmFsc2U7XG5cdFx0XG5cdFx0aWYoY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0KXtcblx0XHRcdHN3aXRjaCh0eXBlb2YgY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LmNoZWNrKXtcblx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdFx0aWYoY2VsbC5yb3cuaW5pdGlhbGl6ZWQpe1xuXHRcdFx0XHRcdFx0Y2hlY2sgPSBjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQuY2hlY2soY2VsbC5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcblx0XHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRcdGNoZWNrID0gISFjZWxsLnJvdy5kYXRhW2NlbGwuY29sdW1uLm1vZHVsZXMuZWRpdC5jaGVja107XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFxuXHRcdFx0XHRjYXNlIFwiYm9vbGVhblwiOlxuXHRcdFx0XHRcdGNoZWNrID0gY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LmNoZWNrO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gY2hlY2s7XG5cdH1cblx0XG5cdGVkaXQoY2VsbCwgZSwgZm9yY2VFZGl0KXtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0YWxsb3dFZGl0ID0gdHJ1ZSxcblx0XHRyZW5kZXJlZCA9IGZ1bmN0aW9uKCl7fSxcblx0XHRlbGVtZW50ID0gY2VsbC5nZXRFbGVtZW50KCksXG5cdFx0ZWRpdEZpbmlzaGVkID0gZmFsc2UsXG5cdFx0Y2VsbEVkaXRvciwgY29tcG9uZW50LCBwYXJhbXM7XG5cblx0XHQvL3ByZXZlbnQgZWRpdGluZyBpZiBhbm90aGVyIGNlbGwgaXMgcmVmdXNpbmcgdG8gbGVhdmUgZm9jdXMgKGVnLiB2YWxpZGF0aW9uIGZhaWwpXG5cdFx0XG5cdFx0aWYodGhpcy5jdXJyZW50Q2VsbCl7XG5cdFx0XHRpZighdGhpcy5pbnZhbGlkRWRpdCAmJiB0aGlzLmN1cnJlbnRDZWxsICE9PSBjZWxsKXtcblx0XHRcdFx0dGhpcy5jYW5jZWxFZGl0KCk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vaGFuZGxlIHN1Y2Nlc3NmdWwgdmFsdWUgY2hhbmdlXG5cdFx0ZnVuY3Rpb24gc3VjY2Vzcyh2YWx1ZSl7XG5cdFx0XHRpZihzZWxmLmN1cnJlbnRDZWxsID09PSBjZWxsICYmICFlZGl0RmluaXNoZWQpe1xuXHRcdFx0XHR2YXIgdmFsaWQgPSBzZWxmLmNoYWluKFwiZWRpdC1zdWNjZXNzXCIsIFtjZWxsLCB2YWx1ZV0sIHRydWUsIHRydWUpO1xuXG5cdFx0XHRcdGlmKHZhbGlkID09PSB0cnVlIHx8IHNlbGYudGFibGUub3B0aW9ucy52YWxpZGF0aW9uTW9kZSA9PT0gXCJoaWdobGlnaHRcIil7XG5cblx0XHRcdFx0XHRlZGl0RmluaXNoZWQgPSB0cnVlO1xuXG5cdFx0XHRcdFx0c2VsZi5jbGVhckVkaXRvcigpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKCFjZWxsLm1vZHVsZXMuZWRpdCl7XG5cdFx0XHRcdFx0XHRjZWxsLm1vZHVsZXMuZWRpdCA9IHt9O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjZWxsLm1vZHVsZXMuZWRpdC5lZGl0ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKHNlbGYuZWRpdGVkQ2VsbHMuaW5kZXhPZihjZWxsKSA9PSAtMSl7XG5cdFx0XHRcdFx0XHRzZWxmLmVkaXRlZENlbGxzLnB1c2goY2VsbCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFsdWUgPSBzZWxmLnRyYW5zZm9ybUVtcHR5VmFsdWVzKHZhbHVlLCBjZWxsKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjZWxsLnNldFZhbHVlKHZhbHVlLCB0cnVlKTtcblxuXHRcdFx0XHRcdHJldHVybiB2YWxpZCA9PT0gdHJ1ZTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGVkaXRGaW5pc2hlZCA9IHRydWU7XG5cdFx0XHRcdFx0c2VsZi5pbnZhbGlkRWRpdCA9IHRydWU7XG5cdFx0XHRcdFx0c2VsZi5mb2N1c0NlbGxOb0V2ZW50KGNlbGwsIHRydWUpO1xuXHRcdFx0XHRcdHJlbmRlcmVkKCk7XG5cblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdGVkaXRGaW5pc2hlZCA9IGZhbHNlO1xuXHRcdFx0XHRcdH0sIDEwKTtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly9oYW5kbGUgYWJvcnRlZCBlZGl0XG5cdFx0ZnVuY3Rpb24gY2FuY2VsKCl7XG5cdFx0XHQvLyBlZGl0RmluaXNoZWQgPSB0cnVlO1xuXG5cdFx0XHRpZihzZWxmLmN1cnJlbnRDZWxsID09PSBjZWxsICYmICFlZGl0RmluaXNoZWQpe1xuXHRcdFx0XHRzZWxmLmNhbmNlbEVkaXQoKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0ZnVuY3Rpb24gb25SZW5kZXJlZChjYWxsYmFjayl7XG5cdFx0XHRyZW5kZXJlZCA9IGNhbGxiYWNrO1xuXHRcdH1cblx0XHRcblx0XHRpZighY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LmJsb2NrZWQpe1xuXHRcdFx0aWYoZSl7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGFsbG93RWRpdCA9IHRoaXMuYWxsb3dFZGl0KGNlbGwpO1xuXHRcdFx0XG5cdFx0XHRpZihhbGxvd0VkaXQgfHwgZm9yY2VFZGl0KXtcblx0XHRcdFx0c2VsZi5jYW5jZWxFZGl0KCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRzZWxmLmN1cnJlbnRDZWxsID0gY2VsbDtcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuZm9jdXNTY3JvbGxBZGp1c3QoY2VsbCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb21wb25lbnQgPSBjZWxsLmdldENvbXBvbmVudCgpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodGhpcy5tb3VzZUNsaWNrKXtcblx0XHRcdFx0XHR0aGlzLm1vdXNlQ2xpY2sgPSBmYWxzZTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihjZWxsLmNvbHVtbi5kZWZpbml0aW9uLmNlbGxDbGljayl7XG5cdFx0XHRcdFx0XHRjZWxsLmNvbHVtbi5kZWZpbml0aW9uLmNlbGxDbGljay5jYWxsKHRoaXMudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihjZWxsLmNvbHVtbi5kZWZpbml0aW9uLmNlbGxFZGl0aW5nKXtcblx0XHRcdFx0XHRjZWxsLmNvbHVtbi5kZWZpbml0aW9uLmNlbGxFZGl0aW5nLmNhbGwodGhpcy50YWJsZSwgY29tcG9uZW50KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5kaXNwYXRjaChcImNlbGwtZWRpdGluZ1wiLCBjZWxsKTtcblx0XHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiY2VsbEVkaXRpbmdcIiwgY29tcG9uZW50KTtcblx0XHRcdFx0XG5cdFx0XHRcdHBhcmFtcyA9IHR5cGVvZiBjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQucGFyYW1zID09PSBcImZ1bmN0aW9uXCIgPyBjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQucGFyYW1zKGNvbXBvbmVudCkgOiBjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQucGFyYW1zO1xuXHRcdFx0XHRcblx0XHRcdFx0Y2VsbEVkaXRvciA9IGNlbGwuY29sdW1uLm1vZHVsZXMuZWRpdC5lZGl0b3IuY2FsbChzZWxmLCBjb21wb25lbnQsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgcGFyYW1zKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vaWYgZWRpdG9yIHJldHVybmVkLCBhZGQgdG8gRE9NLCBpZiBmYWxzZSwgYWJvcnQgZWRpdFxuXHRcdFx0XHRpZih0aGlzLmN1cnJlbnRDZWxsICYmIGNlbGxFZGl0b3IgIT09IGZhbHNlKXtcblx0XHRcdFx0XHRpZihjZWxsRWRpdG9yIGluc3RhbmNlb2YgTm9kZSl7XG5cdFx0XHRcdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZWRpdGluZ1wiKTtcblx0XHRcdFx0XHRcdGNlbGwucm93LmdldEVsZW1lbnQoKS5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWVkaXRpbmdcIik7XG5cdFx0XHRcdFx0XHRjZWxsLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1lZGl0aW5nXCIpO1xuXHRcdFx0XHRcdFx0d2hpbGUoZWxlbWVudC5maXJzdENoaWxkKSBlbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdFx0XHRcdFx0XHRlbGVtZW50LmFwcGVuZENoaWxkKGNlbGxFZGl0b3IpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvL3RyaWdnZXIgb25SZW5kZXJlZCBDYWxsYmFja1xuXHRcdFx0XHRcdFx0cmVuZGVyZWQoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly9wcmV2ZW50IGVkaXRpbmcgZnJvbSB0cmlnZ2VyaW5nIHJvd0NsaWNrIGV2ZW50XG5cdFx0XHRcdFx0XHR2YXIgY2hpbGRyZW4gPSBlbGVtZW50LmNoaWxkcmVuO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdGNoaWxkcmVuW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJFZGl0IEVycm9yIC0gRWRpdG9yIHNob3VsZCByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgTm9kZSwgdGhlIGVkaXRvciByZXR1cm5lZDpcIiwgY2VsbEVkaXRvcik7XG5cdFx0XHRcdFx0XHR0aGlzLmJsdXIoZWxlbWVudCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5ibHVyKGVsZW1lbnQpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMubW91c2VDbGljayA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLmJsdXIoZWxlbWVudCk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLm1vdXNlQ2xpY2sgPSBmYWxzZTtcblx0XHRcdHRoaXMuYmx1cihlbGVtZW50KTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRlbXB0eVZhbHVlQ2hlY2sodmFsdWUpe1xuXHRcdHJldHVybiB2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCI7XG5cdH1cblxuXHR0cmFuc2Zvcm1FbXB0eVZhbHVlcyh2YWx1ZSwgY2VsbCl7XG5cdFx0dmFyIG1vZCA9IGNlbGwuY29sdW1uLm1vZHVsZXMuZWRpdCwgXG5cdFx0Y29udmVydCA9IG1vZC5jb252ZXJ0RW1wdHlWYWx1ZXMgfHwgdGhpcy5jb252ZXJ0RW1wdHlWYWx1ZXMsXG5cdFx0Y2hlY2tGdW5jO1xuXHRcdFxuXHRcdGlmKGNvbnZlcnQpe1xuXHRcdFx0Y2hlY2tGdW5jID0gbW9kLmVkaXRvckVtcHR5VmFsdWVGdW5jIHx8IHRoaXMub3B0aW9ucyhcImVkaXRvckVtcHR5VmFsdWVGdW5jXCIpO1xuXG5cdFx0XHRpZihjaGVja0Z1bmMgJiYgY2hlY2tGdW5jKHZhbHVlKSl7XG5cdFx0XHRcdHZhbHVlID0gbW9kLmNvbnZlcnRFbXB0eVZhbHVlcyA/IG1vZC5lZGl0b3JFbXB0eVZhbHVlIDogdGhpcy5vcHRpb25zKFwiZWRpdG9yRW1wdHlWYWx1ZVwiKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9XG5cdFxuXHRibHVyKGVsZW1lbnQpe1xuXHRcdGlmKCF0aGlzLmNvbmZpcm0oXCJlZGl0LWJsdXJcIiwgW2VsZW1lbnRdKSApe1xuXHRcdFx0ZWxlbWVudC5ibHVyKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRnZXRFZGl0ZWRDZWxscygpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcblx0XHR0aGlzLmVkaXRlZENlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcblx0XHRcdG91dHB1dC5wdXNoKGNlbGwuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblx0XG5cdGNsZWFyRWRpdGVkKGNlbGwpe1xuXHRcdHZhciBlZGl0SW5kZXg7XG5cdFx0XG5cdFx0aWYoY2VsbC5tb2R1bGVzLmVkaXQgJiYgY2VsbC5tb2R1bGVzLmVkaXQuZWRpdGVkKXtcblx0XHRcdGNlbGwubW9kdWxlcy5lZGl0LmVkaXRlZCA9IGZhbHNlO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwiZWRpdC1lZGl0ZWQtY2xlYXJcIiwgY2VsbCk7XG5cdFx0fVxuXHRcdFxuXHRcdGVkaXRJbmRleCA9IHRoaXMuZWRpdGVkQ2VsbHMuaW5kZXhPZihjZWxsKTtcblx0XHRcblx0XHRpZihlZGl0SW5kZXggPiAtMSl7XG5cdFx0XHR0aGlzLmVkaXRlZENlbGxzLnNwbGljZShlZGl0SW5kZXgsIDEpO1xuXHRcdH1cblx0fVxufVxuXG5jbGFzcyBFeHBvcnRSb3d7XG5cdGNvbnN0cnVjdG9yKHR5cGUsIGNvbHVtbnMsIGNvbXBvbmVudCwgaW5kZW50KXtcblx0XHR0aGlzLnR5cGUgPSB0eXBlO1xuXHRcdHRoaXMuY29sdW1ucyA9IGNvbHVtbnM7XG5cdFx0dGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQgfHwgZmFsc2U7XG5cdFx0dGhpcy5pbmRlbnQgPSBpbmRlbnQgfHwgMDtcblx0fVxufVxuXG5jbGFzcyBFeHBvcnRDb2x1bW57XG5cdGNvbnN0cnVjdG9yKHZhbHVlLCBjb21wb25lbnQsIHdpZHRoLCBoZWlnaHQsIGRlcHRoKXtcblx0XHR0aGlzLnZhbHVlID0gdmFsdWU7XG5cdFx0dGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQgfHwgZmFsc2U7XG5cdFx0dGhpcy53aWR0aCA9IHdpZHRoO1xuXHRcdHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXHRcdHRoaXMuZGVwdGggPSBkZXB0aDtcblx0fVxufVxuXG52YXIgY29sdW1uTG9va3VwcyQxID0ge1xyXG5cclxufTtcblxudmFyIHJvd0xvb2t1cHMkMSA9IHtcclxuXHR2aXNpYmxlOmZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLmdldFZpc2libGVSb3dzKGZhbHNlLCB0cnVlKTtcclxuXHR9LFxyXG5cdGFsbDpmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIHRoaXMucm93TWFuYWdlci5yb3dzO1xyXG5cdH0sXHJcblx0c2VsZWN0ZWQ6ZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMuc2VsZWN0Um93LnNlbGVjdGVkUm93cztcclxuXHR9LFxyXG5cdGFjdGl2ZTpmdW5jdGlvbigpe1xyXG5cdFx0aWYodGhpcy5vcHRpb25zLnBhZ2luYXRpb24pe1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKHRoaXMucm93TWFuYWdlci5kaXNwbGF5Um93cy5sZW5ndGggLSAyKTtcclxuXHRcdH1lbHNlIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMucm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpO1xyXG5cdFx0fVxyXG5cdH0sXHJcbn07XG5cbmNsYXNzIEV4cG9ydCBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwiZXhwb3J0XCI7XG5cblx0c3RhdGljIGNvbHVtbkxvb2t1cHMgPSBjb2x1bW5Mb29rdXBzJDE7XG5cdHN0YXRpYyByb3dMb29rdXBzID0gcm93TG9va3VwcyQxO1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLmNvbmZpZyA9IHt9O1xuXHRcdHRoaXMuY2xvbmVUYWJsZVN0eWxlID0gdHJ1ZTtcblx0XHR0aGlzLmNvbFZpc1Byb3AgPSBcIlwiO1xuXHRcdHRoaXMuY29sVmlzUHJvcEF0dGFjaCA9IFwiXCI7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiaHRtbE91dHB1dENvbmZpZ1wiLCBmYWxzZSk7IC8vaHRtbCBvdXRwdXQgY29uZmlnXG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImh0bWxPdXRwdXRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInRpdGxlSHRtbE91dHB1dFwiKTtcblx0fVxuXHRcblx0aW5pdGlhbGl6ZSgpe1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0SHRtbFwiLCB0aGlzLmdldEh0bWwuYmluZCh0aGlzKSk7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBJbnRlcm5hbCBMb2dpYyAvLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRnZW5lcmF0ZUV4cG9ydExpc3QoY29uZmlnLCBzdHlsZSwgcmFuZ2UsIGNvbFZpc1Byb3Ape1xuXHRcdHZhciBoZWFkZXJzLCBib2R5LCBjb2x1bW5zLCBjb2xMb29rdXA7XG5cblx0XHR0aGlzLmNsb25lVGFibGVTdHlsZSA9IHN0eWxlO1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnIHx8IHt9O1xuXHRcdHRoaXMuY29sVmlzUHJvcCA9IGNvbFZpc1Byb3A7XG5cdFx0dGhpcy5jb2xWaXNQcm9wQXR0YWNoID0gdGhpcy5jb2xWaXNQcm9wLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhpcy5jb2xWaXNQcm9wLnNsaWNlKDEpO1xuXG5cdFx0Y29sTG9va3VwID0gRXhwb3J0LmNvbHVtbkxvb2t1cHNbcmFuZ2VdO1xuXG5cdFx0aWYoY29sTG9va3VwKXtcblx0XHRcdGNvbHVtbnMgPSBjb2xMb29rdXAuY2FsbCh0aGlzLnRhYmxlKTtcblx0XHRcdGNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcihjb2wgPT4gdGhpcy5jb2x1bW5WaXNDaGVjayhjb2wpKTtcblx0XHR9XG5cblx0XHRoZWFkZXJzID0gdGhpcy5jb25maWcuY29sdW1uSGVhZGVycyAhPT0gZmFsc2UgPyB0aGlzLmhlYWRlcnNUb0V4cG9ydFJvd3ModGhpcy5nZW5lcmF0ZUNvbHVtbkdyb3VwSGVhZGVycyhjb2x1bW5zKSkgOiBbXTtcblxuXHRcdGlmKGNvbHVtbnMpe1xuXHRcdFx0Y29sdW1ucyA9IGNvbHVtbnMubWFwKGNvbCA9PiBjb2wuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH1cblx0XHRcblx0XHRib2R5ID0gdGhpcy5ib2R5VG9FeHBvcnRSb3dzKHRoaXMucm93TG9va3VwKHJhbmdlKSwgY29sdW1ucyk7XG5cblx0XHRyZXR1cm4gaGVhZGVycy5jb25jYXQoYm9keSk7XG5cdH1cblx0XG5cdGdlbmVyYXRlVGFibGUoY29uZmlnLCBzdHlsZSwgcmFuZ2UsIGNvbFZpc1Byb3Ape1xuXHRcdHZhciBsaXN0ID0gdGhpcy5nZW5lcmF0ZUV4cG9ydExpc3QoY29uZmlnLCBzdHlsZSwgcmFuZ2UsIGNvbFZpc1Byb3ApO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmdlbmVyYXRlVGFibGVFbGVtZW50KGxpc3QpO1xuXHR9XG5cdFxuXHRyb3dMb29rdXAocmFuZ2Upe1xuXHRcdHZhciByb3dzID0gW10sIFxuXHRcdHJvd0xvb2t1cDtcblx0XHRcblx0XHRpZih0eXBlb2YgcmFuZ2UgPT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdHJhbmdlLmNhbGwodGhpcy50YWJsZSkuZm9yRWFjaCgocm93KSA9Pntcblx0XHRcdFx0cm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpbmRSb3cocm93KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHJvdyl7XG5cdFx0XHRcdFx0cm93cy5wdXNoKHJvdyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJvd0xvb2t1cCA9IEV4cG9ydC5yb3dMb29rdXBzW3JhbmdlXSB8fCBFeHBvcnQucm93TG9va3Vwc1tcImFjdGl2ZVwiXTtcblxuXHRcdFx0cm93cyA9IHJvd0xvb2t1cC5jYWxsKHRoaXMudGFibGUpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gT2JqZWN0LmFzc2lnbihbXSwgcm93cyk7XG5cdH1cblx0XG5cdGdlbmVyYXRlQ29sdW1uR3JvdXBIZWFkZXJzKGNvbHVtbnMpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcblx0XHRpZiAoIWNvbHVtbnMpIHtcblx0XHRcdGNvbHVtbnMgPSB0aGlzLmNvbmZpZy5jb2x1bW5Hcm91cHMgIT09IGZhbHNlID8gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnMgOiB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXg7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHR2YXIgY29sRGF0YSA9IHRoaXMucHJvY2Vzc0NvbHVtbkdyb3VwKGNvbHVtbik7XG5cdFx0XHRcblx0XHRcdGlmKGNvbERhdGEpe1xuXHRcdFx0XHRvdXRwdXQucHVzaChjb2xEYXRhKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cdFxuXHRwcm9jZXNzQ29sdW1uR3JvdXAoY29sdW1uKXtcblx0XHR2YXIgc3ViR3JvdXBzID0gY29sdW1uLmNvbHVtbnMsXG5cdFx0bWF4RGVwdGggPSAwLFxuXHRcdHRpdGxlID0gY29sdW1uLmRlZmluaXRpb25bXCJ0aXRsZVwiICsgKHRoaXMuY29sVmlzUHJvcEF0dGFjaCldIHx8IGNvbHVtbi5kZWZpbml0aW9uLnRpdGxlO1xuXHRcdFxuXHRcdHZhciBncm91cERhdGEgPSB7XG5cdFx0XHR0aXRsZTp0aXRsZSxcblx0XHRcdGNvbHVtbjpjb2x1bW4sXG5cdFx0XHRkZXB0aDoxLFxuXHRcdH07XG5cdFx0XG5cdFx0aWYoc3ViR3JvdXBzLmxlbmd0aCl7XG5cdFx0XHRncm91cERhdGEuc3ViR3JvdXBzID0gW107XG5cdFx0XHRncm91cERhdGEud2lkdGggPSAwO1xuXHRcdFx0XG5cdFx0XHRzdWJHcm91cHMuZm9yRWFjaCgoc3ViR3JvdXApID0+IHtcblx0XHRcdFx0dmFyIHN1Ykdyb3VwRGF0YSA9IHRoaXMucHJvY2Vzc0NvbHVtbkdyb3VwKHN1Ykdyb3VwKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHN1Ykdyb3VwRGF0YSl7XG5cdFx0XHRcdFx0Z3JvdXBEYXRhLndpZHRoICs9IHN1Ykdyb3VwRGF0YS53aWR0aDtcblx0XHRcdFx0XHRncm91cERhdGEuc3ViR3JvdXBzLnB1c2goc3ViR3JvdXBEYXRhKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihzdWJHcm91cERhdGEuZGVwdGggPiBtYXhEZXB0aCl7XG5cdFx0XHRcdFx0XHRtYXhEZXB0aCA9IHN1Ykdyb3VwRGF0YS5kZXB0aDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRncm91cERhdGEuZGVwdGggKz0gbWF4RGVwdGg7XG5cdFx0XHRcblx0XHRcdGlmKCFncm91cERhdGEud2lkdGgpe1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYodGhpcy5jb2x1bW5WaXNDaGVjayhjb2x1bW4pKXtcblx0XHRcdFx0Z3JvdXBEYXRhLndpZHRoID0gMTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gZ3JvdXBEYXRhO1xuXHR9XG5cdFxuXHRjb2x1bW5WaXNDaGVjayhjb2x1bW4pe1xuXHRcdHZhciB2aXNQcm9wID0gY29sdW1uLmRlZmluaXRpb25bdGhpcy5jb2xWaXNQcm9wXTtcblxuXHRcdGlmKHRoaXMuY29uZmlnLnJvd0hlYWRlcnMgPT09IGZhbHNlICYmIGNvbHVtbi5pc1Jvd0hlYWRlcil7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHR5cGVvZiB2aXNQcm9wID09PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0dmlzUHJvcCA9IHZpc1Byb3AuY2FsbCh0aGlzLnRhYmxlLCBjb2x1bW4uZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH1cblxuXHRcdGlmKHZpc1Byb3AgPT09IGZhbHNlIHx8IHZpc1Byb3AgPT09IHRydWUpe1xuXHRcdFx0cmV0dXJuIHZpc1Byb3A7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbHVtbi52aXNpYmxlICYmIGNvbHVtbi5maWVsZDtcblx0fVxuXHRcblx0aGVhZGVyc1RvRXhwb3J0Um93cyhjb2x1bW5zKXtcblx0XHR2YXIgaGVhZGVycyA9IFtdLFxuXHRcdGhlYWRlckRlcHRoID0gMCxcblx0XHRleHBvcnRSb3dzID0gW107XG5cdFx0XG5cdFx0ZnVuY3Rpb24gcGFyc2VDb2x1bW5Hcm91cChjb2x1bW4sIGxldmVsKXtcblx0XHRcdFxuXHRcdFx0dmFyIGRlcHRoID0gaGVhZGVyRGVwdGggLSBsZXZlbDtcblx0XHRcdFxuXHRcdFx0aWYodHlwZW9mIGhlYWRlcnNbbGV2ZWxdID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdFx0aGVhZGVyc1tsZXZlbF0gPSBbXTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Y29sdW1uLmhlaWdodCA9IGNvbHVtbi5zdWJHcm91cHMgPyAxIDogKGRlcHRoIC0gY29sdW1uLmRlcHRoKSArIDE7XG5cdFx0XHRcblx0XHRcdGhlYWRlcnNbbGV2ZWxdLnB1c2goY29sdW1uKTtcblx0XHRcdFxuXHRcdFx0aWYoY29sdW1uLmhlaWdodCA+IDEpe1xuXHRcdFx0XHRmb3IobGV0IGkgPSAxOyBpIDwgY29sdW1uLmhlaWdodDsgaSArKyl7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYodHlwZW9mIGhlYWRlcnNbbGV2ZWwgKyBpXSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0XHRoZWFkZXJzW2xldmVsICsgaV0gPSBbXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aGVhZGVyc1tsZXZlbCArIGldLnB1c2goZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbi53aWR0aCA+IDEpe1xuXHRcdFx0XHRmb3IobGV0IGkgPSAxOyBpIDwgY29sdW1uLndpZHRoOyBpICsrKXtcblx0XHRcdFx0XHRoZWFkZXJzW2xldmVsXS5wdXNoKGZhbHNlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihjb2x1bW4uc3ViR3JvdXBzKXtcblx0XHRcdFx0Y29sdW1uLnN1Ykdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uKHN1Ykdyb3VwKXtcblx0XHRcdFx0XHRwYXJzZUNvbHVtbkdyb3VwKHN1Ykdyb3VwLCBsZXZlbCsxKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vY2FsY3VsYXRlIG1heGltdW0gaGVhZGVyIGRlcHRoXG5cdFx0Y29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7XG5cdFx0XHRpZihjb2x1bW4uZGVwdGggPiBoZWFkZXJEZXB0aCl7XG5cdFx0XHRcdGhlYWRlckRlcHRoID0gY29sdW1uLmRlcHRoO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdFx0cGFyc2VDb2x1bW5Hcm91cChjb2x1bW4sMCk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0aGVhZGVycy5mb3JFYWNoKChoZWFkZXIpID0+IHtcblx0XHRcdHZhciBjb2x1bW5zID0gW107XG5cdFx0XHRcblx0XHRcdGhlYWRlci5mb3JFYWNoKChjb2wpID0+IHtcblx0XHRcdFx0aWYoY29sKXtcblx0XHRcdFx0XHRsZXQgdGl0bGUgPSB0eXBlb2YgY29sLnRpdGxlID09PSBcInVuZGVmaW5lZFwiID8gXCJcIiA6IGNvbC50aXRsZTtcblx0XHRcdFx0XHRjb2x1bW5zLnB1c2gobmV3IEV4cG9ydENvbHVtbih0aXRsZSwgY29sLmNvbHVtbi5nZXRDb21wb25lbnQoKSwgY29sLndpZHRoLCBjb2wuaGVpZ2h0LCBjb2wuZGVwdGgpKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvbHVtbnMucHVzaChudWxsKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdGV4cG9ydFJvd3MucHVzaChuZXcgRXhwb3J0Um93KFwiaGVhZGVyXCIsIGNvbHVtbnMpKTtcblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gZXhwb3J0Um93cztcblx0fVxuXHRcblx0Ym9keVRvRXhwb3J0Um93cyhyb3dzLCBjb2x1bW5zID0gW10pe1xuXHRcdHZhciBleHBvcnRSb3dzID0gW107XG5cdFx0XG5cdFx0aWYgKGNvbHVtbnMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXguZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdGlmICh0aGlzLmNvbHVtblZpc0NoZWNrKGNvbHVtbikpIHtcblx0XHRcdFx0XHRjb2x1bW5zLnB1c2goY29sdW1uLmdldENvbXBvbmVudCgpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMuY29uZmlnLmNvbHVtbkNhbGNzICE9PSBmYWxzZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKXtcblx0XHRcdGlmKHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy50b3BJbml0aWFsaXplZCl7XG5cdFx0XHRcdHJvd3MudW5zaGlmdCh0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MudG9wUm93KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYodGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLmJvdEluaXRpYWxpemVkKXtcblx0XHRcdFx0cm93cy5wdXNoKHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5ib3RSb3cpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJvd3MgPSByb3dzLmZpbHRlcigocm93KSA9PiB7XG5cdFx0XHRzd2l0Y2gocm93LnR5cGUpe1xuXHRcdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5jb25maWcucm93R3JvdXBzICE9PSBmYWxzZTtcblx0XHRcdFx0XG5cdFx0XHRcdGNhc2UgXCJjYWxjXCI6XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuY29uZmlnLmNvbHVtbkNhbGNzICE9PSBmYWxzZTtcblx0XHRcdFx0XG5cdFx0XHRcdGNhc2UgXCJyb3dcIjpcblx0XHRcdFx0XHRyZXR1cm4gISh0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUgJiYgdGhpcy5jb25maWcuZGF0YVRyZWUgPT09IGZhbHNlICYmIHJvdy5tb2R1bGVzLmRhdGFUcmVlLnBhcmVudCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJvd3MuZm9yRWFjaCgocm93LCBpKSA9PiB7XG5cdFx0XHR2YXIgcm93RGF0YSA9IHJvdy5nZXREYXRhKHRoaXMuY29sVmlzUHJvcCk7XG5cdFx0XHR2YXIgZXhwb3J0Q29scyA9IFtdO1xuXHRcdFx0dmFyIGluZGVudCA9IDA7XG5cdFx0XHRcblx0XHRcdHN3aXRjaChyb3cudHlwZSl7XG5cdFx0XHRcdGNhc2UgXCJncm91cFwiOlxuXHRcdFx0XHRcdGluZGVudCA9IHJvdy5sZXZlbDtcblx0XHRcdFx0XHRleHBvcnRDb2xzLnB1c2gobmV3IEV4cG9ydENvbHVtbihyb3cua2V5LCByb3cuZ2V0Q29tcG9uZW50KCksIGNvbHVtbnMubGVuZ3RoLCAxKSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFxuXHRcdFx0XHRjYXNlIFwiY2FsY1wiIDpcblx0XHRcdFx0Y2FzZSBcInJvd1wiIDpcblx0XHRcdFx0XHRjb2x1bW5zLmZvckVhY2goKGNvbCkgPT4ge1xuXHRcdFx0XHRcdFx0ZXhwb3J0Q29scy5wdXNoKG5ldyBFeHBvcnRDb2x1bW4oY29sLl9jb2x1bW4uZ2V0RmllbGRWYWx1ZShyb3dEYXRhKSwgY29sLCAxLCAxKSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZSAmJiB0aGlzLmNvbmZpZy5kYXRhVHJlZSAhPT0gZmFsc2Upe1xuXHRcdFx0XHRcdFx0aW5kZW50ID0gcm93Lm1vZHVsZXMuZGF0YVRyZWUuaW5kZXg7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRleHBvcnRSb3dzLnB1c2gobmV3IEV4cG9ydFJvdyhyb3cudHlwZSwgZXhwb3J0Q29scywgcm93LmdldENvbXBvbmVudCgpLCBpbmRlbnQpKTtcblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gZXhwb3J0Um93cztcblx0fVxuXHRcblx0Z2VuZXJhdGVUYWJsZUVsZW1lbnQobGlzdCl7XG5cdFx0dmFyIHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRhYmxlXCIpLFxuXHRcdGhlYWRlckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRoZWFkXCIpLFxuXHRcdGJvZHlFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiKSxcblx0XHRzdHlsZXMgPSB0aGlzLmxvb2t1cFRhYmxlU3R5bGVzKCksXG5cdFx0cm93Rm9ybWF0dGVyID0gdGhpcy50YWJsZS5vcHRpb25zW1wicm93Rm9ybWF0dGVyXCIgKyAodGhpcy5jb2xWaXNQcm9wQXR0YWNoKV0sXG5cdFx0c2V0dXAgPSB7fTtcblx0XHRcblx0XHRzZXR1cC5yb3dGb3JtYXR0ZXIgPSByb3dGb3JtYXR0ZXIgIT09IG51bGwgPyByb3dGb3JtYXR0ZXIgOiB0aGlzLnRhYmxlLm9wdGlvbnMucm93Rm9ybWF0dGVyO1xuXHRcdFxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZSAmJnRoaXMuY29uZmlnLmRhdGFUcmVlICE9PSBmYWxzZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKXtcblx0XHRcdHNldHVwLnRyZWVFbGVtZW50RmllbGQgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuZWxlbWVudEZpZWxkO1xuXHRcdH1cblx0XHRcblx0XHQvL2Fzc2lnbiBncm91cCBoZWFkZXIgZm9ybWF0dGVyXG5cdFx0c2V0dXAuZ3JvdXBIZWFkZXIgPSB0aGlzLnRhYmxlLm9wdGlvbnNbXCJncm91cEhlYWRlclwiICsgKHRoaXMuY29sVmlzUHJvcEF0dGFjaCldO1xuXHRcdFxuXHRcdGlmKHNldHVwLmdyb3VwSGVhZGVyICYmICFBcnJheS5pc0FycmF5KHNldHVwLmdyb3VwSGVhZGVyKSl7XG5cdFx0XHRzZXR1cC5ncm91cEhlYWRlciA9IFtzZXR1cC5ncm91cEhlYWRlcl07XG5cdFx0fVxuXHRcdFxuXHRcdHRhYmxlLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJpbnQtdGFibGVcIik7XG5cdFx0XG5cdFx0dGhpcy5tYXBFbGVtZW50U3R5bGVzKHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRIZWFkZXJzRWxlbWVudCgpLCBoZWFkZXJFbCwgW1wiYm9yZGVyLXRvcFwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiLCBcImJhY2tncm91bmQtY29sb3JcIiwgXCJjb2xvclwiLCBcImZvbnQtd2VpZ2h0XCIsIFwiZm9udC1mYW1pbHlcIiwgXCJmb250LXNpemVcIl0pO1xuXG5cdFx0aWYobGlzdC5sZW5ndGggPiAxMDAwKXtcblx0XHRcdGNvbnNvbGUud2FybihcIkl0IG1heSB0YWtlIGEgbG9uZyB0aW1lIHRvIHJlbmRlciBhbiBIVE1MIHRhYmxlIHdpdGggbW9yZSB0aGFuIDEwMDAgcm93c1wiKTtcblx0XHR9XG5cdFx0XG5cdFx0bGlzdC5mb3JFYWNoKChyb3csIGkpID0+IHtcblx0XHRcdGxldCByb3dFbDtcblx0XHRcdFxuXHRcdFx0c3dpdGNoKHJvdy50eXBlKXtcblx0XHRcdFx0Y2FzZSBcImhlYWRlclwiOlxuXHRcdFx0XHRcdGhlYWRlckVsLmFwcGVuZENoaWxkKHRoaXMuZ2VuZXJhdGVIZWFkZXJFbGVtZW50KHJvdywgc2V0dXAsIHN0eWxlcykpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcblx0XHRcdFx0Y2FzZSBcImdyb3VwXCI6XG5cdFx0XHRcdFx0Ym9keUVsLmFwcGVuZENoaWxkKHRoaXMuZ2VuZXJhdGVHcm91cEVsZW1lbnQocm93LCBzZXR1cCwgc3R5bGVzKSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFxuXHRcdFx0XHRjYXNlIFwiY2FsY1wiOlxuXHRcdFx0XHRcdGJvZHlFbC5hcHBlbmRDaGlsZCh0aGlzLmdlbmVyYXRlQ2FsY0VsZW1lbnQocm93LCBzZXR1cCwgc3R5bGVzKSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFxuXHRcdFx0XHRjYXNlIFwicm93XCI6XG5cdFx0XHRcdFx0cm93RWwgPSB0aGlzLmdlbmVyYXRlUm93RWxlbWVudChyb3csIHNldHVwLCBzdHlsZXMpO1xuXHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLm1hcEVsZW1lbnRTdHlsZXMoKChpICUgMikgJiYgc3R5bGVzLmV2ZW5Sb3cpID8gc3R5bGVzLmV2ZW5Sb3cgOiBzdHlsZXMub2RkUm93LCByb3dFbCwgW1wiYm9yZGVyLXRvcFwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiLCBcImNvbG9yXCIsIFwiZm9udC13ZWlnaHRcIiwgXCJmb250LWZhbWlseVwiLCBcImZvbnQtc2l6ZVwiLCBcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRcdFx0XHRcdGJvZHlFbC5hcHBlbmRDaGlsZChyb3dFbCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0aWYoaGVhZGVyRWwuaW5uZXJIVE1MKXtcblx0XHRcdHRhYmxlLmFwcGVuZENoaWxkKGhlYWRlckVsKTtcblx0XHR9XG5cdFx0XG5cdFx0dGFibGUuYXBwZW5kQ2hpbGQoYm9keUVsKTtcblx0XHRcblx0XHRcblx0XHR0aGlzLm1hcEVsZW1lbnRTdHlsZXModGhpcy50YWJsZS5lbGVtZW50LCB0YWJsZSwgW1wiYm9yZGVyLXRvcFwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiXSk7XG5cdFx0cmV0dXJuIHRhYmxlO1xuXHR9XG5cdFxuXHRsb29rdXBUYWJsZVN0eWxlcygpe1xuXHRcdHZhciBzdHlsZXMgPSB7fTtcblx0XHRcblx0XHQvL2xvb2t1cCByb3cgc3R5bGVzXG5cdFx0aWYodGhpcy5jbG9uZVRhYmxlU3R5bGUgJiYgd2luZG93LmdldENvbXB1dGVkU3R5bGUpe1xuXHRcdFx0c3R5bGVzLm9kZFJvdyA9IHRoaXMudGFibGUuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYnVsYXRvci1yb3ctb2RkOm5vdCgudGFidWxhdG9yLWdyb3VwKTpub3QoLnRhYnVsYXRvci1jYWxjcylcIik7XG5cdFx0XHRzdHlsZXMuZXZlblJvdyA9IHRoaXMudGFibGUuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYnVsYXRvci1yb3ctZXZlbjpub3QoLnRhYnVsYXRvci1ncm91cCk6bm90KC50YWJ1bGF0b3ItY2FsY3MpXCIpO1xuXHRcdFx0c3R5bGVzLmNhbGNSb3cgPSB0aGlzLnRhYmxlLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi50YWJ1bGF0b3Itcm93LnRhYnVsYXRvci1jYWxjc1wiKTtcblx0XHRcdHN0eWxlcy5maXJzdFJvdyA9IHRoaXMudGFibGUuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYnVsYXRvci1yb3c6bm90KC50YWJ1bGF0b3ItZ3JvdXApOm5vdCgudGFidWxhdG9yLWNhbGNzKVwiKTtcblx0XHRcdHN0eWxlcy5maXJzdEdyb3VwID0gdGhpcy50YWJsZS5lbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0YWJ1bGF0b3ItZ3JvdXBcIilbMF07XG5cdFx0XHRcblx0XHRcdGlmKHN0eWxlcy5maXJzdFJvdyl7XG5cdFx0XHRcdHN0eWxlcy5zdHlsZUNlbGxzID0gc3R5bGVzLmZpcnN0Um93LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0YWJ1bGF0b3ItY2VsbFwiKTtcblx0XHRcdFx0c3R5bGVzLnN0eWxlUm93SGVhZGVyID0gc3R5bGVzLmZpcnN0Um93LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0YWJ1bGF0b3Itcm93LWhlYWRlclwiKVswXTtcblx0XHRcdFx0c3R5bGVzLmZpcnN0Q2VsbCA9IHN0eWxlcy5zdHlsZUNlbGxzWzBdO1xuXHRcdFx0XHRzdHlsZXMubGFzdENlbGwgPSBzdHlsZXMuc3R5bGVDZWxsc1tzdHlsZXMuc3R5bGVDZWxscy5sZW5ndGggLSAxXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHN0eWxlcztcblx0fVxuXHRcblx0Z2VuZXJhdGVIZWFkZXJFbGVtZW50KHJvdywgc2V0dXAsIHN0eWxlcyl7XG5cdFx0dmFyIHJvd0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xuXHRcdFxuXHRcdHJvdy5jb2x1bW5zLmZvckVhY2goKGNvbHVtbikgPT4ge1xuXHRcdFx0aWYoY29sdW1uKXtcblx0XHRcdFx0dmFyIGNlbGxFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0aFwiKTtcblx0XHRcdFx0dmFyIGNsYXNzTmFtZXMgPSBjb2x1bW4uY29tcG9uZW50Ll9jb2x1bW4uZGVmaW5pdGlvbi5jc3NDbGFzcyA/IGNvbHVtbi5jb21wb25lbnQuX2NvbHVtbi5kZWZpbml0aW9uLmNzc0NsYXNzLnNwbGl0KFwiIFwiKSA6IFtdO1xuXHRcdFx0XHRcblx0XHRcdFx0Y2VsbEVsLmNvbFNwYW4gPSBjb2x1bW4ud2lkdGg7XG5cdFx0XHRcdGNlbGxFbC5yb3dTcGFuID0gY29sdW1uLmhlaWdodDtcblx0XHRcdFx0XG5cdFx0XHRcdGNlbGxFbC5pbm5lckhUTUwgPSBjb2x1bW4udmFsdWU7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLmNsb25lVGFibGVTdHlsZSl7XG5cdFx0XHRcdFx0Y2VsbEVsLnN0eWxlLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRjbGFzc05hbWVzLmZvckVhY2goZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG5cdFx0XHRcdFx0Y2VsbEVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLm1hcEVsZW1lbnRTdHlsZXMoY29sdW1uLmNvbXBvbmVudC5nZXRFbGVtZW50KCksIGNlbGxFbCwgW1widGV4dC1hbGlnblwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYmFja2dyb3VuZC1jb2xvclwiLCBcImNvbG9yXCIsIFwiZm9udC13ZWlnaHRcIiwgXCJmb250LWZhbWlseVwiLCBcImZvbnQtc2l6ZVwiXSk7XG5cdFx0XHRcdHRoaXMubWFwRWxlbWVudFN0eWxlcyhjb2x1bW4uY29tcG9uZW50Ll9jb2x1bW4uY29udGVudEVsZW1lbnQsIGNlbGxFbCwgW1wicGFkZGluZy10b3BcIiwgXCJwYWRkaW5nLWxlZnRcIiwgXCJwYWRkaW5nLXJpZ2h0XCIsIFwicGFkZGluZy1ib3R0b21cIl0pO1xuXHRcdFxuXHRcdFx0XHRpZihjb2x1bW4uY29tcG9uZW50Ll9jb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRcdFx0dGhpcy5tYXBFbGVtZW50U3R5bGVzKGNvbHVtbi5jb21wb25lbnQuZ2V0RWxlbWVudCgpLCBjZWxsRWwsIFtcIndpZHRoXCJdKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGlmKGNvbHVtbi5jb21wb25lbnQuX2NvbHVtbi5kZWZpbml0aW9uLndpZHRoKXtcblx0XHRcdFx0XHRcdGNlbGxFbC5zdHlsZS53aWR0aCA9IGNvbHVtbi5jb21wb25lbnQuX2NvbHVtbi5kZWZpbml0aW9uLndpZHRoICsgXCJweFwiO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYoY29sdW1uLmNvbXBvbmVudC5fY29sdW1uLnBhcmVudCAmJiBjb2x1bW4uY29tcG9uZW50Ll9jb2x1bW4ucGFyZW50LmlzR3JvdXApe1xuXHRcdFx0XHRcdHRoaXMubWFwRWxlbWVudFN0eWxlcyhjb2x1bW4uY29tcG9uZW50Ll9jb2x1bW4ucGFyZW50Lmdyb3VwRWxlbWVudCwgY2VsbEVsLCBbXCJib3JkZXItdG9wXCJdKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMubWFwRWxlbWVudFN0eWxlcyhjb2x1bW4uY29tcG9uZW50LmdldEVsZW1lbnQoKSwgY2VsbEVsLCBbXCJib3JkZXItdG9wXCJdKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYoY29sdW1uLmNvbXBvbmVudC5fY29sdW1uLmlzR3JvdXApe1xuXHRcdFx0XHRcdHRoaXMubWFwRWxlbWVudFN0eWxlcyhjb2x1bW4uY29tcG9uZW50LmdldEVsZW1lbnQoKSwgY2VsbEVsLCBbXCJib3JkZXItYm90dG9tXCJdKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMubWFwRWxlbWVudFN0eWxlcyh0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0RWxlbWVudCgpLCBjZWxsRWwsIFtcImJvcmRlci1ib3R0b21cIl0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRyb3dFbC5hcHBlbmRDaGlsZChjZWxsRWwpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiByb3dFbDtcblx0fVxuXHRcblx0Z2VuZXJhdGVHcm91cEVsZW1lbnQocm93LCBzZXR1cCwgc3R5bGVzKXtcblx0XHRcblx0XHR2YXIgcm93RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidHJcIiksXG5cdFx0Y2VsbEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpLFxuXHRcdGdyb3VwID0gcm93LmNvbHVtbnNbMF07XG5cdFx0XG5cdFx0cm93RWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC10YWJsZS1yb3dcIik7XG5cdFx0XG5cdFx0aWYoc2V0dXAuZ3JvdXBIZWFkZXIgJiYgc2V0dXAuZ3JvdXBIZWFkZXJbcm93LmluZGVudF0pe1xuXHRcdFx0Z3JvdXAudmFsdWUgPSBzZXR1cC5ncm91cEhlYWRlcltyb3cuaW5kZW50XShncm91cC52YWx1ZSwgcm93LmNvbXBvbmVudC5fZ3JvdXAuZ2V0Um93Q291bnQoKSwgcm93LmNvbXBvbmVudC5fZ3JvdXAuZ2V0RGF0YSgpLCByb3cuY29tcG9uZW50KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZihzZXR1cC5ncm91cEhlYWRlciAhPT0gZmFsc2Upe1xuXHRcdFx0XHRncm91cC52YWx1ZSA9IHJvdy5jb21wb25lbnQuX2dyb3VwLmdlbmVyYXRvcihncm91cC52YWx1ZSwgcm93LmNvbXBvbmVudC5fZ3JvdXAuZ2V0Um93Q291bnQoKSwgcm93LmNvbXBvbmVudC5fZ3JvdXAuZ2V0RGF0YSgpLCByb3cuY29tcG9uZW50KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Y2VsbEVsLmNvbFNwYW4gPSBncm91cC53aWR0aDtcblx0XHRjZWxsRWwuaW5uZXJIVE1MID0gZ3JvdXAudmFsdWU7XG5cdFx0XG5cdFx0cm93RWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC10YWJsZS1ncm91cFwiKTtcblx0XHRyb3dFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWdyb3VwLWxldmVsLVwiICsgcm93LmluZGVudCk7XG5cdFx0XG5cdFx0aWYoZ3JvdXAuY29tcG9uZW50LmlzVmlzaWJsZSgpKXtcblx0XHRcdHJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZ3JvdXAtdmlzaWJsZVwiKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5tYXBFbGVtZW50U3R5bGVzKHN0eWxlcy5maXJzdEdyb3VwLCByb3dFbCwgW1wiYm9yZGVyLXRvcFwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiLCBcImNvbG9yXCIsIFwiZm9udC13ZWlnaHRcIiwgXCJmb250LWZhbWlseVwiLCBcImZvbnQtc2l6ZVwiLCBcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRcdHRoaXMubWFwRWxlbWVudFN0eWxlcyhzdHlsZXMuZmlyc3RHcm91cCwgY2VsbEVsLCBbXCJwYWRkaW5nLXRvcFwiLCBcInBhZGRpbmctbGVmdFwiLCBcInBhZGRpbmctcmlnaHRcIiwgXCJwYWRkaW5nLWJvdHRvbVwiXSk7XG5cdFx0XG5cdFx0cm93RWwuYXBwZW5kQ2hpbGQoY2VsbEVsKTtcblx0XHRcblx0XHRyZXR1cm4gcm93RWw7XG5cdH1cblx0XG5cdGdlbmVyYXRlQ2FsY0VsZW1lbnQocm93LCBzZXR1cCwgc3R5bGVzKXtcblx0XHR2YXIgcm93RWwgPSB0aGlzLmdlbmVyYXRlUm93RWxlbWVudChyb3csIHNldHVwLCBzdHlsZXMpO1xuXHRcdFxuXHRcdHJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJpbnQtdGFibGUtY2FsY3NcIik7XG5cdFx0dGhpcy5tYXBFbGVtZW50U3R5bGVzKHN0eWxlcy5jYWxjUm93LCByb3dFbCwgW1wiYm9yZGVyLXRvcFwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiLCBcImNvbG9yXCIsIFwiZm9udC13ZWlnaHRcIiwgXCJmb250LWZhbWlseVwiLCBcImZvbnQtc2l6ZVwiLCBcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRcdFxuXHRcdHJldHVybiByb3dFbDtcblx0fVxuXHRcblx0Z2VuZXJhdGVSb3dFbGVtZW50KHJvdywgc2V0dXAsIHN0eWxlcyl7XG5cdFx0dmFyIHJvd0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xuXHRcdFxuXHRcdHJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJpbnQtdGFibGUtcm93XCIpO1xuXHRcdFxuXHRcdHJvdy5jb2x1bW5zLmZvckVhY2goKGNvbCwgaSkgPT4ge1xuXHRcdFx0aWYoY29sKXtcblx0XHRcdFx0dmFyIGNlbGxFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKSxcblx0XHRcdFx0Y29sdW1uID0gY29sLmNvbXBvbmVudC5fY29sdW1uLFxuXHRcdFx0XHR0YWJsZSA9ICB0aGlzLnRhYmxlLFxuXHRcdFx0XHRpbmRleCA9IHRhYmxlLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbkluZGV4KGNvbHVtbiksXG5cdFx0XHRcdHZhbHVlID0gY29sLnZhbHVlLFxuXHRcdFx0XHRjZWxsU3R5bGUsIHN0eWxlUHJvcHM7XG5cdFx0XHRcdFxuXHRcdFx0XHR2YXIgY2VsbFdyYXBwZXIgPSB7XG5cdFx0XHRcdFx0bW9kdWxlczp7fSxcblx0XHRcdFx0XHRnZXRWYWx1ZTpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Z2V0RmllbGQ6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHJldHVybiBjb2x1bW4uZGVmaW5pdGlvbi5maWVsZDtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGdldEVsZW1lbnQ6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHJldHVybiBjZWxsRWw7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRnZXRUeXBlOmZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0XHRyZXR1cm4gXCJjZWxsXCI7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRnZXRDb2x1bW46ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHJldHVybiBjb2x1bW4uZ2V0Q29tcG9uZW50KCk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRnZXREYXRhOmZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcm93LmNvbXBvbmVudC5nZXREYXRhKCk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRnZXRSb3c6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHJldHVybiByb3cuY29tcG9uZW50O1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Z2V0VGFibGU6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHJldHVybiB0YWJsZTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGdldENvbXBvbmVudDpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0cmV0dXJuIGNlbGxXcmFwcGVyO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Y29sdW1uOmNvbHVtbixcblx0XHRcdFx0fTtcblx0XHRcdFx0XG5cdFx0XHRcdHZhciBjbGFzc05hbWVzID0gY29sdW1uLmRlZmluaXRpb24uY3NzQ2xhc3MgPyBjb2x1bW4uZGVmaW5pdGlvbi5jc3NDbGFzcy5zcGxpdChcIiBcIikgOiBbXTtcblx0XHRcdFx0XG5cdFx0XHRcdGNsYXNzTmFtZXMuZm9yRWFjaChmdW5jdGlvbihjbGFzc05hbWUpIHtcblx0XHRcdFx0XHRjZWxsRWwuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZm9ybWF0XCIpICYmIHRoaXMuY29uZmlnLmZvcm1hdENlbGxzICE9PSBmYWxzZSl7XG5cdFx0XHRcdFx0dmFsdWUgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZm9ybWF0LmZvcm1hdEV4cG9ydFZhbHVlKGNlbGxXcmFwcGVyLCB0aGlzLmNvbFZpc1Byb3ApO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0c3dpdGNoKHR5cGVvZiB2YWx1ZSl7XG5cdFx0XHRcdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdFx0XHRcdHZhbHVlID0gdmFsdWUgIT09IG51bGwgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkgOiBcIlwiO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IFwiXCI7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYodmFsdWUgaW5zdGFuY2VvZiBOb2RlKXtcblx0XHRcdFx0XHRjZWxsRWwuYXBwZW5kQ2hpbGQodmFsdWUpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0Y2VsbEVsLmlubmVySFRNTCA9IHZhbHVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0c3R5bGVQcm9wcyA9IFtcInBhZGRpbmctdG9wXCIsIFwicGFkZGluZy1sZWZ0XCIsIFwicGFkZGluZy1yaWdodFwiLCBcInBhZGRpbmctYm90dG9tXCIsIFwiYm9yZGVyLXRvcFwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiLCBcImNvbG9yXCIsIFwiZm9udC13ZWlnaHRcIiwgXCJmb250LWZhbWlseVwiLCBcImZvbnQtc2l6ZVwiLCBcInRleHQtYWxpZ25cIl07XG5cblx0XHRcdFx0aWYoY29sdW1uLmlzUm93SGVhZGVyKXtcblx0XHRcdFx0XHRjZWxsU3R5bGUgPSBzdHlsZXMuc3R5bGVSb3dIZWFkZXI7XG5cdFx0XHRcdFx0c3R5bGVQcm9wcy5wdXNoKFwiYmFja2dyb3VuZC1jb2xvclwiKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNlbGxTdHlsZSA9IHN0eWxlcy5zdHlsZUNlbGxzICYmIHN0eWxlcy5zdHlsZUNlbGxzW2luZGV4XSA/IHN0eWxlcy5zdHlsZUNlbGxzW2luZGV4XSA6IHN0eWxlcy5maXJzdENlbGw7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmKGNlbGxTdHlsZSl7XG5cdFx0XHRcdFx0dGhpcy5tYXBFbGVtZW50U3R5bGVzKGNlbGxTdHlsZSwgY2VsbEVsLCBzdHlsZVByb3BzKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi5hbGlnbil7XG5cdFx0XHRcdFx0XHRjZWxsRWwuc3R5bGUudGV4dEFsaWduID0gY29sdW1uLmRlZmluaXRpb24uYWxpZ247XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUgJiYgdGhpcy5jb25maWcuZGF0YVRyZWUgIT09IGZhbHNlKXtcblx0XHRcdFx0XHRpZigoc2V0dXAudHJlZUVsZW1lbnRGaWVsZCAmJiBzZXR1cC50cmVlRWxlbWVudEZpZWxkID09IGNvbHVtbi5maWVsZCkgfHwgKCFzZXR1cC50cmVlRWxlbWVudEZpZWxkICYmIGkgPT0gMCkpe1xuXHRcdFx0XHRcdFx0aWYocm93LmNvbXBvbmVudC5fcm93Lm1vZHVsZXMuZGF0YVRyZWUuY29udHJvbEVsKXtcblx0XHRcdFx0XHRcdFx0Y2VsbEVsLmluc2VydEJlZm9yZShyb3cuY29tcG9uZW50Ll9yb3cubW9kdWxlcy5kYXRhVHJlZS5jb250cm9sRWwuY2xvbmVOb2RlKHRydWUpLCBjZWxsRWwuZmlyc3RDaGlsZCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZihyb3cuY29tcG9uZW50Ll9yb3cubW9kdWxlcy5kYXRhVHJlZS5icmFuY2hFbCl7XG5cdFx0XHRcdFx0XHRcdGNlbGxFbC5pbnNlcnRCZWZvcmUocm93LmNvbXBvbmVudC5fcm93Lm1vZHVsZXMuZGF0YVRyZWUuYnJhbmNoRWwuY2xvbmVOb2RlKHRydWUpLCBjZWxsRWwuZmlyc3RDaGlsZCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRyb3dFbC5hcHBlbmRDaGlsZChjZWxsRWwpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoY2VsbFdyYXBwZXIubW9kdWxlcy5mb3JtYXQgJiYgY2VsbFdyYXBwZXIubW9kdWxlcy5mb3JtYXQucmVuZGVyZWRDYWxsYmFjayl7XG5cdFx0XHRcdFx0Y2VsbFdyYXBwZXIubW9kdWxlcy5mb3JtYXQucmVuZGVyZWRDYWxsYmFjaygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0aWYoc2V0dXAucm93Rm9ybWF0dGVyICYmIHJvdy50eXBlID09PSBcInJvd1wiICYmIHRoaXMuY29uZmlnLmZvcm1hdENlbGxzICE9PSBmYWxzZSl7XG5cdFx0XHRsZXQgZm9ybWF0Q29tcG9uZW50ID0gT2JqZWN0LmFzc2lnbihyb3cuY29tcG9uZW50KTtcblxuXHRcdFx0Zm9ybWF0Q29tcG9uZW50LmdldEVsZW1lbnQgPSBmdW5jdGlvbigpe3JldHVybiByb3dFbDt9O1xuXG5cdFx0XHRzZXR1cC5yb3dGb3JtYXR0ZXIocm93LmNvbXBvbmVudCk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiByb3dFbDtcblx0fVxuXHRcblx0Z2VuZXJhdGVIVE1MVGFibGUobGlzdCl7XG5cdFx0dmFyIGhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XG5cdFx0aG9sZGVyLmFwcGVuZENoaWxkKHRoaXMuZ2VuZXJhdGVUYWJsZUVsZW1lbnQobGlzdCkpO1xuXHRcdFxuXHRcdHJldHVybiBob2xkZXIuaW5uZXJIVE1MO1xuXHR9XG5cdFxuXHRnZXRIdG1sKHZpc2libGUsIHN0eWxlLCBjb25maWcsIGNvbFZpc1Byb3Ape1xuXHRcdHZhciBsaXN0ID0gdGhpcy5nZW5lcmF0ZUV4cG9ydExpc3QoY29uZmlnIHx8IHRoaXMudGFibGUub3B0aW9ucy5odG1sT3V0cHV0Q29uZmlnLCBzdHlsZSwgdmlzaWJsZSwgY29sVmlzUHJvcCB8fCBcImh0bWxPdXRwdXRcIik7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuZ2VuZXJhdGVIVE1MVGFibGUobGlzdCk7XG5cdH1cblx0XG5cdG1hcEVsZW1lbnRTdHlsZXMoZnJvbSwgdG8sIHByb3BzKXtcblx0XHRpZih0aGlzLmNsb25lVGFibGVTdHlsZSAmJiBmcm9tICYmIHRvKXtcblx0XHRcdFxuXHRcdFx0dmFyIGxvb2t1cCA9IHtcblx0XHRcdFx0XCJiYWNrZ3JvdW5kLWNvbG9yXCIgOiBcImJhY2tncm91bmRDb2xvclwiLFxuXHRcdFx0XHRcImNvbG9yXCIgOiBcImZvbnRDb2xvclwiLFxuXHRcdFx0XHRcIndpZHRoXCIgOiBcIndpZHRoXCIsXG5cdFx0XHRcdFwiZm9udC13ZWlnaHRcIiA6IFwiZm9udFdlaWdodFwiLFxuXHRcdFx0XHRcImZvbnQtZmFtaWx5XCIgOiBcImZvbnRGYW1pbHlcIixcblx0XHRcdFx0XCJmb250LXNpemVcIiA6IFwiZm9udFNpemVcIixcblx0XHRcdFx0XCJ0ZXh0LWFsaWduXCIgOiBcInRleHRBbGlnblwiLFxuXHRcdFx0XHRcImJvcmRlci10b3BcIiA6IFwiYm9yZGVyVG9wXCIsXG5cdFx0XHRcdFwiYm9yZGVyLWxlZnRcIiA6IFwiYm9yZGVyTGVmdFwiLFxuXHRcdFx0XHRcImJvcmRlci1yaWdodFwiIDogXCJib3JkZXJSaWdodFwiLFxuXHRcdFx0XHRcImJvcmRlci1ib3R0b21cIiA6IFwiYm9yZGVyQm90dG9tXCIsXG5cdFx0XHRcdFwicGFkZGluZy10b3BcIiA6IFwicGFkZGluZ1RvcFwiLFxuXHRcdFx0XHRcInBhZGRpbmctbGVmdFwiIDogXCJwYWRkaW5nTGVmdFwiLFxuXHRcdFx0XHRcInBhZGRpbmctcmlnaHRcIiA6IFwicGFkZGluZ1JpZ2h0XCIsXG5cdFx0XHRcdFwicGFkZGluZy1ib3R0b21cIiA6IFwicGFkZGluZ0JvdHRvbVwiLFxuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0aWYod2luZG93LmdldENvbXB1dGVkU3R5bGUpe1xuXHRcdFx0XHR2YXIgZnJvbVN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZnJvbSk7XG5cblx0XHRcdFx0cHJvcHMuZm9yRWFjaChmdW5jdGlvbihwcm9wKXtcblx0XHRcdFx0XHRpZighdG8uc3R5bGVbbG9va3VwW3Byb3BdXSl7XG5cdFx0XHRcdFx0XHR0by5zdHlsZVtsb29rdXBbcHJvcF1dID0gZnJvbVN0eWxlLmdldFByb3BlcnR5VmFsdWUocHJvcCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxudmFyIGRlZmF1bHRGaWx0ZXJzID0ge1xuXG5cdC8vZXF1YWwgdG9cblx0XCI9XCI6ZnVuY3Rpb24oZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcyl7XG5cdFx0cmV0dXJuIHJvd1ZhbCA9PSBmaWx0ZXJWYWwgPyB0cnVlIDogZmFsc2U7XG5cdH0sXG5cblx0Ly9sZXNzIHRoYW5cblx0XCI8XCI6ZnVuY3Rpb24oZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcyl7XG5cdFx0cmV0dXJuIHJvd1ZhbCA8IGZpbHRlclZhbCA/IHRydWUgOiBmYWxzZTtcblx0fSxcblxuXHQvL2xlc3MgdGhhbiBvciBlcXVhbCB0b1xuXHRcIjw9XCI6ZnVuY3Rpb24oZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcyl7XG5cdFx0cmV0dXJuIHJvd1ZhbCA8PSBmaWx0ZXJWYWwgPyB0cnVlIDogZmFsc2U7XG5cdH0sXG5cblx0Ly9ncmVhdGVyIHRoYW5cblx0XCI+XCI6ZnVuY3Rpb24oZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcyl7XG5cdFx0cmV0dXJuIHJvd1ZhbCA+IGZpbHRlclZhbCA/IHRydWUgOiBmYWxzZTtcblx0fSxcblxuXHQvL2dyZWF0ZXIgdGhhbiBvciBlcXVhbCB0b1xuXHRcIj49XCI6ZnVuY3Rpb24oZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcyl7XG5cdFx0cmV0dXJuIHJvd1ZhbCA+PSBmaWx0ZXJWYWwgPyB0cnVlIDogZmFsc2U7XG5cdH0sXG5cblx0Ly9ub3QgZXF1YWwgdG9cblx0XCIhPVwiOmZ1bmN0aW9uKGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpe1xuXHRcdHJldHVybiByb3dWYWwgIT0gZmlsdGVyVmFsID8gdHJ1ZSA6IGZhbHNlO1xuXHR9LFxuXG5cdFwicmVnZXhcIjpmdW5jdGlvbihmaWx0ZXJWYWwsIHJvd1ZhbCwgcm93RGF0YSwgZmlsdGVyUGFyYW1zKXtcblxuXHRcdGlmKHR5cGVvZiBmaWx0ZXJWYWwgPT0gXCJzdHJpbmdcIil7XG5cdFx0XHRmaWx0ZXJWYWwgPSBuZXcgUmVnRXhwKGZpbHRlclZhbCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZpbHRlclZhbC50ZXN0KHJvd1ZhbCk7XG5cdH0sXG5cblx0Ly9jb250YWlucyB0aGUgc3RyaW5nXG5cdFwibGlrZVwiOmZ1bmN0aW9uKGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpe1xuXHRcdGlmKGZpbHRlclZhbCA9PT0gbnVsbCB8fCB0eXBlb2YgZmlsdGVyVmFsID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdHJldHVybiByb3dWYWwgPT09IGZpbHRlclZhbCA/IHRydWUgOiBmYWxzZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZih0eXBlb2Ygcm93VmFsICE9PSAndW5kZWZpbmVkJyAmJiByb3dWYWwgIT09IG51bGwpe1xuXHRcdFx0XHRyZXR1cm4gU3RyaW5nKHJvd1ZhbCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKGZpbHRlclZhbC50b0xvd2VyQ2FzZSgpKSA+IC0xO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0Ly9jb250YWlucyB0aGUga2V5d29yZHNcblx0XCJrZXl3b3Jkc1wiOmZ1bmN0aW9uKGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpe1xuXHRcdHZhciBrZXl3b3JkcyA9IGZpbHRlclZhbC50b0xvd2VyQ2FzZSgpLnNwbGl0KHR5cGVvZiBmaWx0ZXJQYXJhbXMuc2VwYXJhdG9yID09PSBcInVuZGVmaW5lZFwiID8gXCIgXCIgOiBmaWx0ZXJQYXJhbXMuc2VwYXJhdG9yKSxcblx0XHR2YWx1ZSA9IFN0cmluZyhyb3dWYWwgPT09IG51bGwgfHwgdHlwZW9mIHJvd1ZhbCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwiXCIgOiByb3dWYWwpLnRvTG93ZXJDYXNlKCksXG5cdFx0bWF0Y2hlcyA9IFtdO1xuXG5cdFx0a2V5d29yZHMuZm9yRWFjaCgoa2V5d29yZCkgPT57XG5cdFx0XHRpZih2YWx1ZS5pbmNsdWRlcyhrZXl3b3JkKSl7XG5cdFx0XHRcdG1hdGNoZXMucHVzaCh0cnVlKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBmaWx0ZXJQYXJhbXMubWF0Y2hBbGwgPyBtYXRjaGVzLmxlbmd0aCA9PT0ga2V5d29yZHMubGVuZ3RoIDogISFtYXRjaGVzLmxlbmd0aDtcblx0fSxcblxuXHQvL3N0YXJ0cyB3aXRoIHRoZSBzdHJpbmdcblx0XCJzdGFydHNcIjpmdW5jdGlvbihmaWx0ZXJWYWwsIHJvd1ZhbCwgcm93RGF0YSwgZmlsdGVyUGFyYW1zKXtcblx0XHRpZihmaWx0ZXJWYWwgPT09IG51bGwgfHwgdHlwZW9mIGZpbHRlclZhbCA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRyZXR1cm4gcm93VmFsID09PSBmaWx0ZXJWYWwgPyB0cnVlIDogZmFsc2U7XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYodHlwZW9mIHJvd1ZhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgcm93VmFsICE9PSBudWxsKXtcblx0XHRcdFx0cmV0dXJuIFN0cmluZyhyb3dWYWwpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChmaWx0ZXJWYWwudG9Mb3dlckNhc2UoKSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvL2VuZHMgd2l0aCB0aGUgc3RyaW5nXG5cdFwiZW5kc1wiOmZ1bmN0aW9uKGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpe1xuXHRcdGlmKGZpbHRlclZhbCA9PT0gbnVsbCB8fCB0eXBlb2YgZmlsdGVyVmFsID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdHJldHVybiByb3dWYWwgPT09IGZpbHRlclZhbCA/IHRydWUgOiBmYWxzZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZih0eXBlb2Ygcm93VmFsICE9PSAndW5kZWZpbmVkJyAmJiByb3dWYWwgIT09IG51bGwpe1xuXHRcdFx0XHRyZXR1cm4gU3RyaW5nKHJvd1ZhbCkudG9Mb3dlckNhc2UoKS5lbmRzV2l0aChmaWx0ZXJWYWwudG9Mb3dlckNhc2UoKSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvL2luIGFycmF5XG5cdFwiaW5cIjpmdW5jdGlvbihmaWx0ZXJWYWwsIHJvd1ZhbCwgcm93RGF0YSwgZmlsdGVyUGFyYW1zKXtcblx0XHRpZihBcnJheS5pc0FycmF5KGZpbHRlclZhbCkpe1xuXHRcdFx0cmV0dXJuIGZpbHRlclZhbC5sZW5ndGggPyBmaWx0ZXJWYWwuaW5kZXhPZihyb3dWYWwpID4gLTEgOiB0cnVlO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkZpbHRlciBFcnJvciAtIGZpbHRlciB2YWx1ZSBpcyBub3QgYW4gYXJyYXk6XCIsIGZpbHRlclZhbCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9LFxufTtcblxuY2xhc3MgRmlsdGVyIGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJmaWx0ZXJcIjtcblxuXHQvL2xvYWQgZGVmYXVsdHNcblx0c3RhdGljIGZpbHRlcnMgPSBkZWZhdWx0RmlsdGVycztcblxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXG5cdFx0dGhpcy5maWx0ZXJMaXN0ID0gW107IC8vaG9sZCBmaWx0ZXIgbGlzdFxuXHRcdHRoaXMuaGVhZGVyRmlsdGVycyA9IHt9OyAvL2hvbGQgY29sdW1uIGZpbHRlcnNcblx0XHR0aGlzLmhlYWRlckZpbHRlckNvbHVtbnMgPSBbXTsgLy9ob2xkIGNvbHVtbnMgdGhhdCB1c2UgaGVhZGVyIGZpbHRlcnNcblxuXHRcdHRoaXMucHJldkhlYWRlckZpbHRlckNoYW5nZUNoZWNrID0gXCJcIjtcblx0XHR0aGlzLnByZXZIZWFkZXJGaWx0ZXJDaGFuZ2VDaGVjayA9IFwie31cIjtcblxuXHRcdHRoaXMuY2hhbmdlZCA9IGZhbHNlOyAvL2hhcyBmaWx0ZXJpbmcgY2hhbmdlZCBzaW5jZSBsYXN0IHJlbmRlclxuXHRcdHRoaXMudGFibGVJbml0aWFsaXplZCA9IGZhbHNlO1xuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZmlsdGVyTW9kZVwiLCBcImxvY2FsXCIpOyAvL2xvY2FsIG9yIHJlbW90ZSBmaWx0ZXJpbmdcblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImluaXRpYWxGaWx0ZXJcIiwgZmFsc2UpOyAvL2luaXRpYWwgZmlsdGVyaW5nIGNyaXRlcmlhXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiaW5pdGlhbEhlYWRlckZpbHRlclwiLCBmYWxzZSk7IC8vaW5pdGlhbCBoZWFkZXIgZmlsdGVyaW5nIGNyaXRlcmlhXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiaGVhZGVyRmlsdGVyTGl2ZUZpbHRlckRlbGF5XCIsIDMwMCk7IC8vZGVsYXkgYmVmb3JlIHVwZGF0aW5nIGNvbHVtbiBhZnRlciB1c2VyIHR5cGVzIGluIGhlYWRlciBmaWx0ZXJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwbGFjZWhvbGRlckhlYWRlckZpbHRlclwiLCBmYWxzZSk7IC8vcGxhY2Vob2xkZXIgd2hlbiBoZWFkZXIgZmlsdGVyIGlzIGVtcHR5XG5cblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyRmlsdGVyXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJGaWx0ZXJQbGFjZWhvbGRlclwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyRmlsdGVyUGFyYW1zXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJGaWx0ZXJFbXB0eUNoZWNrXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJGaWx0ZXJGdW5jXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJGaWx0ZXJGdW5jUGFyYW1zXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJGaWx0ZXJMaXZlRmlsdGVyXCIpO1xuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJzZWFyY2hSb3dzXCIsIHRoaXMuc2VhcmNoUm93cy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInNlYXJjaERhdGFcIiwgdGhpcy5zZWFyY2hEYXRhLmJpbmQodGhpcykpO1xuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJzZXRGaWx0ZXJcIiwgdGhpcy51c2VyU2V0RmlsdGVyLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwicmVmcmVzaEZpbHRlclwiLCB0aGlzLnVzZXJSZWZyZXNoRmlsdGVyLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiYWRkRmlsdGVyXCIsIHRoaXMudXNlckFkZEZpbHRlci5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImdldEZpbHRlcnNcIiwgdGhpcy5nZXRGaWx0ZXJzLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwic2V0SGVhZGVyRmlsdGVyRm9jdXNcIiwgdGhpcy51c2VyU2V0SGVhZGVyRmlsdGVyRm9jdXMuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRIZWFkZXJGaWx0ZXJWYWx1ZVwiLCB0aGlzLnVzZXJHZXRIZWFkZXJGaWx0ZXJWYWx1ZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInNldEhlYWRlckZpbHRlclZhbHVlXCIsIHRoaXMudXNlclNldEhlYWRlckZpbHRlclZhbHVlLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0SGVhZGVyRmlsdGVyc1wiLCB0aGlzLmdldEhlYWRlckZpbHRlcnMuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJyZW1vdmVGaWx0ZXJcIiwgdGhpcy51c2VyUmVtb3ZlRmlsdGVyLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiY2xlYXJGaWx0ZXJcIiwgdGhpcy51c2VyQ2xlYXJGaWx0ZXIuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJjbGVhckhlYWRlckZpbHRlclwiLCB0aGlzLnVzZXJDbGVhckhlYWRlckZpbHRlci5iaW5kKHRoaXMpKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNvbHVtblwiLCBcImhlYWRlckZpbHRlckZvY3VzXCIsIHRoaXMuc2V0SGVhZGVyRmlsdGVyRm9jdXMuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiY29sdW1uXCIsIFwicmVsb2FkSGVhZGVyRmlsdGVyXCIsIHRoaXMucmVsb2FkSGVhZGVyRmlsdGVyLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNvbHVtblwiLCBcImdldEhlYWRlckZpbHRlclZhbHVlXCIsIHRoaXMuZ2V0SGVhZGVyRmlsdGVyVmFsdWUuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiY29sdW1uXCIsIFwic2V0SGVhZGVyRmlsdGVyVmFsdWVcIiwgdGhpcy5zZXRIZWFkZXJGaWx0ZXJWYWx1ZS5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1pbml0XCIsIHRoaXMuaW5pdGlhbGl6ZUNvbHVtbkhlYWRlckZpbHRlci5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi13aWR0aC1maXQtYmVmb3JlXCIsIHRoaXMuaGlkZUhlYWRlckZpbHRlckVsZW1lbnRzLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLXdpZHRoLWZpdC1hZnRlclwiLCB0aGlzLnNob3dIZWFkZXJGaWx0ZXJFbGVtZW50cy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLWJ1aWx0XCIsIHRoaXMudGFibGVCdWlsdC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInBsYWNlaG9sZGVyXCIsIHRoaXMuZ2VuZXJhdGVQbGFjZWhvbGRlci5iaW5kKHRoaXMpKTtcblxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5maWx0ZXJNb2RlID09PSBcInJlbW90ZVwiKXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1wYXJhbXNcIiwgdGhpcy5yZW1vdGVGaWx0ZXJQYXJhbXMuYmluZCh0aGlzKSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5yZWdpc3RlckRhdGFIYW5kbGVyKHRoaXMuZmlsdGVyLmJpbmQodGhpcyksIDEwKTtcblx0fVxuXG5cdHRhYmxlQnVpbHQoKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuaW5pdGlhbEZpbHRlcil7XG5cdFx0XHR0aGlzLnNldEZpbHRlcih0aGlzLnRhYmxlLm9wdGlvbnMuaW5pdGlhbEZpbHRlcik7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmluaXRpYWxIZWFkZXJGaWx0ZXIpe1xuXHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmluaXRpYWxIZWFkZXJGaWx0ZXIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXG5cdFx0XHRcdHZhciBjb2x1bW4gPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihpdGVtLmZpZWxkKTtcblxuXHRcdFx0XHRpZihjb2x1bW4pe1xuXHRcdFx0XHRcdHRoaXMuc2V0SGVhZGVyRmlsdGVyVmFsdWUoY29sdW1uLCBpdGVtLnZhbHVlKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBGaWx0ZXIgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGl0ZW0uZmllbGQpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0dGhpcy50YWJsZUluaXRpYWxpemVkID0gdHJ1ZTtcblx0fVxuXG5cdHJlbW90ZUZpbHRlclBhcmFtcyhkYXRhLCBjb25maWcsIHNpbGVudCwgcGFyYW1zKXtcblx0XHRwYXJhbXMuZmlsdGVyID0gdGhpcy5nZXRGaWx0ZXJzKHRydWUsIHRydWUpO1xuXHRcdHJldHVybiBwYXJhbXM7XG5cdH1cblxuXHRnZW5lcmF0ZVBsYWNlaG9sZGVyKHRleHQpe1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5wbGFjZWhvbGRlckhlYWRlckZpbHRlciAmJiBPYmplY3Qua2V5cyh0aGlzLmhlYWRlckZpbHRlcnMpLmxlbmd0aCl7XG5cdFx0XHRyZXR1cm4gdGhpcy50YWJsZS5vcHRpb25zLnBsYWNlaG9sZGVySGVhZGVyRmlsdGVyO1xuXHRcdH1cblx0fVxuXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBUYWJsZSBGdW5jdGlvbnMgLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblx0Ly9zZXQgc3RhbmRhcmQgZmlsdGVyc1xuXHR1c2VyU2V0RmlsdGVyKGZpZWxkLCB0eXBlLCB2YWx1ZSwgcGFyYW1zKXtcblx0XHR0aGlzLnNldEZpbHRlcihmaWVsZCwgdHlwZSwgdmFsdWUsIHBhcmFtcyk7XG5cdFx0dGhpcy5yZWZyZXNoRmlsdGVyKCk7XG5cdH1cblxuXHQvL3NldCBzdGFuZGFyZCBmaWx0ZXJzXG5cdHVzZXJSZWZyZXNoRmlsdGVyKCl7XG5cdFx0dGhpcy5yZWZyZXNoRmlsdGVyKCk7XG5cdH1cblxuXHQvL2FkZCBmaWx0ZXIgdG8gYXJyYXlcblx0dXNlckFkZEZpbHRlcihmaWVsZCwgdHlwZSwgdmFsdWUsIHBhcmFtcyl7XG5cdFx0dGhpcy5hZGRGaWx0ZXIoZmllbGQsIHR5cGUsIHZhbHVlLCBwYXJhbXMpO1xuXHRcdHRoaXMucmVmcmVzaEZpbHRlcigpO1xuXHR9XG5cblx0dXNlclNldEhlYWRlckZpbHRlckZvY3VzKGZpZWxkKXtcblx0XHR2YXIgY29sdW1uID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZmllbGQpO1xuXG5cdFx0aWYoY29sdW1uKXtcblx0XHRcdHRoaXMuc2V0SGVhZGVyRmlsdGVyRm9jdXMoY29sdW1uKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJDb2x1bW4gRmlsdGVyIEZvY3VzIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmaWVsZCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0dXNlckdldEhlYWRlckZpbHRlclZhbHVlKGZpZWxkKSB7XG5cdFx0dmFyIGNvbHVtbiA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGZpZWxkKTtcblxuXHRcdGlmKGNvbHVtbil7XG5cdFx0XHRyZXR1cm4gdGhpcy5nZXRIZWFkZXJGaWx0ZXJWYWx1ZShjb2x1bW4pO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBGaWx0ZXIgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGZpZWxkKTtcblx0XHR9XG5cdH1cblxuXHR1c2VyU2V0SGVhZGVyRmlsdGVyVmFsdWUoZmllbGQsIHZhbHVlKXtcblx0XHR2YXIgY29sdW1uID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZmllbGQpO1xuXG5cdFx0aWYoY29sdW1uKXtcblx0XHRcdHRoaXMuc2V0SGVhZGVyRmlsdGVyVmFsdWUoY29sdW1uLCB2YWx1ZSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIEZpbHRlciBFcnJvciAtIE5vIG1hdGNoaW5nIGNvbHVtbiBmb3VuZDpcIiwgZmllbGQpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdC8vcmVtb3ZlIGZpbHRlciBmcm9tIGFycmF5XG5cdHVzZXJSZW1vdmVGaWx0ZXIoZmllbGQsIHR5cGUsIHZhbHVlKXtcblx0XHR0aGlzLnJlbW92ZUZpbHRlcihmaWVsZCwgdHlwZSwgdmFsdWUpO1xuXHRcdHRoaXMucmVmcmVzaEZpbHRlcigpO1xuXHR9XG5cblx0Ly9jbGVhciBmaWx0ZXJzXG5cdHVzZXJDbGVhckZpbHRlcihhbGwpe1xuXHRcdHRoaXMuY2xlYXJGaWx0ZXIoYWxsKTtcblx0XHR0aGlzLnJlZnJlc2hGaWx0ZXIoKTtcblx0fVxuXG5cdC8vY2xlYXIgaGVhZGVyIGZpbHRlcnNcblx0dXNlckNsZWFySGVhZGVyRmlsdGVyKCl7XG5cdFx0dGhpcy5jbGVhckhlYWRlckZpbHRlcigpO1xuXHRcdHRoaXMucmVmcmVzaEZpbHRlcigpO1xuXHR9XG5cblxuXHQvL3NlYXJjaCBmb3Igc3BlY2lmaWMgcm93IGNvbXBvbmVudHNcblx0c2VhcmNoUm93cyhmaWVsZCwgdHlwZSwgdmFsdWUpe1xuXHRcdHJldHVybiB0aGlzLnNlYXJjaChcInJvd3NcIiwgZmllbGQsIHR5cGUsIHZhbHVlKTtcblx0fVxuXG5cdC8vc2VhcmNoIGZvciBzcGVjaWZpYyBkYXRhXG5cdHNlYXJjaERhdGEoZmllbGQsIHR5cGUsIHZhbHVlKXtcblx0XHRyZXR1cm4gdGhpcy5zZWFyY2goXCJkYXRhXCIsIGZpZWxkLCB0eXBlLCB2YWx1ZSk7XG5cdH1cblxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gSW50ZXJuYWwgTG9naWMgLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdGluaXRpYWxpemVDb2x1bW5IZWFkZXJGaWx0ZXIoY29sdW1uKXtcblx0XHR2YXIgZGVmID0gY29sdW1uLmRlZmluaXRpb247XG5cblx0XHRpZihkZWYuaGVhZGVyRmlsdGVyKXtcblx0XHRcdHRoaXMuaW5pdGlhbGl6ZUNvbHVtbihjb2x1bW4pO1xuXHRcdH1cblx0fVxuXG5cdC8vaW5pdGlhbGl6ZSBjb2x1bW4gaGVhZGVyIGZpbHRlclxuXHRpbml0aWFsaXplQ29sdW1uKGNvbHVtbiwgdmFsdWUpe1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRmaWVsZCA9IGNvbHVtbi5nZXRGaWVsZCgpO1xuXG5cdFx0Ly9oYW5kbGUgc3VjY2Vzc2Z1bGx5IHZhbHVlIGNoYW5nZVxuXHRcdGZ1bmN0aW9uIHN1Y2Nlc3ModmFsdWUpe1xuXHRcdFx0dmFyIGZpbHRlclR5cGUgPSAoY29sdW1uLm1vZHVsZXMuZmlsdGVyLnRhZ1R5cGUgPT0gXCJpbnB1dFwiICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5hdHRyVHlwZSA9PSBcInRleHRcIikgfHwgY29sdW1uLm1vZHVsZXMuZmlsdGVyLnRhZ1R5cGUgPT0gXCJ0ZXh0YXJlYVwiID8gXCJwYXJ0aWFsXCIgOiBcIm1hdGNoXCIsXG5cdFx0XHR0eXBlID0gXCJcIixcblx0XHRcdGZpbHRlckNoYW5nZUNoZWNrID0gXCJcIixcblx0XHRcdGZpbHRlckZ1bmM7XG5cblx0XHRcdGlmKHR5cGVvZiBjb2x1bW4ubW9kdWxlcy5maWx0ZXIucHJldlN1Y2Nlc3MgPT09IFwidW5kZWZpbmVkXCIgfHwgY29sdW1uLm1vZHVsZXMuZmlsdGVyLnByZXZTdWNjZXNzICE9PSB2YWx1ZSl7XG5cblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLnByZXZTdWNjZXNzID0gdmFsdWU7XG5cblx0XHRcdFx0aWYoIWNvbHVtbi5tb2R1bGVzLmZpbHRlci5lbXB0eUZ1bmModmFsdWUpKXtcblx0XHRcdFx0XHRjb2x1bW4ubW9kdWxlcy5maWx0ZXIudmFsdWUgPSB2YWx1ZTtcblxuXHRcdFx0XHRcdHN3aXRjaCh0eXBlb2YgY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyRnVuYyl7XG5cdFx0XHRcdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdFx0XHRcdGlmKEZpbHRlci5maWx0ZXJzW2NvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckZ1bmNdKXtcblx0XHRcdFx0XHRcdFx0XHR0eXBlID0gY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyRnVuYztcblx0XHRcdFx0XHRcdFx0XHRmaWx0ZXJGdW5jID0gZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgcGFyYW1zID0gY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyRnVuY1BhcmFtcyB8fCB7fTtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBmaWVsZFZhbCA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHRwYXJhbXMgPSB0eXBlb2YgcGFyYW1zID09PSBcImZ1bmN0aW9uXCIgPyBwYXJhbXModmFsdWUsIGZpZWxkVmFsLCBkYXRhKSA6IHBhcmFtcztcblxuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIEZpbHRlci5maWx0ZXJzW2NvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckZ1bmNdKHZhbHVlLCBmaWVsZFZhbCwgZGF0YSwgcGFyYW1zKTtcblx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiSGVhZGVyIEZpbHRlciBFcnJvciAtIE1hdGNoaW5nIGZpbHRlciBmdW5jdGlvbiBub3QgZm91bmQ6IFwiLCBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJGdW5jKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdFx0XHRcdGZpbHRlckZ1bmMgPSBmdW5jdGlvbihkYXRhKXtcblx0XHRcdFx0XHRcdFx0XHR2YXIgcGFyYW1zID0gY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyRnVuY1BhcmFtcyB8fCB7fTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgZmllbGRWYWwgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShkYXRhKTtcblxuXHRcdFx0XHRcdFx0XHRcdHBhcmFtcyA9IHR5cGVvZiBwYXJhbXMgPT09IFwiZnVuY3Rpb25cIiA/IHBhcmFtcyh2YWx1ZSwgZmllbGRWYWwsIGRhdGEpIDogcGFyYW1zO1xuXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckZ1bmModmFsdWUsIGZpZWxkVmFsLCBkYXRhLCBwYXJhbXMpO1xuXHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdHR5cGUgPSBmaWx0ZXJGdW5jO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZighZmlsdGVyRnVuYyl7XG5cdFx0XHRcdFx0XHRzd2l0Y2goZmlsdGVyVHlwZSl7XG5cdFx0XHRcdFx0XHRcdGNhc2UgXCJwYXJ0aWFsXCI6XG5cdFx0XHRcdFx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uKGRhdGEpe1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGNvbFZhbCA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHRpZih0eXBlb2YgY29sVmFsICE9PSAndW5kZWZpbmVkJyAmJiBjb2xWYWwgIT09IG51bGwpe1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gU3RyaW5nKGNvbFZhbCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKFN0cmluZyh2YWx1ZSkudG9Mb3dlckNhc2UoKSkgPiAtMTtcblx0XHRcdFx0XHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0dHlwZSA9IFwibGlrZVwiO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uKGRhdGEpe1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpID09IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0dHlwZSA9IFwiPVwiO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHNlbGYuaGVhZGVyRmlsdGVyc1tmaWVsZF0gPSB7dmFsdWU6dmFsdWUsIGZ1bmM6ZmlsdGVyRnVuYywgdHlwZTp0eXBlfTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGRlbGV0ZSBzZWxmLmhlYWRlckZpbHRlcnNbZmllbGRdO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLnZhbHVlID0gdmFsdWU7XG5cblx0XHRcdFx0ZmlsdGVyQ2hhbmdlQ2hlY2sgPSBKU09OLnN0cmluZ2lmeShzZWxmLmhlYWRlckZpbHRlcnMpO1xuXG5cdFx0XHRcdGlmKHNlbGYucHJldkhlYWRlckZpbHRlckNoYW5nZUNoZWNrICE9PSBmaWx0ZXJDaGFuZ2VDaGVjayl7XG5cdFx0XHRcdFx0c2VsZi5wcmV2SGVhZGVyRmlsdGVyQ2hhbmdlQ2hlY2sgPSBmaWx0ZXJDaGFuZ2VDaGVjaztcblxuXHRcdFx0XHRcdHNlbGYudHJhY2tDaGFuZ2VzKCk7XG5cdFx0XHRcdFx0c2VsZi5yZWZyZXNoRmlsdGVyKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyID0ge1xuXHRcdFx0c3VjY2VzczpzdWNjZXNzLFxuXHRcdFx0YXR0clR5cGU6ZmFsc2UsXG5cdFx0XHR0YWdUeXBlOmZhbHNlLFxuXHRcdFx0ZW1wdHlGdW5jOmZhbHNlLFxuXHRcdH07XG5cblx0XHR0aGlzLmdlbmVyYXRlSGVhZGVyRmlsdGVyRWxlbWVudChjb2x1bW4pO1xuXHR9XG5cblx0Z2VuZXJhdGVIZWFkZXJGaWx0ZXJFbGVtZW50KGNvbHVtbiwgaW5pdGlhbFZhbHVlLCByZWluaXRpYWxpemUpe1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRzdWNjZXNzID0gY29sdW1uLm1vZHVsZXMuZmlsdGVyLnN1Y2Nlc3MsXG5cdFx0ZmllbGQgPSBjb2x1bW4uZ2V0RmllbGQoKSxcblx0XHRmaWx0ZXJFbGVtZW50LCBlZGl0b3IsIGVkaXRvckVsZW1lbnQsIGNlbGxXcmFwcGVyLCB0eXBpbmdUaW1lciwgc2VhcmNoVHJpZ2dlciwgcGFyYW1zLCBvblJlbmRlcmVkQ2FsbGJhY2s7XG5cblx0XHRjb2x1bW4ubW9kdWxlcy5maWx0ZXIudmFsdWUgPSBpbml0aWFsVmFsdWU7XG5cblx0XHQvL2hhbmRsZSBhYm9ydGVkIGVkaXRcblx0XHRmdW5jdGlvbiBjYW5jZWwoKXt9XG5cblx0XHRmdW5jdGlvbiBvblJlbmRlcmVkKGNhbGxiYWNrKXtcblx0XHRcdG9uUmVuZGVyZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdH1cblxuXHRcdGlmKGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50ICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50LnBhcmVudE5vZGUpe1xuXHRcdFx0Y29sdW1uLmNvbnRlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50LnBhcmVudE5vZGUpO1xuXHRcdH1cblxuXHRcdGlmKGZpZWxkKXtcblxuXHRcdFx0Ly9zZXQgZW1wdHkgdmFsdWUgZnVuY3Rpb25cblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5lbXB0eUZ1bmMgPSBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJFbXB0eUNoZWNrIHx8IGZ1bmN0aW9uKHZhbHVlKXtcblx0XHRcdFx0cmV0dXJuICF2YWx1ZSAmJiB2YWx1ZSAhPT0gMDtcblx0XHRcdH07XG5cblx0XHRcdGZpbHRlckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0ZmlsdGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWhlYWRlci1maWx0ZXJcIik7XG5cblx0XHRcdC8vc2V0IGNvbHVtbiBlZGl0b3Jcblx0XHRcdHN3aXRjaCh0eXBlb2YgY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyKXtcblx0XHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRcdGlmKHNlbGYudGFibGUubW9kdWxlcy5lZGl0LmVkaXRvcnNbY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyXSl7XG5cdFx0XHRcdFx0XHRlZGl0b3IgPSBzZWxmLnRhYmxlLm1vZHVsZXMuZWRpdC5lZGl0b3JzW2NvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlcl07XG5cblx0XHRcdFx0XHRcdGlmKChjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXIgPT09IFwidGlja1wiIHx8IGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlciA9PT0gXCJ0aWNrQ3Jvc3NcIikgJiYgIWNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckVtcHR5Q2hlY2spe1xuXHRcdFx0XHRcdFx0XHRjb2x1bW4ubW9kdWxlcy5maWx0ZXIuZW1wdHlGdW5jID0gZnVuY3Rpb24odmFsdWUpe1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZSAhPT0gdHJ1ZSAmJiB2YWx1ZSAhPT0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiRmlsdGVyIEVycm9yIC0gQ2Fubm90IGJ1aWxkIGhlYWRlciBmaWx0ZXIsIE5vIHN1Y2ggZWRpdG9yIGZvdW5kOiBcIiwgY29sdW1uLmRlZmluaXRpb24uZWRpdG9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdFx0ZWRpdG9yID0gY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJib29sZWFuXCI6XG5cdFx0XHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuZWRpdCAmJiBjb2x1bW4ubW9kdWxlcy5lZGl0LmVkaXRvcil7XG5cdFx0XHRcdFx0XHRlZGl0b3IgPSBjb2x1bW4ubW9kdWxlcy5lZGl0LmVkaXRvcjtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXIgJiYgc2VsZi50YWJsZS5tb2R1bGVzLmVkaXQuZWRpdG9yc1tjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXJdKXtcblx0XHRcdFx0XHRcdFx0ZWRpdG9yID0gc2VsZi50YWJsZS5tb2R1bGVzLmVkaXQuZWRpdG9yc1tjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXJdO1xuXG5cdFx0XHRcdFx0XHRcdGlmKChjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXIgPT09IFwidGlja1wiIHx8IGNvbHVtbi5kZWZpbml0aW9uLmZvcm1hdHRlciA9PT0gXCJ0aWNrQ3Jvc3NcIikgJiYgIWNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckVtcHR5Q2hlY2spe1xuXHRcdFx0XHRcdFx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5lbXB0eUZ1bmMgPSBmdW5jdGlvbih2YWx1ZSl7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWUgIT09IHRydWUgJiYgdmFsdWUgIT09IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdFx0ZWRpdG9yID0gc2VsZi50YWJsZS5tb2R1bGVzLmVkaXQuZWRpdG9yc1tcImlucHV0XCJdO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblxuXHRcdFx0aWYoZWRpdG9yKXtcblxuXHRcdFx0XHRjZWxsV3JhcHBlciA9IHtcblx0XHRcdFx0XHRnZXRWYWx1ZTpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0cmV0dXJuIHR5cGVvZiBpbml0aWFsVmFsdWUgIT09IFwidW5kZWZpbmVkXCIgPyBpbml0aWFsVmFsdWUgOiBcIlwiO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Z2V0RmllbGQ6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHJldHVybiBjb2x1bW4uZGVmaW5pdGlvbi5maWVsZDtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGdldEVsZW1lbnQ6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHJldHVybiBmaWx0ZXJFbGVtZW50O1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Z2V0Q29sdW1uOmZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0XHRyZXR1cm4gY29sdW1uLmdldENvbXBvbmVudCgpO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Z2V0VGFibGU6KCkgPT4ge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXMudGFibGU7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRnZXRUeXBlOigpID0+IHtcblx0XHRcdFx0XHRcdHJldHVybiBcImhlYWRlclwiO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Z2V0Um93OmZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRub3JtYWxpemVIZWlnaHQ6ZnVuY3Rpb24oKXtcblxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHRwYXJhbXMgPSBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJQYXJhbXMgfHwge307XG5cblx0XHRcdFx0cGFyYW1zID0gdHlwZW9mIHBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gcGFyYW1zLmNhbGwoc2VsZi50YWJsZSwgY2VsbFdyYXBwZXIpIDogcGFyYW1zO1xuXG5cdFx0XHRcdGVkaXRvckVsZW1lbnQgPSBlZGl0b3IuY2FsbCh0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdCwgY2VsbFdyYXBwZXIsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgcGFyYW1zKTtcblxuXHRcdFx0XHRpZighZWRpdG9yRWxlbWVudCl7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiRmlsdGVyIEVycm9yIC0gQ2Fubm90IGFkZCBmaWx0ZXIgdG8gXCIgKyBmaWVsZCArIFwiIGNvbHVtbiwgZWRpdG9yIHJldHVybmVkIGEgdmFsdWUgb2YgZmFsc2VcIik7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYoIShlZGl0b3JFbGVtZW50IGluc3RhbmNlb2YgTm9kZSkpe1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkZpbHRlciBFcnJvciAtIENhbm5vdCBhZGQgZmlsdGVyIHRvIFwiICsgZmllbGQgKyBcIiBjb2x1bW4sIGVkaXRvciBzaG91bGQgcmV0dXJuIGFuIGluc3RhbmNlIG9mIE5vZGUsIHRoZSBlZGl0b3IgcmV0dXJuZWQ6XCIsIGVkaXRvckVsZW1lbnQpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vc2V0IFBsYWNlaG9sZGVyIFRleHRcblx0XHRcdFx0c2VsZi5sYW5nQmluZChcImhlYWRlckZpbHRlcnN8Y29sdW1uc3xcIiArIGNvbHVtbi5kZWZpbml0aW9uLmZpZWxkLCBmdW5jdGlvbih2YWx1ZSl7XG5cdFx0XHRcdFx0ZWRpdG9yRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJwbGFjZWhvbGRlclwiLCB0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIgJiYgdmFsdWUgPyB2YWx1ZSA6IChjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJQbGFjZWhvbGRlciB8fCBzZWxmLmxhbmdUZXh0KFwiaGVhZGVyRmlsdGVyc3xkZWZhdWx0XCIpKSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vZm9jdXMgb24gZWxlbWVudCBvbiBjbGlja1xuXHRcdFx0XHRlZGl0b3JFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdGVkaXRvckVsZW1lbnQuZm9jdXMoKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0ZWRpdG9yRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgKGUpID0+IHtcblx0XHRcdFx0XHR2YXIgbGVmdCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5jb250ZW50c0VsZW1lbnQuc2Nyb2xsTGVmdDtcblxuXHRcdFx0XHRcdHZhciBoZWFkZXJQb3MgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxMZWZ0O1xuXG5cdFx0XHRcdFx0aWYobGVmdCAhPT0gaGVhZGVyUG9zKXtcblx0XHRcdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHRcdFx0XHRcdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLnNjcm9sbEhvcml6b250YWwobGVmdCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvL2xpdmUgdXBkYXRlIGZpbHRlcnMgYXMgdXNlciB0eXBlc1xuXHRcdFx0XHR0eXBpbmdUaW1lciA9IGZhbHNlO1xuXG5cdFx0XHRcdHNlYXJjaFRyaWdnZXIgPSBmdW5jdGlvbihlKXtcblx0XHRcdFx0XHRpZih0eXBpbmdUaW1lcil7XG5cdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQodHlwaW5nVGltZXIpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHR5cGluZ1RpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0c3VjY2VzcyhlZGl0b3JFbGVtZW50LnZhbHVlKTtcblx0XHRcdFx0XHR9LHNlbGYudGFibGUub3B0aW9ucy5oZWFkZXJGaWx0ZXJMaXZlRmlsdGVyRGVsYXkpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50ID0gZWRpdG9yRWxlbWVudDtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLmF0dHJUeXBlID0gZWRpdG9yRWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJ0eXBlXCIpID8gZWRpdG9yRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpLnRvTG93ZXJDYXNlKCkgOiBcIlwiIDtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLnRhZ1R5cGUgPSBlZGl0b3JFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJMaXZlRmlsdGVyICE9PSBmYWxzZSl7XG5cblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHQhKFxuXHRcdFx0XHRcdFx0XHRjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXIgPT09ICdhdXRvY29tcGxldGUnIHx8XG5cdFx0XHRcdFx0XHRcdGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlciA9PT0gJ3RpY2tDcm9zcycgfHxcblx0XHRcdFx0XHRcdFx0KChjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3IgPT09ICdhdXRvY29tcGxldGUnIHx8XG5cdFx0XHRcdFx0XHRcdFx0Y29sdW1uLmRlZmluaXRpb24uZWRpdG9yID09PSAndGlja0Nyb3NzJykgJiZcblx0XHRcdFx0XHRcdFx0Y29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyID09PSB0cnVlKVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0ZWRpdG9yRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgc2VhcmNoVHJpZ2dlcik7XG5cdFx0XHRcdFx0XHRlZGl0b3JFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzZWFyY2hcIiwgc2VhcmNoVHJpZ2dlcik7XG5cblxuXHRcdFx0XHRcdFx0Ly91cGRhdGUgbnVtYmVyIGZpbHRlcmVkIGNvbHVtbnMgb24gY2hhbmdlXG5cdFx0XHRcdFx0XHRpZihjb2x1bW4ubW9kdWxlcy5maWx0ZXIuYXR0clR5cGUgPT0gXCJudW1iZXJcIil7XG5cdFx0XHRcdFx0XHRcdGVkaXRvckVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0XHRcdFx0XHRzdWNjZXNzKGVkaXRvckVsZW1lbnQudmFsdWUpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly9jaGFuZ2UgdGV4dCBpbnB1dHMgdG8gc2VhcmNoIGlucHV0cyB0byBhbGxvdyBmb3IgY2xlYXJpbmcgb2YgZmllbGRcblx0XHRcdFx0XHRcdGlmKGNvbHVtbi5tb2R1bGVzLmZpbHRlci5hdHRyVHlwZSA9PSBcInRleHRcIiAmJiB0aGlzLnRhYmxlLmJyb3dzZXIgIT09IFwiaWVcIil7XG5cdFx0XHRcdFx0XHRcdGVkaXRvckVsZW1lbnQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInNlYXJjaFwiKTtcblx0XHRcdFx0XHRcdC8vIGVkaXRvckVsZW1lbnQub2ZmKFwiY2hhbmdlIGJsdXJcIik7IC8vcHJldmVudCBibHVyIGZyb20gdHJpZ2dlcmluZyBmaWx0ZXIgYW5kIHByZXZlbnRpbmcgc2VsZWN0aW9uIGNsaWNrXG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvL3ByZXZlbnQgaW5wdXQgYW5kIHNlbGVjdCBlbGVtZW50cyBmcm9tIHByb3BhZ2F0aW5nIGNsaWNrIHRvIGNvbHVtbiBzb3J0ZXJzIGV0Y1xuXHRcdFx0XHRcdGlmKGNvbHVtbi5tb2R1bGVzLmZpbHRlci50YWdUeXBlID09IFwiaW5wdXRcIiB8fCBjb2x1bW4ubW9kdWxlcy5maWx0ZXIudGFnVHlwZSA9PSBcInNlbGVjdFwiIHx8IGNvbHVtbi5tb2R1bGVzLmZpbHRlci50YWdUeXBlID09IFwidGV4dGFyZWFcIil7XG5cdFx0XHRcdFx0XHRlZGl0b3JFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIixmdW5jdGlvbihlKXtcblx0XHRcdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZpbHRlckVsZW1lbnQuYXBwZW5kQ2hpbGQoZWRpdG9yRWxlbWVudCk7XG5cblx0XHRcdFx0Y29sdW1uLmNvbnRlbnRFbGVtZW50LmFwcGVuZENoaWxkKGZpbHRlckVsZW1lbnQpO1xuXG5cdFx0XHRcdGlmKCFyZWluaXRpYWxpemUpe1xuXHRcdFx0XHRcdHNlbGYuaGVhZGVyRmlsdGVyQ29sdW1ucy5wdXNoKGNvbHVtbik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZihvblJlbmRlcmVkQ2FsbGJhY2spe1xuXHRcdFx0XHRcdG9uUmVuZGVyZWRDYWxsYmFjaygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiRmlsdGVyIEVycm9yIC0gQ2Fubm90IGFkZCBoZWFkZXIgZmlsdGVyLCBjb2x1bW4gaGFzIG5vIGZpZWxkIHNldDpcIiwgY29sdW1uLmRlZmluaXRpb24udGl0bGUpO1xuXHRcdH1cblx0fVxuXG5cdC8vaGlkZSBhbGwgaGVhZGVyIGZpbHRlciBlbGVtZW50cyAodXNlZCB0byBlbnN1cmUgY29ycmVjdCBjb2x1bW4gd2lkdGhzIGluIFwiZml0RGF0YVwiIGxheW91dCBtb2RlKVxuXHRoaWRlSGVhZGVyRmlsdGVyRWxlbWVudHMoKXtcblx0XHR0aGlzLmhlYWRlckZpbHRlckNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuZmlsdGVyICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50KXtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLmhlYWRlckVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8vc2hvdyBhbGwgaGVhZGVyIGZpbHRlciBlbGVtZW50cyAodXNlZCB0byBlbnN1cmUgY29ycmVjdCBjb2x1bW4gd2lkdGhzIGluIFwiZml0RGF0YVwiIGxheW91dCBtb2RlKVxuXHRzaG93SGVhZGVyRmlsdGVyRWxlbWVudHMoKXtcblx0XHR0aGlzLmhlYWRlckZpbHRlckNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuZmlsdGVyICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50KXtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLmhlYWRlckVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICcnO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0Ly9wcm9ncmFtbWF0aWNhbGx5IHNldCBmb2N1cyBvZiBoZWFkZXIgZmlsdGVyXG5cdHNldEhlYWRlckZpbHRlckZvY3VzKGNvbHVtbil7XG5cdFx0aWYoY29sdW1uLm1vZHVsZXMuZmlsdGVyICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50KXtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50LmZvY3VzKCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIEZpbHRlciBGb2N1cyBFcnJvciAtIE5vIGhlYWRlciBmaWx0ZXIgc2V0IG9uIGNvbHVtbjpcIiwgY29sdW1uLmdldEZpZWxkKCkpO1xuXHRcdH1cblx0fVxuXG5cdC8vcHJvZ3JhbW1hdGljYWxseSBnZXQgdmFsdWUgb2YgaGVhZGVyIGZpbHRlclxuXHRnZXRIZWFkZXJGaWx0ZXJWYWx1ZShjb2x1bW4pe1xuXHRcdGlmKGNvbHVtbi5tb2R1bGVzLmZpbHRlciAmJiBjb2x1bW4ubW9kdWxlcy5maWx0ZXIuaGVhZGVyRWxlbWVudCl7XG5cdFx0XHRyZXR1cm4gY29sdW1uLm1vZHVsZXMuZmlsdGVyLnZhbHVlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJDb2x1bW4gRmlsdGVyIEVycm9yIC0gTm8gaGVhZGVyIGZpbHRlciBzZXQgb24gY29sdW1uOlwiLCBjb2x1bW4uZ2V0RmllbGQoKSk7XG5cdFx0fVxuXHR9XG5cblx0Ly9wcm9ncmFtbWF0aWNhbGx5IHNldCB2YWx1ZSBvZiBoZWFkZXIgZmlsdGVyXG5cdHNldEhlYWRlckZpbHRlclZhbHVlKGNvbHVtbiwgdmFsdWUpe1xuXHRcdGlmIChjb2x1bW4pe1xuXHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuZmlsdGVyICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50KXtcblx0XHRcdFx0dGhpcy5nZW5lcmF0ZUhlYWRlckZpbHRlckVsZW1lbnQoY29sdW1uLCB2YWx1ZSwgdHJ1ZSk7XG5cdFx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5zdWNjZXNzKHZhbHVlKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIEZpbHRlciBFcnJvciAtIE5vIGhlYWRlciBmaWx0ZXIgc2V0IG9uIGNvbHVtbjpcIiwgY29sdW1uLmdldEZpZWxkKCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJlbG9hZEhlYWRlckZpbHRlcihjb2x1bW4pe1xuXHRcdGlmIChjb2x1bW4pe1xuXHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuZmlsdGVyICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50KXtcblx0XHRcdFx0dGhpcy5nZW5lcmF0ZUhlYWRlckZpbHRlckVsZW1lbnQoY29sdW1uLCBjb2x1bW4ubW9kdWxlcy5maWx0ZXIudmFsdWUsIHRydWUpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJDb2x1bW4gRmlsdGVyIEVycm9yIC0gTm8gaGVhZGVyIGZpbHRlciBzZXQgb24gY29sdW1uOlwiLCBjb2x1bW4uZ2V0RmllbGQoKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmVmcmVzaEZpbHRlcigpe1xuXHRcdGlmKHRoaXMudGFibGVJbml0aWFsaXplZCl7XG5cdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZmlsdGVyTW9kZSA9PT0gXCJyZW1vdGVcIil7XG5cdFx0XHRcdHRoaXMucmVsb2FkRGF0YShudWxsLCBmYWxzZSwgZmFsc2UpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLnJlZnJlc2hEYXRhKHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vVE9ETyAtIFBlcnNpc3QgbGVmdCBwb3NpdGlvbiBvZiByb3cgbWFuYWdlclxuXHRcdC8vIGxlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XG5cdFx0Ly8gdGhpcy5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHR9XG5cblx0Ly9jaGVjayBpZiB0aGUgZmlsdGVycyBoYXMgY2hhbmdlZCBzaW5jZSBsYXN0IHVzZVxuXHR0cmFja0NoYW5nZXMoKXtcblx0XHR0aGlzLmNoYW5nZWQgPSB0cnVlO1xuXHRcdHRoaXMuZGlzcGF0Y2goXCJmaWx0ZXItY2hhbmdlZFwiKTtcblx0fVxuXG5cdC8vY2hlY2sgaWYgdGhlIGZpbHRlcnMgaGFzIGNoYW5nZWQgc2luY2UgbGFzdCB1c2Vcblx0aGFzQ2hhbmdlZCgpe1xuXHRcdHZhciBjaGFuZ2VkID0gdGhpcy5jaGFuZ2VkO1xuXHRcdHRoaXMuY2hhbmdlZCA9IGZhbHNlO1xuXHRcdHJldHVybiBjaGFuZ2VkO1xuXHR9XG5cblx0Ly9zZXQgc3RhbmRhcmQgZmlsdGVyc1xuXHRzZXRGaWx0ZXIoZmllbGQsIHR5cGUsIHZhbHVlLCBwYXJhbXMpe1xuXHRcdHRoaXMuZmlsdGVyTGlzdCA9IFtdO1xuXG5cdFx0aWYoIUFycmF5LmlzQXJyYXkoZmllbGQpKXtcblx0XHRcdGZpZWxkID0gW3tmaWVsZDpmaWVsZCwgdHlwZTp0eXBlLCB2YWx1ZTp2YWx1ZSwgcGFyYW1zOnBhcmFtc31dO1xuXHRcdH1cblxuXHRcdHRoaXMuYWRkRmlsdGVyKGZpZWxkKTtcblx0fVxuXG5cdC8vYWRkIGZpbHRlciB0byBhcnJheVxuXHRhZGRGaWx0ZXIoZmllbGQsIHR5cGUsIHZhbHVlLCBwYXJhbXMpe1xuXHRcdHZhciBjaGFuZ2VkID0gZmFsc2U7XG5cblx0XHRpZighQXJyYXkuaXNBcnJheShmaWVsZCkpe1xuXHRcdFx0ZmllbGQgPSBbe2ZpZWxkOmZpZWxkLCB0eXBlOnR5cGUsIHZhbHVlOnZhbHVlLCBwYXJhbXM6cGFyYW1zfV07XG5cdFx0fVxuXG5cdFx0ZmllbGQuZm9yRWFjaCgoZmlsdGVyKSA9PiB7XG5cdFx0XHRmaWx0ZXIgPSB0aGlzLmZpbmRGaWx0ZXIoZmlsdGVyKTtcblxuXHRcdFx0aWYoZmlsdGVyKXtcblx0XHRcdFx0dGhpcy5maWx0ZXJMaXN0LnB1c2goZmlsdGVyKTtcblx0XHRcdFx0Y2hhbmdlZCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZihjaGFuZ2VkKXtcblx0XHRcdHRoaXMudHJhY2tDaGFuZ2VzKCk7XG5cdFx0fVxuXHR9XG5cblx0ZmluZEZpbHRlcihmaWx0ZXIpe1xuXHRcdHZhciBjb2x1bW47XG5cblx0XHRpZihBcnJheS5pc0FycmF5KGZpbHRlcikpe1xuXHRcdFx0cmV0dXJuIHRoaXMuZmluZFN1YkZpbHRlcnMoZmlsdGVyKTtcblx0XHR9XG5cblx0XHR2YXIgZmlsdGVyRnVuYyA9IGZhbHNlO1xuXG5cdFx0aWYodHlwZW9mIGZpbHRlci5maWVsZCA9PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uKGRhdGEpe1xuXHRcdFx0XHRyZXR1cm4gZmlsdGVyLmZpZWxkKGRhdGEsIGZpbHRlci50eXBlIHx8IHt9KTsvLyBwYXNzIHBhcmFtcyB0byBjdXN0b20gZmlsdGVyIGZ1bmN0aW9uXG5cdFx0XHR9O1xuXHRcdH1lbHNlIHtcblxuXHRcdFx0aWYoRmlsdGVyLmZpbHRlcnNbZmlsdGVyLnR5cGVdKXtcblxuXHRcdFx0XHRjb2x1bW4gPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29sdW1uQnlGaWVsZChmaWx0ZXIuZmllbGQpO1xuXG5cdFx0XHRcdGlmKGNvbHVtbil7XG5cdFx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uKGRhdGEpe1xuXHRcdFx0XHRcdFx0cmV0dXJuIEZpbHRlci5maWx0ZXJzW2ZpbHRlci50eXBlXShmaWx0ZXIudmFsdWUsIGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpLCBkYXRhLCBmaWx0ZXIucGFyYW1zIHx8IHt9KTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uKGRhdGEpe1xuXHRcdFx0XHRcdFx0cmV0dXJuIEZpbHRlci5maWx0ZXJzW2ZpbHRlci50eXBlXShmaWx0ZXIudmFsdWUsIGRhdGFbZmlsdGVyLmZpZWxkXSwgZGF0YSwgZmlsdGVyLnBhcmFtcyB8fCB7fSk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXG5cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiRmlsdGVyIEVycm9yIC0gTm8gc3VjaCBmaWx0ZXIgdHlwZSBmb3VuZCwgaWdub3Jpbmc6IFwiLCBmaWx0ZXIudHlwZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZmlsdGVyLmZ1bmMgPSBmaWx0ZXJGdW5jO1xuXG5cdFx0cmV0dXJuIGZpbHRlci5mdW5jID8gZmlsdGVyIDogZmFsc2U7XG5cdH1cblxuXHRmaW5kU3ViRmlsdGVycyhmaWx0ZXJzKXtcblx0XHR2YXIgb3V0cHV0ID0gW107XG5cblx0XHRmaWx0ZXJzLmZvckVhY2goKGZpbHRlcikgPT4ge1xuXHRcdFx0ZmlsdGVyID0gdGhpcy5maW5kRmlsdGVyKGZpbHRlcik7XG5cblx0XHRcdGlmKGZpbHRlcil7XG5cdFx0XHRcdG91dHB1dC5wdXNoKGZpbHRlcik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gb3V0cHV0Lmxlbmd0aCA/IG91dHB1dCA6IGZhbHNlO1xuXHR9XG5cblx0Ly9nZXQgYWxsIGZpbHRlcnNcblx0Z2V0RmlsdGVycyhhbGwsIGFqYXgpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblxuXHRcdGlmKGFsbCl7XG5cdFx0XHRvdXRwdXQgPSB0aGlzLmdldEhlYWRlckZpbHRlcnMoKTtcblx0XHR9XG5cblx0XHRpZihhamF4KXtcblx0XHRcdG91dHB1dC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuXHRcdFx0XHRpZih0eXBlb2YgaXRlbS50eXBlID09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdFx0aXRlbS50eXBlID0gXCJmdW5jdGlvblwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRvdXRwdXQgPSBvdXRwdXQuY29uY2F0KHRoaXMuZmlsdGVyc1RvQXJyYXkodGhpcy5maWx0ZXJMaXN0LCBhamF4KSk7XG5cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cblx0Ly9maWx0ZXIgdG8gT2JqZWN0XG5cdGZpbHRlcnNUb0FycmF5KGZpbHRlckxpc3QsIGFqYXgpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblxuXHRcdGZpbHRlckxpc3QuZm9yRWFjaCgoZmlsdGVyKSA9PiB7XG5cdFx0XHR2YXIgaXRlbTtcblxuXHRcdFx0aWYoQXJyYXkuaXNBcnJheShmaWx0ZXIpKXtcblx0XHRcdFx0b3V0cHV0LnB1c2godGhpcy5maWx0ZXJzVG9BcnJheShmaWx0ZXIsIGFqYXgpKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aXRlbSA9IHtmaWVsZDpmaWx0ZXIuZmllbGQsIHR5cGU6ZmlsdGVyLnR5cGUsIHZhbHVlOmZpbHRlci52YWx1ZX07XG5cblx0XHRcdFx0aWYoYWpheCl7XG5cdFx0XHRcdFx0aWYodHlwZW9mIGl0ZW0udHlwZSA9PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0XHRcdFx0aXRlbS50eXBlID0gXCJmdW5jdGlvblwiO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdG91dHB1dC5wdXNoKGl0ZW0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXG5cdC8vZ2V0IGFsbCBmaWx0ZXJzXG5cdGdldEhlYWRlckZpbHRlcnMoKXtcblx0XHR2YXIgb3V0cHV0ID0gW107XG5cblx0XHRmb3IodmFyIGtleSBpbiB0aGlzLmhlYWRlckZpbHRlcnMpe1xuXHRcdFx0b3V0cHV0LnB1c2goe2ZpZWxkOmtleSwgdHlwZTp0aGlzLmhlYWRlckZpbHRlcnNba2V5XS50eXBlLCB2YWx1ZTp0aGlzLmhlYWRlckZpbHRlcnNba2V5XS52YWx1ZX0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblxuXHQvL3JlbW92ZSBmaWx0ZXIgZnJvbSBhcnJheVxuXHRyZW1vdmVGaWx0ZXIoZmllbGQsIHR5cGUsIHZhbHVlKXtcblx0XHRpZighQXJyYXkuaXNBcnJheShmaWVsZCkpe1xuXHRcdFx0ZmllbGQgPSBbe2ZpZWxkOmZpZWxkLCB0eXBlOnR5cGUsIHZhbHVlOnZhbHVlfV07XG5cdFx0fVxuXG5cdFx0ZmllbGQuZm9yRWFjaCgoZmlsdGVyKSA9PiB7XG5cdFx0XHR2YXIgaW5kZXggPSAtMTtcblxuXHRcdFx0aWYodHlwZW9mIGZpbHRlci5maWVsZCA9PSBcIm9iamVjdFwiKXtcblx0XHRcdFx0aW5kZXggPSB0aGlzLmZpbHRlckxpc3QuZmluZEluZGV4KChlbGVtZW50KSA9PiB7XG5cdFx0XHRcdFx0cmV0dXJuIGZpbHRlciA9PT0gZWxlbWVudDtcblx0XHRcdFx0fSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGluZGV4ID0gdGhpcy5maWx0ZXJMaXN0LmZpbmRJbmRleCgoZWxlbWVudCkgPT4ge1xuXHRcdFx0XHRcdHJldHVybiBmaWx0ZXIuZmllbGQgPT09IGVsZW1lbnQuZmllbGQgJiYgZmlsdGVyLnR5cGUgPT09IGVsZW1lbnQudHlwZSAgJiYgZmlsdGVyLnZhbHVlID09PSBlbGVtZW50LnZhbHVlO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0aWYoaW5kZXggPiAtMSl7XG5cdFx0XHRcdHRoaXMuZmlsdGVyTGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJGaWx0ZXIgRXJyb3IgLSBObyBtYXRjaGluZyBmaWx0ZXIgdHlwZSBmb3VuZCwgaWdub3Jpbmc6IFwiLCBmaWx0ZXIudHlwZSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLnRyYWNrQ2hhbmdlcygpO1xuXHR9XG5cblx0Ly9jbGVhciBmaWx0ZXJzXG5cdGNsZWFyRmlsdGVyKGFsbCl7XG5cdFx0dGhpcy5maWx0ZXJMaXN0ID0gW107XG5cblx0XHRpZihhbGwpe1xuXHRcdFx0dGhpcy5jbGVhckhlYWRlckZpbHRlcigpO1xuXHRcdH1cblxuXHRcdHRoaXMudHJhY2tDaGFuZ2VzKCk7XG5cdH1cblxuXHQvL2NsZWFyIGhlYWRlciBmaWx0ZXJzXG5cdGNsZWFySGVhZGVyRmlsdGVyKCl7XG5cdFx0dGhpcy5oZWFkZXJGaWx0ZXJzID0ge307XG5cdFx0dGhpcy5wcmV2SGVhZGVyRmlsdGVyQ2hhbmdlQ2hlY2sgPSBcInt9XCI7XG5cblx0XHR0aGlzLmhlYWRlckZpbHRlckNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRpZih0eXBlb2YgY29sdW1uLm1vZHVsZXMuZmlsdGVyLnZhbHVlICE9PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdFx0ZGVsZXRlIGNvbHVtbi5tb2R1bGVzLmZpbHRlci52YWx1ZTtcblx0XHRcdH1cblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5wcmV2U3VjY2VzcyA9IHVuZGVmaW5lZDtcblx0XHRcdHRoaXMucmVsb2FkSGVhZGVyRmlsdGVyKGNvbHVtbik7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnRyYWNrQ2hhbmdlcygpO1xuXHR9XG5cblx0Ly9zZWFyY2ggZGF0YSBhbmQgcmV0dXJuIG1hdGNoaW5nIHJvd3Ncblx0c2VhcmNoIChzZWFyY2hUeXBlLCBmaWVsZCwgdHlwZSwgdmFsdWUpe1xuXHRcdHZhciBhY3RpdmVSb3dzID0gW10sXG5cdFx0ZmlsdGVyTGlzdCA9IFtdO1xuXG5cdFx0aWYoIUFycmF5LmlzQXJyYXkoZmllbGQpKXtcblx0XHRcdGZpZWxkID0gW3tmaWVsZDpmaWVsZCwgdHlwZTp0eXBlLCB2YWx1ZTp2YWx1ZX1dO1xuXHRcdH1cblxuXHRcdGZpZWxkLmZvckVhY2goKGZpbHRlcikgPT4ge1xuXHRcdFx0ZmlsdGVyID0gdGhpcy5maW5kRmlsdGVyKGZpbHRlcik7XG5cblx0XHRcdGlmKGZpbHRlcil7XG5cdFx0XHRcdGZpbHRlckxpc3QucHVzaChmaWx0ZXIpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHR2YXIgbWF0Y2ggPSB0cnVlO1xuXG5cdFx0XHRmaWx0ZXJMaXN0LmZvckVhY2goKGZpbHRlcikgPT4ge1xuXHRcdFx0XHRpZighdGhpcy5maWx0ZXJSZWN1cnNlKGZpbHRlciwgcm93LmdldERhdGEoKSkpe1xuXHRcdFx0XHRcdG1hdGNoID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRpZihtYXRjaCl7XG5cdFx0XHRcdGFjdGl2ZVJvd3MucHVzaChzZWFyY2hUeXBlID09PSBcImRhdGFcIiA/IHJvdy5nZXREYXRhKFwiZGF0YVwiKSA6IHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cblx0XHR9KTtcblxuXHRcdHJldHVybiBhY3RpdmVSb3dzO1xuXHR9XG5cblx0Ly9maWx0ZXIgcm93IGFycmF5XG5cdGZpbHRlcihyb3dMaXN0LCBmaWx0ZXJzKXtcblx0XHR2YXIgYWN0aXZlUm93cyA9IFtdLFxuXHRcdGFjdGl2ZVJvd0NvbXBvbmVudHMgPSBbXTtcblxuXHRcdGlmKHRoaXMuc3Vic2NyaWJlZEV4dGVybmFsKFwiZGF0YUZpbHRlcmluZ1wiKSl7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhRmlsdGVyaW5nXCIsIHRoaXMuZ2V0RmlsdGVycyh0cnVlKSk7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmZpbHRlck1vZGUgIT09IFwicmVtb3RlXCIgJiYgKHRoaXMuZmlsdGVyTGlzdC5sZW5ndGggfHwgT2JqZWN0LmtleXModGhpcy5oZWFkZXJGaWx0ZXJzKS5sZW5ndGgpKXtcblxuXHRcdFx0cm93TGlzdC5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdFx0aWYodGhpcy5maWx0ZXJSb3cocm93KSl7XG5cdFx0XHRcdFx0YWN0aXZlUm93cy5wdXNoKHJvdyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0fWVsc2Uge1xuXHRcdFx0YWN0aXZlUm93cyA9IHJvd0xpc3Quc2xpY2UoMCk7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5zdWJzY3JpYmVkRXh0ZXJuYWwoXCJkYXRhRmlsdGVyZWRcIikpe1xuXG5cdFx0XHRhY3RpdmVSb3dzLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRhY3RpdmVSb3dDb21wb25lbnRzLnB1c2gocm93LmdldENvbXBvbmVudCgpKTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhRmlsdGVyZWRcIiwgdGhpcy5nZXRGaWx0ZXJzKHRydWUpLCBhY3RpdmVSb3dDb21wb25lbnRzKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gYWN0aXZlUm93cztcblx0fVxuXG5cdC8vZmlsdGVyIGluZGl2aWR1YWwgcm93XG5cdGZpbHRlclJvdyhyb3csIGZpbHRlcnMpe1xuXHRcdHZhciBtYXRjaCA9IHRydWUsXG5cdFx0ZGF0YSA9IHJvdy5nZXREYXRhKCk7XG5cblx0XHR0aGlzLmZpbHRlckxpc3QuZm9yRWFjaCgoZmlsdGVyKSA9PiB7XG5cdFx0XHRpZighdGhpcy5maWx0ZXJSZWN1cnNlKGZpbHRlciwgZGF0YSkpe1xuXHRcdFx0XHRtYXRjaCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cblx0XHRmb3IodmFyIGZpZWxkIGluIHRoaXMuaGVhZGVyRmlsdGVycyl7XG5cdFx0XHRpZighdGhpcy5oZWFkZXJGaWx0ZXJzW2ZpZWxkXS5mdW5jKGRhdGEpKXtcblx0XHRcdFx0bWF0Y2ggPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbWF0Y2g7XG5cdH1cblxuXHRmaWx0ZXJSZWN1cnNlKGZpbHRlciwgZGF0YSl7XG5cdFx0dmFyIG1hdGNoID0gZmFsc2U7XG5cblx0XHRpZihBcnJheS5pc0FycmF5KGZpbHRlcikpe1xuXHRcdFx0ZmlsdGVyLmZvckVhY2goKHN1YkZpbHRlcikgPT4ge1xuXHRcdFx0XHRpZih0aGlzLmZpbHRlclJlY3Vyc2Uoc3ViRmlsdGVyLCBkYXRhKSl7XG5cdFx0XHRcdFx0bWF0Y2ggPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRtYXRjaCA9IGZpbHRlci5mdW5jKGRhdGEpO1xuXHRcdH1cblxuXHRcdHJldHVybiBtYXRjaDtcblx0fVxufVxuXG5mdW5jdGlvbiBwbGFpbnRleHQoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0cmV0dXJuIHRoaXMuZW1wdHlUb1NwYWNlKHRoaXMuc2FuaXRpemVIVE1MKGNlbGwuZ2V0VmFsdWUoKSkpO1xufVxuXG5mdW5jdGlvbiBodG1sKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCl7XG5cdHJldHVybiBjZWxsLmdldFZhbHVlKCk7XG59XG5cbmZ1bmN0aW9uIHRleHRhcmVhKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCl7XG5cdGNlbGwuZ2V0RWxlbWVudCgpLnN0eWxlLndoaXRlU3BhY2UgPSBcInByZS13cmFwXCI7XG5cdHJldHVybiB0aGlzLmVtcHR5VG9TcGFjZSh0aGlzLnNhbml0aXplSFRNTChjZWxsLmdldFZhbHVlKCkpKTtcbn1cblxuZnVuY3Rpb24gbW9uZXkoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0dmFyIGZsb2F0VmFsID0gcGFyc2VGbG9hdChjZWxsLmdldFZhbHVlKCkpLFxuXHRzaWduID0gXCJcIixcblx0bnVtYmVyLCBpbnRlZ2VyLCBkZWNpbWFsLCByZ3gsIHZhbHVlO1xuXG5cdHZhciBkZWNpbWFsU3ltID0gZm9ybWF0dGVyUGFyYW1zLmRlY2ltYWwgfHwgXCIuXCI7XG5cdHZhciB0aG91c2FuZFN5bSA9IGZvcm1hdHRlclBhcmFtcy50aG91c2FuZCB8fCBcIixcIjtcblx0dmFyIG5lZ2F0aXZlU2lnbiA9IGZvcm1hdHRlclBhcmFtcy5uZWdhdGl2ZVNpZ24gfHwgXCItXCI7XG5cdHZhciBzeW1ib2wgPSBmb3JtYXR0ZXJQYXJhbXMuc3ltYm9sIHx8IFwiXCI7XG5cdHZhciBhZnRlciA9ICEhZm9ybWF0dGVyUGFyYW1zLnN5bWJvbEFmdGVyO1xuXHR2YXIgcHJlY2lzaW9uID0gdHlwZW9mIGZvcm1hdHRlclBhcmFtcy5wcmVjaXNpb24gIT09IFwidW5kZWZpbmVkXCIgPyBmb3JtYXR0ZXJQYXJhbXMucHJlY2lzaW9uIDogMjtcblxuXHRpZihpc05hTihmbG9hdFZhbCkpe1xuXHRcdHJldHVybiB0aGlzLmVtcHR5VG9TcGFjZSh0aGlzLnNhbml0aXplSFRNTChjZWxsLmdldFZhbHVlKCkpKTtcblx0fVxuXG5cdGlmKGZsb2F0VmFsIDwgMCl7XG5cdFx0ZmxvYXRWYWwgPSBNYXRoLmFicyhmbG9hdFZhbCk7XG5cdFx0c2lnbiA9IG5lZ2F0aXZlU2lnbjtcblx0fVxuXG5cdG51bWJlciA9IHByZWNpc2lvbiAhPT0gZmFsc2UgPyBmbG9hdFZhbC50b0ZpeGVkKHByZWNpc2lvbikgOiBmbG9hdFZhbDtcblx0bnVtYmVyID0gU3RyaW5nKG51bWJlcikuc3BsaXQoXCIuXCIpO1xuXG5cdGludGVnZXIgPSBudW1iZXJbMF07XG5cdGRlY2ltYWwgPSBudW1iZXIubGVuZ3RoID4gMSA/IGRlY2ltYWxTeW0gKyBudW1iZXJbMV0gOiBcIlwiO1xuXG5cdGlmIChmb3JtYXR0ZXJQYXJhbXMudGhvdXNhbmQgIT09IGZhbHNlKSB7XG5cdFx0cmd4ID0gLyhcXGQrKShcXGR7M30pLztcblxuXHRcdHdoaWxlIChyZ3gudGVzdChpbnRlZ2VyKSl7XG5cdFx0XHRpbnRlZ2VyID0gaW50ZWdlci5yZXBsYWNlKHJneCwgXCIkMVwiICsgdGhvdXNhbmRTeW0gKyBcIiQyXCIpO1xuXHRcdH1cblx0fVxuXG5cdHZhbHVlID0gaW50ZWdlciArIGRlY2ltYWw7XG5cdFxuXHRpZihzaWduID09PSB0cnVlKXtcblx0XHR2YWx1ZSA9IFwiKFwiICsgdmFsdWUgICsgXCIpXCI7XG5cdFx0cmV0dXJuIGFmdGVyID8gdmFsdWUgKyBzeW1ib2wgOiBzeW1ib2wgKyB2YWx1ZTtcblx0fWVsc2Uge1xuXHRcdHJldHVybiBhZnRlciA/IHNpZ24gKyB2YWx1ZSArIHN5bWJvbCA6IHNpZ24gKyBzeW1ib2wgKyB2YWx1ZTtcblx0fVxufVxuXG5mdW5jdGlvbiBsaW5rKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCl7XG5cdHZhciB2YWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKSxcblx0dXJsUHJlZml4ID0gZm9ybWF0dGVyUGFyYW1zLnVybFByZWZpeCB8fCBcIlwiLFxuXHRkb3dubG9hZCA9IGZvcm1hdHRlclBhcmFtcy5kb3dubG9hZCxcblx0bGFiZWwgPSB2YWx1ZSxcblx0ZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKSxcblx0ZGF0YTtcblxuXHRmdW5jdGlvbiBsYWJlbFRyYXZlcnNlKHBhdGgsIGRhdGEpe1xuXHRcdHZhciBpdGVtID0gcGF0aC5zaGlmdCgpLFxuXHRcdHZhbHVlID0gZGF0YVtpdGVtXTtcblx0XHRcblx0XHRpZihwYXRoLmxlbmd0aCAmJiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIpe1xuXHRcdFx0cmV0dXJuIGxhYmVsVHJhdmVyc2UocGF0aCwgdmFsdWUpO1xuXHRcdH1cblxuXHRcdHJldHVybiB2YWx1ZTtcblx0fVxuXG5cdGlmKGZvcm1hdHRlclBhcmFtcy5sYWJlbEZpZWxkKXtcblx0XHRkYXRhID0gY2VsbC5nZXREYXRhKCk7XG5cdFx0bGFiZWwgPSBsYWJlbFRyYXZlcnNlKGZvcm1hdHRlclBhcmFtcy5sYWJlbEZpZWxkLnNwbGl0KHRoaXMudGFibGUub3B0aW9ucy5uZXN0ZWRGaWVsZFNlcGFyYXRvciksIGRhdGEpO1xuXHR9XG5cblx0aWYoZm9ybWF0dGVyUGFyYW1zLmxhYmVsKXtcblx0XHRzd2l0Y2godHlwZW9mIGZvcm1hdHRlclBhcmFtcy5sYWJlbCl7XG5cdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdGxhYmVsID0gZm9ybWF0dGVyUGFyYW1zLmxhYmVsO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdGxhYmVsID0gZm9ybWF0dGVyUGFyYW1zLmxhYmVsKGNlbGwpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH1cblxuXHRpZihsYWJlbCl7XG5cdFx0aWYoZm9ybWF0dGVyUGFyYW1zLnVybEZpZWxkKXtcblx0XHRcdGRhdGEgPSBjZWxsLmdldERhdGEoKTtcblxuXHRcdFx0dmFsdWUgPSBIZWxwZXJzLnJldHJpZXZlTmVzdGVkRGF0YSh0aGlzLnRhYmxlLm9wdGlvbnMubmVzdGVkRmllbGRTZXBhcmF0b3IsIGZvcm1hdHRlclBhcmFtcy51cmxGaWVsZCwgZGF0YSk7XG5cdFx0fVxuXG5cdFx0aWYoZm9ybWF0dGVyUGFyYW1zLnVybCl7XG5cdFx0XHRzd2l0Y2godHlwZW9mIGZvcm1hdHRlclBhcmFtcy51cmwpe1xuXHRcdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdFx0dmFsdWUgPSBmb3JtYXR0ZXJQYXJhbXMudXJsO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRcdHZhbHVlID0gZm9ybWF0dGVyUGFyYW1zLnVybChjZWxsKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsIHVybFByZWZpeCArIHZhbHVlKTtcblxuXHRcdGlmKGZvcm1hdHRlclBhcmFtcy50YXJnZXQpe1xuXHRcdFx0ZWwuc2V0QXR0cmlidXRlKFwidGFyZ2V0XCIsIGZvcm1hdHRlclBhcmFtcy50YXJnZXQpO1xuXHRcdH1cblxuXHRcdGlmKGZvcm1hdHRlclBhcmFtcy5kb3dubG9hZCl7XG5cblx0XHRcdGlmKHR5cGVvZiBkb3dubG9hZCA9PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0XHRkb3dubG9hZCA9IGRvd25sb2FkKGNlbGwpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRkb3dubG9hZCA9IGRvd25sb2FkID09PSB0cnVlID8gXCJcIiA6IGRvd25sb2FkO1xuXHRcdFx0fVxuXG5cdFx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJkb3dubG9hZFwiLCBkb3dubG9hZCk7XG5cdFx0fVxuXG5cdFx0ZWwuaW5uZXJIVE1MID0gdGhpcy5lbXB0eVRvU3BhY2UodGhpcy5zYW5pdGl6ZUhUTUwobGFiZWwpKTtcblxuXHRcdHJldHVybiBlbDtcblx0fWVsc2Uge1xuXHRcdHJldHVybiBcIiZuYnNwO1wiO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGltYWdlKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCl7XG5cdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiksXG5cdHNyYyA9IGNlbGwuZ2V0VmFsdWUoKTtcblxuXHRpZihmb3JtYXR0ZXJQYXJhbXMudXJsUHJlZml4KXtcblx0XHRzcmMgPSBmb3JtYXR0ZXJQYXJhbXMudXJsUHJlZml4ICsgY2VsbC5nZXRWYWx1ZSgpO1xuXHR9XG5cblx0aWYoZm9ybWF0dGVyUGFyYW1zLnVybFN1ZmZpeCl7XG5cdFx0c3JjID0gc3JjICsgZm9ybWF0dGVyUGFyYW1zLnVybFN1ZmZpeDtcblx0fVxuXG5cdGVsLnNldEF0dHJpYnV0ZShcInNyY1wiLCBzcmMpO1xuXG5cdHN3aXRjaCh0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLmhlaWdodCl7XG5cdFx0Y2FzZSBcIm51bWJlclwiOlxuXHRcdFx0ZWwuc3R5bGUuaGVpZ2h0ID0gZm9ybWF0dGVyUGFyYW1zLmhlaWdodCArIFwicHhcIjtcblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0ZWwuc3R5bGUuaGVpZ2h0ID0gZm9ybWF0dGVyUGFyYW1zLmhlaWdodDtcblx0XHRcdGJyZWFrO1xuXHR9XG5cblx0c3dpdGNoKHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMud2lkdGgpe1xuXHRcdGNhc2UgXCJudW1iZXJcIjpcblx0XHRcdGVsLnN0eWxlLndpZHRoID0gZm9ybWF0dGVyUGFyYW1zLndpZHRoICsgXCJweFwiO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRlbC5zdHlsZS53aWR0aCA9IGZvcm1hdHRlclBhcmFtcy53aWR0aDtcblx0XHRcdGJyZWFrO1xuXHR9XG5cblx0ZWwuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24oKXtcblx0XHRjZWxsLmdldFJvdygpLm5vcm1hbGl6ZUhlaWdodCgpO1xuXHR9KTtcblxuXHRyZXR1cm4gZWw7XG59XG5cbmZ1bmN0aW9uIHRpY2tDcm9zcyhjZWxsLCBmb3JtYXR0ZXJQYXJhbXMsIG9uUmVuZGVyZWQpe1xuXHR2YXIgdmFsdWUgPSBjZWxsLmdldFZhbHVlKCksXG5cdGVsZW1lbnQgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0ZW1wdHkgPSBmb3JtYXR0ZXJQYXJhbXMuYWxsb3dFbXB0eSxcblx0dHJ1dGh5ID0gZm9ybWF0dGVyUGFyYW1zLmFsbG93VHJ1dGh5LFxuXHR0cnVlVmFsdWVTZXQgPSBPYmplY3Qua2V5cyhmb3JtYXR0ZXJQYXJhbXMpLmluY2x1ZGVzKFwidHJ1ZVZhbHVlXCIpLFxuXHR0aWNrID0gdHlwZW9mIGZvcm1hdHRlclBhcmFtcy50aWNrRWxlbWVudCAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcm1hdHRlclBhcmFtcy50aWNrRWxlbWVudCA6ICc8c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPVwibmV3IDAgMCAyNCAyNFwiIGhlaWdodD1cIjE0XCIgd2lkdGg9XCIxNFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB4bWw6c3BhY2U9XCJwcmVzZXJ2ZVwiID48cGF0aCBmaWxsPVwiIzJEQzIxNFwiIGNsaXAtcnVsZT1cImV2ZW5vZGRcIiBkPVwiTTIxLjY1MiwzLjIxMWMtMC4yOTMtMC4yOTUtMC43Ny0wLjI5NS0xLjA2MSwwTDkuNDEsMTQuMzQgIGMtMC4yOTMsMC4yOTctMC43NzEsMC4yOTctMS4wNjIsMEwzLjQ0OSw5LjM1MUMzLjMwNCw5LjIwMywzLjExNCw5LjEzLDIuOTIzLDkuMTI5QzIuNzMsOS4xMjgsMi41MzQsOS4yMDEsMi4zODcsOS4zNTEgIGwtMi4xNjUsMS45NDZDMC4wNzgsMTEuNDQ1LDAsMTEuNjMsMCwxMS44MjNjMCwwLjE5NCwwLjA3OCwwLjM5NywwLjIyMywwLjU0NGw0Ljk0LDUuMTg0YzAuMjkyLDAuMjk2LDAuNzcxLDAuNzc2LDEuMDYyLDEuMDcgIGwyLjEyNCwyLjE0MWMwLjI5MiwwLjI5MywwLjc2OSwwLjI5MywxLjA2MiwwbDE0LjM2Ni0xNC4zNGMwLjI5My0wLjI5NCwwLjI5My0wLjc3NywwLTEuMDcxTDIxLjY1MiwzLjIxMXpcIiBmaWxsLXJ1bGU9XCJldmVub2RkXCIvPjwvc3ZnPicsXG5cdGNyb3NzID0gdHlwZW9mIGZvcm1hdHRlclBhcmFtcy5jcm9zc0VsZW1lbnQgIT09IFwidW5kZWZpbmVkXCIgPyBmb3JtYXR0ZXJQYXJhbXMuY3Jvc3NFbGVtZW50IDogJzxzdmcgZW5hYmxlLWJhY2tncm91bmQ9XCJuZXcgMCAwIDI0IDI0XCIgaGVpZ2h0PVwiMTRcIiB3aWR0aD1cIjE0XCIgIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB4bWw6c3BhY2U9XCJwcmVzZXJ2ZVwiID48cGF0aCBmaWxsPVwiI0NFMTUxNVwiIGQ9XCJNMjIuMjQ1LDQuMDE1YzAuMzEzLDAuMzEzLDAuMzEzLDAuODI2LDAsMS4xMzlsLTYuMjc2LDYuMjdjLTAuMzEzLDAuMzEyLTAuMzEzLDAuODI2LDAsMS4xNGw2LjI3Myw2LjI3MiAgYzAuMzEzLDAuMzEzLDAuMzEzLDAuODI2LDAsMS4xNGwtMi4yODUsMi4yNzdjLTAuMzE0LDAuMzEyLTAuODI4LDAuMzEyLTEuMTQyLDBsLTYuMjcxLTYuMjcxYy0wLjMxMy0wLjMxMy0wLjgyOC0wLjMxMy0xLjE0MSwwICBsLTYuMjc2LDYuMjY3Yy0wLjMxMywwLjMxMy0wLjgyOCwwLjMxMy0xLjE0MSwwbC0yLjI4Mi0yLjI4Yy0wLjMxMy0wLjMxMy0wLjMxMy0wLjgyNiwwLTEuMTRsNi4yNzgtNi4yNjkgIGMwLjMxMy0wLjMxMiwwLjMxMy0wLjgyNiwwLTEuMTRMMS43MDksNS4xNDdjLTAuMzE0LTAuMzEzLTAuMzE0LTAuODI3LDAtMS4xNGwyLjI4NC0yLjI3OEM0LjMwOCwxLjQxNyw0LjgyMSwxLjQxNyw1LjEzNSwxLjczICBMMTEuNDA1LDhjMC4zMTQsMC4zMTQsMC44MjgsMC4zMTQsMS4xNDEsMC4wMDFsNi4yNzYtNi4yNjdjMC4zMTItMC4zMTIsMC44MjYtMC4zMTIsMS4xNDEsMEwyMi4yNDUsNC4wMTV6XCIvPjwvc3ZnPic7XG5cblx0aWYoKHRydWVWYWx1ZVNldCAmJiB2YWx1ZSA9PT0gZm9ybWF0dGVyUGFyYW1zLnRydWVWYWx1ZSkgfHwgKCF0cnVlVmFsdWVTZXQgJiYgKCh0cnV0aHkgJiYgdmFsdWUpIHx8ICh2YWx1ZSA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gXCJ0cnVlXCIgfHwgdmFsdWUgPT09IFwiVHJ1ZVwiIHx8IHZhbHVlID09PSAxIHx8IHZhbHVlID09PSBcIjFcIikpKSl7XG5cdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWNoZWNrZWRcIiwgdHJ1ZSk7XG5cdFx0cmV0dXJuIHRpY2sgfHwgXCJcIjtcblx0fWVsc2Uge1xuXHRcdGlmKGVtcHR5ICYmICh2YWx1ZSA9PT0gXCJudWxsXCIgfHwgdmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSl7XG5cdFx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtY2hlY2tlZFwiLCBcIm1peGVkXCIpO1xuXHRcdFx0cmV0dXJuIFwiXCI7XG5cdFx0fWVsc2Uge1xuXHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWNoZWNrZWRcIiwgZmFsc2UpO1xuXHRcdFx0cmV0dXJuIGNyb3NzIHx8IFwiXCI7XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIGRhdGV0aW1lJDEoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0dmFyIERUID0gdGhpcy50YWJsZS5kZXBlbmRlbmN5UmVnaXN0cnkubG9va3VwKFtcImx1eG9uXCIsIFwiRGF0ZVRpbWVcIl0sIFwiRGF0ZVRpbWVcIik7XG5cdHZhciBpbnB1dEZvcm1hdCA9IGZvcm1hdHRlclBhcmFtcy5pbnB1dEZvcm1hdCB8fCBcInl5eXktTU0tZGQgSEg6bW06c3NcIjtcblx0dmFyXHRvdXRwdXRGb3JtYXQgPSBmb3JtYXR0ZXJQYXJhbXMub3V0cHV0Rm9ybWF0IHx8IFwiZGQvTU0veXl5eSBISDptbTpzc1wiO1xuXHR2YXJcdGludmFsaWQgPSB0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLmludmFsaWRQbGFjZWhvbGRlciAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcm1hdHRlclBhcmFtcy5pbnZhbGlkUGxhY2Vob2xkZXIgOiBcIlwiO1xuXHR2YXIgdmFsdWUgPSBjZWxsLmdldFZhbHVlKCk7XG5cblx0aWYodHlwZW9mIERUICE9IFwidW5kZWZpbmVkXCIpe1xuXHRcdHZhciBuZXdEYXRldGltZTtcblxuXHRcdGlmKERULmlzRGF0ZVRpbWUodmFsdWUpKXtcblx0XHRcdG5ld0RhdGV0aW1lID0gdmFsdWU7XG5cdFx0fWVsc2UgaWYoaW5wdXRGb3JtYXQgPT09IFwiaXNvXCIpe1xuXHRcdFx0bmV3RGF0ZXRpbWUgPSBEVC5mcm9tSVNPKFN0cmluZyh2YWx1ZSkpO1xuXHRcdH1lbHNlIHtcblx0XHRcdG5ld0RhdGV0aW1lID0gRFQuZnJvbUZvcm1hdChTdHJpbmcodmFsdWUpLCBpbnB1dEZvcm1hdCk7XG5cdFx0fVxuXG5cdFx0aWYobmV3RGF0ZXRpbWUuaXNWYWxpZCl7XG5cdFx0XHRpZihmb3JtYXR0ZXJQYXJhbXMudGltZXpvbmUpe1xuXHRcdFx0XHRuZXdEYXRldGltZSA9IG5ld0RhdGV0aW1lLnNldFpvbmUoZm9ybWF0dGVyUGFyYW1zLnRpbWV6b25lKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG5ld0RhdGV0aW1lLnRvRm9ybWF0KG91dHB1dEZvcm1hdCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYoaW52YWxpZCA9PT0gdHJ1ZSB8fCAhdmFsdWUpe1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9ZWxzZSBpZih0eXBlb2YgaW52YWxpZCA9PT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdFx0cmV0dXJuIGludmFsaWQodmFsdWUpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gaW52YWxpZDtcblx0XHRcdH1cblx0XHR9XG5cdH1lbHNlIHtcblx0XHRjb25zb2xlLmVycm9yKFwiRm9ybWF0IEVycm9yIC0gJ2RhdGV0aW1lJyBmb3JtYXR0ZXIgaXMgZGVwZW5kYW50IG9uIGx1eG9uLmpzXCIpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGRhdGV0aW1lZGlmZiAoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKSB7XG5cdHZhciBEVCA9IHRoaXMudGFibGUuZGVwZW5kZW5jeVJlZ2lzdHJ5Lmxvb2t1cChbXCJsdXhvblwiLCBcIkRhdGVUaW1lXCJdLCBcIkRhdGVUaW1lXCIpO1xuXHR2YXIgaW5wdXRGb3JtYXQgPSBmb3JtYXR0ZXJQYXJhbXMuaW5wdXRGb3JtYXQgfHwgXCJ5eXl5LU1NLWRkIEhIOm1tOnNzXCI7XG5cdHZhciBpbnZhbGlkID0gdHlwZW9mIGZvcm1hdHRlclBhcmFtcy5pbnZhbGlkUGxhY2Vob2xkZXIgIT09IFwidW5kZWZpbmVkXCIgPyBmb3JtYXR0ZXJQYXJhbXMuaW52YWxpZFBsYWNlaG9sZGVyIDogXCJcIjtcblx0dmFyIHN1ZmZpeCA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMuc3VmZml4ICE9PSBcInVuZGVmaW5lZFwiID8gZm9ybWF0dGVyUGFyYW1zLnN1ZmZpeCA6IGZhbHNlO1xuXHR2YXIgdW5pdCA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMudW5pdCAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcm1hdHRlclBhcmFtcy51bml0IDogXCJkYXlzXCI7XG5cdHZhciBodW1hbml6ZSA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMuaHVtYW5pemUgIT09IFwidW5kZWZpbmVkXCIgPyBmb3JtYXR0ZXJQYXJhbXMuaHVtYW5pemUgOiBmYWxzZTtcblx0dmFyIGRhdGUgPSB0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLmRhdGUgIT09IFwidW5kZWZpbmVkXCIgPyBmb3JtYXR0ZXJQYXJhbXMuZGF0ZSA6IERULm5vdygpO1xuXHR2YXIgdmFsdWUgPSBjZWxsLmdldFZhbHVlKCk7XG5cblx0aWYodHlwZW9mIERUICE9IFwidW5kZWZpbmVkXCIpe1xuXHRcdHZhciBuZXdEYXRldGltZTtcblxuXHRcdGlmKERULmlzRGF0ZVRpbWUodmFsdWUpKXtcblx0XHRcdG5ld0RhdGV0aW1lID0gdmFsdWU7XG5cdFx0fWVsc2UgaWYoaW5wdXRGb3JtYXQgPT09IFwiaXNvXCIpe1xuXHRcdFx0bmV3RGF0ZXRpbWUgPSBEVC5mcm9tSVNPKFN0cmluZyh2YWx1ZSkpO1xuXHRcdH1lbHNlIHtcblx0XHRcdG5ld0RhdGV0aW1lID0gRFQuZnJvbUZvcm1hdChTdHJpbmcodmFsdWUpLCBpbnB1dEZvcm1hdCk7XG5cdFx0fVxuXG5cdFx0aWYgKG5ld0RhdGV0aW1lLmlzVmFsaWQpe1xuXHRcdFx0aWYoaHVtYW5pemUpe1xuXHRcdFx0XHRyZXR1cm4gbmV3RGF0ZXRpbWUuZGlmZihkYXRlLCB1bml0KS50b0h1bWFuKCkgICsgKHN1ZmZpeCA/IFwiIFwiICsgc3VmZml4IDogXCJcIik7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHJldHVybiBwYXJzZUludChuZXdEYXRldGltZS5kaWZmKGRhdGUsIHVuaXQpW3VuaXRdKSArIChzdWZmaXggPyBcIiBcIiArIHN1ZmZpeCA6IFwiXCIpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGlmIChpbnZhbGlkID09PSB0cnVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH0gZWxzZSBpZiAodHlwZW9mIGludmFsaWQgPT09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0XHRyZXR1cm4gaW52YWxpZCh2YWx1ZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gaW52YWxpZDtcblx0XHRcdH1cblx0XHR9XG5cdH1lbHNlIHtcblx0XHRjb25zb2xlLmVycm9yKFwiRm9ybWF0IEVycm9yIC0gJ2RhdGV0aW1lZGlmZicgZm9ybWF0dGVyIGlzIGRlcGVuZGFudCBvbiBsdXhvbi5qc1wiKTtcblx0fVxufVxuXG5mdW5jdGlvbiBsb29rdXAgKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHR2YXIgdmFsdWUgPSBjZWxsLmdldFZhbHVlKCk7XG5cblx0aWYgKHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXNbdmFsdWVdID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0Y29uc29sZS53YXJuKCdNaXNzaW5nIGRpc3BsYXkgdmFsdWUgZm9yICcgKyB2YWx1ZSk7XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9XG5cblx0cmV0dXJuIGZvcm1hdHRlclBhcmFtc1t2YWx1ZV07XG59XG5cbmZ1bmN0aW9uIHN0YXIoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0dmFyIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRlbGVtZW50ID0gY2VsbC5nZXRFbGVtZW50KCksXG5cdG1heFN0YXJzID0gZm9ybWF0dGVyUGFyYW1zICYmIGZvcm1hdHRlclBhcmFtcy5zdGFycyA/IGZvcm1hdHRlclBhcmFtcy5zdGFycyA6IDUsXG5cdHN0YXJzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIiksXG5cdHN0YXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgXCJzdmdcIiksXG5cdHN0YXJBY3RpdmUgPSAnPHBvbHlnb24gZmlsbD1cIiNGRkVBMDBcIiBzdHJva2U9XCIjQzFBQjYwXCIgc3Ryb2tlLXdpZHRoPVwiMzcuNjE1MlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS1taXRlcmxpbWl0PVwiMTBcIiBwb2ludHM9XCIyNTkuMjE2LDI5Ljk0MiAzMzAuMjcsMTczLjkxOSA0ODkuMTYsMTk3LjAwNyAzNzQuMTg1LDMwOS4wOCA0MDEuMzMsNDY3LjMxIDI1OS4yMTYsMzkyLjYxMiAxMTcuMTA0LDQ2Ny4zMSAxNDQuMjUsMzA5LjA4IDI5LjI3NCwxOTcuMDA3IDE4OC4xNjUsMTczLjkxOSBcIi8+Jyxcblx0c3RhckluYWN0aXZlID0gJzxwb2x5Z29uIGZpbGw9XCIjRDJEMkQyXCIgc3Ryb2tlPVwiIzY4Njg2OFwiIHN0cm9rZS13aWR0aD1cIjM3LjYxNTJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBzdHJva2UtbWl0ZXJsaW1pdD1cIjEwXCIgcG9pbnRzPVwiMjU5LjIxNiwyOS45NDIgMzMwLjI3LDE3My45MTkgNDg5LjE2LDE5Ny4wMDcgMzc0LjE4NSwzMDkuMDggNDAxLjMzLDQ2Ny4zMSAyNTkuMjE2LDM5Mi42MTIgMTE3LjEwNCw0NjcuMzEgMTQ0LjI1LDMwOS4wOCAyOS4yNzQsMTk3LjAwNyAxODguMTY1LDE3My45MTkgXCIvPic7XG5cblx0Ly9zdHlsZSBzdGFycyBob2xkZXJcblx0c3RhcnMuc3R5bGUudmVydGljYWxBbGlnbiA9IFwibWlkZGxlXCI7XG5cblx0Ly9zdHlsZSBzdGFyXG5cdHN0YXIuc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgXCIxNFwiKTtcblx0c3Rhci5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgXCIxNFwiKTtcblx0c3Rhci5zZXRBdHRyaWJ1dGUoXCJ2aWV3Qm94XCIsIFwiMCAwIDUxMiA1MTJcIik7XG5cdHN0YXIuc2V0QXR0cmlidXRlKFwieG1sOnNwYWNlXCIsIFwicHJlc2VydmVcIik7XG5cdHN0YXIuc3R5bGUucGFkZGluZyA9IFwiMCAxcHhcIjtcblxuXHR2YWx1ZSA9IHZhbHVlICYmICFpc05hTih2YWx1ZSkgPyBwYXJzZUludCh2YWx1ZSkgOiAwO1xuXG5cdHZhbHVlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odmFsdWUsIG1heFN0YXJzKSk7XG5cblx0Zm9yKHZhciBpPTE7aTw9IG1heFN0YXJzO2krKyl7XG5cdFx0dmFyIG5leHRTdGFyID0gc3Rhci5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0bmV4dFN0YXIuaW5uZXJIVE1MID0gaSA8PSB2YWx1ZSA/IHN0YXJBY3RpdmUgOiBzdGFySW5hY3RpdmU7XG5cblx0XHRzdGFycy5hcHBlbmRDaGlsZChuZXh0U3Rhcik7XG5cdH1cblxuXHRlbGVtZW50LnN0eWxlLndoaXRlU3BhY2UgPSBcIm5vd3JhcFwiO1xuXHRlbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcblx0ZWxlbWVudC5zdHlsZS50ZXh0T3ZlcmZsb3cgPSBcImVsbGlwc2lzXCI7XG5cblx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHZhbHVlKTtcblxuXHRyZXR1cm4gc3RhcnM7XG59XG5cbmZ1bmN0aW9uIHRyYWZmaWMoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0dmFyIHZhbHVlID0gdGhpcy5zYW5pdGl6ZUhUTUwoY2VsbC5nZXRWYWx1ZSgpKSB8fCAwLFxuXHRlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLFxuXHRtYXggPSBmb3JtYXR0ZXJQYXJhbXMgJiYgZm9ybWF0dGVyUGFyYW1zLm1heCA/IGZvcm1hdHRlclBhcmFtcy5tYXggOiAxMDAsXG5cdG1pbiA9IGZvcm1hdHRlclBhcmFtcyAmJiBmb3JtYXR0ZXJQYXJhbXMubWluID8gZm9ybWF0dGVyUGFyYW1zLm1pbiA6IDAsXG5cdGNvbG9ycyA9IGZvcm1hdHRlclBhcmFtcyAmJiB0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLmNvbG9yICE9PSBcInVuZGVmaW5lZFwiID8gZm9ybWF0dGVyUGFyYW1zLmNvbG9yIDogW1wicmVkXCIsIFwib3JhbmdlXCIsIFwiZ3JlZW5cIl0sXG5cdGNvbG9yID0gXCIjNjY2NjY2XCIsXG5cdHBlcmNlbnQsIHBlcmNlbnRWYWx1ZTtcblxuXHRpZihpc05hTih2YWx1ZSkgfHwgdHlwZW9mIGNlbGwuZ2V0VmFsdWUoKSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci10cmFmZmljLWxpZ2h0XCIpO1xuXG5cdC8vbWFrZSBzdXJlIHZhbHVlIGlzIGluIHJhbmdlXG5cdHBlcmNlbnRWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpIDw9IG1heCA/IHBhcnNlRmxvYXQodmFsdWUpIDogbWF4O1xuXHRwZXJjZW50VmFsdWUgPSBwYXJzZUZsb2F0KHBlcmNlbnRWYWx1ZSkgPj0gbWluID8gcGFyc2VGbG9hdChwZXJjZW50VmFsdWUpIDogbWluO1xuXG5cdC8vd29ya291dCBwZXJjZW50YWdlXG5cdHBlcmNlbnQgPSAobWF4IC0gbWluKSAvIDEwMDtcblx0cGVyY2VudFZhbHVlID0gTWF0aC5yb3VuZCgocGVyY2VudFZhbHVlIC0gbWluKSAvIHBlcmNlbnQpO1xuXG5cdC8vc2V0IGNvbG9yXG5cdHN3aXRjaCh0eXBlb2YgY29sb3JzKXtcblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRjb2xvciA9IGNvbG9ycztcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0Y29sb3IgPSBjb2xvcnModmFsdWUpO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcIm9iamVjdFwiOlxuXHRcdFx0aWYoQXJyYXkuaXNBcnJheShjb2xvcnMpKXtcblx0XHRcdFx0dmFyIHVuaXQgPSAxMDAgLyBjb2xvcnMubGVuZ3RoO1xuXHRcdFx0XHR2YXIgaW5kZXggPSBNYXRoLmZsb29yKHBlcmNlbnRWYWx1ZSAvIHVuaXQpO1xuXG5cdFx0XHRcdGluZGV4ID0gTWF0aC5taW4oaW5kZXgsIGNvbG9ycy5sZW5ndGggLSAxKTtcblx0XHRcdFx0aW5kZXggPSBNYXRoLm1heChpbmRleCwgMCk7XG5cdFx0XHRcdGNvbG9yID0gY29sb3JzW2luZGV4XTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdH1cblxuXHRlbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcblxuXHRyZXR1cm4gZWw7XG59XG5cbmZ1bmN0aW9uIHByb2dyZXNzKGNlbGwsIGZvcm1hdHRlclBhcmFtcyA9IHt9LCBvblJlbmRlcmVkKXsgLy9wcm9ncmVzcyBiYXJcblx0dmFyIHZhbHVlID0gdGhpcy5zYW5pdGl6ZUhUTUwoY2VsbC5nZXRWYWx1ZSgpKSB8fCAwLFxuXHRlbGVtZW50ID0gY2VsbC5nZXRFbGVtZW50KCksXG5cdG1heCA9IGZvcm1hdHRlclBhcmFtcy5tYXggPyBmb3JtYXR0ZXJQYXJhbXMubWF4IDogMTAwLFxuXHRtaW4gPSBmb3JtYXR0ZXJQYXJhbXMubWluID8gZm9ybWF0dGVyUGFyYW1zLm1pbiA6IDAsXG5cdGxlZ2VuZEFsaWduID0gZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZEFsaWduID8gZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZEFsaWduIDogXCJjZW50ZXJcIixcblx0cGVyY2VudCwgcGVyY2VudFZhbHVlLCBjb2xvciwgbGVnZW5kLCBsZWdlbmRDb2xvcjtcblxuXHQvL21ha2Ugc3VyZSB2YWx1ZSBpcyBpbiByYW5nZVxuXHRwZXJjZW50VmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKSA8PSBtYXggPyBwYXJzZUZsb2F0KHZhbHVlKSA6IG1heDtcblx0cGVyY2VudFZhbHVlID0gcGFyc2VGbG9hdChwZXJjZW50VmFsdWUpID49IG1pbiA/IHBhcnNlRmxvYXQocGVyY2VudFZhbHVlKSA6IG1pbjtcblxuXHQvL3dvcmtvdXQgcGVyY2VudGFnZVxuXHRwZXJjZW50ID0gKG1heCAtIG1pbikgLyAxMDA7XG5cdHBlcmNlbnRWYWx1ZSA9IE1hdGgucm91bmQoKHBlcmNlbnRWYWx1ZSAtIG1pbikgLyBwZXJjZW50KTtcblxuXHQvL3NldCBiYXIgY29sb3Jcblx0c3dpdGNoKHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMuY29sb3Ipe1xuXHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdGNvbG9yID0gZm9ybWF0dGVyUGFyYW1zLmNvbG9yO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRjb2xvciA9IGZvcm1hdHRlclBhcmFtcy5jb2xvcih2YWx1ZSk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRpZihBcnJheS5pc0FycmF5KGZvcm1hdHRlclBhcmFtcy5jb2xvcikpe1xuXHRcdFx0XHRsZXQgdW5pdCA9IDEwMCAvIGZvcm1hdHRlclBhcmFtcy5jb2xvci5sZW5ndGg7XG5cdFx0XHRcdGxldCBpbmRleCA9IE1hdGguZmxvb3IocGVyY2VudFZhbHVlIC8gdW5pdCk7XG5cblx0XHRcdFx0aW5kZXggPSBNYXRoLm1pbihpbmRleCwgZm9ybWF0dGVyUGFyYW1zLmNvbG9yLmxlbmd0aCAtIDEpO1xuXHRcdFx0XHRpbmRleCA9IE1hdGgubWF4KGluZGV4LCAwKTtcblx0XHRcdFx0Y29sb3IgPSBmb3JtYXR0ZXJQYXJhbXMuY29sb3JbaW5kZXhdO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRkZWZhdWx0OlxuXHRcdFx0Y29sb3IgPSBcIiMyREMyMTRcIjtcblx0fVxuXG5cdC8vZ2VuZXJhdGUgbGVnZW5kXG5cdHN3aXRjaCh0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZCl7XG5cdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0bGVnZW5kID0gZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZDtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0bGVnZW5kID0gZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZCh2YWx1ZSk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFwiYm9vbGVhblwiOlxuXHRcdFx0bGVnZW5kID0gdmFsdWU7XG5cdFx0XHRicmVhaztcblx0XHRkZWZhdWx0OlxuXHRcdFx0bGVnZW5kID0gZmFsc2U7XG5cdH1cblxuXHQvL3NldCBsZWdlbmQgY29sb3Jcblx0c3dpdGNoKHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMubGVnZW5kQ29sb3Ipe1xuXHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdGxlZ2VuZENvbG9yID0gZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZENvbG9yO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRsZWdlbmRDb2xvciA9IGZvcm1hdHRlclBhcmFtcy5sZWdlbmRDb2xvcih2YWx1ZSk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRpZihBcnJheS5pc0FycmF5KGZvcm1hdHRlclBhcmFtcy5sZWdlbmRDb2xvcikpe1xuXHRcdFx0XHRsZXQgdW5pdCA9IDEwMCAvIGZvcm1hdHRlclBhcmFtcy5sZWdlbmRDb2xvci5sZW5ndGg7XG5cdFx0XHRcdGxldCBpbmRleCA9IE1hdGguZmxvb3IocGVyY2VudFZhbHVlIC8gdW5pdCk7XG5cblx0XHRcdFx0aW5kZXggPSBNYXRoLm1pbihpbmRleCwgZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZENvbG9yLmxlbmd0aCAtIDEpO1xuXHRcdFx0XHRpbmRleCA9IE1hdGgubWF4KGluZGV4LCAwKTtcblx0XHRcdFx0bGVnZW5kQ29sb3IgPSBmb3JtYXR0ZXJQYXJhbXMubGVnZW5kQ29sb3JbaW5kZXhdO1xuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0ZGVmYXVsdDpcblx0XHRcdGxlZ2VuZENvbG9yID0gXCIjMDAwXCI7XG5cdH1cblxuXHRlbGVtZW50LnN0eWxlLm1pbldpZHRoID0gXCIzMHB4XCI7XG5cdGVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSBcInJlbGF0aXZlXCI7XG5cblx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHBlcmNlbnRWYWx1ZSk7XG5cblx0dmFyIGJhckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0YmFyRWwuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWJsb2NrXCI7XG5cdGJhckVsLnN0eWxlLndpZHRoID0gcGVyY2VudFZhbHVlICsgXCIlXCI7XG5cdGJhckVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xuXHRiYXJFbC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblxuXHRiYXJFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtbWF4JywgbWF4KTtcblx0YmFyRWwuc2V0QXR0cmlidXRlKCdkYXRhLW1pbicsIG1pbik7XG5cblx0dmFyIGJhckNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdGJhckNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcblx0YmFyQ29udGFpbmVyLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cdGJhckNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblxuXHRpZihsZWdlbmQpe1xuXHRcdHZhciBsZWdlbmRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0bGVnZW5kRWwuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cdFx0bGVnZW5kRWwuc3R5bGUudG9wID0gMDtcblx0XHRsZWdlbmRFbC5zdHlsZS5sZWZ0ID0gMDtcblx0XHRsZWdlbmRFbC5zdHlsZS50ZXh0QWxpZ24gPSBsZWdlbmRBbGlnbjtcblx0XHRsZWdlbmRFbC5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuXHRcdGxlZ2VuZEVsLnN0eWxlLmNvbG9yID0gbGVnZW5kQ29sb3I7XG5cdFx0bGVnZW5kRWwuaW5uZXJIVE1MID0gbGVnZW5kO1xuXHR9XG5cblx0b25SZW5kZXJlZChmdW5jdGlvbigpe1xuXG5cdFx0Ly9oYW5kbGUgY3VzdG9tIGVsZW1lbnQgbmVlZGVkIGlmIGZvcm1hdHRlciBpcyB0byBiZSBpbmNsdWRlZCBpbiBwcmludGVkL2Rvd25sb2FkZWQgb3V0cHV0XG5cdFx0aWYoIShjZWxsIGluc3RhbmNlb2YgQ2VsbENvbXBvbmVudCkpe1xuXHRcdFx0dmFyIGhvbGRlckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdGhvbGRlckVsLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXHRcdFx0aG9sZGVyRWwuc3R5bGUudG9wID0gXCI0cHhcIjtcblx0XHRcdGhvbGRlckVsLnN0eWxlLmJvdHRvbSA9IFwiNHB4XCI7XG5cdFx0XHRob2xkZXJFbC5zdHlsZS5sZWZ0ID0gXCI0cHhcIjtcblx0XHRcdGhvbGRlckVsLnN0eWxlLnJpZ2h0ID0gXCI0cHhcIjtcblxuXHRcdFx0ZWxlbWVudC5hcHBlbmRDaGlsZChob2xkZXJFbCk7XG5cblx0XHRcdGVsZW1lbnQgPSBob2xkZXJFbDtcblx0XHR9XG5cblx0XHRlbGVtZW50LmFwcGVuZENoaWxkKGJhckNvbnRhaW5lcik7XG5cdFx0YmFyQ29udGFpbmVyLmFwcGVuZENoaWxkKGJhckVsKTtcblxuXHRcdGlmKGxlZ2VuZCl7XG5cdFx0XHRiYXJDb250YWluZXIuYXBwZW5kQ2hpbGQobGVnZW5kRWwpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIFwiXCI7XG59XG5cbmZ1bmN0aW9uIGNvbG9yKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCl7XG5cdGNlbGwuZ2V0RWxlbWVudCgpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuc2FuaXRpemVIVE1MKGNlbGwuZ2V0VmFsdWUoKSk7XG5cdHJldHVybiBcIlwiO1xufVxuXG5mdW5jdGlvbiBidXR0b25UaWNrKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCl7XG5cdHJldHVybiAnPHN2ZyBlbmFibGUtYmFja2dyb3VuZD1cIm5ldyAwIDAgMjQgMjRcIiBoZWlnaHQ9XCIxNFwiIHdpZHRoPVwiMTRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgeG1sOnNwYWNlPVwicHJlc2VydmVcIiA+PHBhdGggZmlsbD1cIiMyREMyMTRcIiBjbGlwLXJ1bGU9XCJldmVub2RkXCIgZD1cIk0yMS42NTIsMy4yMTFjLTAuMjkzLTAuMjk1LTAuNzctMC4yOTUtMS4wNjEsMEw5LjQxLDE0LjM0ICBjLTAuMjkzLDAuMjk3LTAuNzcxLDAuMjk3LTEuMDYyLDBMMy40NDksOS4zNTFDMy4zMDQsOS4yMDMsMy4xMTQsOS4xMywyLjkyMyw5LjEyOUMyLjczLDkuMTI4LDIuNTM0LDkuMjAxLDIuMzg3LDkuMzUxICBsLTIuMTY1LDEuOTQ2QzAuMDc4LDExLjQ0NSwwLDExLjYzLDAsMTEuODIzYzAsMC4xOTQsMC4wNzgsMC4zOTcsMC4yMjMsMC41NDRsNC45NCw1LjE4NGMwLjI5MiwwLjI5NiwwLjc3MSwwLjc3NiwxLjA2MiwxLjA3ICBsMi4xMjQsMi4xNDFjMC4yOTIsMC4yOTMsMC43NjksMC4yOTMsMS4wNjIsMGwxNC4zNjYtMTQuMzRjMC4yOTMtMC4yOTQsMC4yOTMtMC43NzcsMC0xLjA3MUwyMS42NTIsMy4yMTF6XCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiLz48L3N2Zz4nO1xufVxuXG5mdW5jdGlvbiBidXR0b25Dcm9zcyhjZWxsLCBmb3JtYXR0ZXJQYXJhbXMsIG9uUmVuZGVyZWQpe1xuXHRyZXR1cm4gJzxzdmcgZW5hYmxlLWJhY2tncm91bmQ9XCJuZXcgMCAwIDI0IDI0XCIgaGVpZ2h0PVwiMTRcIiB3aWR0aD1cIjE0XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHhtbDpzcGFjZT1cInByZXNlcnZlXCIgPjxwYXRoIGZpbGw9XCIjQ0UxNTE1XCIgZD1cIk0yMi4yNDUsNC4wMTVjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjEzOWwtNi4yNzYsNi4yN2MtMC4zMTMsMC4zMTItMC4zMTMsMC44MjYsMCwxLjE0bDYuMjczLDYuMjcyICBjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjE0bC0yLjI4NSwyLjI3N2MtMC4zMTQsMC4zMTItMC44MjgsMC4zMTItMS4xNDIsMGwtNi4yNzEtNi4yNzFjLTAuMzEzLTAuMzEzLTAuODI4LTAuMzEzLTEuMTQxLDAgIGwtNi4yNzYsNi4yNjdjLTAuMzEzLDAuMzEzLTAuODI4LDAuMzEzLTEuMTQxLDBsLTIuMjgyLTIuMjhjLTAuMzEzLTAuMzEzLTAuMzEzLTAuODI2LDAtMS4xNGw2LjI3OC02LjI2OSAgYzAuMzEzLTAuMzEyLDAuMzEzLTAuODI2LDAtMS4xNEwxLjcwOSw1LjE0N2MtMC4zMTQtMC4zMTMtMC4zMTQtMC44MjcsMC0xLjE0bDIuMjg0LTIuMjc4QzQuMzA4LDEuNDE3LDQuODIxLDEuNDE3LDUuMTM1LDEuNzMgIEwxMS40MDUsOGMwLjMxNCwwLjMxNCwwLjgyOCwwLjMxNCwxLjE0MSwwLjAwMWw2LjI3Ni02LjI2N2MwLjMxMi0wLjMxMiwwLjgyNi0wLjMxMiwxLjE0MSwwTDIyLjI0NSw0LjAxNXpcIi8+PC9zdmc+Jztcbn1cblxuZnVuY3Rpb24gdG9nZ2xlKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCl7XHJcblx0dmFyIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxyXG5cdHNpemUgPSBmb3JtYXR0ZXJQYXJhbXMuc2l6ZSB8fDE1LFxyXG5cdHNpemVQeCA9IHNpemUgKyBcInB4XCIsXHJcblx0Y29udGFpbkVsLCBzd2l0Y2hFbCxcclxuXHRvblZhbHVlID0gZm9ybWF0dGVyUGFyYW1zLmhhc093blByb3BlcnR5KFwib25WYWx1ZVwiKSA/IGZvcm1hdHRlclBhcmFtcy5vblZhbHVlIDogdHJ1ZSxcclxuXHRvZmZWYWx1ZSA9IGZvcm1hdHRlclBhcmFtcy5oYXNPd25Qcm9wZXJ0eShcIm9mZlZhbHVlXCIpID8gZm9ybWF0dGVyUGFyYW1zLm9mZlZhbHVlIDogZmFsc2UsXHJcblxyXG5cclxuXHRzdGF0ZSA9IGZvcm1hdHRlclBhcmFtcy5vblRydXRoeSA/IHZhbHVlIDogdmFsdWUgPT09IG9uVmFsdWU7XHJcblxyXG5cdFxyXG5cdGNvbnRhaW5FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcblx0Y29udGFpbkVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItdG9nZ2xlXCIpO1xyXG5cclxuXHRpZihzdGF0ZSl7XHJcblx0XHRjb250YWluRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci10b2dnbGUtb25cIik7XHJcblx0XHRjb250YWluRWwuc3R5bGUuZmxleERpcmVjdGlvbiA9IFwicm93LXJldmVyc2VcIjtcclxuXHJcblx0XHRpZihmb3JtYXR0ZXJQYXJhbXMub25Db2xvcil7XHJcblx0XHRcdGNvbnRhaW5FbC5zdHlsZS5iYWNrZ3JvdW5kID0gZm9ybWF0dGVyUGFyYW1zLm9uQ29sb3I7XHJcblx0XHR9XHJcblx0fWVsc2Uge1xyXG5cdFx0aWYoZm9ybWF0dGVyUGFyYW1zLm9mZkNvbG9yKXtcclxuXHRcdFx0Y29udGFpbkVsLnN0eWxlLmJhY2tncm91bmQgPSBmb3JtYXR0ZXJQYXJhbXMub2ZmQ29sb3I7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRjb250YWluRWwuc3R5bGUud2lkdGggPSAoMi41ICogc2l6ZSkgKyBcInB4XCI7XHJcblx0Y29udGFpbkVsLnN0eWxlLmJvcmRlclJhZGl1cyA9IHNpemVQeDtcclxuXHJcblx0aWYoZm9ybWF0dGVyUGFyYW1zLmNsaWNrYWJsZSl7XHJcblx0XHRjb250YWluRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRcdGNlbGwuc2V0VmFsdWUoc3RhdGUgPyBvZmZWYWx1ZSA6IG9uVmFsdWUpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRzd2l0Y2hFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcblx0c3dpdGNoRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci10b2dnbGUtc3dpdGNoXCIpO1xyXG5cclxuXHRzd2l0Y2hFbC5zdHlsZS5oZWlnaHQgPSBzaXplUHg7XHJcblx0c3dpdGNoRWwuc3R5bGUud2lkdGggPSBzaXplUHg7XHJcblx0c3dpdGNoRWwuc3R5bGUuYm9yZGVyUmFkaXVzID0gc2l6ZVB4O1xyXG5cdFxyXG5cdGNvbnRhaW5FbC5hcHBlbmRDaGlsZChzd2l0Y2hFbCk7XHJcblx0XHJcblx0cmV0dXJuIGNvbnRhaW5FbDtcclxufVxuXG5mdW5jdGlvbiByb3dudW0oY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0dmFyIGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0dmFyIHJvdyA9IGNlbGwuZ2V0Um93KCk7XG5cdHZhciB0YWJsZSA9IGNlbGwuZ2V0VGFibGUoKTtcblxuXHRyb3cud2F0Y2hQb3NpdGlvbigocG9zaXRpb24pID0+IHtcblx0XHRpZiAoZm9ybWF0dGVyUGFyYW1zLnJlbGF0aXZlVG9QYWdlKSB7XG5cdFx0XHRwb3NpdGlvbiArPSB0YWJsZS5tb2R1bGVzLnBhZ2UuZ2V0UGFnZVNpemUoKSAqICh0YWJsZS5tb2R1bGVzLnBhZ2UuZ2V0UGFnZSgpIC0gMSk7XG5cdFx0fVxuXHRcdGNvbnRlbnQuaW5uZXJUZXh0ID0gcG9zaXRpb247XG5cdH0pO1xuXHRcblx0cmV0dXJuIGNvbnRlbnQ7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZShjZWxsLCBmb3JtYXR0ZXJQYXJhbXMsIG9uUmVuZGVyZWQpe1xuXHRjZWxsLmdldEVsZW1lbnQoKS5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1oYW5kbGVcIik7XG5cdHJldHVybiBcIjxkaXYgY2xhc3M9J3RhYnVsYXRvci1yb3ctaGFuZGxlLWJveCc+PGRpdiBjbGFzcz0ndGFidWxhdG9yLXJvdy1oYW5kbGUtYmFyJz48L2Rpdj48ZGl2IGNsYXNzPSd0YWJ1bGF0b3Itcm93LWhhbmRsZS1iYXInPjwvZGl2PjxkaXYgY2xhc3M9J3RhYnVsYXRvci1yb3ctaGFuZGxlLWJhcic+PC9kaXY+PC9kaXY+XCI7XG59XG5cbmZ1bmN0aW9uIGFkYXB0YWJsZShjZWxsLCBwYXJhbXMsIG9uUmVuZGVyZWQpe1xyXG5cdHZhciBsb29rdXAsIGZvcm1hdHRlckZ1bmMsIGZvcm1hdHRlclBhcmFtcztcclxuICAgIFxyXG5cdGZ1bmN0aW9uIGRlZmF1bHRMb29rdXAoY2VsbCl7XHJcblx0XHR2YXIgdmFsdWUgPSBjZWxsLmdldFZhbHVlKCksXHJcblx0XHRmb3JtYXR0ZXIgPSBcInBsYWludGV4dFwiO1xyXG4gICAgICAgIFxyXG5cdFx0c3dpdGNoKHR5cGVvZiB2YWx1ZSl7ICAgICAgICAgICBcclxuXHRcdFx0Y2FzZSBcImJvb2xlYW5cIjpcclxuXHRcdFx0XHRmb3JtYXR0ZXIgPSBcInRpY2tDcm9zc1wiO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG4gICAgICAgICAgICBcclxuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxyXG5cdFx0XHRcdGlmKHZhbHVlLmluY2x1ZGVzKFwiXFxuXCIpKXtcclxuXHRcdFx0XHRcdGZvcm1hdHRlciA9IFwidGV4dGFyZWFcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcbiAgICAgICAgXHJcblx0XHRyZXR1cm4gZm9ybWF0dGVyO1xyXG5cdH1cclxuICAgIFxyXG5cdGxvb2t1cCA9IHBhcmFtcy5mb3JtYXR0ZXJMb29rdXAgPyBwYXJhbXMuZm9ybWF0dGVyTG9va3VwKGNlbGwpIDogZGVmYXVsdExvb2t1cChjZWxsKTtcclxuXHJcblx0aWYocGFyYW1zLnBhcmFtc0xvb2t1cCl7XHJcblx0XHRmb3JtYXR0ZXJQYXJhbXMgPSB0eXBlb2YgcGFyYW1zLnBhcmFtc0xvb2t1cCA9PT0gXCJmdW5jdGlvblwiID8gcGFyYW1zLnBhcmFtc0xvb2t1cChsb29rdXAsIGNlbGwpIDogcGFyYW1zLnBhcmFtc0xvb2t1cFtsb29rdXBdO1xyXG5cdH1cclxuXHJcblx0Zm9ybWF0dGVyRnVuYyA9IHRoaXMudGFibGUubW9kdWxlcy5mb3JtYXQubG9va3VwRm9ybWF0dGVyKGxvb2t1cCk7XHJcbiAgICBcclxuXHRyZXR1cm4gIGZvcm1hdHRlckZ1bmMuY2FsbCh0aGlzLCBjZWxsLCBmb3JtYXR0ZXJQYXJhbXMgfHwge30sIG9uUmVuZGVyZWQpO1xyXG59XG5cbmZ1bmN0aW9uIGFycmF5JDIoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0dmFyIGRlbGltaXRlciA9IGZvcm1hdHRlclBhcmFtcy5kZWxpbWl0ZXIgfHwgXCIsXCIsXG5cdHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHR0YWJsZSA9IHRoaXMudGFibGUsXG5cdHZhbHVlTWFwO1xuXHRcblx0aWYoZm9ybWF0dGVyUGFyYW1zLnZhbHVlTWFwKXtcblx0XHRpZih0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLnZhbHVlTWFwID09PSBcInN0cmluZ1wiKXtcblx0XHRcdHZhbHVlTWFwID0gZnVuY3Rpb24odmFsdWUpe1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUubWFwKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0cmV0dXJuIEhlbHBlcnMucmV0cmlldmVOZXN0ZWREYXRhKHRhYmxlLm9wdGlvbnMubmVzdGVkRmllbGRTZXBhcmF0b3IsIGZvcm1hdHRlclBhcmFtcy52YWx1ZU1hcCwgaXRlbSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR2YWx1ZU1hcCA9IGZvcm1hdHRlclBhcmFtcy52YWx1ZU1hcDtcblx0XHR9XG5cdH1cblxuXHRpZihBcnJheS5pc0FycmF5KHZhbHVlKSl7XG5cdFx0aWYodmFsdWVNYXApe1xuXHRcdFx0dmFsdWUgPSB2YWx1ZU1hcCh2YWx1ZSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHZhbHVlLmpvaW4oZGVsaW1pdGVyKTtcblx0fWVsc2Uge1xuXHRcdHJldHVybiB2YWx1ZTtcblx0fVxufVxuXG5mdW5jdGlvbiBqc29uJDEoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0dmFyIGluZGVudCA9IGZvcm1hdHRlclBhcmFtcy5pbmRlbnQgfHwgXCJcXHRcIixcblx0bXVsdGlsaW5lID0gdHlwZW9mIGZvcm1hdHRlclBhcmFtcy5tdWx0aWxpbmUgPT09IFwidW5kZWZpbmVkXCIgPyB0cnVlIDogZm9ybWF0dGVyUGFyYW1zLm11bHRpbGluZSxcblx0cmVwbGFjZXIgPSBmb3JtYXR0ZXJQYXJhbXMucmVwbGFjZXIgfHwgbnVsbCxcblx0dmFsdWUgPSBjZWxsLmdldFZhbHVlKCk7XG5cdFxuXHRpZihtdWx0aWxpbmUpe1xuXHRcdGNlbGwuZ2V0RWxlbWVudCgpLnN0eWxlLndoaXRlU3BhY2UgPSBcInByZS13cmFwXCI7XG5cdH1cblxuXHRyZXR1cm4gSlNPTi5zdHJpbmdpZnkodmFsdWUsIHJlcGxhY2VyLCBpbmRlbnQpO1xufVxuXG52YXIgZGVmYXVsdEZvcm1hdHRlcnMgPSB7XG5cdHBsYWludGV4dDpwbGFpbnRleHQsXG5cdGh0bWw6aHRtbCxcblx0dGV4dGFyZWE6dGV4dGFyZWEsXG5cdG1vbmV5Om1vbmV5LFxuXHRsaW5rOmxpbmssXG5cdGltYWdlOmltYWdlLFxuXHR0aWNrQ3Jvc3M6dGlja0Nyb3NzLFxuXHRkYXRldGltZTpkYXRldGltZSQxLFxuXHRkYXRldGltZWRpZmY6ZGF0ZXRpbWVkaWZmLFxuXHRsb29rdXA6bG9va3VwLFxuXHRzdGFyOnN0YXIsXG5cdHRyYWZmaWM6dHJhZmZpYyxcblx0cHJvZ3Jlc3M6cHJvZ3Jlc3MsXG5cdGNvbG9yOmNvbG9yLFxuXHRidXR0b25UaWNrOmJ1dHRvblRpY2ssXG5cdGJ1dHRvbkNyb3NzOmJ1dHRvbkNyb3NzLFxuXHR0b2dnbGU6dG9nZ2xlLFxuXHRyb3dudW06cm93bnVtLFxuXHRoYW5kbGU6aGFuZGxlLFxuXHRhZGFwdGFibGU6YWRhcHRhYmxlLFxuXHRhcnJheTphcnJheSQyLFxuXHRqc29uOmpzb24kMSxcbn07XG5cbmNsYXNzIEZvcm1hdCBleHRlbmRzIE1vZHVsZXtcblx0XG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJmb3JtYXRcIjtcblx0XG5cdC8vbG9hZCBkZWZhdWx0c1xuXHRzdGF0aWMgZm9ybWF0dGVycyA9IGRlZmF1bHRGb3JtYXR0ZXJzO1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiZm9ybWF0dGVyXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJmb3JtYXR0ZXJQYXJhbXNcIik7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImZvcm1hdHRlclByaW50XCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJmb3JtYXR0ZXJQcmludFBhcmFtc1wiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiZm9ybWF0dGVyQ2xpcGJvYXJkXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJmb3JtYXR0ZXJDbGlwYm9hcmRQYXJhbXNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImZvcm1hdHRlckh0bWxPdXRwdXRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImZvcm1hdHRlckh0bWxPdXRwdXRQYXJhbXNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInRpdGxlRm9ybWF0dGVyXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJ0aXRsZUZvcm1hdHRlclBhcmFtc1wiKTtcblx0fVxuXHRcblx0aW5pdGlhbGl6ZSgpe1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC1mb3JtYXRcIiwgdGhpcy5mb3JtYXRWYWx1ZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtcmVuZGVyZWRcIiwgdGhpcy5jZWxsUmVuZGVyZWQuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tbGF5b3V0XCIsIHRoaXMuaW5pdGlhbGl6ZUNvbHVtbi5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1mb3JtYXRcIiwgdGhpcy5mb3JtYXRIZWFkZXIuYmluZCh0aGlzKSk7XG5cdH1cblx0XG5cdC8vaW5pdGlhbGl6ZSBjb2x1bW4gZm9ybWF0dGVyXG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHRjb2x1bW4ubW9kdWxlcy5mb3JtYXQgPSB0aGlzLmxvb2t1cFR5cGVGb3JtYXR0ZXIoY29sdW1uLCBcIlwiKTtcblx0XHRcblx0XHRpZih0eXBlb2YgY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyUHJpbnQgIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0Y29sdW1uLm1vZHVsZXMuZm9ybWF0LnByaW50ID0gdGhpcy5sb29rdXBUeXBlRm9ybWF0dGVyKGNvbHVtbiwgXCJQcmludFwiKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodHlwZW9mIGNvbHVtbi5kZWZpbml0aW9uLmZvcm1hdHRlckNsaXBib2FyZCAhPT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRjb2x1bW4ubW9kdWxlcy5mb3JtYXQuY2xpcGJvYXJkID0gdGhpcy5sb29rdXBUeXBlRm9ybWF0dGVyKGNvbHVtbiwgXCJDbGlwYm9hcmRcIik7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHR5cGVvZiBjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXJIdG1sT3V0cHV0ICE9PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZvcm1hdC5odG1sT3V0cHV0ID0gdGhpcy5sb29rdXBUeXBlRm9ybWF0dGVyKGNvbHVtbiwgXCJIdG1sT3V0cHV0XCIpO1xuXHRcdH1cblx0fVxuXHRcblx0bG9va3VwVHlwZUZvcm1hdHRlcihjb2x1bW4sIHR5cGUpe1xuXHRcdHZhciBjb25maWcgPSB7cGFyYW1zOmNvbHVtbi5kZWZpbml0aW9uW1wiZm9ybWF0dGVyXCIgKyB0eXBlICsgXCJQYXJhbXNcIl0gfHwge319LFxuXHRcdGZvcm1hdHRlciA9IGNvbHVtbi5kZWZpbml0aW9uW1wiZm9ybWF0dGVyXCIgKyB0eXBlXTtcblx0XHRcblx0XHRjb25maWcuZm9ybWF0dGVyID0gdGhpcy5sb29rdXBGb3JtYXR0ZXIoZm9ybWF0dGVyKTtcblx0XHRcblx0XHRyZXR1cm4gY29uZmlnO1xuXHR9XG5cdFxuXHRcblx0bG9va3VwRm9ybWF0dGVyKGZvcm1hdHRlcil7XG5cdFx0dmFyIGZvcm1hdHRlckZ1bmM7XG5cblx0XHQvL3NldCBjb2x1bW4gZm9ybWF0dGVyXG5cdFx0c3dpdGNoKHR5cGVvZiBmb3JtYXR0ZXIpe1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRpZihGb3JtYXQuZm9ybWF0dGVyc1tmb3JtYXR0ZXJdKXtcblx0XHRcdFx0XHRmb3JtYXR0ZXJGdW5jID0gRm9ybWF0LmZvcm1hdHRlcnNbZm9ybWF0dGVyXTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkZvcm1hdHRlciBFcnJvciAtIE5vIHN1Y2ggZm9ybWF0dGVyIGZvdW5kOiBcIiwgZm9ybWF0dGVyKTtcblx0XHRcdFx0XHRmb3JtYXR0ZXJGdW5jID0gRm9ybWF0LmZvcm1hdHRlcnMucGxhaW50ZXh0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0Zm9ybWF0dGVyRnVuYyA9IGZvcm1hdHRlcjtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdGZvcm1hdHRlckZ1bmMgPSBGb3JtYXQuZm9ybWF0dGVycy5wbGFpbnRleHQ7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gZm9ybWF0dGVyRnVuYztcblx0fVxuXHRcblx0Y2VsbFJlbmRlcmVkKGNlbGwpe1xuXHRcdGlmKGNlbGwubW9kdWxlcy5mb3JtYXQgJiYgY2VsbC5tb2R1bGVzLmZvcm1hdC5yZW5kZXJlZENhbGxiYWNrICYmICFjZWxsLm1vZHVsZXMuZm9ybWF0LnJlbmRlcmVkKXtcblx0XHRcdGNlbGwubW9kdWxlcy5mb3JtYXQucmVuZGVyZWRDYWxsYmFjaygpO1xuXHRcdFx0Y2VsbC5tb2R1bGVzLmZvcm1hdC5yZW5kZXJlZCA9IHRydWU7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3JldHVybiBhIGZvcm1hdHRlZCB2YWx1ZSBmb3IgYSBjb2x1bW4gaGVhZGVyXG5cdGZvcm1hdEhlYWRlcihjb2x1bW4sIHRpdGxlLCBlbCl7XG5cdFx0dmFyIGZvcm1hdHRlciwgcGFyYW1zLCBvblJlbmRlcmVkLCBtb2NrQ2VsbDtcblx0XHRcblx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi50aXRsZUZvcm1hdHRlcil7XG5cdFx0XHRmb3JtYXR0ZXIgPSB0aGlzLmxvb2t1cEZvcm1hdHRlcihjb2x1bW4uZGVmaW5pdGlvbi50aXRsZUZvcm1hdHRlcik7XG5cdFx0XHRcblx0XHRcdG9uUmVuZGVyZWQgPSAoY2FsbGJhY2spID0+IHtcblx0XHRcdFx0Y29sdW1uLnRpdGxlRm9ybWF0dGVyUmVuZGVyZWQgPSBjYWxsYmFjaztcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdG1vY2tDZWxsID0ge1xuXHRcdFx0XHRnZXRWYWx1ZTpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdHJldHVybiB0aXRsZTtcblx0XHRcdFx0fSxcblx0XHRcdFx0Z2V0RWxlbWVudDpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdHJldHVybiBlbDtcblx0XHRcdFx0fSxcblx0XHRcdFx0Z2V0VHlwZTpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdHJldHVybiBcImhlYWRlclwiO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRnZXRDb2x1bW46ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRyZXR1cm4gY29sdW1uLmdldENvbXBvbmVudCgpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRnZXRUYWJsZTooKSA9PiB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMudGFibGU7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdHBhcmFtcyA9IGNvbHVtbi5kZWZpbml0aW9uLnRpdGxlRm9ybWF0dGVyUGFyYW1zIHx8IHt9O1xuXHRcdFx0XG5cdFx0XHRwYXJhbXMgPSB0eXBlb2YgcGFyYW1zID09PSBcImZ1bmN0aW9uXCIgPyBwYXJhbXMoKSA6IHBhcmFtcztcblx0XHRcdFxuXHRcdFx0cmV0dXJuIGZvcm1hdHRlci5jYWxsKHRoaXMsIG1vY2tDZWxsLCBwYXJhbXMsIG9uUmVuZGVyZWQpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJldHVybiB0aXRsZTtcblx0XHR9XG5cdH1cblx0XG5cdFxuXHQvL3JldHVybiBhIGZvcm1hdHRlZCB2YWx1ZSBmb3IgYSBjZWxsXG5cdGZvcm1hdFZhbHVlKGNlbGwpe1xuXHRcdHZhciBjb21wb25lbnQgPSBjZWxsLmdldENvbXBvbmVudCgpLFxuXHRcdHBhcmFtcyA9IHR5cGVvZiBjZWxsLmNvbHVtbi5tb2R1bGVzLmZvcm1hdC5wYXJhbXMgPT09IFwiZnVuY3Rpb25cIiA/IGNlbGwuY29sdW1uLm1vZHVsZXMuZm9ybWF0LnBhcmFtcyhjb21wb25lbnQpIDogY2VsbC5jb2x1bW4ubW9kdWxlcy5mb3JtYXQucGFyYW1zO1xuXHRcdFxuXHRcdGZ1bmN0aW9uIG9uUmVuZGVyZWQoY2FsbGJhY2spe1xuXHRcdFx0aWYoIWNlbGwubW9kdWxlcy5mb3JtYXQpe1xuXHRcdFx0XHRjZWxsLm1vZHVsZXMuZm9ybWF0ID0ge307XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGNlbGwubW9kdWxlcy5mb3JtYXQucmVuZGVyZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdFx0Y2VsbC5tb2R1bGVzLmZvcm1hdC5yZW5kZXJlZCA9IGZhbHNlO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gY2VsbC5jb2x1bW4ubW9kdWxlcy5mb3JtYXQuZm9ybWF0dGVyLmNhbGwodGhpcywgY29tcG9uZW50LCBwYXJhbXMsIG9uUmVuZGVyZWQpO1xuXHR9XG5cdFxuXHRmb3JtYXRFeHBvcnRWYWx1ZShjZWxsLCB0eXBlKXtcblx0XHR2YXIgZm9ybWF0dGVyID0gY2VsbC5jb2x1bW4ubW9kdWxlcy5mb3JtYXRbdHlwZV0sXG5cdFx0cGFyYW1zO1xuXHRcdFxuXHRcdGlmKGZvcm1hdHRlcil7XG5cdFx0XHRwYXJhbXMgPSB0eXBlb2YgZm9ybWF0dGVyLnBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gZm9ybWF0dGVyLnBhcmFtcyhjZWxsLmdldENvbXBvbmVudCgpKSA6IGZvcm1hdHRlci5wYXJhbXM7XG5cdFx0XHRcblx0XHRcdGZ1bmN0aW9uIG9uUmVuZGVyZWQoY2FsbGJhY2spe1xuXHRcdFx0XHRpZighY2VsbC5tb2R1bGVzLmZvcm1hdCl7XG5cdFx0XHRcdFx0Y2VsbC5tb2R1bGVzLmZvcm1hdCA9IHt9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRjZWxsLm1vZHVsZXMuZm9ybWF0LnJlbmRlcmVkQ2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHRcdFx0Y2VsbC5tb2R1bGVzLmZvcm1hdC5yZW5kZXJlZCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRyZXR1cm4gZm9ybWF0dGVyLmZvcm1hdHRlci5jYWxsKHRoaXMsIGNlbGwuZ2V0Q29tcG9uZW50KCksIHBhcmFtcywgb25SZW5kZXJlZCk7XG5cdFx0XHRcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5mb3JtYXRWYWx1ZShjZWxsKTtcblx0XHR9XG5cdH1cblx0XG5cdHNhbml0aXplSFRNTCh2YWx1ZSl7XG5cdFx0aWYodmFsdWUpe1xuXHRcdFx0dmFyIGVudGl0eU1hcCA9IHtcblx0XHRcdFx0JyYnOiAnJmFtcDsnLFxuXHRcdFx0XHQnPCc6ICcmbHQ7Jyxcblx0XHRcdFx0Jz4nOiAnJmd0OycsXG5cdFx0XHRcdCdcIic6ICcmcXVvdDsnLFxuXHRcdFx0XHRcIidcIjogJyYjMzk7Jyxcblx0XHRcdFx0Jy8nOiAnJiN4MkY7Jyxcblx0XHRcdFx0J2AnOiAnJiN4NjA7Jyxcblx0XHRcdFx0Jz0nOiAnJiN4M0Q7J1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIFN0cmluZyh2YWx1ZSkucmVwbGFjZSgvWyY8PlwiJ2A9L10vZywgZnVuY3Rpb24gKHMpIHtcblx0XHRcdFx0cmV0dXJuIGVudGl0eU1hcFtzXTtcblx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHR9XG5cdH1cblx0XG5cdGVtcHR5VG9TcGFjZSh2YWx1ZSl7XG5cdFx0cmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIiB8fCB2YWx1ZSA9PT0gXCJcIiA/IFwiJm5ic3A7XCIgOiB2YWx1ZTtcblx0fVxuXHRcbn1cblxuY2xhc3MgRnJvemVuQ29sdW1ucyBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwiZnJvemVuQ29sdW1uc1wiO1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLmxlZnRDb2x1bW5zID0gW107XG5cdFx0dGhpcy5yaWdodENvbHVtbnMgPSBbXTtcblx0XHR0aGlzLmluaXRpYWxpemF0aW9uTW9kZSA9IFwibGVmdFwiO1xuXHRcdHRoaXMuYWN0aXZlID0gZmFsc2U7XG5cdFx0dGhpcy5ibG9ja2VkID0gdHJ1ZTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiZnJvemVuXCIpO1xuXHR9XG5cdFxuXHQvL3Jlc2V0IGluaXRpYWwgc3RhdGVcblx0cmVzZXQoKXtcblx0XHR0aGlzLmluaXRpYWxpemF0aW9uTW9kZSA9IFwibGVmdFwiO1xuXHRcdHRoaXMubGVmdENvbHVtbnMgPSBbXTtcblx0XHR0aGlzLnJpZ2h0Q29sdW1ucyA9IFtdO1xuXHRcdHRoaXMuYWN0aXZlID0gZmFsc2U7XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtbGF5b3V0XCIsIHRoaXMubGF5b3V0Q2VsbC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1pbml0XCIsIHRoaXMuaW5pdGlhbGl6ZUNvbHVtbi5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi13aWR0aFwiLCB0aGlzLmxheW91dC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1sYXlvdXQtYWZ0ZXJcIiwgdGhpcy5sYXlvdXRSb3cuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1sYXlvdXRcIiwgdGhpcy5sYXlvdXQuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW5zLWxvYWRpbmdcIiwgdGhpcy5yZXNldC5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1hZGRcIiwgdGhpcy5yZWluaXRpYWxpemVDb2x1bW5zLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWRlbGV0ZWRcIiwgdGhpcy5yZWluaXRpYWxpemVDb2x1bW5zLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWhpZGVcIiwgdGhpcy5yZWluaXRpYWxpemVDb2x1bW5zLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLXNob3dcIiwgdGhpcy5yZWluaXRpYWxpemVDb2x1bW5zLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1ucy1sb2FkZWRcIiwgdGhpcy5yZWluaXRpYWxpemVDb2x1bW5zLmJpbmQodGhpcykpO1xuXHRcdFxuXHRcdHRoaXMuc3Vic2NyaWJlKFwidGFibGUtcmVkcmF3XCIsIHRoaXMubGF5b3V0LmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwibGF5b3V0LXJlZnJlc2hpbmdcIiwgdGhpcy5ibG9ja0xheW91dC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImxheW91dC1yZWZyZXNoZWRcIiwgdGhpcy51bmJsb2NrTGF5b3V0LmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwic2Nyb2xsYmFyLXZlcnRpY2FsXCIsIHRoaXMuYWRqdXN0Rm9yU2Nyb2xsYmFyLmJpbmQodGhpcykpO1xuXHR9XG5cdFxuXHRibG9ja0xheW91dCgpe1xuXHRcdHRoaXMuYmxvY2tlZCA9IHRydWU7XG5cdH1cblx0XG5cdHVuYmxvY2tMYXlvdXQoKXtcblx0XHR0aGlzLmJsb2NrZWQgPSBmYWxzZTtcblx0fVxuXHRcblx0bGF5b3V0Q2VsbChjZWxsKXtcblx0XHR0aGlzLmxheW91dEVsZW1lbnQoY2VsbC5lbGVtZW50LCBjZWxsLmNvbHVtbik7XG5cdH1cblx0XG5cdHJlaW5pdGlhbGl6ZUNvbHVtbnMoKXtcblx0XHR0aGlzLnJlc2V0KCk7XG5cdFx0XG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZvckVhY2goKGNvbHVtbikgPT4ge1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQ29sdW1uKGNvbHVtbik7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmxheW91dCgpO1xuXHR9XG5cdFxuXHQvL2luaXRpYWxpemUgc3BlY2lmaWMgY29sdW1uXG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHR2YXIgY29uZmlnID0ge21hcmdpbjowLCBlZGdlOmZhbHNlfTtcblx0XHRcblx0XHRpZighY29sdW1uLmlzR3JvdXApe1x0XHRcdFxuXHRcdFx0aWYodGhpcy5mcm96ZW5DaGVjayhjb2x1bW4pKXtcblx0XHRcdFx0Y29uZmlnLnBvc2l0aW9uID0gdGhpcy5pbml0aWFsaXphdGlvbk1vZGU7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLmluaXRpYWxpemF0aW9uTW9kZSA9PSBcImxlZnRcIil7XG5cdFx0XHRcdFx0dGhpcy5sZWZ0Q29sdW1ucy5wdXNoKGNvbHVtbik7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHR0aGlzLnJpZ2h0Q29sdW1ucy51bnNoaWZ0KGNvbHVtbik7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuYWN0aXZlID0gdHJ1ZTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbHVtbi5tb2R1bGVzLmZyb3plbiA9IGNvbmZpZztcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5pbml0aWFsaXphdGlvbk1vZGUgPSBcInJpZ2h0XCI7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRmcm96ZW5DaGVjayhjb2x1bW4pe1xuXHRcdGlmKGNvbHVtbi5wYXJlbnQuaXNHcm91cCAmJiBjb2x1bW4uZGVmaW5pdGlvbi5mcm96ZW4pe1xuXHRcdFx0Y29uc29sZS53YXJuKFwiRnJvemVuIENvbHVtbiBFcnJvciAtIFBhcmVudCBjb2x1bW4gZ3JvdXAgbXVzdCBiZSBmcm96ZW4sIG5vdCBpbmRpdmlkdWFsIGNvbHVtbnMgb3Igc3ViIGNvbHVtbiBncm91cHNcIik7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGNvbHVtbi5wYXJlbnQuaXNHcm91cCl7XG5cdFx0XHRyZXR1cm4gdGhpcy5mcm96ZW5DaGVjayhjb2x1bW4ucGFyZW50KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gY29sdW1uLmRlZmluaXRpb24uZnJvemVuO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9sYXlvdXQgY2FsY3VsYXRpb24gcm93c1xuXHRsYXlvdXRDYWxjUm93cygpe1xuXHRcdGlmKHRoaXMudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpe1xuXHRcdFx0aWYodGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnRvcEluaXRpYWxpemVkICYmIHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy50b3BSb3cpe1xuXHRcdFx0XHR0aGlzLmxheW91dFJvdyh0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MudG9wUm93KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYodGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLmJvdEluaXRpYWxpemVkICYmIHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5ib3RSb3cpe1xuXHRcdFx0XHR0aGlzLmxheW91dFJvdyh0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MuYm90Um93KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJncm91cFJvd3NcIikpe1xuXHRcdFx0XHR0aGlzLmxheW91dEdyb3VwQ2FsY3ModGhpcy50YWJsZS5tb2R1bGVzLmdyb3VwUm93cy5nZXRHcm91cHMoKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRsYXlvdXRHcm91cENhbGNzKGdyb3Vwcyl7XG5cdFx0Z3JvdXBzLmZvckVhY2goKGdyb3VwKSA9PiB7XG5cdFx0XHRpZihncm91cC5jYWxjcy50b3Ape1xuXHRcdFx0XHR0aGlzLmxheW91dFJvdyhncm91cC5jYWxjcy50b3ApO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihncm91cC5jYWxjcy5ib3R0b20pe1xuXHRcdFx0XHR0aGlzLmxheW91dFJvdyhncm91cC5jYWxjcy5ib3R0b20pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihncm91cC5ncm91cExpc3QgJiYgZ3JvdXAuZ3JvdXBMaXN0Lmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMubGF5b3V0R3JvdXBDYWxjcyhncm91cC5ncm91cExpc3QpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdFxuXHQvL2NhbGN1bGF0ZSBjb2x1bW4gcG9zaXRpb25zIGFuZCBsYXlvdXQgaGVhZGVyc1xuXHRsYXlvdXRDb2x1bW5Qb3NpdGlvbihhbGxDZWxscyl7XG5cdFx0dmFyIGxlZnRQYXJlbnRzID0gW107XG5cdFx0XG5cdFx0dmFyIGxlZnRNYXJnaW4gPSAwO1xuXHRcdHZhciByaWdodE1hcmdpbiA9IDA7XG5cdFx0XG5cdFx0dGhpcy5sZWZ0Q29sdW1ucy5mb3JFYWNoKChjb2x1bW4sIGkpID0+IHtcdFxuXHRcdFx0Y29sdW1uLm1vZHVsZXMuZnJvemVuLm1hcmdpblZhbHVlID0gbGVmdE1hcmdpbjtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZyb3plbi5tYXJnaW4gPSBjb2x1bW4ubW9kdWxlcy5mcm96ZW4ubWFyZ2luVmFsdWUgKyBcInB4XCI7XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbi52aXNpYmxlKXtcblx0XHRcdFx0bGVmdE1hcmdpbiArPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoaSA9PSB0aGlzLmxlZnRDb2x1bW5zLmxlbmd0aCAtIDEpe1xuXHRcdFx0XHRjb2x1bW4ubW9kdWxlcy5mcm96ZW4uZWRnZSA9IHRydWU7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGNvbHVtbi5tb2R1bGVzLmZyb3plbi5lZGdlID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbi5wYXJlbnQuaXNHcm91cCl7XG5cdFx0XHRcdHZhciBwYXJlbnRFbCA9IHRoaXMuZ2V0Q29sR3JvdXBQYXJlbnRFbGVtZW50KGNvbHVtbik7XG5cdFx0XHRcdGlmKCFsZWZ0UGFyZW50cy5pbmNsdWRlcyhwYXJlbnRFbCkpe1xuXHRcdFx0XHRcdHRoaXMubGF5b3V0RWxlbWVudChwYXJlbnRFbCwgY29sdW1uKTtcblx0XHRcdFx0XHRsZWZ0UGFyZW50cy5wdXNoKHBhcmVudEVsKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0cGFyZW50RWwuY2xhc3NMaXN0LnRvZ2dsZShcInRhYnVsYXRvci1mcm96ZW4tbGVmdFwiLCAgY29sdW1uLm1vZHVsZXMuZnJvemVuLmVkZ2UgJiYgY29sdW1uLm1vZHVsZXMuZnJvemVuLnBvc2l0aW9uID09PSBcImxlZnRcIik7XG5cdFx0XHRcdHBhcmVudEVsLmNsYXNzTGlzdC50b2dnbGUoXCJ0YWJ1bGF0b3ItZnJvemVuLXJpZ2h0XCIsIGNvbHVtbi5tb2R1bGVzLmZyb3plbi5lZGdlICYmIGNvbHVtbi5tb2R1bGVzLmZyb3plbi5wb3NpdGlvbiA9PT0gXCJyaWdodFwiKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5sYXlvdXRFbGVtZW50KGNvbHVtbi5nZXRFbGVtZW50KCksIGNvbHVtbik7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKGFsbENlbGxzKXtcblx0XHRcdFx0Y29sdW1uLmNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcblx0XHRcdFx0XHR0aGlzLmxheW91dEVsZW1lbnQoY2VsbC5nZXRFbGVtZW50KHRydWUpLCBjb2x1bW4pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHR0aGlzLnJpZ2h0Q29sdW1ucy5mb3JFYWNoKChjb2x1bW4sIGkpID0+IHtcblx0XHRcdFxuXHRcdFx0Y29sdW1uLm1vZHVsZXMuZnJvemVuLm1hcmdpblZhbHVlID0gcmlnaHRNYXJnaW47XG5cdFx0XHRjb2x1bW4ubW9kdWxlcy5mcm96ZW4ubWFyZ2luID0gY29sdW1uLm1vZHVsZXMuZnJvemVuLm1hcmdpblZhbHVlICsgXCJweFwiO1xuXHRcdFx0XG5cdFx0XHRpZihjb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRcdHJpZ2h0TWFyZ2luICs9IGNvbHVtbi5nZXRXaWR0aCgpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihpID09IHRoaXMucmlnaHRDb2x1bW5zLmxlbmd0aCAtIDEpe1xuXHRcdFx0XHRjb2x1bW4ubW9kdWxlcy5mcm96ZW4uZWRnZSA9IHRydWU7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGNvbHVtbi5tb2R1bGVzLmZyb3plbi5lZGdlID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbi5wYXJlbnQuaXNHcm91cCl7XG5cdFx0XHRcdHRoaXMubGF5b3V0RWxlbWVudCh0aGlzLmdldENvbEdyb3VwUGFyZW50RWxlbWVudChjb2x1bW4pLCBjb2x1bW4pO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmxheW91dEVsZW1lbnQoY29sdW1uLmdldEVsZW1lbnQoKSwgY29sdW1uKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoYWxsQ2VsbHMpe1xuXHRcdFx0XHRjb2x1bW4uY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMubGF5b3V0RWxlbWVudChjZWxsLmdldEVsZW1lbnQodHJ1ZSksIGNvbHVtbik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdFxuXHRnZXRDb2xHcm91cFBhcmVudEVsZW1lbnQoY29sdW1uKXtcblx0XHRyZXR1cm4gY29sdW1uLnBhcmVudC5pc0dyb3VwID8gdGhpcy5nZXRDb2xHcm91cFBhcmVudEVsZW1lbnQoY29sdW1uLnBhcmVudCkgOiBjb2x1bW4uZ2V0RWxlbWVudCgpO1xuXHR9XG5cdFxuXHQvL2xheW91dCBjb2x1bW5zIGFwcHJvcHJpYXRlbHlcblx0bGF5b3V0KCl7XHRcblx0XHRpZih0aGlzLmFjdGl2ZSAmJiAhdGhpcy5ibG9ja2VkKXtcblx0XHRcdC8vY2FsY3VsYXRlIGxlZnQgY29sdW1uc1xuXHRcdFx0dGhpcy5sYXlvdXRDb2x1bW5Qb3NpdGlvbigpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnJlaW5pdGlhbGl6ZVJvd3MoKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5sYXlvdXRDYWxjUm93cygpO1xuXHRcdH1cblx0fVxuXHRcblx0cmVpbml0aWFsaXplUm93cygpe1xuXHRcdHZhciB2aXNpYmxlUm93cyA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRWaXNpYmxlUm93cyh0cnVlKTtcblx0XHR2YXIgb3RoZXJSb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd3MoKS5maWx0ZXIocm93ID0+ICF2aXNpYmxlUm93cy5pbmNsdWRlcyhyb3cpKTtcblx0XHRcblx0XHRvdGhlclJvd3MuZm9yRWFjaCgocm93KSA9Pntcblx0XHRcdHJvdy5kZWluaXRpYWxpemUoKTtcblx0XHR9KTtcblx0XHRcblx0XHR2aXNpYmxlUm93cy5mb3JFYWNoKChyb3cpID0+e1xuXHRcdFx0aWYocm93LnR5cGUgPT09IFwicm93XCIpe1xuXHRcdFx0XHR0aGlzLmxheW91dFJvdyhyb3cpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdFxuXHRsYXlvdXRSb3cocm93KXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMubGF5b3V0ID09PSBcImZpdERhdGFGaWxsXCIgJiYgdGhpcy5yaWdodENvbHVtbnMubGVuZ3RoKXtcblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5nZXRUYWJsZUVsZW1lbnQoKS5zdHlsZS5taW5XaWR0aCA9IFwiY2FsYygxMDAlIC0gXCIgKyB0aGlzLnJpZ2h0TWFyZ2luICsgXCIpXCI7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMubGVmdENvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHR2YXIgY2VsbCA9IHJvdy5nZXRDZWxsKGNvbHVtbik7XG5cdFx0XHRcblx0XHRcdGlmKGNlbGwpe1xuXHRcdFx0XHR0aGlzLmxheW91dEVsZW1lbnQoY2VsbC5nZXRFbGVtZW50KHRydWUpLCBjb2x1bW4pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMucmlnaHRDb2x1bW5zLmZvckVhY2goKGNvbHVtbikgPT4ge1xuXHRcdFx0dmFyIGNlbGwgPSByb3cuZ2V0Q2VsbChjb2x1bW4pO1xuXHRcdFx0XG5cdFx0XHRpZihjZWxsKXtcblx0XHRcdFx0dGhpcy5sYXlvdXRFbGVtZW50KGNlbGwuZ2V0RWxlbWVudCh0cnVlKSwgY29sdW1uKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0bGF5b3V0RWxlbWVudChlbGVtZW50LCBjb2x1bW4pe1xuXHRcdHZhciBwb3NpdGlvbjtcblx0XHRcblx0XHRpZihjb2x1bW4ubW9kdWxlcy5mcm96ZW4gJiYgZWxlbWVudCl7XG5cdFx0XHRlbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gXCJzdGlja3lcIjtcblxuXHRcdFx0aWYodGhpcy50YWJsZS5ydGwpe1xuXHRcdFx0XHRwb3NpdGlvbiA9IGNvbHVtbi5tb2R1bGVzLmZyb3plbi5wb3NpdGlvbiA9PT0gXCJsZWZ0XCIgPyBcInJpZ2h0XCIgOiBcImxlZnRcIjtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0cG9zaXRpb24gPSBjb2x1bW4ubW9kdWxlcy5mcm96ZW4ucG9zaXRpb247XG5cdFx0XHR9XG5cdFx0XG5cdFx0XHRlbGVtZW50LnN0eWxlW3Bvc2l0aW9uXSA9IGNvbHVtbi5tb2R1bGVzLmZyb3plbi5tYXJnaW47XG5cblx0XHRcdGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1mcm96ZW5cIik7XG5cdFx0XHRcblx0XHRcdGVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShcInRhYnVsYXRvci1mcm96ZW4tbGVmdFwiLCAgY29sdW1uLm1vZHVsZXMuZnJvemVuLmVkZ2UgJiYgY29sdW1uLm1vZHVsZXMuZnJvemVuLnBvc2l0aW9uID09PSBcImxlZnRcIik7XG5cdFx0XHRlbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoXCJ0YWJ1bGF0b3ItZnJvemVuLXJpZ2h0XCIsIGNvbHVtbi5tb2R1bGVzLmZyb3plbi5lZGdlICYmIGNvbHVtbi5tb2R1bGVzLmZyb3plbi5wb3NpdGlvbiA9PT0gXCJyaWdodFwiKTtcblx0XHR9XG5cdH1cblxuXHRhZGp1c3RGb3JTY3JvbGxiYXIod2lkdGgpe1xuXHRcdGlmKHRoaXMucmlnaHRDb2x1bW5zLmxlbmd0aCl7XG5cdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29udGVudHNFbGVtZW50KCkuc3R5bGUud2lkdGggPSBcImNhbGMoMTAwJSAtIFwiICsgd2lkdGggKyBcInB4KVwiO1xuXHRcdH1cblx0fVxuXG5cdGdldEZyb3plbkNvbHVtbnMoKXtcblx0XHRyZXR1cm4gdGhpcy5sZWZ0Q29sdW1ucy5jb25jYXQodGhpcy5yaWdodENvbHVtbnMpO1xuXHR9XG5cdFxuXHRfY2FsY1NwYWNlKGNvbHVtbnMsIGluZGV4KXtcblx0XHR2YXIgd2lkdGggPSAwO1xuXHRcdFxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgaW5kZXg7IGkrKyl7XG5cdFx0XHRpZihjb2x1bW5zW2ldLnZpc2libGUpe1xuXHRcdFx0XHR3aWR0aCArPSBjb2x1bW5zW2ldLmdldFdpZHRoKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB3aWR0aDtcblx0fVxufVxuXG5jbGFzcyBGcm96ZW5Sb3dzIGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJmcm96ZW5Sb3dzXCI7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMudG9wRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0dGhpcy5yb3dzID0gW107XG5cblx0XHQvL3JlZ2lzdGVyIGNvbXBvbmVudCBmdW5jdGlvbnNcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJyb3dcIiwgXCJmcmVlemVcIiwgdGhpcy5mcmVlemVSb3cuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwicm93XCIsIFwidW5mcmVlemVcIiwgdGhpcy51bmZyZWV6ZVJvdy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJyb3dcIiwgXCJpc0Zyb3plblwiLCB0aGlzLmlzUm93RnJvemVuLmJpbmQodGhpcykpO1xuXG5cdFx0Ly9yZWdpc3RlciB0YWJsZSBvcHRpb25zXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZnJvemVuUm93c0ZpZWxkXCIsIFwiaWRcIik7IC8vZmllbGQgdG8gY2hvb3NlIGZyb3plbiByb3dzIGJ5XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZnJvemVuUm93c1wiLCBmYWxzZSk7IC8vaG9sZGVyIGZvciBmcm96ZW4gcm93IGlkZW50aWZpZXJzXG5cdH1cblxuXHRpbml0aWFsaXplKCl7XG5cdFx0dmFyXHRmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblx0XHRcblx0XHR0aGlzLnJvd3MgPSBbXTtcblxuXHRcdHRoaXMudG9wRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWZyb3plbi1yb3dzLWhvbGRlclwiKTtcblx0XHRcblx0XHRmcmFnbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIikpO1xuXHRcdGZyYWdtZW50LmFwcGVuZENoaWxkKHRoaXMudG9wRWxlbWVudCk7XG5cblx0XHQvLyB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZWxlbWVudC5hcHBlbmQodGhpcy50b3BFbGVtZW50KTtcblx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29udGVudHNFbGVtZW50KCkuaW5zZXJ0QmVmb3JlKGZyYWdtZW50LCB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuaGVhZGVyc0VsZW1lbnQubmV4dFNpYmxpbmcpO1xuXG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctZGVsZXRpbmdcIiwgdGhpcy5kZXRhY2hSb3cuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3dzLXZpc2libGVcIiwgdGhpcy52aXNpYmxlUm93cy5iaW5kKHRoaXMpKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJEaXNwbGF5SGFuZGxlcih0aGlzLmdldFJvd3MuYmluZCh0aGlzKSwgMTApO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmZyb3plblJvd3Mpe1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJkYXRhLXByb2Nlc3NlZFwiLCB0aGlzLmluaXRpYWxpemVSb3dzLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctYWRkZWRcIiwgdGhpcy5pbml0aWFsaXplUm93LmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1yZWRyYXdpbmdcIiwgdGhpcy5yZXNpemVIb2xkZXJXaWR0aC5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLXJlc2l6ZWRcIiwgdGhpcy5yZXNpemVIb2xkZXJXaWR0aC5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLXNob3dcIiwgdGhpcy5yZXNpemVIb2xkZXJXaWR0aC5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWhpZGVcIiwgdGhpcy5yZXNpemVIb2xkZXJXaWR0aC5iaW5kKHRoaXMpKTtcblx0XHR9XG5cblx0XHR0aGlzLnJlc2l6ZUhvbGRlcldpZHRoKCk7XG5cdH1cblxuXHRyZXNpemVIb2xkZXJXaWR0aCgpe1xuXHRcdHRoaXMudG9wRWxlbWVudC5zdHlsZS5taW5XaWR0aCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5oZWFkZXJzRWxlbWVudC5vZmZzZXRXaWR0aCArIFwicHhcIjtcblx0fVxuXG5cdGluaXRpYWxpemVSb3dzKCl7XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd3MoKS5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdHRoaXMuaW5pdGlhbGl6ZVJvdyhyb3cpO1xuXHRcdH0pO1xuXHR9XG5cblx0aW5pdGlhbGl6ZVJvdyhyb3cpe1xuXHRcdHZhciBmcm96ZW5Sb3dzID0gdGhpcy50YWJsZS5vcHRpb25zLmZyb3plblJvd3MsXG5cdFx0cm93VHlwZSA9IHR5cGVvZiBmcm96ZW5Sb3dzO1xuXG5cdFx0aWYocm93VHlwZSA9PT0gXCJudW1iZXJcIil7XG5cdFx0XHRpZihyb3cuZ2V0UG9zaXRpb24oKSAmJiAocm93LmdldFBvc2l0aW9uKCkgKyB0aGlzLnJvd3MubGVuZ3RoKSA8PSBmcm96ZW5Sb3dzKXtcblx0XHRcdFx0dGhpcy5mcmVlemVSb3cocm93KTtcblx0XHRcdH1cblx0XHR9ZWxzZSBpZihyb3dUeXBlID09PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0aWYoZnJvemVuUm93cy5jYWxsKHRoaXMudGFibGUsIHJvdy5nZXRDb21wb25lbnQoKSkpe1xuXHRcdFx0XHR0aGlzLmZyZWV6ZVJvdyhyb3cpO1xuXHRcdFx0fVxuXHRcdH1lbHNlIGlmKEFycmF5LmlzQXJyYXkoZnJvemVuUm93cykpe1xuXHRcdFx0aWYoZnJvemVuUm93cy5pbmNsdWRlcyhyb3cuZGF0YVt0aGlzLm9wdGlvbnMoXCJmcm96ZW5Sb3dzRmllbGRcIildKSl7XG5cdFx0XHRcdHRoaXMuZnJlZXplUm93KHJvdyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aXNSb3dGcm96ZW4ocm93KXtcblx0XHR2YXIgaW5kZXggPSB0aGlzLnJvd3MuaW5kZXhPZihyb3cpO1xuXHRcdHJldHVybiBpbmRleCA+IC0xO1xuXHR9XG5cblx0aXNGcm96ZW4oKXtcblx0XHRyZXR1cm4gISF0aGlzLnJvd3MubGVuZ3RoO1xuXHR9XG5cblx0dmlzaWJsZVJvd3Modmlld2FibGUsIHJvd3Mpe1xuXHRcdHRoaXMucm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdHJvd3MucHVzaChyb3cpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHJvd3M7XG5cdH1cblxuXHQvL2ZpbHRlciBmcm96ZW4gcm93cyBvdXQgb2YgZGlzcGxheSBkYXRhXG5cdGdldFJvd3Mocm93cyl7XG5cdFx0dmFyIG91dHB1dCA9IHJvd3Muc2xpY2UoMCk7XG5cblx0XHR0aGlzLnJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdFx0dmFyIGluZGV4ID0gb3V0cHV0LmluZGV4T2Yocm93KTtcblxuXHRcdFx0aWYoaW5kZXggPiAtMSl7XG5cdFx0XHRcdG91dHB1dC5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXG5cdGZyZWV6ZVJvdyhyb3cpe1xuXHRcdGlmKCFyb3cubW9kdWxlcy5mcm96ZW4pe1xuXHRcdFx0cm93Lm1vZHVsZXMuZnJvemVuID0gdHJ1ZTtcblx0XHRcdHRoaXMudG9wRWxlbWVudC5hcHBlbmRDaGlsZChyb3cuZ2V0RWxlbWVudCgpKTtcblx0XHRcdHJvdy5pbml0aWFsaXplKCk7XG5cdFx0XHRyb3cubm9ybWFsaXplSGVpZ2h0KCk7XG5cdFx0XG5cdFx0XHR0aGlzLnJvd3MucHVzaChyb3cpO1xuXG5cdFx0XHR0aGlzLnJlZnJlc2hEYXRhKGZhbHNlLCBcImRpc3BsYXlcIik7XG5cblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5hZGp1c3RUYWJsZVNpemUoKTtcblxuXHRcdFx0dGhpcy5zdHlsZVJvd3MoKTtcblxuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkZyZWV6ZSBFcnJvciAtIFJvdyBpcyBhbHJlYWR5IGZyb3plblwiKTtcblx0XHR9XG5cdH1cblxuXHR1bmZyZWV6ZVJvdyhyb3cpe1xuXHRcdGlmKHJvdy5tb2R1bGVzLmZyb3plbil7XG5cblx0XHRcdHJvdy5tb2R1bGVzLmZyb3plbiA9IGZhbHNlO1xuXG5cdFx0XHR0aGlzLmRldGFjaFJvdyhyb3cpO1xuXG5cdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWRqdXN0VGFibGVTaXplKCk7XG5cblx0XHRcdHRoaXMucmVmcmVzaERhdGEoZmFsc2UsIFwiZGlzcGxheVwiKTtcblxuXHRcdFx0aWYodGhpcy5yb3dzLmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMuc3R5bGVSb3dzKCk7XG5cdFx0XHR9XG5cblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJGcmVlemUgRXJyb3IgLSBSb3cgaXMgYWxyZWFkeSB1bmZyb3plblwiKTtcblx0XHR9XG5cdH1cblxuXHRkZXRhY2hSb3cocm93KXtcblx0XHR2YXIgaW5kZXggPSB0aGlzLnJvd3MuaW5kZXhPZihyb3cpO1xuXG5cdFx0aWYoaW5kZXggPiAtMSl7XG5cdFx0XHR2YXIgcm93RWwgPSByb3cuZ2V0RWxlbWVudCgpO1xuXG5cdFx0XHRpZihyb3dFbC5wYXJlbnROb2RlKXtcblx0XHRcdFx0cm93RWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyb3dFbCk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMucm93cy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdH1cblx0fVxuXG5cdHN0eWxlUm93cyhyb3cpe1xuXHRcdHRoaXMucm93cy5mb3JFYWNoKChyb3csIGkpID0+IHtcblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5zdHlsZVJvdyhyb3csIGkpO1xuXHRcdH0pO1xuXHR9XG59XG5cbi8vcHVibGljIGdyb3VwIG9iamVjdFxuY2xhc3MgR3JvdXBDb21wb25lbnQge1xuXHRjb25zdHJ1Y3RvciAoZ3JvdXApe1xuXHRcdHRoaXMuX2dyb3VwID0gZ3JvdXA7XG5cdFx0dGhpcy50eXBlID0gXCJHcm91cENvbXBvbmVudFwiO1xuXG5cdFx0cmV0dXJuIG5ldyBQcm94eSh0aGlzLCB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKHRhcmdldCwgbmFtZSwgcmVjZWl2ZXIpIHtcblx0XHRcdFx0aWYgKHR5cGVvZiB0YXJnZXRbbmFtZV0gIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gdGFyZ2V0W25hbWVdO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRhcmdldC5fZ3JvdXAuZ3JvdXBNYW5hZ2VyLnRhYmxlLmNvbXBvbmVudEZ1bmN0aW9uQmluZGVyLmhhbmRsZShcImdyb3VwXCIsIHRhcmdldC5fZ3JvdXAsIG5hbWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRnZXRLZXkoKXtcblx0XHRyZXR1cm4gdGhpcy5fZ3JvdXAua2V5O1xuXHR9XG5cblx0Z2V0RmllbGQoKXtcblx0XHRyZXR1cm4gdGhpcy5fZ3JvdXAuZmllbGQ7XG5cdH1cblxuXHRnZXRFbGVtZW50KCl7XG5cdFx0cmV0dXJuIHRoaXMuX2dyb3VwLmVsZW1lbnQ7XG5cdH1cblxuXHRnZXRSb3dzKCl7XG5cdFx0cmV0dXJuIHRoaXMuX2dyb3VwLmdldFJvd3ModHJ1ZSk7XG5cdH1cblxuXHRnZXRTdWJHcm91cHMoKXtcblx0XHRyZXR1cm4gdGhpcy5fZ3JvdXAuZ2V0U3ViR3JvdXBzKHRydWUpO1xuXHR9XG5cblx0Z2V0UGFyZW50R3JvdXAoKXtcblx0XHRyZXR1cm4gdGhpcy5fZ3JvdXAucGFyZW50ID8gdGhpcy5fZ3JvdXAucGFyZW50LmdldENvbXBvbmVudCgpIDogZmFsc2U7XG5cdH1cblxuXHRpc1Zpc2libGUoKXtcblx0XHRyZXR1cm4gdGhpcy5fZ3JvdXAudmlzaWJsZTtcblx0fVxuXG5cdHNob3coKXtcblx0XHR0aGlzLl9ncm91cC5zaG93KCk7XG5cdH1cblxuXHRoaWRlKCl7XG5cdFx0dGhpcy5fZ3JvdXAuaGlkZSgpO1xuXHR9XG5cblx0dG9nZ2xlKCl7XG5cdFx0dGhpcy5fZ3JvdXAudG9nZ2xlVmlzaWJpbGl0eSgpO1xuXHR9XG5cblx0c2Nyb2xsVG8ocG9zaXRpb24sIGlmVmlzaWJsZSl7XG5cdFx0cmV0dXJuIHRoaXMuX2dyb3VwLmdyb3VwTWFuYWdlci50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbFRvUm93KHRoaXMuX2dyb3VwLCBwb3NpdGlvbiwgaWZWaXNpYmxlKTtcblx0fVxuXG5cdF9nZXRTZWxmKCl7XG5cdFx0cmV0dXJuIHRoaXMuX2dyb3VwO1xuXHR9XG5cblx0Z2V0VGFibGUoKXtcblx0XHRyZXR1cm4gdGhpcy5fZ3JvdXAuZ3JvdXBNYW5hZ2VyLnRhYmxlO1xuXHR9XG59XG5cbi8vR3JvdXAgZnVuY3Rpb25zXG5jbGFzcyBHcm91cHtcblx0XG5cdGNvbnN0cnVjdG9yKGdyb3VwTWFuYWdlciwgcGFyZW50LCBsZXZlbCwga2V5LCBmaWVsZCwgZ2VuZXJhdG9yLCBvbGRHcm91cCl7XG5cdFx0dGhpcy5ncm91cE1hbmFnZXIgPSBncm91cE1hbmFnZXI7XG5cdFx0dGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdFx0dGhpcy5rZXkgPSBrZXk7XG5cdFx0dGhpcy5sZXZlbCA9IGxldmVsO1xuXHRcdHRoaXMuZmllbGQgPSBmaWVsZDtcblx0XHR0aGlzLmhhc1N1Ykdyb3VwcyA9IGxldmVsIDwgKGdyb3VwTWFuYWdlci5ncm91cElETG9va3Vwcy5sZW5ndGggLSAxKTtcblx0XHR0aGlzLmFkZFJvdyA9IHRoaXMuaGFzU3ViR3JvdXBzID8gdGhpcy5fYWRkUm93VG9Hcm91cCA6IHRoaXMuX2FkZFJvdztcblx0XHR0aGlzLnR5cGUgPSBcImdyb3VwXCI7IC8vdHlwZSBvZiBlbGVtZW50XG5cdFx0dGhpcy5vbGQgPSBvbGRHcm91cDtcblx0XHR0aGlzLnJvd3MgPSBbXTtcblx0XHR0aGlzLmdyb3VwcyA9IFtdO1xuXHRcdHRoaXMuZ3JvdXBMaXN0ID0gW107XG5cdFx0dGhpcy5nZW5lcmF0b3IgPSBnZW5lcmF0b3I7XG5cdFx0dGhpcy5lbGVtZW50ID0gZmFsc2U7XG5cdFx0dGhpcy5lbGVtZW50Q29udGVudHMgPSBmYWxzZTtcblx0XHR0aGlzLmhlaWdodCA9IDA7XG5cdFx0dGhpcy5vdXRlckhlaWdodCA9IDA7XG5cdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdHRoaXMuY2FsY3MgPSB7fTtcblx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0dGhpcy5tb2R1bGVzID0ge307XG5cdFx0dGhpcy5hcnJvd0VsZW1lbnQgPSBmYWxzZTtcblx0XHRcblx0XHR0aGlzLnZpc2libGUgPSBvbGRHcm91cCA/IG9sZEdyb3VwLnZpc2libGUgOiAodHlwZW9mIGdyb3VwTWFuYWdlci5zdGFydE9wZW5bbGV2ZWxdICE9PSBcInVuZGVmaW5lZFwiID8gZ3JvdXBNYW5hZ2VyLnN0YXJ0T3BlbltsZXZlbF0gOiBncm91cE1hbmFnZXIuc3RhcnRPcGVuWzBdKTtcblx0XHRcblx0XHR0aGlzLmNvbXBvbmVudCA9IG51bGw7XG5cdFx0XG5cdFx0dGhpcy5jcmVhdGVFbGVtZW50cygpO1xuXHRcdHRoaXMuYWRkQmluZGluZ3MoKTtcblx0XHRcblx0XHR0aGlzLmNyZWF0ZVZhbHVlR3JvdXBzKCk7XG5cdH1cblx0XG5cdHdpcGUoZWxlbWVudHNPbmx5KXtcblx0XHRpZighZWxlbWVudHNPbmx5KXtcblx0XHRcdGlmKHRoaXMuZ3JvdXBMaXN0Lmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMuZ3JvdXBMaXN0LmZvckVhY2goZnVuY3Rpb24oZ3JvdXApe1xuXHRcdFx0XHRcdGdyb3VwLndpcGUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMucm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdFx0XHRpZihyb3cubW9kdWxlcyl7XG5cdFx0XHRcdFx0XHRkZWxldGUgcm93Lm1vZHVsZXMuZ3JvdXA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5lbGVtZW50ID0gZmFsc2U7XG5cdFx0dGhpcy5hcnJvd0VsZW1lbnQgPSBmYWxzZTtcblx0XHR0aGlzLmVsZW1lbnRDb250ZW50cyA9IGZhbHNlO1xuXHR9XG5cdFxuXHRjcmVhdGVFbGVtZW50cygpe1xuXHRcdHZhciBhcnJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0YXJyb3cuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1hcnJvd1wiKTtcblx0XHRcblx0XHR0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvd1wiKTtcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ncm91cFwiKTtcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ncm91cC1sZXZlbC1cIiArIHRoaXMubGV2ZWwpO1xuXHRcdHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwicm93Z3JvdXBcIik7XG5cdFx0XG5cdFx0dGhpcy5hcnJvd0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMuYXJyb3dFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZ3JvdXAtdG9nZ2xlXCIpO1xuXHRcdHRoaXMuYXJyb3dFbGVtZW50LmFwcGVuZENoaWxkKGFycm93KTtcblx0XHRcblx0XHQvL3NldHVwIG1vdmFibGUgcm93c1xuXHRcdGlmKHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3MgIT09IGZhbHNlICYmIHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZEV4aXN0cyhcIm1vdmVSb3dcIikpe1xuXHRcdFx0dGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5tb3ZlUm93LmluaXRpYWxpemVHcm91cEhlYWRlcih0aGlzKTtcblx0XHR9XG5cdH1cblx0XG5cdGNyZWF0ZVZhbHVlR3JvdXBzKCl7XG5cdFx0dmFyIGxldmVsID0gdGhpcy5sZXZlbCArIDE7XG5cdFx0aWYodGhpcy5ncm91cE1hbmFnZXIuYWxsb3dlZFZhbHVlcyAmJiB0aGlzLmdyb3VwTWFuYWdlci5hbGxvd2VkVmFsdWVzW2xldmVsXSl7XG5cdFx0XHR0aGlzLmdyb3VwTWFuYWdlci5hbGxvd2VkVmFsdWVzW2xldmVsXS5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLl9jcmVhdGVHcm91cCh2YWx1ZSwgbGV2ZWwpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRhZGRCaW5kaW5ncygpe1xuXHRcdHZhciB0b2dnbGVFbGVtZW50O1xuXHRcdFxuXHRcdGlmKHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuZ3JvdXBUb2dnbGVFbGVtZW50KXtcblx0XHRcdHRvZ2dsZUVsZW1lbnQgPSB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwVG9nZ2xlRWxlbWVudCA9PSBcImFycm93XCIgPyB0aGlzLmFycm93RWxlbWVudCA6IHRoaXMuZWxlbWVudDtcblx0XHRcdFxuXHRcdFx0dG9nZ2xlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdFx0aWYodGhpcy5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cFRvZ2dsZUVsZW1lbnQgPT09IFwiYXJyb3dcIil7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9hbGxvdyBjbGljayBldmVudCB0byBwcm9wYWdhdGUgYmVmb3JlIHRvZ2dsaW5nIHZpc2liaWxpdHlcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy50b2dnbGVWaXNpYmlsaXR5KCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRfY3JlYXRlR3JvdXAoZ3JvdXBJRCwgbGV2ZWwpe1xuXHRcdHZhciBncm91cEtleSA9IGxldmVsICsgXCJfXCIgKyBncm91cElEO1xuXHRcdHZhciBncm91cCA9IG5ldyBHcm91cCh0aGlzLmdyb3VwTWFuYWdlciwgdGhpcywgbGV2ZWwsIGdyb3VwSUQsICB0aGlzLmdyb3VwTWFuYWdlci5ncm91cElETG9va3Vwc1tsZXZlbF0uZmllbGQsIHRoaXMuZ3JvdXBNYW5hZ2VyLmhlYWRlckdlbmVyYXRvcltsZXZlbF0gfHwgdGhpcy5ncm91cE1hbmFnZXIuaGVhZGVyR2VuZXJhdG9yWzBdLCB0aGlzLm9sZCA/IHRoaXMub2xkLmdyb3Vwc1tncm91cEtleV0gOiBmYWxzZSk7XG5cdFx0XG5cdFx0dGhpcy5ncm91cHNbZ3JvdXBLZXldID0gZ3JvdXA7XG5cdFx0dGhpcy5ncm91cExpc3QucHVzaChncm91cCk7XG5cdH1cblx0XG5cdF9hZGRSb3dUb0dyb3VwKHJvdyl7XG5cdFx0XG5cdFx0dmFyIGxldmVsID0gdGhpcy5sZXZlbCArIDE7XG5cdFx0XG5cdFx0aWYodGhpcy5oYXNTdWJHcm91cHMpe1xuXHRcdFx0dmFyIGdyb3VwSUQgPSB0aGlzLmdyb3VwTWFuYWdlci5ncm91cElETG9va3Vwc1tsZXZlbF0uZnVuYyhyb3cuZ2V0RGF0YSgpKSxcblx0XHRcdGdyb3VwS2V5ID0gbGV2ZWwgKyBcIl9cIiArIGdyb3VwSUQ7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMuZ3JvdXBNYW5hZ2VyLmFsbG93ZWRWYWx1ZXMgJiYgdGhpcy5ncm91cE1hbmFnZXIuYWxsb3dlZFZhbHVlc1tsZXZlbF0pe1xuXHRcdFx0XHRpZih0aGlzLmdyb3Vwc1tncm91cEtleV0pe1xuXHRcdFx0XHRcdHRoaXMuZ3JvdXBzW2dyb3VwS2V5XS5hZGRSb3cocm93KTtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRpZighdGhpcy5ncm91cHNbZ3JvdXBLZXldKXtcblx0XHRcdFx0XHR0aGlzLl9jcmVhdGVHcm91cChncm91cElELCBsZXZlbCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuZ3JvdXBzW2dyb3VwS2V5XS5hZGRSb3cocm93KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdF9hZGRSb3cocm93KXtcblx0XHR0aGlzLnJvd3MucHVzaChyb3cpO1xuXHRcdHJvdy5tb2R1bGVzLmdyb3VwID0gdGhpcztcblx0fVxuXHRcblx0aW5zZXJ0Um93KHJvdywgdG8sIGFmdGVyKXtcblx0XHR2YXIgZGF0YSA9IHRoaXMuY29uZm9ybVJvd0RhdGEoe30pO1xuXHRcdFxuXHRcdHJvdy51cGRhdGVEYXRhKGRhdGEpO1xuXHRcdFxuXHRcdHZhciB0b0luZGV4ID0gdGhpcy5yb3dzLmluZGV4T2YodG8pO1xuXHRcdFxuXHRcdGlmKHRvSW5kZXggPiAtMSl7XG5cdFx0XHRpZihhZnRlcil7XG5cdFx0XHRcdHRoaXMucm93cy5zcGxpY2UodG9JbmRleCsxLCAwLCByb3cpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLnJvd3Muc3BsaWNlKHRvSW5kZXgsIDAsIHJvdyk7XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYoYWZ0ZXIpe1xuXHRcdFx0XHR0aGlzLnJvd3MucHVzaChyb3cpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLnJvd3MudW5zaGlmdChyb3cpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyb3cubW9kdWxlcy5ncm91cCA9IHRoaXM7XG5cdFx0XG5cdFx0Ly8gdGhpcy5nZW5lcmF0ZUdyb3VwSGVhZGVyQ29udGVudHMoKTtcblx0XHRcblx0XHRpZih0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2RFeGlzdHMoXCJjb2x1bW5DYWxjc1wiKSAmJiB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwidGFibGVcIil7XG5cdFx0XHR0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnJlY2FsY0dyb3VwKHRoaXMpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmdyb3VwTWFuYWdlci51cGRhdGVHcm91cFJvd3ModHJ1ZSk7XG5cdH1cblx0XG5cdHNjcm9sbEhlYWRlcihsZWZ0KXtcblx0XHRpZih0aGlzLmFycm93RWxlbWVudCl7XG5cdFx0XHR0aGlzLmFycm93RWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gbGVmdDtcblx0XHRcdFxuXHRcdFx0dGhpcy5ncm91cExpc3QuZm9yRWFjaChmdW5jdGlvbihjaGlsZCl7XG5cdFx0XHRcdGNoaWxkLnNjcm9sbEhlYWRlcihsZWZ0KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXHRcblx0Z2V0Um93SW5kZXgocm93KXt9XG5cdFxuXHQvL3VwZGF0ZSByb3cgZGF0YSB0byBtYXRjaCBncm91cGluZyBjb25zdHJhaW50c1xuXHRjb25mb3JtUm93RGF0YShkYXRhKXtcblx0XHRpZih0aGlzLmZpZWxkKXtcblx0XHRcdGRhdGFbdGhpcy5maWVsZF0gPSB0aGlzLmtleTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJEYXRhIENvbmZvcm1pbmcgRXJyb3IgLSBDYW5ub3QgY29uZm9ybSByb3cgZGF0YSB0byBtYXRjaCBuZXcgZ3JvdXAgYXMgZ3JvdXBCeSBpcyBhIGZ1bmN0aW9uXCIpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLnBhcmVudCl7XG5cdFx0XHRkYXRhID0gdGhpcy5wYXJlbnQuY29uZm9ybVJvd0RhdGEoZGF0YSk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBkYXRhO1xuXHR9XG5cdFxuXHRyZW1vdmVSb3cocm93KXtcblx0XHR2YXIgaW5kZXggPSB0aGlzLnJvd3MuaW5kZXhPZihyb3cpO1xuXHRcdHZhciBlbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cdFx0XG5cdFx0aWYoaW5kZXggPiAtMSl7XG5cdFx0XHR0aGlzLnJvd3Muc3BsaWNlKGluZGV4LCAxKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoIXRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuZ3JvdXBWYWx1ZXMgJiYgIXRoaXMucm93cy5sZW5ndGgpe1xuXHRcdFx0aWYodGhpcy5wYXJlbnQpe1xuXHRcdFx0XHR0aGlzLnBhcmVudC5yZW1vdmVHcm91cCh0aGlzKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5ncm91cE1hbmFnZXIucmVtb3ZlR3JvdXAodGhpcyk7XG5cdFx0XHR9XHRcdFxuXHRcdFx0XG5cdFx0XHR0aGlzLmdyb3VwTWFuYWdlci51cGRhdGVHcm91cFJvd3ModHJ1ZSk7XG5cdFx0XHRcblx0XHR9ZWxzZSB7XG5cdFx0XHRcblx0XHRcdGlmKGVsLnBhcmVudE5vZGUpe1xuXHRcdFx0XHRlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoIXRoaXMuZ3JvdXBNYW5hZ2VyLmJsb2NrUmVkcmF3KXtcblx0XHRcdFx0dGhpcy5nZW5lcmF0ZUdyb3VwSGVhZGVyQ29udGVudHMoKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpICYmIHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuY29sdW1uQ2FsY3MgIT0gXCJ0YWJsZVwiKXtcblx0XHRcdFx0XHR0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnJlY2FsY0dyb3VwKHRoaXMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9XG5cdH1cblx0XG5cdHJlbW92ZUdyb3VwKGdyb3VwKXtcblx0XHR2YXIgZ3JvdXBLZXkgPSBncm91cC5sZXZlbCArIFwiX1wiICsgZ3JvdXAua2V5LFxuXHRcdGluZGV4O1xuXHRcdFxuXHRcdGlmKHRoaXMuZ3JvdXBzW2dyb3VwS2V5XSl7XG5cdFx0XHRkZWxldGUgdGhpcy5ncm91cHNbZ3JvdXBLZXldO1xuXHRcdFx0XG5cdFx0XHRpbmRleCA9IHRoaXMuZ3JvdXBMaXN0LmluZGV4T2YoZ3JvdXApO1xuXHRcdFx0XG5cdFx0XHRpZihpbmRleCA+IC0xKXtcblx0XHRcdFx0dGhpcy5ncm91cExpc3Quc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoIXRoaXMuZ3JvdXBMaXN0Lmxlbmd0aCl7XG5cdFx0XHRcdGlmKHRoaXMucGFyZW50KXtcblx0XHRcdFx0XHR0aGlzLnBhcmVudC5yZW1vdmVHcm91cCh0aGlzKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuZ3JvdXBNYW5hZ2VyLnJlbW92ZUdyb3VwKHRoaXMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRnZXRIZWFkZXJzQW5kUm93cygpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcblx0XHRvdXRwdXQucHVzaCh0aGlzKTtcblx0XHRcblx0XHR0aGlzLl92aXNTZXQoKTtcblx0XHRcblx0XHRcblx0XHRpZih0aGlzLmNhbGNzLnRvcCl7XG5cdFx0XHR0aGlzLmNhbGNzLnRvcC5kZXRhY2hFbGVtZW50KCk7XG5cdFx0XHR0aGlzLmNhbGNzLnRvcC5kZWxldGVDZWxscygpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLmNhbGNzLmJvdHRvbSl7XG5cdFx0XHR0aGlzLmNhbGNzLmJvdHRvbS5kZXRhY2hFbGVtZW50KCk7XG5cdFx0XHR0aGlzLmNhbGNzLmJvdHRvbS5kZWxldGVDZWxscygpO1xuXHRcdH1cblx0XHRcblx0XHRcblx0XHRcblx0XHRpZih0aGlzLnZpc2libGUpe1xuXHRcdFx0aWYodGhpcy5ncm91cExpc3QubGVuZ3RoKXtcblx0XHRcdFx0dGhpcy5ncm91cExpc3QuZm9yRWFjaChmdW5jdGlvbihncm91cCl7XG5cdFx0XHRcdFx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdChncm91cC5nZXRIZWFkZXJzQW5kUm93cygpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRpZih0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwidGFibGVcIiAmJiB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2RFeGlzdHMoXCJjb2x1bW5DYWxjc1wiKSAmJiB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLmhhc1RvcENhbGNzKCkpe1xuXHRcdFx0XHRcdHRoaXMuY2FsY3MudG9wID0gdGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5nZW5lcmF0ZVRvcFJvdyh0aGlzLnJvd3MpO1xuXHRcdFx0XHRcdG91dHB1dC5wdXNoKHRoaXMuY2FsY3MudG9wKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdCh0aGlzLnJvd3MpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodGhpcy5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPSBcInRhYmxlXCIgJiYgIHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpICYmIHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MuaGFzQm90dG9tQ2FsY3MoKSl7XG5cdFx0XHRcdFx0dGhpcy5jYWxjcy5ib3R0b20gPSB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLmdlbmVyYXRlQm90dG9tUm93KHRoaXMucm93cyk7XG5cdFx0XHRcdFx0b3V0cHV0LnB1c2godGhpcy5jYWxjcy5ib3R0b20pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYoIXRoaXMuZ3JvdXBMaXN0Lmxlbmd0aCAmJiB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwidGFibGVcIil7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2RFeGlzdHMoXCJjb2x1bW5DYWxjc1wiKSl7XG5cdFx0XHRcdFx0aWYodGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5oYXNUb3BDYWxjcygpKXtcblx0XHRcdFx0XHRcdGlmKHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuZ3JvdXBDbG9zZWRTaG93Q2FsY3Mpe1xuXHRcdFx0XHRcdFx0XHR0aGlzLmNhbGNzLnRvcCA9IHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MuZ2VuZXJhdGVUb3BSb3codGhpcy5yb3dzKTtcblx0XHRcdFx0XHRcdFx0b3V0cHV0LnB1c2godGhpcy5jYWxjcy50b3ApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZih0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLmhhc0JvdHRvbUNhbGNzKCkpe1x0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYodGhpcy5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cENsb3NlZFNob3dDYWxjcyl7XG5cdFx0XHRcdFx0XHRcdHRoaXMuY2FsY3MuYm90dG9tID0gdGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5nZW5lcmF0ZUJvdHRvbVJvdyh0aGlzLnJvd3MpO1xuXHRcdFx0XHRcdFx0XHRvdXRwdXQucHVzaCh0aGlzLmNhbGNzLmJvdHRvbSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0Z2V0RGF0YSh2aXNpYmxlLCB0cmFuc2Zvcm0pe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcblx0XHR0aGlzLl92aXNTZXQoKTtcblx0XHRcblx0XHRpZighdmlzaWJsZSB8fCAodmlzaWJsZSAmJiB0aGlzLnZpc2libGUpKXtcblx0XHRcdHRoaXMucm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdFx0b3V0cHV0LnB1c2gocm93LmdldERhdGEodHJhbnNmb3JtIHx8IFwiZGF0YVwiKSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0Z2V0Um93Q291bnQoKXtcblx0XHR2YXIgY291bnQgPSAwO1xuXHRcdFxuXHRcdGlmKHRoaXMuZ3JvdXBMaXN0Lmxlbmd0aCl7XG5cdFx0XHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKChncm91cCkgPT4ge1xuXHRcdFx0XHRjb3VudCArPSBncm91cC5nZXRSb3dDb3VudCgpO1xuXHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y291bnQgPSB0aGlzLnJvd3MubGVuZ3RoO1xuXHRcdH1cblx0XHRyZXR1cm4gY291bnQ7XG5cdH1cblxuXHRcblx0dG9nZ2xlVmlzaWJpbGl0eSgpe1xuXHRcdGlmKHRoaXMudmlzaWJsZSl7XG5cdFx0XHR0aGlzLmhpZGUoKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLnNob3coKTtcblx0XHR9XG5cdH1cblx0XG5cdGhpZGUoKXtcblx0XHR0aGlzLnZpc2libGUgPSBmYWxzZTtcblx0XHRcblx0XHRpZih0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5yb3dNYW5hZ2VyLmdldFJlbmRlck1vZGUoKSA9PSBcImJhc2ljXCIgJiYgIXRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbil7XG5cdFx0XHRcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWdyb3VwLXZpc2libGVcIik7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMuZ3JvdXBMaXN0Lmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMuZ3JvdXBMaXN0LmZvckVhY2goKGdyb3VwKSA9PiB7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0dmFyIHJvd3MgPSBncm91cC5nZXRIZWFkZXJzQW5kUm93cygpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdFx0XHRyb3cuZGV0YWNoRWxlbWVudCgpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMucm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdFx0XHR2YXIgcm93RWwgPSByb3cuZ2V0RWxlbWVudCgpO1xuXHRcdFx0XHRcdHJvd0VsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocm93RWwpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5ncm91cE1hbmFnZXIudXBkYXRlR3JvdXBSb3dzKHRydWUpO1xuXHRcdFx0XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5ncm91cE1hbmFnZXIudXBkYXRlR3JvdXBSb3dzKHRydWUpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5leHRlcm5hbEV2ZW50cy5kaXNwYXRjaChcImdyb3VwVmlzaWJpbGl0eUNoYW5nZWRcIiwgdGhpcy5nZXRDb21wb25lbnQoKSwgZmFsc2UpO1xuXHR9XG5cdFxuXHRzaG93KCl7XG5cdFx0dGhpcy52aXNpYmxlID0gdHJ1ZTtcblx0XHRcblx0XHRpZih0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5yb3dNYW5hZ2VyLmdldFJlbmRlck1vZGUoKSA9PSBcImJhc2ljXCIgJiYgIXRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbil7XG5cdFx0XHRcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWdyb3VwLXZpc2libGVcIik7XG5cdFx0XHRcblx0XHRcdHZhciBwcmV2ID0gdGhpcy5nZW5lcmF0ZUVsZW1lbnQoKTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy5ncm91cExpc3QubGVuZ3RoKXtcblx0XHRcdFx0dGhpcy5ncm91cExpc3QuZm9yRWFjaCgoZ3JvdXApID0+IHtcblx0XHRcdFx0XHR2YXIgcm93cyA9IGdyb3VwLmdldEhlYWRlcnNBbmRSb3dzKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0cm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdFx0XHRcdHZhciByb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cdFx0XHRcdFx0XHRwcmV2LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHJvd0VsLCBwcmV2Lm5leHRTaWJsaW5nKTtcblx0XHRcdFx0XHRcdHJvdy5pbml0aWFsaXplKCk7XG5cdFx0XHRcdFx0XHRwcmV2ID0gcm93RWw7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5yb3dzLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRcdHZhciByb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cdFx0XHRcdFx0cHJldi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyb3dFbCwgcHJldi5uZXh0U2libGluZyk7XG5cdFx0XHRcdFx0cm93LmluaXRpYWxpemUoKTtcblx0XHRcdFx0XHRwcmV2ID0gcm93RWw7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLmdyb3VwTWFuYWdlci51cGRhdGVHcm91cFJvd3ModHJ1ZSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5ncm91cE1hbmFnZXIudXBkYXRlR3JvdXBSb3dzKHRydWUpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5leHRlcm5hbEV2ZW50cy5kaXNwYXRjaChcImdyb3VwVmlzaWJpbGl0eUNoYW5nZWRcIiwgdGhpcy5nZXRDb21wb25lbnQoKSwgdHJ1ZSk7XG5cdH1cblx0XG5cdF92aXNTZXQoKXtcblx0XHR2YXIgZGF0YSA9IFtdO1xuXHRcdFxuXHRcdGlmKHR5cGVvZiB0aGlzLnZpc2libGUgPT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdFxuXHRcdFx0dGhpcy5yb3dzLmZvckVhY2goZnVuY3Rpb24ocm93KXtcblx0XHRcdFx0ZGF0YS5wdXNoKHJvdy5nZXREYXRhKCkpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMudmlzaWJsZSA9IHRoaXMudmlzaWJsZSh0aGlzLmtleSwgdGhpcy5nZXRSb3dDb3VudCgpLCBkYXRhLCB0aGlzLmdldENvbXBvbmVudCgpKTtcblx0XHR9XG5cdH1cblx0XG5cdGdldFJvd0dyb3VwKHJvdyl7XG5cdFx0dmFyIG1hdGNoID0gZmFsc2U7XG5cdFx0aWYodGhpcy5ncm91cExpc3QubGVuZ3RoKXtcblx0XHRcdHRoaXMuZ3JvdXBMaXN0LmZvckVhY2goZnVuY3Rpb24oZ3JvdXApe1xuXHRcdFx0XHR2YXIgcmVzdWx0ID0gZ3JvdXAuZ2V0Um93R3JvdXAocm93KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHJlc3VsdCl7XG5cdFx0XHRcdFx0bWF0Y2ggPSByZXN1bHQ7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdGlmKHRoaXMucm93cy5maW5kKGZ1bmN0aW9uKGl0ZW0pe1xuXHRcdFx0XHRyZXR1cm4gaXRlbSA9PT0gcm93O1xuXHRcdFx0fSkpe1xuXHRcdFx0XHRtYXRjaCA9IHRoaXM7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBtYXRjaDtcblx0fVxuXHRcblx0Z2V0U3ViR3JvdXBzKGNvbXBvbmVudCl7XG5cdFx0dmFyIG91dHB1dCA9IFtdO1xuXHRcdFxuXHRcdHRoaXMuZ3JvdXBMaXN0LmZvckVhY2goZnVuY3Rpb24oY2hpbGQpe1xuXHRcdFx0b3V0cHV0LnB1c2goY29tcG9uZW50ID8gY2hpbGQuZ2V0Q29tcG9uZW50KCkgOiBjaGlsZCk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0Z2V0Um93cyhjb21wb25lbnQsIGluY2x1ZGVDaGlsZHJlbil7XG5cdFx0dmFyIG91dHB1dCA9IFtdO1xuXHRcdFxuXHRcdGlmKGluY2x1ZGVDaGlsZHJlbiAmJiB0aGlzLmdyb3VwTGlzdC5sZW5ndGgpe1xuXHRcdFx0dGhpcy5ncm91cExpc3QuZm9yRWFjaCgoZ3JvdXApID0+IHtcblx0XHRcdFx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdChncm91cC5nZXRSb3dzKGNvbXBvbmVudCwgaW5jbHVkZUNoaWxkcmVuKSk7XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLnJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdFx0XHRvdXRwdXQucHVzaChjb21wb25lbnQgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiByb3cpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblx0XG5cdGdlbmVyYXRlR3JvdXBIZWFkZXJDb250ZW50cygpe1xuXHRcdHZhciBkYXRhID0gW107XG5cdFx0XG5cdFx0dmFyIHJvd3MgPSB0aGlzLmdldFJvd3MoZmFsc2UsIHRydWUpO1xuXHRcdFxuXHRcdHJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdFx0ZGF0YS5wdXNoKHJvdy5nZXREYXRhKCkpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMuZWxlbWVudENvbnRlbnRzID0gdGhpcy5nZW5lcmF0b3IodGhpcy5rZXksIHRoaXMuZ2V0Um93Q291bnQoKSwgZGF0YSwgdGhpcy5nZXRDb21wb25lbnQoKSk7XG5cdFx0XG5cdFx0d2hpbGUodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpIHRoaXMuZWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdFx0XG5cdFx0aWYodHlwZW9mIHRoaXMuZWxlbWVudENvbnRlbnRzID09PSBcInN0cmluZ1wiKXtcblx0XHRcdHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLmVsZW1lbnRDb250ZW50cztcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50Q29udGVudHMpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmVsZW1lbnQuaW5zZXJ0QmVmb3JlKHRoaXMuYXJyb3dFbGVtZW50LCB0aGlzLmVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdH1cblx0XG5cdGdldFBhdGgocGF0aCA9IFtdKSB7XG5cdFx0cGF0aC51bnNoaWZ0KHRoaXMua2V5KTtcblx0XHRpZih0aGlzLnBhcmVudCkge1xuXHRcdFx0dGhpcy5wYXJlbnQuZ2V0UGF0aChwYXRoKTtcblx0XHR9XG5cdFx0cmV0dXJuIHBhdGg7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vIFN0YW5kYXJkIFJvdyBGdW5jdGlvbnMgLy8vLy8vLy8vLy8vLy9cblx0XG5cdGdldEVsZW1lbnQoKXtcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50Q29udGVudHMgPyB0aGlzLmVsZW1lbnQgOiB0aGlzLmdlbmVyYXRlRWxlbWVudCgpO1xuXHR9XG5cdFxuXHRnZW5lcmF0ZUVsZW1lbnQoKXtcblx0XHR0aGlzLmFkZEJpbmRpbmdzID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5fdmlzU2V0KCk7XG5cdFx0XG5cdFx0aWYodGhpcy52aXNpYmxlKXtcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWdyb3VwLXZpc2libGVcIik7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItZ3JvdXAtdmlzaWJsZVwiKTtcblx0XHR9XG5cdFx0XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuZWxlbWVudC5jaGlsZE5vZGVzLmxlbmd0aDsgKytpKXtcblx0XHRcdHRoaXMuZWxlbWVudC5jaGlsZE5vZGVzW2ldLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50LmNoaWxkTm9kZXNbaV0pO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmdlbmVyYXRlR3JvdXBIZWFkZXJDb250ZW50cygpO1xuXHRcdFxuXHRcdC8vIHRoaXMuYWRkQmluZGluZ3MoKTtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50O1xuXHR9XG5cdFxuXHRkZXRhY2hFbGVtZW50KCl7XG5cdFx0aWYgKHRoaXMuZWxlbWVudCAmJiB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSl7XG5cdFx0XHR0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9ub3JtYWxpemUgdGhlIGhlaWdodCBvZiBlbGVtZW50cyBpbiB0aGUgcm93XG5cdG5vcm1hbGl6ZUhlaWdodCgpe1xuXHRcdHRoaXMuc2V0SGVpZ2h0KHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQpO1xuXHR9XG5cdFxuXHRpbml0aWFsaXplKGZvcmNlKXtcblx0XHRpZighdGhpcy5pbml0aWFsaXplZCB8fCBmb3JjZSl7XG5cdFx0XHR0aGlzLm5vcm1hbGl6ZUhlaWdodCgpO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZWluaXRpYWxpemUoKXtcblx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0dGhpcy5oZWlnaHQgPSAwO1xuXHRcdFxuXHRcdGlmKEhlbHBlcnMuZWxWaXNpYmxlKHRoaXMuZWxlbWVudCkpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplKHRydWUpO1xuXHRcdH1cblx0fVxuXHRcblx0c2V0SGVpZ2h0KGhlaWdodCl7XG5cdFx0aWYodGhpcy5oZWlnaHQgIT0gaGVpZ2h0KXtcblx0XHRcdHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXHRcdFx0dGhpcy5vdXRlckhlaWdodCA9IHRoaXMuZWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3JldHVybiByb3dzIG91dGVyIGhlaWdodFxuXHRnZXRIZWlnaHQoKXtcblx0XHRyZXR1cm4gdGhpcy5vdXRlckhlaWdodDtcblx0fVxuXHRcblx0Z2V0R3JvdXAoKXtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXHRcblx0cmVpbml0aWFsaXplSGVpZ2h0KCl7fVxuXHRcblx0Y2FsY0hlaWdodCgpe31cblx0XG5cdHNldENlbGxIZWlnaHQoKXt9XG5cdFxuXHRjbGVhckNlbGxIZWlnaHQoKXt9XG5cdFxuXHRkZWluaXRpYWxpemVIZWlnaHQoKXt9XG5cblx0cmVuZGVyZWQoKXt9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vIE9iamVjdCBHZW5lcmF0aW9uIC8vLy8vLy8vLy8vLy8vLy8vXG5cdGdldENvbXBvbmVudCgpe1xuXHRcdGlmKCF0aGlzLmNvbXBvbmVudCl7XG5cdFx0XHR0aGlzLmNvbXBvbmVudCA9IG5ldyBHcm91cENvbXBvbmVudCh0aGlzKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuY29tcG9uZW50O1xuXHR9XG59XG5cbmNsYXNzIEdyb3VwUm93cyBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwiZ3JvdXBSb3dzXCI7XG5cdFxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMuZ3JvdXBJRExvb2t1cHMgPSBmYWxzZTsgLy9lbmFibGUgdGFibGUgZ3JvdXBpbmcgYW5kIHNldCBmaWVsZCB0byBncm91cCBieVxuXHRcdHRoaXMuc3RhcnRPcGVuID0gW2Z1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO31dOyAvL3N0YXJ0aW5nIHN0YXRlIG9mIGdyb3VwXG5cdFx0dGhpcy5oZWFkZXJHZW5lcmF0b3IgPSBbZnVuY3Rpb24oKXtyZXR1cm4gXCJcIjt9XTtcblx0XHR0aGlzLmdyb3VwTGlzdCA9IFtdOyAvL29yZGVyZWQgbGlzdCBvZiBncm91cHNcblx0XHR0aGlzLmFsbG93ZWRWYWx1ZXMgPSBmYWxzZTtcblx0XHR0aGlzLmdyb3VwcyA9IHt9OyAvL2hvbGQgcm93IGdyb3Vwc1xuXHRcdFxuXHRcdHRoaXMuZGlzcGxheUhhbmRsZXIgPSB0aGlzLmdldFJvd3MuYmluZCh0aGlzKTtcblxuXHRcdHRoaXMuYmxvY2tSZWRyYXcgPSBmYWxzZTtcblx0XHRcblx0XHQvL3JlZ2lzdGVyIHRhYmxlIG9wdGlvbnNcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJncm91cEJ5XCIsIGZhbHNlKTsgLy9lbmFibGUgdGFibGUgZ3JvdXBpbmcgYW5kIHNldCBmaWVsZCB0byBncm91cCBieVxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImdyb3VwU3RhcnRPcGVuXCIsIHRydWUpOyAvL3N0YXJ0aW5nIHN0YXRlIG9mIGdyb3VwXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZ3JvdXBWYWx1ZXNcIiwgZmFsc2UpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImdyb3VwVXBkYXRlT25DZWxsRWRpdFwiLCBmYWxzZSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZ3JvdXBIZWFkZXJcIiwgZmFsc2UpOyAvL2hlYWRlciBnZW5lcmF0aW9uIGZ1bmN0aW9uXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZ3JvdXBIZWFkZXJQcmludFwiLCBudWxsKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJncm91cEhlYWRlckNsaXBib2FyZFwiLCBudWxsKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJncm91cEhlYWRlckh0bWxPdXRwdXRcIiwgbnVsbCk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZ3JvdXBIZWFkZXJEb3dubG9hZFwiLCBudWxsKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJncm91cFRvZ2dsZUVsZW1lbnRcIiwgXCJhcnJvd1wiKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJncm91cENsb3NlZFNob3dDYWxjc1wiLCBmYWxzZSk7XG5cdFx0XG5cdFx0Ly9yZWdpc3RlciB0YWJsZSBmdW5jdGlvbnNcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInNldEdyb3VwQnlcIiwgdGhpcy5zZXRHcm91cEJ5LmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwic2V0R3JvdXBWYWx1ZXNcIiwgdGhpcy5zZXRHcm91cFZhbHVlcy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInNldEdyb3VwU3RhcnRPcGVuXCIsIHRoaXMuc2V0R3JvdXBTdGFydE9wZW4uYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJzZXRHcm91cEhlYWRlclwiLCB0aGlzLnNldEdyb3VwSGVhZGVyLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0R3JvdXBzXCIsIHRoaXMudXNlckdldEdyb3Vwcy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImdldEdyb3VwZWREYXRhXCIsIHRoaXMudXNlckdldEdyb3VwZWREYXRhLmJpbmQodGhpcykpO1xuXHRcdFxuXHRcdC8vcmVnaXN0ZXIgY29tcG9uZW50IGZ1bmN0aW9uc1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcInJvd1wiLCBcImdldEdyb3VwXCIsIHRoaXMucm93R2V0R3JvdXAuYmluZCh0aGlzKSk7XG5cdH1cblx0XG5cdC8vaW5pdGlhbGl6ZSBncm91cCBjb25maWd1cmF0aW9uXG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLWRlc3Ryb3lcIiwgdGhpcy5fYmxvY2tSZWRyYXdpbmcuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3dzLXdpcGVcIiwgdGhpcy5fYmxvY2tSZWRyYXdpbmcuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3dzLXdpcGVkXCIsIHRoaXMuX3Jlc3RvcmVfcmVkcmF3aW5nLmJpbmQodGhpcykpO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkpe1xuXHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwVXBkYXRlT25DZWxsRWRpdCl7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC12YWx1ZS11cGRhdGVkXCIsIHRoaXMuY2VsbFVwZGF0ZWQuYmluZCh0aGlzKSk7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWRhdGEtY2hhbmdlZFwiLCB0aGlzLnJlYXNzaWduUm93VG9Hcm91cC5iaW5kKHRoaXMpLCAwKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1idWlsdFwiLCB0aGlzLmNvbmZpZ3VyZUdyb3VwU2V0dXAuYmluZCh0aGlzKSk7XG5cdFx0XHRcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWRlbGV0aW5nXCIsIHRoaXMucm93RGVsZXRpbmcuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1kZWxldGVkXCIsIHRoaXMucm93c1VwZGF0ZWQuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInNjcm9sbC1ob3Jpem9udGFsXCIsIHRoaXMuc2Nyb2xsSGVhZGVycy5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93cy13aXBlXCIsIHRoaXMud2lwZS5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93cy1hZGRlZFwiLCB0aGlzLnJvd3NVcGRhdGVkLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctbW92aW5nXCIsIHRoaXMucm93TW92aW5nLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctYWRkaW5nLWluZGV4XCIsIHRoaXMucm93QWRkaW5nSW5kZXguYmluZCh0aGlzKSk7XG5cdFx0XHRcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93cy1zYW1wbGVcIiwgdGhpcy5yb3dTYW1wbGUuYmluZCh0aGlzKSk7XG5cdFx0XHRcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicmVuZGVyLXZpcnR1YWwtZmlsbFwiLCB0aGlzLnZpcnR1YWxSZW5kZXJGaWxsLmJpbmQodGhpcykpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnJlZ2lzdGVyRGlzcGxheUhhbmRsZXIodGhpcy5kaXNwbGF5SGFuZGxlciwgMjApO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHR9XG5cdH1cblx0XG5cdF9ibG9ja1JlZHJhd2luZygpe1xuXHRcdHRoaXMuYmxvY2tSZWRyYXcgPSB0cnVlO1xuXHR9XG5cblx0X3Jlc3RvcmVfcmVkcmF3aW5nKCl7XG5cdFx0dGhpcy5ibG9ja1JlZHJhdyA9IGZhbHNlO1xuXHR9XG5cblx0Y29uZmlndXJlR3JvdXBTZXR1cCgpe1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5KXtcblx0XHRcdHZhciBncm91cEJ5ID0gdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnksXG5cdFx0XHRzdGFydE9wZW4gPSB0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBTdGFydE9wZW4sXG5cdFx0XHRncm91cEhlYWRlciA9IHRoaXMudGFibGUub3B0aW9ucy5ncm91cEhlYWRlcjtcblx0XHRcdFxuXHRcdFx0dGhpcy5hbGxvd2VkVmFsdWVzID0gdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwVmFsdWVzO1xuXHRcdFx0XG5cdFx0XHRpZihBcnJheS5pc0FycmF5KGdyb3VwQnkpICYmIEFycmF5LmlzQXJyYXkoZ3JvdXBIZWFkZXIpICYmIGdyb3VwQnkubGVuZ3RoID4gZ3JvdXBIZWFkZXIubGVuZ3RoKXtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiRXJyb3IgY3JlYXRpbmcgZ3JvdXAgaGVhZGVycywgZ3JvdXBIZWFkZXIgYXJyYXkgaXMgc2hvcnRlciB0aGFuIGdyb3VwQnkgYXJyYXlcIik7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMuaGVhZGVyR2VuZXJhdG9yID0gW2Z1bmN0aW9uKCl7cmV0dXJuIFwiXCI7fV07XG5cdFx0XHR0aGlzLnN0YXJ0T3BlbiA9IFtmdW5jdGlvbigpe3JldHVybiBmYWxzZTt9XTsgLy9zdGFydGluZyBzdGF0ZSBvZiBncm91cFxuXHRcdFx0XG5cdFx0XHR0aGlzLmxhbmdCaW5kKFwiZ3JvdXBzfGl0ZW1cIiwgKGxhbmdWYWx1ZSwgbGFuZykgPT4ge1xuXHRcdFx0XHR0aGlzLmhlYWRlckdlbmVyYXRvclswXSA9ICh2YWx1ZSwgY291bnQsIGRhdGEpID0+IHsgLy9oZWFkZXIgbGF5b3V0IGZ1bmN0aW9uXG5cdFx0XHRcdFx0cmV0dXJuICh0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIgPyBcIlwiIDogdmFsdWUpICsgXCI8c3Bhbj4oXCIgKyBjb3VudCArIFwiIFwiICsgKChjb3VudCA9PT0gMSkgPyBsYW5nVmFsdWUgOiBsYW5nLmdyb3Vwcy5pdGVtcykgKyBcIik8L3NwYW4+XCI7XG5cdFx0XHRcdH07XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5ncm91cElETG9va3VwcyA9IFtdO1xuXHRcdFx0XG5cdFx0XHRpZihncm91cEJ5KXtcblx0XHRcdFx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJjb2x1bW5DYWxjc1wiKSAmJiB0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1uQ2FsY3MgIT0gXCJ0YWJsZVwiICYmIHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPSBcImJvdGhcIil7XG5cdFx0XHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnJlbW92ZUNhbGNzKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJjb2x1bW5DYWxjc1wiKSAmJiB0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1uQ2FsY3MgIT0gXCJncm91cFwiKXtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR2YXIgY29scyA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRSZWFsQ29sdW1ucygpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbHMuZm9yRWFjaCgoY29sKSA9PiB7XG5cdFx0XHRcdFx0XHRpZihjb2wuZGVmaW5pdGlvbi50b3BDYWxjKXtcblx0XHRcdFx0XHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLmluaXRpYWxpemVUb3BSb3coKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYoY29sLmRlZmluaXRpb24uYm90dG9tQ2FsYyl7XG5cdFx0XHRcdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5pbml0aWFsaXplQm90dG9tUm93KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoIUFycmF5LmlzQXJyYXkoZ3JvdXBCeSkpe1xuXHRcdFx0XHRncm91cEJ5ID0gW2dyb3VwQnldO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRncm91cEJ5LmZvckVhY2goKGdyb3VwLCBpKSA9PiB7XG5cdFx0XHRcdHZhciBsb29rdXBGdW5jLCBjb2x1bW47XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0eXBlb2YgZ3JvdXAgPT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdFx0XHRsb29rdXBGdW5jID0gZ3JvdXA7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRjb2x1bW4gPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29sdW1uQnlGaWVsZChncm91cCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoY29sdW1uKXtcblx0XHRcdFx0XHRcdGxvb2t1cEZ1bmMgPSBmdW5jdGlvbihkYXRhKXtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRsb29rdXBGdW5jID0gZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBkYXRhW2dyb3VwXTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmdyb3VwSURMb29rdXBzLnB1c2goe1xuXHRcdFx0XHRcdGZpZWxkOiB0eXBlb2YgZ3JvdXAgPT09IFwiZnVuY3Rpb25cIiA/IGZhbHNlIDogZ3JvdXAsXG5cdFx0XHRcdFx0ZnVuYzpsb29rdXBGdW5jLFxuXHRcdFx0XHRcdHZhbHVlczp0aGlzLmFsbG93ZWRWYWx1ZXMgPyB0aGlzLmFsbG93ZWRWYWx1ZXNbaV0gOiBmYWxzZSxcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0aWYoc3RhcnRPcGVuKXtcblx0XHRcdFx0aWYoIUFycmF5LmlzQXJyYXkoc3RhcnRPcGVuKSl7XG5cdFx0XHRcdFx0c3RhcnRPcGVuID0gW3N0YXJ0T3Blbl07XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHN0YXJ0T3Blbi5mb3JFYWNoKChsZXZlbCkgPT4ge1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuc3RhcnRPcGVuID0gc3RhcnRPcGVuO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihncm91cEhlYWRlcil7XG5cdFx0XHRcdHRoaXMuaGVhZGVyR2VuZXJhdG9yID0gQXJyYXkuaXNBcnJheShncm91cEhlYWRlcikgPyBncm91cEhlYWRlciA6IFtncm91cEhlYWRlcl07XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5ncm91cExpc3QgPSBbXTtcblx0XHRcdHRoaXMuZ3JvdXBzID0ge307XG5cdFx0fVxuXHR9XG5cdFxuXHRyb3dTYW1wbGUocm93cywgcHJldlZhbHVlKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSl7XG5cdFx0XHR2YXIgZ3JvdXAgPSB0aGlzLmdldEdyb3VwcyhmYWxzZSlbMF07XG5cdFx0XHRcblx0XHRcdHByZXZWYWx1ZS5wdXNoKGdyb3VwLmdldFJvd3MoZmFsc2UpWzBdKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHByZXZWYWx1ZTtcblx0fVxuXHRcblx0dmlydHVhbFJlbmRlckZpbGwoKXtcblx0XHR2YXIgZWwgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIudGFibGVFbGVtZW50O1xuXHRcdHZhciByb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFZpc2libGVSb3dzKCk7XG5cdFx0XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkpe1xuXHRcdFx0cm93cyA9IHJvd3MuZmlsdGVyKChyb3cpID0+IHtcblx0XHRcdFx0cmV0dXJuIHJvdy50eXBlICE9PSBcImdyb3VwXCI7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0ZWwuc3R5bGUubWluV2lkdGggPSAhcm93cy5sZW5ndGggPyB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0V2lkdGgoKSArIFwicHhcIiA6IFwiXCI7XG5cdFx0fWVsc2Uge1xuXHRcdFx0cmV0dXJuIHJvd3M7XG5cdFx0fVxuXHR9XG5cdFxuXHRyb3dBZGRpbmdJbmRleChyb3csIGluZGV4LCB0b3Ape1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5KXtcblx0XHRcdHRoaXMuYXNzaWduUm93VG9Hcm91cChyb3cpO1xuXHRcdFx0XG5cdFx0XHR2YXIgZ3JvdXBSb3dzID0gcm93Lm1vZHVsZXMuZ3JvdXAucm93cztcblx0XHRcdFxuXHRcdFx0aWYoZ3JvdXBSb3dzLmxlbmd0aCA+IDEpe1xuXHRcdFx0XHRpZighaW5kZXggfHwgKGluZGV4ICYmIGdyb3VwUm93cy5pbmRleE9mKGluZGV4KSA9PSAtMSkpe1xuXHRcdFx0XHRcdGlmKHRvcCl7XG5cdFx0XHRcdFx0XHRpZihncm91cFJvd3NbMF0gIT09IHJvdyl7XG5cdFx0XHRcdFx0XHRcdGluZGV4ID0gZ3JvdXBSb3dzWzBdO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIubW92ZVJvd0luQXJyYXkocm93Lm1vZHVsZXMuZ3JvdXAucm93cywgcm93LCBpbmRleCwgIXRvcCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0aWYoZ3JvdXBSb3dzW2dyb3VwUm93cy5sZW5ndGggLTFdICE9PSByb3cpe1xuXHRcdFx0XHRcdFx0XHRpbmRleCA9IGdyb3VwUm93c1tncm91cFJvd3MubGVuZ3RoIC0xXTtcblx0XHRcdFx0XHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLm1vdmVSb3dJbkFycmF5KHJvdy5tb2R1bGVzLmdyb3VwLnJvd3MsIHJvdywgaW5kZXgsICF0b3ApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5tb3ZlUm93SW5BcnJheShyb3cubW9kdWxlcy5ncm91cC5yb3dzLCByb3csIGluZGV4LCAhdG9wKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRyZXR1cm4gaW5kZXg7XG5cdFx0fVxuXHR9XG5cdFxuXHR0cmFja0NoYW5nZXMoKXtcblx0XHR0aGlzLmRpc3BhdGNoKFwiZ3JvdXAtY2hhbmdlZFwiKTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIFRhYmxlIEZ1bmN0aW9ucyAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdHNldEdyb3VwQnkoZ3JvdXBzKXtcblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSA9IGdyb3Vwcztcblx0XHRcblx0XHRpZighdGhpcy5pbml0aWFsaXplZCl7XG5cdFx0XHR0aGlzLmluaXRpYWxpemUoKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jb25maWd1cmVHcm91cFNldHVwKCk7XG5cblx0XHRpZighZ3JvdXBzICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikgJiYgdGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzID09PSB0cnVlKXtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5yZWluaXRpYWxpemVDYWxjcygpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnJlZnJlc2hEYXRhKCk7XG5cdFx0XG5cdFx0dGhpcy50cmFja0NoYW5nZXMoKTtcblx0fVxuXHRcblx0c2V0R3JvdXBWYWx1ZXMoZ3JvdXBWYWx1ZXMpe1xuXHRcdHRoaXMudGFibGUub3B0aW9ucy5ncm91cFZhbHVlcyA9IGdyb3VwVmFsdWVzO1xuXHRcdHRoaXMuY29uZmlndXJlR3JvdXBTZXR1cCgpO1xuXHRcdHRoaXMucmVmcmVzaERhdGEoKTtcblx0XHRcblx0XHR0aGlzLnRyYWNrQ2hhbmdlcygpO1xuXHR9XG5cdFxuXHRzZXRHcm91cFN0YXJ0T3Blbih2YWx1ZXMpe1xuXHRcdHRoaXMudGFibGUub3B0aW9ucy5ncm91cFN0YXJ0T3BlbiA9IHZhbHVlcztcblx0XHR0aGlzLmNvbmZpZ3VyZUdyb3VwU2V0dXAoKTtcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSl7XG5cdFx0XHR0aGlzLnJlZnJlc2hEYXRhKCk7XG5cdFx0XHRcblx0XHRcdHRoaXMudHJhY2tDaGFuZ2VzKCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiR3JvdXBpbmcgVXBkYXRlIC0gY2FudCByZWZyZXNoIHZpZXcsIG5vIGdyb3VwcyBoYXZlIGJlZW4gc2V0XCIpO1xuXHRcdH1cblx0fVxuXHRcblx0c2V0R3JvdXBIZWFkZXIodmFsdWVzKXtcblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBIZWFkZXIgPSB2YWx1ZXM7XG5cdFx0dGhpcy5jb25maWd1cmVHcm91cFNldHVwKCk7XG5cdFx0XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkpe1xuXHRcdFx0dGhpcy5yZWZyZXNoRGF0YSgpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnRyYWNrQ2hhbmdlcygpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkdyb3VwaW5nIFVwZGF0ZSAtIGNhbnQgcmVmcmVzaCB2aWV3LCBubyBncm91cHMgaGF2ZSBiZWVuIHNldFwiKTtcblx0XHR9XG5cdH1cblx0XG5cdHVzZXJHZXRHcm91cHModmFsdWVzKXtcblx0XHRyZXR1cm4gdGhpcy5nZXRHcm91cHModHJ1ZSk7XG5cdH1cblx0XG5cdC8vIGdldCBncm91cGVkIHRhYmxlIGRhdGEgaW4gdGhlIHNhbWUgZm9ybWF0IGFzIGdldERhdGEoKVxuXHR1c2VyR2V0R3JvdXBlZERhdGEoKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkgPyB0aGlzLmdldEdyb3VwZWREYXRhKCkgOiB0aGlzLmdldERhdGEoKTtcblx0fVxuXHRcblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gQ29tcG9uZW50IEZ1bmN0aW9ucyAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRyb3dHZXRHcm91cChyb3cpe1xuXHRcdHJldHVybiByb3cubW9kdWxlcy5ncm91cCA/IHJvdy5tb2R1bGVzLmdyb3VwLmdldENvbXBvbmVudCgpIDogZmFsc2U7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBJbnRlcm5hbCBMb2dpYyAvLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRyb3dNb3ZpbmcoZnJvbSwgdG8sIGFmdGVyKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSl7XG5cdFx0XHRpZighYWZ0ZXIgJiYgdG8gaW5zdGFuY2VvZiBHcm91cCl7XG5cdFx0XHRcdHRvID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnByZXZEaXNwbGF5Um93KGZyb20pIHx8IHRvO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR2YXIgdG9Hcm91cCA9IHRvIGluc3RhbmNlb2YgR3JvdXAgPyB0byA6IHRvLm1vZHVsZXMuZ3JvdXA7XG5cdFx0XHR2YXIgZnJvbUdyb3VwID0gZnJvbSBpbnN0YW5jZW9mIEdyb3VwID8gZnJvbSA6IGZyb20ubW9kdWxlcy5ncm91cDtcblx0XHRcdFxuXHRcdFx0aWYodG9Hcm91cCA9PT0gZnJvbUdyb3VwKXtcblx0XHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLm1vdmVSb3dJbkFycmF5KHRvR3JvdXAucm93cywgZnJvbSwgdG8sIGFmdGVyKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYoZnJvbUdyb3VwKXtcblx0XHRcdFx0XHRmcm9tR3JvdXAucmVtb3ZlUm93KGZyb20pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHR0b0dyb3VwLmluc2VydFJvdyhmcm9tLCB0bywgYWZ0ZXIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0XG5cdHJvd0RlbGV0aW5nKHJvdyl7XG5cdFx0Ly9yZW1vdmUgZnJvbSBncm91cFxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5ICYmIHJvdy5tb2R1bGVzLmdyb3VwKXtcblx0XHRcdHJvdy5tb2R1bGVzLmdyb3VwLnJlbW92ZVJvdyhyb3cpO1xuXHRcdH1cblx0fVxuXHRcblx0cm93c1VwZGF0ZWQocm93KXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSl7XG5cdFx0XHR0aGlzLnVwZGF0ZUdyb3VwUm93cyh0cnVlKTtcblx0XHR9XHRcblx0fVxuXHRcblx0Y2VsbFVwZGF0ZWQoY2VsbCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkpe1xuXHRcdFx0dGhpcy5yZWFzc2lnblJvd1RvR3JvdXAoY2VsbC5yb3cpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9yZXR1cm4gYXBwcm9wcmlhdGUgcm93cyB3aXRoIGdyb3VwIGhlYWRlcnNcblx0Z2V0Um93cyhyb3dzKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLmdyb3VwSURMb29rdXBzLmxlbmd0aCl7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImRhdGFHcm91cGluZ1wiKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5nZW5lcmF0ZUdyb3Vwcyhyb3dzKTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy5zdWJzY3JpYmVkRXh0ZXJuYWwoXCJkYXRhR3JvdXBlZFwiKSl7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImRhdGFHcm91cGVkXCIsIHRoaXMuZ2V0R3JvdXBzKHRydWUpKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cmV0dXJuIHRoaXMudXBkYXRlR3JvdXBSb3dzKCk7XG5cdFx0XHRcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gcm93cy5zbGljZSgwKTtcblx0XHR9XG5cdH1cblx0XG5cdGdldEdyb3Vwcyhjb21wb25lbnQpe1xuXHRcdHZhciBncm91cENvbXBvbmVudHMgPSBbXTtcblx0XHRcblx0XHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGdyb3VwKXtcblx0XHRcdGdyb3VwQ29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCA/IGdyb3VwLmdldENvbXBvbmVudCgpIDogZ3JvdXApO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBncm91cENvbXBvbmVudHM7XG5cdH1cblx0XG5cdGdldENoaWxkR3JvdXBzKGdyb3VwKXtcblx0XHR2YXIgZ3JvdXBDb21wb25lbnRzID0gW107XG5cdFx0XG5cdFx0aWYoIWdyb3VwKXtcblx0XHRcdGdyb3VwID0gdGhpcztcblx0XHR9XG5cdFx0XG5cdFx0Z3JvdXAuZ3JvdXBMaXN0LmZvckVhY2goKGNoaWxkKSA9PiB7XG5cdFx0XHRpZihjaGlsZC5ncm91cExpc3QubGVuZ3RoKXtcblx0XHRcdFx0Z3JvdXBDb21wb25lbnRzID0gZ3JvdXBDb21wb25lbnRzLmNvbmNhdCh0aGlzLmdldENoaWxkR3JvdXBzKGNoaWxkKSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGdyb3VwQ29tcG9uZW50cy5wdXNoKGNoaWxkKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gZ3JvdXBDb21wb25lbnRzO1xuXHR9XG5cdFxuXHR3aXBlKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkpe1xuXHRcdFx0dGhpcy5ncm91cExpc3QuZm9yRWFjaChmdW5jdGlvbihncm91cCl7XG5cdFx0XHRcdGdyb3VwLndpcGUoKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmdyb3VwTGlzdCA9IFtdO1xuXHRcdFx0dGhpcy5ncm91cHMgPSB7fTtcblx0XHR9XG5cdH1cblx0XG5cdHB1bGxHcm91cExpc3REYXRhKGdyb3VwTGlzdCkge1xuXHRcdHZhciBncm91cExpc3REYXRhID0gW107XG5cdFx0XG5cdFx0Z3JvdXBMaXN0LmZvckVhY2goKGdyb3VwKSA9PiB7XG5cdFx0XHR2YXIgZ3JvdXBIZWFkZXIgPSB7fTtcblx0XHRcdGdyb3VwSGVhZGVyLmxldmVsID0gMDtcblx0XHRcdGdyb3VwSGVhZGVyLnJvd0NvdW50ID0gMDtcblx0XHRcdGdyb3VwSGVhZGVyLmhlYWRlckNvbnRlbnQgPSBcIlwiO1xuXHRcdFx0dmFyIGNoaWxkRGF0YSA9IFtdO1xuXHRcdFx0XG5cdFx0XHRpZiAoZ3JvdXAuaGFzU3ViR3JvdXBzKSB7XG5cdFx0XHRcdGNoaWxkRGF0YSA9IHRoaXMucHVsbEdyb3VwTGlzdERhdGEoZ3JvdXAuZ3JvdXBMaXN0KTtcblx0XHRcdFx0XG5cdFx0XHRcdGdyb3VwSGVhZGVyLmxldmVsID0gZ3JvdXAubGV2ZWw7XG5cdFx0XHRcdGdyb3VwSGVhZGVyLnJvd0NvdW50ID0gY2hpbGREYXRhLmxlbmd0aCAtIGdyb3VwLmdyb3VwTGlzdC5sZW5ndGg7IC8vIGRhdGEgbGVuZ3RoIG1pbnVzIG51bWJlciBvZiBzdWItaGVhZGVyc1xuXHRcdFx0XHRncm91cEhlYWRlci5oZWFkZXJDb250ZW50ID0gZ3JvdXAuZ2VuZXJhdG9yKGdyb3VwLmtleSwgZ3JvdXBIZWFkZXIucm93Q291bnQsIGdyb3VwLnJvd3MsIGdyb3VwKTtcblx0XHRcdFx0XG5cdFx0XHRcdGdyb3VwTGlzdERhdGEucHVzaChncm91cEhlYWRlcik7XG5cdFx0XHRcdGdyb3VwTGlzdERhdGEgPSBncm91cExpc3REYXRhLmNvbmNhdChjaGlsZERhdGEpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0Z3JvdXBIZWFkZXIubGV2ZWwgPSBncm91cC5sZXZlbDtcblx0XHRcdFx0Z3JvdXBIZWFkZXIuaGVhZGVyQ29udGVudCA9IGdyb3VwLmdlbmVyYXRvcihncm91cC5rZXksIGdyb3VwLnJvd3MubGVuZ3RoLCBncm91cC5yb3dzLCBncm91cCk7XG5cdFx0XHRcdGdyb3VwSGVhZGVyLnJvd0NvdW50ID0gZ3JvdXAuZ2V0Um93cygpLmxlbmd0aDtcblx0XHRcdFx0XG5cdFx0XHRcdGdyb3VwTGlzdERhdGEucHVzaChncm91cEhlYWRlcik7XG5cdFx0XHRcdFxuXHRcdFx0XHRncm91cC5nZXRSb3dzKCkuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdFx0Z3JvdXBMaXN0RGF0YS5wdXNoKHJvdy5nZXREYXRhKFwiZGF0YVwiKSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBncm91cExpc3REYXRhO1xuXHR9XG5cdFxuXHRnZXRHcm91cGVkRGF0YSgpe1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLnB1bGxHcm91cExpc3REYXRhKHRoaXMuZ3JvdXBMaXN0KTtcblx0fVxuXHRcblx0Z2V0Um93R3JvdXAocm93KXtcblx0XHR2YXIgbWF0Y2ggPSBmYWxzZTtcblx0XHRcblx0XHRpZih0aGlzLm9wdGlvbnMoXCJkYXRhVHJlZVwiKSl7XG5cdFx0XHRyb3cgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuZ2V0VHJlZVBhcmVudFJvb3Qocm93KTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5ncm91cExpc3QuZm9yRWFjaCgoZ3JvdXApID0+IHtcblx0XHRcdHZhciByZXN1bHQgPSBncm91cC5nZXRSb3dHcm91cChyb3cpO1xuXHRcdFx0XG5cdFx0XHRpZihyZXN1bHQpe1xuXHRcdFx0XHRtYXRjaCA9IHJlc3VsdDtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gbWF0Y2g7XG5cdH1cblx0XG5cdGNvdW50R3JvdXBzKCl7XG5cdFx0cmV0dXJuIHRoaXMuZ3JvdXBMaXN0Lmxlbmd0aDtcblx0fVxuXHRcblx0Z2VuZXJhdGVHcm91cHMocm93cyl7XG5cdFx0dmFyIG9sZEdyb3VwcyA9IHRoaXMuZ3JvdXBzO1xuXHRcdFxuXHRcdHRoaXMuZ3JvdXBzID0ge307XG5cdFx0dGhpcy5ncm91cExpc3QgPSBbXTtcblx0XHRcblx0XHRpZih0aGlzLmFsbG93ZWRWYWx1ZXMgJiYgdGhpcy5hbGxvd2VkVmFsdWVzWzBdKXtcblx0XHRcdHRoaXMuYWxsb3dlZFZhbHVlc1swXS5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLmNyZWF0ZUdyb3VwKHZhbHVlLCAwLCBvbGRHcm91cHMpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdHRoaXMuYXNzaWduUm93VG9FeGlzdGluZ0dyb3VwKHJvdywgb2xkR3JvdXBzKTtcblx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdHRoaXMuYXNzaWduUm93VG9Hcm91cChyb3csIG9sZEdyb3Vwcyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0T2JqZWN0LnZhbHVlcyhvbGRHcm91cHMpLmZvckVhY2goKGdyb3VwKSA9PiB7XG5cdFx0XHRncm91cC53aXBlKHRydWUpO1xuXHRcdH0pO1x0XG5cdH1cblx0XG5cdFxuXHRjcmVhdGVHcm91cChncm91cElELCBsZXZlbCwgb2xkR3JvdXBzKXtcblx0XHR2YXIgZ3JvdXBLZXkgPSBsZXZlbCArIFwiX1wiICsgZ3JvdXBJRCxcblx0XHRncm91cDtcblx0XHRcblx0XHRvbGRHcm91cHMgPSBvbGRHcm91cHMgfHwgW107XG5cdFx0XG5cdFx0Z3JvdXAgPSBuZXcgR3JvdXAodGhpcywgZmFsc2UsIGxldmVsLCBncm91cElELCB0aGlzLmdyb3VwSURMb29rdXBzWzBdLmZpZWxkLCB0aGlzLmhlYWRlckdlbmVyYXRvclswXSwgb2xkR3JvdXBzW2dyb3VwS2V5XSk7XG5cdFx0XG5cdFx0dGhpcy5ncm91cHNbZ3JvdXBLZXldID0gZ3JvdXA7XG5cdFx0dGhpcy5ncm91cExpc3QucHVzaChncm91cCk7XG5cdH1cblx0XG5cdGFzc2lnblJvd1RvRXhpc3RpbmdHcm91cChyb3csIG9sZEdyb3Vwcyl7XG5cdFx0dmFyIGdyb3VwSUQgPSB0aGlzLmdyb3VwSURMb29rdXBzWzBdLmZ1bmMocm93LmdldERhdGEoKSksXG5cdFx0Z3JvdXBLZXkgPSBcIjBfXCIgKyBncm91cElEO1xuXHRcdFxuXHRcdGlmKHRoaXMuZ3JvdXBzW2dyb3VwS2V5XSl7XG5cdFx0XHR0aGlzLmdyb3Vwc1tncm91cEtleV0uYWRkUm93KHJvdyk7XG5cdFx0fVxuXHR9XG5cdFxuXHRhc3NpZ25Sb3dUb0dyb3VwKHJvdywgb2xkR3JvdXBzKXtcblx0XHR2YXIgZ3JvdXBJRCA9IHRoaXMuZ3JvdXBJRExvb2t1cHNbMF0uZnVuYyhyb3cuZ2V0RGF0YSgpKSxcblx0XHRuZXdHcm91cE5lZWRlZCA9ICF0aGlzLmdyb3Vwc1tcIjBfXCIgKyBncm91cElEXTtcblx0XHRcblx0XHRpZihuZXdHcm91cE5lZWRlZCl7XG5cdFx0XHR0aGlzLmNyZWF0ZUdyb3VwKGdyb3VwSUQsIDAsIG9sZEdyb3Vwcyk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZ3JvdXBzW1wiMF9cIiArIGdyb3VwSURdLmFkZFJvdyhyb3cpO1xuXHRcdFxuXHRcdHJldHVybiAhbmV3R3JvdXBOZWVkZWQ7XG5cdH1cblx0XG5cdHJlYXNzaWduUm93VG9Hcm91cChyb3cpe1xuXHRcdGlmKHJvdy50eXBlID09PSBcInJvd1wiKXtcblx0XHRcdHZhciBvbGRSb3dHcm91cCA9IHJvdy5tb2R1bGVzLmdyb3VwLFxuXHRcdFx0b2xkR3JvdXBQYXRoID0gb2xkUm93R3JvdXAuZ2V0UGF0aCgpLFxuXHRcdFx0bmV3R3JvdXBQYXRoID0gdGhpcy5nZXRFeHBlY3RlZFBhdGgocm93KSxcblx0XHRcdHNhbWVQYXRoO1xuXHRcdFx0XG5cdFx0XHQvLyBmaWd1cmUgb3V0IGlmIG5ldyBncm91cCBwYXRoIGlzIHRoZSBzYW1lIGFzIG9sZCBncm91cCBwYXRoXG5cdFx0XHRzYW1lUGF0aCA9IChvbGRHcm91cFBhdGgubGVuZ3RoID09IG5ld0dyb3VwUGF0aC5sZW5ndGgpICYmIG9sZEdyb3VwUGF0aC5ldmVyeSgoZWxlbWVudCwgaW5kZXgpID0+IHtcblx0XHRcdFx0cmV0dXJuIGVsZW1lbnQgPT09IG5ld0dyb3VwUGF0aFtpbmRleF07XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gcmVmcmVzaCBpZiB0aGV5IG5ldyBwYXRoIGFuZCBvbGQgcGF0aCBhcmVuJ3QgdGhlIHNhbWUgKGFrYSB0aGUgcm93J3MgZ3JvdXBpbmdzIGhhdmUgY2hhbmdlZClcblx0XHRcdGlmKCFzYW1lUGF0aCkge1xuXHRcdFx0XHRvbGRSb3dHcm91cC5yZW1vdmVSb3cocm93KTtcblx0XHRcdFx0dGhpcy5hc3NpZ25Sb3dUb0dyb3VwKHJvdywgdGhpcy5ncm91cHMpO1xuXHRcdFx0XHR0aGlzLnJlZnJlc2hEYXRhKHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0Z2V0RXhwZWN0ZWRQYXRoKHJvdykge1xuXHRcdHZhciBncm91cFBhdGggPSBbXSwgcm93RGF0YSA9IHJvdy5nZXREYXRhKCk7XG5cdFx0XG5cdFx0dGhpcy5ncm91cElETG9va3Vwcy5mb3JFYWNoKChncm91cElkKSA9PiB7XG5cdFx0XHRncm91cFBhdGgucHVzaChncm91cElkLmZ1bmMocm93RGF0YSkpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBncm91cFBhdGg7XG5cdH1cblx0XG5cdHVwZGF0ZUdyb3VwUm93cyhmb3JjZSl7XG5cdFx0dmFyIG91dHB1dCA9IFtdO1xuXG5cdFx0aWYoIXRoaXMuYmxvY2tSZWRyYXcpe1xuXHRcdFx0dGhpcy5ncm91cExpc3QuZm9yRWFjaCgoZ3JvdXApID0+IHtcblx0XHRcdFx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdChncm91cC5nZXRIZWFkZXJzQW5kUm93cygpKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRpZihmb3JjZSl7XG5cdFx0XHRcdHRoaXMucmVmcmVzaERhdGEodHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblx0XG5cdHNjcm9sbEhlYWRlcnMobGVmdCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkpe1xuXHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJlbmRlckhvcml6b250YWwgPT09IFwidmlydHVhbFwiKXtcblx0XHRcdFx0bGVmdCAtPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIucmVuZGVyZXIudkRvbVBhZExlZnQ7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGxlZnQgPSBsZWZ0ICsgXCJweFwiO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKChncm91cCkgPT4ge1xuXHRcdFx0XHRncm91cC5zY3JvbGxIZWFkZXIobGVmdCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0XG5cdHJlbW92ZUdyb3VwKGdyb3VwKXtcblx0XHR2YXIgZ3JvdXBLZXkgPSBncm91cC5sZXZlbCArIFwiX1wiICsgZ3JvdXAua2V5LFxuXHRcdGluZGV4O1xuXHRcdFxuXHRcdGlmKHRoaXMuZ3JvdXBzW2dyb3VwS2V5XSl7XG5cdFx0XHRkZWxldGUgdGhpcy5ncm91cHNbZ3JvdXBLZXldO1xuXHRcdFx0XG5cdFx0XHRpbmRleCA9IHRoaXMuZ3JvdXBMaXN0LmluZGV4T2YoZ3JvdXApO1xuXHRcdFx0XG5cdFx0XHRpZihpbmRleCA+IC0xKXtcblx0XHRcdFx0dGhpcy5ncm91cExpc3Quc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGNoZWNrQmFzaWNNb2RlR3JvdXBIZWFkZXJXaWR0aCgpe1xuXHRcdHZhciBlbGVtZW50ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnRhYmxlRWxlbWVudCxcblx0XHRvbmx5R3JvdXBIZWFkZXJzID0gdHJ1ZTtcblx0XHRcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5mb3JFYWNoKChyb3csIGluZGV4KSA9Pntcblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5zdHlsZVJvdyhyb3csIGluZGV4KTtcblx0XHRcdGVsZW1lbnQuYXBwZW5kQ2hpbGQocm93LmdldEVsZW1lbnQoKSk7XG5cdFx0XHRyb3cuaW5pdGlhbGl6ZSh0cnVlKTtcblx0XHRcdFxuXHRcdFx0aWYocm93LnR5cGUgIT09IFwiZ3JvdXBcIil7XG5cdFx0XHRcdG9ubHlHcm91cEhlYWRlcnMgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHRpZihvbmx5R3JvdXBIZWFkZXJzKXtcblx0XHRcdGVsZW1lbnQuc3R5bGUubWluV2lkdGggPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0V2lkdGgoKSArIFwicHhcIjtcblx0XHR9ZWxzZSB7XG5cdFx0XHRlbGVtZW50LnN0eWxlLm1pbldpZHRoID0gXCJcIjtcblx0XHR9XG5cdH1cblx0XG59XG5cbnZhciBkZWZhdWx0VW5kb2VycyA9IHtcblx0Y2VsbEVkaXQ6IGZ1bmN0aW9uKGFjdGlvbil7XG5cdFx0YWN0aW9uLmNvbXBvbmVudC5zZXRWYWx1ZVByb2Nlc3NEYXRhKGFjdGlvbi5kYXRhLm9sZFZhbHVlKTtcblx0XHRhY3Rpb24uY29tcG9uZW50LmNlbGxSZW5kZXJlZCgpO1xuXHR9LFxuXG5cdHJvd0FkZDogZnVuY3Rpb24oYWN0aW9uKXtcblx0XHRhY3Rpb24uY29tcG9uZW50LmRlbGV0ZUFjdHVhbCgpO1xuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmNoZWNrUGxhY2Vob2xkZXIoKTtcblx0fSxcblxuXHRyb3dEZWxldGU6IGZ1bmN0aW9uKGFjdGlvbil7XG5cdFx0dmFyIG5ld1JvdyA9IHRoaXMudGFibGUucm93TWFuYWdlci5hZGRSb3dBY3R1YWwoYWN0aW9uLmRhdGEuZGF0YSwgYWN0aW9uLmRhdGEucG9zLCBhY3Rpb24uZGF0YS5pbmRleCk7XG5cblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSl7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLnVwZGF0ZUdyb3VwUm93cyh0cnVlKTtcblx0XHR9XG5cblx0XHR0aGlzLl9yZWJpbmRSb3coYWN0aW9uLmNvbXBvbmVudCwgbmV3Um93KTtcblxuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5jaGVja1BsYWNlaG9sZGVyKCk7XG5cdH0sXG5cblx0cm93TW92ZTogZnVuY3Rpb24oYWN0aW9uKXtcblx0XHR2YXIgYWZ0ZXIgPSAoYWN0aW9uLmRhdGEucG9zRnJvbSAgLSBhY3Rpb24uZGF0YS5wb3NUbykgPiAwO1xuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLm1vdmVSb3dBY3R1YWwoYWN0aW9uLmNvbXBvbmVudCwgdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd0Zyb21Qb3NpdGlvbihhY3Rpb24uZGF0YS5wb3NGcm9tKSwgYWZ0ZXIpO1xuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlZ2VuZXJhdGVSb3dQb3NpdGlvbnMoKTtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVSZW5kZXJJblBvc2l0aW9uKCk7XG5cdH0sXG59O1xuXG52YXIgZGVmYXVsdFJlZG9lcnMgPSB7XG5cdGNlbGxFZGl0OiBmdW5jdGlvbihhY3Rpb24pe1xuXHRcdGFjdGlvbi5jb21wb25lbnQuc2V0VmFsdWVQcm9jZXNzRGF0YShhY3Rpb24uZGF0YS5uZXdWYWx1ZSk7XG5cdFx0YWN0aW9uLmNvbXBvbmVudC5jZWxsUmVuZGVyZWQoKTtcblx0fSxcblxuXHRyb3dBZGQ6IGZ1bmN0aW9uKGFjdGlvbil7XG5cdFx0dmFyIG5ld1JvdyA9IHRoaXMudGFibGUucm93TWFuYWdlci5hZGRSb3dBY3R1YWwoYWN0aW9uLmRhdGEuZGF0YSwgYWN0aW9uLmRhdGEucG9zLCBhY3Rpb24uZGF0YS5pbmRleCk7XG5cblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSl7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLnVwZGF0ZUdyb3VwUm93cyh0cnVlKTtcblx0XHR9XG5cblx0XHR0aGlzLl9yZWJpbmRSb3coYWN0aW9uLmNvbXBvbmVudCwgbmV3Um93KTtcblxuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5jaGVja1BsYWNlaG9sZGVyKCk7XG5cdH0sXG5cblx0cm93RGVsZXRlOmZ1bmN0aW9uKGFjdGlvbil7XG5cdFx0YWN0aW9uLmNvbXBvbmVudC5kZWxldGVBY3R1YWwoKTtcblxuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5jaGVja1BsYWNlaG9sZGVyKCk7XG5cdH0sXG5cblx0cm93TW92ZTogZnVuY3Rpb24oYWN0aW9uKXtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIubW92ZVJvd0FjdHVhbChhY3Rpb24uY29tcG9uZW50LCB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0Um93RnJvbVBvc2l0aW9uKGFjdGlvbi5kYXRhLnBvc1RvKSwgYWN0aW9uLmRhdGEuYWZ0ZXIpO1xuXHRcdFxuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZWdlbmVyYXRlUm93UG9zaXRpb25zKCk7XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHR9LFxufTtcblxudmFyIGJpbmRpbmdzJDEgPSB7XHJcblx0dW5kbzpbXCJjdHJsICsgOTBcIiwgXCJtZXRhICsgOTBcIl0sXHJcblx0cmVkbzpbXCJjdHJsICsgODlcIiwgXCJtZXRhICsgODlcIl0sXHJcbn07XG5cbnZhciBhY3Rpb25zJDEgPSB7XHJcblx0dW5kbzpmdW5jdGlvbihlKXtcclxuXHRcdHZhciBjZWxsID0gZmFsc2U7XHJcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuaGlzdG9yeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImhpc3RvcnlcIikgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJlZGl0XCIpKXtcclxuXHJcblx0XHRcdGNlbGwgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbDtcclxuXHJcblx0XHRcdGlmKCFjZWxsKXtcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmhpc3RvcnkudW5kbygpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0cmVkbzpmdW5jdGlvbihlKXtcclxuXHRcdHZhciBjZWxsID0gZmFsc2U7XHJcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuaGlzdG9yeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImhpc3RvcnlcIikgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJlZGl0XCIpKXtcclxuXHJcblx0XHRcdGNlbGwgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbDtcclxuXHJcblx0XHRcdGlmKCFjZWxsKXtcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmhpc3RvcnkucmVkbygpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSxcclxufTtcblxudmFyIGV4dGVuc2lvbnMkMyA9IHtcclxuXHRrZXliaW5kaW5nczp7XHJcblx0XHRiaW5kaW5nczpiaW5kaW5ncyQxLFxyXG5cdFx0YWN0aW9uczphY3Rpb25zJDFcclxuXHR9LFxyXG59O1xuXG5jbGFzcyBIaXN0b3J5IGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJoaXN0b3J5XCI7XG5cdHN0YXRpYyBtb2R1bGVFeHRlbnNpb25zID0gZXh0ZW5zaW9ucyQzO1xuXG5cdC8vbG9hZCBkZWZhdWx0c1xuXHRzdGF0aWMgdW5kb2VycyA9IGRlZmF1bHRVbmRvZXJzO1xuXHRzdGF0aWMgcmVkb2VycyA9IGRlZmF1bHRSZWRvZXJzO1xuXG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cblx0XHR0aGlzLmhpc3RvcnkgPSBbXTtcblx0XHR0aGlzLmluZGV4ID0gLTE7XG5cblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJoaXN0b3J5XCIsIGZhbHNlKTsgLy9lbmFibGUgZWRpdCBoaXN0b3J5XG5cdH1cblxuXHRpbml0aWFsaXplKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmhpc3Rvcnkpe1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLXZhbHVlLXVwZGF0ZWRcIiwgdGhpcy5jZWxsVXBkYXRlZC5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC1kZWxldGVcIiwgdGhpcy5jbGVhckNvbXBvbmVudEhpc3RvcnkuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1kZWxldGVcIiwgdGhpcy5yb3dEZWxldGVkLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3dzLXdpcGVcIiwgdGhpcy5jbGVhci5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWFkZGVkXCIsIHRoaXMucm93QWRkZWQuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1tb3ZlXCIsIHRoaXMucm93TW92ZWQuYmluZCh0aGlzKSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJ1bmRvXCIsIHRoaXMudW5kby5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInJlZG9cIiwgdGhpcy5yZWRvLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0SGlzdG9yeVVuZG9TaXplXCIsIHRoaXMuZ2V0SGlzdG9yeVVuZG9TaXplLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0SGlzdG9yeVJlZG9TaXplXCIsIHRoaXMuZ2V0SGlzdG9yeVJlZG9TaXplLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiY2xlYXJIaXN0b3J5XCIsIHRoaXMuY2xlYXIuYmluZCh0aGlzKSk7XG5cdH1cblxuXHRyb3dNb3ZlZChmcm9tLCB0bywgYWZ0ZXIpe1xuXHRcdHRoaXMuYWN0aW9uKFwicm93TW92ZVwiLCBmcm9tLCB7cG9zRnJvbTpmcm9tLmdldFBvc2l0aW9uKCksIHBvc1RvOnRvLmdldFBvc2l0aW9uKCksIHRvOnRvLCBhZnRlcjphZnRlcn0pO1xuXHR9XG5cblx0cm93QWRkZWQocm93LCBkYXRhLCBwb3MsIGluZGV4KXtcblx0XHR0aGlzLmFjdGlvbihcInJvd0FkZFwiLCByb3csIHtkYXRhOmRhdGEsIHBvczpwb3MsIGluZGV4OmluZGV4fSk7XG5cdH1cblxuXHRyb3dEZWxldGVkKHJvdyl7XG5cdFx0dmFyIGluZGV4LCByb3dzO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkpe1xuXG5cdFx0XHRyb3dzID0gcm93LmdldENvbXBvbmVudCgpLmdldEdyb3VwKCkuX2dldFNlbGYoKS5yb3dzO1xuXHRcdFx0aW5kZXggPSByb3dzLmluZGV4T2Yocm93KTtcblxuXHRcdFx0aWYoaW5kZXgpe1xuXHRcdFx0XHRpbmRleCA9IHJvd3NbaW5kZXgtMV07XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aW5kZXggPSByb3cudGFibGUucm93TWFuYWdlci5nZXRSb3dJbmRleChyb3cpO1xuXG5cdFx0XHRpZihpbmRleCl7XG5cdFx0XHRcdGluZGV4ID0gcm93LnRhYmxlLnJvd01hbmFnZXIucm93c1tpbmRleC0xXTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLmFjdGlvbihcInJvd0RlbGV0ZVwiLCByb3csIHtkYXRhOnJvdy5nZXREYXRhKCksIHBvczohaW5kZXgsIGluZGV4OmluZGV4fSk7XG5cdH1cblxuXHRjZWxsVXBkYXRlZChjZWxsKXtcblx0XHR0aGlzLmFjdGlvbihcImNlbGxFZGl0XCIsIGNlbGwsIHtvbGRWYWx1ZTpjZWxsLm9sZFZhbHVlLCBuZXdWYWx1ZTpjZWxsLnZhbHVlfSk7XG5cdH1cblxuXHRjbGVhcigpe1xuXHRcdHRoaXMuaGlzdG9yeSA9IFtdO1xuXHRcdHRoaXMuaW5kZXggPSAtMTtcblx0fVxuXG5cdGFjdGlvbih0eXBlLCBjb21wb25lbnQsIGRhdGEpe1xuXHRcdHRoaXMuaGlzdG9yeSA9IHRoaXMuaGlzdG9yeS5zbGljZSgwLCB0aGlzLmluZGV4ICsgMSk7XG5cblx0XHR0aGlzLmhpc3RvcnkucHVzaCh7XG5cdFx0XHR0eXBlOnR5cGUsXG5cdFx0XHRjb21wb25lbnQ6Y29tcG9uZW50LFxuXHRcdFx0ZGF0YTpkYXRhLFxuXHRcdH0pO1xuXG5cdFx0dGhpcy5pbmRleCArKztcblx0fVxuXG5cdGdldEhpc3RvcnlVbmRvU2l6ZSgpe1xuXHRcdHJldHVybiB0aGlzLmluZGV4ICsgMTtcblx0fVxuXG5cdGdldEhpc3RvcnlSZWRvU2l6ZSgpe1xuXHRcdHJldHVybiB0aGlzLmhpc3RvcnkubGVuZ3RoIC0gKHRoaXMuaW5kZXggKyAxKTtcblx0fVxuXG5cdGNsZWFyQ29tcG9uZW50SGlzdG9yeShjb21wb25lbnQpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMuaGlzdG9yeS5maW5kSW5kZXgoZnVuY3Rpb24oaXRlbSl7XG5cdFx0XHRyZXR1cm4gaXRlbS5jb21wb25lbnQgPT09IGNvbXBvbmVudDtcblx0XHR9KTtcblxuXHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0dGhpcy5oaXN0b3J5LnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRpZihpbmRleCA8PSB0aGlzLmluZGV4KXtcblx0XHRcdFx0dGhpcy5pbmRleC0tO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmNsZWFyQ29tcG9uZW50SGlzdG9yeShjb21wb25lbnQpO1xuXHRcdH1cblx0fVxuXG5cdHVuZG8oKXtcblx0XHRpZih0aGlzLmluZGV4ID4gLTEpe1xuXHRcdFx0bGV0IGFjdGlvbiA9IHRoaXMuaGlzdG9yeVt0aGlzLmluZGV4XTtcblxuXHRcdFx0SGlzdG9yeS51bmRvZXJzW2FjdGlvbi50eXBlXS5jYWxsKHRoaXMsIGFjdGlvbik7XG5cblx0XHRcdHRoaXMuaW5kZXgtLTtcblxuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiaGlzdG9yeVVuZG9cIiwgYWN0aW9uLnR5cGUsIGFjdGlvbi5jb21wb25lbnQuZ2V0Q29tcG9uZW50KCksIGFjdGlvbi5kYXRhKTtcblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKHRoaXMub3B0aW9ucyhcImhpc3RvcnlcIikgPyBcIkhpc3RvcnkgVW5kbyBFcnJvciAtIE5vIG1vcmUgaGlzdG9yeSB0byB1bmRvXCIgOiBcIkhpc3RvcnkgbW9kdWxlIG5vdCBlbmFibGVkXCIpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdHJlZG8oKXtcblx0XHRpZih0aGlzLmhpc3RvcnkubGVuZ3RoLTEgPiB0aGlzLmluZGV4KXtcblxuXHRcdFx0dGhpcy5pbmRleCsrO1xuXG5cdFx0XHRsZXQgYWN0aW9uID0gdGhpcy5oaXN0b3J5W3RoaXMuaW5kZXhdO1xuXG5cdFx0XHRIaXN0b3J5LnJlZG9lcnNbYWN0aW9uLnR5cGVdLmNhbGwodGhpcywgYWN0aW9uKTtcblxuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiaGlzdG9yeVJlZG9cIiwgYWN0aW9uLnR5cGUsIGFjdGlvbi5jb21wb25lbnQuZ2V0Q29tcG9uZW50KCksIGFjdGlvbi5kYXRhKTtcblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKHRoaXMub3B0aW9ucyhcImhpc3RvcnlcIikgPyBcIkhpc3RvcnkgUmVkbyBFcnJvciAtIE5vIG1vcmUgaGlzdG9yeSB0byByZWRvXCIgOiBcIkhpc3RvcnkgbW9kdWxlIG5vdCBlbmFibGVkXCIpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdC8vcmViaW5kIHJvd3MgdG8gbmV3IGVsZW1lbnQgYWZ0ZXIgZGVsZXRpb25cblx0X3JlYmluZFJvdyhvbGRSb3csIG5ld1Jvdyl7XG5cdFx0dGhpcy5oaXN0b3J5LmZvckVhY2goZnVuY3Rpb24oYWN0aW9uKXtcblx0XHRcdGlmKGFjdGlvbi5jb21wb25lbnQgaW5zdGFuY2VvZiBSb3cpe1xuXHRcdFx0XHRpZihhY3Rpb24uY29tcG9uZW50ID09PSBvbGRSb3cpe1xuXHRcdFx0XHRcdGFjdGlvbi5jb21wb25lbnQgPSBuZXdSb3c7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIGlmKGFjdGlvbi5jb21wb25lbnQgaW5zdGFuY2VvZiBDZWxsKXtcblx0XHRcdFx0aWYoYWN0aW9uLmNvbXBvbmVudC5yb3cgPT09IG9sZFJvdyl7XG5cdFx0XHRcdFx0dmFyIGZpZWxkID0gYWN0aW9uLmNvbXBvbmVudC5jb2x1bW4uZ2V0RmllbGQoKTtcblxuXHRcdFx0XHRcdGlmKGZpZWxkKXtcblx0XHRcdFx0XHRcdGFjdGlvbi5jb21wb25lbnQgPSBuZXdSb3cuZ2V0Q2VsbChmaWVsZCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxufVxuXG5jbGFzcyBIdG1sVGFibGVJbXBvcnQgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcImh0bWxUYWJsZUltcG9ydFwiO1xuXG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cblx0XHR0aGlzLmZpZWxkSW5kZXggPSBbXTtcblx0XHR0aGlzLmhhc0luZGV4ID0gZmFsc2U7XG5cdH1cblxuXHRpbml0aWFsaXplKCl7XG5cdFx0dGhpcy50YWJsZUVsZW1lbnRDaGVjaygpO1xuXHR9XG5cblx0dGFibGVFbGVtZW50Q2hlY2soKXtcblx0XHRpZih0aGlzLnRhYmxlLm9yaWdpbmFsRWxlbWVudCAmJiB0aGlzLnRhYmxlLm9yaWdpbmFsRWxlbWVudC50YWdOYW1lID09PSBcIlRBQkxFXCIpe1xuXHRcdFx0aWYodGhpcy50YWJsZS5vcmlnaW5hbEVsZW1lbnQuY2hpbGROb2Rlcy5sZW5ndGgpe1xuXHRcdFx0XHR0aGlzLnBhcnNlVGFibGUoKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiVW5hYmxlIHRvIHBhcnNlIGRhdGEgZnJvbSBlbXB0eSB0YWJsZSB0YWcsIFRhYnVsYXRvciBzaG91bGQgYmUgaW5pdGlhbGl6ZWQgb24gYSBkaXYgdGFnIHVubGVzcyBpbXBvcnRpbmcgZGF0YSBmcm9tIGEgdGFibGUgZWxlbWVudC5cIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cGFyc2VUYWJsZSgpe1xuXHRcdHZhciBlbGVtZW50ID0gdGhpcy50YWJsZS5vcmlnaW5hbEVsZW1lbnQsXG5cdFx0b3B0aW9ucyA9IHRoaXMudGFibGUub3B0aW9ucyxcblx0XHRoZWFkZXJzID0gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRoXCIpLFxuXHRcdHJvd3MgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGJvZHlcIilbMF0sXG5cdFx0ZGF0YSA9IFtdO1xuXG5cdFx0dGhpcy5oYXNJbmRleCA9IGZhbHNlO1xuXG5cdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiaHRtbEltcG9ydGluZ1wiKTtcblxuXHRcdHJvd3MgPSByb3dzID8gcm93cy5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRyXCIpIDogW107XG5cblx0XHQvL2NoZWNrIGZvciBUYWJ1bGF0b3IgaW5saW5lIG9wdGlvbnNcblx0XHR0aGlzLl9leHRyYWN0T3B0aW9ucyhlbGVtZW50LCBvcHRpb25zKTtcblxuXHRcdGlmKGhlYWRlcnMubGVuZ3RoKXtcblx0XHRcdHRoaXMuX2V4dHJhY3RIZWFkZXJzKGhlYWRlcnMsIHJvd3MpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuX2dlbmVyYXRlQmxhbmtIZWFkZXJzKGhlYWRlcnMsIHJvd3MpO1xuXHRcdH1cblxuXHRcdC8vaXRlcmF0ZSB0aHJvdWdoIHRhYmxlIHJvd3MgYW5kIGJ1aWxkIGRhdGEgc2V0XG5cdFx0Zm9yKHZhciBpbmRleCA9IDA7IGluZGV4IDwgcm93cy5sZW5ndGg7IGluZGV4Kyspe1xuXHRcdFx0dmFyIHJvdyA9IHJvd3NbaW5kZXhdLFxuXHRcdFx0Y2VsbHMgPSByb3cuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0ZFwiKSxcblx0XHRcdGl0ZW0gPSB7fTtcblxuXHRcdFx0Ly9jcmVhdGUgaW5kZXggaWYgdGhlIGRvbid0IGV4aXN0IGluIHRhYmxlXG5cdFx0XHRpZighdGhpcy5oYXNJbmRleCl7XG5cdFx0XHRcdGl0ZW1bb3B0aW9ucy5pbmRleF0gPSBpbmRleDtcblx0XHRcdH1cblxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGNlbGxzLmxlbmd0aDsgaSsrKXtcblx0XHRcdFx0dmFyIGNlbGwgPSBjZWxsc1tpXTtcblx0XHRcdFx0aWYodHlwZW9mIHRoaXMuZmllbGRJbmRleFtpXSAhPT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0aXRlbVt0aGlzLmZpZWxkSW5kZXhbaV1dID0gY2VsbC5pbm5lckhUTUw7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly9hZGQgcm93IGRhdGEgdG8gaXRlbVxuXHRcdFx0ZGF0YS5wdXNoKGl0ZW0pO1xuXHRcdH1cblxuXHRcdG9wdGlvbnMuZGF0YSA9IGRhdGE7XG5cblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJodG1sSW1wb3J0ZWRcIik7XG5cdH1cblxuXHQvL2V4dHJhY3QgdGFidWxhdG9yIGF0dHJpYnV0ZSBvcHRpb25zXG5cdF9leHRyYWN0T3B0aW9ucyhlbGVtZW50LCBvcHRpb25zLCBkZWZhdWx0T3B0aW9ucyl7XG5cdFx0dmFyIGF0dHJpYnV0ZXMgPSBlbGVtZW50LmF0dHJpYnV0ZXM7XG5cdFx0dmFyIG9wdGlvbnNBcnIgPSBkZWZhdWx0T3B0aW9ucyA/IE9iamVjdC5rZXlzKGRlZmF1bHRPcHRpb25zKSA6IE9iamVjdC5rZXlzKG9wdGlvbnMpO1xuXHRcdHZhciBvcHRpb25zTGlzdCA9IHt9O1xuXG5cdFx0b3B0aW9uc0Fyci5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRvcHRpb25zTGlzdFtpdGVtLnRvTG93ZXJDYXNlKCldID0gaXRlbTtcblx0XHR9KTtcblxuXHRcdGZvcih2YXIgaW5kZXggaW4gYXR0cmlidXRlcyl7XG5cdFx0XHR2YXIgYXR0cmliID0gYXR0cmlidXRlc1tpbmRleF07XG5cdFx0XHR2YXIgbmFtZTtcblxuXHRcdFx0aWYoYXR0cmliICYmIHR5cGVvZiBhdHRyaWIgPT0gXCJvYmplY3RcIiAmJiBhdHRyaWIubmFtZSAmJiBhdHRyaWIubmFtZS5pbmRleE9mKFwidGFidWxhdG9yLVwiKSA9PT0gMCl7XG5cdFx0XHRcdG5hbWUgPSBhdHRyaWIubmFtZS5yZXBsYWNlKFwidGFidWxhdG9yLVwiLCBcIlwiKTtcblxuXHRcdFx0XHRpZih0eXBlb2Ygb3B0aW9uc0xpc3RbbmFtZV0gIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0XHRcdG9wdGlvbnNbb3B0aW9uc0xpc3RbbmFtZV1dID0gdGhpcy5fYXR0cmliVmFsdWUoYXR0cmliLnZhbHVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vZ2V0IHZhbHVlIG9mIGF0dHJpYnV0ZVxuXHRfYXR0cmliVmFsdWUodmFsdWUpe1xuXHRcdGlmKHZhbHVlID09PSBcInRydWVcIil7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZih2YWx1ZSA9PT0gXCJmYWxzZVwiKXtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH1cblxuXHQvL2ZpbmQgY29sdW1uIGlmIGl0IGhhcyBhbHJlYWR5IGJlZW4gZGVmaW5lZFxuXHRfZmluZENvbCh0aXRsZSl7XG5cdFx0dmFyIG1hdGNoID0gdGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMuZmluZCgoY29sdW1uKSA9PiB7XG5cdFx0XHRyZXR1cm4gY29sdW1uLnRpdGxlID09PSB0aXRsZTtcblx0XHR9KTtcblxuXHRcdHJldHVybiBtYXRjaCB8fCBmYWxzZTtcblx0fVxuXG5cdC8vZXh0cmFjdCBjb2x1bW4gZnJvbSBoZWFkZXJzXG5cdF9leHRyYWN0SGVhZGVycyhoZWFkZXJzLCByb3dzKXtcblx0XHRmb3IodmFyIGluZGV4ID0gMDsgaW5kZXggPCBoZWFkZXJzLmxlbmd0aDsgaW5kZXgrKyl7XG5cdFx0XHR2YXIgaGVhZGVyID0gaGVhZGVyc1tpbmRleF0sXG5cdFx0XHRleGlzdHMgPSBmYWxzZSxcblx0XHRcdGNvbCA9IHRoaXMuX2ZpbmRDb2woaGVhZGVyLnRleHRDb250ZW50KSxcblx0XHRcdHdpZHRoO1xuXG5cdFx0XHRpZihjb2wpe1xuXHRcdFx0XHRleGlzdHMgPSB0cnVlO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb2wgPSB7dGl0bGU6aGVhZGVyLnRleHRDb250ZW50LnRyaW0oKX07XG5cdFx0XHR9XG5cblx0XHRcdGlmKCFjb2wuZmllbGQpIHtcblx0XHRcdFx0Y29sLmZpZWxkID0gaGVhZGVyLnRleHRDb250ZW50LnRyaW0oKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2VBbGwoXCIgXCIsIFwiX1wiKTtcblx0XHRcdH1cblxuXHRcdFx0d2lkdGggPSBoZWFkZXIuZ2V0QXR0cmlidXRlKFwid2lkdGhcIik7XG5cblx0XHRcdGlmKHdpZHRoICYmICFjb2wud2lkdGgpXHR7XG5cdFx0XHRcdGNvbC53aWR0aCA9IHdpZHRoO1xuXHRcdFx0fVxuXG5cdFx0XHQvL2NoZWNrIGZvciBUYWJ1bGF0b3IgaW5saW5lIG9wdGlvbnNcblx0XHRcdHRoaXMuX2V4dHJhY3RPcHRpb25zKGhlYWRlciwgY29sLCB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIub3B0aW9uc0xpc3QucmVnaXN0ZXJlZERlZmF1bHRzKTtcblxuXHRcdFx0dGhpcy5maWVsZEluZGV4W2luZGV4XSA9IGNvbC5maWVsZDtcblxuXHRcdFx0aWYoY29sLmZpZWxkID09IHRoaXMudGFibGUub3B0aW9ucy5pbmRleCl7XG5cdFx0XHRcdHRoaXMuaGFzSW5kZXggPSB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZighZXhpc3RzKXtcblx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMucHVzaChjb2wpO1xuXHRcdFx0fVxuXG5cdFx0fVxuXHR9XG5cblx0Ly9nZW5lcmF0ZSBibGFuayBoZWFkZXJzXG5cdF9nZW5lcmF0ZUJsYW5rSGVhZGVycyhoZWFkZXJzLCByb3dzKXtcblx0XHRmb3IodmFyIGluZGV4ID0gMDsgaW5kZXggPCBoZWFkZXJzLmxlbmd0aDsgaW5kZXgrKyl7XG5cdFx0XHR2YXIgaGVhZGVyID0gaGVhZGVyc1tpbmRleF0sXG5cdFx0XHRjb2wgPSB7dGl0bGU6XCJcIiwgZmllbGQ6XCJjb2xcIiArIGluZGV4fTtcblxuXHRcdFx0dGhpcy5maWVsZEluZGV4W2luZGV4XSA9IGNvbC5maWVsZDtcblxuXHRcdFx0dmFyIHdpZHRoID0gaGVhZGVyLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpO1xuXG5cdFx0XHRpZih3aWR0aCl7XG5cdFx0XHRcdGNvbC53aWR0aCA9IHdpZHRoO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1ucy5wdXNoKGNvbCk7XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIGNzdihpbnB1dCl7XG5cdHZhciBkYXRhID0gW10sXG5cdHJvdyA9IDAsIFxuXHRjb2wgPSAwLFxuXHRpblF1b3RlID0gZmFsc2U7XG4gICAgXG5cdC8vSXRlcmF0ZSBvdmVyIGVhY2ggY2hhcmFjdGVyXG5cdGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBpbnB1dC5sZW5ndGg7IGluZGV4KyspIHtcblx0XHRsZXQgY2hhciA9IGlucHV0W2luZGV4XSwgXG5cdFx0bmV4dENoYXIgPSBpbnB1dFtpbmRleCsxXTsgICAgICBcbiAgICAgICAgXG5cdFx0Ly9Jbml0aWFsaXplIGVtcHR5IHJvd1xuXHRcdGlmKCFkYXRhW3Jvd10pe1xuXHRcdFx0ZGF0YVtyb3ddID0gW107XG5cdFx0fVxuXG5cdFx0Ly9Jbml0aWFsaXplIGVtcHR5IGNvbHVtblxuXHRcdGlmKCFkYXRhW3Jvd11bY29sXSl7XG5cdFx0XHRkYXRhW3Jvd11bY29sXSA9IFwiXCI7XG5cdFx0fVxuICAgICAgICBcblx0XHQvL0hhbmRsZSBxdW90YXRpb24gbWFyayBpbnNpZGUgc3RyaW5nXG5cdFx0aWYgKGNoYXIgPT0gJ1wiJyAmJiBpblF1b3RlICYmIG5leHRDaGFyID09ICdcIicpIHsgXG5cdFx0XHRkYXRhW3Jvd11bY29sXSArPSBjaGFyOyBcblx0XHRcdGluZGV4Kys7XG5cdFx0XHRjb250aW51ZTsgXG5cdFx0fVxuICAgICAgICBcblx0XHQvL0JlZ2luIC8gRW5kIFF1b3RlXG5cdFx0aWYgKGNoYXIgPT0gJ1wiJykgeyBcblx0XHRcdGluUXVvdGUgPSAhaW5RdW90ZTtcblx0XHRcdGNvbnRpbnVlO1xuXHRcdH1cbiAgICAgICAgXG5cdFx0Ly9OZXh0IGNvbHVtbiAoaWYgbm90IGluIHF1b3RlKVxuXHRcdGlmIChjaGFyID09ICcsJyAmJiAhaW5RdW90ZSkgeyBcblx0XHRcdGNvbCsrO1xuXHRcdFx0Y29udGludWU7IFxuXHRcdH1cbiAgICAgICAgXG5cdFx0Ly9OZXcgcm93IGlmIG5ldyBsaW5lIGFuZCBub3QgaW4gcXVvdGUgKENSTEYpIFxuXHRcdGlmIChjaGFyID09ICdcXHInICYmIG5leHRDaGFyID09ICdcXG4nICYmICFpblF1b3RlKSB7IFxuXHRcdFx0Y29sID0gMDsgXG5cdFx0XHRyb3crKzsgXG5cdFx0XHRpbmRleCsrOyBcblx0XHRcdGNvbnRpbnVlOyBcblx0XHR9XG4gICAgICAgIFxuXHRcdC8vTmV3IHJvdyBpZiBuZXcgbGluZSBhbmQgbm90IGluIHF1b3RlIChDUiBvciBMRikgXG5cdFx0aWYgKChjaGFyID09ICdcXHInIHx8IGNoYXIgPT0gJ1xcbicpICYmICFpblF1b3RlKSB7IFxuXHRcdFx0Y29sID0gMDtcblx0XHRcdHJvdysrO1xuXHRcdFx0Y29udGludWU7IFxuXHRcdH1cblxuXHRcdC8vTm9ybWFsIENoYXJhY3RlciwgYXBwZW5kIHRvIGNvbHVtblxuXHRcdGRhdGFbcm93XVtjb2xdICs9IGNoYXI7XG5cdH1cblxuXHRyZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24ganNvbihpbnB1dCl7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIEpTT04ucGFyc2UoaW5wdXQpO1xuXHR9IGNhdGNoKGUpIHtcblx0XHRjb25zb2xlLndhcm4oXCJKU09OIEltcG9ydCBFcnJvciAtIEZpbGUgY29udGVudHMgaXMgaW52YWxpZCBKU09OXCIsIGUpO1xuXHRcdHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGFycmF5JDEgKGlucHV0KXtcblx0cmV0dXJuIGlucHV0O1xufVxuXG5mdW5jdGlvbiB4bHN4KGlucHV0KXtcclxuXHR2YXIgWExTWExpYiA9IHRoaXMuZGVwZW5kZW5jeVJlZ2lzdHJ5Lmxvb2t1cChcIlhMU1hcIiksXHJcblx0d29ya2Jvb2syID0gWExTWExpYi5yZWFkKGlucHV0KSxcclxuXHRzaGVldCA9IHdvcmtib29rMi5TaGVldHNbd29ya2Jvb2syLlNoZWV0TmFtZXNbMF1dO1xyXG5cdFxyXG5cdHJldHVybiBYTFNYTGliLnV0aWxzLnNoZWV0X3RvX2pzb24oc2hlZXQsIHtoZWFkZXI6IDEgfSk7XHJcbn1cblxudmFyIGRlZmF1bHRJbXBvcnRlcnMgPSB7XG5cdGNzdjpjc3YsXG5cdGpzb246anNvbixcblx0YXJyYXk6YXJyYXkkMSxcblx0eGxzeDp4bHN4LFxufTtcblxuY2xhc3MgSW1wb3J0IGV4dGVuZHMgTW9kdWxle1xuXHRcblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcImltcG9ydFwiO1xuXHRcblx0Ly9sb2FkIGRlZmF1bHRzXG5cdHN0YXRpYyBpbXBvcnRlcnMgPSBkZWZhdWx0SW1wb3J0ZXJzO1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJpbXBvcnRGb3JtYXRcIik7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiaW1wb3J0UmVhZGVyXCIsIFwidGV4dFwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJpbXBvcnRIZWFkZXJUcmFuc2Zvcm1cIik7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiaW1wb3J0VmFsdWVUcmFuc2Zvcm1cIik7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiaW1wb3J0RGF0YVZhbGlkYXRvclwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJpbXBvcnRGaWxlVmFsaWRhdG9yXCIpO1xuXHR9XG5cdFxuXHRpbml0aWFsaXplKCl7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJpbXBvcnRcIiwgdGhpcy5pbXBvcnRGcm9tRmlsZS5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuaW1wb3J0Rm9ybWF0KXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1sb2FkaW5nXCIsIHRoaXMubG9hZERhdGFDaGVjay5iaW5kKHRoaXMpLCAxMCk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImRhdGEtbG9hZFwiLCB0aGlzLmxvYWREYXRhLmJpbmQodGhpcyksIDEwKTtcblx0XHR9XG5cdH1cblx0XG5cdGxvYWREYXRhQ2hlY2soZGF0YSl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUub3B0aW9ucy5pbXBvcnRGb3JtYXQgJiYgKHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiIHx8IChBcnJheS5pc0FycmF5KGRhdGEpICYmIGRhdGEubGVuZ3RoICYmIEFycmF5LmlzQXJyYXkoZGF0YSkpKTtcblx0fVxuXHRcblx0bG9hZERhdGEoZGF0YSwgcGFyYW1zLCBjb25maWcsIHNpbGVudCwgcHJldmlvdXNEYXRhKXtcblx0XHRyZXR1cm4gdGhpcy5pbXBvcnREYXRhKHRoaXMubG9va3VwSW1wb3J0ZXIoKSwgZGF0YSlcblx0XHRcdC50aGVuKHRoaXMuc3RydWN0dXJlRGF0YS5iaW5kKHRoaXMpKVxuXHRcdFx0LmNhdGNoKChlcnIpID0+IHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcIkltcG9ydCBFcnJvcjpcIiwgZXJyIHx8IFwiVW5hYmxlIHRvIGltcG9ydCBkYXRhXCIpO1xuXHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcblx0XHRcdH0pO1xuXHR9XG5cdFxuXHRsb29rdXBJbXBvcnRlcihpbXBvcnRGb3JtYXQpe1xuXHRcdHZhciBpbXBvcnRlcjtcblx0XHRcblx0XHRpZighaW1wb3J0Rm9ybWF0KXtcblx0XHRcdGltcG9ydEZvcm1hdCA9IHRoaXMudGFibGUub3B0aW9ucy5pbXBvcnRGb3JtYXQ7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHR5cGVvZiBpbXBvcnRGb3JtYXQgPT09IFwic3RyaW5nXCIpe1xuXHRcdFx0aW1wb3J0ZXIgPSBJbXBvcnQuaW1wb3J0ZXJzW2ltcG9ydEZvcm1hdF07XG5cdFx0fWVsc2Uge1xuXHRcdFx0aW1wb3J0ZXIgPSBpbXBvcnRGb3JtYXQ7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKCFpbXBvcnRlcil7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiSW1wb3J0IEVycm9yIC0gSW1wb3J0ZXIgbm90IGZvdW5kOlwiLCBpbXBvcnRGb3JtYXQpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gaW1wb3J0ZXI7XG5cdH1cblx0XG5cdGltcG9ydEZyb21GaWxlKGltcG9ydEZvcm1hdCwgZXh0ZW5zaW9uLCBpbXBvcnRSZWFkZXIpe1xuXHRcdHZhciBpbXBvcnRlciA9IHRoaXMubG9va3VwSW1wb3J0ZXIoaW1wb3J0Rm9ybWF0KTtcblx0XHRcblx0XHRpZihpbXBvcnRlcil7XG5cdFx0XHRyZXR1cm4gdGhpcy5waWNrRmlsZShleHRlbnNpb24sIGltcG9ydFJlYWRlcilcblx0XHRcdFx0LnRoZW4odGhpcy5pbXBvcnREYXRhLmJpbmQodGhpcywgaW1wb3J0ZXIpKVxuXHRcdFx0XHQudGhlbih0aGlzLnN0cnVjdHVyZURhdGEuYmluZCh0aGlzKSlcblx0XHRcdFx0LnRoZW4odGhpcy5tdXRhdGVEYXRhLmJpbmQodGhpcykpXG5cdFx0XHRcdC50aGVuKHRoaXMudmFsaWRhdGVEYXRhLmJpbmQodGhpcykpXG5cdFx0XHRcdC50aGVuKHRoaXMuc2V0RGF0YS5iaW5kKHRoaXMpKVxuXHRcdFx0XHQuY2F0Y2goKGVycikgPT4ge1xuXHRcdFx0XHRcdHRoaXMuZGlzcGF0Y2goXCJpbXBvcnQtZXJyb3JcIiwgZXJyKTtcblx0XHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJpbXBvcnRFcnJvclwiLCBlcnIpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJJbXBvcnQgRXJyb3I6XCIsIGVyciB8fCBcIlVuYWJsZSB0byBpbXBvcnQgZmlsZVwiKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLnRhYmxlLmRhdGFMb2FkZXIuYWxlcnRFcnJvcigpO1xuXG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnRhYmxlLmRhdGFMb2FkZXIuY2xlYXJBbGVydCgpO1xuXHRcdFx0XHRcdH0sIDMwMDApO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuXHRcdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0XG5cdHBpY2tGaWxlKGV4dGVuc2lvbnMsIGltcG9ydFJlYWRlcil7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdHZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcblx0XHRcdGlucHV0LnR5cGUgPSBcImZpbGVcIjtcblx0XHRcdGlucHV0LmFjY2VwdCA9IGV4dGVuc2lvbnM7XG5cdFx0XHRcblx0XHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHtcblx0XHRcdFx0dmFyIGZpbGUgPSBpbnB1dC5maWxlc1swXSxcblx0XHRcdFx0cmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKSxcblx0XHRcdFx0dmFsaWQgPSB0aGlzLnZhbGlkYXRlRmlsZShmaWxlKTtcblxuXHRcdFx0XHRpZih2YWxpZCA9PT0gdHJ1ZSl7XG5cdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMuZGlzcGF0Y2goXCJpbXBvcnQtaW1wb3J0aW5nXCIsIGlucHV0LmZpbGVzKTtcblx0XHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJpbXBvcnRJbXBvcnRpbmdcIiwgaW5wdXQuZmlsZXMpO1xuXHRcdFx0XHRcblx0XHRcdFx0XHRzd2l0Y2goaW1wb3J0UmVhZGVyIHx8IHRoaXMudGFibGUub3B0aW9ucy5pbXBvcnRSZWFkZXIpe1xuXHRcdFx0XHRcdFx0Y2FzZSBcImJ1ZmZlclwiOlxuXHRcdFx0XHRcdFx0XHRyZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRjYXNlIFwiYmluYXJ5XCI6XG5cdFx0XHRcdFx0XHRcdHJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcoZmlsZSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRjYXNlIFwidXJsXCI6XG5cdFx0XHRcdFx0XHRcdHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Y2FzZSBcInRleHRcIjpcblx0XHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRcdHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRyZWFkZXIub25sb2FkID0gKGUpID0+IHtcblx0XHRcdFx0XHRcdHJlc29sdmUocmVhZGVyLnJlc3VsdCk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRyZWFkZXIub25lcnJvciA9IChlKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJGaWxlIExvYWQgRXJyb3IgLSBVbmFibGUgdG8gcmVhZCBmaWxlXCIpO1xuXHRcdFx0XHRcdFx0cmVqZWN0KGUpO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRyZWplY3QodmFsaWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5kaXNwYXRjaChcImltcG9ydC1jaG9vc2VcIik7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJpbXBvcnRDaG9vc2VcIik7XG5cdFx0XHRpbnB1dC5jbGljaygpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRpbXBvcnREYXRhKGltcG9ydGVyLCBmaWxlQ29udGVudHMpe1xuXHRcdHZhciBkYXRhO1xuXHRcdFxuXHRcdHRoaXMudGFibGUuZGF0YUxvYWRlci5hbGVydExvYWRlcigpO1xuXHRcdFxuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0ZGF0YSA9IGltcG9ydGVyLmNhbGwodGhpcy50YWJsZSwgZmlsZUNvbnRlbnRzKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGRhdGEgaW5zdGFuY2VvZiBQcm9taXNlKXtcblx0XHRcdFx0XHRyZXNvbHZlKGRhdGEpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0ZGF0YSA/IHJlc29sdmUoZGF0YSkgOiByZWplY3QoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgMTApO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRzdHJ1Y3R1cmVEYXRhKHBhcnNlZERhdGEpe1xuXHRcdHZhciBkYXRhID0gW107XG5cdFx0XG5cdFx0aWYoQXJyYXkuaXNBcnJheShwYXJzZWREYXRhKSAmJiBwYXJzZWREYXRhLmxlbmd0aCAmJiBBcnJheS5pc0FycmF5KHBhcnNlZERhdGFbMF0pKXtcblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5hdXRvQ29sdW1ucyl7XG5cdFx0XHRcdGRhdGEgPSB0aGlzLnN0cnVjdHVyZUFycmF5VG9PYmplY3QocGFyc2VkRGF0YSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGRhdGEgPSB0aGlzLnN0cnVjdHVyZUFycmF5VG9Db2x1bW5zKHBhcnNlZERhdGEpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gcGFyc2VkRGF0YTtcblx0XHR9XG5cdH1cblx0XG5cdG11dGF0ZURhdGEoZGF0YSl7XG5cdFx0dmFyIG91dHB1dCA9IFtdO1xuXHRcdFxuXHRcdGlmKEFycmF5LmlzQXJyYXkoZGF0YSkpe1xuXHRcdFx0ZGF0YS5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdFx0b3V0cHV0LnB1c2godGhpcy50YWJsZS5tb2R1bGVzLm11dGF0b3IudHJhbnNmb3JtUm93KHJvdywgXCJpbXBvcnRcIikpO1xuXHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0b3V0cHV0ID0gZGF0YTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0dHJhbnNmb3JtSGVhZGVyKGhlYWRlcnMpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuaW1wb3J0SGVhZGVyVHJhbnNmb3JtKXtcblx0XHRcdGhlYWRlcnMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXHRcdFx0XHRvdXRwdXQucHVzaCh0aGlzLnRhYmxlLm9wdGlvbnMuaW1wb3J0SGVhZGVyVHJhbnNmb3JtLmNhbGwodGhpcy50YWJsZSwgaXRlbSwgaGVhZGVycykpO1xuXHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0cmV0dXJuIGhlYWRlcnM7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblx0XG5cdHRyYW5zZm9ybURhdGEocm93KXtcblx0XHR2YXIgb3V0cHV0ID0gW107XG5cblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuaW1wb3J0VmFsdWVUcmFuc2Zvcm0pe1xuXHRcdFx0cm93LmZvckVhY2goKGl0ZW0pID0+IHtcblx0XHRcdFx0b3V0cHV0LnB1c2godGhpcy50YWJsZS5vcHRpb25zLmltcG9ydFZhbHVlVHJhbnNmb3JtLmNhbGwodGhpcy50YWJsZSwgaXRlbSwgcm93KSk7XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gcm93O1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cdFxuXHRzdHJ1Y3R1cmVBcnJheVRvT2JqZWN0KHBhcnNlZERhdGEpe1xuXHRcdHZhciBjb2x1bW5zID0gdGhpcy50cmFuc2Zvcm1IZWFkZXIocGFyc2VkRGF0YS5zaGlmdCgpKTtcdFxuXHRcdFxuXHRcdHZhciBkYXRhID0gcGFyc2VkRGF0YS5tYXAoKHZhbHVlcykgPT4ge1xuXHRcdFx0dmFyIHJvdyA9IHt9O1xuXG5cdFx0XHR2YWx1ZXMgPSB0aGlzLnRyYW5zZm9ybURhdGEodmFsdWVzKTtcblx0XHRcdFxuXHRcdFx0Y29sdW1ucy5mb3JFYWNoKChrZXksIGkpID0+IHtcblx0XHRcdFx0cm93W2tleV0gPSB2YWx1ZXNbaV07XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIHJvdztcblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gZGF0YTtcblx0fVxuXHRcblx0c3RydWN0dXJlQXJyYXlUb0NvbHVtbnMocGFyc2VkRGF0YSl7XG5cdFx0dmFyIGRhdGEgPSBbXSxcblx0XHRmaXJzdFJvdyA9IHRoaXMudHJhbnNmb3JtSGVhZGVyKHBhcnNlZERhdGFbMF0pLFxuXHRcdGNvbHVtbnMgPSB0aGlzLnRhYmxlLmdldENvbHVtbnMoKTtcblx0XHRcblx0XHQvL3JlbW92ZSBmaXJzdCByb3cgaWYgaXQgaXMgdGhlIGNvbHVtbiBuYW1lc1xuXHRcdGlmKGNvbHVtbnNbMF0gJiYgZmlyc3RSb3dbMF0pe1xuXHRcdFx0aWYoY29sdW1uc1swXS5nZXREZWZpbml0aW9uKCkudGl0bGUgPT09IGZpcnN0Um93WzBdKXtcblx0XHRcdFx0cGFyc2VkRGF0YS5zaGlmdCgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvL2NvbnZlcnQgcm93IGFycmF5cyB0byBvYmplY3RzXG5cdFx0cGFyc2VkRGF0YS5mb3JFYWNoKChyb3dEYXRhKSA9PiB7XG5cdFx0XHR2YXIgcm93ID0ge307XG5cblx0XHRcdHJvd0RhdGEgPSB0aGlzLnRyYW5zZm9ybURhdGEocm93RGF0YSk7XG5cdFx0XHRcblx0XHRcdHJvd0RhdGEuZm9yRWFjaCgodmFsdWUsIGluZGV4KSA9PiB7XG5cdFx0XHRcdHZhciBjb2x1bW4gPSBjb2x1bW5zW2luZGV4XTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGNvbHVtbil7XG5cdFx0XHRcdFx0cm93W2NvbHVtbi5nZXRGaWVsZCgpXSA9IHZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0ZGF0YS5wdXNoKHJvdyk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIGRhdGE7XG5cdH1cblxuXHR2YWxpZGF0ZUZpbGUoZmlsZSl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmltcG9ydEZpbGVWYWxpZGF0b3Ipe1xuXHRcdFx0cmV0dXJuIHRoaXMudGFibGUub3B0aW9ucy5pbXBvcnRGaWxlVmFsaWRhdG9yLmNhbGwodGhpcy50YWJsZSwgZmlsZSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHR2YWxpZGF0ZURhdGEoZGF0YSl7XG5cdFx0dmFyIHJlc3VsdDtcblxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5pbXBvcnREYXRhVmFsaWRhdG9yKXtcblx0XHRcdHJlc3VsdCA9IHRoaXMudGFibGUub3B0aW9ucy5pbXBvcnREYXRhVmFsaWRhdG9yLmNhbGwodGhpcy50YWJsZSwgZGF0YSk7XG5cblx0XHRcdGlmKHJlc3VsdCA9PT0gdHJ1ZSl7XG5cdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzdWx0KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZGF0YTtcblx0fVxuXHRcblx0c2V0RGF0YShkYXRhKXtcblx0XHR0aGlzLmRpc3BhdGNoKFwiaW1wb3J0LWltcG9ydGVkXCIsIGRhdGEpO1xuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImltcG9ydEltcG9ydGVkXCIsIGRhdGEpO1xuXHRcdFxuXHRcdHRoaXMudGFibGUuZGF0YUxvYWRlci5jbGVhckFsZXJ0KCk7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuc2V0RGF0YShkYXRhKTtcblx0fVxufVxuXG5jbGFzcyBJbnRlcmFjdGlvbiBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwiaW50ZXJhY3Rpb25cIjtcblxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXG5cdFx0dGhpcy5ldmVudE1hcCA9IHtcblx0XHRcdC8vcm93IGV2ZW50c1xuXHRcdFx0cm93Q2xpY2s6XCJyb3ctY2xpY2tcIixcblx0XHRcdHJvd0RibENsaWNrOlwicm93LWRibGNsaWNrXCIsXG5cdFx0XHRyb3dDb250ZXh0Olwicm93LWNvbnRleHRtZW51XCIsXG5cdFx0XHRyb3dNb3VzZUVudGVyOlwicm93LW1vdXNlZW50ZXJcIixcblx0XHRcdHJvd01vdXNlTGVhdmU6XCJyb3ctbW91c2VsZWF2ZVwiLFxuXHRcdFx0cm93TW91c2VPdmVyOlwicm93LW1vdXNlb3ZlclwiLFxuXHRcdFx0cm93TW91c2VPdXQ6XCJyb3ctbW91c2VvdXRcIixcblx0XHRcdHJvd01vdXNlTW92ZTpcInJvdy1tb3VzZW1vdmVcIixcblx0XHRcdHJvd01vdXNlRG93bjpcInJvdy1tb3VzZWRvd25cIixcblx0XHRcdHJvd01vdXNlVXA6XCJyb3ctbW91c2V1cFwiLFxuXHRcdFx0cm93VGFwOlwicm93XCIsXG5cdFx0XHRyb3dEYmxUYXA6XCJyb3dcIixcblx0XHRcdHJvd1RhcEhvbGQ6XCJyb3dcIixcblxuXHRcdFx0Ly9jZWxsIGV2ZW50c1xuXHRcdFx0Y2VsbENsaWNrOlwiY2VsbC1jbGlja1wiLFxuXHRcdFx0Y2VsbERibENsaWNrOlwiY2VsbC1kYmxjbGlja1wiLFxuXHRcdFx0Y2VsbENvbnRleHQ6XCJjZWxsLWNvbnRleHRtZW51XCIsXG5cdFx0XHRjZWxsTW91c2VFbnRlcjpcImNlbGwtbW91c2VlbnRlclwiLFxuXHRcdFx0Y2VsbE1vdXNlTGVhdmU6XCJjZWxsLW1vdXNlbGVhdmVcIixcblx0XHRcdGNlbGxNb3VzZU92ZXI6XCJjZWxsLW1vdXNlb3ZlclwiLFxuXHRcdFx0Y2VsbE1vdXNlT3V0OlwiY2VsbC1tb3VzZW91dFwiLFxuXHRcdFx0Y2VsbE1vdXNlTW92ZTpcImNlbGwtbW91c2Vtb3ZlXCIsXG5cdFx0XHRjZWxsTW91c2VEb3duOlwiY2VsbC1tb3VzZWRvd25cIixcblx0XHRcdGNlbGxNb3VzZVVwOlwiY2VsbC1tb3VzZXVwXCIsXG5cdFx0XHRjZWxsVGFwOlwiY2VsbFwiLFxuXHRcdFx0Y2VsbERibFRhcDpcImNlbGxcIixcblx0XHRcdGNlbGxUYXBIb2xkOlwiY2VsbFwiLFxuXG5cdFx0XHQvL2NvbHVtbiBoZWFkZXIgZXZlbnRzXG5cdFx0XHRoZWFkZXJDbGljazpcImNvbHVtbi1jbGlja1wiLFxuXHRcdFx0aGVhZGVyRGJsQ2xpY2s6XCJjb2x1bW4tZGJsY2xpY2tcIixcblx0XHRcdGhlYWRlckNvbnRleHQ6XCJjb2x1bW4tY29udGV4dG1lbnVcIixcblx0XHRcdGhlYWRlck1vdXNlRW50ZXI6XCJjb2x1bW4tbW91c2VlbnRlclwiLFxuXHRcdFx0aGVhZGVyTW91c2VMZWF2ZTpcImNvbHVtbi1tb3VzZWxlYXZlXCIsXG5cdFx0XHRoZWFkZXJNb3VzZU92ZXI6XCJjb2x1bW4tbW91c2VvdmVyXCIsXG5cdFx0XHRoZWFkZXJNb3VzZU91dDpcImNvbHVtbi1tb3VzZW91dFwiLFxuXHRcdFx0aGVhZGVyTW91c2VNb3ZlOlwiY29sdW1uLW1vdXNlbW92ZVwiLFxuXHRcdFx0aGVhZGVyTW91c2VEb3duOlwiY29sdW1uLW1vdXNlZG93blwiLFxuXHRcdFx0aGVhZGVyTW91c2VVcDpcImNvbHVtbi1tb3VzZXVwXCIsXG5cdFx0XHRoZWFkZXJUYXA6XCJjb2x1bW5cIixcblx0XHRcdGhlYWRlckRibFRhcDpcImNvbHVtblwiLFxuXHRcdFx0aGVhZGVyVGFwSG9sZDpcImNvbHVtblwiLFxuXG5cdFx0XHQvL2dyb3VwIGhlYWRlclxuXHRcdFx0Z3JvdXBDbGljazpcImdyb3VwLWNsaWNrXCIsXG5cdFx0XHRncm91cERibENsaWNrOlwiZ3JvdXAtZGJsY2xpY2tcIixcblx0XHRcdGdyb3VwQ29udGV4dDpcImdyb3VwLWNvbnRleHRtZW51XCIsXG5cdFx0XHRncm91cE1vdXNlRW50ZXI6XCJncm91cC1tb3VzZWVudGVyXCIsXG5cdFx0XHRncm91cE1vdXNlTGVhdmU6XCJncm91cC1tb3VzZWxlYXZlXCIsXG5cdFx0XHRncm91cE1vdXNlT3ZlcjpcImdyb3VwLW1vdXNlb3ZlclwiLFxuXHRcdFx0Z3JvdXBNb3VzZU91dDpcImdyb3VwLW1vdXNlb3V0XCIsXG5cdFx0XHRncm91cE1vdXNlTW92ZTpcImdyb3VwLW1vdXNlbW92ZVwiLFxuXHRcdFx0Z3JvdXBNb3VzZURvd246XCJncm91cC1tb3VzZWRvd25cIixcblx0XHRcdGdyb3VwTW91c2VVcDpcImdyb3VwLW1vdXNldXBcIixcblx0XHRcdGdyb3VwVGFwOlwiZ3JvdXBcIixcblx0XHRcdGdyb3VwRGJsVGFwOlwiZ3JvdXBcIixcblx0XHRcdGdyb3VwVGFwSG9sZDpcImdyb3VwXCIsXG5cdFx0fTtcblxuXHRcdHRoaXMuc3Vic2NyaWJlcnMgPSB7fTtcblxuXHRcdHRoaXMudG91Y2hTdWJzY3JpYmVycyA9IHt9O1xuXG5cdFx0dGhpcy5jb2x1bW5TdWJzY3JpYmVycyA9IHt9O1xuXG5cdFx0dGhpcy50b3VjaFdhdGNoZXJzID0ge1xuXHRcdFx0cm93Ontcblx0XHRcdFx0dGFwOm51bGwsXG5cdFx0XHRcdHRhcERibDpudWxsLFxuXHRcdFx0XHR0YXBIb2xkOm51bGwsXG5cdFx0XHR9LFxuXHRcdFx0Y2VsbDp7XG5cdFx0XHRcdHRhcDpudWxsLFxuXHRcdFx0XHR0YXBEYmw6bnVsbCxcblx0XHRcdFx0dGFwSG9sZDpudWxsLFxuXHRcdFx0fSxcblx0XHRcdGNvbHVtbjp7XG5cdFx0XHRcdHRhcDpudWxsLFxuXHRcdFx0XHR0YXBEYmw6bnVsbCxcblx0XHRcdFx0dGFwSG9sZDpudWxsLFxuXHRcdFx0fSxcblx0XHRcdGdyb3VwOntcblx0XHRcdFx0dGFwOm51bGwsXG5cdFx0XHRcdHRhcERibDpudWxsLFxuXHRcdFx0XHR0YXBIb2xkOm51bGwsXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJDbGlja1wiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyRGJsQ2xpY2tcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlckNvbnRleHRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlck1vdXNlRW50ZXJcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlck1vdXNlTGVhdmVcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlck1vdXNlT3ZlclwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyTW91c2VPdXRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlck1vdXNlTW92ZVwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyTW91c2VEb3duXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJNb3VzZVVwXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJUYXBcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlckRibFRhcFwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyVGFwSG9sZFwiKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJjZWxsQ2xpY2tcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImNlbGxEYmxDbGlja1wiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiY2VsbENvbnRleHRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImNlbGxNb3VzZUVudGVyXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJjZWxsTW91c2VMZWF2ZVwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiY2VsbE1vdXNlT3ZlclwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiY2VsbE1vdXNlT3V0XCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJjZWxsTW91c2VNb3ZlXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJjZWxsTW91c2VEb3duXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJjZWxsTW91c2VVcFwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiY2VsbFRhcFwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiY2VsbERibFRhcFwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiY2VsbFRhcEhvbGRcIik7XG5cblx0fVxuXG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLmluaXRpYWxpemVFeHRlcm5hbEV2ZW50cygpO1xuXG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4taW5pdFwiLCB0aGlzLmluaXRpYWxpemVDb2x1bW4uYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLWRibGNsaWNrXCIsIHRoaXMuY2VsbENvbnRlbnRzU2VsZWN0aW9uRml4ZXIuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJzY3JvbGwtaG9yaXpvbnRhbFwiLCB0aGlzLmNsZWFyVG91Y2hXYXRjaGVycy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInNjcm9sbC12ZXJ0aWNhbFwiLCB0aGlzLmNsZWFyVG91Y2hXYXRjaGVycy5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdGNsZWFyVG91Y2hXYXRjaGVycygpe1xuXHRcdHZhciB0eXBlcyA9IE9iamVjdC52YWx1ZXModGhpcy50b3VjaFdhdGNoZXJzKTtcblxuXHRcdHR5cGVzLmZvckVhY2goKHR5cGUpID0+IHtcblx0XHRcdGZvcihsZXQga2V5IGluIHR5cGUpe1xuXHRcdFx0XHR0eXBlW2tleV0gPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdFx0XG5cdGNlbGxDb250ZW50c1NlbGVjdGlvbkZpeGVyKGUsIGNlbGwpe1xuXHRcdHZhciByYW5nZTtcblxuXHRcdGlmKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSl7XG5cdFx0XHRpZiAodGhpcy50YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGwgPT09IGNlbGwpe1xuXHRcdFx0XHRyZXR1cm47IC8vcHJldmVudCBpbnN0YW50IHNlbGVjdGlvbiBvZiBlZGl0b3IgY29udGVudFxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHRyeXtcblx0XHRcdGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHsgLy8gSUVcblx0XHRcdFx0cmFuZ2UgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpO1xuXHRcdFx0XHRyYW5nZS5tb3ZlVG9FbGVtZW50VGV4dChjZWxsLmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdHJhbmdlLnNlbGVjdCgpO1xuXHRcdFx0fSBlbHNlIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSB7XG5cdFx0XHRcdHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcblx0XHRcdFx0cmFuZ2Uuc2VsZWN0Tm9kZShjZWxsLmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKTtcblx0XHRcdFx0d2luZG93LmdldFNlbGVjdGlvbigpLmFkZFJhbmdlKHJhbmdlKTtcblx0XHRcdH1cblx0XHR9Y2F0Y2goZSl7fVxuXHR9XG5cblx0aW5pdGlhbGl6ZUV4dGVybmFsRXZlbnRzKCl7XG5cdFx0Zm9yKGxldCBrZXkgaW4gdGhpcy5ldmVudE1hcCl7XG5cdFx0XHR0aGlzLnN1YnNjcmlwdGlvbkNoYW5nZUV4dGVybmFsKGtleSwgdGhpcy5zdWJzY3JpcHRpb25DaGFuZ2VkLmJpbmQodGhpcywga2V5KSk7XG5cdFx0fVxuXHR9XG5cblx0c3Vic2NyaXB0aW9uQ2hhbmdlZChrZXksIGFkZGVkKXtcblx0XHRpZihhZGRlZCl7XG5cdFx0XHRpZighdGhpcy5zdWJzY3JpYmVyc1trZXldKXtcblx0XHRcdFx0aWYodGhpcy5ldmVudE1hcFtrZXldLmluY2x1ZGVzKFwiLVwiKSl7XG5cdFx0XHRcdFx0dGhpcy5zdWJzY3JpYmVyc1trZXldID0gdGhpcy5oYW5kbGUuYmluZCh0aGlzLCBrZXkpO1xuXHRcdFx0XHRcdHRoaXMuc3Vic2NyaWJlKHRoaXMuZXZlbnRNYXBba2V5XSwgdGhpcy5zdWJzY3JpYmVyc1trZXldKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuc3Vic2NyaWJlVG91Y2hFdmVudHMoa2V5KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGlmKHRoaXMuZXZlbnRNYXBba2V5XS5pbmNsdWRlcyhcIi1cIikpe1xuXHRcdFx0XHRpZih0aGlzLnN1YnNjcmliZXJzW2tleV0gJiYgIXRoaXMuY29sdW1uU3Vic2NyaWJlcnNba2V5XSAgJiYgIXRoaXMuc3Vic2NyaWJlZEV4dGVybmFsKGtleSkpe1xuXHRcdFx0XHRcdHRoaXMudW5zdWJzY3JpYmUodGhpcy5ldmVudE1hcFtrZXldLCB0aGlzLnN1YnNjcmliZXJzW2tleV0pO1xuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLnN1YnNjcmliZXJzW2tleV07XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy51bnN1YnNjcmliZVRvdWNoRXZlbnRzKGtleSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblxuXHRzdWJzY3JpYmVUb3VjaEV2ZW50cyhrZXkpe1xuXHRcdHZhciB0eXBlID0gdGhpcy5ldmVudE1hcFtrZXldO1xuXG5cdFx0aWYoIXRoaXMudG91Y2hTdWJzY3JpYmVyc1t0eXBlICsgXCItdG91Y2hzdGFydFwiXSl7XG5cdFx0XHR0aGlzLnRvdWNoU3Vic2NyaWJlcnNbdHlwZSArIFwiLXRvdWNoc3RhcnRcIl0gPSB0aGlzLmhhbmRsZVRvdWNoLmJpbmQodGhpcywgdHlwZSwgXCJzdGFydFwiKTtcblx0XHRcdHRoaXMudG91Y2hTdWJzY3JpYmVyc1t0eXBlICsgXCItdG91Y2hlbmRcIl0gPSB0aGlzLmhhbmRsZVRvdWNoLmJpbmQodGhpcywgdHlwZSwgXCJlbmRcIik7XG5cblx0XHRcdHRoaXMuc3Vic2NyaWJlKHR5cGUgKyBcIi10b3VjaHN0YXJ0XCIsIHRoaXMudG91Y2hTdWJzY3JpYmVyc1t0eXBlICsgXCItdG91Y2hzdGFydFwiXSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZSh0eXBlICsgXCItdG91Y2hlbmRcIiwgdGhpcy50b3VjaFN1YnNjcmliZXJzW3R5cGUgKyBcIi10b3VjaGVuZFwiXSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5zdWJzY3JpYmVyc1trZXldID0gdHJ1ZTtcblx0fVxuXG5cdHVuc3Vic2NyaWJlVG91Y2hFdmVudHMoa2V5KXtcblx0XHR2YXIgbm9Ub3VjaCA9IHRydWUsXG5cdFx0dHlwZSA9IHRoaXMuZXZlbnRNYXBba2V5XTtcblxuXHRcdGlmKHRoaXMuc3Vic2NyaWJlcnNba2V5XSAmJiAhdGhpcy5zdWJzY3JpYmVkRXh0ZXJuYWwoa2V5KSl7XG5cdFx0XHRkZWxldGUgdGhpcy5zdWJzY3JpYmVyc1trZXldO1xuXG5cdFx0XHRmb3IobGV0IGkgaW4gdGhpcy5ldmVudE1hcCl7XG5cdFx0XHRcdGlmKHRoaXMuZXZlbnRNYXBbaV0gPT09IHR5cGUpe1xuXHRcdFx0XHRcdGlmKHRoaXMuc3Vic2NyaWJlcnNbaV0pe1xuXHRcdFx0XHRcdFx0bm9Ub3VjaCA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZihub1RvdWNoKXtcblx0XHRcdFx0dGhpcy51bnN1YnNjcmliZSh0eXBlICsgXCItdG91Y2hzdGFydFwiLCB0aGlzLnRvdWNoU3Vic2NyaWJlcnNbdHlwZSArIFwiLXRvdWNoc3RhcnRcIl0pO1xuXHRcdFx0XHR0aGlzLnVuc3Vic2NyaWJlKHR5cGUgKyBcIi10b3VjaGVuZFwiLCB0aGlzLnRvdWNoU3Vic2NyaWJlcnNbdHlwZSArIFwiLXRvdWNoZW5kXCJdKTtcblxuXHRcdFx0XHRkZWxldGUgdGhpcy50b3VjaFN1YnNjcmliZXJzW3R5cGUgKyBcIi10b3VjaHN0YXJ0XCJdO1xuXHRcdFx0XHRkZWxldGUgdGhpcy50b3VjaFN1YnNjcmliZXJzW3R5cGUgKyBcIi10b3VjaGVuZFwiXTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpbml0aWFsaXplQ29sdW1uKGNvbHVtbil7XG5cdFx0dmFyIGRlZiA9IGNvbHVtbi5kZWZpbml0aW9uO1xuXG5cdFx0Zm9yKGxldCBrZXkgaW4gdGhpcy5ldmVudE1hcCl7XG5cdFx0XHRpZihkZWZba2V5XSl7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaXB0aW9uQ2hhbmdlZChrZXksIHRydWUpO1xuXG5cdFx0XHRcdGlmKCF0aGlzLmNvbHVtblN1YnNjcmliZXJzW2tleV0pe1xuXHRcdFx0XHRcdHRoaXMuY29sdW1uU3Vic2NyaWJlcnNba2V5XSA9IFtdO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5jb2x1bW5TdWJzY3JpYmVyc1trZXldLnB1c2goY29sdW1uKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRoYW5kbGUoYWN0aW9uLCBlLCBjb21wb25lbnQpe1xuXHRcdHRoaXMuZGlzcGF0Y2hFdmVudChhY3Rpb24sIGUsIGNvbXBvbmVudCk7XG5cdH1cblxuXHRoYW5kbGVUb3VjaCh0eXBlLCBhY3Rpb24sIGUsIGNvbXBvbmVudCl7XG5cdFx0dmFyIHdhdGNoZXJzID0gdGhpcy50b3VjaFdhdGNoZXJzW3R5cGVdO1xuXG5cdFx0aWYodHlwZSA9PT0gXCJjb2x1bW5cIil7XG5cdFx0XHR0eXBlID0gXCJoZWFkZXJcIjtcblx0XHR9XG5cblx0XHRzd2l0Y2goYWN0aW9uKXtcblx0XHRcdGNhc2UgXCJzdGFydFwiOlxuXHRcdFx0XHR3YXRjaGVycy50YXAgPSB0cnVlO1xuXG5cdFx0XHRcdGNsZWFyVGltZW91dCh3YXRjaGVycy50YXBIb2xkKTtcblxuXHRcdFx0XHR3YXRjaGVycy50YXBIb2xkID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KHdhdGNoZXJzLnRhcEhvbGQpO1xuXHRcdFx0XHRcdHdhdGNoZXJzLnRhcEhvbGQgPSBudWxsO1xuXG5cdFx0XHRcdFx0d2F0Y2hlcnMudGFwID0gbnVsbDtcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQod2F0Y2hlcnMudGFwRGJsKTtcblx0XHRcdFx0XHR3YXRjaGVycy50YXBEYmwgPSBudWxsO1xuXG5cdFx0XHRcdFx0dGhpcy5kaXNwYXRjaEV2ZW50KHR5cGUgKyBcIlRhcEhvbGRcIiwgZSwgIGNvbXBvbmVudCk7XG5cdFx0XHRcdH0sIDEwMDApO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImVuZFwiOlxuXHRcdFx0XHRpZih3YXRjaGVycy50YXApe1xuXG5cdFx0XHRcdFx0d2F0Y2hlcnMudGFwID0gbnVsbDtcblx0XHRcdFx0XHR0aGlzLmRpc3BhdGNoRXZlbnQodHlwZSArIFwiVGFwXCIsIGUsICBjb21wb25lbnQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYod2F0Y2hlcnMudGFwRGJsKXtcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQod2F0Y2hlcnMudGFwRGJsKTtcblx0XHRcdFx0XHR3YXRjaGVycy50YXBEYmwgPSBudWxsO1xuXG5cdFx0XHRcdFx0dGhpcy5kaXNwYXRjaEV2ZW50KHR5cGUgKyBcIkRibFRhcFwiLCBlLCAgY29tcG9uZW50KTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHdhdGNoZXJzLnRhcERibCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KHdhdGNoZXJzLnRhcERibCk7XG5cdFx0XHRcdFx0XHR3YXRjaGVycy50YXBEYmwgPSBudWxsO1xuXHRcdFx0XHRcdH0sIDMwMCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjbGVhclRpbWVvdXQod2F0Y2hlcnMudGFwSG9sZCk7XG5cdFx0XHRcdHdhdGNoZXJzLnRhcEhvbGQgPSBudWxsO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH1cblxuXHRkaXNwYXRjaEV2ZW50KGFjdGlvbiwgZSwgY29tcG9uZW50KXtcblx0XHR2YXIgY29tcG9uZW50T2JqID0gY29tcG9uZW50LmdldENvbXBvbmVudCgpLFxuXHRcdGNhbGxiYWNrO1xuXG5cdFx0aWYodGhpcy5jb2x1bW5TdWJzY3JpYmVyc1thY3Rpb25dKXtcblxuXHRcdFx0aWYoY29tcG9uZW50IGluc3RhbmNlb2YgQ2VsbCl7XG5cdFx0XHRcdGNhbGxiYWNrID0gY29tcG9uZW50LmNvbHVtbi5kZWZpbml0aW9uW2FjdGlvbl07XG5cdFx0XHR9ZWxzZSBpZihjb21wb25lbnQgaW5zdGFuY2VvZiBDb2x1bW4pe1xuXHRcdFx0XHRjYWxsYmFjayA9IGNvbXBvbmVudC5kZWZpbml0aW9uW2FjdGlvbl07XG5cdFx0XHR9XG5cblx0XHRcdGlmKGNhbGxiYWNrKXtcblx0XHRcdFx0Y2FsbGJhY2soZSwgY29tcG9uZW50T2JqKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoYWN0aW9uLCBlLCBjb21wb25lbnRPYmopO1xuXHR9XG59XG5cbnZhciBkZWZhdWx0QmluZGluZ3MgPSB7XG5cdG5hdlByZXY6XCJzaGlmdCArIDlcIixcblx0bmF2TmV4dDo5LFxuXHRuYXZVcDozOCxcblx0bmF2RG93bjo0MCxcblx0bmF2TGVmdDozNyxcblx0bmF2UmlnaHQ6MzksXG5cdHNjcm9sbFBhZ2VVcDozMyxcblx0c2Nyb2xsUGFnZURvd246MzQsXG5cdHNjcm9sbFRvU3RhcnQ6MzYsXG5cdHNjcm9sbFRvRW5kOjM1LFxufTtcblxudmFyIGRlZmF1bHRBY3Rpb25zID0ge1xuXHRrZXlCbG9jazpmdW5jdGlvbihlKXtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0fSxcblxuXHRzY3JvbGxQYWdlVXA6ZnVuY3Rpb24oZSl7XG5cdFx0dmFyIHJvd01hbmFnZXIgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIsXG5cdFx0bmV3UG9zID0gcm93TWFuYWdlci5zY3JvbGxUb3AgLSByb3dNYW5hZ2VyLmVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0aWYocm93TWFuYWdlci5kaXNwbGF5Um93c0NvdW50KXtcblx0XHRcdGlmKG5ld1BvcyA+PSAwKXtcblx0XHRcdFx0cm93TWFuYWdlci5lbGVtZW50LnNjcm9sbFRvcCA9IG5ld1Bvcztcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0cm93TWFuYWdlci5zY3JvbGxUb1Jvdyhyb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKClbMF0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5mb2N1cygpO1xuXHR9LFxuXG5cdHNjcm9sbFBhZ2VEb3duOmZ1bmN0aW9uKGUpe1xuXHRcdHZhciByb3dNYW5hZ2VyID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLFxuXHRcdG5ld1BvcyA9IHJvd01hbmFnZXIuc2Nyb2xsVG9wICsgcm93TWFuYWdlci5lbGVtZW50LmNsaWVudEhlaWdodCxcblx0XHRzY3JvbGxNYXggPSByb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0O1xuXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0aWYocm93TWFuYWdlci5kaXNwbGF5Um93c0NvdW50KXtcblx0XHRcdGlmKG5ld1BvcyA8PSBzY3JvbGxNYXgpe1xuXHRcdFx0XHRyb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsVG9wID0gbmV3UG9zO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRyb3dNYW5hZ2VyLnNjcm9sbFRvUm93KHJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKVtyb3dNYW5hZ2VyLmRpc3BsYXlSb3dzQ291bnQgLSAxXSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy50YWJsZS5lbGVtZW50LmZvY3VzKCk7XG5cblx0fSxcblxuXHRzY3JvbGxUb1N0YXJ0OmZ1bmN0aW9uKGUpe1xuXHRcdHZhciByb3dNYW5hZ2VyID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyO1xuXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0aWYocm93TWFuYWdlci5kaXNwbGF5Um93c0NvdW50KXtcblx0XHRcdHJvd01hbmFnZXIuc2Nyb2xsVG9Sb3cocm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpWzBdKTtcblx0XHR9XG5cblx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuZm9jdXMoKTtcblx0fSxcblxuXHRzY3JvbGxUb0VuZDpmdW5jdGlvbihlKXtcblx0XHR2YXIgcm93TWFuYWdlciA9IHRoaXMudGFibGUucm93TWFuYWdlcjtcblxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGlmKHJvd01hbmFnZXIuZGlzcGxheVJvd3NDb3VudCl7XG5cdFx0XHRyb3dNYW5hZ2VyLnNjcm9sbFRvUm93KHJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKVtyb3dNYW5hZ2VyLmRpc3BsYXlSb3dzQ291bnQgLSAxXSk7XG5cdFx0fVxuXG5cdFx0dGhpcy50YWJsZS5lbGVtZW50LmZvY3VzKCk7XG5cdH0sXG5cblx0bmF2UHJldjpmdW5jdGlvbihlKXtcblx0XHR0aGlzLmRpc3BhdGNoKFwia2V5YmluZGluZy1uYXYtcHJldlwiLCBlKTtcblx0fSxcblxuXHRuYXZOZXh0OmZ1bmN0aW9uKGUpe1xuXHRcdHRoaXMuZGlzcGF0Y2goXCJrZXliaW5kaW5nLW5hdi1uZXh0XCIsIGUpO1xuXHR9LFxuXG5cdG5hdkxlZnQ6ZnVuY3Rpb24oZSl7XG5cdFx0dGhpcy5kaXNwYXRjaChcImtleWJpbmRpbmctbmF2LWxlZnRcIiwgZSk7XG5cdH0sXG5cblx0bmF2UmlnaHQ6ZnVuY3Rpb24oZSl7XG5cdFx0dGhpcy5kaXNwYXRjaChcImtleWJpbmRpbmctbmF2LXJpZ2h0XCIsIGUpO1xuXHR9LFxuXG5cdG5hdlVwOmZ1bmN0aW9uKGUpe1xuXHRcdHRoaXMuZGlzcGF0Y2goXCJrZXliaW5kaW5nLW5hdi11cFwiLCBlKTtcblx0fSxcblxuXHRuYXZEb3duOmZ1bmN0aW9uKGUpe1xuXHRcdHRoaXMuZGlzcGF0Y2goXCJrZXliaW5kaW5nLW5hdi1kb3duXCIsIGUpO1xuXHR9LFxufTtcblxuY2xhc3MgS2V5YmluZGluZ3MgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcImtleWJpbmRpbmdzXCI7XG5cblx0Ly9sb2FkIGRlZmF1bHRzXG5cdHN0YXRpYyBiaW5kaW5ncyA9IGRlZmF1bHRCaW5kaW5ncztcblx0c3RhdGljIGFjdGlvbnMgPSBkZWZhdWx0QWN0aW9ucztcblxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXG5cdFx0dGhpcy53YXRjaEtleXMgPSBudWxsO1xuXHRcdHRoaXMucHJlc3NlZEtleXMgPSBudWxsO1xuXHRcdHRoaXMua2V5dXBCaW5kaW5nID0gZmFsc2U7XG5cdFx0dGhpcy5rZXlkb3duQmluZGluZyA9IGZhbHNlO1xuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwia2V5YmluZGluZ3NcIiwge30pOyAvL2FycmF5IGZvciBrZXliaW5kaW5nc1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInRhYkVuZE5ld1Jvd1wiLCBmYWxzZSk7IC8vY3JlYXRlIG5ldyByb3cgd2hlbiB0YWIgdG8gZW5kIG9mIHRhYmxlXG5cdH1cblxuXHRpbml0aWFsaXplKCl7XG5cdFx0dmFyIGJpbmRpbmdzID0gdGhpcy50YWJsZS5vcHRpb25zLmtleWJpbmRpbmdzLFxuXHRcdG1lcmdlZEJpbmRpbmdzID0ge307XG5cblx0XHR0aGlzLndhdGNoS2V5cyA9IHt9O1xuXHRcdHRoaXMucHJlc3NlZEtleXMgPSBbXTtcblxuXHRcdGlmKGJpbmRpbmdzICE9PSBmYWxzZSl7XG5cdFx0XHRPYmplY3QuYXNzaWduKG1lcmdlZEJpbmRpbmdzLCBLZXliaW5kaW5ncy5iaW5kaW5ncyk7XG5cdFx0XHRPYmplY3QuYXNzaWduKG1lcmdlZEJpbmRpbmdzLCBiaW5kaW5ncyk7XG5cblx0XHRcdHRoaXMubWFwQmluZGluZ3MobWVyZ2VkQmluZGluZ3MpO1xuXHRcdFx0dGhpcy5iaW5kRXZlbnRzKCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1kZXN0cm95XCIsIHRoaXMuY2xlYXJCaW5kaW5ncy5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdG1hcEJpbmRpbmdzKGJpbmRpbmdzKXtcblx0XHRmb3IobGV0IGtleSBpbiBiaW5kaW5ncyl7XG5cdFx0XHRpZihLZXliaW5kaW5ncy5hY3Rpb25zW2tleV0pe1xuXHRcdFx0XHRpZihiaW5kaW5nc1trZXldKXtcblx0XHRcdFx0XHRpZih0eXBlb2YgYmluZGluZ3Nba2V5XSAhPT0gXCJvYmplY3RcIil7XG5cdFx0XHRcdFx0XHRiaW5kaW5nc1trZXldID0gW2JpbmRpbmdzW2tleV1dO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJpbmRpbmdzW2tleV0uZm9yRWFjaCgoYmluZGluZykgPT4ge1xuXHRcdFx0XHRcdFx0dmFyIGJpbmRpbmdMaXN0ID0gQXJyYXkuaXNBcnJheShiaW5kaW5nKSA/ICBiaW5kaW5nIDogW2JpbmRpbmddO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRiaW5kaW5nTGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMubWFwQmluZGluZyhrZXksIGl0ZW0pO1xuXHRcdFx0XHRcdFx0fSk7XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiS2V5IEJpbmRpbmcgRXJyb3IgLSBubyBzdWNoIGFjdGlvbjpcIiwga2V5KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRtYXBCaW5kaW5nKGFjdGlvbiwgc3ltYm9sc0xpc3Qpe1xuXHRcdHZhciBiaW5kaW5nID0ge1xuXHRcdFx0YWN0aW9uOiBLZXliaW5kaW5ncy5hY3Rpb25zW2FjdGlvbl0sXG5cdFx0XHRrZXlzOiBbXSxcblx0XHRcdGN0cmw6IGZhbHNlLFxuXHRcdFx0c2hpZnQ6IGZhbHNlLFxuXHRcdFx0bWV0YTogZmFsc2UsXG5cdFx0fTtcblxuXHRcdHZhciBzeW1ib2xzID0gc3ltYm9sc0xpc3QudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpLnNwbGl0KFwiIFwiKS5qb2luKFwiXCIpLnNwbGl0KFwiK1wiKTtcblxuXHRcdHN5bWJvbHMuZm9yRWFjaCgoc3ltYm9sKSA9PiB7XG5cdFx0XHRzd2l0Y2goc3ltYm9sKXtcblx0XHRcdFx0Y2FzZSBcImN0cmxcIjpcblx0XHRcdFx0XHRiaW5kaW5nLmN0cmwgPSB0cnVlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJzaGlmdFwiOlxuXHRcdFx0XHRcdGJpbmRpbmcuc2hpZnQgPSB0cnVlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJtZXRhXCI6XG5cdFx0XHRcdFx0YmluZGluZy5tZXRhID0gdHJ1ZTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHN5bWJvbCA9IGlzTmFOKHN5bWJvbCkgPyBzeW1ib2wudG9VcHBlckNhc2UoKS5jaGFyQ29kZUF0KDApIDogcGFyc2VJbnQoc3ltYm9sKTtcblx0XHRcdFx0XHRiaW5kaW5nLmtleXMucHVzaChzeW1ib2wpO1xuXG5cdFx0XHRcdFx0aWYoIXRoaXMud2F0Y2hLZXlzW3N5bWJvbF0pe1xuXHRcdFx0XHRcdFx0dGhpcy53YXRjaEtleXNbc3ltYm9sXSA9IFtdO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRoaXMud2F0Y2hLZXlzW3N5bWJvbF0ucHVzaChiaW5kaW5nKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdGJpbmRFdmVudHMoKXtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHR0aGlzLmtleXVwQmluZGluZyA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIGNvZGUgPSBlLmtleUNvZGU7XG5cdFx0XHR2YXIgYmluZGluZ3MgPSBzZWxmLndhdGNoS2V5c1tjb2RlXTtcblxuXHRcdFx0aWYoYmluZGluZ3Mpe1xuXG5cdFx0XHRcdHNlbGYucHJlc3NlZEtleXMucHVzaChjb2RlKTtcblxuXHRcdFx0XHRiaW5kaW5ncy5mb3JFYWNoKGZ1bmN0aW9uKGJpbmRpbmcpe1xuXHRcdFx0XHRcdHNlbGYuY2hlY2tCaW5kaW5nKGUsIGJpbmRpbmcpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0dGhpcy5rZXlkb3duQmluZGluZyA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIGNvZGUgPSBlLmtleUNvZGU7XG5cdFx0XHR2YXIgYmluZGluZ3MgPSBzZWxmLndhdGNoS2V5c1tjb2RlXTtcblxuXHRcdFx0aWYoYmluZGluZ3Mpe1xuXG5cdFx0XHRcdHZhciBpbmRleCA9IHNlbGYucHJlc3NlZEtleXMuaW5kZXhPZihjb2RlKTtcblxuXHRcdFx0XHRpZihpbmRleCA+IC0xKXtcblx0XHRcdFx0XHRzZWxmLnByZXNzZWRLZXlzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0dGhpcy50YWJsZS5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMua2V5dXBCaW5kaW5nKTtcblxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5rZXlkb3duQmluZGluZyk7XG5cdH1cblxuXHRjbGVhckJpbmRpbmdzKCl7XG5cdFx0aWYodGhpcy5rZXl1cEJpbmRpbmcpe1xuXHRcdFx0dGhpcy50YWJsZS5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMua2V5dXBCaW5kaW5nKTtcblx0XHR9XG5cblx0XHRpZih0aGlzLmtleWRvd25CaW5kaW5nKXtcblx0XHRcdHRoaXMudGFibGUuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5rZXlkb3duQmluZGluZyk7XG5cdFx0fVxuXHR9XG5cblx0Y2hlY2tCaW5kaW5nKGUsIGJpbmRpbmcpe1xuXHRcdHZhciBtYXRjaCA9IHRydWU7XG5cblx0XHRpZihlLmN0cmxLZXkgPT0gYmluZGluZy5jdHJsICYmIGUuc2hpZnRLZXkgPT0gYmluZGluZy5zaGlmdCAmJiBlLm1ldGFLZXkgPT0gYmluZGluZy5tZXRhKXtcblx0XHRcdGJpbmRpbmcua2V5cy5mb3JFYWNoKChrZXkpID0+IHtcblx0XHRcdFx0dmFyIGluZGV4ID0gdGhpcy5wcmVzc2VkS2V5cy5pbmRleE9mKGtleSk7XG5cblx0XHRcdFx0aWYoaW5kZXggPT0gLTEpe1xuXHRcdFx0XHRcdG1hdGNoID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRpZihtYXRjaCl7XG5cdFx0XHRcdGJpbmRpbmcuYWN0aW9uLmNhbGwodGhpcywgZSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufVxuXG5jbGFzcyBNZW51IGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJtZW51XCI7XG5cdFxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMubWVudUNvbnRhaW5lciA9IG51bGw7XG5cdFx0dGhpcy5uZXN0ZWRNZW51QmxvY2sgPSBmYWxzZTtcblx0XHRcblx0XHR0aGlzLmN1cnJlbnRDb21wb25lbnQgPSBudWxsO1xuXHRcdHRoaXMucm9vdFBvcHVwID0gbnVsbDtcblx0XHRcblx0XHR0aGlzLmNvbHVtblN1YnNjcmliZXJzID0ge307XG5cdFx0XG5cdFx0Ly8gdGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwibWVudUNvbnRhaW5lclwiLCB1bmRlZmluZWQpOyAvL2RlcHJlY2F0ZWRcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJyb3dDb250ZXh0TWVudVwiLCBmYWxzZSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicm93Q2xpY2tNZW51XCIsIGZhbHNlKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJyb3dEYmxDbGlja01lbnVcIiwgZmFsc2UpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImdyb3VwQ29udGV4dE1lbnVcIiwgZmFsc2UpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImdyb3VwQ2xpY2tNZW51XCIsIGZhbHNlKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJncm91cERibENsaWNrTWVudVwiLCBmYWxzZSk7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlckNvbnRleHRNZW51XCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJDbGlja01lbnVcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlckRibENsaWNrTWVudVwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyTWVudVwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyTWVudUljb25cIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImNvbnRleHRNZW51XCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJjbGlja01lbnVcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImRibENsaWNrTWVudVwiKTtcblx0XHRcblx0fVxuXHRcblx0aW5pdGlhbGl6ZSgpe1xuXHRcdHRoaXMuZGVwcmVjYXRlZE9wdGlvbnNDaGVjaygpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZVJvd1dhdGNoZXJzKCk7XG5cdFx0dGhpcy5pbml0aWFsaXplR3JvdXBXYXRjaGVycygpO1xuXHRcdFxuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWluaXRcIiwgdGhpcy5pbml0aWFsaXplQ29sdW1uLmJpbmQodGhpcykpO1xuXHR9XG5cdFxuXHRkZXByZWNhdGVkT3B0aW9uc0NoZWNrKCl7XG5cdFx0Ly8gaWYoIXRoaXMuZGVwcmVjYXRpb25DaGVjayhcIm1lbnVDb250YWluZXJcIiwgXCJwb3B1cENvbnRhaW5lclwiKSl7XG5cdFx0Ly8gXHR0aGlzLnRhYmxlLm9wdGlvbnMucG9wdXBDb250YWluZXIgPSB0aGlzLnRhYmxlLm9wdGlvbnMubWVudUNvbnRhaW5lcjtcblx0XHQvLyB9XG5cdH1cdFxuXHRcblx0aW5pdGlhbGl6ZVJvd1dhdGNoZXJzKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJvd0NvbnRleHRNZW51KXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWNvbnRleHRtZW51XCIsIHRoaXMubG9hZE1lbnVFdmVudC5iaW5kKHRoaXMsIHRoaXMudGFibGUub3B0aW9ucy5yb3dDb250ZXh0TWVudSkpO1xuXHRcdFx0dGhpcy50YWJsZS5vbihcInJvd1RhcEhvbGRcIiwgdGhpcy5sb2FkTWVudUV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLnJvd0NvbnRleHRNZW51KSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5yb3dDbGlja01lbnUpe1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctY2xpY2tcIiwgdGhpcy5sb2FkTWVudUV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLnJvd0NsaWNrTWVudSkpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucm93RGJsQ2xpY2tNZW51KXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWRibGNsaWNrXCIsIHRoaXMubG9hZE1lbnVFdmVudC5iaW5kKHRoaXMsIHRoaXMudGFibGUub3B0aW9ucy5yb3dEYmxDbGlja01lbnUpKTtcblx0XHR9XG5cdH1cblx0XG5cdGluaXRpYWxpemVHcm91cFdhdGNoZXJzKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQ29udGV4dE1lbnUpe1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJncm91cC1jb250ZXh0bWVudVwiLCB0aGlzLmxvYWRNZW51RXZlbnQuYmluZCh0aGlzLCB0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBDb250ZXh0TWVudSkpO1xuXHRcdFx0dGhpcy50YWJsZS5vbihcImdyb3VwVGFwSG9sZFwiLCB0aGlzLmxvYWRNZW51RXZlbnQuYmluZCh0aGlzLCB0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBDb250ZXh0TWVudSkpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBDbGlja01lbnUpe1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJncm91cC1jbGlja1wiLCB0aGlzLmxvYWRNZW51RXZlbnQuYmluZCh0aGlzLCB0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBDbGlja01lbnUpKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwRGJsQ2xpY2tNZW51KXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZ3JvdXAtZGJsY2xpY2tcIiwgdGhpcy5sb2FkTWVudUV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwRGJsQ2xpY2tNZW51KSk7XG5cdFx0fVxuXHR9XG5cblx0aW5pdGlhbGl6ZUNvbHVtbihjb2x1bW4pe1xuXHRcdHZhclx0ZGVmID0gY29sdW1uLmRlZmluaXRpb247XG5cdFx0XG5cdFx0Ly9oYW5kbGUgY29sdW1uIGV2ZW50c1xuXHRcdGlmKGRlZi5oZWFkZXJDb250ZXh0TWVudSAmJiAhdGhpcy5jb2x1bW5TdWJzY3JpYmVycy5oZWFkZXJDb250ZXh0TWVudSl7XG5cdFx0XHR0aGlzLmNvbHVtblN1YnNjcmliZXJzLmhlYWRlckNvbnRleHRNZW51ID0gdGhpcy5sb2FkTWVudVRhYmxlQ29sdW1uRXZlbnQuYmluZCh0aGlzLCBcImhlYWRlckNvbnRleHRNZW51XCIpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tY29udGV4dG1lbnVcIiwgdGhpcy5jb2x1bW5TdWJzY3JpYmVycy5oZWFkZXJDb250ZXh0TWVudSk7XG5cdFx0XHR0aGlzLnRhYmxlLm9uKFwiaGVhZGVyVGFwSG9sZFwiLCB0aGlzLmxvYWRNZW51VGFibGVDb2x1bW5FdmVudC5iaW5kKHRoaXMsIFwiaGVhZGVyQ29udGV4dE1lbnVcIikpO1xuXHRcdH1cblx0XHRcblx0XHRpZihkZWYuaGVhZGVyQ2xpY2tNZW51ICYmICF0aGlzLmNvbHVtblN1YnNjcmliZXJzLmhlYWRlckNsaWNrTWVudSl7XG5cdFx0XHR0aGlzLmNvbHVtblN1YnNjcmliZXJzLmhlYWRlckNsaWNrTWVudSA9IHRoaXMubG9hZE1lbnVUYWJsZUNvbHVtbkV2ZW50LmJpbmQodGhpcywgXCJoZWFkZXJDbGlja01lbnVcIik7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1jbGlja1wiLCB0aGlzLmNvbHVtblN1YnNjcmliZXJzLmhlYWRlckNsaWNrTWVudSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGRlZi5oZWFkZXJEYmxDbGlja01lbnUgJiYgIXRoaXMuY29sdW1uU3Vic2NyaWJlcnMuaGVhZGVyRGJsQ2xpY2tNZW51KXtcblx0XHRcdHRoaXMuY29sdW1uU3Vic2NyaWJlcnMuaGVhZGVyRGJsQ2xpY2tNZW51ID0gdGhpcy5sb2FkTWVudVRhYmxlQ29sdW1uRXZlbnQuYmluZCh0aGlzLCBcImhlYWRlckRibENsaWNrTWVudVwiKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWRibGNsaWNrXCIsIHRoaXMuY29sdW1uU3Vic2NyaWJlcnMuaGVhZGVyRGJsQ2xpY2tNZW51KTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoZGVmLmhlYWRlck1lbnUpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQ29sdW1uSGVhZGVyTWVudShjb2x1bW4pO1xuXHRcdH1cblx0XHRcblx0XHQvL2hhbmRsZSBjZWxsIGV2ZW50c1xuXHRcdGlmKGRlZi5jb250ZXh0TWVudSAmJiAhdGhpcy5jb2x1bW5TdWJzY3JpYmVycy5jb250ZXh0TWVudSl7XG5cdFx0XHR0aGlzLmNvbHVtblN1YnNjcmliZXJzLmNvbnRleHRNZW51ID0gdGhpcy5sb2FkTWVudVRhYmxlQ2VsbEV2ZW50LmJpbmQodGhpcywgXCJjb250ZXh0TWVudVwiKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC1jb250ZXh0bWVudVwiLCB0aGlzLmNvbHVtblN1YnNjcmliZXJzLmNvbnRleHRNZW51KTtcblx0XHRcdHRoaXMudGFibGUub24oXCJjZWxsVGFwSG9sZFwiLCB0aGlzLmxvYWRNZW51VGFibGVDZWxsRXZlbnQuYmluZCh0aGlzLCBcImNvbnRleHRNZW51XCIpKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoZGVmLmNsaWNrTWVudSAmJiAhdGhpcy5jb2x1bW5TdWJzY3JpYmVycy5jbGlja01lbnUpe1xuXHRcdFx0dGhpcy5jb2x1bW5TdWJzY3JpYmVycy5jbGlja01lbnUgPSB0aGlzLmxvYWRNZW51VGFibGVDZWxsRXZlbnQuYmluZCh0aGlzLCBcImNsaWNrTWVudVwiKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC1jbGlja1wiLCB0aGlzLmNvbHVtblN1YnNjcmliZXJzLmNsaWNrTWVudSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGRlZi5kYmxDbGlja01lbnUgJiYgIXRoaXMuY29sdW1uU3Vic2NyaWJlcnMuZGJsQ2xpY2tNZW51KXtcblx0XHRcdHRoaXMuY29sdW1uU3Vic2NyaWJlcnMuZGJsQ2xpY2tNZW51ID0gdGhpcy5sb2FkTWVudVRhYmxlQ2VsbEV2ZW50LmJpbmQodGhpcywgXCJkYmxDbGlja01lbnVcIik7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtZGJsY2xpY2tcIiwgdGhpcy5jb2x1bW5TdWJzY3JpYmVycy5kYmxDbGlja01lbnUpO1xuXHRcdH1cblx0fVxuXHRcblx0aW5pdGlhbGl6ZUNvbHVtbkhlYWRlck1lbnUoY29sdW1uKXtcblx0XHR2YXIgaWNvbiA9IGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlck1lbnVJY29uLFxuXHRcdGhlYWRlck1lbnVFbDtcblx0XHRcblx0XHRoZWFkZXJNZW51RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHRoZWFkZXJNZW51RWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1oZWFkZXItcG9wdXAtYnV0dG9uXCIpO1xuXHRcdFxuXHRcdGlmKGljb24pe1xuXHRcdFx0aWYodHlwZW9mIGljb24gPT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdGljb24gPSBpY29uKGNvbHVtbi5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKGljb24gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7XG5cdFx0XHRcdGhlYWRlck1lbnVFbC5hcHBlbmRDaGlsZChpY29uKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aGVhZGVyTWVudUVsLmlubmVySFRNTCA9IGljb247XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aGVhZGVyTWVudUVsLmlubmVySFRNTCA9IFwiJnZlbGxpcDtcIjtcblx0XHR9XG5cdFx0XG5cdFx0aGVhZGVyTWVudUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5sb2FkTWVudUV2ZW50KGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlck1lbnUsIGUsIGNvbHVtbik7XG5cdFx0fSk7XG5cdFx0XG5cdFx0Y29sdW1uLnRpdGxlRWxlbWVudC5pbnNlcnRCZWZvcmUoaGVhZGVyTWVudUVsLCBjb2x1bW4udGl0bGVFbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHR9XG5cdFxuXHRsb2FkTWVudVRhYmxlQ2VsbEV2ZW50KG9wdGlvbiwgZSwgY2VsbCl7XG5cdFx0aWYoY2VsbC5fY2VsbCl7XG5cdFx0XHRjZWxsID0gY2VsbC5fY2VsbDtcblx0XHR9XG5cdFx0XG5cdFx0aWYoY2VsbC5jb2x1bW4uZGVmaW5pdGlvbltvcHRpb25dKXtcblx0XHRcdHRoaXMubG9hZE1lbnVFdmVudChjZWxsLmNvbHVtbi5kZWZpbml0aW9uW29wdGlvbl0sIGUsIGNlbGwpO1xuXHRcdH1cblx0fVxuXHRcblx0bG9hZE1lbnVUYWJsZUNvbHVtbkV2ZW50KG9wdGlvbiwgZSwgY29sdW1uKXtcblx0XHRpZihjb2x1bW4uX2NvbHVtbil7XG5cdFx0XHRjb2x1bW4gPSBjb2x1bW4uX2NvbHVtbjtcblx0XHR9XG5cdFx0XG5cdFx0aWYoY29sdW1uLmRlZmluaXRpb25bb3B0aW9uXSl7XG5cdFx0XHR0aGlzLmxvYWRNZW51RXZlbnQoY29sdW1uLmRlZmluaXRpb25bb3B0aW9uXSwgZSwgY29sdW1uKTtcblx0XHR9XG5cdH1cblx0XG5cdGxvYWRNZW51RXZlbnQobWVudSwgZSwgY29tcG9uZW50KXtcblx0XHRpZihjb21wb25lbnQuX2dyb3VwKXtcblx0XHRcdGNvbXBvbmVudCA9IGNvbXBvbmVudC5fZ3JvdXA7XG5cdFx0fWVsc2UgaWYoY29tcG9uZW50Ll9yb3cpe1xuXHRcdFx0Y29tcG9uZW50ID0gY29tcG9uZW50Ll9yb3c7XG5cdFx0fVxuXHRcdFxuXHRcdG1lbnUgPSB0eXBlb2YgbWVudSA9PSBcImZ1bmN0aW9uXCIgPyBtZW51LmNhbGwodGhpcy50YWJsZSwgZSwgY29tcG9uZW50LmdldENvbXBvbmVudCgpKSA6IG1lbnU7XG5cdFx0XG5cdFx0dGhpcy5sb2FkTWVudShlLCBjb21wb25lbnQsIG1lbnUpO1xuXHR9XG5cdFxuXHRsb2FkTWVudShlLCBjb21wb25lbnQsIG1lbnUsIHBhcmVudEVsLCBwYXJlbnRQb3B1cCl7XG5cdFx0dmFyIHRvdWNoID0gIShlIGluc3RhbmNlb2YgTW91c2VFdmVudCksXHRcdFxuXHRcdG1lbnVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdFx0cG9wdXA7XG5cdFx0XG5cdFx0bWVudUVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItbWVudVwiKTtcblx0XHRcblx0XHRpZighdG91Y2gpe1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblx0XHRcblx0XHQvL2Fib3J0IGlmIG5vIG1lbnUgc2V0XG5cdFx0aWYoIW1lbnUgfHwgIW1lbnUubGVuZ3RoKXtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0aWYoIXBhcmVudEVsKXtcblx0XHRcdGlmKHRoaXMubmVzdGVkTWVudUJsb2NrKXtcblx0XHRcdFx0Ly9hYm9ydCBpZiBjaGlsZCBtZW51IGFscmVhZHkgb3BlblxuXHRcdFx0XHRpZih0aGlzLnJvb3RQb3B1cCl7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMubmVzdGVkTWVudUJsb2NrID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5uZXN0ZWRNZW51QmxvY2sgPSBmYWxzZTtcblx0XHRcdFx0fSwgMTAwKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYodGhpcy5yb290UG9wdXApe1xuXHRcdFx0XHR0aGlzLnJvb3RQb3B1cC5oaWRlKCk7XHRcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5yb290UG9wdXAgPSBwb3B1cCA9IHRoaXMucG9wdXAobWVudUVsKTtcblx0XHRcdFxuXHRcdH1lbHNlIHtcblx0XHRcdHBvcHVwID0gcGFyZW50UG9wdXAuY2hpbGQobWVudUVsKTtcblx0XHR9XG5cdFx0XG5cdFx0bWVudS5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHR2YXIgaXRlbUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcblx0XHRcdGxhYmVsID0gaXRlbS5sYWJlbCxcblx0XHRcdGRpc2FibGVkID0gaXRlbS5kaXNhYmxlZDtcblx0XHRcdFxuXHRcdFx0aWYoaXRlbS5zZXBhcmF0b3Ipe1xuXHRcdFx0XHRpdGVtRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1tZW51LXNlcGFyYXRvclwiKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aXRlbUVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItbWVudS1pdGVtXCIpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodHlwZW9mIGxhYmVsID09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdFx0bGFiZWwgPSBsYWJlbC5jYWxsKHRoaXMudGFibGUsIGNvbXBvbmVudC5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmKGxhYmVsIGluc3RhbmNlb2YgTm9kZSl7XG5cdFx0XHRcdFx0aXRlbUVsLmFwcGVuZENoaWxkKGxhYmVsKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGl0ZW1FbC5pbm5lckhUTUwgPSBsYWJlbDtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYodHlwZW9mIGRpc2FibGVkID09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdFx0ZGlzYWJsZWQgPSBkaXNhYmxlZC5jYWxsKHRoaXMudGFibGUsIGNvbXBvbmVudC5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmKGRpc2FibGVkKXtcblx0XHRcdFx0XHRpdGVtRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1tZW51LWl0ZW0tZGlzYWJsZWRcIik7XG5cdFx0XHRcdFx0aXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuXHRcdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGlmKGl0ZW0ubWVudSAmJiBpdGVtLm1lbnUubGVuZ3RoKXtcblx0XHRcdFx0XHRcdGl0ZW1FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5sb2FkTWVudShlLCBjb21wb25lbnQsIGl0ZW0ubWVudSwgaXRlbUVsLCBwb3B1cCk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRpZihpdGVtLmFjdGlvbil7XG5cdFx0XHRcdFx0XHRcdGl0ZW1FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRpdGVtLmFjdGlvbihlLCBjb21wb25lbnQuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmKGl0ZW0ubWVudSAmJiBpdGVtLm1lbnUubGVuZ3RoKXtcblx0XHRcdFx0XHRpdGVtRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1tZW51LWl0ZW0tc3VibWVudVwiKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRtZW51RWwuYXBwZW5kQ2hpbGQoaXRlbUVsKTtcblx0XHR9KTtcblx0XHRcblx0XHRtZW51RWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRpZih0aGlzLnJvb3RQb3B1cCl7XG5cdFx0XHRcdHRoaXMucm9vdFBvcHVwLmhpZGUoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHRwb3B1cC5zaG93KHBhcmVudEVsIHx8IGUpO1xuXHRcdFxuXHRcdGlmKHBvcHVwID09PSB0aGlzLnJvb3RQb3B1cCl7XG5cdFx0XHR0aGlzLnJvb3RQb3B1cC5oaWRlT25CbHVyKCgpID0+IHtcblx0XHRcdFx0dGhpcy5yb290UG9wdXAgPSBudWxsO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodGhpcy5jdXJyZW50Q29tcG9uZW50KXtcblx0XHRcdFx0XHR0aGlzLmRpc3BhdGNoKFwibWVudS1jbG9zZWRcIiwgbWVudSwgcG9wdXApO1xuXHRcdFx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcIm1lbnVDbG9zZWRcIiwgdGhpcy5jdXJyZW50Q29tcG9uZW50LmdldENvbXBvbmVudCgpKTtcblx0XHRcdFx0XHR0aGlzLmN1cnJlbnRDb21wb25lbnQgPSBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5jdXJyZW50Q29tcG9uZW50ID0gY29tcG9uZW50O1xuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwibWVudS1vcGVuZWRcIiwgbWVudSwgcG9wdXApO1xuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwibWVudU9wZW5lZFwiLCBjb21wb25lbnQuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH1cblx0fVxufVxuXG5jbGFzcyBNb3ZlQ29sdW1ucyBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwibW92ZUNvbHVtblwiO1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLnBsYWNlaG9sZGVyRWxlbWVudCA9IHRoaXMuY3JlYXRlUGxhY2Vob2xkZXJFbGVtZW50KCk7XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQgPSBmYWxzZTsgLy9mbG9hdGluZyBjb2x1bW4gaGVhZGVyIGVsZW1lbnRcblx0XHR0aGlzLmNoZWNrVGltZW91dCA9IGZhbHNlOyAvL2NsaWNrIGNoZWNrIHRpbWVvdXQgaG9sZGVyXG5cdFx0dGhpcy5jaGVja1BlcmlvZCA9IDI1MDsgLy9wZXJpb2QgdG8gd2FpdCBvbiBtb3VzZWRvd24gdG8gY29uc2lkZXIgdGhpcyBhIG1vdmUgYW5kIG5vdCBhIGNsaWNrXG5cdFx0dGhpcy5tb3ZpbmcgPSBmYWxzZTsgLy9jdXJyZW50bHkgbW92aW5nIGNvbHVtblxuXHRcdHRoaXMudG9Db2wgPSBmYWxzZTsgLy9kZXN0aW5hdGlvbiBjb2x1bW5cblx0XHR0aGlzLnRvQ29sQWZ0ZXIgPSBmYWxzZTsgLy9wb3NpdGlvbiBvZiBtb3ZpbmcgY29sdW1uIHJlbGF0aXZlIHRvIHRoZSBkZXN0aW5hdGlvbiBjb2x1bW5cblx0XHR0aGlzLnN0YXJ0WCA9IDA7IC8vc3RhcnRpbmcgcG9zaXRpb24gd2l0aGluIGhlYWRlciBlbGVtZW50XG5cdFx0dGhpcy5hdXRvU2Nyb2xsTWFyZ2luID0gNDA7IC8vYXV0byBzY3JvbGwgb24gZWRnZSB3aGVuIHdpdGhpbiBtYXJnaW5cblx0XHR0aGlzLmF1dG9TY3JvbGxTdGVwID0gNTsgLy9hdXRvIHNjcm9sbCBkaXN0YW5jZSBpbiBwaXhlbHNcblx0XHR0aGlzLmF1dG9TY3JvbGxUaW1lb3V0ID0gZmFsc2U7IC8vYXV0byBzY3JvbGwgdGltZW91dFxuXHRcdHRoaXMudG91Y2hNb3ZlID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5tb3ZlSG92ZXIgPSB0aGlzLm1vdmVIb3Zlci5iaW5kKHRoaXMpO1xuXHRcdHRoaXMuZW5kTW92ZSA9IHRoaXMuZW5kTW92ZS5iaW5kKHRoaXMpO1xuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcIm1vdmFibGVDb2x1bW5zXCIsIGZhbHNlKTsgLy9lbmFibGUgbW92YWJsZSBjb2x1bW5zXG5cdH1cblx0XG5cdGNyZWF0ZVBsYWNlaG9sZGVyRWxlbWVudCgpe1xuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XG5cdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2xcIik7XG5cdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtcGxhY2Vob2xkZXJcIik7XG5cdFx0XG5cdFx0cmV0dXJuIGVsO1xuXHR9XG5cdFxuXHRpbml0aWFsaXplKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVDb2x1bW5zKXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWluaXRcIiwgdGhpcy5pbml0aWFsaXplQ29sdW1uLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJhbGVydC1zaG93XCIsIHRoaXMuYWJvcnRNb3ZlLmJpbmQodGhpcykpO1xuXHRcdH1cblx0fVxuXG5cdGFib3J0TW92ZSgpe1xuXHRcdGNsZWFyVGltZW91dCh0aGlzLmNoZWNrVGltZW91dCk7XG5cdH1cblx0XG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0Y29uZmlnID0ge30sXG5cdFx0Y29sRWw7XG5cblx0XHRpZighY29sdW1uLm1vZHVsZXMuZnJvemVuICYmICFjb2x1bW4uaXNHcm91cCAmJiAhY29sdW1uLmlzUm93SGVhZGVyKXtcblx0XHRcdGNvbEVsID0gY29sdW1uLmdldEVsZW1lbnQoKTtcblx0XHRcdFxuXHRcdFx0Y29uZmlnLm1vdXNlbW92ZSA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHRpZihjb2x1bW4ucGFyZW50ID09PSBzZWxmLm1vdmluZy5wYXJlbnQpe1xuXHRcdFx0XHRcdGlmKCgoKHNlbGYudG91Y2hNb3ZlID8gZS50b3VjaGVzWzBdLnBhZ2VYIDogZS5wYWdlWCkgLSBIZWxwZXJzLmVsT2Zmc2V0KGNvbEVsKS5sZWZ0KSArIHNlbGYudGFibGUuY29sdW1uTWFuYWdlci5jb250ZW50c0VsZW1lbnQuc2Nyb2xsTGVmdCkgPiAoY29sdW1uLmdldFdpZHRoKCkgLyAyKSl7XG5cdFx0XHRcdFx0XHRpZihzZWxmLnRvQ29sICE9PSBjb2x1bW4gfHwgIXNlbGYudG9Db2xBZnRlcil7XG5cdFx0XHRcdFx0XHRcdGNvbEVsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYucGxhY2Vob2xkZXJFbGVtZW50LCBjb2xFbC5uZXh0U2libGluZyk7XG5cdFx0XHRcdFx0XHRcdHNlbGYubW92ZUNvbHVtbihjb2x1bW4sIHRydWUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdGlmKHNlbGYudG9Db2wgIT09IGNvbHVtbiB8fCBzZWxmLnRvQ29sQWZ0ZXIpe1xuXHRcdFx0XHRcdFx0XHRjb2xFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLnBsYWNlaG9sZGVyRWxlbWVudCwgY29sRWwpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLm1vdmVDb2x1bW4oY29sdW1uLCBmYWxzZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9LmJpbmQoc2VsZik7XG5cdFx0XHRcblx0XHRcdGNvbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZSl7XG5cdFx0XHRcdHNlbGYudG91Y2hNb3ZlID0gZmFsc2U7XG5cdFx0XHRcdGlmKGUud2hpY2ggPT09IDEpe1xuXHRcdFx0XHRcdHNlbGYuY2hlY2tUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0c2VsZi5zdGFydE1vdmUoZSwgY29sdW1uKTtcblx0XHRcdFx0XHR9LCBzZWxmLmNoZWNrUGVyaW9kKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdGNvbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHRpZihlLndoaWNoID09PSAxKXtcblx0XHRcdFx0XHRpZihzZWxmLmNoZWNrVGltZW91dCl7XG5cdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQoc2VsZi5jaGVja1RpbWVvdXQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHNlbGYuYmluZFRvdWNoRXZlbnRzKGNvbHVtbik7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbHVtbi5tb2R1bGVzLm1vdmVDb2x1bW4gPSBjb25maWc7XG5cdH1cblx0XG5cdGJpbmRUb3VjaEV2ZW50cyhjb2x1bW4pe1xuXHRcdHZhciBjb2xFbCA9IGNvbHVtbi5nZXRFbGVtZW50KCksXG5cdFx0c3RhcnRYTW92ZSA9IGZhbHNlLCAvL3NoaWZ0aW5nIGNlbnRlciBwb3NpdGlvbiBvZiB0aGUgY2VsbFxuXHRcdG5leHRDb2wsIHByZXZDb2wsIG5leHRDb2xXaWR0aCwgcHJldkNvbFdpZHRoLCBuZXh0Q29sV2lkdGhMYXN0LCBwcmV2Q29sV2lkdGhMYXN0O1xuXHRcdFxuXHRcdGNvbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChlKSA9PiB7XG5cdFx0XHR0aGlzLmNoZWNrVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnRvdWNoTW92ZSA9IHRydWU7XG5cdFx0XHRcdG5leHRDb2wgPSBjb2x1bW4ubmV4dENvbHVtbigpO1xuXHRcdFx0XHRuZXh0Q29sV2lkdGggPSBuZXh0Q29sID8gbmV4dENvbC5nZXRXaWR0aCgpLzIgOiAwO1xuXHRcdFx0XHRwcmV2Q29sID0gY29sdW1uLnByZXZDb2x1bW4oKTtcblx0XHRcdFx0cHJldkNvbFdpZHRoID0gcHJldkNvbCA/IHByZXZDb2wuZ2V0V2lkdGgoKS8yIDogMDtcblx0XHRcdFx0bmV4dENvbFdpZHRoTGFzdCA9IDA7XG5cdFx0XHRcdHByZXZDb2xXaWR0aExhc3QgPSAwO1xuXHRcdFx0XHRzdGFydFhNb3ZlID0gZmFsc2U7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnN0YXJ0TW92ZShlLCBjb2x1bW4pO1xuXHRcdFx0fSwgdGhpcy5jaGVja1BlcmlvZCk7XG5cdFx0fSwge3Bhc3NpdmU6IHRydWV9KTtcblx0XHRcblx0XHRjb2xFbC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIChlKSA9PiB7XG5cdFx0XHR2YXIgZGlmZiwgbW92ZVRvQ29sO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLm1vdmluZyl7XG5cdFx0XHRcdHRoaXMubW92ZUhvdmVyKGUpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoIXN0YXJ0WE1vdmUpe1xuXHRcdFx0XHRcdHN0YXJ0WE1vdmUgPSBlLnRvdWNoZXNbMF0ucGFnZVg7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGRpZmYgPSBlLnRvdWNoZXNbMF0ucGFnZVggLSBzdGFydFhNb3ZlO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoZGlmZiA+IDApe1xuXHRcdFx0XHRcdGlmKG5leHRDb2wgJiYgZGlmZiAtIG5leHRDb2xXaWR0aExhc3QgPiBuZXh0Q29sV2lkdGgpe1xuXHRcdFx0XHRcdFx0bW92ZVRvQ29sID0gbmV4dENvbDtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYobW92ZVRvQ29sICE9PSBjb2x1bW4pe1xuXHRcdFx0XHRcdFx0XHRzdGFydFhNb3ZlID0gZS50b3VjaGVzWzBdLnBhZ2VYO1xuXHRcdFx0XHRcdFx0XHRtb3ZlVG9Db2wuZ2V0RWxlbWVudCgpLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LCBtb3ZlVG9Db2wuZ2V0RWxlbWVudCgpLm5leHRTaWJsaW5nKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5tb3ZlQ29sdW1uKG1vdmVUb0NvbCwgdHJ1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0aWYocHJldkNvbCAmJiAtZGlmZiAtIHByZXZDb2xXaWR0aExhc3QgPiAgcHJldkNvbFdpZHRoKXtcblx0XHRcdFx0XHRcdG1vdmVUb0NvbCA9IHByZXZDb2w7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmKG1vdmVUb0NvbCAhPT0gY29sdW1uKXtcblx0XHRcdFx0XHRcdFx0c3RhcnRYTW92ZSA9IGUudG91Y2hlc1swXS5wYWdlWDtcblx0XHRcdFx0XHRcdFx0bW92ZVRvQ29sLmdldEVsZW1lbnQoKS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLnBsYWNlaG9sZGVyRWxlbWVudCwgbW92ZVRvQ29sLmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdFx0XHRcdHRoaXMubW92ZUNvbHVtbihtb3ZlVG9Db2wsIGZhbHNlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmKG1vdmVUb0NvbCl7XG5cdFx0XHRcdFx0bmV4dENvbCA9IG1vdmVUb0NvbC5uZXh0Q29sdW1uKCk7XG5cdFx0XHRcdFx0bmV4dENvbFdpZHRoTGFzdCA9IG5leHRDb2xXaWR0aDtcblx0XHRcdFx0XHRuZXh0Q29sV2lkdGggPSBuZXh0Q29sID8gbmV4dENvbC5nZXRXaWR0aCgpIC8gMiA6IDA7XG5cdFx0XHRcdFx0cHJldkNvbCA9IG1vdmVUb0NvbC5wcmV2Q29sdW1uKCk7XG5cdFx0XHRcdFx0cHJldkNvbFdpZHRoTGFzdCA9IHByZXZDb2xXaWR0aDtcblx0XHRcdFx0XHRwcmV2Q29sV2lkdGggPSBwcmV2Q29sID8gcHJldkNvbC5nZXRXaWR0aCgpIC8gMiA6IDA7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LCB7cGFzc2l2ZTogdHJ1ZX0pO1xuXHRcdFxuXHRcdGNvbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCAoZSkgPT4ge1xuXHRcdFx0aWYodGhpcy5jaGVja1RpbWVvdXQpe1xuXHRcdFx0XHRjbGVhclRpbWVvdXQodGhpcy5jaGVja1RpbWVvdXQpO1xuXHRcdFx0fVxuXHRcdFx0aWYodGhpcy5tb3Zpbmcpe1xuXHRcdFx0XHR0aGlzLmVuZE1vdmUoZSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0XG5cdHN0YXJ0TW92ZShlLCBjb2x1bW4pe1xuXHRcdHZhciBlbGVtZW50ID0gY29sdW1uLmdldEVsZW1lbnQoKSxcblx0XHRoZWFkZXJFbGVtZW50ID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldENvbnRlbnRzRWxlbWVudCgpLFxuXHRcdGhlYWRlcnNFbGVtZW50ID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldEhlYWRlcnNFbGVtZW50KCk7XG5cdFx0XG5cdFx0Ly9QcmV2ZW50IG1vdmluZyBjb2x1bW5zIHdoZW4gcmFuZ2Ugc2VsZWN0aW9uIGlzIGFjdGl2ZVxuXHRcdGlmKHRoaXMudGFibGUubW9kdWxlcy5zZWxlY3RSYW5nZSAmJiB0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0UmFuZ2UuY29sdW1uU2VsZWN0aW9uKXtcblx0XHRcdGlmKHRoaXMudGFibGUubW9kdWxlcy5zZWxlY3RSYW5nZS5tb3VzZWRvd24gJiYgdGhpcy50YWJsZS5tb2R1bGVzLnNlbGVjdFJhbmdlLnNlbGVjdGluZyA9PT0gXCJjb2x1bW5cIil7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLm1vdmluZyA9IGNvbHVtbjtcblx0XHR0aGlzLnN0YXJ0WCA9ICh0aGlzLnRvdWNoTW92ZSA/IGUudG91Y2hlc1swXS5wYWdlWCA6IGUucGFnZVgpIC0gSGVscGVycy5lbE9mZnNldChlbGVtZW50KS5sZWZ0O1xuXHRcdFxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblx0XHRcblx0XHQvL2NyZWF0ZSBwbGFjZWhvbGRlclxuXHRcdHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LnN0eWxlLndpZHRoID0gY29sdW1uLmdldFdpZHRoKCkgKyBcInB4XCI7XG5cdFx0dGhpcy5wbGFjZWhvbGRlckVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gY29sdW1uLmdldEhlaWdodCgpICsgXCJweFwiO1xuXHRcdFxuXHRcdGVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGhpcy5wbGFjZWhvbGRlckVsZW1lbnQsIGVsZW1lbnQpO1xuXHRcdGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTtcblx0XHRcblx0XHQvL2NyZWF0ZSBob3ZlciBlbGVtZW50XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQgPSBlbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcblx0XHR0aGlzLmhvdmVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLW1vdmluZ1wiKTtcblx0XHRcblx0XHRoZWFkZXJFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuaG92ZXJFbGVtZW50KTtcblx0XHRcblx0XHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS5sZWZ0ID0gXCIwXCI7XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUuYm90dG9tID0gKGhlYWRlckVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gaGVhZGVyc0VsZW1lbnQub2Zmc2V0SGVpZ2h0KSArIFwicHhcIjtcblx0XHRcblx0XHRpZighdGhpcy50b3VjaE1vdmUpe1xuXHRcdFx0dGhpcy5fYmluZE1vdXNlTW92ZSgpO1xuXHRcdFx0XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy5tb3ZlSG92ZXIpO1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLmVuZE1vdmUpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLm1vdmVIb3ZlcihlKTtcblxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjb2x1bW4tbW92aW5nXCIsIGUsIHRoaXMubW92aW5nKTtcblx0fVxuXHRcblx0X2JpbmRNb3VzZU1vdmUoKXtcblx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXguZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdFx0aWYoY29sdW1uLm1vZHVsZXMubW92ZUNvbHVtbi5tb3VzZW1vdmUpe1xuXHRcdFx0XHRjb2x1bW4uZ2V0RWxlbWVudCgpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgY29sdW1uLm1vZHVsZXMubW92ZUNvbHVtbi5tb3VzZW1vdmUpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdFxuXHRfdW5iaW5kTW91c2VNb3ZlKCl7XG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZvckVhY2goZnVuY3Rpb24oY29sdW1uKXtcblx0XHRcdGlmKGNvbHVtbi5tb2R1bGVzLm1vdmVDb2x1bW4ubW91c2Vtb3ZlKXtcblx0XHRcdFx0Y29sdW1uLmdldEVsZW1lbnQoKS5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGNvbHVtbi5tb2R1bGVzLm1vdmVDb2x1bW4ubW91c2Vtb3ZlKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0bW92ZUNvbHVtbihjb2x1bW4sIGFmdGVyKXtcblx0XHR2YXIgbW92aW5nQ2VsbHMgPSB0aGlzLm1vdmluZy5nZXRDZWxscygpO1xuXHRcdFxuXHRcdHRoaXMudG9Db2wgPSBjb2x1bW47XG5cdFx0dGhpcy50b0NvbEFmdGVyID0gYWZ0ZXI7XG5cdFx0XG5cdFx0aWYoYWZ0ZXIpe1xuXHRcdFx0Y29sdW1uLmdldENlbGxzKCkuZm9yRWFjaChmdW5jdGlvbihjZWxsLCBpKXtcblx0XHRcdFx0dmFyIGNlbGxFbCA9IGNlbGwuZ2V0RWxlbWVudCh0cnVlKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGNlbGxFbC5wYXJlbnROb2RlICYmIG1vdmluZ0NlbGxzW2ldKXtcblx0XHRcdFx0XHRjZWxsRWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobW92aW5nQ2VsbHNbaV0uZ2V0RWxlbWVudCgpLCBjZWxsRWwubmV4dFNpYmxpbmcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb2x1bW4uZ2V0Q2VsbHMoKS5mb3JFYWNoKGZ1bmN0aW9uKGNlbGwsIGkpe1xuXHRcdFx0XHR2YXIgY2VsbEVsID0gY2VsbC5nZXRFbGVtZW50KHRydWUpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoY2VsbEVsLnBhcmVudE5vZGUgJiYgbW92aW5nQ2VsbHNbaV0pe1xuXHRcdFx0XHRcdGNlbGxFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShtb3ZpbmdDZWxsc1tpXS5nZXRFbGVtZW50KCksIGNlbGxFbCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXHRcblx0ZW5kTW92ZShlKXtcblx0XHRpZihlLndoaWNoID09PSAxIHx8IHRoaXMudG91Y2hNb3ZlKXtcblx0XHRcdHRoaXMuX3VuYmluZE1vdXNlTW92ZSgpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnBsYWNlaG9sZGVyRWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLm1vdmluZy5nZXRFbGVtZW50KCksIHRoaXMucGxhY2Vob2xkZXJFbGVtZW50Lm5leHRTaWJsaW5nKTtcblx0XHRcdHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5wbGFjZWhvbGRlckVsZW1lbnQpO1xuXHRcdFx0dGhpcy5ob3ZlckVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmhvdmVyRWxlbWVudCk7XG5cdFx0XHRcblx0XHRcdHRoaXMudGFibGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy50b0NvbCl7XG5cdFx0XHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5tb3ZlQ29sdW1uQWN0dWFsKHRoaXMubW92aW5nLCB0aGlzLnRvQ29sLCB0aGlzLnRvQ29sQWZ0ZXIpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLm1vdmluZyA9IGZhbHNlO1xuXHRcdFx0dGhpcy50b0NvbCA9IGZhbHNlO1xuXHRcdFx0dGhpcy50b0NvbEFmdGVyID0gZmFsc2U7XG5cdFx0XHRcblx0XHRcdGlmKCF0aGlzLnRvdWNoTW92ZSl7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCB0aGlzLm1vdmVIb3Zlcik7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy5lbmRNb3ZlKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdG1vdmVIb3ZlcihlKXtcblx0XHR2YXIgY29sdW1uSG9sZGVyID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldENvbnRlbnRzRWxlbWVudCgpLFxuXHRcdHNjcm9sbExlZnQgPSBjb2x1bW5Ib2xkZXIuc2Nyb2xsTGVmdCxcblx0XHR4UG9zID0gKCh0aGlzLnRvdWNoTW92ZSA/IGUudG91Y2hlc1swXS5wYWdlWCA6IGUucGFnZVgpIC0gSGVscGVycy5lbE9mZnNldChjb2x1bW5Ib2xkZXIpLmxlZnQpICsgc2Nyb2xsTGVmdCxcblx0XHRzY3JvbGxQb3M7XG5cdFx0XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUubGVmdCA9ICh4UG9zIC0gdGhpcy5zdGFydFgpICsgXCJweFwiO1xuXHRcdFxuXHRcdGlmKHhQb3MgLSBzY3JvbGxMZWZ0IDwgdGhpcy5hdXRvU2Nyb2xsTWFyZ2luKXtcblx0XHRcdGlmKCF0aGlzLmF1dG9TY3JvbGxUaW1lb3V0KXtcblx0XHRcdFx0dGhpcy5hdXRvU2Nyb2xsVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdHNjcm9sbFBvcyA9IE1hdGgubWF4KDAsc2Nyb2xsTGVmdC01KTtcblx0XHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RWxlbWVudCgpLnNjcm9sbExlZnQgPSBzY3JvbGxQb3M7XG5cdFx0XHRcdFx0dGhpcy5hdXRvU2Nyb2xsVGltZW91dCA9IGZhbHNlO1xuXHRcdFx0XHR9LCAxKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYoc2Nyb2xsTGVmdCArIGNvbHVtbkhvbGRlci5jbGllbnRXaWR0aCAtIHhQb3MgPCB0aGlzLmF1dG9TY3JvbGxNYXJnaW4pe1xuXHRcdFx0aWYoIXRoaXMuYXV0b1Njcm9sbFRpbWVvdXQpe1xuXHRcdFx0XHR0aGlzLmF1dG9TY3JvbGxUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0c2Nyb2xsUG9zID0gTWF0aC5taW4oY29sdW1uSG9sZGVyLmNsaWVudFdpZHRoLCBzY3JvbGxMZWZ0KzUpO1xuXHRcdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5nZXRFbGVtZW50KCkuc2Nyb2xsTGVmdCA9IHNjcm9sbFBvcztcblx0XHRcdFx0XHR0aGlzLmF1dG9TY3JvbGxUaW1lb3V0ID0gZmFsc2U7XG5cdFx0XHRcdH0sIDEpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG52YXIgZGVmYXVsdFNlbmRlcnMgPSB7XHJcblx0ZGVsZXRlOmZ1bmN0aW9uKGZyb21Sb3csIHRvUm93LCB0b1RhYmxlKXtcclxuXHRcdGZyb21Sb3cuZGVsZXRlKCk7XHJcblx0fVxyXG59O1xuXG52YXIgZGVmYXVsdFJlY2VpdmVycyA9IHtcclxuXHRpbnNlcnQ6ZnVuY3Rpb24oZnJvbVJvdywgdG9Sb3csIGZyb21UYWJsZSl7XHJcblx0XHR0aGlzLnRhYmxlLmFkZFJvdyhmcm9tUm93LmdldERhdGEoKSwgdW5kZWZpbmVkLCB0b1Jvdyk7XHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHRhZGQ6ZnVuY3Rpb24oZnJvbVJvdywgdG9Sb3csIGZyb21UYWJsZSl7XHJcblx0XHR0aGlzLnRhYmxlLmFkZFJvdyhmcm9tUm93LmdldERhdGEoKSk7XHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHR1cGRhdGU6ZnVuY3Rpb24oZnJvbVJvdywgdG9Sb3csIGZyb21UYWJsZSl7XHJcblx0XHRpZih0b1Jvdyl7XHJcblx0XHRcdHRvUm93LnVwZGF0ZShmcm9tUm93LmdldERhdGEoKSk7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9LFxyXG5cclxuXHRyZXBsYWNlOmZ1bmN0aW9uKGZyb21Sb3csIHRvUm93LCBmcm9tVGFibGUpe1xyXG5cdFx0aWYodG9Sb3cpe1xyXG5cdFx0XHR0aGlzLnRhYmxlLmFkZFJvdyhmcm9tUm93LmdldERhdGEoKSwgdW5kZWZpbmVkLCB0b1Jvdyk7XHJcblx0XHRcdHRvUm93LmRlbGV0ZSgpO1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fSxcclxufTtcblxuY2xhc3MgTW92ZVJvd3MgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcIm1vdmVSb3dcIjtcblxuXHQvL2xvYWQgZGVmYXVsdHNcblx0c3RhdGljIHNlbmRlcnMgPSBkZWZhdWx0U2VuZGVycztcblx0c3RhdGljIHJlY2VpdmVycyA9IGRlZmF1bHRSZWNlaXZlcnM7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMucGxhY2Vob2xkZXJFbGVtZW50ID0gdGhpcy5jcmVhdGVQbGFjZWhvbGRlckVsZW1lbnQoKTtcblx0XHR0aGlzLmhvdmVyRWxlbWVudCA9IGZhbHNlOyAvL2Zsb2F0aW5nIHJvdyBoZWFkZXIgZWxlbWVudFxuXHRcdHRoaXMuY2hlY2tUaW1lb3V0ID0gZmFsc2U7IC8vY2xpY2sgY2hlY2sgdGltZW91dCBob2xkZXJcblx0XHR0aGlzLmNoZWNrUGVyaW9kID0gMTUwOyAvL3BlcmlvZCB0byB3YWl0IG9uIG1vdXNlZG93biB0byBjb25zaWRlciB0aGlzIGEgbW92ZSBhbmQgbm90IGEgY2xpY2tcblx0XHR0aGlzLm1vdmluZyA9IGZhbHNlOyAvL2N1cnJlbnRseSBtb3Zpbmcgcm93XG5cdFx0dGhpcy50b1JvdyA9IGZhbHNlOyAvL2Rlc3RpbmF0aW9uIHJvd1xuXHRcdHRoaXMudG9Sb3dBZnRlciA9IGZhbHNlOyAvL3Bvc2l0aW9uIG9mIG1vdmluZyByb3cgcmVsYXRpdmUgdG8gdGhlIGRlc3RpbmF0aW9uIHJvd1xuXHRcdHRoaXMuaGFzSGFuZGxlID0gZmFsc2U7IC8vcm93IGhhcyBoYW5kbGUgaW5zdGVhZCBvZiBmdWxseSBtb3ZhYmxlIHJvd1xuXHRcdHRoaXMuc3RhcnRZID0gMDsgLy9zdGFydGluZyBZIHBvc2l0aW9uIHdpdGhpbiBoZWFkZXIgZWxlbWVudFxuXHRcdHRoaXMuc3RhcnRYID0gMDsgLy9zdGFydGluZyBYIHBvc2l0aW9uIHdpdGhpbiBoZWFkZXIgZWxlbWVudFxuXG5cdFx0dGhpcy5tb3ZlSG92ZXIgPSB0aGlzLm1vdmVIb3Zlci5iaW5kKHRoaXMpO1xuXHRcdHRoaXMuZW5kTW92ZSA9IHRoaXMuZW5kTW92ZS5iaW5kKHRoaXMpO1xuXHRcdHRoaXMudGFibGVSb3dEcm9wRXZlbnQgPSBmYWxzZTtcblxuXHRcdHRoaXMudG91Y2hNb3ZlID0gZmFsc2U7XG5cblx0XHR0aGlzLmNvbm5lY3Rpb24gPSBmYWxzZTtcblx0XHR0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNUYWJsZXMgPSBmYWxzZTtcblx0XHR0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNFbGVtZW50cyA9IGZhbHNlO1xuXHRcdHRoaXMuY29ubmVjdGlvbkVsZW1lbnRzID0gW107XG5cdFx0dGhpcy5jb25uZWN0aW9ucyA9IFtdO1xuXG5cdFx0dGhpcy5jb25uZWN0ZWRUYWJsZSA9IGZhbHNlO1xuXHRcdHRoaXMuY29ubmVjdGVkUm93ID0gZmFsc2U7XG5cblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJtb3ZhYmxlUm93c1wiLCBmYWxzZSk7IC8vZW5hYmxlIG1vdmFibGUgcm93c1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcIm1vdmFibGVSb3dzQ29ubmVjdGVkVGFibGVzXCIsIGZhbHNlKTsgLy90YWJsZXMgZm9yIG1vdmFibGUgcm93cyB0byBiZSBjb25uZWN0ZWQgdG9cblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJtb3ZhYmxlUm93c0Nvbm5lY3RlZEVsZW1lbnRzXCIsIGZhbHNlKTsgLy9vdGhlciBlbGVtZW50cyBmb3IgbW92YWJsZSByb3dzIHRvIGJlIGNvbm5lY3RlZCB0b1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcIm1vdmFibGVSb3dzU2VuZGVyXCIsIGZhbHNlKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJtb3ZhYmxlUm93c1JlY2VpdmVyXCIsIFwiaW5zZXJ0XCIpO1xuXG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInJvd0hhbmRsZVwiKTtcblx0fVxuXG5cdGNyZWF0ZVBsYWNlaG9sZGVyRWxlbWVudCgpe1xuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvd1wiKTtcblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1wbGFjZWhvbGRlclwiKTtcblxuXHRcdHJldHVybiBlbDtcblx0fVxuXG5cdGluaXRpYWxpemUoKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3Mpe1xuXHRcdFx0dGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzVGFibGVzID0gdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzQ29ubmVjdGVkVGFibGVzO1xuXHRcdFx0dGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzRWxlbWVudHMgPSB0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NDb25uZWN0ZWRFbGVtZW50cztcblxuXHRcdFx0dGhpcy5jb25uZWN0aW9uID0gdGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzVGFibGVzIHx8IHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc0VsZW1lbnRzO1xuXG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtaW5pdFwiLCB0aGlzLmluaXRpYWxpemVDZWxsLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4taW5pdFwiLCB0aGlzLmluaXRpYWxpemVDb2x1bW4uYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1pbml0XCIsIHRoaXMuaW5pdGlhbGl6ZVJvdy5iaW5kKHRoaXMpKTtcblx0XHR9XG5cdH1cblxuXHRpbml0aWFsaXplR3JvdXBIZWFkZXIoZ3JvdXApe1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRjb25maWcgPSB7fTtcblxuXHRcdC8vaW50ZXIgdGFibGUgZHJhZyBkcm9wXG5cdFx0Y29uZmlnLm1vdXNldXAgPSBmdW5jdGlvbihlKXtcblx0XHRcdHNlbGYudGFibGVSb3dEcm9wKGUsIGdyb3VwKTtcblx0XHR9LmJpbmQoc2VsZik7XG5cblx0XHQvL3NhbWUgdGFibGUgZHJhZyBkcm9wXG5cdFx0Y29uZmlnLm1vdXNlbW92ZSA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIHJvd0VsO1xuXG5cdFx0XHRpZigoKGUucGFnZVkgLSBIZWxwZXJzLmVsT2Zmc2V0KGdyb3VwLmVsZW1lbnQpLnRvcCkgKyBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxUb3ApID4gKGdyb3VwLmdldEhlaWdodCgpIC8gMikpe1xuXHRcdFx0XHRpZihzZWxmLnRvUm93ICE9PSBncm91cCB8fCAhc2VsZi50b1Jvd0FmdGVyKXtcblx0XHRcdFx0XHRyb3dFbCA9IGdyb3VwLmdldEVsZW1lbnQoKTtcblx0XHRcdFx0XHRyb3dFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLnBsYWNlaG9sZGVyRWxlbWVudCwgcm93RWwubmV4dFNpYmxpbmcpO1xuXHRcdFx0XHRcdHNlbGYubW92ZVJvdyhncm91cCwgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYoc2VsZi50b1JvdyAhPT0gZ3JvdXAgfHwgc2VsZi50b1Jvd0FmdGVyKXtcblx0XHRcdFx0XHRyb3dFbCA9IGdyb3VwLmdldEVsZW1lbnQoKTtcblx0XHRcdFx0XHRpZihyb3dFbC5wcmV2aW91c1NpYmxpbmcpe1xuXHRcdFx0XHRcdFx0cm93RWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5wbGFjZWhvbGRlckVsZW1lbnQsIHJvd0VsKTtcblx0XHRcdFx0XHRcdHNlbGYubW92ZVJvdyhncm91cCwgZmFsc2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0uYmluZChzZWxmKTtcblxuXHRcdGdyb3VwLm1vZHVsZXMubW92ZVJvdyA9IGNvbmZpZztcblx0fVxuXG5cdGluaXRpYWxpemVSb3cocm93KXtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0Y29uZmlnID0ge30sXG5cdFx0cm93RWw7XG5cblx0XHQvL2ludGVyIHRhYmxlIGRyYWcgZHJvcFxuXHRcdGNvbmZpZy5tb3VzZXVwID0gZnVuY3Rpb24oZSl7XG5cdFx0XHRzZWxmLnRhYmxlUm93RHJvcChlLCByb3cpO1xuXHRcdH0uYmluZChzZWxmKTtcblxuXHRcdC8vc2FtZSB0YWJsZSBkcmFnIGRyb3Bcblx0XHRjb25maWcubW91c2Vtb3ZlID0gZnVuY3Rpb24oZSl7XG5cdFx0XHR2YXIgcm93RWwgPSByb3cuZ2V0RWxlbWVudCgpO1xuXG5cdFx0XHRpZigoKGUucGFnZVkgLSBIZWxwZXJzLmVsT2Zmc2V0KHJvd0VsKS50b3ApICsgc2VsZi50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsVG9wKSA+IChyb3cuZ2V0SGVpZ2h0KCkgLyAyKSl7XG5cdFx0XHRcdGlmKHNlbGYudG9Sb3cgIT09IHJvdyB8fCAhc2VsZi50b1Jvd0FmdGVyKXtcblx0XHRcdFx0XHRyb3dFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLnBsYWNlaG9sZGVyRWxlbWVudCwgcm93RWwubmV4dFNpYmxpbmcpO1xuXHRcdFx0XHRcdHNlbGYubW92ZVJvdyhyb3csIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKHNlbGYudG9Sb3cgIT09IHJvdyB8fCBzZWxmLnRvUm93QWZ0ZXIpe1xuXHRcdFx0XHRcdHJvd0VsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYucGxhY2Vob2xkZXJFbGVtZW50LCByb3dFbCk7XG5cdFx0XHRcdFx0c2VsZi5tb3ZlUm93KHJvdywgZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fS5iaW5kKHNlbGYpO1xuXG5cblx0XHRpZighdGhpcy5oYXNIYW5kbGUpe1xuXG5cdFx0XHRyb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cblx0XHRcdHJvd0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZSl7XG5cdFx0XHRcdGlmKGUud2hpY2ggPT09IDEpe1xuXHRcdFx0XHRcdHNlbGYuY2hlY2tUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0c2VsZi5zdGFydE1vdmUoZSwgcm93KTtcblx0XHRcdFx0XHR9LCBzZWxmLmNoZWNrUGVyaW9kKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHJvd0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHRpZihlLndoaWNoID09PSAxKXtcblx0XHRcdFx0XHRpZihzZWxmLmNoZWNrVGltZW91dCl7XG5cdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQoc2VsZi5jaGVja1RpbWVvdXQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYmluZFRvdWNoRXZlbnRzKHJvdywgcm93LmdldEVsZW1lbnQoKSk7XG5cdFx0fVxuXG5cdFx0cm93Lm1vZHVsZXMubW92ZVJvdyA9IGNvbmZpZztcblx0fVxuXG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi5yb3dIYW5kbGUgJiYgdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzICE9PSBmYWxzZSl7XG5cdFx0XHR0aGlzLmhhc0hhbmRsZSA9IHRydWU7XG5cdFx0fVxuXHR9XG5cblx0aW5pdGlhbGl6ZUNlbGwoY2VsbCl7XG5cdFx0aWYoY2VsbC5jb2x1bW4uZGVmaW5pdGlvbi5yb3dIYW5kbGUgJiYgdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzICE9PSBmYWxzZSl7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRjZWxsRWwgPSBjZWxsLmdldEVsZW1lbnQodHJ1ZSk7XG5cblx0XHRcdGNlbGxFbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHRpZihlLndoaWNoID09PSAxKXtcblx0XHRcdFx0XHRzZWxmLmNoZWNrVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHNlbGYuc3RhcnRNb3ZlKGUsIGNlbGwucm93KTtcblx0XHRcdFx0XHR9LCBzZWxmLmNoZWNrUGVyaW9kKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGNlbGxFbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0aWYoZS53aGljaCA9PT0gMSl7XG5cdFx0XHRcdFx0aWYoc2VsZi5jaGVja1RpbWVvdXQpe1xuXHRcdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KHNlbGYuY2hlY2tUaW1lb3V0KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmJpbmRUb3VjaEV2ZW50cyhjZWxsLnJvdywgY2VsbEVsKTtcblx0XHR9XG5cdH1cblxuXHRiaW5kVG91Y2hFdmVudHMocm93LCBlbGVtZW50KXtcblx0XHR2YXIgc3RhcnRZTW92ZSA9IGZhbHNlLCAvL3NoaWZ0aW5nIGNlbnRlciBwb3NpdGlvbiBvZiB0aGUgY2VsbFxuXHRcdG5leHRSb3csIHByZXZSb3csIG5leHRSb3dIZWlnaHQsIHByZXZSb3dIZWlnaHQsIG5leHRSb3dIZWlnaHRMYXN0LCBwcmV2Um93SGVpZ2h0TGFzdDtcblxuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgKGUpID0+IHtcblx0XHRcdHRoaXMuY2hlY2tUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMudG91Y2hNb3ZlID0gdHJ1ZTtcblx0XHRcdFx0bmV4dFJvdyA9IHJvdy5uZXh0Um93KCk7XG5cdFx0XHRcdG5leHRSb3dIZWlnaHQgPSBuZXh0Um93ID8gbmV4dFJvdy5nZXRIZWlnaHQoKS8yIDogMDtcblx0XHRcdFx0cHJldlJvdyA9IHJvdy5wcmV2Um93KCk7XG5cdFx0XHRcdHByZXZSb3dIZWlnaHQgPSBwcmV2Um93ID8gcHJldlJvdy5nZXRIZWlnaHQoKS8yIDogMDtcblx0XHRcdFx0bmV4dFJvd0hlaWdodExhc3QgPSAwO1xuXHRcdFx0XHRwcmV2Um93SGVpZ2h0TGFzdCA9IDA7XG5cdFx0XHRcdHN0YXJ0WU1vdmUgPSBmYWxzZTtcblxuXHRcdFx0XHR0aGlzLnN0YXJ0TW92ZShlLCByb3cpO1xuXHRcdFx0fSwgdGhpcy5jaGVja1BlcmlvZCk7XG5cdFx0fSwge3Bhc3NpdmU6IHRydWV9KTtcblx0XHR0aGlzLm1vdmluZywgdGhpcy50b1JvdywgdGhpcy50b1Jvd0FmdGVyO1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCAoZSkgPT4ge1xuXG5cdFx0XHR2YXIgZGlmZiwgbW92ZVRvUm93O1xuXG5cdFx0XHRpZih0aGlzLm1vdmluZyl7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHR0aGlzLm1vdmVIb3ZlcihlKTtcblxuXHRcdFx0XHRpZighc3RhcnRZTW92ZSl7XG5cdFx0XHRcdFx0c3RhcnRZTW92ZSA9IGUudG91Y2hlc1swXS5wYWdlWTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGRpZmYgPSBlLnRvdWNoZXNbMF0ucGFnZVkgLSBzdGFydFlNb3ZlO1xuXG5cdFx0XHRcdGlmKGRpZmYgPiAwKXtcblx0XHRcdFx0XHRpZihuZXh0Um93ICYmIGRpZmYgLSBuZXh0Um93SGVpZ2h0TGFzdCA+IG5leHRSb3dIZWlnaHQpe1xuXHRcdFx0XHRcdFx0bW92ZVRvUm93ID0gbmV4dFJvdztcblxuXHRcdFx0XHRcdFx0aWYobW92ZVRvUm93ICE9PSByb3cpe1xuXHRcdFx0XHRcdFx0XHRzdGFydFlNb3ZlID0gZS50b3VjaGVzWzBdLnBhZ2VZO1xuXHRcdFx0XHRcdFx0XHRtb3ZlVG9Sb3cuZ2V0RWxlbWVudCgpLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LCBtb3ZlVG9Sb3cuZ2V0RWxlbWVudCgpLm5leHRTaWJsaW5nKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5tb3ZlUm93KG1vdmVUb1JvdywgdHJ1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0aWYocHJldlJvdyAmJiAtZGlmZiAtIHByZXZSb3dIZWlnaHRMYXN0ID4gIHByZXZSb3dIZWlnaHQpe1xuXHRcdFx0XHRcdFx0bW92ZVRvUm93ID0gcHJldlJvdztcblxuXHRcdFx0XHRcdFx0aWYobW92ZVRvUm93ICE9PSByb3cpe1xuXHRcdFx0XHRcdFx0XHRzdGFydFlNb3ZlID0gZS50b3VjaGVzWzBdLnBhZ2VZO1xuXHRcdFx0XHRcdFx0XHRtb3ZlVG9Sb3cuZ2V0RWxlbWVudCgpLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LCBtb3ZlVG9Sb3cuZ2V0RWxlbWVudCgpKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5tb3ZlUm93KG1vdmVUb1JvdywgZmFsc2UpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmKG1vdmVUb1Jvdyl7XG5cdFx0XHRcdFx0bmV4dFJvdyA9IG1vdmVUb1Jvdy5uZXh0Um93KCk7XG5cdFx0XHRcdFx0bmV4dFJvd0hlaWdodExhc3QgPSBuZXh0Um93SGVpZ2h0O1xuXHRcdFx0XHRcdG5leHRSb3dIZWlnaHQgPSBuZXh0Um93ID8gbmV4dFJvdy5nZXRIZWlnaHQoKSAvIDIgOiAwO1xuXHRcdFx0XHRcdHByZXZSb3cgPSBtb3ZlVG9Sb3cucHJldlJvdygpO1xuXHRcdFx0XHRcdHByZXZSb3dIZWlnaHRMYXN0ID0gcHJldlJvd0hlaWdodDtcblx0XHRcdFx0XHRwcmV2Um93SGVpZ2h0ID0gcHJldlJvdyA/IHByZXZSb3cuZ2V0SGVpZ2h0KCkgLyAyIDogMDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgKGUpID0+IHtcblx0XHRcdGlmKHRoaXMuY2hlY2tUaW1lb3V0KXtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMuY2hlY2tUaW1lb3V0KTtcblx0XHRcdH1cblx0XHRcdGlmKHRoaXMubW92aW5nKXtcblx0XHRcdFx0dGhpcy5lbmRNb3ZlKGUpO1xuXHRcdFx0XHR0aGlzLnRvdWNoTW92ZSA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0X2JpbmRNb3VzZU1vdmUoKXtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdGlmKChyb3cudHlwZSA9PT0gXCJyb3dcIiB8fCByb3cudHlwZSA9PT0gXCJncm91cFwiKSAmJiByb3cubW9kdWxlcy5tb3ZlUm93ICYmIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2Vtb3ZlKXtcblx0XHRcdFx0cm93LmdldEVsZW1lbnQoKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2Vtb3ZlKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdF91bmJpbmRNb3VzZU1vdmUoKXtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdGlmKChyb3cudHlwZSA9PT0gXCJyb3dcIiB8fCByb3cudHlwZSA9PT0gXCJncm91cFwiKSAmJiByb3cubW9kdWxlcy5tb3ZlUm93ICYmIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2Vtb3ZlKXtcblx0XHRcdFx0cm93LmdldEVsZW1lbnQoKS5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2Vtb3ZlKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHN0YXJ0TW92ZShlLCByb3cpe1xuXHRcdHZhciBlbGVtZW50ID0gcm93LmdldEVsZW1lbnQoKTtcblxuXHRcdHRoaXMuc2V0U3RhcnRQb3NpdGlvbihlLCByb3cpO1xuXG5cdFx0dGhpcy5tb3ZpbmcgPSByb3c7XG5cblx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ibG9jay1zZWxlY3RcIik7XG5cblx0XHQvL2NyZWF0ZSBwbGFjZWhvbGRlclxuXHRcdHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LnN0eWxlLndpZHRoID0gcm93LmdldFdpZHRoKCkgKyBcInB4XCI7XG5cdFx0dGhpcy5wbGFjZWhvbGRlckVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gcm93LmdldEhlaWdodCgpICsgXCJweFwiO1xuXG5cdFx0aWYoIXRoaXMuY29ubmVjdGlvbil7XG5cdFx0XHRlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LCBlbGVtZW50KTtcblx0XHRcdGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1tb3Zpbmdyb3ctc2VuZGluZ1wiKTtcblx0XHRcdHRoaXMuY29ubmVjdFRvVGFibGVzKHJvdyk7XG5cdFx0fVxuXG5cdFx0Ly9jcmVhdGUgaG92ZXIgZWxlbWVudFxuXHRcdHRoaXMuaG92ZXJFbGVtZW50ID0gZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1tb3ZpbmdcIik7XG5cblx0XHRpZih0aGlzLmNvbm5lY3Rpb24pe1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmhvdmVyRWxlbWVudCk7XG5cdFx0XHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS5sZWZ0ID0gXCIwXCI7XG5cdFx0XHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS50b3AgPSBcIjBcIjtcblx0XHRcdHRoaXMuaG92ZXJFbGVtZW50LnN0eWxlLndpZHRoID0gdGhpcy50YWJsZS5lbGVtZW50LmNsaWVudFdpZHRoICsgXCJweFwiO1xuXHRcdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUud2hpdGVTcGFjZSA9IFwibm93cmFwXCI7XG5cdFx0XHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG5cdFx0XHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFRhYmxlRWxlbWVudCgpLmFwcGVuZENoaWxkKHRoaXMuaG92ZXJFbGVtZW50KTtcblxuXHRcdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUubGVmdCA9IFwiMFwiO1xuXHRcdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUudG9wID0gXCIwXCI7XG5cblx0XHRcdHRoaXMuX2JpbmRNb3VzZU1vdmUoKTtcblx0XHR9XG5cblx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy5tb3ZlSG92ZXIpO1xuXHRcdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy5lbmRNb3ZlKTtcblxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInJvd01vdmluZ1wiLCByb3cuZ2V0Q29tcG9uZW50KCkpO1xuXG5cdFx0dGhpcy5tb3ZlSG92ZXIoZSk7XG5cdH1cblxuXHRzZXRTdGFydFBvc2l0aW9uKGUsIHJvdyl7XG5cdFx0dmFyIHBhZ2VYID0gdGhpcy50b3VjaE1vdmUgPyBlLnRvdWNoZXNbMF0ucGFnZVggOiBlLnBhZ2VYLFxuXHRcdHBhZ2VZID0gdGhpcy50b3VjaE1vdmUgPyBlLnRvdWNoZXNbMF0ucGFnZVkgOiBlLnBhZ2VZLFxuXHRcdGVsZW1lbnQsIHBvc2l0aW9uO1xuXG5cdFx0ZWxlbWVudCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cdFx0aWYodGhpcy5jb25uZWN0aW9uKXtcblx0XHRcdHBvc2l0aW9uID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuXHRcdFx0dGhpcy5zdGFydFggPSBwb3NpdGlvbi5sZWZ0IC0gcGFnZVggKyB3aW5kb3cucGFnZVhPZmZzZXQ7XG5cdFx0XHR0aGlzLnN0YXJ0WSA9IHBvc2l0aW9uLnRvcCAtIHBhZ2VZICsgd2luZG93LnBhZ2VZT2Zmc2V0O1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuc3RhcnRZID0gKHBhZ2VZIC0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3ApO1xuXHRcdH1cblx0fVxuXG5cdGVuZE1vdmUoZSl7XG5cdFx0aWYoIWUgfHwgZS53aGljaCA9PT0gMSB8fCB0aGlzLnRvdWNoTW92ZSl7XG5cdFx0XHR0aGlzLl91bmJpbmRNb3VzZU1vdmUoKTtcblxuXHRcdFx0aWYoIXRoaXMuY29ubmVjdGlvbil7XG5cdFx0XHRcdHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMubW92aW5nLmdldEVsZW1lbnQoKSwgdGhpcy5wbGFjZWhvbGRlckVsZW1lbnQubmV4dFNpYmxpbmcpO1xuXHRcdFx0XHR0aGlzLnBsYWNlaG9sZGVyRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMucGxhY2Vob2xkZXJFbGVtZW50KTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5ob3ZlckVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmhvdmVyRWxlbWVudCk7XG5cblx0XHRcdHRoaXMudGFibGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblxuXHRcdFx0aWYodGhpcy50b1Jvdyl7XG5cdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5tb3ZlUm93KHRoaXMubW92aW5nLCB0aGlzLnRvUm93LCB0aGlzLnRvUm93QWZ0ZXIpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJyb3dNb3ZlQ2FuY2VsbGVkXCIsIHRoaXMubW92aW5nLmdldENvbXBvbmVudCgpKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5tb3ZpbmcgPSBmYWxzZTtcblx0XHRcdHRoaXMudG9Sb3cgPSBmYWxzZTtcblx0XHRcdHRoaXMudG9Sb3dBZnRlciA9IGZhbHNlO1xuXG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy5tb3ZlSG92ZXIpO1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLmVuZE1vdmUpO1xuXG5cdFx0XHRpZih0aGlzLmNvbm5lY3Rpb24pe1xuXHRcdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1tb3Zpbmdyb3ctc2VuZGluZ1wiKTtcblx0XHRcdFx0dGhpcy5kaXNjb25uZWN0RnJvbVRhYmxlcygpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdG1vdmVSb3cocm93LCBhZnRlcil7XG5cdFx0dGhpcy50b1JvdyA9IHJvdztcblx0XHR0aGlzLnRvUm93QWZ0ZXIgPSBhZnRlcjtcblx0fVxuXG5cdG1vdmVIb3ZlcihlKXtcblx0XHRpZih0aGlzLmNvbm5lY3Rpb24pe1xuXHRcdFx0dGhpcy5tb3ZlSG92ZXJDb25uZWN0aW9ucy5jYWxsKHRoaXMsIGUpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMubW92ZUhvdmVyVGFibGUuY2FsbCh0aGlzLCBlKTtcblx0XHR9XG5cdH1cblxuXHRtb3ZlSG92ZXJUYWJsZShlKXtcblx0XHR2YXIgcm93SG9sZGVyID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldEVsZW1lbnQoKSxcblx0XHRzY3JvbGxUb3AgPSByb3dIb2xkZXIuc2Nyb2xsVG9wLFxuXHRcdHlQb3MgPSAoKHRoaXMudG91Y2hNb3ZlID8gZS50b3VjaGVzWzBdLnBhZ2VZIDogZS5wYWdlWSkgLSByb3dIb2xkZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wKSArIHNjcm9sbFRvcDtcblx0XHRcblx0XHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS50b3AgPSBNYXRoLm1pbih5UG9zIC0gdGhpcy5zdGFydFksIHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbEhlaWdodCAtIHRoaXMuaG92ZXJFbGVtZW50Lm9mZnNldEhlaWdodCkgKyBcInB4XCI7XG5cdH1cblxuXHRtb3ZlSG92ZXJDb25uZWN0aW9ucyhlKXtcblx0XHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS5sZWZ0ID0gKHRoaXMuc3RhcnRYICsgKHRoaXMudG91Y2hNb3ZlID8gZS50b3VjaGVzWzBdLnBhZ2VYIDogZS5wYWdlWCkpICsgXCJweFwiO1xuXHRcdHRoaXMuaG92ZXJFbGVtZW50LnN0eWxlLnRvcCA9ICh0aGlzLnN0YXJ0WSArICh0aGlzLnRvdWNoTW92ZSA/IGUudG91Y2hlc1swXS5wYWdlWSA6IGUucGFnZVkpKSArIFwicHhcIjtcblx0fVxuXG5cdGVsZW1lbnRSb3dEcm9wKGUsIGVsZW1lbnQsIHJvdyl7XG5cdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwibW92YWJsZVJvd3NFbGVtZW50RHJvcFwiLCBlLCBlbGVtZW50LCByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiBmYWxzZSk7XG5cdH1cblxuXHQvL2VzdGFibGlzaCBjb25uZWN0aW9uIHdpdGggb3RoZXIgdGFibGVzXG5cdGNvbm5lY3RUb1RhYmxlcyhyb3cpe1xuXHRcdHZhciBjb25uZWN0aW9uVGFibGVzO1xuXG5cdFx0aWYodGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzVGFibGVzKXtcblx0XHRcdGNvbm5lY3Rpb25UYWJsZXMgPSB0aGlzLmNvbW1zQ29ubmVjdGlvbnModGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzVGFibGVzKTtcblxuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwibW92YWJsZVJvd3NTZW5kaW5nU3RhcnRcIiwgY29ubmVjdGlvblRhYmxlcyk7XG5cblx0XHRcdHRoaXMuY29tbXNTZW5kKHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc1RhYmxlcywgXCJtb3ZlUm93XCIsIFwiY29ubmVjdFwiLCB7XG5cdFx0XHRcdHJvdzpyb3csXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRpZih0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNFbGVtZW50cyl7XG5cblx0XHRcdHRoaXMuY29ubmVjdGlvbkVsZW1lbnRzID0gW107XG5cblx0XHRcdGlmKCFBcnJheS5pc0FycmF5KHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc0VsZW1lbnRzKSl7XG5cdFx0XHRcdHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc0VsZW1lbnRzID0gW3RoaXMuY29ubmVjdGlvblNlbGVjdG9yc0VsZW1lbnRzXTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzRWxlbWVudHMuZm9yRWFjaCgocXVlcnkpID0+IHtcblx0XHRcdFx0aWYodHlwZW9mIHF1ZXJ5ID09PSBcInN0cmluZ1wiKXtcblx0XHRcdFx0XHR0aGlzLmNvbm5lY3Rpb25FbGVtZW50cyA9IHRoaXMuY29ubmVjdGlvbkVsZW1lbnRzLmNvbmNhdChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KSkpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5jb25uZWN0aW9uRWxlbWVudHMucHVzaChxdWVyeSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmNvbm5lY3Rpb25FbGVtZW50cy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG5cdFx0XHRcdHZhciBkcm9wRXZlbnQgPSAoZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuZWxlbWVudFJvd0Ryb3AoZSwgZWxlbWVudCwgdGhpcy5tb3ZpbmcpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgZHJvcEV2ZW50KTtcblx0XHRcdFx0ZWxlbWVudC50YWJ1bGF0b3JFbGVtZW50RHJvcEV2ZW50ID0gZHJvcEV2ZW50O1xuXG5cdFx0XHRcdGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1tb3Zpbmdyb3ctcmVjZWl2aW5nXCIpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cblx0Ly9kaXNjb25uZWN0IGZyb20gb3RoZXIgdGFibGVzXG5cdGRpc2Nvbm5lY3RGcm9tVGFibGVzKCl7XG5cdFx0dmFyIGNvbm5lY3Rpb25UYWJsZXM7XG5cblx0XHRpZih0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNUYWJsZXMpe1xuXHRcdFx0Y29ubmVjdGlvblRhYmxlcyA9IHRoaXMuY29tbXNDb25uZWN0aW9ucyh0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNUYWJsZXMpO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJtb3ZhYmxlUm93c1NlbmRpbmdTdG9wXCIsIGNvbm5lY3Rpb25UYWJsZXMpO1xuXG5cdFx0XHR0aGlzLmNvbW1zU2VuZCh0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNUYWJsZXMsIFwibW92ZVJvd1wiLCBcImRpc2Nvbm5lY3RcIik7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb25uZWN0aW9uRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuXHRcdFx0ZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLW1vdmluZ3Jvdy1yZWNlaXZpbmdcIik7XG5cdFx0XHRlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGVsZW1lbnQudGFidWxhdG9yRWxlbWVudERyb3BFdmVudCk7XG5cdFx0XHRkZWxldGUgZWxlbWVudC50YWJ1bGF0b3JFbGVtZW50RHJvcEV2ZW50O1xuXHRcdH0pO1xuXHR9XG5cblx0Ly9hY2NlcHQgaW5jb21taW5nIGNvbm5lY3Rpb25cblx0Y29ubmVjdCh0YWJsZSwgcm93KXtcblx0XHRpZighdGhpcy5jb25uZWN0ZWRUYWJsZSl7XG5cdFx0XHR0aGlzLmNvbm5lY3RlZFRhYmxlID0gdGFibGU7XG5cdFx0XHR0aGlzLmNvbm5lY3RlZFJvdyA9IHJvdztcblxuXHRcdFx0dGhpcy50YWJsZS5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItbW92aW5ncm93LXJlY2VpdmluZ1wiKTtcblxuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKCkuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdGlmKHJvdy50eXBlID09PSBcInJvd1wiICYmIHJvdy5tb2R1bGVzLm1vdmVSb3cgJiYgcm93Lm1vZHVsZXMubW92ZVJvdy5tb3VzZXVwKXtcblx0XHRcdFx0XHRyb3cuZ2V0RWxlbWVudCgpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2V1cCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLnRhYmxlUm93RHJvcEV2ZW50ID0gdGhpcy50YWJsZVJvd0Ryb3AuYmluZCh0aGlzKTtcblxuXHRcdFx0dGhpcy50YWJsZS5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMudGFibGVSb3dEcm9wRXZlbnQpO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJtb3ZhYmxlUm93c1JlY2VpdmluZ1N0YXJ0XCIsIHJvdywgdGFibGUpO1xuXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJNb3ZlIFJvdyBFcnJvciAtIFRhYmxlIGNhbm5vdCBhY2NlcHQgY29ubmVjdGlvbiwgYWxyZWFkeSBjb25uZWN0ZWQgdG8gdGFibGU6XCIsIHRoaXMuY29ubmVjdGVkVGFibGUpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdC8vY2xvc2UgaW5jb21pbmcgY29ubmVjdGlvblxuXHRkaXNjb25uZWN0KHRhYmxlKXtcblx0XHRpZih0YWJsZSA9PT0gdGhpcy5jb25uZWN0ZWRUYWJsZSl7XG5cdFx0XHR0aGlzLmNvbm5lY3RlZFRhYmxlID0gZmFsc2U7XG5cdFx0XHR0aGlzLmNvbm5lY3RlZFJvdyA9IGZhbHNlO1xuXG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1tb3Zpbmdyb3ctcmVjZWl2aW5nXCIpO1xuXG5cdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5mb3JFYWNoKChyb3cpID0+e1xuXHRcdFx0XHRpZihyb3cudHlwZSA9PT0gXCJyb3dcIiAmJiByb3cubW9kdWxlcy5tb3ZlUm93ICYmIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2V1cCl7XG5cdFx0XHRcdFx0cm93LmdldEVsZW1lbnQoKS5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCByb3cubW9kdWxlcy5tb3ZlUm93Lm1vdXNldXApO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy50YWJsZS5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMudGFibGVSb3dEcm9wRXZlbnQpO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJtb3ZhYmxlUm93c1JlY2VpdmluZ1N0b3BcIiwgdGFibGUpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIk1vdmUgUm93IEVycm9yIC0gdHJ5aW5nIHRvIGRpc2Nvbm5lY3QgZnJvbSBub24gY29ubmVjdGVkIHRhYmxlXCIpO1xuXHRcdH1cblx0fVxuXG5cdGRyb3BDb21wbGV0ZSh0YWJsZSwgcm93LCBzdWNjZXNzKXtcblx0XHR2YXIgc2VuZGVyID0gZmFsc2U7XG5cblx0XHRpZihzdWNjZXNzKXtcblxuXHRcdFx0c3dpdGNoKHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NTZW5kZXIpe1xuXHRcdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdFx0c2VuZGVyID0gTW92ZVJvd3Muc2VuZGVyc1t0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NTZW5kZXJdO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRcdHNlbmRlciA9IHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1NlbmRlcjtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblxuXHRcdFx0aWYoc2VuZGVyKXtcblx0XHRcdFx0c2VuZGVyLmNhbGwodGhpcywgdGhpcy5tb3ZpbmcgPyB0aGlzLm1vdmluZy5nZXRDb21wb25lbnQoKSA6IHVuZGVmaW5lZCwgcm93ID8gcm93LmdldENvbXBvbmVudCgpIDogdW5kZWZpbmVkLCB0YWJsZSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1NlbmRlcil7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiTW92ZXIgUm93IEVycm9yIC0gbm8gbWF0Y2hpbmcgc2VuZGVyIGZvdW5kOlwiLCB0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NTZW5kZXIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcIm1vdmFibGVSb3dzU2VudFwiLCB0aGlzLm1vdmluZy5nZXRDb21wb25lbnQoKSwgcm93ID8gcm93LmdldENvbXBvbmVudCgpIDogdW5kZWZpbmVkLCB0YWJsZSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwibW92YWJsZVJvd3NTZW50RmFpbGVkXCIsIHRoaXMubW92aW5nLmdldENvbXBvbmVudCgpLCByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiB1bmRlZmluZWQsIHRhYmxlKTtcblx0XHR9XG5cblx0XHR0aGlzLmVuZE1vdmUoKTtcblx0fVxuXG5cdHRhYmxlUm93RHJvcChlLCByb3cpe1xuXHRcdHZhciByZWNlaXZlciA9IGZhbHNlLFxuXHRcdHN1Y2Nlc3MgPSBmYWxzZTtcblxuXHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cblx0XHRzd2l0Y2godHlwZW9mIHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1JlY2VpdmVyKXtcblx0XHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdFx0cmVjZWl2ZXIgPSBNb3ZlUm93cy5yZWNlaXZlcnNbdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzUmVjZWl2ZXJdO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdHJlY2VpdmVyID0gdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzUmVjZWl2ZXI7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdGlmKHJlY2VpdmVyKXtcblx0XHRcdHN1Y2Nlc3MgPSByZWNlaXZlci5jYWxsKHRoaXMsIHRoaXMuY29ubmVjdGVkUm93LmdldENvbXBvbmVudCgpLCByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiB1bmRlZmluZWQsIHRoaXMuY29ubmVjdGVkVGFibGUpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIk1vdmVyIFJvdyBFcnJvciAtIG5vIG1hdGNoaW5nIHJlY2VpdmVyIGZvdW5kOlwiLCB0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NSZWNlaXZlcik7XG5cdFx0fVxuXG5cdFx0aWYoc3VjY2Vzcyl7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJtb3ZhYmxlUm93c1JlY2VpdmVkXCIsIHRoaXMuY29ubmVjdGVkUm93LmdldENvbXBvbmVudCgpLCByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiB1bmRlZmluZWQsIHRoaXMuY29ubmVjdGVkVGFibGUpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcIm1vdmFibGVSb3dzUmVjZWl2ZWRGYWlsZWRcIiwgdGhpcy5jb25uZWN0ZWRSb3cuZ2V0Q29tcG9uZW50KCksIHJvdyA/IHJvdy5nZXRDb21wb25lbnQoKSA6IHVuZGVmaW5lZCwgdGhpcy5jb25uZWN0ZWRUYWJsZSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb21tc1NlbmQodGhpcy5jb25uZWN0ZWRUYWJsZSwgXCJtb3ZlUm93XCIsIFwiZHJvcGNvbXBsZXRlXCIsIHtcblx0XHRcdHJvdzpyb3csXG5cdFx0XHRzdWNjZXNzOnN1Y2Nlc3MsXG5cdFx0fSk7XG5cdH1cblxuXHRjb21tc1JlY2VpdmVkKHRhYmxlLCBhY3Rpb24sIGRhdGEpe1xuXHRcdHN3aXRjaChhY3Rpb24pe1xuXHRcdFx0Y2FzZSBcImNvbm5lY3RcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuY29ubmVjdCh0YWJsZSwgZGF0YS5yb3cpO1xuXG5cdFx0XHRjYXNlIFwiZGlzY29ubmVjdFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5kaXNjb25uZWN0KHRhYmxlKTtcblxuXHRcdFx0Y2FzZSBcImRyb3Bjb21wbGV0ZVwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5kcm9wQ29tcGxldGUodGFibGUsIGRhdGEucm93LCBkYXRhLnN1Y2Nlc3MpO1xuXHRcdH1cblx0fVxufVxuXG52YXIgZGVmYXVsdE11dGF0b3JzID0ge307XG5cbmNsYXNzIE11dGF0b3IgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcIm11dGF0b3JcIjtcblxuXHQvL2xvYWQgZGVmYXVsdHNcblx0c3RhdGljIG11dGF0b3JzID0gZGVmYXVsdE11dGF0b3JzO1xuXG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cblx0XHR0aGlzLmFsbG93ZWRUeXBlcyA9IFtcIlwiLCBcImRhdGFcIiwgXCJlZGl0XCIsIFwiY2xpcGJvYXJkXCIsIFwiaW1wb3J0XCJdOyAvL2xpc3Qgb2YgbXV0YXRpb24gdHlwZXNcblx0XHR0aGlzLmVuYWJsZWQgPSB0cnVlO1xuXG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcIm11dGF0b3JcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcIm11dGF0b3JQYXJhbXNcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcIm11dGF0b3JEYXRhXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJtdXRhdG9yRGF0YVBhcmFtc1wiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwibXV0YXRvckVkaXRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcIm11dGF0b3JFZGl0UGFyYW1zXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJtdXRhdG9yQ2xpcGJvYXJkXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJtdXRhdG9yQ2xpcGJvYXJkUGFyYW1zXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJtdXRhdG9ySW1wb3J0XCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJtdXRhdG9ySW1wb3J0UGFyYW1zXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJtdXRhdGVMaW5rXCIpO1xuXHR9XG5cblx0aW5pdGlhbGl6ZSgpe1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC12YWx1ZS1jaGFuZ2luZ1wiLCB0aGlzLnRyYW5zZm9ybUNlbGwuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLXZhbHVlLWNoYW5nZWRcIiwgdGhpcy5tdXRhdGVMaW5rLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWxheW91dFwiLCB0aGlzLmluaXRpYWxpemVDb2x1bW4uYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctZGF0YS1pbml0LWJlZm9yZVwiLCB0aGlzLnJvd0RhdGFDaGFuZ2VkLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWRhdGEtY2hhbmdpbmdcIiwgdGhpcy5yb3dEYXRhQ2hhbmdlZC5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdHJvd0RhdGFDaGFuZ2VkKHJvdywgdGVtcERhdGEsIHVwZGF0ZWREYXRhKXtcblx0XHRyZXR1cm4gdGhpcy50cmFuc2Zvcm1Sb3codGVtcERhdGEsIFwiZGF0YVwiLCB1cGRhdGVkRGF0YSk7XG5cdH1cblxuXHQvL2luaXRpYWxpemUgY29sdW1uIG11dGF0b3Jcblx0aW5pdGlhbGl6ZUNvbHVtbihjb2x1bW4pe1xuXHRcdHZhciBtYXRjaCA9IGZhbHNlLFxuXHRcdGNvbmZpZyA9IHt9O1xuXG5cdFx0dGhpcy5hbGxvd2VkVHlwZXMuZm9yRWFjaCgodHlwZSkgPT4ge1xuXHRcdFx0dmFyIGtleSA9IFwibXV0YXRvclwiICsgKHR5cGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eXBlLnNsaWNlKDEpKSxcblx0XHRcdG11dGF0b3I7XG5cblx0XHRcdGlmKGNvbHVtbi5kZWZpbml0aW9uW2tleV0pe1xuXHRcdFx0XHRtdXRhdG9yID0gdGhpcy5sb29rdXBNdXRhdG9yKGNvbHVtbi5kZWZpbml0aW9uW2tleV0pO1xuXG5cdFx0XHRcdGlmKG11dGF0b3Ipe1xuXHRcdFx0XHRcdG1hdGNoID0gdHJ1ZTtcblxuXHRcdFx0XHRcdGNvbmZpZ1trZXldID0ge1xuXHRcdFx0XHRcdFx0bXV0YXRvcjptdXRhdG9yLFxuXHRcdFx0XHRcdFx0cGFyYW1zOiBjb2x1bW4uZGVmaW5pdGlvbltrZXkgKyBcIlBhcmFtc1wiXSB8fCB7fSxcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZihtYXRjaCl7XG5cdFx0XHRjb2x1bW4ubW9kdWxlcy5tdXRhdGUgPSBjb25maWc7XG5cdFx0fVxuXHR9XG5cblx0bG9va3VwTXV0YXRvcih2YWx1ZSl7XG5cdFx0dmFyIG11dGF0b3IgPSBmYWxzZTtcblxuXHRcdC8vc2V0IGNvbHVtbiBtdXRhdG9yXG5cdFx0c3dpdGNoKHR5cGVvZiB2YWx1ZSl7XG5cdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdGlmKE11dGF0b3IubXV0YXRvcnNbdmFsdWVdKXtcblx0XHRcdFx0XHRtdXRhdG9yID0gTXV0YXRvci5tdXRhdG9yc1t2YWx1ZV07XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJNdXRhdG9yIEVycm9yIC0gTm8gc3VjaCBtdXRhdG9yIGZvdW5kLCBpZ25vcmluZzogXCIsIHZhbHVlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdG11dGF0b3IgPSB2YWx1ZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG11dGF0b3I7XG5cdH1cblxuXHQvL2FwcGx5IG11dGF0b3IgdG8gcm93XG5cdHRyYW5zZm9ybVJvdyhkYXRhLCB0eXBlLCB1cGRhdGVkRGF0YSl7XG5cdFx0dmFyIGtleSA9IFwibXV0YXRvclwiICsgKHR5cGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eXBlLnNsaWNlKDEpKSxcblx0XHR2YWx1ZTtcblxuXHRcdC8vIGNvbnNvbGUubG9nKFwia2V5XCIsIGtleSlcblxuXHRcdGlmKHRoaXMuZW5hYmxlZCl7XG5cblx0XHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci50cmF2ZXJzZSgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdHZhciBtdXRhdG9yLCBwYXJhbXMsIGNvbXBvbmVudDtcblxuXHRcdFx0XHRpZihjb2x1bW4ubW9kdWxlcy5tdXRhdGUpe1xuXHRcdFx0XHRcdG11dGF0b3IgPSBjb2x1bW4ubW9kdWxlcy5tdXRhdGVba2V5XSB8fCBjb2x1bW4ubW9kdWxlcy5tdXRhdGUubXV0YXRvciB8fCBmYWxzZTtcblxuXHRcdFx0XHRcdGlmKG11dGF0b3Ipe1xuXHRcdFx0XHRcdFx0dmFsdWUgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZSh0eXBlb2YgdXBkYXRlZERhdGEgIT09IFwidW5kZWZpbmVkXCIgPyB1cGRhdGVkRGF0YSA6IGRhdGEpO1xuXG5cdFx0XHRcdFx0XHRpZigodHlwZSA9PSBcImRhdGFcIiAmJiAhdXBkYXRlZERhdGEpfHwgdHlwZW9mIHZhbHVlICE9PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdFx0XHRcdFx0Y29tcG9uZW50ID0gY29sdW1uLmdldENvbXBvbmVudCgpO1xuXHRcdFx0XHRcdFx0XHRwYXJhbXMgPSB0eXBlb2YgbXV0YXRvci5wYXJhbXMgPT09IFwiZnVuY3Rpb25cIiA/IG11dGF0b3IucGFyYW1zKHZhbHVlLCBkYXRhLCB0eXBlLCBjb21wb25lbnQpIDogbXV0YXRvci5wYXJhbXM7XG5cdFx0XHRcdFx0XHRcdGNvbHVtbi5zZXRGaWVsZFZhbHVlKGRhdGEsIG11dGF0b3IubXV0YXRvcih2YWx1ZSwgZGF0YSwgdHlwZSwgcGFyYW1zLCBjb21wb25lbnQpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBkYXRhO1xuXHR9XG5cblx0Ly9hcHBseSBtdXRhdG9yIHRvIG5ldyBjZWxsIHZhbHVlXG5cdHRyYW5zZm9ybUNlbGwoY2VsbCwgdmFsdWUpe1xuXHRcdGlmKGNlbGwuY29sdW1uLm1vZHVsZXMubXV0YXRlKXtcblx0XHRcdHZhciBtdXRhdG9yID0gY2VsbC5jb2x1bW4ubW9kdWxlcy5tdXRhdGUubXV0YXRvckVkaXQgfHwgY2VsbC5jb2x1bW4ubW9kdWxlcy5tdXRhdGUubXV0YXRvciB8fCBmYWxzZSxcblx0XHRcdHRlbXBEYXRhID0ge307XG5cblx0XHRcdGlmKG11dGF0b3Ipe1xuXHRcdFx0XHR0ZW1wRGF0YSA9IE9iamVjdC5hc3NpZ24odGVtcERhdGEsIGNlbGwucm93LmdldERhdGEoKSk7XG5cdFx0XHRcdGNlbGwuY29sdW1uLnNldEZpZWxkVmFsdWUodGVtcERhdGEsIHZhbHVlKTtcblx0XHRcdFx0cmV0dXJuIG11dGF0b3IubXV0YXRvcih2YWx1ZSwgdGVtcERhdGEsIFwiZWRpdFwiLCBtdXRhdG9yLnBhcmFtcywgY2VsbC5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9XG5cblx0bXV0YXRlTGluayhjZWxsKXtcblx0XHR2YXIgbGlua3MgPSBjZWxsLmNvbHVtbi5kZWZpbml0aW9uLm11dGF0ZUxpbms7XG5cblx0XHRpZihsaW5rcyl7XG5cdFx0XHRpZighQXJyYXkuaXNBcnJheShsaW5rcykpe1xuXHRcdFx0XHRsaW5rcyA9IFtsaW5rc107XG5cdFx0XHR9XG5cblx0XHRcdGxpbmtzLmZvckVhY2goKGxpbmspID0+IHtcblx0XHRcdFx0dmFyIGxpbmtDZWxsID0gY2VsbC5yb3cuZ2V0Q2VsbChsaW5rKTtcblxuXHRcdFx0XHRpZihsaW5rQ2VsbCl7XG5cdFx0XHRcdFx0bGlua0NlbGwuc2V0VmFsdWUobGlua0NlbGwuZ2V0VmFsdWUoKSwgdHJ1ZSwgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdGVuYWJsZSgpe1xuXHRcdHRoaXMuZW5hYmxlZCA9IHRydWU7XG5cdH1cblxuXHRkaXNhYmxlKCl7XG5cdFx0dGhpcy5lbmFibGVkID0gZmFsc2U7XG5cdH1cbn1cblxuZnVuY3Rpb24gcm93cyhwYWdlU2l6ZSwgY3VycmVudFJvdywgY3VycmVudFBhZ2UsIHRvdGFsUm93cywgdG90YWxQYWdlcyl7XG5cdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLFxuXHRzaG93aW5nRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxcblx0dmFsdWVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLFxuXHRvZkVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIiksXG5cdHRvdGFsRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxcblx0cm93c0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cblx0dGhpcy50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmxhbmdCaW5kKFwicGFnaW5hdGlvbnxjb3VudGVyfHNob3dpbmdcIiwgKHZhbHVlKSA9PiB7XG5cdFx0c2hvd2luZ0VsLmlubmVySFRNTCA9IHZhbHVlO1xuXHR9KTtcblxuXHR0aGlzLnRhYmxlLm1vZHVsZXMubG9jYWxpemUubGFuZ0JpbmQoXCJwYWdpbmF0aW9ufGNvdW50ZXJ8b2ZcIiwgKHZhbHVlKSA9PiB7XG5cdFx0b2ZFbC5pbm5lckhUTUwgPSB2YWx1ZTtcblx0fSk7XG5cblx0dGhpcy50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmxhbmdCaW5kKFwicGFnaW5hdGlvbnxjb3VudGVyfHJvd3NcIiwgKHZhbHVlKSA9PiB7XG5cdFx0cm93c0VsLmlubmVySFRNTCA9IHZhbHVlO1xuXHR9KTtcblxuXHRpZih0b3RhbFJvd3Mpe1xuXHRcdHZhbHVlRWwuaW5uZXJIVE1MID0gXCIgXCIgKyBjdXJyZW50Um93ICsgXCItXCIgKyBNYXRoLm1pbigoY3VycmVudFJvdyArIHBhZ2VTaXplIC0gMSksIHRvdGFsUm93cykgKyBcIiBcIjtcblx0XHRcblx0XHR0b3RhbEVsLmlubmVySFRNTCA9IFwiIFwiICsgdG90YWxSb3dzICsgXCIgXCI7XG5cdFx0XG5cdFx0ZWwuYXBwZW5kQ2hpbGQoc2hvd2luZ0VsKTtcblx0XHRlbC5hcHBlbmRDaGlsZCh2YWx1ZUVsKTtcblx0XHRlbC5hcHBlbmRDaGlsZChvZkVsKTtcblx0XHRlbC5hcHBlbmRDaGlsZCh0b3RhbEVsKTtcblx0XHRlbC5hcHBlbmRDaGlsZChyb3dzRWwpO1xuXHR9ZWxzZSB7XG5cdFx0dmFsdWVFbC5pbm5lckhUTUwgPSBcIiAwIFwiO1xuXG5cdFx0ZWwuYXBwZW5kQ2hpbGQoc2hvd2luZ0VsKTtcblx0XHRlbC5hcHBlbmRDaGlsZCh2YWx1ZUVsKTtcblx0XHRlbC5hcHBlbmRDaGlsZChyb3dzRWwpO1xuXHR9XG5cdFxuXHRyZXR1cm4gZWw7XG59XG5cbmZ1bmN0aW9uIHBhZ2VzKHBhZ2VTaXplLCBjdXJyZW50Um93LCBjdXJyZW50UGFnZSwgdG90YWxSb3dzLCB0b3RhbFBhZ2VzKXtcblxuXHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxcblx0c2hvd2luZ0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIiksXG5cdHZhbHVlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxcblx0b2ZFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLFxuXHR0b3RhbEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIiksXG5cdHJvd3NFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHRcblx0dGhpcy50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmxhbmdCaW5kKFwicGFnaW5hdGlvbnxjb3VudGVyfHNob3dpbmdcIiwgKHZhbHVlKSA9PiB7XG5cdFx0c2hvd2luZ0VsLmlubmVySFRNTCA9IHZhbHVlO1xuXHR9KTtcblx0XG5cdHZhbHVlRWwuaW5uZXJIVE1MID0gXCIgXCIgKyBjdXJyZW50UGFnZSArIFwiIFwiO1xuXHRcblx0dGhpcy50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmxhbmdCaW5kKFwicGFnaW5hdGlvbnxjb3VudGVyfG9mXCIsICh2YWx1ZSkgPT4ge1xuXHRcdG9mRWwuaW5uZXJIVE1MID0gdmFsdWU7XG5cdH0pO1xuXHRcblx0dG90YWxFbC5pbm5lckhUTUwgPSBcIiBcIiArIHRvdGFsUGFnZXMgKyBcIiBcIjtcblx0XG5cdHRoaXMudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5sYW5nQmluZChcInBhZ2luYXRpb258Y291bnRlcnxwYWdlc1wiLCAodmFsdWUpID0+IHtcblx0XHRyb3dzRWwuaW5uZXJIVE1MID0gdmFsdWU7XG5cdH0pO1xuXHRcblx0ZWwuYXBwZW5kQ2hpbGQoc2hvd2luZ0VsKTtcblx0ZWwuYXBwZW5kQ2hpbGQodmFsdWVFbCk7XG5cdGVsLmFwcGVuZENoaWxkKG9mRWwpO1xuXHRlbC5hcHBlbmRDaGlsZCh0b3RhbEVsKTtcblx0ZWwuYXBwZW5kQ2hpbGQocm93c0VsKTtcblx0XG5cdHJldHVybiBlbDtcbn1cblxudmFyIGRlZmF1bHRQYWdlQ291bnRlcnMgPSB7XG5cdHJvd3M6cm93cyxcblx0cGFnZXM6cGFnZXMsXG59O1xuXG5jbGFzcyBQYWdlIGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJwYWdlXCI7XG5cblx0Ly9sb2FkIGRlZmF1bHRzXG5cdHN0YXRpYyBwYWdlQ291bnRlcnMgPSBkZWZhdWx0UGFnZUNvdW50ZXJzO1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLm1vZGUgPSBcImxvY2FsXCI7XG5cdFx0dGhpcy5wcm9ncmVzc2l2ZUxvYWQgPSBmYWxzZTtcblx0XHRcblx0XHR0aGlzLmVsZW1lbnQgPSBudWxsO1xuXHRcdHRoaXMucGFnZUNvdW50ZXJFbGVtZW50ID0gbnVsbDtcblx0XHR0aGlzLnBhZ2VDb3VudGVyID0gbnVsbDtcblx0XHRcblx0XHR0aGlzLnNpemUgPSAwO1xuXHRcdHRoaXMucGFnZSA9IDE7XG5cdFx0dGhpcy5jb3VudCA9IDU7XG5cdFx0dGhpcy5tYXggPSAxO1xuXG5cdFx0dGhpcy5yZW1vdGVSb3dDb3VudEVzdGltYXRlID0gbnVsbDtcblx0XHRcblx0XHR0aGlzLmluaXRpYWxMb2FkID0gdHJ1ZTtcblx0XHR0aGlzLmRhdGFDaGFuZ2luZyA9IGZhbHNlOyAvL2ZsYWcgdG8gY2hlY2sgaWYgZGF0YSBpcyBiZWluZyBjaGFuZ2VkIGJ5IHRoaXMgbW9kdWxlXG5cdFx0XG5cdFx0dGhpcy5wYWdlU2l6ZXMgPSBbXTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwYWdpbmF0aW9uXCIsIGZhbHNlKTsgLy9zZXQgcGFnaW5hdGlvbiB0eXBlXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicGFnaW5hdGlvbk1vZGVcIiwgXCJsb2NhbFwiKTsgLy9sb2NhbCBvciByZW1vdGUgcGFnaW5hdGlvblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInBhZ2luYXRpb25TaXplXCIsIGZhbHNlKTsgLy9zZXQgbnVtYmVyIG9mIHJvd3MgdG8gYSBwYWdlXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicGFnaW5hdGlvbkluaXRpYWxQYWdlXCIsIDEpOyAvL2luaXRpYWwgcGFnZSB0byBzaG93IG9uIGxvYWRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwYWdpbmF0aW9uQ291bnRlclwiLCBmYWxzZSk7ICAvLyBzZXQgcGFnaW5hdGlvbiBjb3VudGVyXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicGFnaW5hdGlvbkNvdW50ZXJFbGVtZW50XCIsIGZhbHNlKTsgIC8vIHNldCBwYWdpbmF0aW9uIGNvdW50ZXJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwYWdpbmF0aW9uQnV0dG9uQ291bnRcIiwgNSk7ICAvLyBzZXQgY291bnQgb2YgcGFnZSBidXR0b25cblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwYWdpbmF0aW9uU2l6ZVNlbGVjdG9yXCIsIGZhbHNlKTsgLy9hZGQgcGFnaW5hdGlvbiBzaXplIHNlbGVjdG9yIGVsZW1lbnRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwYWdpbmF0aW9uRWxlbWVudFwiLCBmYWxzZSk7IC8vZWxlbWVudCB0byBob2xkIHBhZ2luYXRpb24gbnVtYmVyc1xuXHRcdC8vIHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInBhZ2luYXRpb25EYXRhU2VudFwiLCB7fSk7IC8vcGFnaW5hdGlvbiBkYXRhIHNlbnQgdG8gdGhlIHNlcnZlclxuXHRcdC8vIHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInBhZ2luYXRpb25EYXRhUmVjZWl2ZWRcIiwge30pOyAvL3BhZ2luYXRpb24gZGF0YSByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwYWdpbmF0aW9uQWRkUm93XCIsIFwicGFnZVwiKTsgLy9hZGQgcm93cyBvbiB0YWJsZSBvciBwYWdlXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicGFnaW5hdGlvbk91dE9mUmFuZ2VcIiwgZmFsc2UpOyAvL3Jlc2V0IHRoZSBjdXJyZW50IHBhZ2Ugd2hlbiB0aGUgbGFzdCBwYWdlIDwgdGhpcy5wYWdlLCB2YWx1ZXM6IGZhbHNlfGZ1bmN0aW9ufGFueSB2YWx1ZSBhY2NlcHRlZCBieSBzZXRQYWdlKClcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwcm9ncmVzc2l2ZUxvYWRcIiwgZmFsc2UpOyAvL3Byb2dyZXNzaXZlIGxvYWRpbmdcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwcm9ncmVzc2l2ZUxvYWREZWxheVwiLCAwKTsgLy9kZWxheSBiZXR3ZWVuIHJlcXVlc3RzXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicHJvZ3Jlc3NpdmVMb2FkU2Nyb2xsTWFyZ2luXCIsIDApOyAvL21hcmdpbiBiZWZvcmUgc2Nyb2xsIGJlZ2luc1xuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwic2V0TWF4UGFnZVwiLCB0aGlzLnNldE1heFBhZ2UuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJzZXRQYWdlXCIsIHRoaXMuc2V0UGFnZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInNldFBhZ2VUb1Jvd1wiLCB0aGlzLnVzZXJTZXRQYWdlVG9Sb3cuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJzZXRQYWdlU2l6ZVwiLCB0aGlzLnVzZXJTZXRQYWdlU2l6ZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImdldFBhZ2VTaXplXCIsIHRoaXMuZ2V0UGFnZVNpemUuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJwcmV2aW91c1BhZ2VcIiwgdGhpcy5wcmV2aW91c1BhZ2UuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJuZXh0UGFnZVwiLCB0aGlzLm5leHRQYWdlLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0UGFnZVwiLCB0aGlzLmdldFBhZ2UuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRQYWdlTWF4XCIsIHRoaXMuZ2V0UGFnZU1heC5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHQvL3JlZ2lzdGVyIGNvbXBvbmVudCBmdW5jdGlvbnNcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJyb3dcIiwgXCJwYWdlVG9cIiwgdGhpcy5zZXRQYWdlVG9Sb3cuYmluZCh0aGlzKSk7XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbil7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1kZWxldGVkXCIsIHRoaXMucm93c1VwZGF0ZWQuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1hZGRlZFwiLCB0aGlzLnJvd3NVcGRhdGVkLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJkYXRhLXByb2Nlc3NlZFwiLCB0aGlzLmluaXRpYWxMb2FkQ29tcGxldGUuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLWJ1aWx0XCIsIHRoaXMuY2FsY3VsYXRlUGFnZVNpemVzLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJmb290ZXItcmVkcmF3XCIsIHRoaXMuZm9vdGVyUmVkcmF3LmJpbmQodGhpcykpO1xuXG5cdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbkFkZFJvdyA9PSBcInBhZ2VcIil7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWFkZGluZy1wb3NpdGlvblwiLCB0aGlzLnJvd0FkZGluZ1Bvc2l0aW9uLmJpbmQodGhpcykpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbk1vZGUgPT09IFwicmVtb3RlXCIpe1xuXHRcdFx0XHR0aGlzLnN1YnNjcmliZShcImRhdGEtcGFyYW1zXCIsIHRoaXMucmVtb3RlUGFnZVBhcmFtcy5iaW5kKHRoaXMpKTtcblx0XHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJkYXRhLWxvYWRlZFwiLCB0aGlzLl9wYXJzZVJlbW90ZURhdGEuYmluZCh0aGlzKSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5wcm9ncmVzc2l2ZUxvYWQpe1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwiUHJvZ3Jlc3NpdmUgTG9hZCBFcnJvciAtIFBhZ2luYXRpb24gYW5kIHByb2dyZXNzaXZlIGxvYWQgY2Fubm90IGJlIHVzZWQgYXQgdGhlIHNhbWUgdGltZVwiKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5yZWdpc3RlckRpc3BsYXlIYW5kbGVyKHRoaXMucmVzdE9uUmVuZGVyQmVmb3JlLmJpbmQodGhpcyksIDQwKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJEaXNwbGF5SGFuZGxlcih0aGlzLmdldFJvd3MuYmluZCh0aGlzKSwgNTApO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmNyZWF0ZUVsZW1lbnRzKCk7XG5cdFx0XHR0aGlzLmluaXRpYWxpemVQYWdlQ291bnRlcigpO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplUGFnaW5hdG9yKCk7XG5cdFx0fWVsc2UgaWYodGhpcy50YWJsZS5vcHRpb25zLnByb2dyZXNzaXZlTG9hZCl7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImRhdGEtcGFyYW1zXCIsIHRoaXMucmVtb3RlUGFnZVBhcmFtcy5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1sb2FkZWRcIiwgdGhpcy5fcGFyc2VSZW1vdGVEYXRhLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1idWlsdFwiLCB0aGlzLmNhbGN1bGF0ZVBhZ2VTaXplcy5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1wcm9jZXNzZWRcIiwgdGhpcy5pbml0aWFsTG9hZENvbXBsZXRlLmJpbmQodGhpcykpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmluaXRpYWxpemVQcm9ncmVzc2l2ZSh0aGlzLnRhYmxlLm9wdGlvbnMucHJvZ3Jlc3NpdmVMb2FkKTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnByb2dyZXNzaXZlTG9hZCA9PT0gXCJzY3JvbGxcIil7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlKFwic2Nyb2xsLXZlcnRpY2FsXCIsIHRoaXMuc2Nyb2xsVmVydGljYWwuYmluZCh0aGlzKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRyb3dBZGRpbmdQb3NpdGlvbihyb3csIHRvcCl7XG5cdFx0dmFyIHJvd01hbmFnZXIgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIsXG5cdFx0ZGlzcGxheVJvd3MgPSByb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKCksXG5cdFx0aW5kZXg7XG5cdFx0XG5cdFx0aWYodG9wKXtcblx0XHRcdGlmKGRpc3BsYXlSb3dzLmxlbmd0aCl7XG5cdFx0XHRcdGluZGV4ID0gZGlzcGxheVJvd3NbMF07XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKHJvd01hbmFnZXIuYWN0aXZlUm93cy5sZW5ndGgpe1xuXHRcdFx0XHRcdGluZGV4ID0gcm93TWFuYWdlci5hY3RpdmVSb3dzW3Jvd01hbmFnZXIuYWN0aXZlUm93cy5sZW5ndGgtMV07XG5cdFx0XHRcdFx0dG9wID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRpZihkaXNwbGF5Um93cy5sZW5ndGgpe1xuXHRcdFx0XHRpbmRleCA9IGRpc3BsYXlSb3dzW2Rpc3BsYXlSb3dzLmxlbmd0aCAtIDFdO1xuXHRcdFx0XHR0b3AgPSBkaXNwbGF5Um93cy5sZW5ndGggPCB0aGlzLnNpemUgPyBmYWxzZSA6IHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB7aW5kZXgsIHRvcH07XG5cdH1cblx0XG5cdGNhbGN1bGF0ZVBhZ2VTaXplcygpe1xuXHRcdHZhciB0ZXN0RWxSb3csIHRlc3RFbENlbGw7XG5cdFx0XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25TaXplKXtcblx0XHRcdHRoaXMuc2l6ZSA9IHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uU2l6ZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0ZXN0RWxSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0dGVzdEVsUm93LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itcm93XCIpO1xuXHRcdFx0dGVzdEVsUm93LnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuXHRcdFx0XG5cdFx0XHR0ZXN0RWxDZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdHRlc3RFbENlbGwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jZWxsXCIpO1xuXHRcdFx0dGVzdEVsQ2VsbC5pbm5lckhUTUwgPSBcIlBhZ2UgUm93IFRlc3RcIjtcblx0XHRcdFxuXHRcdFx0dGVzdEVsUm93LmFwcGVuZENoaWxkKHRlc3RFbENlbGwpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0VGFibGVFbGVtZW50KCkuYXBwZW5kQ2hpbGQodGVzdEVsUm93KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5zaXplID0gTWF0aC5mbG9vcih0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RWxlbWVudCgpLmNsaWVudEhlaWdodCAvIHRlc3RFbFJvdy5vZmZzZXRIZWlnaHQpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0VGFibGVFbGVtZW50KCkucmVtb3ZlQ2hpbGQodGVzdEVsUm93KTtcblx0XHR9XG5cblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJwYWdlU2l6ZUNoYW5nZWRcIiwgdGhpcy5zaXplKTtcblx0XHRcblx0XHR0aGlzLmdlbmVyYXRlUGFnZVNpemVTZWxlY3RMaXN0KCk7XG5cdH1cblx0XG5cdGluaXRpYWxMb2FkQ29tcGxldGUoKXtcblx0XHR0aGlzLmluaXRpYWxMb2FkID0gZmFsc2U7XG5cdH1cblx0XG5cdHJlbW90ZVBhZ2VQYXJhbXMoZGF0YSwgY29uZmlnLCBzaWxlbnQsIHBhcmFtcyl7XG5cdFx0aWYoIXRoaXMuaW5pdGlhbExvYWQpe1xuXHRcdFx0aWYoKHRoaXMucHJvZ3Jlc3NpdmVMb2FkICYmICFzaWxlbnQpIHx8ICghdGhpcy5wcm9ncmVzc2l2ZUxvYWQgJiYgIXRoaXMuZGF0YUNoYW5naW5nKSl7XG5cdFx0XHRcdHRoaXMucmVzZXQodHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vY29uZmlndXJlIHJlcXVlc3QgcGFyYW1zXG5cdFx0cGFyYW1zLnBhZ2UgPSB0aGlzLnBhZ2U7XG5cdFx0XG5cdFx0Ly9zZXQgcGFnZSBzaXplIGlmIGRlZmluZWRcblx0XHRpZih0aGlzLnNpemUpe1xuXHRcdFx0cGFyYW1zLnNpemUgPSB0aGlzLnNpemU7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBwYXJhbXM7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBUYWJsZSBGdW5jdGlvbnMgLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHR1c2VyU2V0UGFnZVRvUm93KHJvdyl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb24pe1xuXHRcdFx0cm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpbmRSb3cocm93KTtcblx0XHRcdFxuXHRcdFx0aWYocm93KXtcblx0XHRcdFx0cmV0dXJuIHRoaXMuc2V0UGFnZVRvUm93KHJvdyk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuXHR9XG5cdFxuXHR1c2VyU2V0UGFnZVNpemUoc2l6ZSl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb24pe1xuXHRcdFx0dGhpcy5zZXRQYWdlU2l6ZShzaXplKTtcblx0XHRcdHJldHVybiB0aGlzLnNldFBhZ2UoMSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gSW50ZXJuYWwgTG9naWMgLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0c2Nyb2xsVmVydGljYWwodG9wLCBkaXIpe1xuXHRcdHZhciBlbGVtZW50LCBkaWZmLCBtYXJnaW47XG5cdFx0aWYoIWRpciAmJiAhdGhpcy50YWJsZS5kYXRhTG9hZGVyLmxvYWRpbmcpe1xuXHRcdFx0ZWxlbWVudCA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRFbGVtZW50KCk7XG5cdFx0XHRkaWZmID0gZWxlbWVudC5zY3JvbGxIZWlnaHQgLSBlbGVtZW50LmNsaWVudEhlaWdodCAtIHRvcDtcblx0XHRcdG1hcmdpbiA9IHRoaXMudGFibGUub3B0aW9ucy5wcm9ncmVzc2l2ZUxvYWRTY3JvbGxNYXJnaW4gfHwgKGVsZW1lbnQuY2xpZW50SGVpZ2h0ICogMik7XG5cdFx0XHRcblx0XHRcdGlmKGRpZmYgPCBtYXJnaW4pe1xuXHRcdFx0XHR0aGlzLm5leHRQYWdlKClcblx0XHRcdFx0XHQuY2F0Y2goKCkgPT4ge30pOyAvL2NvbnN1bWUgdGhlIGV4Y2VwdGlvbiB0aHJvd24gd2hlbiBvbiB0aGUgbGFzdCBwYWdlXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRyZXN0T25SZW5kZXJCZWZvcmUocm93cywgcmVuZGVySW5Qb3NpdGlvbil7XG5cdFx0aWYoIXJlbmRlckluUG9zaXRpb24pe1xuXHRcdFx0aWYodGhpcy5tb2RlID09PSBcImxvY2FsXCIpe1xuXHRcdFx0XHR0aGlzLnJlc2V0KCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiByb3dzO1xuXHR9XG5cdFxuXHRyb3dzVXBkYXRlZCgpe1xuXHRcdHRoaXMucmVmcmVzaERhdGEodHJ1ZSwgXCJhbGxcIik7XG5cdH1cblx0XG5cdGNyZWF0ZUVsZW1lbnRzKCl7XG5cdFx0dmFyIGJ1dHRvbjtcblx0XHRcblx0XHR0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wYWdpbmF0b3JcIik7XG5cdFx0XG5cdFx0dGhpcy5wYWdlc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHR0aGlzLnBhZ2VzRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXBhZ2VzXCIpO1xuXHRcdFxuXHRcdGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cdFx0YnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcGFnZVwiKTtcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImJ1dHRvblwiKTtcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImJ1dHRvblwiKTtcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIlwiKTtcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgXCJcIik7XG5cdFx0XG5cdFx0dGhpcy5maXJzdEJ1dCA9IGJ1dHRvbi5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0dGhpcy5maXJzdEJ1dC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXBhZ2VcIiwgXCJmaXJzdFwiKTtcblx0XHRcblx0XHR0aGlzLnByZXZCdXQgPSBidXR0b24uY2xvbmVOb2RlKHRydWUpO1xuXHRcdHRoaXMucHJldkJ1dC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXBhZ2VcIiwgXCJwcmV2XCIpO1xuXHRcdFxuXHRcdHRoaXMubmV4dEJ1dCA9IGJ1dHRvbi5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0dGhpcy5uZXh0QnV0LnNldEF0dHJpYnV0ZShcImRhdGEtcGFnZVwiLCBcIm5leHRcIik7XG5cdFx0XG5cdFx0dGhpcy5sYXN0QnV0ID0gYnV0dG9uLmNsb25lTm9kZSh0cnVlKTtcblx0XHR0aGlzLmxhc3RCdXQuc2V0QXR0cmlidXRlKFwiZGF0YS1wYWdlXCIsIFwibGFzdFwiKTtcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvblNpemVTZWxlY3Rvcil7XG5cdFx0XHR0aGlzLnBhZ2VTaXplU2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcblx0XHRcdHRoaXMucGFnZVNpemVTZWxlY3QuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wYWdlLXNpemVcIik7XG5cdFx0fVxuXHR9XG5cdFxuXHRnZW5lcmF0ZVBhZ2VTaXplU2VsZWN0TGlzdCgpe1xuXHRcdHZhciBwYWdlU2l6ZXMgPSBbXTtcblx0XHRcblx0XHRpZih0aGlzLnBhZ2VTaXplU2VsZWN0KXtcblx0XHRcdFxuXHRcdFx0aWYoQXJyYXkuaXNBcnJheSh0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvblNpemVTZWxlY3Rvcikpe1xuXHRcdFx0XHRwYWdlU2l6ZXMgPSB0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvblNpemVTZWxlY3Rvcjtcblx0XHRcdFx0dGhpcy5wYWdlU2l6ZXMgPSBwYWdlU2l6ZXM7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLnBhZ2VTaXplcy5pbmRleE9mKHRoaXMuc2l6ZSkgPT0gLTEpe1xuXHRcdFx0XHRcdHBhZ2VTaXplcy51bnNoaWZ0KHRoaXMuc2l6ZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHRoaXMucGFnZVNpemVzLmluZGV4T2YodGhpcy5zaXplKSA9PSAtMSl7XG5cdFx0XHRcdFx0cGFnZVNpemVzID0gW107XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Zm9yIChsZXQgaSA9IDE7IGkgPCA1OyBpKyspe1xuXHRcdFx0XHRcdFx0cGFnZVNpemVzLnB1c2godGhpcy5zaXplICogaSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMucGFnZVNpemVzID0gcGFnZVNpemVzO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0cGFnZVNpemVzID0gdGhpcy5wYWdlU2l6ZXM7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0d2hpbGUodGhpcy5wYWdlU2l6ZVNlbGVjdC5maXJzdENoaWxkKSB0aGlzLnBhZ2VTaXplU2VsZWN0LnJlbW92ZUNoaWxkKHRoaXMucGFnZVNpemVTZWxlY3QuZmlyc3RDaGlsZCk7XG5cdFx0XHRcblx0XHRcdHBhZ2VTaXplcy5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRcdHZhciBpdGVtRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuXHRcdFx0XHRpdGVtRWwudmFsdWUgPSBpdGVtO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoaXRlbSA9PT0gdHJ1ZSl7XG5cdFx0XHRcdFx0dGhpcy5sYW5nQmluZChcInBhZ2luYXRpb258YWxsXCIsIGZ1bmN0aW9uKHZhbHVlKXtcblx0XHRcdFx0XHRcdGl0ZW1FbC5pbm5lckhUTUwgPSB2YWx1ZTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGl0ZW1FbC5pbm5lckhUTUwgPSBpdGVtO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMucGFnZVNpemVTZWxlY3QuYXBwZW5kQ2hpbGQoaXRlbUVsKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnBhZ2VTaXplU2VsZWN0LnZhbHVlID0gdGhpcy5zaXplO1xuXHRcdH1cblx0fVxuXHRcblx0aW5pdGlhbGl6ZVBhZ2VDb3VudGVyKCl7XG5cdFx0dmFyIGNvdW50ZXIgPSB0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbkNvdW50ZXIsXG5cdFx0cGFnZUNvdW50ZXIgPSBudWxsO1xuXHRcdFxuXHRcdGlmKGNvdW50ZXIpe1xuXHRcdFx0aWYodHlwZW9mIGNvdW50ZXIgPT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdHBhZ2VDb3VudGVyID0gY291bnRlcjtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0cGFnZUNvdW50ZXIgPSBQYWdlLnBhZ2VDb3VudGVyc1tjb3VudGVyXTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYocGFnZUNvdW50ZXIpe1xuXHRcdFx0XHR0aGlzLnBhZ2VDb3VudGVyID0gcGFnZUNvdW50ZXI7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnBhZ2VDb3VudGVyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHRcdFx0XHR0aGlzLnBhZ2VDb3VudGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXBhZ2UtY291bnRlclwiKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiUGFnaW5hdGlvbiBFcnJvciAtIE5vIHN1Y2ggcGFnZSBjb3VudGVyIGZvdW5kOiBcIiwgY291bnRlcik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3NldHVwIHBhZ2luYXRpb25cblx0aW5pdGlhbGl6ZVBhZ2luYXRvcihoaWRkZW4pe1xuXHRcdHZhciBwYWdlU2VsZWN0TGFiZWwsIHBhZ2luYXRpb25Db3VudGVySG9sZGVyO1xuXHRcdFxuXHRcdGlmKCFoaWRkZW4pe1xuXHRcdFx0Ly9idWlsZCBwYWdpbmF0aW9uIGVsZW1lbnRcblx0XHRcdFxuXHRcdFx0Ly9iaW5kIGxvY2FsaXphdGlvbnNcblx0XHRcdHRoaXMubGFuZ0JpbmQoXCJwYWdpbmF0aW9ufGZpcnN0XCIsICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLmZpcnN0QnV0LmlubmVySFRNTCA9IHZhbHVlO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMubGFuZ0JpbmQoXCJwYWdpbmF0aW9ufGZpcnN0X3RpdGxlXCIsICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLmZpcnN0QnV0LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgdmFsdWUpO1xuXHRcdFx0XHR0aGlzLmZpcnN0QnV0LnNldEF0dHJpYnV0ZShcInRpdGxlXCIsIHZhbHVlKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmxhbmdCaW5kKFwicGFnaW5hdGlvbnxwcmV2XCIsICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLnByZXZCdXQuaW5uZXJIVE1MID0gdmFsdWU7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5sYW5nQmluZChcInBhZ2luYXRpb258cHJldl90aXRsZVwiLCAodmFsdWUpID0+IHtcblx0XHRcdFx0dGhpcy5wcmV2QnV0LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgdmFsdWUpO1xuXHRcdFx0XHR0aGlzLnByZXZCdXQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdmFsdWUpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMubGFuZ0JpbmQoXCJwYWdpbmF0aW9ufG5leHRcIiwgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdHRoaXMubmV4dEJ1dC5pbm5lckhUTUwgPSB2YWx1ZTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmxhbmdCaW5kKFwicGFnaW5hdGlvbnxuZXh0X3RpdGxlXCIsICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLm5leHRCdXQuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCB2YWx1ZSk7XG5cdFx0XHRcdHRoaXMubmV4dEJ1dC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCB2YWx1ZSk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5sYW5nQmluZChcInBhZ2luYXRpb258bGFzdFwiLCAodmFsdWUpID0+IHtcblx0XHRcdFx0dGhpcy5sYXN0QnV0LmlubmVySFRNTCA9IHZhbHVlO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMubGFuZ0JpbmQoXCJwYWdpbmF0aW9ufGxhc3RfdGl0bGVcIiwgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdHRoaXMubGFzdEJ1dC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHZhbHVlKTtcblx0XHRcdFx0dGhpcy5sYXN0QnV0LnNldEF0dHJpYnV0ZShcInRpdGxlXCIsIHZhbHVlKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvL2NsaWNrIGJpbmRpbmdzXG5cdFx0XHR0aGlzLmZpcnN0QnV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuc2V0UGFnZSgxKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnByZXZCdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblx0XHRcdFx0dGhpcy5wcmV2aW91c1BhZ2UoKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLm5leHRCdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblx0XHRcdFx0dGhpcy5uZXh0UGFnZSgpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMubGFzdEJ1dC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNldFBhZ2UodGhpcy5tYXgpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uRWxlbWVudCl7XG5cdFx0XHRcdHRoaXMuZWxlbWVudCA9IHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uRWxlbWVudDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYodGhpcy5wYWdlU2l6ZVNlbGVjdCl7XG5cdFx0XHRcdHBhZ2VTZWxlY3RMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMubGFuZ0JpbmQoXCJwYWdpbmF0aW9ufHBhZ2Vfc2l6ZVwiLCAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBhZ2VTaXplU2VsZWN0LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgdmFsdWUpO1xuXHRcdFx0XHRcdHRoaXMucGFnZVNpemVTZWxlY3Quc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdmFsdWUpO1xuXHRcdFx0XHRcdHBhZ2VTZWxlY3RMYWJlbC5pbm5lckhUTUwgPSB2YWx1ZTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQocGFnZVNlbGVjdExhYmVsKTtcblx0XHRcdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMucGFnZVNpemVTZWxlY3QpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5wYWdlU2l6ZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5zZXRQYWdlU2l6ZSh0aGlzLnBhZ2VTaXplU2VsZWN0LnZhbHVlID09IFwidHJ1ZVwiID8gdHJ1ZSA6IHRoaXMucGFnZVNpemVTZWxlY3QudmFsdWUpO1xuXHRcdFx0XHRcdHRoaXMuc2V0UGFnZSgxKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vYXBwZW5kIHRvIERPTVxuXHRcdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuZmlyc3RCdXQpO1xuXHRcdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMucHJldkJ1dCk7XG5cdFx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5wYWdlc0VsZW1lbnQpO1xuXHRcdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMubmV4dEJ1dCk7XG5cdFx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5sYXN0QnV0KTtcblx0XHRcdFxuXHRcdFx0aWYoIXRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uRWxlbWVudCl7XG5cdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uQ291bnRlcil7XG5cblx0XHRcdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbkNvdW50ZXJFbGVtZW50KXtcblx0XHRcdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uQ291bnRlckVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7XG5cdFx0XHRcdFx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uQ291bnRlckVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5wYWdlQ291bnRlckVsZW1lbnQpO1xuXHRcdFx0XHRcdFx0fWVsc2UgaWYodHlwZW9mIHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uQ291bnRlckVsZW1lbnQgPT09IFwic3RyaW5nXCIpe1xuXHRcdFx0XHRcdFx0XHRwYWdpbmF0aW9uQ291bnRlckhvbGRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25Db3VudGVyRWxlbWVudCk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRpZihwYWdpbmF0aW9uQ291bnRlckhvbGRlcil7XG5cdFx0XHRcdFx0XHRcdFx0cGFnaW5hdGlvbkNvdW50ZXJIb2xkZXIuYXBwZW5kQ2hpbGQodGhpcy5wYWdlQ291bnRlckVsZW1lbnQpO1xuXHRcdFx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiUGFnaW5hdGlvbiBFcnJvciAtIFVuYWJsZSB0byBmaW5kIGVsZW1lbnQgbWF0Y2hpbmcgcGFnaW5hdGlvbkNvdW50ZXJFbGVtZW50IHNlbGVjdG9yOlwiLCB0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbkNvdW50ZXJFbGVtZW50KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdHRoaXMuZm9vdGVyQXBwZW5kKHRoaXMucGFnZUNvdW50ZXJFbGVtZW50KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuZm9vdGVyQXBwZW5kKHRoaXMuZWxlbWVudCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMucGFnZSA9IHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uSW5pdGlhbFBhZ2U7XG5cdFx0XHR0aGlzLmNvdW50ID0gdGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25CdXR0b25Db3VudDtcblx0XHR9XG5cdFx0XG5cdFx0Ly9zZXQgZGVmYXVsdCB2YWx1ZXNcblx0XHR0aGlzLm1vZGUgPSB0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbk1vZGU7XG5cdH1cblx0XG5cdGluaXRpYWxpemVQcm9ncmVzc2l2ZShtb2RlKXtcblx0XHR0aGlzLmluaXRpYWxpemVQYWdpbmF0b3IodHJ1ZSk7XG5cdFx0dGhpcy5tb2RlID0gXCJwcm9ncmVzc2l2ZV9cIiArIG1vZGU7XG5cdFx0dGhpcy5wcm9ncmVzc2l2ZUxvYWQgPSB0cnVlO1xuXHR9XG5cdFxuXHR0cmFja0NoYW5nZXMoKXtcblx0XHR0aGlzLmRpc3BhdGNoKFwicGFnZS1jaGFuZ2VkXCIpO1xuXHR9XG5cdFxuXHQvL2NhbGN1bGF0ZSBtYXhpbXVtIHBhZ2UgZnJvbSBudW1iZXIgb2Ygcm93c1xuXHRzZXRNYXhSb3dzKHJvd0NvdW50KXtcblx0XHRpZighcm93Q291bnQpe1xuXHRcdFx0dGhpcy5tYXggPSAxO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMubWF4ID0gdGhpcy5zaXplID09PSB0cnVlID8gIDEgOiBNYXRoLmNlaWwocm93Q291bnQvdGhpcy5zaXplKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy5wYWdlID4gdGhpcy5tYXgpe1xuXHRcdFx0dGhpcy5wYWdlID0gdGhpcy5tYXg7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3Jlc2V0IHRvIGZpcnN0IHBhZ2Ugd2l0aG91dCB0cmlnZ2VyaW5nIGFjdGlvblxuXHRyZXNldChmb3JjZSl7XG5cdFx0aWYoIXRoaXMuaW5pdGlhbExvYWQpe1xuXHRcdFx0aWYodGhpcy5tb2RlID09IFwibG9jYWxcIiB8fCBmb3JjZSl7XG5cdFx0XHRcdHRoaXMucGFnZSA9IDE7XG5cdFx0XHRcdHRoaXMudHJhY2tDaGFuZ2VzKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3NldCB0aGUgbWF4aW11bSBwYWdlXG5cdHNldE1heFBhZ2UobWF4KXtcblx0XHRcblx0XHRtYXggPSBwYXJzZUludChtYXgpO1xuXHRcdFxuXHRcdHRoaXMubWF4ID0gbWF4IHx8IDE7XG5cdFx0XG5cdFx0aWYodGhpcy5wYWdlID4gdGhpcy5tYXgpe1xuXHRcdFx0dGhpcy5wYWdlID0gdGhpcy5tYXg7XG5cdFx0XHR0aGlzLnRyaWdnZXIoKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vc2V0IGN1cnJlbnQgcGFnZSBudW1iZXJcblx0c2V0UGFnZShwYWdlKXtcblx0XHRzd2l0Y2gocGFnZSl7XG5cdFx0XHRjYXNlIFwiZmlyc3RcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuc2V0UGFnZSgxKTtcblx0XG5cdFx0XHRjYXNlIFwicHJldlwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5wcmV2aW91c1BhZ2UoKTtcblx0XHRcdFxuXHRcdFx0Y2FzZSBcIm5leHRcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMubmV4dFBhZ2UoKTtcblx0XHRcdFxuXHRcdFx0Y2FzZSBcImxhc3RcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuc2V0UGFnZSh0aGlzLm1heCk7XG5cdFx0fVxuXHRcdFxuXHRcdHBhZ2UgPSBwYXJzZUludChwYWdlKTtcblx0XHRcblx0XHRpZigocGFnZSA+IDAgJiYgcGFnZSA8PSB0aGlzLm1heCkgfHwgdGhpcy5tb2RlICE9PSBcImxvY2FsXCIpe1xuXHRcdFx0dGhpcy5wYWdlID0gcGFnZTtcblx0XHRcdFxuXHRcdFx0dGhpcy50cmFja0NoYW5nZXMoKTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIHRoaXMudHJpZ2dlcigpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIlBhZ2luYXRpb24gRXJyb3IgLSBSZXF1ZXN0ZWQgcGFnZSBpcyBvdXQgb2YgcmFuZ2Ugb2YgMSAtIFwiICsgdGhpcy5tYXggKyBcIjpcIiwgcGFnZSk7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcblx0XHR9XG5cdH1cblx0XG5cdHNldFBhZ2VUb1Jvdyhyb3cpe1xuXHRcdHZhciByb3dzID0gdGhpcy5kaXNwbGF5Um93cygtMSk7XG5cdFx0dmFyIGluZGV4ID0gcm93cy5pbmRleE9mKHJvdyk7XG5cdFxuXHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0dmFyIHBhZ2UgPSB0aGlzLnNpemUgPT09IHRydWUgPyAxIDogTWF0aC5jZWlsKChpbmRleCArIDEpIC8gdGhpcy5zaXplKTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIHRoaXMuc2V0UGFnZShwYWdlKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJQYWdpbmF0aW9uIEVycm9yIC0gUmVxdWVzdGVkIHJvdyBpcyBub3QgdmlzaWJsZVwiKTtcblx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuXHRcdH1cblx0fVxuXHRcblx0c2V0UGFnZVNpemUoc2l6ZSl7XG5cdFx0aWYoc2l6ZSAhPT0gdHJ1ZSl7XG5cdFx0XHRzaXplID0gcGFyc2VJbnQoc2l6ZSk7XG5cdFx0fVxuXG5cdFx0aWYoc2l6ZSA+IDApe1xuXHRcdFx0dGhpcy5zaXplID0gc2l6ZTtcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInBhZ2VTaXplQ2hhbmdlZFwiLCBzaXplKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy5wYWdlU2l6ZVNlbGVjdCl7XG5cdFx0XHQvLyB0aGlzLnBhZ2VTaXplU2VsZWN0LnZhbHVlID0gc2l6ZTtcblx0XHRcdHRoaXMuZ2VuZXJhdGVQYWdlU2l6ZVNlbGVjdExpc3QoKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy50cmFja0NoYW5nZXMoKTtcblx0fVxuXHRcblx0X3NldFBhZ2VDb3VudGVyKHRvdGFsUm93cywgc2l6ZSwgY3VycmVudFJvdyl7XG5cdFx0dmFyIGNvbnRlbnQ7XG5cdFx0XG5cdFx0aWYodGhpcy5wYWdlQ291bnRlcil7XG5cblx0XHRcdGlmKHRoaXMubW9kZSA9PT0gXCJyZW1vdGVcIil7XG5cdFx0XHRcdHNpemUgPSB0aGlzLnNpemU7XG5cdFx0XHRcdGN1cnJlbnRSb3cgPSAoKHRoaXMucGFnZSAtIDEpICogdGhpcy5zaXplKSArIDE7XG5cdFx0XHRcdHRvdGFsUm93cyA9IHRoaXMucmVtb3RlUm93Q291bnRFc3RpbWF0ZTtcblx0XHRcdH1cblxuXHRcdFx0Y29udGVudCA9IHRoaXMucGFnZUNvdW50ZXIuY2FsbCh0aGlzLCBzaXplLCBjdXJyZW50Um93LCB0aGlzLnBhZ2UsIHRvdGFsUm93cywgdGhpcy5tYXgpO1xuXHRcdFx0XG5cdFx0XHRzd2l0Y2godHlwZW9mIGNvbnRlbnQpe1xuXHRcdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdFx0aWYoY29udGVudCBpbnN0YW5jZW9mIE5vZGUpe1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly9jbGVhciBwcmV2aW91cyBjZWxsIGNvbnRlbnRzXG5cdFx0XHRcdFx0XHR3aGlsZSh0aGlzLnBhZ2VDb3VudGVyRWxlbWVudC5maXJzdENoaWxkKSB0aGlzLnBhZ2VDb3VudGVyRWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLnBhZ2VDb3VudGVyRWxlbWVudC5maXJzdENoaWxkKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHRoaXMucGFnZUNvdW50ZXJFbGVtZW50LmFwcGVuZENoaWxkKGNvbnRlbnQpO1xuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdHRoaXMucGFnZUNvdW50ZXJFbGVtZW50LmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZihjb250ZW50ICE9IG51bGwpe1xuXHRcdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJQYWdlIENvdW50ZXIgRXJyb3IgLSBQYWdlIENvdW50ZXIgaGFzIHJldHVybmVkIGEgdHlwZSBvZiBvYmplY3QsIHRoZSBvbmx5IHZhbGlkIHBhZ2UgY291bnRlciBvYmplY3QgcmV0dXJuIGlzIGFuIGluc3RhbmNlIG9mIE5vZGUsIHRoZSBwYWdlIGNvdW50ZXIgcmV0dXJuZWQ6XCIsIGNvbnRlbnQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRcdHRoaXMucGFnZUNvdW50ZXJFbGVtZW50LmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0dGhpcy5wYWdlQ291bnRlckVsZW1lbnQuaW5uZXJIVE1MID0gY29udGVudDtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8vc2V0dXAgdGhlIHBhZ2luYXRpb24gYnV0dG9uc1xuXHRfc2V0UGFnZUJ1dHRvbnMoKXtcblx0XHRsZXQgbGVmdFNpemUgPSBNYXRoLmZsb29yKCh0aGlzLmNvdW50LTEpIC8gMik7XG5cdFx0bGV0IHJpZ2h0U2l6ZSA9IE1hdGguY2VpbCgodGhpcy5jb3VudC0xKSAvIDIpO1xuXHRcdGxldCBtaW4gPSB0aGlzLm1heCAtIHRoaXMucGFnZSArIGxlZnRTaXplICsgMSA8IHRoaXMuY291bnQgPyB0aGlzLm1heC10aGlzLmNvdW50KzE6IE1hdGgubWF4KHRoaXMucGFnZS1sZWZ0U2l6ZSwxKTtcblx0XHRsZXQgbWF4ID0gdGhpcy5wYWdlIDw9IHJpZ2h0U2l6ZT8gTWF0aC5taW4odGhpcy5jb3VudCwgdGhpcy5tYXgpIDpNYXRoLm1pbih0aGlzLnBhZ2UrcmlnaHRTaXplLCB0aGlzLm1heCk7XG5cdFx0XG5cdFx0d2hpbGUodGhpcy5wYWdlc0VsZW1lbnQuZmlyc3RDaGlsZCkgdGhpcy5wYWdlc0VsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5wYWdlc0VsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdFx0XG5cdFx0aWYodGhpcy5wYWdlID09IDEpe1xuXHRcdFx0dGhpcy5maXJzdEJ1dC5kaXNhYmxlZCA9IHRydWU7XG5cdFx0XHR0aGlzLnByZXZCdXQuZGlzYWJsZWQgPSB0cnVlO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuZmlyc3RCdXQuZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRcdHRoaXMucHJldkJ1dC5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLnBhZ2UgPT0gdGhpcy5tYXgpe1xuXHRcdFx0dGhpcy5sYXN0QnV0LmRpc2FibGVkID0gdHJ1ZTtcblx0XHRcdHRoaXMubmV4dEJ1dC5kaXNhYmxlZCA9IHRydWU7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5sYXN0QnV0LmRpc2FibGVkID0gZmFsc2U7XG5cdFx0XHR0aGlzLm5leHRCdXQuZGlzYWJsZWQgPSBmYWxzZTtcblx0XHR9XG5cdFx0XG5cdFx0Zm9yKGxldCBpID0gbWluOyBpIDw9IG1heDsgaSsrKXtcblx0XHRcdGlmKGk+MCAmJiBpIDw9IHRoaXMubWF4KXtcblx0XHRcdFx0dGhpcy5wYWdlc0VsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5fZ2VuZXJhdGVQYWdlQnV0dG9uKGkpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5mb290ZXJSZWRyYXcoKTtcblx0fVxuXHRcblx0X2dlbmVyYXRlUGFnZUJ1dHRvbihwYWdlKXtcblx0XHR2YXIgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcblx0XHRcblx0XHRidXR0b24uY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wYWdlXCIpO1xuXHRcdGlmKHBhZ2UgPT0gdGhpcy5wYWdlKXtcblx0XHRcdGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuXHRcdH1cblx0XHRcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImJ1dHRvblwiKTtcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImJ1dHRvblwiKTtcblx0XHRcblx0XHR0aGlzLmxhbmdCaW5kKFwicGFnaW5hdGlvbnxwYWdlX3RpdGxlXCIsICh2YWx1ZSkgPT4ge1xuXHRcdFx0YnV0dG9uLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgdmFsdWUgKyBcIiBcIiArIHBhZ2UpO1xuXHRcdFx0YnV0dG9uLnNldEF0dHJpYnV0ZShcInRpdGxlXCIsIHZhbHVlICsgXCIgXCIgKyBwYWdlKTtcblx0XHR9KTtcblx0XHRcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwiZGF0YS1wYWdlXCIsIHBhZ2UpO1xuXHRcdGJ1dHRvbi50ZXh0Q29udGVudCA9IHBhZ2U7XG5cdFx0XG5cdFx0YnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuXHRcdFx0dGhpcy5zZXRQYWdlKHBhZ2UpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBidXR0b247XG5cdH1cblx0XG5cdC8vcHJldmlvdXMgcGFnZVxuXHRwcmV2aW91c1BhZ2UoKXtcblx0XHRpZih0aGlzLnBhZ2UgPiAxKXtcblx0XHRcdHRoaXMucGFnZS0tO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnRyYWNrQ2hhbmdlcygpO1xuXHRcdFx0XG5cdFx0XHRyZXR1cm4gdGhpcy50cmlnZ2VyKCk7XG5cdFx0XHRcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJQYWdpbmF0aW9uIEVycm9yIC0gUHJldmlvdXMgcGFnZSB3b3VsZCBiZSBsZXNzIHRoYW4gcGFnZSAxOlwiLCAwKTtcblx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9uZXh0IHBhZ2Vcblx0bmV4dFBhZ2UoKXtcblx0XHRpZih0aGlzLnBhZ2UgPCB0aGlzLm1heCl7XG5cdFx0XHR0aGlzLnBhZ2UrKztcblx0XHRcdFxuXHRcdFx0dGhpcy50cmFja0NoYW5nZXMoKTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIHRoaXMudHJpZ2dlcigpO1xuXHRcdFx0XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYoIXRoaXMucHJvZ3Jlc3NpdmVMb2FkKXtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiUGFnaW5hdGlvbiBFcnJvciAtIE5leHQgcGFnZSB3b3VsZCBiZSBncmVhdGVyIHRoYW4gbWF4aW11bSBwYWdlIG9mIFwiICsgdGhpcy5tYXggKyBcIjpcIiwgdGhpcy5tYXggKyAxKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9yZXR1cm4gY3VycmVudCBwYWdlIG51bWJlclxuXHRnZXRQYWdlKCl7XG5cdFx0cmV0dXJuIHRoaXMucGFnZTtcblx0fVxuXHRcblx0Ly9yZXR1cm4gbWF4IHBhZ2UgbnVtYmVyXG5cdGdldFBhZ2VNYXgoKXtcblx0XHRyZXR1cm4gdGhpcy5tYXg7XG5cdH1cblx0XG5cdGdldFBhZ2VTaXplKHNpemUpe1xuXHRcdHJldHVybiB0aGlzLnNpemU7XG5cdH1cblx0XG5cdGdldE1vZGUoKXtcblx0XHRyZXR1cm4gdGhpcy5tb2RlO1xuXHR9XG5cdFxuXHQvL3JldHVybiBhcHByb3ByaWF0ZSByb3dzIGZvciBjdXJyZW50IHBhZ2Vcblx0Z2V0Um93cyhkYXRhKXtcblx0XHR2YXIgYWN0dWFsUm93UGFnZVNpemUgPSAwLFxuXHRcdG91dHB1dCwgc3RhcnQsIGVuZCwgYWN0dWFsU3RhcnRSb3c7XG5cblx0XHR2YXIgYWN0dWFsUm93cyA9IGRhdGEuZmlsdGVyKChyb3cpID0+IHtcblx0XHRcdHJldHVybiByb3cudHlwZSA9PT0gXCJyb3dcIjtcblx0XHR9KTtcblx0XHRcblx0XHRpZih0aGlzLm1vZGUgPT0gXCJsb2NhbFwiKXtcblx0XHRcdG91dHB1dCA9IFtdO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnNldE1heFJvd3MoZGF0YS5sZW5ndGgpO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnNpemUgPT09IHRydWUpe1xuXHRcdFx0XHRzdGFydCA9IDA7XG5cdFx0XHRcdGVuZCA9IGRhdGEubGVuZ3RoO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRzdGFydCA9IHRoaXMuc2l6ZSAqICh0aGlzLnBhZ2UgLSAxKTtcblx0XHRcdFx0ZW5kID0gc3RhcnQgKyBwYXJzZUludCh0aGlzLnNpemUpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLl9zZXRQYWdlQnV0dG9ucygpO1xuXHRcdFx0XG5cdFx0XHRmb3IobGV0IGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKXtcblx0XHRcdFx0bGV0IHJvdyA9IGRhdGFbaV07XG5cblx0XHRcdFx0aWYocm93KXtcblx0XHRcdFx0XHRvdXRwdXQucHVzaChyb3cpO1xuXG5cdFx0XHRcdFx0aWYocm93LnR5cGUgPT09IFwicm93XCIpe1xuXHRcdFx0XHRcdFx0aWYoIWFjdHVhbFN0YXJ0Um93KXtcblx0XHRcdFx0XHRcdFx0YWN0dWFsU3RhcnRSb3cgPSByb3c7XG5cdFx0XHRcdFx0XHR9XHRcblxuXHRcdFx0XHRcdFx0YWN0dWFsUm93UGFnZVNpemUrKztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5fc2V0UGFnZUNvdW50ZXIoYWN0dWFsUm93cy5sZW5ndGgsIGFjdHVhbFJvd1BhZ2VTaXplLCBhY3R1YWxTdGFydFJvdyA/IChhY3R1YWxSb3dzLmluZGV4T2YoYWN0dWFsU3RhcnRSb3cpICsgMSkgOiAwKTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIG91dHB1dDtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLl9zZXRQYWdlQnV0dG9ucygpO1xuXHRcdFx0dGhpcy5fc2V0UGFnZUNvdW50ZXIoYWN0dWFsUm93cy5sZW5ndGgpO1xuXHRcdFx0XG5cdFx0XHRyZXR1cm4gZGF0YS5zbGljZSgwKTtcblx0XHR9XG5cdH1cblx0XG5cdHRyaWdnZXIoKXtcblx0XHR2YXIgbGVmdDtcblx0XHRcblx0XHRzd2l0Y2godGhpcy5tb2RlKXtcblx0XHRcdGNhc2UgXCJsb2NhbFwiOlxuXHRcdFx0XHRsZWZ0ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbExlZnQ7XG5cdFx0XHRcblx0XHRcdFx0dGhpcy5yZWZyZXNoRGF0YSgpO1xuXHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcblx0XHRcdFxuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJwYWdlTG9hZGVkXCIsIHRoaXMuZ2V0UGFnZSgpKTtcblx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdFx0XHRcblx0XHRcdGNhc2UgXCJyZW1vdGVcIjpcblx0XHRcdFx0dGhpcy5kYXRhQ2hhbmdpbmcgPSB0cnVlO1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5yZWxvYWREYXRhKG51bGwpXG5cdFx0XHRcdFx0LmZpbmFsbHkoKCkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5kYXRhQ2hhbmdpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Y2FzZSBcInByb2dyZXNzaXZlX2xvYWRcIjpcblx0XHRcdGNhc2UgXCJwcm9ncmVzc2l2ZV9zY3JvbGxcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMucmVsb2FkRGF0YShudWxsLCB0cnVlKTtcblx0XHRcdFxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiUGFnaW5hdGlvbiBFcnJvciAtIG5vIHN1Y2ggcGFnaW5hdGlvbiBtb2RlOlwiLCB0aGlzLm1vZGUpO1xuXHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcblx0XHR9XG5cdH1cblx0XG5cdF9wYXJzZVJlbW90ZURhdGEoZGF0YSl7XG5cdFx0dmFyIG1hcmdpbiwgcGFnaW5hdGlvbk91dE9mUmFuZ2U7XG5cdFx0XG5cdFx0aWYodHlwZW9mIGRhdGEubGFzdF9wYWdlID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdGNvbnNvbGUud2FybihcIlJlbW90ZSBQYWdpbmF0aW9uIEVycm9yIC0gU2VydmVyIHJlc3BvbnNlIG1pc3NpbmcgJ1wiICsgKHRoaXMub3B0aW9ucyhcImRhdGFSZWNlaXZlUGFyYW1zXCIpLmxhc3RfcGFnZSB8fCBcImxhc3RfcGFnZVwiKSArIFwiJyBwcm9wZXJ0eVwiKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoZGF0YS5kYXRhKXtcblx0XHRcdHRoaXMubWF4ID0gcGFyc2VJbnQoZGF0YS5sYXN0X3BhZ2UpIHx8IDE7XG5cblx0XHRcdHRoaXMucmVtb3RlUm93Q291bnRFc3RpbWF0ZSA9IHR5cGVvZiBkYXRhLmxhc3Rfcm93ICE9PSBcInVuZGVmaW5lZFwiID8gZGF0YS5sYXN0X3JvdyA6IChkYXRhLmxhc3RfcGFnZSAqIHRoaXMuc2l6ZSAtICh0aGlzLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UgPyAodGhpcy5zaXplIC0gZGF0YS5kYXRhLmxlbmd0aCkgOiAwKSk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMucHJvZ3Jlc3NpdmVMb2FkKXtcblx0XHRcdFx0c3dpdGNoKHRoaXMubW9kZSl7XG5cdFx0XHRcdFx0Y2FzZSBcInByb2dyZXNzaXZlX2xvYWRcIjpcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmKHRoaXMucGFnZSA9PSAxKXtcblx0XHRcdFx0XHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNldERhdGEoZGF0YS5kYXRhLCBmYWxzZSwgdGhpcy5wYWdlID09IDEpO1xuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWRkUm93cyhkYXRhLmRhdGEpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYodGhpcy5wYWdlIDwgdGhpcy5tYXgpe1xuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLm5leHRQYWdlKCk7XG5cdFx0XHRcdFx0XHRcdH0sIHRoaXMudGFibGUub3B0aW9ucy5wcm9ncmVzc2l2ZUxvYWREZWxheSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjYXNlIFwicHJvZ3Jlc3NpdmVfc2Nyb2xsXCI6XG5cdFx0XHRcdFx0XHRkYXRhID0gdGhpcy5wYWdlID09PSAxID8gZGF0YS5kYXRhIDogdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERhdGEoKS5jb25jYXQoZGF0YS5kYXRhKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5zZXREYXRhKGRhdGEsIHRoaXMucGFnZSAhPT0gMSwgdGhpcy5wYWdlID09IDEpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0bWFyZ2luID0gdGhpcy50YWJsZS5vcHRpb25zLnByb2dyZXNzaXZlTG9hZFNjcm9sbE1hcmdpbiB8fCAodGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuY2xpZW50SGVpZ2h0ICogMik7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZih0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxIZWlnaHQgPD0gKHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LmNsaWVudEhlaWdodCArIG1hcmdpbikpe1xuXHRcdFx0XHRcdFx0XHRpZih0aGlzLnBhZ2UgPCB0aGlzLm1heCl7XG5cdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm5leHRQYWdlKCk7XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9ZWxzZSB7XG5cblx0XHRcdFx0aWYodGhpcy5wYWdlID4gdGhpcy5tYXgpe1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybiggXCJSZW1vdGUgUGFnaW5hdGlvbiBFcnJvciAtIFNlcnZlciByZXR1cm5lZCBsYXN0IHBhZ2UgdmFsdWUgbG93ZXIgdGhhbiB0aGUgY3VycmVudCBwYWdlXCIgKTtcblxuXHRcdFx0XHRcdHBhZ2luYXRpb25PdXRPZlJhbmdlID0gdGhpcy5vcHRpb25zKCdwYWdpbmF0aW9uT3V0T2ZSYW5nZScpO1xuXG5cdFx0XHRcdFx0aWYocGFnaW5hdGlvbk91dE9mUmFuZ2Upe1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXMuc2V0UGFnZSh0eXBlb2YgcGFnaW5hdGlvbk91dE9mUmFuZ2UgPT09ICdmdW5jdGlvbicgPyBwYWdpbmF0aW9uT3V0T2ZSYW5nZS5jYWxsKHRoaXMsIHRoaXMucGFnZSwgdGhpcy5tYXgpIDpcdHBhZ2luYXRpb25PdXRPZlJhbmdlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBsZWZ0ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbExlZnQ7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInBhZ2VMb2FkZWRcIiwgIHRoaXMuZ2V0UGFnZSgpKTtcblx0XHRcdFx0Ly8gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbEhvcml6b250YWwobGVmdCk7XG5cdFx0XHRcdC8vIHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiUmVtb3RlIFBhZ2luYXRpb24gRXJyb3IgLSBTZXJ2ZXIgcmVzcG9uc2UgbWlzc2luZyAnXCIgKyAodGhpcy5vcHRpb25zKFwiZGF0YVJlY2VpdmVQYXJhbXNcIikuZGF0YSB8fCBcImRhdGFcIikgKyBcIicgcHJvcGVydHlcIik7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBkYXRhLmRhdGE7XG5cdH1cblx0XG5cdC8vaGFuZGxlIHRoZSBmb290ZXIgZWxlbWVudCBiZWluZyByZWRyYXduXG5cdGZvb3RlclJlZHJhdygpe1xuXHRcdHZhciBmb290ZXIgPSB0aGlzLnRhYmxlLmZvb3Rlck1hbmFnZXIuY29udGFpbmVyRWxlbWVudDtcblxuXHRcdGlmKChNYXRoLmNlaWwoZm9vdGVyLmNsaWVudFdpZHRoKSAtIGZvb3Rlci5zY3JvbGxXaWR0aCkgPCAwKXtcblx0XHRcdHRoaXMucGFnZXNFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5wYWdlc0VsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICcnO1xuXHRcdFx0XG5cdFx0XHRpZigoTWF0aC5jZWlsKGZvb3Rlci5jbGllbnRXaWR0aCkgLSBmb290ZXIuc2Nyb2xsV2lkdGgpIDwgMCl7XG5cdFx0XHRcdHRoaXMucGFnZXNFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG5cbi8vIHJlYWQgcGVyc2lzdGFuY2UgaW5mb3JtYXRpb24gZnJvbSBzdG9yYWdlXG52YXIgZGVmYXVsdFJlYWRlcnMgPSB7XG5cdGxvY2FsOmZ1bmN0aW9uKGlkLCB0eXBlKXtcblx0XHR2YXIgZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGlkICsgXCItXCIgKyB0eXBlKTtcblxuXHRcdHJldHVybiBkYXRhID8gSlNPTi5wYXJzZShkYXRhKSA6IGZhbHNlO1xuXHR9LFxuXHRjb29raWU6ZnVuY3Rpb24oaWQsIHR5cGUpe1xuXHRcdHZhciBjb29raWUgPSBkb2N1bWVudC5jb29raWUsXG5cdFx0a2V5ID0gaWQgKyBcIi1cIiArIHR5cGUsXG5cdFx0Y29va2llUG9zID0gY29va2llLmluZGV4T2Yoa2V5ICsgXCI9XCIpLFxuXHRcdGVuZCwgZGF0YTtcblxuXHRcdC8vaWYgY29va2llIGV4aXN0cywgZGVjb2RlIGFuZCBsb2FkIGNvbHVtbiBkYXRhIGludG8gdGFidWxhdG9yXG5cdFx0aWYoY29va2llUG9zID4gLTEpe1xuXHRcdFx0Y29va2llID0gY29va2llLnNsaWNlKGNvb2tpZVBvcyk7XG5cblx0XHRcdGVuZCA9IGNvb2tpZS5pbmRleE9mKFwiO1wiKTtcblxuXHRcdFx0aWYoZW5kID4gLTEpe1xuXHRcdFx0XHRjb29raWUgPSBjb29raWUuc2xpY2UoMCwgZW5kKTtcblx0XHRcdH1cblxuXHRcdFx0ZGF0YSA9IGNvb2tpZS5yZXBsYWNlKGtleSArIFwiPVwiLCBcIlwiKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZGF0YSA/IEpTT04ucGFyc2UoZGF0YSkgOiBmYWxzZTtcblx0fVxufTtcblxuLy93cml0ZSBwZXJzaXN0ZW5jZSBpbmZvcm1hdGlvbiB0byBzdG9yYWdlXG52YXIgZGVmYXVsdFdyaXRlcnMgPSB7XG5cdGxvY2FsOmZ1bmN0aW9uKGlkLCB0eXBlLCBkYXRhKXtcblx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbShpZCArIFwiLVwiICsgdHlwZSwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuXHR9LFxuXHRjb29raWU6ZnVuY3Rpb24oaWQsIHR5cGUsIGRhdGEpe1xuXHRcdHZhciBleHBpcmVEYXRlID0gbmV3IERhdGUoKTtcblxuXHRcdGV4cGlyZURhdGUuc2V0RGF0ZShleHBpcmVEYXRlLmdldERhdGUoKSArIDEwMDAwKTtcblxuXHRcdGRvY3VtZW50LmNvb2tpZSA9IGlkICsgXCItXCIgKyB0eXBlICsgXCI9XCIgKyBKU09OLnN0cmluZ2lmeShkYXRhKSArIFwiOyBleHBpcmVzPVwiICsgZXhwaXJlRGF0ZS50b1VUQ1N0cmluZygpO1xuXHR9XG59O1xuXG5jbGFzcyBQZXJzaXN0ZW5jZSBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwicGVyc2lzdGVuY2VcIjtcblxuXHRzdGF0aWMgbW9kdWxlSW5pdE9yZGVyID0gLTEwO1xuXG5cdC8vbG9hZCBkZWZhdWx0c1xuXHRzdGF0aWMgcmVhZGVycyA9IGRlZmF1bHRSZWFkZXJzO1xuXHRzdGF0aWMgd3JpdGVycyA9IGRlZmF1bHRXcml0ZXJzO1xuXG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cblx0XHR0aGlzLm1vZGUgPSBcIlwiO1xuXHRcdHRoaXMuaWQgPSBcIlwiO1xuXHRcdC8vIHRoaXMucGVyc2lzdFByb3BzID0gW1wiZmllbGRcIiwgXCJ3aWR0aFwiLCBcInZpc2libGVcIl07XG5cdFx0dGhpcy5kZWZXYXRjaGVyQmxvY2sgPSBmYWxzZTtcblx0XHR0aGlzLmNvbmZpZyA9IHt9O1xuXHRcdHRoaXMucmVhZEZ1bmMgPSBmYWxzZTtcblx0XHR0aGlzLndyaXRlRnVuYyA9IGZhbHNlO1xuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicGVyc2lzdGVuY2VcIiwgZmFsc2UpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInBlcnNpc3RlbmNlSURcIiwgXCJcIik7IC8va2V5IGZvciBwZXJzaXN0ZW50IHN0b3JhZ2Vcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJwZXJzaXN0ZW5jZU1vZGVcIiwgdHJ1ZSk7IC8vbW9kZSBmb3Igc3RvcmluZyBwZXJzaXN0ZW5jZSBpbmZvcm1hdGlvblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInBlcnNpc3RlbmNlUmVhZGVyRnVuY1wiLCBmYWxzZSk7IC8vZnVuY3Rpb24gZm9yIGhhbmRsaW5nIHBlcnNpc3RlbmNlIGRhdGEgcmVhZGluZ1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInBlcnNpc3RlbmNlV3JpdGVyRnVuY1wiLCBmYWxzZSk7IC8vZnVuY3Rpb24gZm9yIGhhbmRsaW5nIHBlcnNpc3RlbmNlIGRhdGEgd3JpdGluZ1xuXHR9XG5cblx0Ly8gVGVzdCBmb3Igd2hldGhlciBsb2NhbFN0b3JhZ2UgaXMgYXZhaWxhYmxlIGZvciB1c2UuXG5cdGxvY2FsU3RvcmFnZVRlc3QoKSB7XG5cdFx0dmFyICB0ZXN0S2V5ID0gIFwiX3RhYnVsYXRvcl90ZXN0XCI7XG5cblx0XHR0cnkge1xuXHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCB0ZXN0S2V5LCB0ZXN0S2V5KTtcblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSggdGVzdEtleSApO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBjYXRjaChlKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0Ly9zZXR1cCBwYXJhbWV0ZXJzXG5cdGluaXRpYWxpemUoKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2Upe1xuXHRcdFx0Ly9kZXRlcm1pbmUgcGVyc2lzdGVudCBsYXlvdXQgc3RvcmFnZSB0eXBlXG5cdFx0XHR2YXIgbW9kZSA9IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZU1vZGUsXG5cdFx0XHRpZCA9IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZUlELFxuXHRcdFx0cmV0cmlldmVkRGF0YTtcblxuXHRcdFx0dGhpcy5tb2RlID0gbW9kZSAhPT0gdHJ1ZSA/ICBtb2RlIDogKHRoaXMubG9jYWxTdG9yYWdlVGVzdCgpID8gXCJsb2NhbFwiIDogXCJjb29raWVcIik7XG5cblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZVJlYWRlckZ1bmMpe1xuXHRcdFx0XHRpZih0eXBlb2YgdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlUmVhZGVyRnVuYyA9PT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdFx0XHR0aGlzLnJlYWRGdW5jID0gdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlUmVhZGVyRnVuYztcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGlmKFBlcnNpc3RlbmNlLnJlYWRlcnNbdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlUmVhZGVyRnVuY10pe1xuXHRcdFx0XHRcdFx0dGhpcy5yZWFkRnVuYyA9IFBlcnNpc3RlbmNlLnJlYWRlcnNbdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlUmVhZGVyRnVuY107XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiUGVyc2lzdGVuY2UgUmVhZCBFcnJvciAtIGludmFsaWQgcmVhZGVyIHNldFwiLCB0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2VSZWFkZXJGdW5jKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYoUGVyc2lzdGVuY2UucmVhZGVyc1t0aGlzLm1vZGVdKXtcblx0XHRcdFx0XHR0aGlzLnJlYWRGdW5jID0gUGVyc2lzdGVuY2UucmVhZGVyc1t0aGlzLm1vZGVdO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiUGVyc2lzdGVuY2UgUmVhZCBFcnJvciAtIGludmFsaWQgcmVhZGVyIHNldFwiLCB0aGlzLm1vZGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZVdyaXRlckZ1bmMpe1xuXHRcdFx0XHRpZih0eXBlb2YgdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlV3JpdGVyRnVuYyA9PT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdFx0XHR0aGlzLndyaXRlRnVuYyA9IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZVdyaXRlckZ1bmM7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRpZihQZXJzaXN0ZW5jZS53cml0ZXJzW3RoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZVdyaXRlckZ1bmNdKXtcblx0XHRcdFx0XHRcdHRoaXMud3JpdGVGdW5jID0gUGVyc2lzdGVuY2Uud3JpdGVyc1t0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2VXcml0ZXJGdW5jXTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJQZXJzaXN0ZW5jZSBXcml0ZSBFcnJvciAtIGludmFsaWQgcmVhZGVyIHNldFwiLCB0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2VXcml0ZXJGdW5jKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYoUGVyc2lzdGVuY2Uud3JpdGVyc1t0aGlzLm1vZGVdKXtcblx0XHRcdFx0XHR0aGlzLndyaXRlRnVuYyA9IFBlcnNpc3RlbmNlLndyaXRlcnNbdGhpcy5tb2RlXTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIlBlcnNpc3RlbmNlIFdyaXRlIEVycm9yIC0gaW52YWxpZCB3cml0ZXIgc2V0XCIsIHRoaXMubW9kZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly9zZXQgc3RvcmFnZSB0YWdcblx0XHRcdHRoaXMuaWQgPSBcInRhYnVsYXRvci1cIiArIChpZCB8fCAodGhpcy50YWJsZS5lbGVtZW50LmdldEF0dHJpYnV0ZShcImlkXCIpIHx8IFwiXCIpKTtcblxuXHRcdFx0dGhpcy5jb25maWcgPSB7XG5cdFx0XHRcdHNvcnQ6dGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlID09PSB0cnVlIHx8IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZS5zb3J0LFxuXHRcdFx0XHRmaWx0ZXI6dGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlID09PSB0cnVlIHx8IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZS5maWx0ZXIsXG5cdFx0XHRcdGhlYWRlckZpbHRlcjp0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2UgPT09IHRydWUgfHwgdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlLmhlYWRlckZpbHRlcixcblx0XHRcdFx0Z3JvdXA6dGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlID09PSB0cnVlIHx8IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZS5ncm91cCxcblx0XHRcdFx0cGFnZTp0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2UgPT09IHRydWUgfHwgdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlLnBhZ2UsXG5cdFx0XHRcdGNvbHVtbnM6dGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlID09PSB0cnVlID8gW1widGl0bGVcIiwgXCJ3aWR0aFwiLCBcInZpc2libGVcIl0gOiB0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2UuY29sdW1ucyxcblx0XHRcdH07XG5cblx0XHRcdC8vbG9hZCBwYWdpbmF0aW9uIGRhdGEgaWYgbmVlZGVkXG5cdFx0XHRpZih0aGlzLmNvbmZpZy5wYWdlKXtcblx0XHRcdFx0cmV0cmlldmVkRGF0YSA9IHRoaXMucmV0cmlldmVEYXRhKFwicGFnZVwiKTtcblxuXHRcdFx0XHRpZihyZXRyaWV2ZWREYXRhKXtcblx0XHRcdFx0XHRpZih0eXBlb2YgcmV0cmlldmVkRGF0YS5wYWdpbmF0aW9uU2l6ZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiAodGhpcy5jb25maWcucGFnZSA9PT0gdHJ1ZSB8fCB0aGlzLmNvbmZpZy5wYWdlLnNpemUpKXtcblx0XHRcdFx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uU2l6ZSA9IHJldHJpZXZlZERhdGEucGFnaW5hdGlvblNpemU7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYodHlwZW9mIHJldHJpZXZlZERhdGEucGFnaW5hdGlvbkluaXRpYWxQYWdlICE9PSBcInVuZGVmaW5lZFwiICYmICh0aGlzLmNvbmZpZy5wYWdlID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLnBhZ2UucGFnZSkpe1xuXHRcdFx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25Jbml0aWFsUGFnZSA9IHJldHJpZXZlZERhdGEucGFnaW5hdGlvbkluaXRpYWxQYWdlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvL2xvYWQgZ3JvdXAgZGF0YSBpZiBuZWVkZWRcblx0XHRcdGlmKHRoaXMuY29uZmlnLmdyb3VwKXtcblx0XHRcdFx0cmV0cmlldmVkRGF0YSA9IHRoaXMucmV0cmlldmVEYXRhKFwiZ3JvdXBcIik7XG5cblx0XHRcdFx0aWYocmV0cmlldmVkRGF0YSl7XG5cdFx0XHRcdFx0aWYodHlwZW9mIHJldHJpZXZlZERhdGEuZ3JvdXBCeSAhPT0gXCJ1bmRlZmluZWRcIiAmJiAodGhpcy5jb25maWcuZ3JvdXAgPT09IHRydWUgfHwgdGhpcy5jb25maWcuZ3JvdXAuZ3JvdXBCeSkpe1xuXHRcdFx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkgPSByZXRyaWV2ZWREYXRhLmdyb3VwQnk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmKHR5cGVvZiByZXRyaWV2ZWREYXRhLmdyb3VwU3RhcnRPcGVuICE9PSBcInVuZGVmaW5lZFwiICYmICh0aGlzLmNvbmZpZy5ncm91cCA9PT0gdHJ1ZSB8fCB0aGlzLmNvbmZpZy5ncm91cC5ncm91cFN0YXJ0T3Blbikpe1xuXHRcdFx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmdyb3VwU3RhcnRPcGVuID0gcmV0cmlldmVkRGF0YS5ncm91cFN0YXJ0T3Blbjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYodHlwZW9mIHJldHJpZXZlZERhdGEuZ3JvdXBIZWFkZXIgIT09IFwidW5kZWZpbmVkXCIgJiYgKHRoaXMuY29uZmlnLmdyb3VwID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLmdyb3VwLmdyb3VwSGVhZGVyKSl7XG5cdFx0XHRcdFx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBIZWFkZXIgPSByZXRyaWV2ZWREYXRhLmdyb3VwSGVhZGVyO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZih0aGlzLmNvbmZpZy5jb2x1bW5zKXtcblx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMgPSB0aGlzLmxvYWQoXCJjb2x1bW5zXCIsIHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5zKTtcblx0XHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4taW5pdFwiLCB0aGlzLmluaXRpYWxpemVDb2x1bW4uYmluZCh0aGlzKSk7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLXNob3dcIiwgdGhpcy5zYXZlLmJpbmQodGhpcywgXCJjb2x1bW5zXCIpKTtcblx0XHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4taGlkZVwiLCB0aGlzLnNhdmUuYmluZCh0aGlzLCBcImNvbHVtbnNcIikpO1xuXHRcdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1tb3ZlZFwiLCB0aGlzLnNhdmUuYmluZCh0aGlzLCBcImNvbHVtbnNcIikpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLWJ1aWx0XCIsIHRoaXMudGFibGVCdWlsdC5iaW5kKHRoaXMpLCAwKTtcblxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1yZWRyYXdcIiwgdGhpcy50YWJsZVJlZHJhdy5iaW5kKHRoaXMpKTtcblxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJmaWx0ZXItY2hhbmdlZFwiLCB0aGlzLmV2ZW50U2F2ZS5iaW5kKHRoaXMsIFwiZmlsdGVyXCIpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZmlsdGVyLWNoYW5nZWRcIiwgdGhpcy5ldmVudFNhdmUuYmluZCh0aGlzLCBcImhlYWRlckZpbHRlclwiKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInNvcnQtY2hhbmdlZFwiLCB0aGlzLmV2ZW50U2F2ZS5iaW5kKHRoaXMsIFwic29ydFwiKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImdyb3VwLWNoYW5nZWRcIiwgdGhpcy5ldmVudFNhdmUuYmluZCh0aGlzLCBcImdyb3VwXCIpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicGFnZS1jaGFuZ2VkXCIsIHRoaXMuZXZlbnRTYXZlLmJpbmQodGhpcywgXCJwYWdlXCIpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLXJlc2l6ZWRcIiwgdGhpcy5ldmVudFNhdmUuYmluZCh0aGlzLCBcImNvbHVtbnNcIikpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4td2lkdGhcIiwgdGhpcy5ldmVudFNhdmUuYmluZCh0aGlzLCBcImNvbHVtbnNcIikpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJsYXlvdXQtcmVmcmVzaGVkXCIsIHRoaXMuZXZlbnRTYXZlLmJpbmQodGhpcywgXCJjb2x1bW5zXCIpKTtcblx0XHR9XG5cblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImdldENvbHVtbkxheW91dFwiLCB0aGlzLmdldENvbHVtbkxheW91dC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInNldENvbHVtbkxheW91dFwiLCB0aGlzLnNldENvbHVtbkxheW91dC5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdGV2ZW50U2F2ZSh0eXBlKXtcblx0XHRpZih0aGlzLmNvbmZpZ1t0eXBlXSl7XG5cdFx0XHR0aGlzLnNhdmUodHlwZSk7XG5cdFx0fVxuXHR9XG5cblx0dGFibGVCdWlsdCgpe1xuXHRcdHZhciBzb3J0ZXJzLCBmaWx0ZXJzLCBoZWFkZXJGaWx0ZXJzO1xuXG5cdFx0aWYodGhpcy5jb25maWcuc29ydCl7XG5cdFx0XHRzb3J0ZXJzID0gdGhpcy5sb2FkKFwic29ydFwiKTtcblxuXHRcdFx0aWYoIXNvcnRlcnMgPT09IGZhbHNlKXtcblx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmluaXRpYWxTb3J0ID0gc29ydGVycztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZih0aGlzLmNvbmZpZy5maWx0ZXIpe1xuXHRcdFx0ZmlsdGVycyA9IHRoaXMubG9hZChcImZpbHRlclwiKTtcblxuXHRcdFx0aWYoIWZpbHRlcnMgPT09IGZhbHNlKXtcblx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmluaXRpYWxGaWx0ZXIgPSBmaWx0ZXJzO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZih0aGlzLmNvbmZpZy5oZWFkZXJGaWx0ZXIpe1xuXHRcdFx0aGVhZGVyRmlsdGVycyA9IHRoaXMubG9hZChcImhlYWRlckZpbHRlclwiKTtcblxuXHRcdFx0aWYoIWhlYWRlckZpbHRlcnMgPT09IGZhbHNlKXtcblx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmluaXRpYWxIZWFkZXJGaWx0ZXIgPSBoZWFkZXJGaWx0ZXJzO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0fVxuXG5cdHRhYmxlUmVkcmF3KGZvcmNlKXtcblx0XHRpZihmb3JjZSAmJiB0aGlzLmNvbmZpZy5jb2x1bW5zKXtcblx0XHRcdHRoaXMuc2F2ZShcImNvbHVtbnNcIik7XG5cdFx0fVxuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIFRhYmxlIEZ1bmN0aW9ucyAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXHRnZXRDb2x1bW5MYXlvdXQoKXtcblx0XHRyZXR1cm4gdGhpcy5wYXJzZUNvbHVtbnModGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldENvbHVtbnMoKSk7XG5cdH1cblxuXHRzZXRDb2x1bW5MYXlvdXQobGF5b3V0KXtcblx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuc2V0Q29sdW1ucyh0aGlzLm1lcmdlRGVmaW5pdGlvbih0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1ucywgbGF5b3V0LCB0cnVlKSk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gSW50ZXJuYWwgTG9naWMgLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHR2YXIgZGVmLCBrZXlzO1xuXG5cdFx0aWYodGhpcy5jb25maWcuY29sdW1ucyl7XG5cdFx0XHR0aGlzLmRlZldhdGNoZXJCbG9jayA9IHRydWU7XG5cblx0XHRcdGRlZiA9IGNvbHVtbi5nZXREZWZpbml0aW9uKCk7XG5cblx0XHRcdGtleXMgPSB0aGlzLmNvbmZpZy5jb2x1bW5zID09PSB0cnVlID8gT2JqZWN0LmtleXMoZGVmKSA6IHRoaXMuY29uZmlnLmNvbHVtbnM7XG5cblx0XHRcdGtleXMuZm9yRWFjaCgoa2V5KT0+e1xuXHRcdFx0XHR2YXIgcHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGRlZiwga2V5KTtcblx0XHRcdFx0dmFyIHZhbHVlID0gZGVmW2tleV07XG5cblx0XHRcdFx0aWYocHJvcHMpe1xuXHRcdFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkZWYsIGtleSwge1xuXHRcdFx0XHRcdFx0c2V0OiAobmV3VmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdFx0dmFsdWUgPSBuZXdWYWx1ZTtcblxuXHRcdFx0XHRcdFx0XHRpZighdGhpcy5kZWZXYXRjaGVyQmxvY2spe1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMuc2F2ZShcImNvbHVtbnNcIik7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRpZihwcm9wcy5zZXQpe1xuXHRcdFx0XHRcdFx0XHRcdHByb3BzLnNldChuZXdWYWx1ZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRnZXQ6KCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRpZihwcm9wcy5nZXQpe1xuXHRcdFx0XHRcdFx0XHRcdHByb3BzLmdldCgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuZGVmV2F0Y2hlckJsb2NrID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0Ly9sb2FkIHNhdmVkIGRlZmluaXRpb25zXG5cdGxvYWQodHlwZSwgY3VycmVudCl7XG5cdFx0dmFyIGRhdGEgPSB0aGlzLnJldHJpZXZlRGF0YSh0eXBlKTtcblxuXHRcdGlmKGN1cnJlbnQpe1xuXHRcdFx0ZGF0YSA9IGRhdGEgPyB0aGlzLm1lcmdlRGVmaW5pdGlvbihjdXJyZW50LCBkYXRhKSA6IGN1cnJlbnQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRhdGE7XG5cdH1cblxuXHQvL3JldHJpZXZlIGRhdGEgZnJvbSBtZW1vcnlcblx0cmV0cmlldmVEYXRhKHR5cGUpe1xuXHRcdHJldHVybiB0aGlzLnJlYWRGdW5jID8gdGhpcy5yZWFkRnVuYyh0aGlzLmlkLCB0eXBlKSA6IGZhbHNlO1xuXHR9XG5cblx0Ly9tZXJnZSBvbGQgYW5kIG5ldyBjb2x1bW4gZGVmaW5pdGlvbnNcblx0bWVyZ2VEZWZpbml0aW9uKG9sZENvbHMsIG5ld0NvbHMsIG1lcmdlQWxsTmV3KXtcblx0XHR2YXIgb3V0cHV0ID0gW107XG5cblx0XHRuZXdDb2xzID0gbmV3Q29scyB8fCBbXTtcblxuXHRcdG5ld0NvbHMuZm9yRWFjaCgoY29sdW1uLCB0bykgPT4ge1xuXHRcdFx0dmFyIGZyb20gPSB0aGlzLl9maW5kQ29sdW1uKG9sZENvbHMsIGNvbHVtbiksXG5cdFx0XHRrZXlzO1xuXG5cdFx0XHRpZihmcm9tKXtcblx0XHRcdFx0aWYobWVyZ2VBbGxOZXcpe1xuXHRcdFx0XHRcdGtleXMgPSBPYmplY3Qua2V5cyhjb2x1bW4pO1xuXHRcdFx0XHR9ZWxzZSBpZih0aGlzLmNvbmZpZy5jb2x1bW5zID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLmNvbHVtbnMgPT0gdW5kZWZpbmVkKXtcblx0XHRcdFx0XHRrZXlzID0gIE9iamVjdC5rZXlzKGZyb20pO1xuXHRcdFx0XHRcdGtleXMucHVzaChcIndpZHRoXCIpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0a2V5cyA9IHRoaXMuY29uZmlnLmNvbHVtbnM7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRrZXlzLmZvckVhY2goKGtleSk9Pntcblx0XHRcdFx0XHRpZihrZXkgIT09IFwiY29sdW1uc1wiICYmIHR5cGVvZiBjb2x1bW5ba2V5XSAhPT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0XHRmcm9tW2tleV0gPSBjb2x1bW5ba2V5XTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmKGZyb20uY29sdW1ucyl7XG5cdFx0XHRcdFx0ZnJvbS5jb2x1bW5zID0gdGhpcy5tZXJnZURlZmluaXRpb24oZnJvbS5jb2x1bW5zLCBjb2x1bW4uY29sdW1ucyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRvdXRwdXQucHVzaChmcm9tKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG9sZENvbHMuZm9yRWFjaCgoY29sdW1uLCBpKSA9PiB7XG5cdFx0XHR2YXIgZnJvbSA9IHRoaXMuX2ZpbmRDb2x1bW4obmV3Q29scywgY29sdW1uKTtcblxuXHRcdFx0aWYgKCFmcm9tKSB7XG5cdFx0XHRcdGlmKG91dHB1dC5sZW5ndGg+aSl7XG5cdFx0XHRcdFx0b3V0cHV0LnNwbGljZShpLCAwLCBjb2x1bW4pO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0b3V0cHV0LnB1c2goY29sdW1uKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXG5cdC8vZmluZCBtYXRjaGluZyBjb2x1bW5zXG5cdF9maW5kQ29sdW1uKGNvbHVtbnMsIHN1YmplY3Qpe1xuXHRcdHZhciB0eXBlID0gc3ViamVjdC5jb2x1bW5zID8gXCJncm91cFwiIDogKHN1YmplY3QuZmllbGQgPyBcImZpZWxkXCIgOiBcIm9iamVjdFwiKTtcblxuXHRcdHJldHVybiBjb2x1bW5zLmZpbmQoZnVuY3Rpb24oY29sKXtcblx0XHRcdHN3aXRjaCh0eXBlKXtcblx0XHRcdFx0Y2FzZSBcImdyb3VwXCI6XG5cdFx0XHRcdFx0cmV0dXJuIGNvbC50aXRsZSA9PT0gc3ViamVjdC50aXRsZSAmJiBjb2wuY29sdW1ucy5sZW5ndGggPT09IHN1YmplY3QuY29sdW1ucy5sZW5ndGg7XG5cblx0XHRcdFx0Y2FzZSBcImZpZWxkXCI6XG5cdFx0XHRcdFx0cmV0dXJuIGNvbC5maWVsZCA9PT0gc3ViamVjdC5maWVsZDtcblxuXHRcdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdFx0cmV0dXJuIGNvbCA9PT0gc3ViamVjdDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8vc2F2ZSBkYXRhXG5cdHNhdmUodHlwZSl7XG5cdFx0dmFyIGRhdGEgPSB7fTtcblxuXHRcdHN3aXRjaCh0eXBlKXtcblx0XHRcdGNhc2UgXCJjb2x1bW5zXCI6XG5cdFx0XHRcdGRhdGEgPSB0aGlzLnBhcnNlQ29sdW1ucyh0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29sdW1ucygpKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJmaWx0ZXJcIjpcblx0XHRcdFx0ZGF0YSA9IHRoaXMudGFibGUubW9kdWxlcy5maWx0ZXIuZ2V0RmlsdGVycygpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImhlYWRlckZpbHRlclwiOlxuXHRcdFx0XHRkYXRhID0gdGhpcy50YWJsZS5tb2R1bGVzLmZpbHRlci5nZXRIZWFkZXJGaWx0ZXJzKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwic29ydFwiOlxuXHRcdFx0XHRkYXRhID0gdGhpcy52YWxpZGF0ZVNvcnRlcnModGhpcy50YWJsZS5tb2R1bGVzLnNvcnQuZ2V0U29ydCgpKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJncm91cFwiOlxuXHRcdFx0XHRkYXRhID0gdGhpcy5nZXRHcm91cENvbmZpZygpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcInBhZ2VcIjpcblx0XHRcdFx0ZGF0YSA9IHRoaXMuZ2V0UGFnZUNvbmZpZygpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cblx0XHRpZih0aGlzLndyaXRlRnVuYyl7XG5cdFx0XHR0aGlzLndyaXRlRnVuYyh0aGlzLmlkLCB0eXBlLCBkYXRhKTtcblx0XHR9XG5cblx0fVxuXG5cdC8vZW5zdXJlIHNvcnRlcnMgY29udGFpbiBubyBmdW5jdGlvbiBkYXRhXG5cdHZhbGlkYXRlU29ydGVycyhkYXRhKXtcblx0XHRkYXRhLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG5cdFx0XHRpdGVtLmNvbHVtbiA9IGl0ZW0uZmllbGQ7XG5cdFx0XHRkZWxldGUgaXRlbS5maWVsZDtcblx0XHR9KTtcblxuXHRcdHJldHVybiBkYXRhO1xuXHR9XG5cblx0Z2V0R3JvdXBDb25maWcoKXtcblx0XHR2YXIgZGF0YSA9IHt9O1xuXG5cdFx0aWYodGhpcy5jb25maWcuZ3JvdXApe1xuXHRcdFx0aWYodGhpcy5jb25maWcuZ3JvdXAgPT09IHRydWUgfHwgdGhpcy5jb25maWcuZ3JvdXAuZ3JvdXBCeSl7XG5cdFx0XHRcdGRhdGEuZ3JvdXBCeSA9IHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5O1xuXHRcdFx0fVxuXG5cdFx0XHRpZih0aGlzLmNvbmZpZy5ncm91cCA9PT0gdHJ1ZSB8fCB0aGlzLmNvbmZpZy5ncm91cC5ncm91cFN0YXJ0T3Blbil7XG5cdFx0XHRcdGRhdGEuZ3JvdXBTdGFydE9wZW4gPSB0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBTdGFydE9wZW47XG5cdFx0XHR9XG5cblx0XHRcdGlmKHRoaXMuY29uZmlnLmdyb3VwID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLmdyb3VwLmdyb3VwSGVhZGVyKXtcblx0XHRcdFx0ZGF0YS5ncm91cEhlYWRlciA9IHRoaXMudGFibGUub3B0aW9ucy5ncm91cEhlYWRlcjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZGF0YTtcblx0fVxuXG5cdGdldFBhZ2VDb25maWcoKXtcblx0XHR2YXIgZGF0YSA9IHt9O1xuXG5cdFx0aWYodGhpcy5jb25maWcucGFnZSl7XG5cdFx0XHRpZih0aGlzLmNvbmZpZy5wYWdlID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLnBhZ2Uuc2l6ZSl7XG5cdFx0XHRcdGRhdGEucGFnaW5hdGlvblNpemUgPSB0aGlzLnRhYmxlLm1vZHVsZXMucGFnZS5nZXRQYWdlU2l6ZSgpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZih0aGlzLmNvbmZpZy5wYWdlID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLnBhZ2UucGFnZSl7XG5cdFx0XHRcdGRhdGEucGFnaW5hdGlvbkluaXRpYWxQYWdlID0gdGhpcy50YWJsZS5tb2R1bGVzLnBhZ2UuZ2V0UGFnZSgpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBkYXRhO1xuXHR9XG5cblxuXHQvL3BhcnNlIGNvbHVtbnMgZm9yIGRhdGEgdG8gc3RvcmVcblx0cGFyc2VDb2x1bW5zKGNvbHVtbnMpe1xuXHRcdHZhciBkZWZpbml0aW9ucyA9IFtdLFxuXHRcdGV4Y2x1ZGVkS2V5cyA9IFtcImhlYWRlckNvbnRleHRNZW51XCIsIFwiaGVhZGVyTWVudVwiLCBcImNvbnRleHRNZW51XCIsIFwiY2xpY2tNZW51XCJdO1xuXG5cdFx0Y29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcblx0XHRcdHZhciBkZWZTdG9yZSA9IHt9LFxuXHRcdFx0Y29sRGVmID0gY29sdW1uLmdldERlZmluaXRpb24oKSxcblx0XHRcdGtleXM7XG5cblx0XHRcdGlmKGNvbHVtbi5pc0dyb3VwKXtcblx0XHRcdFx0ZGVmU3RvcmUudGl0bGUgPSBjb2xEZWYudGl0bGU7XG5cdFx0XHRcdGRlZlN0b3JlLmNvbHVtbnMgPSB0aGlzLnBhcnNlQ29sdW1ucyhjb2x1bW4uZ2V0Q29sdW1ucygpKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0ZGVmU3RvcmUuZmllbGQgPSBjb2x1bW4uZ2V0RmllbGQoKTtcblxuXHRcdFx0XHRpZih0aGlzLmNvbmZpZy5jb2x1bW5zID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLmNvbHVtbnMgPT0gdW5kZWZpbmVkKXtcblx0XHRcdFx0XHRrZXlzID0gIE9iamVjdC5rZXlzKGNvbERlZik7XG5cdFx0XHRcdFx0a2V5cy5wdXNoKFwid2lkdGhcIik7XG5cdFx0XHRcdFx0a2V5cy5wdXNoKFwidmlzaWJsZVwiKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGtleXMgPSB0aGlzLmNvbmZpZy5jb2x1bW5zO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0a2V5cy5mb3JFYWNoKChrZXkpPT57XG5cdFx0XHRcdFx0c3dpdGNoKGtleSl7XG5cdFx0XHRcdFx0XHRjYXNlIFwid2lkdGhcIjpcblx0XHRcdFx0XHRcdFx0ZGVmU3RvcmUud2lkdGggPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlIFwidmlzaWJsZVwiOlxuXHRcdFx0XHRcdFx0XHRkZWZTdG9yZS52aXNpYmxlID0gY29sdW1uLnZpc2libGU7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRpZih0eXBlb2YgY29sRGVmW2tleV0gIT09IFwiZnVuY3Rpb25cIiAmJiBleGNsdWRlZEtleXMuaW5kZXhPZihrZXkpID09PSAtMSl7XG5cdFx0XHRcdFx0XHRcdFx0ZGVmU3RvcmVba2V5XSA9IGNvbERlZltrZXldO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0ZGVmaW5pdGlvbnMucHVzaChkZWZTdG9yZSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gZGVmaW5pdGlvbnM7XG5cdH1cbn1cblxuY2xhc3MgUG9wdXAgZXh0ZW5kcyBNb2R1bGV7XG5cdFxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwicG9wdXBcIjtcblx0XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy5jb2x1bW5TdWJzY3JpYmVycyA9IHt9O1xuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInJvd0NvbnRleHRQb3B1cFwiLCBmYWxzZSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicm93Q2xpY2tQb3B1cFwiLCBmYWxzZSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicm93RGJsQ2xpY2tQb3B1cFwiLCBmYWxzZSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZ3JvdXBDb250ZXh0UG9wdXBcIiwgZmFsc2UpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImdyb3VwQ2xpY2tQb3B1cFwiLCBmYWxzZSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiZ3JvdXBEYmxDbGlja1BvcHVwXCIsIGZhbHNlKTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyQ29udGV4dFBvcHVwXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJDbGlja1BvcHVwXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJEYmxDbGlja1BvcHVwXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJQb3B1cFwiKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyUG9wdXBJY29uXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJjb250ZXh0UG9wdXBcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImNsaWNrUG9wdXBcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImRibENsaWNrUG9wdXBcIik7XG5cblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJjZWxsXCIsIFwicG9wdXBcIiwgdGhpcy5fY29tcG9uZW50UG9wdXBDYWxsLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNvbHVtblwiLCBcInBvcHVwXCIsIHRoaXMuX2NvbXBvbmVudFBvcHVwQ2FsbC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJyb3dcIiwgXCJwb3B1cFwiLCB0aGlzLl9jb21wb25lbnRQb3B1cENhbGwuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiZ3JvdXBcIiwgXCJwb3B1cFwiLCB0aGlzLl9jb21wb25lbnRQb3B1cENhbGwuYmluZCh0aGlzKSk7XG5cdFx0XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLmluaXRpYWxpemVSb3dXYXRjaGVycygpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUdyb3VwV2F0Y2hlcnMoKTtcblx0XHRcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1pbml0XCIsIHRoaXMuaW5pdGlhbGl6ZUNvbHVtbi5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdF9jb21wb25lbnRQb3B1cENhbGwoY29tcG9uZW50LCBjb250ZW50cywgcG9zaXRpb24pe1xuXHRcdHRoaXMubG9hZFBvcHVwRXZlbnQoY29udGVudHMsIG51bGwsIGNvbXBvbmVudCwgcG9zaXRpb24pO1xuXHR9XG5cdFxuXHRpbml0aWFsaXplUm93V2F0Y2hlcnMoKXtcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucm93Q29udGV4dFBvcHVwKXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWNvbnRleHRtZW51XCIsIHRoaXMubG9hZFBvcHVwRXZlbnQuYmluZCh0aGlzLCB0aGlzLnRhYmxlLm9wdGlvbnMucm93Q29udGV4dFBvcHVwKSk7XG5cdFx0XHR0aGlzLnRhYmxlLm9uKFwicm93VGFwSG9sZFwiLCB0aGlzLmxvYWRQb3B1cEV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLnJvd0NvbnRleHRQb3B1cCkpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucm93Q2xpY2tQb3B1cCl7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1jbGlja1wiLCB0aGlzLmxvYWRQb3B1cEV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLnJvd0NsaWNrUG9wdXApKTtcblx0XHR9XG5cblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucm93RGJsQ2xpY2tQb3B1cCl7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1kYmxjbGlja1wiLCB0aGlzLmxvYWRQb3B1cEV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLnJvd0RibENsaWNrUG9wdXApKTtcblx0XHR9XG5cdH1cblx0XG5cdGluaXRpYWxpemVHcm91cFdhdGNoZXJzKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQ29udGV4dFBvcHVwKXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZ3JvdXAtY29udGV4dG1lbnVcIiwgdGhpcy5sb2FkUG9wdXBFdmVudC5iaW5kKHRoaXMsIHRoaXMudGFibGUub3B0aW9ucy5ncm91cENvbnRleHRQb3B1cCkpO1xuXHRcdFx0dGhpcy50YWJsZS5vbihcImdyb3VwVGFwSG9sZFwiLCB0aGlzLmxvYWRQb3B1cEV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQ29udGV4dFBvcHVwKSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5ncm91cENsaWNrUG9wdXApe1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJncm91cC1jbGlja1wiLCB0aGlzLmxvYWRQb3B1cEV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQ2xpY2tQb3B1cCkpO1xuXHRcdH1cblxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5ncm91cERibENsaWNrUG9wdXApe1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJncm91cC1kYmxjbGlja1wiLCB0aGlzLmxvYWRQb3B1cEV2ZW50LmJpbmQodGhpcywgdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwRGJsQ2xpY2tQb3B1cCkpO1xuXHRcdH1cblx0fVxuXG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHR2YXIgZGVmID0gY29sdW1uLmRlZmluaXRpb247XG5cdFx0XG5cdFx0Ly9oYW5kbGUgY29sdW1uIGV2ZW50c1xuXHRcdGlmKGRlZi5oZWFkZXJDb250ZXh0UG9wdXAgJiYgIXRoaXMuY29sdW1uU3Vic2NyaWJlcnMuaGVhZGVyQ29udGV4dFBvcHVwKXtcblx0XHRcdHRoaXMuY29sdW1uU3Vic2NyaWJlcnMuaGVhZGVyQ29udGV4dFBvcHVwID0gdGhpcy5sb2FkUG9wdXBUYWJsZUNvbHVtbkV2ZW50LmJpbmQodGhpcywgXCJoZWFkZXJDb250ZXh0UG9wdXBcIik7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1jb250ZXh0bWVudVwiLCB0aGlzLmNvbHVtblN1YnNjcmliZXJzLmhlYWRlckNvbnRleHRQb3B1cCk7XG5cdFx0XHR0aGlzLnRhYmxlLm9uKFwiaGVhZGVyVGFwSG9sZFwiLCB0aGlzLmxvYWRQb3B1cFRhYmxlQ29sdW1uRXZlbnQuYmluZCh0aGlzLCBcImhlYWRlckNvbnRleHRQb3B1cFwiKSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGRlZi5oZWFkZXJDbGlja1BvcHVwICYmICF0aGlzLmNvbHVtblN1YnNjcmliZXJzLmhlYWRlckNsaWNrUG9wdXApe1xuXHRcdFx0dGhpcy5jb2x1bW5TdWJzY3JpYmVycy5oZWFkZXJDbGlja1BvcHVwID0gdGhpcy5sb2FkUG9wdXBUYWJsZUNvbHVtbkV2ZW50LmJpbmQodGhpcywgXCJoZWFkZXJDbGlja1BvcHVwXCIpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tY2xpY2tcIiwgdGhpcy5jb2x1bW5TdWJzY3JpYmVycy5oZWFkZXJDbGlja1BvcHVwKTtcblx0XHRcblx0XHRcblx0XHR9aWYoZGVmLmhlYWRlckRibENsaWNrUG9wdXAgJiYgIXRoaXMuY29sdW1uU3Vic2NyaWJlcnMuaGVhZGVyRGJsQ2xpY2tQb3B1cCl7XG5cdFx0XHR0aGlzLmNvbHVtblN1YnNjcmliZXJzLmhlYWRlckRibENsaWNrUG9wdXAgPSB0aGlzLmxvYWRQb3B1cFRhYmxlQ29sdW1uRXZlbnQuYmluZCh0aGlzLCBcImhlYWRlckRibENsaWNrUG9wdXBcIik7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1kYmxjbGlja1wiLCB0aGlzLmNvbHVtblN1YnNjcmliZXJzLmhlYWRlckRibENsaWNrUG9wdXApO1xuXHRcdH1cblx0XHRcblx0XHRpZihkZWYuaGVhZGVyUG9wdXApe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQ29sdW1uSGVhZGVyUG9wdXAoY29sdW1uKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly9oYW5kbGUgY2VsbCBldmVudHNcblx0XHRpZihkZWYuY29udGV4dFBvcHVwICYmICF0aGlzLmNvbHVtblN1YnNjcmliZXJzLmNvbnRleHRQb3B1cCl7XG5cdFx0XHR0aGlzLmNvbHVtblN1YnNjcmliZXJzLmNvbnRleHRQb3B1cCA9IHRoaXMubG9hZFBvcHVwVGFibGVDZWxsRXZlbnQuYmluZCh0aGlzLCBcImNvbnRleHRQb3B1cFwiKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC1jb250ZXh0bWVudVwiLCB0aGlzLmNvbHVtblN1YnNjcmliZXJzLmNvbnRleHRQb3B1cCk7XG5cdFx0XHR0aGlzLnRhYmxlLm9uKFwiY2VsbFRhcEhvbGRcIiwgdGhpcy5sb2FkUG9wdXBUYWJsZUNlbGxFdmVudC5iaW5kKHRoaXMsIFwiY29udGV4dFBvcHVwXCIpKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoZGVmLmNsaWNrUG9wdXAgJiYgIXRoaXMuY29sdW1uU3Vic2NyaWJlcnMuY2xpY2tQb3B1cCl7XG5cdFx0XHR0aGlzLmNvbHVtblN1YnNjcmliZXJzLmNsaWNrUG9wdXAgPSB0aGlzLmxvYWRQb3B1cFRhYmxlQ2VsbEV2ZW50LmJpbmQodGhpcywgXCJjbGlja1BvcHVwXCIpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLWNsaWNrXCIsIHRoaXMuY29sdW1uU3Vic2NyaWJlcnMuY2xpY2tQb3B1cCk7XG5cdFx0fVxuXG5cdFx0aWYoZGVmLmRibENsaWNrUG9wdXAgJiYgIXRoaXMuY29sdW1uU3Vic2NyaWJlcnMuZGJsQ2xpY2tQb3B1cCl7XG5cdFx0XHR0aGlzLmNvbHVtblN1YnNjcmliZXJzLmRibENsaWNrUG9wdXAgPSB0aGlzLmxvYWRQb3B1cFRhYmxlQ2VsbEV2ZW50LmJpbmQodGhpcywgXCJkYmxDbGlja1BvcHVwXCIpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLWNsaWNrXCIsIHRoaXMuY29sdW1uU3Vic2NyaWJlcnMuZGJsQ2xpY2tQb3B1cCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRpbml0aWFsaXplQ29sdW1uSGVhZGVyUG9wdXAoY29sdW1uKXtcblx0XHR2YXIgaWNvbiA9IGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlclBvcHVwSWNvbixcblx0XHRoZWFkZXJQb3B1cEVsO1xuXHRcdFxuXHRcdGhlYWRlclBvcHVwRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHRoZWFkZXJQb3B1cEVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItaGVhZGVyLXBvcHVwLWJ1dHRvblwiKTtcblxuXHRcdGlmKGljb24pe1xuXHRcdFx0aWYodHlwZW9mIGljb24gPT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdGljb24gPSBpY29uKGNvbHVtbi5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKGljb24gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7XG5cdFx0XHRcdGhlYWRlclBvcHVwRWwuYXBwZW5kQ2hpbGQoaWNvbik7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGhlYWRlclBvcHVwRWwuaW5uZXJIVE1MID0gaWNvbjtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRoZWFkZXJQb3B1cEVsLmlubmVySFRNTCA9IFwiJnZlbGxpcDtcIjtcblx0XHR9XG5cdFx0XG5cdFx0aGVhZGVyUG9wdXBFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcblx0XHRcdHRoaXMubG9hZFBvcHVwRXZlbnQoY29sdW1uLmRlZmluaXRpb24uaGVhZGVyUG9wdXAsIGUsIGNvbHVtbik7XG5cdFx0fSk7XG5cdFx0XG5cdFx0Y29sdW1uLnRpdGxlRWxlbWVudC5pbnNlcnRCZWZvcmUoaGVhZGVyUG9wdXBFbCwgY29sdW1uLnRpdGxlRWxlbWVudC5maXJzdENoaWxkKTtcblx0fVxuXHRcblx0bG9hZFBvcHVwVGFibGVDZWxsRXZlbnQob3B0aW9uLCBlLCBjZWxsKXtcblx0XHRpZihjZWxsLl9jZWxsKXtcblx0XHRcdGNlbGwgPSBjZWxsLl9jZWxsO1xuXHRcdH1cblx0XHRcblx0XHRpZihjZWxsLmNvbHVtbi5kZWZpbml0aW9uW29wdGlvbl0pe1xuXHRcdFx0dGhpcy5sb2FkUG9wdXBFdmVudChjZWxsLmNvbHVtbi5kZWZpbml0aW9uW29wdGlvbl0sIGUsIGNlbGwpO1xuXHRcdH1cblx0fVxuXHRcblx0bG9hZFBvcHVwVGFibGVDb2x1bW5FdmVudChvcHRpb24sIGUsIGNvbHVtbil7XG5cdFx0aWYoY29sdW1uLl9jb2x1bW4pe1xuXHRcdFx0Y29sdW1uID0gY29sdW1uLl9jb2x1bW47XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGNvbHVtbi5kZWZpbml0aW9uW29wdGlvbl0pe1xuXHRcdFx0dGhpcy5sb2FkUG9wdXBFdmVudChjb2x1bW4uZGVmaW5pdGlvbltvcHRpb25dLCBlLCBjb2x1bW4pO1xuXHRcdH1cblx0fVxuXHRcblx0bG9hZFBvcHVwRXZlbnQoY29udGVudHMsIGUsIGNvbXBvbmVudCwgcG9zaXRpb24pe1xuXHRcdHZhciByZW5kZXJlZENhbGxiYWNrO1xuXG5cdFx0ZnVuY3Rpb24gb25SZW5kZXJlZChjYWxsYmFjayl7XG5cdFx0XHRyZW5kZXJlZENhbGxiYWNrID0gY2FsbGJhY2s7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGNvbXBvbmVudC5fZ3JvdXApe1xuXHRcdFx0Y29tcG9uZW50ID0gY29tcG9uZW50Ll9ncm91cDtcblx0XHR9ZWxzZSBpZihjb21wb25lbnQuX3Jvdyl7XG5cdFx0XHRjb21wb25lbnQgPSBjb21wb25lbnQuX3Jvdztcblx0XHR9XG5cdFx0XG5cdFx0Y29udGVudHMgPSB0eXBlb2YgY29udGVudHMgPT0gXCJmdW5jdGlvblwiID8gY29udGVudHMuY2FsbCh0aGlzLnRhYmxlLCBlLCBjb21wb25lbnQuZ2V0Q29tcG9uZW50KCksICBvblJlbmRlcmVkKSA6IGNvbnRlbnRzO1xuXHRcdFxuXHRcdHRoaXMubG9hZFBvcHVwKGUsIGNvbXBvbmVudCwgY29udGVudHMsIHJlbmRlcmVkQ2FsbGJhY2ssIHBvc2l0aW9uKTtcblx0fVxuXHRcblx0bG9hZFBvcHVwKGUsIGNvbXBvbmVudCwgY29udGVudHMsIHJlbmRlcmVkQ2FsbGJhY2ssIHBvc2l0aW9uKXtcblx0XHR2YXIgdG91Y2ggPSAhKGUgaW5zdGFuY2VvZiBNb3VzZUV2ZW50KSxcblx0XHRjb250ZW50c0VsLCBwb3B1cDtcblx0XHRcblx0XHRpZihjb250ZW50cyBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KXtcblx0XHRcdGNvbnRlbnRzRWwgPSBjb250ZW50cztcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb250ZW50c0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdGNvbnRlbnRzRWwuaW5uZXJIVE1MID0gY29udGVudHM7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnRlbnRzRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wb3B1cFwiKTtcblxuXHRcdGNvbnRlbnRzRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9Pntcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cblx0XHRpZighdG91Y2gpe1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblx0XHRcblx0XHRwb3B1cCA9IHRoaXMucG9wdXAoY29udGVudHNFbCk7XG5cblx0XHRpZih0eXBlb2YgcmVuZGVyZWRDYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdHBvcHVwLnJlbmRlckNhbGxiYWNrKHJlbmRlcmVkQ2FsbGJhY2spO1xuXHRcdH1cblxuXHRcdGlmKGUpe1xuXHRcdFx0cG9wdXAuc2hvdyhlKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRwb3B1cC5zaG93KGNvbXBvbmVudC5nZXRFbGVtZW50KCksIHBvc2l0aW9uIHx8IFwiY2VudGVyXCIpO1xuXHRcdH1cblxuXHRcdFxuXHRcdHBvcHVwLmhpZGVPbkJsdXIoKCkgPT4ge1xuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwicG9wdXBDbG9zZWRcIiwgY29tcG9uZW50LmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInBvcHVwT3BlbmVkXCIsIGNvbXBvbmVudC5nZXRDb21wb25lbnQoKSk7XG5cdH1cbn1cblxuY2xhc3MgUHJpbnQgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcInByaW50XCI7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMuZWxlbWVudCA9IGZhbHNlO1xuXHRcdHRoaXMubWFudWFsQmxvY2sgPSBmYWxzZTtcblx0XHR0aGlzLmJlZm9yZXByaW50RXZlbnRIYW5kbGVyID0gbnVsbDtcblx0XHR0aGlzLmFmdGVycHJpbnRFdmVudEhhbmRsZXIgPSBudWxsO1xuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicHJpbnRBc0h0bWxcIiwgZmFsc2UpOyAvL2VuYWJsZSBwcmludCBhcyBodG1sXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicHJpbnRGb3JtYXR0ZXJcIiwgZmFsc2UpOyAvL3ByaW50aW5nIHBhZ2UgZm9ybWF0dGVyXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicHJpbnRIZWFkZXJcIiwgZmFsc2UpOyAvL3BhZ2UgaGVhZGVyIGNvbnRlbnRzXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicHJpbnRGb290ZXJcIiwgZmFsc2UpOyAvL3BhZ2UgZm9vdGVyIGNvbnRlbnRzXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicHJpbnRTdHlsZWRcIiwgdHJ1ZSk7IC8vZW5hYmxlIHByaW50IGFzIGh0bWwgc3R5bGluZ1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInByaW50Um93UmFuZ2VcIiwgXCJ2aXNpYmxlXCIpOyAvL3Jlc3RyaWN0IHByaW50IHRvIHZpc2libGUgcm93cyBvbmx5XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicHJpbnRDb25maWdcIiwge30pOyAvL3ByaW50IGNvbmZpZyBvcHRpb25zXG5cblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwicHJpbnRcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInRpdGxlUHJpbnRcIik7XG5cdH1cblxuXHRpbml0aWFsaXplKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnByaW50QXNIdG1sKXtcblx0XHRcdHRoaXMuYmVmb3JlcHJpbnRFdmVudEhhbmRsZXIgPSB0aGlzLnJlcGxhY2VUYWJsZS5iaW5kKHRoaXMpO1xuXHRcdFx0dGhpcy5hZnRlcnByaW50RXZlbnRIYW5kbGVyID0gdGhpcy5jbGVhbnVwLmJpbmQodGhpcyk7XG5cblx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiYmVmb3JlcHJpbnRcIiwgdGhpcy5iZWZvcmVwcmludEV2ZW50SGFuZGxlciApO1xuXHRcdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJhZnRlcnByaW50XCIsIHRoaXMuYWZ0ZXJwcmludEV2ZW50SGFuZGxlcik7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLWRlc3Ryb3lcIiwgdGhpcy5kZXN0cm95LmJpbmQodGhpcykpO1xuXHRcdH1cblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwicHJpbnRcIiwgdGhpcy5wcmludEZ1bGxzY3JlZW4uYmluZCh0aGlzKSk7XG5cdH1cblxuXHRkZXN0cm95KCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnByaW50QXNIdG1sKXtcblx0XHRcdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCBcImJlZm9yZXByaW50XCIsIHRoaXMuYmVmb3JlcHJpbnRFdmVudEhhbmRsZXIgKTtcblx0XHRcdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCBcImFmdGVycHJpbnRcIiwgdGhpcy5hZnRlcnByaW50RXZlbnRIYW5kbGVyICk7XG5cdFx0fVxuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIFRhYmxlIEZ1bmN0aW9ucyAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gSW50ZXJuYWwgTG9naWMgLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdHJlcGxhY2VUYWJsZSgpe1xuXHRcdGlmKCF0aGlzLm1hbnVhbEJsb2NrKXtcblx0XHRcdHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC10YWJsZVwiKTtcblxuXHRcdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMudGFibGUubW9kdWxlcy5leHBvcnQuZ2VuZXJhdGVUYWJsZSh0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRDb25maWcsIHRoaXMudGFibGUub3B0aW9ucy5wcmludFN0eWxlZCwgdGhpcy50YWJsZS5vcHRpb25zLnByaW50Um93UmFuZ2UsIFwicHJpbnRcIikpO1xuXG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGhpcy5lbGVtZW50LCB0aGlzLnRhYmxlLmVsZW1lbnQpO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFudXAoKXtcblx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItcHJpbnQtZnVsbHNjcmVlbi1oaWRlXCIpO1xuXG5cdFx0aWYodGhpcy5lbGVtZW50ICYmIHRoaXMuZWxlbWVudC5wYXJlbnROb2RlKXtcblx0XHRcdHRoaXMuZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudCk7XG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG5cdFx0fVxuXHR9XG5cblx0cHJpbnRGdWxsc2NyZWVuKHZpc2libGUsIHN0eWxlLCBjb25maWcpe1xuXHRcdHZhciBzY3JvbGxYID0gd2luZG93LnNjcm9sbFgsXG5cdFx0c2Nyb2xsWSA9IHdpbmRvdy5zY3JvbGxZLFxuXHRcdGhlYWRlckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcblx0XHRmb290ZXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdFx0dGFibGVFbCA9IHRoaXMudGFibGUubW9kdWxlcy5leHBvcnQuZ2VuZXJhdGVUYWJsZSh0eXBlb2YgY29uZmlnICE9IFwidW5kZWZpbmVkXCIgPyBjb25maWcgOiB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRDb25maWcsIHR5cGVvZiBzdHlsZSAhPSBcInVuZGVmaW5lZFwiID8gc3R5bGUgOiB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRTdHlsZWQsIHZpc2libGUgfHwgdGhpcy50YWJsZS5vcHRpb25zLnByaW50Um93UmFuZ2UsIFwicHJpbnRcIiksXG5cdFx0aGVhZGVyQ29udGVudCwgZm9vdGVyQ29udGVudDtcblxuXHRcdHRoaXMubWFudWFsQmxvY2sgPSB0cnVlO1xuXG5cdFx0dGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC1mdWxsc2NyZWVuXCIpO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnByaW50SGVhZGVyKXtcblx0XHRcdGhlYWRlckVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJpbnQtaGVhZGVyXCIpO1xuXG5cdFx0XHRoZWFkZXJDb250ZW50ID0gdHlwZW9mIHRoaXMudGFibGUub3B0aW9ucy5wcmludEhlYWRlciA9PSBcImZ1bmN0aW9uXCIgPyB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRIZWFkZXIuY2FsbCh0aGlzLnRhYmxlKSA6IHRoaXMudGFibGUub3B0aW9ucy5wcmludEhlYWRlcjtcblxuXHRcdFx0aWYodHlwZW9mIGhlYWRlckNvbnRlbnQgPT0gXCJzdHJpbmdcIil7XG5cdFx0XHRcdGhlYWRlckVsLmlubmVySFRNTCA9IGhlYWRlckNvbnRlbnQ7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGhlYWRlckVsLmFwcGVuZENoaWxkKGhlYWRlckNvbnRlbnQpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoaGVhZGVyRWwpO1xuXHRcdH1cblxuXHRcdHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZCh0YWJsZUVsKTtcblxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5wcmludEZvb3Rlcil7XG5cdFx0XHRmb290ZXJFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXByaW50LWZvb3RlclwiKTtcblxuXHRcdFx0Zm9vdGVyQ29udGVudCA9IHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRGb290ZXIgPT0gXCJmdW5jdGlvblwiID8gdGhpcy50YWJsZS5vcHRpb25zLnByaW50Rm9vdGVyLmNhbGwodGhpcy50YWJsZSkgOiB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRGb290ZXI7XG5cblxuXHRcdFx0aWYodHlwZW9mIGZvb3RlckNvbnRlbnQgPT0gXCJzdHJpbmdcIil7XG5cdFx0XHRcdGZvb3RlckVsLmlubmVySFRNTCA9IGZvb3RlckNvbnRlbnQ7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGZvb3RlckVsLmFwcGVuZENoaWxkKGZvb3RlckNvbnRlbnQpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoZm9vdGVyRWwpO1xuXHRcdH1cblxuXHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC1mdWxsc2NyZWVuLWhpZGVcIik7XG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnByaW50Rm9ybWF0dGVyKXtcblx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5wcmludEZvcm1hdHRlcih0aGlzLmVsZW1lbnQsIHRhYmxlRWwpO1xuXHRcdH1cblxuXHRcdHdpbmRvdy5wcmludCgpO1xuXG5cdFx0dGhpcy5jbGVhbnVwKCk7XG5cblx0XHR3aW5kb3cuc2Nyb2xsVG8oc2Nyb2xsWCwgc2Nyb2xsWSk7XG5cblx0XHR0aGlzLm1hbnVhbEJsb2NrID0gZmFsc2U7XG5cdH1cbn1cblxuY2xhc3MgUmVhY3RpdmVEYXRhIGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJyZWFjdGl2ZURhdGFcIjtcblx0XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy5kYXRhID0gZmFsc2U7XG5cdFx0dGhpcy5ibG9ja2VkID0gZmFsc2U7IC8vYmxvY2sgcmVhY3Rpdml0eSB3aGlsZSBwZXJmb3JtaW5nIHVwZGF0ZVxuXHRcdHRoaXMub3JpZ0Z1bmNzID0ge307IC8vIGhvbGQgb3JpZ2luYWwgZGF0YSBhcnJheSBmdW5jdGlvbnMgdG8gYWxsb3cgcmVwbGFjZW1lbnQgYWZ0ZXIgZGF0YSBpcyBkb25lIHdpdGhcblx0XHR0aGlzLmN1cnJlbnRWZXJzaW9uID0gMDtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJyZWFjdGl2ZURhdGFcIiwgZmFsc2UpOyAvL2VuYWJsZSBkYXRhIHJlYWN0aXZpdHlcblx0fVxuXHRcblx0aW5pdGlhbGl6ZSgpe1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5yZWFjdGl2ZURhdGEpe1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLXZhbHVlLXNhdmUtYmVmb3JlXCIsIHRoaXMuYmxvY2suYmluZCh0aGlzLCBcImNlbGxzYXZlXCIpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC12YWx1ZS1zYXZlLWFmdGVyXCIsIHRoaXMudW5ibG9jay5iaW5kKHRoaXMsIFwiY2VsbHNhdmVcIikpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctZGF0YS1zYXZlLWJlZm9yZVwiLCB0aGlzLmJsb2NrLmJpbmQodGhpcywgXCJyb3dzYXZlXCIpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWRhdGEtc2F2ZS1hZnRlclwiLCB0aGlzLnVuYmxvY2suYmluZCh0aGlzLCBcInJvd3NhdmVcIikpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctZGF0YS1pbml0LWFmdGVyXCIsIHRoaXMud2F0Y2hSb3cuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImRhdGEtcHJvY2Vzc2luZ1wiLCB0aGlzLndhdGNoRGF0YS5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwidGFibGUtZGVzdHJveVwiLCB0aGlzLnVud2F0Y2hEYXRhLmJpbmQodGhpcykpO1xuXHRcdH1cblx0fVxuXHRcblx0d2F0Y2hEYXRhKGRhdGEpe1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHR2ZXJzaW9uO1xuXHRcdFxuXHRcdHRoaXMuY3VycmVudFZlcnNpb24gKys7XG5cdFx0XG5cdFx0dmVyc2lvbiA9IHRoaXMuY3VycmVudFZlcnNpb247XG5cdFx0XG5cdFx0dGhpcy51bndhdGNoRGF0YSgpO1xuXHRcdFxuXHRcdHRoaXMuZGF0YSA9IGRhdGE7XG5cdFx0XG5cdFx0Ly9vdmVycmlkZSBhcnJheSBwdXNoIGZ1bmN0aW9uXG5cdFx0dGhpcy5vcmlnRnVuY3MucHVzaCA9IGRhdGEucHVzaDtcblx0XHRcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5kYXRhLCBcInB1c2hcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24oKXtcblx0XHRcdFx0dmFyIGFyZ3MgPSBBcnJheS5mcm9tKGFyZ3VtZW50cyksXG5cdFx0XHRcdHJlc3VsdDtcblxuXHRcdFx0XHRpZighc2VsZi5ibG9ja2VkICYmIHZlcnNpb24gPT09IHNlbGYuY3VycmVudFZlcnNpb24pe1x0XG5cdFx0XHRcdFx0c2VsZi5ibG9jayhcImRhdGEtcHVzaFwiKTtcblxuXHRcdFx0XHRcdGFyZ3MuZm9yRWFjaCgoYXJnKSA9PiB7XG5cdFx0XHRcdFx0XHRzZWxmLnRhYmxlLnJvd01hbmFnZXIuYWRkUm93QWN0dWFsKGFyZywgZmFsc2UpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJlc3VsdCA9IHNlbGYub3JpZ0Z1bmNzLnB1c2guYXBwbHkoZGF0YSwgYXJndW1lbnRzKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRzZWxmLnVuYmxvY2soXCJkYXRhLXB1c2hcIik7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0Ly9vdmVycmlkZSBhcnJheSB1bnNoaWZ0IGZ1bmN0aW9uXG5cdFx0dGhpcy5vcmlnRnVuY3MudW5zaGlmdCA9IGRhdGEudW5zaGlmdDtcblx0XHRcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5kYXRhLCBcInVuc2hpZnRcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24oKXtcblx0XHRcdFx0dmFyIGFyZ3MgPSBBcnJheS5mcm9tKGFyZ3VtZW50cyksXG5cdFx0XHRcdHJlc3VsdDtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKCFzZWxmLmJsb2NrZWQgJiYgdmVyc2lvbiA9PT0gc2VsZi5jdXJyZW50VmVyc2lvbil7XG5cdFx0XHRcdFx0c2VsZi5ibG9jayhcImRhdGEtdW5zaGlmdFwiKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRhcmdzLmZvckVhY2goKGFyZykgPT4ge1xuXHRcdFx0XHRcdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLmFkZFJvd0FjdHVhbChhcmcsIHRydWUpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJlc3VsdCA9IHNlbGYub3JpZ0Z1bmNzLnVuc2hpZnQuYXBwbHkoZGF0YSwgYXJndW1lbnRzKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRzZWxmLnVuYmxvY2soXCJkYXRhLXVuc2hpZnRcIik7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0XG5cdFx0Ly9vdmVycmlkZSBhcnJheSBzaGlmdCBmdW5jdGlvblxuXHRcdHRoaXMub3JpZ0Z1bmNzLnNoaWZ0ID0gZGF0YS5zaGlmdDtcblx0XHRcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5kYXRhLCBcInNoaWZ0XCIsIHtcblx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxuXHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHZhciByb3csIHJlc3VsdDtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKCFzZWxmLmJsb2NrZWQgJiYgdmVyc2lvbiA9PT0gc2VsZi5jdXJyZW50VmVyc2lvbil7XG5cdFx0XHRcdFx0c2VsZi5ibG9jayhcImRhdGEtc2hpZnRcIik7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoc2VsZi5kYXRhLmxlbmd0aCl7XG5cdFx0XHRcdFx0XHRyb3cgPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0Um93RnJvbURhdGFPYmplY3Qoc2VsZi5kYXRhWzBdKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYocm93KXtcblx0XHRcdFx0XHRcdFx0cm93LmRlbGV0ZUFjdHVhbCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJlc3VsdCA9IHNlbGYub3JpZ0Z1bmNzLnNoaWZ0LmNhbGwoZGF0YSk7XG5cblx0XHRcdFx0XHRzZWxmLnVuYmxvY2soXCJkYXRhLXNoaWZ0XCIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdC8vb3ZlcnJpZGUgYXJyYXkgcG9wIGZ1bmN0aW9uXG5cdFx0dGhpcy5vcmlnRnVuY3MucG9wID0gZGF0YS5wb3A7XG5cdFx0XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuZGF0YSwgXCJwb3BcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24oKXtcblx0XHRcdFx0dmFyIHJvdywgcmVzdWx0O1xuXHRcdFx0XG5cdFx0XHRcdGlmKCFzZWxmLmJsb2NrZWQgJiYgdmVyc2lvbiA9PT0gc2VsZi5jdXJyZW50VmVyc2lvbil7XG5cdFx0XHRcdFx0c2VsZi5ibG9jayhcImRhdGEtcG9wXCIpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKHNlbGYuZGF0YS5sZW5ndGgpe1xuXHRcdFx0XHRcdFx0cm93ID0gc2VsZi50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd0Zyb21EYXRhT2JqZWN0KHNlbGYuZGF0YVtzZWxmLmRhdGEubGVuZ3RoIC0gMV0pO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZihyb3cpe1xuXHRcdFx0XHRcdFx0XHRyb3cuZGVsZXRlQWN0dWFsKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmVzdWx0ID0gc2VsZi5vcmlnRnVuY3MucG9wLmNhbGwoZGF0YSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0c2VsZi51bmJsb2NrKFwiZGF0YS1wb3BcIik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdFxuXHRcdC8vb3ZlcnJpZGUgYXJyYXkgc3BsaWNlIGZ1bmN0aW9uXG5cdFx0dGhpcy5vcmlnRnVuY3Muc3BsaWNlID0gZGF0YS5zcGxpY2U7XG5cdFx0XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuZGF0YSwgXCJzcGxpY2VcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24oKXtcblx0XHRcdFx0dmFyIGFyZ3MgPSBBcnJheS5mcm9tKGFyZ3VtZW50cyksXG5cdFx0XHRcdHN0YXJ0ID0gYXJnc1swXSA8IDAgPyBkYXRhLmxlbmd0aCArIGFyZ3NbMF0gOiBhcmdzWzBdLFxuXHRcdFx0XHRlbmQgPSBhcmdzWzFdLFxuXHRcdFx0XHRuZXdSb3dzID0gYXJnc1syXSA/IGFyZ3Muc2xpY2UoMikgOiBmYWxzZSxcblx0XHRcdFx0c3RhcnRSb3csIHJlc3VsdDtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKCFzZWxmLmJsb2NrZWQgJiYgdmVyc2lvbiA9PT0gc2VsZi5jdXJyZW50VmVyc2lvbil7XG5cdFx0XHRcdFx0c2VsZi5ibG9jayhcImRhdGEtc3BsaWNlXCIpO1xuXHRcdFx0XHRcdC8vYWRkIG5ldyByb3dzXG5cdFx0XHRcdFx0aWYobmV3Um93cyl7XG5cdFx0XHRcdFx0XHRzdGFydFJvdyA9IGRhdGFbc3RhcnRdID8gc2VsZi50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd0Zyb21EYXRhT2JqZWN0KGRhdGFbc3RhcnRdKSA6IGZhbHNlO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZihzdGFydFJvdyl7XG5cdFx0XHRcdFx0XHRcdG5ld1Jvd3MuZm9yRWFjaCgocm93RGF0YSkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdHNlbGYudGFibGUucm93TWFuYWdlci5hZGRSb3dBY3R1YWwocm93RGF0YSwgdHJ1ZSwgc3RhcnRSb3csIHRydWUpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdFx0bmV3Um93cyA9IG5ld1Jvd3Muc2xpY2UoKS5yZXZlcnNlKCk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRuZXdSb3dzLmZvckVhY2goKHJvd0RhdGEpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLnRhYmxlLnJvd01hbmFnZXIuYWRkUm93QWN0dWFsKHJvd0RhdGEsIHRydWUsIGZhbHNlLCB0cnVlKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vZGVsZXRlIHJlbW92ZWQgcm93c1xuXHRcdFx0XHRcdGlmKGVuZCAhPT0gMCl7XG5cdFx0XHRcdFx0XHR2YXIgb2xkUm93cyA9IGRhdGEuc2xpY2Uoc3RhcnQsIHR5cGVvZiBhcmdzWzFdID09PSBcInVuZGVmaW5lZFwiID8gYXJnc1sxXSA6IHN0YXJ0ICsgZW5kKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0b2xkUm93cy5mb3JFYWNoKChyb3dEYXRhLCBpKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHZhciByb3cgPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0Um93RnJvbURhdGFPYmplY3Qocm93RGF0YSk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRpZihyb3cpe1xuXHRcdFx0XHRcdFx0XHRcdHJvdy5kZWxldGVBY3R1YWwoaSAhPT0gb2xkUm93cy5sZW5ndGggLSAxKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKG5ld1Jvd3MgfHwgZW5kICE9PSAwKXtcblx0XHRcdFx0XHRcdHNlbGYudGFibGUucm93TWFuYWdlci5yZVJlbmRlckluUG9zaXRpb24oKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXN1bHQgPSBzZWxmLm9yaWdGdW5jcy5zcGxpY2UuYXBwbHkoZGF0YSwgYXJndW1lbnRzKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRzZWxmLnVuYmxvY2soXCJkYXRhLXNwbGljZVwiKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIHJlc3VsdCA7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0XG5cdHVud2F0Y2hEYXRhKCl7XG5cdFx0aWYodGhpcy5kYXRhICE9PSBmYWxzZSl7XG5cdFx0XHRmb3IodmFyIGtleSBpbiB0aGlzLm9yaWdGdW5jcyl7XG5cdFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLmRhdGEsIGtleSwge1xuXHRcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHRcdFx0Y29uZmlndXJhYmxlOnRydWUsXG5cdFx0XHRcdFx0d3JpdGFibGU6dHJ1ZSxcblx0XHRcdFx0XHR2YWx1ZTogdGhpcy5vcmlnRnVuY3Mua2V5LFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdHdhdGNoUm93KHJvdyl7XG5cdFx0dmFyIGRhdGEgPSByb3cuZ2V0RGF0YSgpO1xuXHRcdFxuXHRcdGZvcih2YXIga2V5IGluIGRhdGEpe1xuXHRcdFx0dGhpcy53YXRjaEtleShyb3csIGRhdGEsIGtleSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZSl7XG5cdFx0XHR0aGlzLndhdGNoVHJlZUNoaWxkcmVuKHJvdyk7XG5cdFx0fVxuXHR9XG5cdFxuXHR3YXRjaFRyZWVDaGlsZHJlbiAocm93KXtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0Y2hpbGRGaWVsZCA9IHJvdy5nZXREYXRhKClbdGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlQ2hpbGRGaWVsZF0sXG5cdFx0b3JpZ0Z1bmNzID0ge307XG5cdFx0XG5cdFx0aWYoY2hpbGRGaWVsZCl7XG5cdFx0XHRcblx0XHRcdG9yaWdGdW5jcy5wdXNoID0gY2hpbGRGaWVsZC5wdXNoO1xuXHRcdFx0XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoY2hpbGRGaWVsZCwgXCJwdXNoXCIsIHtcblx0XHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRcdFx0dmFsdWU6ICgpID0+IHtcblx0XHRcdFx0XHRpZighc2VsZi5ibG9ja2VkKXtcblx0XHRcdFx0XHRcdHNlbGYuYmxvY2soXCJ0cmVlLXB1c2hcIik7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHZhciByZXN1bHQgPSBvcmlnRnVuY3MucHVzaC5hcHBseShjaGlsZEZpZWxkLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWJ1aWxkVHJlZShyb3cpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRzZWxmLnVuYmxvY2soXCJ0cmVlLXB1c2hcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRvcmlnRnVuY3MudW5zaGlmdCA9IGNoaWxkRmllbGQudW5zaGlmdDtcblx0XHRcdFxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGNoaWxkRmllbGQsIFwidW5zaGlmdFwiLCB7XG5cdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxuXHRcdFx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0XHRcdHZhbHVlOiAoKSA9PiB7XG5cdFx0XHRcdFx0aWYoIXNlbGYuYmxvY2tlZCl7XG5cdFx0XHRcdFx0XHRzZWxmLmJsb2NrKFwidHJlZS11bnNoaWZ0XCIpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHR2YXIgcmVzdWx0ID0gIG9yaWdGdW5jcy51bnNoaWZ0LmFwcGx5KGNoaWxkRmllbGQsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0XHR0aGlzLnJlYnVpbGRUcmVlKHJvdyk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHNlbGYudW5ibG9jayhcInRyZWUtdW5zaGlmdFwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdG9yaWdGdW5jcy5zaGlmdCA9IGNoaWxkRmllbGQuc2hpZnQ7XG5cdFx0XHRcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjaGlsZEZpZWxkLCBcInNoaWZ0XCIsIHtcblx0XHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRcdFx0dmFsdWU6ICgpID0+IHtcblx0XHRcdFx0XHRpZighc2VsZi5ibG9ja2VkKXtcblx0XHRcdFx0XHRcdHNlbGYuYmxvY2soXCJ0cmVlLXNoaWZ0XCIpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHR2YXIgcmVzdWx0ID0gIG9yaWdGdW5jcy5zaGlmdC5jYWxsKGNoaWxkRmllbGQpO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWJ1aWxkVHJlZShyb3cpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRzZWxmLnVuYmxvY2soXCJ0cmVlLXNoaWZ0XCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0b3JpZ0Z1bmNzLnBvcCA9IGNoaWxkRmllbGQucG9wO1xuXHRcdFx0XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoY2hpbGRGaWVsZCwgXCJwb3BcIiwge1xuXHRcdFx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcblx0XHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlLFxuXHRcdFx0XHR2YWx1ZTogKCkgPT4ge1xuXHRcdFx0XHRcdGlmKCFzZWxmLmJsb2NrZWQpe1xuXHRcdFx0XHRcdFx0c2VsZi5ibG9jayhcInRyZWUtcG9wXCIpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHR2YXIgcmVzdWx0ID0gIG9yaWdGdW5jcy5wb3AuY2FsbChjaGlsZEZpZWxkKTtcblx0XHRcdFx0XHRcdHRoaXMucmVidWlsZFRyZWUocm93KTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0c2VsZi51bmJsb2NrKFwidHJlZS1wb3BcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRvcmlnRnVuY3Muc3BsaWNlID0gY2hpbGRGaWVsZC5zcGxpY2U7XG5cdFx0XHRcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjaGlsZEZpZWxkLCBcInNwbGljZVwiLCB7XG5cdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxuXHRcdFx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0XHRcdHZhbHVlOiAoKSA9PiB7XG5cdFx0XHRcdFx0aWYoIXNlbGYuYmxvY2tlZCl7XG5cdFx0XHRcdFx0XHRzZWxmLmJsb2NrKFwidHJlZS1zcGxpY2VcIik7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHZhciByZXN1bHQgPSAgb3JpZ0Z1bmNzLnNwbGljZS5hcHBseShjaGlsZEZpZWxkLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWJ1aWxkVHJlZShyb3cpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRzZWxmLnVuYmxvY2soXCJ0cmVlLXNwbGljZVwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZWJ1aWxkVHJlZShyb3cpe1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5kYXRhVHJlZS5pbml0aWFsaXplUm93KHJvdyk7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmxheW91dFJvdyhyb3cpO1xuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcInRyZWVcIiwgZmFsc2UsIHRydWUpO1xuXHR9XG5cdFxuXHR3YXRjaEtleShyb3csIGRhdGEsIGtleSl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdHByb3BzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihkYXRhLCBrZXkpLFxuXHRcdHZhbHVlID0gZGF0YVtrZXldLFxuXHRcdHZlcnNpb24gPSB0aGlzLmN1cnJlbnRWZXJzaW9uO1xuXHRcdFxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkYXRhLCBrZXksIHtcblx0XHRcdHNldDogKG5ld1ZhbHVlKSA9PiB7XG5cdFx0XHRcdHZhbHVlID0gbmV3VmFsdWU7XG5cdFx0XHRcdGlmKCFzZWxmLmJsb2NrZWQgJiYgdmVyc2lvbiA9PT0gc2VsZi5jdXJyZW50VmVyc2lvbil7XG5cdFx0XHRcdFx0c2VsZi5ibG9jayhcImtleVwiKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR2YXIgdXBkYXRlID0ge307XG5cdFx0XHRcdFx0dXBkYXRlW2tleV0gPSBuZXdWYWx1ZTtcblx0XHRcdFx0XHRyb3cudXBkYXRlRGF0YSh1cGRhdGUpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHNlbGYudW5ibG9jayhcImtleVwiKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYocHJvcHMuc2V0KXtcblx0XHRcdFx0XHRwcm9wcy5zZXQobmV3VmFsdWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0Z2V0OigpID0+IHtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHByb3BzLmdldCl7XG5cdFx0XHRcdFx0cHJvcHMuZ2V0KCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0dW53YXRjaFJvdyhyb3cpe1xuXHRcdHZhciBkYXRhID0gcm93LmdldERhdGEoKTtcblx0XHRcblx0XHRmb3IodmFyIGtleSBpbiBkYXRhKXtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkYXRhLCBrZXksIHtcblx0XHRcdFx0dmFsdWU6ZGF0YVtrZXldLFxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRibG9jayhrZXkpe1xuXHRcdGlmKCF0aGlzLmJsb2NrZWQpe1xuXHRcdFx0dGhpcy5ibG9ja2VkID0ga2V5O1xuXHRcdH1cblx0fVxuXHRcblx0dW5ibG9jayhrZXkpe1xuXHRcdGlmKHRoaXMuYmxvY2tlZCA9PT0ga2V5KXtcblx0XHRcdHRoaXMuYmxvY2tlZCA9IGZhbHNlO1xuXHRcdH1cblx0fVxufVxuXG5jbGFzcyBSZXNpemVDb2x1bW5zIGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJyZXNpemVDb2x1bW5zXCI7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLnN0YXJ0Q29sdW1uID0gZmFsc2U7XG5cdFx0dGhpcy5zdGFydFggPSBmYWxzZTtcblx0XHR0aGlzLnN0YXJ0V2lkdGggPSBmYWxzZTtcblx0XHR0aGlzLmxhdGVzdFggPSBmYWxzZTtcblx0XHR0aGlzLmhhbmRsZSA9IG51bGw7XG5cdFx0dGhpcy5pbml0aWFsTmV4dENvbHVtbiA9IG51bGw7XG5cdFx0dGhpcy5uZXh0Q29sdW1uID0gbnVsbDtcblx0XHRcblx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInJlc2l6YWJsZVwiLCB0cnVlKTtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJyZXNpemFibGVDb2x1bW5GaXRcIiwgZmFsc2UpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInJlc2l6YWJsZUNvbHVtbkd1aWRlXCIsIGZhbHNlKTtcblx0fVxuXHRcblx0aW5pdGlhbGl6ZSgpe1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLXJlbmRlcmVkXCIsIHRoaXMubGF5b3V0Q29sdW1uSGVhZGVyLmJpbmQodGhpcykpO1xuXHR9XG5cdFxuXHRpbml0aWFsaXplRXZlbnRXYXRjaGVycygpe1xuXHRcdGlmKCF0aGlzLmluaXRpYWxpemVkKXtcblx0XHRcdFxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLXJlbmRlcmVkXCIsIHRoaXMubGF5b3V0Q2VsbEhhbmRsZXMuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtZGVsZXRlXCIsIHRoaXMuZGVJbml0aWFsaXplQ29tcG9uZW50LmJpbmQodGhpcykpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtaGVpZ2h0XCIsIHRoaXMucmVzaXplSGFuZGxlLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tbW92ZWRcIiwgdGhpcy5jb2x1bW5MYXlvdXRVcGRhdGVkLmJpbmQodGhpcykpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1oaWRlXCIsIHRoaXMuZGVJbml0aWFsaXplQ29sdW1uLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tc2hvd1wiLCB0aGlzLmNvbHVtbkxheW91dFVwZGF0ZWQuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi13aWR0aFwiLCB0aGlzLmNvbHVtbldpZHRoVXBkYXRlZC5iaW5kKHRoaXMpKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tZGVsZXRlXCIsIHRoaXMuZGVJbml0aWFsaXplQ29tcG9uZW50LmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4taGVpZ2h0XCIsIHRoaXMucmVzaXplSGFuZGxlLmJpbmQodGhpcykpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0XHR9XG5cdH1cblx0XG5cdFxuXHRsYXlvdXRDZWxsSGFuZGxlcyhjZWxsKXtcblx0XHRpZihjZWxsLnJvdy50eXBlID09PSBcInJvd1wiKXtcblx0XHRcdHRoaXMuZGVJbml0aWFsaXplQ29tcG9uZW50KGNlbGwpO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQ29sdW1uKFwiY2VsbFwiLCBjZWxsLCBjZWxsLmNvbHVtbiwgY2VsbC5lbGVtZW50KTtcblx0XHR9XG5cdH1cblx0XG5cdGxheW91dENvbHVtbkhlYWRlcihjb2x1bW4pe1xuXHRcdGlmKGNvbHVtbi5kZWZpbml0aW9uLnJlc2l6YWJsZSl7XG5cdFx0XHR0aGlzLmluaXRpYWxpemVFdmVudFdhdGNoZXJzKCk7XG5cdFx0XHR0aGlzLmRlSW5pdGlhbGl6ZUNvbXBvbmVudChjb2x1bW4pO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQ29sdW1uKFwiaGVhZGVyXCIsIGNvbHVtbiwgY29sdW1uLCBjb2x1bW4uZWxlbWVudCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRjb2x1bW5MYXlvdXRVcGRhdGVkKGNvbHVtbil7XG5cdFx0dmFyIHByZXYgPSBjb2x1bW4ucHJldkNvbHVtbigpO1xuXHRcdFxuXHRcdHRoaXMucmVpbml0aWFsaXplQ29sdW1uKGNvbHVtbik7XG5cdFx0XG5cdFx0aWYocHJldil7XG5cdFx0XHR0aGlzLnJlaW5pdGlhbGl6ZUNvbHVtbihwcmV2KTtcblx0XHR9XG5cdH1cblx0XG5cdGNvbHVtbldpZHRoVXBkYXRlZChjb2x1bW4pe1xuXHRcdGlmKGNvbHVtbi5tb2R1bGVzLmZyb3plbil7XG5cdFx0XHRpZih0aGlzLnRhYmxlLm1vZHVsZXMuZnJvemVuQ29sdW1ucy5sZWZ0Q29sdW1ucy5pbmNsdWRlcyhjb2x1bW4pKXtcblx0XHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmZyb3plbkNvbHVtbnMubGVmdENvbHVtbnMuZm9yRWFjaCgoY29sKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5yZWluaXRpYWxpemVDb2x1bW4oY29sKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9ZWxzZSBpZih0aGlzLnRhYmxlLm1vZHVsZXMuZnJvemVuQ29sdW1ucy5yaWdodENvbHVtbnMuaW5jbHVkZXMoY29sdW1uKSl7XG5cdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLnJpZ2h0Q29sdW1ucy5mb3JFYWNoKChjb2wpID0+IHtcblx0XHRcdFx0XHR0aGlzLnJlaW5pdGlhbGl6ZUNvbHVtbihjb2wpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRmcm96ZW5Db2x1bW5PZmZzZXQoY29sdW1uKXtcblx0XHR2YXIgb2Zmc2V0ID0gZmFsc2U7XG5cblx0XHRpZihjb2x1bW4ubW9kdWxlcy5mcm96ZW4pe1xuXHRcdFx0b2Zmc2V0ID0gY29sdW1uLm1vZHVsZXMuZnJvemVuLm1hcmdpblZhbHVlOyBcblxuXHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuZnJvemVuLnBvc2l0aW9uID09PSBcImxlZnRcIil7XG5cdFx0XHRcdG9mZnNldCArPSBjb2x1bW4uZ2V0V2lkdGgoKSAtIDM7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKG9mZnNldCl7XG5cdFx0XHRcdFx0b2Zmc2V0IC09IDM7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gb2Zmc2V0ICE9PSBmYWxzZSA/IG9mZnNldCArIFwicHhcIiA6IGZhbHNlO1xuXHR9XG5cdFxuXHRyZWluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHR2YXIgZnJvemVuT2Zmc2V0ID0gdGhpcy5mcm96ZW5Db2x1bW5PZmZzZXQoY29sdW1uKTtcblx0XHRcblx0XHRjb2x1bW4uY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuXHRcdFx0aWYoY2VsbC5tb2R1bGVzLnJlc2l6ZSAmJiBjZWxsLm1vZHVsZXMucmVzaXplLmhhbmRsZUVsKXtcblx0XHRcdFx0aWYoZnJvemVuT2Zmc2V0KXtcblx0XHRcdFx0XHRjZWxsLm1vZHVsZXMucmVzaXplLmhhbmRsZUVsLnN0eWxlW2NvbHVtbi5tb2R1bGVzLmZyb3plbi5wb3NpdGlvbl0gPSBmcm96ZW5PZmZzZXQ7XG5cdFx0XHRcdFx0Y2VsbC5tb2R1bGVzLnJlc2l6ZS5oYW5kbGVFbC5zdHlsZVtcInotaW5kZXhcIl0gPSAxMTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Y2VsbC5lbGVtZW50LmFmdGVyKGNlbGwubW9kdWxlcy5yZXNpemUuaGFuZGxlRWwpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdGlmKGNvbHVtbi5tb2R1bGVzLnJlc2l6ZSAmJiBjb2x1bW4ubW9kdWxlcy5yZXNpemUuaGFuZGxlRWwpe1xuXHRcdFx0aWYoZnJvemVuT2Zmc2V0KXtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMucmVzaXplLmhhbmRsZUVsLnN0eWxlW2NvbHVtbi5tb2R1bGVzLmZyb3plbi5wb3NpdGlvbl0gPSBmcm96ZW5PZmZzZXQ7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGNvbHVtbi5lbGVtZW50LmFmdGVyKGNvbHVtbi5tb2R1bGVzLnJlc2l6ZS5oYW5kbGVFbCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRpbml0aWFsaXplQ29sdW1uKHR5cGUsIGNvbXBvbmVudCwgY29sdW1uLCBlbGVtZW50KXtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0dmFyaWFibGVIZWlnaHQgPSBmYWxzZSxcblx0XHRtb2RlID0gY29sdW1uLmRlZmluaXRpb24ucmVzaXphYmxlLFxuXHRcdGNvbmZpZyA9IHt9LFxuXHRcdG5lYXJlc3RDb2x1bW4gPSBjb2x1bW4uZ2V0TGFzdENvbHVtbigpO1xuXHRcdFxuXHRcdC8vc2V0IGNvbHVtbiByZXNpemUgbW9kZVxuXHRcdGlmKHR5cGUgPT09IFwiaGVhZGVyXCIpe1xuXHRcdFx0dmFyaWFibGVIZWlnaHQgPSBjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXIgPT0gXCJ0ZXh0YXJlYVwiIHx8IGNvbHVtbi5kZWZpbml0aW9uLnZhcmlhYmxlSGVpZ2h0O1xuXHRcdFx0Y29uZmlnID0ge3ZhcmlhYmxlSGVpZ2h0OnZhcmlhYmxlSGVpZ2h0fTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoKG1vZGUgPT09IHRydWUgfHwgbW9kZSA9PSB0eXBlKSAmJiB0aGlzLl9jaGVja1Jlc2l6YWJpbGl0eShuZWFyZXN0Q29sdW1uKSl7XG5cdFx0XHRcblx0XHRcdHZhciBoYW5kbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cdFx0XHRoYW5kbGUuY2xhc3NOYW1lID0gXCJ0YWJ1bGF0b3ItY29sLXJlc2l6ZS1oYW5kbGVcIjtcblx0XHRcdFxuXHRcdFx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR2YXIgaGFuZGxlRG93biA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHRzZWxmLnN0YXJ0Q29sdW1uID0gY29sdW1uO1xuXHRcdFx0XHRzZWxmLmluaXRpYWxOZXh0Q29sdW1uID0gc2VsZi5uZXh0Q29sdW1uID0gbmVhcmVzdENvbHVtbi5uZXh0Q29sdW1uKCk7XG5cdFx0XHRcdHNlbGYuX21vdXNlRG93bihlLCBuZWFyZXN0Q29sdW1uLCBoYW5kbGUpO1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlRG93bik7XG5cdFx0XHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgaGFuZGxlRG93biwge3Bhc3NpdmU6IHRydWV9KTtcblx0XHRcdFxuXHRcdFx0Ly9yZXNpemUgY29sdW1uIG9uICBkb3VibGUgY2xpY2tcblx0XHRcdGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdFx0dmFyIG9sZFdpZHRoID0gbmVhcmVzdENvbHVtbi5nZXRXaWR0aCgpO1xuXHRcdFx0XHRcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0bmVhcmVzdENvbHVtbi5yZWluaXRpYWxpemVXaWR0aCh0cnVlKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKG9sZFdpZHRoICE9PSBuZWFyZXN0Q29sdW1uLmdldFdpZHRoKCkpe1xuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2goXCJjb2x1bW4tcmVzaXplZFwiLCBuZWFyZXN0Q29sdW1uKTtcblx0XHRcdFx0XHRzZWxmLmRpc3BhdGNoRXh0ZXJuYWwoXCJjb2x1bW5SZXNpemVkXCIsIG5lYXJlc3RDb2x1bW4uZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuZnJvemVuKXtcblx0XHRcdFx0aGFuZGxlLnN0eWxlLnBvc2l0aW9uID0gXCJzdGlja3lcIjtcblx0XHRcdFx0aGFuZGxlLnN0eWxlW2NvbHVtbi5tb2R1bGVzLmZyb3plbi5wb3NpdGlvbl0gPSB0aGlzLmZyb3plbkNvbHVtbk9mZnNldChjb2x1bW4pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb25maWcuaGFuZGxlRWwgPSBoYW5kbGU7XG5cdFx0XHRcblx0XHRcdGlmKGVsZW1lbnQucGFyZW50Tm9kZSAmJiBjb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRcdGVsZW1lbnQuYWZ0ZXIoaGFuZGxlKTtcdFx0XHRcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Y29tcG9uZW50Lm1vZHVsZXMucmVzaXplID0gY29uZmlnO1xuXHR9XG5cdFxuXHRkZUluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHR0aGlzLmRlSW5pdGlhbGl6ZUNvbXBvbmVudChjb2x1bW4pO1xuXHRcdFxuXHRcdGNvbHVtbi5jZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG5cdFx0XHR0aGlzLmRlSW5pdGlhbGl6ZUNvbXBvbmVudChjZWxsKTtcblx0XHR9KTtcblx0fVxuXHRcblx0ZGVJbml0aWFsaXplQ29tcG9uZW50KGNvbXBvbmVudCl7XG5cdFx0dmFyIGhhbmRsZUVsO1xuXHRcdFxuXHRcdGlmKGNvbXBvbmVudC5tb2R1bGVzLnJlc2l6ZSl7XG5cdFx0XHRoYW5kbGVFbCA9IGNvbXBvbmVudC5tb2R1bGVzLnJlc2l6ZS5oYW5kbGVFbDtcblx0XHRcdFxuXHRcdFx0aWYoaGFuZGxlRWwgJiYgaGFuZGxlRWwucGFyZW50RWxlbWVudCl7XG5cdFx0XHRcdGhhbmRsZUVsLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoaGFuZGxlRWwpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0cmVzaXplSGFuZGxlKGNvbXBvbmVudCwgaGVpZ2h0KXtcblx0XHRpZihjb21wb25lbnQubW9kdWxlcy5yZXNpemUgJiYgY29tcG9uZW50Lm1vZHVsZXMucmVzaXplLmhhbmRsZUVsKXtcblx0XHRcdGNvbXBvbmVudC5tb2R1bGVzLnJlc2l6ZS5oYW5kbGVFbC5zdHlsZS5oZWlnaHQgPSBoZWlnaHQ7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZXNpemUoZSwgY29sdW1uKXtcblx0XHR2YXIgeCA9IHR5cGVvZiBlLmNsaWVudFggPT09IFwidW5kZWZpbmVkXCIgPyBlLnRvdWNoZXNbMF0uY2xpZW50WCA6IGUuY2xpZW50WCxcblx0XHRzdGFydERpZmYgPSB4IC0gdGhpcy5zdGFydFgsXG5cdFx0bW92ZURpZmYgPSB4IC0gdGhpcy5sYXRlc3RYLFxuXHRcdGJsb2NrZWRCZWZvcmUsIGJsb2NrZWRBZnRlcjtcblxuXHRcdHRoaXMubGF0ZXN0WCA9IHg7XG5cblx0XHRpZih0aGlzLnRhYmxlLnJ0bCl7XG5cdFx0XHRzdGFydERpZmYgPSAtc3RhcnREaWZmO1xuXHRcdFx0bW92ZURpZmYgPSAtbW92ZURpZmY7XG5cdFx0fVxuXG5cdFx0YmxvY2tlZEJlZm9yZSA9IGNvbHVtbi53aWR0aCA9PSBjb2x1bW4ubWluV2lkdGggfHwgY29sdW1uLndpZHRoID09IGNvbHVtbi5tYXhXaWR0aDtcblxuXHRcdGNvbHVtbi5zZXRXaWR0aCh0aGlzLnN0YXJ0V2lkdGggKyBzdGFydERpZmYpO1xuXG5cdFx0YmxvY2tlZEFmdGVyID0gY29sdW1uLndpZHRoID09IGNvbHVtbi5taW5XaWR0aCB8fCBjb2x1bW4ud2lkdGggPT0gY29sdW1uLm1heFdpZHRoO1xuXG5cdFx0aWYobW92ZURpZmYgPCAwKXtcblx0XHRcdHRoaXMubmV4dENvbHVtbiA9IHRoaXMuaW5pdGlhbE5leHRDb2x1bW47XG5cdFx0fVxuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJlc2l6YWJsZUNvbHVtbkZpdCAmJiB0aGlzLm5leHRDb2x1bW4gJiYgIShibG9ja2VkQmVmb3JlICYmIGJsb2NrZWRBZnRlcikpe1xuXHRcdFx0bGV0IGNvbFdpZHRoID0gdGhpcy5uZXh0Q29sdW1uLmdldFdpZHRoKCk7XG5cblx0XHRcdGlmKG1vdmVEaWZmID4gMCl7XG5cdFx0XHRcdGlmKGNvbFdpZHRoIDw9IHRoaXMubmV4dENvbHVtbi5taW5XaWR0aCl7XG5cdFx0XHRcdFx0dGhpcy5uZXh0Q29sdW1uID0gdGhpcy5uZXh0Q29sdW1uLm5leHRDb2x1bW4oKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZih0aGlzLm5leHRDb2x1bW4pe1xuXHRcdFx0XHR0aGlzLm5leHRDb2x1bW4uc2V0V2lkdGgodGhpcy5uZXh0Q29sdW1uLmdldFdpZHRoKCkgLSBtb3ZlRGlmZik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLnJlcmVuZGVyQ29sdW1ucyh0cnVlKTtcblxuXHRcdGlmKCF0aGlzLnRhYmxlLmJyb3dzZXJTbG93ICYmIGNvbHVtbi5tb2R1bGVzLnJlc2l6ZSAmJiBjb2x1bW4ubW9kdWxlcy5yZXNpemUudmFyaWFibGVIZWlnaHQpe1xuXHRcdFx0Y29sdW1uLmNoZWNrQ2VsbEhlaWdodHMoKTtcblx0XHR9XG5cdH1cblxuXHRjYWxjR3VpZGVQb3NpdGlvbihlLCBjb2x1bW4sIGhhbmRsZSkge1xuXHRcdHZhciBtb3VzZVggPSB0eXBlb2YgZS5jbGllbnRYID09PSBcInVuZGVmaW5lZFwiID8gZS50b3VjaGVzWzBdLmNsaWVudFggOiBlLmNsaWVudFgsXG5cdFx0aGFuZGxlWCA9IGhhbmRsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS54IC0gdGhpcy50YWJsZS5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLngsXG5cdFx0dGFibGVYID0gdGhpcy50YWJsZS5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLngsXG5cdFx0Y29sdW1uWCA9IGNvbHVtbi5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgLSB0YWJsZVgsXG5cdFx0bW91c2VEaWZmID0gbW91c2VYIC0gdGhpcy5zdGFydFgsXG5cdFx0cG9zID0gTWF0aC5tYXgoaGFuZGxlWCArIG1vdXNlRGlmZiwgY29sdW1uWCArIGNvbHVtbi5taW5XaWR0aCk7XG5cblx0XHRpZihjb2x1bW4ubWF4V2lkdGgpe1xuXHRcdFx0cG9zID0gTWF0aC5taW4ocG9zLCBjb2x1bW5YICsgY29sdW1uLm1heFdpZHRoKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gcG9zO1xuXHR9XG5cblx0X2NoZWNrUmVzaXphYmlsaXR5KGNvbHVtbil7XG5cdFx0cmV0dXJuIGNvbHVtbi5kZWZpbml0aW9uLnJlc2l6YWJsZTtcblx0fVxuXHRcblx0X21vdXNlRG93bihlLCBjb2x1bW4sIGhhbmRsZSl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdGd1aWRlRWw7XG5cblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJjb2x1bW5SZXNpemluZ1wiLCBjb2x1bW4uZ2V0Q29tcG9uZW50KCkpO1xuXG5cdFx0aWYoc2VsZi50YWJsZS5vcHRpb25zLnJlc2l6YWJsZUNvbHVtbkd1aWRlKXtcblx0XHRcdGd1aWRlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHRcdGd1aWRlRWwuY2xhc3NMaXN0LmFkZCgndGFidWxhdG9yLWNvbC1yZXNpemUtZ3VpZGUnKTtcblx0XHRcdHNlbGYudGFibGUuZWxlbWVudC5hcHBlbmRDaGlsZChndWlkZUVsKTtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRndWlkZUVsLnN0eWxlLmxlZnQgPSBzZWxmLmNhbGNHdWlkZVBvc2l0aW9uKGUsIGNvbHVtbiwgaGFuZGxlKSArIFwicHhcIjtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHNlbGYudGFibGUuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblxuXHRcdGZ1bmN0aW9uIG1vdXNlTW92ZShlKXtcblx0XHRcdGlmKHNlbGYudGFibGUub3B0aW9ucy5yZXNpemFibGVDb2x1bW5HdWlkZSl7XG5cdFx0XHRcdGd1aWRlRWwuc3R5bGUubGVmdCA9IHNlbGYuY2FsY0d1aWRlUG9zaXRpb24oZSwgY29sdW1uLCBoYW5kbGUpICsgXCJweFwiO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRzZWxmLnJlc2l6ZShlLCBjb2x1bW4pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRmdW5jdGlvbiBtb3VzZVVwKGUpe1xuXHRcdFx0aWYoc2VsZi50YWJsZS5vcHRpb25zLnJlc2l6YWJsZUNvbHVtbkd1aWRlKXtcblx0XHRcdFx0c2VsZi5yZXNpemUoZSwgY29sdW1uKTtcblx0XHRcdFx0Z3VpZGVFbC5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly9ibG9jayBlZGl0b3IgZnJvbSB0YWtpbmcgYWN0aW9uIHdoaWxlIHJlc2l6aW5nIGlzIHRha2luZyBwbGFjZVxuXHRcdFx0aWYoc2VsZi5zdGFydENvbHVtbi5tb2R1bGVzLmVkaXQpe1xuXHRcdFx0XHRzZWxmLnN0YXJ0Q29sdW1uLm1vZHVsZXMuZWRpdC5ibG9ja2VkID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKHNlbGYudGFibGUuYnJvd3NlclNsb3cgJiYgY29sdW1uLm1vZHVsZXMucmVzaXplICYmIGNvbHVtbi5tb2R1bGVzLnJlc2l6ZS52YXJpYWJsZUhlaWdodCl7XG5cdFx0XHRcdGNvbHVtbi5jaGVja0NlbGxIZWlnaHRzKCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgbW91c2VVcCk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgbW91c2VNb3ZlKTtcblx0XHRcdFxuXHRcdFx0aGFuZGxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgbW91c2VNb3ZlKTtcblx0XHRcdGhhbmRsZS5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgbW91c2VVcCk7XG5cdFx0XHRcblx0XHRcdHNlbGYudGFibGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblx0XHRcdFxuXHRcdFx0aWYoc2VsZi5zdGFydFdpZHRoICE9PSBjb2x1bW4uZ2V0V2lkdGgoKSl7XG5cdFx0XHRcdHNlbGYudGFibGUuY29sdW1uTWFuYWdlci52ZXJ0aWNhbEFsaWduSGVhZGVycygpO1xuXG5cdFx0XHRcdHNlbGYuZGlzcGF0Y2goXCJjb2x1bW4tcmVzaXplZFwiLCBjb2x1bW4pO1xuXHRcdFx0XHRzZWxmLmRpc3BhdGNoRXh0ZXJuYWwoXCJjb2x1bW5SZXNpemVkXCIsIGNvbHVtbi5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7IC8vcHJldmVudCByZXNpemUgZnJvbSBpbnRlcmZlcmluZyB3aXRoIG1vdmFibGUgY29sdW1uc1xuXHRcdFxuXHRcdC8vYmxvY2sgZWRpdG9yIGZyb20gdGFraW5nIGFjdGlvbiB3aGlsZSByZXNpemluZyBpcyB0YWtpbmcgcGxhY2Vcblx0XHRpZihzZWxmLnN0YXJ0Q29sdW1uLm1vZHVsZXMuZWRpdCl7XG5cdFx0XHRzZWxmLnN0YXJ0Q29sdW1uLm1vZHVsZXMuZWRpdC5ibG9ja2VkID0gdHJ1ZTtcblx0XHR9XG5cdFx0XG5cdFx0c2VsZi5zdGFydFggPSB0eXBlb2YgZS5jbGllbnRYID09PSBcInVuZGVmaW5lZFwiID8gZS50b3VjaGVzWzBdLmNsaWVudFggOiBlLmNsaWVudFg7XG5cdFx0c2VsZi5sYXRlc3RYID0gc2VsZi5zdGFydFg7XG5cdFx0c2VsZi5zdGFydFdpZHRoID0gY29sdW1uLmdldFdpZHRoKCk7XG5cdFx0XG5cdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIG1vdXNlTW92ZSk7XG5cdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBtb3VzZVVwKTtcblx0XHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCBtb3VzZU1vdmUsIHtwYXNzaXZlOiB0cnVlfSk7XG5cdFx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBtb3VzZVVwKTtcblx0fVxufVxuXG5jbGFzcyBSZXNpemVSb3dzIGV4dGVuZHMgTW9kdWxle1xuXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJyZXNpemVSb3dzXCI7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMuc3RhcnRDb2x1bW4gPSBmYWxzZTtcblx0XHR0aGlzLnN0YXJ0WSA9IGZhbHNlO1xuXHRcdHRoaXMuc3RhcnRIZWlnaHQgPSBmYWxzZTtcblx0XHR0aGlzLmhhbmRsZSA9IG51bGw7XG5cdFx0dGhpcy5wcmV2SGFuZGxlID0gbnVsbDtcblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInJlc2l6YWJsZVJvd3NcIiwgZmFsc2UpOyAvL3Jlc2l6YWJsZSByb3dzXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicmVzaXphYmxlUm93R3VpZGVcIiwgZmFsc2UpO1xuXHR9XG5cblx0aW5pdGlhbGl6ZSgpe1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5yZXNpemFibGVSb3dzKXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWxheW91dC1hZnRlclwiLCB0aGlzLmluaXRpYWxpemVSb3cuYmluZCh0aGlzKSk7XG5cdFx0fVxuXHR9XG5cblx0aW5pdGlhbGl6ZVJvdyhyb3cpe1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRyb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cblx0XHR2YXIgaGFuZGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0aGFuZGxlLmNsYXNzTmFtZSA9IFwidGFidWxhdG9yLXJvdy1yZXNpemUtaGFuZGxlXCI7XG5cblx0XHR2YXIgcHJldkhhbmRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdHByZXZIYW5kbGUuY2xhc3NOYW1lID0gXCJ0YWJ1bGF0b3Itcm93LXJlc2l6ZS1oYW5kbGUgcHJldlwiO1xuXG5cdFx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKXtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cblx0XHR2YXIgaGFuZGxlRG93biA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0c2VsZi5zdGFydFJvdyA9IHJvdztcblx0XHRcdHNlbGYuX21vdXNlRG93bihlLCByb3csIGhhbmRsZSk7XG5cdFx0fTtcblxuXHRcdGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZURvd24pO1xuXHRcdGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBoYW5kbGVEb3duLCB7cGFzc2l2ZTogdHJ1ZX0pO1xuXG5cdFx0cHJldkhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSl7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdH0pO1xuXG5cdFx0dmFyIHByZXZIYW5kbGVEb3duID0gIGZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIHByZXZSb3cgPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIucHJldkRpc3BsYXlSb3cocm93KTtcblxuXHRcdFx0aWYocHJldlJvdyl7XG5cdFx0XHRcdHNlbGYuc3RhcnRSb3cgPSBwcmV2Um93O1xuXHRcdFx0XHRzZWxmLl9tb3VzZURvd24oZSwgcHJldlJvdywgcHJldkhhbmRsZSk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHByZXZIYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLHByZXZIYW5kbGVEb3duKTtcblx0XHRwcmV2SGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIscHJldkhhbmRsZURvd24sIHtwYXNzaXZlOiB0cnVlfSk7XG5cblx0XHRyb3dFbC5hcHBlbmRDaGlsZChoYW5kbGUpO1xuXHRcdHJvd0VsLmFwcGVuZENoaWxkKHByZXZIYW5kbGUpO1xuXHR9XG5cblx0cmVzaXplKGUsIHJvdykge1xuXHRcdHJvdy5zZXRIZWlnaHQodGhpcy5zdGFydEhlaWdodCArICgodHlwZW9mIGUuc2NyZWVuWSA9PT0gXCJ1bmRlZmluZWRcIiA/IGUudG91Y2hlc1swXS5zY3JlZW5ZIDogZS5zY3JlZW5ZKSAtIHRoaXMuc3RhcnRZKSk7XG5cdH1cblxuXHRjYWxjR3VpZGVQb3NpdGlvbihlLCByb3csIGhhbmRsZSkge1xuXHRcdHZhciBtb3VzZVkgPSB0eXBlb2YgZS5zY3JlZW5ZID09PSBcInVuZGVmaW5lZFwiID8gZS50b3VjaGVzWzBdLnNjcmVlblkgOiBlLnNjcmVlblksXG5cdFx0aGFuZGxlWSA9IGhhbmRsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS55IC0gdGhpcy50YWJsZS5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnksXG5cdFx0dGFibGVZID0gdGhpcy50YWJsZS5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnksXG5cdFx0cm93WSA9IHJvdy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCAtIHRhYmxlWSxcblx0XHRtb3VzZURpZmYgPSBtb3VzZVkgLSB0aGlzLnN0YXJ0WTtcblxuXHRcdHJldHVybiBNYXRoLm1heChoYW5kbGVZICsgbW91c2VEaWZmLCByb3dZKTtcblx0fVxuXG5cdF9tb3VzZURvd24oZSwgcm93LCBoYW5kbGUpe1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRndWlkZUVsO1xuXG5cdFx0c2VsZi5kaXNwYXRjaEV4dGVybmFsKFwicm93UmVzaXppbmdcIiwgcm93LmdldENvbXBvbmVudCgpKTtcblxuXHRcdGlmKHNlbGYudGFibGUub3B0aW9ucy5yZXNpemFibGVSb3dHdWlkZSl7XG5cdFx0XHRndWlkZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0XHRndWlkZUVsLmNsYXNzTGlzdC5hZGQoJ3RhYnVsYXRvci1yb3ctcmVzaXplLWd1aWRlJyk7XG5cdFx0XHRzZWxmLnRhYmxlLmVsZW1lbnQuYXBwZW5kQ2hpbGQoZ3VpZGVFbCk7XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0Z3VpZGVFbC5zdHlsZS50b3AgPSBzZWxmLmNhbGNHdWlkZVBvc2l0aW9uKGUsIHJvdywgaGFuZGxlKSArIFwicHhcIjtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHNlbGYudGFibGUuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblxuXHRcdGZ1bmN0aW9uIG1vdXNlTW92ZShlKXtcblx0XHRcdGlmKHNlbGYudGFibGUub3B0aW9ucy5yZXNpemFibGVSb3dHdWlkZSl7XG5cdFx0XHRcdGd1aWRlRWwuc3R5bGUudG9wID0gc2VsZi5jYWxjR3VpZGVQb3NpdGlvbihlLCByb3csIGhhbmRsZSkgKyBcInB4XCI7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHNlbGYucmVzaXplKGUsIHJvdyk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gbW91c2VVcChlKXtcblx0XHRcdGlmKHNlbGYudGFibGUub3B0aW9ucy5yZXNpemFibGVSb3dHdWlkZSl7XG5cdFx0XHRcdHNlbGYucmVzaXplKGUsIHJvdyk7XG5cdFx0XHRcdGd1aWRlRWwucmVtb3ZlKCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIC8vYmxvY2sgZWRpdG9yIGZyb20gdGFraW5nIGFjdGlvbiB3aGlsZSByZXNpemluZyBpcyB0YWtpbmcgcGxhY2Vcblx0XHRcdC8vIGlmKHNlbGYuc3RhcnRDb2x1bW4ubW9kdWxlcy5lZGl0KXtcblx0XHRcdC8vIFx0c2VsZi5zdGFydENvbHVtbi5tb2R1bGVzLmVkaXQuYmxvY2tlZCA9IGZhbHNlO1xuXHRcdFx0Ly8gfVxuXG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG1vdXNlTW92ZSk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgbW91c2VNb3ZlKTtcblxuXHRcdFx0aGFuZGxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgbW91c2VNb3ZlKTtcblx0XHRcdGhhbmRsZS5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgbW91c2VVcCk7XG5cblx0XHRcdHNlbGYudGFibGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblxuXHRcdFx0c2VsZi5kaXNwYXRjaEV4dGVybmFsKFwicm93UmVzaXplZFwiLCByb3cuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH1cblxuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7IC8vcHJldmVudCByZXNpemUgZnJvbSBpbnRlcmZlcmluZyB3aXRoIG1vdmFibGUgY29sdW1uc1xuXG5cdFx0Ly9ibG9jayBlZGl0b3IgZnJvbSB0YWtpbmcgYWN0aW9uIHdoaWxlIHJlc2l6aW5nIGlzIHRha2luZyBwbGFjZVxuXHRcdC8vIGlmKHNlbGYuc3RhcnRDb2x1bW4ubW9kdWxlcy5lZGl0KXtcblx0XHQvLyBcdHNlbGYuc3RhcnRDb2x1bW4ubW9kdWxlcy5lZGl0LmJsb2NrZWQgPSB0cnVlO1xuXHRcdC8vIH1cblxuXHRcdHNlbGYuc3RhcnRZID0gdHlwZW9mIGUuc2NyZWVuWSA9PT0gXCJ1bmRlZmluZWRcIiA/IGUudG91Y2hlc1swXS5zY3JlZW5ZIDogZS5zY3JlZW5ZO1xuXHRcdHNlbGYuc3RhcnRIZWlnaHQgPSByb3cuZ2V0SGVpZ2h0KCk7XG5cblx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgbW91c2VNb3ZlKTtcblx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG1vdXNlVXApO1xuXG5cdFx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgbW91c2VNb3ZlLCB7cGFzc2l2ZTogdHJ1ZX0pO1xuXHRcdGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgbW91c2VVcCk7XG5cdH1cbn1cblxuY2xhc3MgUmVzaXplVGFibGUgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcInJlc2l6ZVRhYmxlXCI7XG5cdFxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMuYmluZGluZyA9IGZhbHNlO1xuXHRcdHRoaXMudmlzaWJpbGl0eU9ic2VydmVyID0gZmFsc2U7XG5cdFx0dGhpcy5yZXNpemVPYnNlcnZlciA9IGZhbHNlO1xuXHRcdHRoaXMuY29udGFpbmVyT2JzZXJ2ZXIgPSBmYWxzZTtcblx0XHRcblx0XHR0aGlzLnRhYmxlSGVpZ2h0ID0gMDtcblx0XHR0aGlzLnRhYmxlV2lkdGggPSAwO1xuXHRcdHRoaXMuY29udGFpbmVySGVpZ2h0ID0gMDtcblx0XHR0aGlzLmNvbnRhaW5lcldpZHRoID0gMDtcblx0XHRcblx0XHR0aGlzLmF1dG9SZXNpemUgPSBmYWxzZTtcblx0XHRcblx0XHR0aGlzLnZpc2libGUgPSBmYWxzZTtcblx0XHRcblx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0dGhpcy5pbml0aWFsUmVkcmF3ID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiYXV0b1Jlc2l6ZVwiLCB0cnVlKTsgLy9hdXRvIHJlc2l6ZSB0YWJsZVxuXHR9XG5cdFxuXHRpbml0aWFsaXplKCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmF1dG9SZXNpemUpe1xuXHRcdFx0dmFyIHRhYmxlID0gdGhpcy50YWJsZSxcblx0XHRcdHRhYmxlU3R5bGU7XG5cdFx0XHRcblx0XHRcdHRoaXMudGFibGVIZWlnaHQgPSB0YWJsZS5lbGVtZW50LmNsaWVudEhlaWdodDtcblx0XHRcdHRoaXMudGFibGVXaWR0aCA9IHRhYmxlLmVsZW1lbnQuY2xpZW50V2lkdGg7XG5cdFx0XHRcblx0XHRcdGlmKHRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZSl7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVySGVpZ2h0ID0gdGFibGUuZWxlbWVudC5wYXJlbnROb2RlLmNsaWVudEhlaWdodDtcblx0XHRcdFx0dGhpcy5jb250YWluZXJXaWR0aCA9IHRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZS5jbGllbnRXaWR0aDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYodHlwZW9mIEludGVyc2VjdGlvbk9ic2VydmVyICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBSZXNpemVPYnNlcnZlciAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0YWJsZS5yb3dNYW5hZ2VyLmdldFJlbmRlck1vZGUoKSA9PT0gXCJ2aXJ0dWFsXCIpe1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5pbml0aWFsaXplVmlzaWJpbGl0eU9ic2VydmVyKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmF1dG9SZXNpemUgPSB0cnVlO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5yZXNpemVPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcigoZW50cnkpID0+IHtcblx0XHRcdFx0XHRpZighdGFibGUuYnJvd3Nlck1vYmlsZSB8fCAodGFibGUuYnJvd3Nlck1vYmlsZSAmJiAoIXRhYmxlLm1vZHVsZXMuZWRpdCB8fCAodGFibGUubW9kdWxlcy5lZGl0ICYmICF0YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGwpKSkpe1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHR2YXIgbm9kZUhlaWdodCA9IE1hdGguZmxvb3IoZW50cnlbMF0uY29udGVudFJlY3QuaGVpZ2h0KTtcblx0XHRcdFx0XHRcdHZhciBub2RlV2lkdGggPSBNYXRoLmZsb29yKGVudHJ5WzBdLmNvbnRlbnRSZWN0LndpZHRoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYodGhpcy50YWJsZUhlaWdodCAhPSBub2RlSGVpZ2h0IHx8IHRoaXMudGFibGVXaWR0aCAhPSBub2RlV2lkdGgpe1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRhYmxlSGVpZ2h0ID0gbm9kZUhlaWdodDtcblx0XHRcdFx0XHRcdFx0dGhpcy50YWJsZVdpZHRoID0gbm9kZVdpZHRoO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0aWYodGFibGUuZWxlbWVudC5wYXJlbnROb2RlKXtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lckhlaWdodCA9IHRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZS5jbGllbnRIZWlnaHQ7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5jb250YWluZXJXaWR0aCA9IHRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZS5jbGllbnRXaWR0aDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0dGhpcy5yZWRyYXdUYWJsZSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnJlc2l6ZU9ic2VydmVyLm9ic2VydmUodGFibGUuZWxlbWVudCk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0YWJsZVN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGFibGUuZWxlbWVudCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLnRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZSAmJiAhdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpeGVkSGVpZ2h0ICYmICh0YWJsZVN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJtYXgtaGVpZ2h0XCIpIHx8IHRhYmxlU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcIm1pbi1oZWlnaHRcIikpKXtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lck9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKChlbnRyeSkgPT4ge1xuXHRcdFx0XHRcdFx0aWYoIXRhYmxlLmJyb3dzZXJNb2JpbGUgfHwgKHRhYmxlLmJyb3dzZXJNb2JpbGUgJiYgKCF0YWJsZS5tb2R1bGVzLmVkaXQgfHwgKHRhYmxlLm1vZHVsZXMuZWRpdCAmJiAhdGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsKSkpKXtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdHZhciBub2RlSGVpZ2h0ID0gTWF0aC5mbG9vcihlbnRyeVswXS5jb250ZW50UmVjdC5oZWlnaHQpO1xuXHRcdFx0XHRcdFx0XHR2YXIgbm9kZVdpZHRoID0gTWF0aC5mbG9vcihlbnRyeVswXS5jb250ZW50UmVjdC53aWR0aCk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRpZih0aGlzLmNvbnRhaW5lckhlaWdodCAhPSBub2RlSGVpZ2h0IHx8IHRoaXMuY29udGFpbmVyV2lkdGggIT0gbm9kZVdpZHRoKXtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lckhlaWdodCA9IG5vZGVIZWlnaHQ7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5jb250YWluZXJXaWR0aCA9IG5vZGVXaWR0aDtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnRhYmxlSGVpZ2h0ID0gdGFibGUuZWxlbWVudC5jbGllbnRIZWlnaHQ7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy50YWJsZVdpZHRoID0gdGFibGUuZWxlbWVudC5jbGllbnRXaWR0aDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0dGhpcy5yZWRyYXdUYWJsZSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMuY29udGFpbmVyT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLnRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlKFwidGFibGUtcmVzaXplXCIsIHRoaXMudGFibGVSZXNpemVkLmJpbmQodGhpcykpO1xuXHRcdFx0XHRcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5iaW5kaW5nID0gZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRpZighdGFibGUuYnJvd3Nlck1vYmlsZSB8fCAodGFibGUuYnJvd3Nlck1vYmlsZSAmJiAoIXRhYmxlLm1vZHVsZXMuZWRpdCB8fCAodGFibGUubW9kdWxlcy5lZGl0ICYmICF0YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGwpKSkpe1xuXHRcdFx0XHRcdFx0dGFibGUuY29sdW1uTWFuYWdlci5yZXJlbmRlckNvbHVtbnModHJ1ZSk7XG5cdFx0XHRcdFx0XHR0YWJsZS5yZWRyYXcoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHRcdFxuXHRcdFx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLmJpbmRpbmcpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLWRlc3Ryb3lcIiwgdGhpcy5jbGVhckJpbmRpbmdzLmJpbmQodGhpcykpO1xuXHRcdH1cblx0fVxuXHRcblx0aW5pdGlhbGl6ZVZpc2liaWxpdHlPYnNlcnZlcigpe1xuXHRcdHRoaXMudmlzaWJpbGl0eU9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzKSA9PiB7XG5cdFx0XHR0aGlzLnZpc2libGUgPSBlbnRyaWVzWzBdLmlzSW50ZXJzZWN0aW5nO1xuXHRcdFx0XG5cdFx0XHRpZighdGhpcy5pbml0aWFsaXplZCl7XG5cdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxSZWRyYXcgPSAhdGhpcy52aXNpYmxlO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRpZih0aGlzLnZpc2libGUpe1xuXHRcdFx0XHRcdHRoaXMucmVkcmF3VGFibGUodGhpcy5pbml0aWFsUmVkcmF3KTtcblx0XHRcdFx0XHR0aGlzLmluaXRpYWxSZWRyYXcgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMudmlzaWJpbGl0eU9ic2VydmVyLm9ic2VydmUodGhpcy50YWJsZS5lbGVtZW50KTtcblx0fVxuXHRcblx0cmVkcmF3VGFibGUoZm9yY2Upe1xuXHRcdGlmKHRoaXMuaW5pdGlhbGl6ZWQgJiYgdGhpcy52aXNpYmxlKXtcblx0XHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5yZXJlbmRlckNvbHVtbnModHJ1ZSk7XG5cdFx0XHR0aGlzLnRhYmxlLnJlZHJhdyhmb3JjZSk7XG5cdFx0fVxuXHR9XG5cdFxuXHR0YWJsZVJlc2l6ZWQoKXtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVkcmF3KCk7XG5cdH1cblx0XG5cdGNsZWFyQmluZGluZ3MoKXtcblx0XHRpZih0aGlzLmJpbmRpbmcpe1xuXHRcdFx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5iaW5kaW5nKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy5yZXNpemVPYnNlcnZlcil7XG5cdFx0XHR0aGlzLnJlc2l6ZU9ic2VydmVyLnVub2JzZXJ2ZSh0aGlzLnRhYmxlLmVsZW1lbnQpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLnZpc2liaWxpdHlPYnNlcnZlcil7XG5cdFx0XHR0aGlzLnZpc2liaWxpdHlPYnNlcnZlci51bm9ic2VydmUodGhpcy50YWJsZS5lbGVtZW50KTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy5jb250YWluZXJPYnNlcnZlcil7XG5cdFx0XHR0aGlzLmNvbnRhaW5lck9ic2VydmVyLnVub2JzZXJ2ZSh0aGlzLnRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZSk7XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIHJlc3BvbnNpdmVDb2xsYXBzZShjZWxsLCBmb3JtYXR0ZXJQYXJhbXMsIG9uUmVuZGVyZWQpe1xuXHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuXHRjb25maWcgPSBjZWxsLmdldFJvdygpLl9yb3cubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0O1xuXG5cdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcmVzcG9uc2l2ZS1jb2xsYXBzZS10b2dnbGVcIik7XG5cdFxuXHRlbC5pbm5lckhUTUwgPSBgPHN2ZyBjbGFzcz0ndGFidWxhdG9yLXJlc3BvbnNpdmUtY29sbGFwc2UtdG9nZ2xlLW9wZW4nIHZpZXdib3g9XCIwIDAgMjQgMjRcIj5cbiAgPGxpbmUgeDE9XCI3XCIgeTE9XCIxMlwiIHgyPVwiMTdcIiB5Mj1cIjEyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIC8+XG4gIDxsaW5lIHkxPVwiN1wiIHgxPVwiMTJcIiB5Mj1cIjE3XCIgeDI9XCIxMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiAvPlxuPC9zdmc+XG5cbjxzdmcgY2xhc3M9J3RhYnVsYXRvci1yZXNwb25zaXZlLWNvbGxhcHNlLXRvZ2dsZS1jbG9zZScgdmlld2JveD1cIjAgMCAyNCAyNFwiPlxuICA8bGluZSB4MT1cIjdcIiB5MT1cIjEyXCIgeDI9XCIxN1wiIHkyPVwiMTJcIiAgZmlsbD1cIm5vbmVcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIC8+XG48L3N2Zz5gO1xuXG5cdGNlbGwuZ2V0RWxlbWVudCgpLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itcm93LWhhbmRsZVwiKTtcblxuXHRmdW5jdGlvbiB0b2dnbGVMaXN0KGlzT3Blbil7XG5cdFx0dmFyIGNvbGxhcHNlRWwgPSBjb25maWcuZWxlbWVudDtcblxuXHRcdGNvbmZpZy5vcGVuID0gaXNPcGVuO1xuXG5cdFx0aWYoY29sbGFwc2VFbCl7XG5cblx0XHRcdGlmKGNvbmZpZy5vcGVuKXtcblx0XHRcdFx0ZWwuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG5cdFx0XHRcdGNvbGxhcHNlRWwuc3R5bGUuZGlzcGxheSA9ICcnO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRlbC5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcblx0XHRcdFx0Y29sbGFwc2VFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKXtcblx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdHRvZ2dsZUxpc3QoIWNvbmZpZy5vcGVuKTtcblx0XHRjZWxsLmdldFRhYmxlKCkucm93TWFuYWdlci5hZGp1c3RUYWJsZVNpemUoKTtcblx0fSk7XG5cblx0dG9nZ2xlTGlzdChjb25maWcub3Blbik7XG5cblx0cmV0dXJuIGVsO1xufVxuXG52YXIgZXh0ZW5zaW9ucyQyID0ge1xyXG5cdGZvcm1hdDp7XHJcblx0XHRmb3JtYXR0ZXJzOntcclxuXHRcdFx0cmVzcG9uc2l2ZUNvbGxhcHNlOnJlc3BvbnNpdmVDb2xsYXBzZSxcclxuXHRcdH1cclxuXHR9XHJcbn07XG5cbmNsYXNzIFJlc3BvbnNpdmVMYXlvdXQgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcInJlc3BvbnNpdmVMYXlvdXRcIjtcblx0c3RhdGljIG1vZHVsZUV4dGVuc2lvbnMgPSBleHRlbnNpb25zJDI7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMuY29sdW1ucyA9IFtdO1xuXHRcdHRoaXMuaGlkZGVuQ29sdW1ucyA9IFtdO1xuXHRcdHRoaXMubW9kZSA9IFwiXCI7XG5cdFx0dGhpcy5pbmRleCA9IDA7XG5cdFx0dGhpcy5jb2xsYXBzZUZvcm1hdHRlciA9IFtdO1xuXHRcdHRoaXMuY29sbGFwc2VTdGFydE9wZW4gPSB0cnVlO1xuXHRcdHRoaXMuY29sbGFwc2VIYW5kbGVDb2x1bW4gPSBmYWxzZTtcblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInJlc3BvbnNpdmVMYXlvdXRcIiwgZmFsc2UpOyAvL3Jlc3BvbnNpdmUgbGF5b3V0IGZsYWdzXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwicmVzcG9uc2l2ZUxheW91dENvbGxhcHNlU3RhcnRPcGVuXCIsIHRydWUpOyAvL3N0YXJ0IHNob3dpbmcgY29sbGFwc2VkIGRhdGFcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJyZXNwb25zaXZlTGF5b3V0Q29sbGFwc2VVc2VGb3JtYXR0ZXJzXCIsIHRydWUpOyAvL3Jlc3BvbnNpdmUgbGF5b3V0IGNvbGxhcHNlIGZvcm1hdHRlclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInJlc3BvbnNpdmVMYXlvdXRDb2xsYXBzZUZvcm1hdHRlclwiLCBmYWxzZSk7IC8vcmVzcG9uc2l2ZSBsYXlvdXQgY29sbGFwc2UgZm9ybWF0dGVyXG5cblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwicmVzcG9uc2l2ZVwiKTtcblx0fVxuXG5cdC8vZ2VuZXJhdGUgcmVzcG9uc2l2ZSBjb2x1bW5zIGxpc3Rcblx0aW5pdGlhbGl6ZSgpe1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0KXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWxheW91dFwiLCB0aGlzLmluaXRpYWxpemVDb2x1bW4uYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1zaG93XCIsIHRoaXMudXBkYXRlQ29sdW1uVmlzaWJpbGl0eS5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWhpZGVcIiwgdGhpcy51cGRhdGVDb2x1bW5WaXNpYmlsaXR5LmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW5zLWxvYWRlZFwiLCB0aGlzLmluaXRpYWxpemVSZXNwb25zaXZpdHkuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1tb3ZlZFwiLCB0aGlzLmluaXRpYWxpemVSZXNwb25zaXZpdHkuYmluZCh0aGlzKSk7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1hZGRcIiwgdGhpcy5pbml0aWFsaXplUmVzcG9uc2l2aXR5LmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tZGVsZXRlXCIsIHRoaXMuaW5pdGlhbGl6ZVJlc3BvbnNpdml0eS5iaW5kKHRoaXMpKTtcblxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1yZWRyYXdpbmdcIiwgdGhpcy50YWJsZVJlZHJhdy5iaW5kKHRoaXMpKTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgPT09IFwiY29sbGFwc2VcIil7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWRhdGEtY2hhbmdlZFwiLCB0aGlzLmdlbmVyYXRlQ29sbGFwc2VkUm93Q29udGVudC5iaW5kKHRoaXMpKTtcblx0XHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3ctaW5pdFwiLCB0aGlzLmluaXRpYWxpemVSb3cuYmluZCh0aGlzKSk7XG5cdFx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWxheW91dFwiLCB0aGlzLmxheW91dFJvdy5iaW5kKHRoaXMpKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHR0YWJsZVJlZHJhdyhmb3JjZSl7XG5cdFx0aWYoW1wiZml0Q29sdW1uc1wiLCBcImZpdERhdGFTdHJldGNoXCJdLmluZGV4T2YodGhpcy5sYXlvdXRNb2RlKCkpID09PSAtMSl7XG5cdFx0XHRpZighZm9yY2Upe1xuXHRcdFx0XHR0aGlzLnVwZGF0ZSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGluaXRpYWxpemVSZXNwb25zaXZpdHkoKXtcblx0XHR2YXIgY29sdW1ucyA9IFtdO1xuXG5cdFx0dGhpcy5tb2RlID0gdGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQ7XG5cdFx0dGhpcy5jb2xsYXBzZUZvcm1hdHRlciA9IHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0Q29sbGFwc2VGb3JtYXR0ZXIgfHwgdGhpcy5mb3JtYXRDb2xsYXBzZWREYXRhO1xuXHRcdHRoaXMuY29sbGFwc2VTdGFydE9wZW4gPSB0aGlzLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dENvbGxhcHNlU3RhcnRPcGVuO1xuXHRcdHRoaXMuaGlkZGVuQ29sdW1ucyA9IFtdO1xuXG5cdFx0aWYodGhpcy5jb2xsYXBzZUZvcm1hdHRlcil7XG5cdFx0XHR0aGlzLmNvbGxhcHNlRm9ybWF0dGVyID0gdGhpcy5jb2xsYXBzZUZvcm1hdHRlci5iaW5kKHRoaXMudGFibGUpO1xuXHRcdH1cblxuXHRcdC8vZGV0ZXJtaW5lIGxldmVsIG9mIHJlc3BvbnNpdml0eSBmb3IgZWFjaCBjb2x1bW5cblx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXguZm9yRWFjaCgoY29sdW1uLCBpKSA9PiB7XG5cdFx0XHRpZihjb2x1bW4ubW9kdWxlcy5yZXNwb25zaXZlKXtcblx0XHRcdFx0aWYoY29sdW1uLm1vZHVsZXMucmVzcG9uc2l2ZS5vcmRlciAmJiBjb2x1bW4ubW9kdWxlcy5yZXNwb25zaXZlLnZpc2libGUpe1xuXHRcdFx0XHRcdGNvbHVtbi5tb2R1bGVzLnJlc3BvbnNpdmUuaW5kZXggPSBpO1xuXHRcdFx0XHRcdGNvbHVtbnMucHVzaChjb2x1bW4pO1xuXG5cdFx0XHRcdFx0aWYoIWNvbHVtbi52aXNpYmxlICYmIHRoaXMubW9kZSA9PT0gXCJjb2xsYXBzZVwiKXtcblx0XHRcdFx0XHRcdHRoaXMuaGlkZGVuQ29sdW1ucy5wdXNoKGNvbHVtbik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvL3NvcnQgbGlzdCBieSByZXNwb25zaXZpdHlcblx0XHRjb2x1bW5zID0gY29sdW1ucy5yZXZlcnNlKCk7XG5cdFx0Y29sdW1ucyA9IGNvbHVtbnMuc29ydCgoYSwgYikgPT4ge1xuXHRcdFx0dmFyIGRpZmYgPSBiLm1vZHVsZXMucmVzcG9uc2l2ZS5vcmRlciAtIGEubW9kdWxlcy5yZXNwb25zaXZlLm9yZGVyO1xuXHRcdFx0cmV0dXJuIGRpZmYgfHwgKGIubW9kdWxlcy5yZXNwb25zaXZlLmluZGV4IC0gYS5tb2R1bGVzLnJlc3BvbnNpdmUuaW5kZXgpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5jb2x1bW5zID0gY29sdW1ucztcblxuXHRcdGlmKHRoaXMubW9kZSA9PT0gXCJjb2xsYXBzZVwiKXtcblx0XHRcdHRoaXMuZ2VuZXJhdGVDb2xsYXBzZWRDb250ZW50KCk7XG5cdFx0fVxuXG5cdFx0Ly9hc3NpZ24gY29sbGFwc2UgY29sdW1uXG5cdFx0Zm9yIChsZXQgY29sIG9mIHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5jb2x1bW5zQnlJbmRleCl7XG5cdFx0XHRpZihjb2wuZGVmaW5pdGlvbi5mb3JtYXR0ZXIgPT0gXCJyZXNwb25zaXZlQ29sbGFwc2VcIil7XG5cdFx0XHRcdHRoaXMuY29sbGFwc2VIYW5kbGVDb2x1bW4gPSBjb2w7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmKHRoaXMuY29sbGFwc2VIYW5kbGVDb2x1bW4pe1xuXHRcdFx0aWYodGhpcy5oaWRkZW5Db2x1bW5zLmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMuY29sbGFwc2VIYW5kbGVDb2x1bW4uc2hvdygpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmNvbGxhcHNlSGFuZGxlQ29sdW1uLmhpZGUoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvL2RlZmluZSBsYXlvdXQgaW5mb3JtYXRpb25cblx0aW5pdGlhbGl6ZUNvbHVtbihjb2x1bW4pe1xuXHRcdHZhciBkZWYgPSBjb2x1bW4uZ2V0RGVmaW5pdGlvbigpO1xuXG5cdFx0Y29sdW1uLm1vZHVsZXMucmVzcG9uc2l2ZSA9IHtvcmRlcjogdHlwZW9mIGRlZi5yZXNwb25zaXZlID09PSBcInVuZGVmaW5lZFwiID8gMSA6IGRlZi5yZXNwb25zaXZlLCB2aXNpYmxlOmRlZi52aXNpYmxlID09PSBmYWxzZSA/IGZhbHNlIDogdHJ1ZX07XG5cdH1cblxuXHRpbml0aWFsaXplUm93KHJvdyl7XG5cdFx0dmFyIGVsO1xuXG5cdFx0aWYocm93LnR5cGUgIT09IFwiY2FsY1wiKXtcblx0XHRcdGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcmVzcG9uc2l2ZS1jb2xsYXBzZVwiKTtcblxuXHRcdFx0cm93Lm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dCA9IHtcblx0XHRcdFx0ZWxlbWVudDplbCxcblx0XHRcdFx0b3Blbjp0aGlzLmNvbGxhcHNlU3RhcnRPcGVuLFxuXHRcdFx0fTtcblxuXHRcdFx0aWYoIXRoaXMuY29sbGFwc2VTdGFydE9wZW4pe1xuXHRcdFx0XHRlbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGxheW91dFJvdyhyb3cpe1xuXHRcdHZhciByb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cblx0XHRpZihyb3cubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0KXtcblx0XHRcdHJvd0VsLmFwcGVuZENoaWxkKHJvdy5tb2R1bGVzLnJlc3BvbnNpdmVMYXlvdXQuZWxlbWVudCk7XG5cdFx0XHR0aGlzLmdlbmVyYXRlQ29sbGFwc2VkUm93Q29udGVudChyb3cpO1xuXHRcdH1cblx0fVxuXG5cdC8vdXBkYXRlIGNvbHVtbiB2aXNpYmlsaXR5XG5cdHVwZGF0ZUNvbHVtblZpc2liaWxpdHkoY29sdW1uLCByZXNwb25zaXZlVG9nZ2xlKXtcblx0XHRpZighcmVzcG9uc2l2ZVRvZ2dsZSAmJiBjb2x1bW4ubW9kdWxlcy5yZXNwb25zaXZlKXtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLnJlc3BvbnNpdmUudmlzaWJsZSA9IGNvbHVtbi52aXNpYmxlO1xuXHRcdFx0dGhpcy5pbml0aWFsaXplUmVzcG9uc2l2aXR5KCk7XG5cdFx0fVxuXHR9XG5cblx0aGlkZUNvbHVtbihjb2x1bW4pe1xuXHRcdHZhciBjb2xDb3VudCA9IHRoaXMuaGlkZGVuQ29sdW1ucy5sZW5ndGg7XG5cblx0XHRjb2x1bW4uaGlkZShmYWxzZSwgdHJ1ZSk7XG5cblx0XHRpZih0aGlzLm1vZGUgPT09IFwiY29sbGFwc2VcIil7XG5cdFx0XHR0aGlzLmhpZGRlbkNvbHVtbnMudW5zaGlmdChjb2x1bW4pO1xuXHRcdFx0dGhpcy5nZW5lcmF0ZUNvbGxhcHNlZENvbnRlbnQoKTtcblxuXHRcdFx0aWYodGhpcy5jb2xsYXBzZUhhbmRsZUNvbHVtbiAmJiAhY29sQ291bnQpe1xuXHRcdFx0XHR0aGlzLmNvbGxhcHNlSGFuZGxlQ29sdW1uLnNob3coKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRzaG93Q29sdW1uKGNvbHVtbil7XG5cdFx0dmFyIGluZGV4O1xuXG5cdFx0Y29sdW1uLnNob3coZmFsc2UsIHRydWUpO1xuXHRcdC8vc2V0IGNvbHVtbiB3aWR0aCB0byBwcmV2ZW50IGNhbGN1bGF0aW9uIGxvb3BzIG9uIHVuaW5pdGlhbGl6ZWQgY29sdW1uc1xuXHRcdGNvbHVtbi5zZXRXaWR0aChjb2x1bW4uZ2V0V2lkdGgoKSk7XG5cblx0XHRpZih0aGlzLm1vZGUgPT09IFwiY29sbGFwc2VcIil7XG5cdFx0XHRpbmRleCA9IHRoaXMuaGlkZGVuQ29sdW1ucy5pbmRleE9mKGNvbHVtbik7XG5cblx0XHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0XHR0aGlzLmhpZGRlbkNvbHVtbnMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5nZW5lcmF0ZUNvbGxhcHNlZENvbnRlbnQoKTtcblxuXHRcdFx0aWYodGhpcy5jb2xsYXBzZUhhbmRsZUNvbHVtbiAmJiAhdGhpcy5oaWRkZW5Db2x1bW5zLmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMuY29sbGFwc2VIYW5kbGVDb2x1bW4uaGlkZSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vcmVkcmF3IGNvbHVtbnMgdG8gZml0IHNwYWNlXG5cdHVwZGF0ZSgpe1xuXHRcdHZhciB3b3JraW5nID0gdHJ1ZTtcblxuXHRcdHdoaWxlKHdvcmtpbmcpe1xuXG5cdFx0XHRsZXQgd2lkdGggPSB0aGlzLnRhYmxlLm1vZHVsZXMubGF5b3V0LmdldE1vZGUoKSA9PSBcImZpdENvbHVtbnNcIiA/IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRGbGV4QmFzZVdpZHRoKCkgOiB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0V2lkdGgoKTtcblxuXHRcdFx0bGV0IGRpZmYgPSAodGhpcy50YWJsZS5vcHRpb25zLmhlYWRlclZpc2libGUgPyB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZWxlbWVudC5jbGllbnRXaWR0aCA6IHRoaXMudGFibGUuZWxlbWVudC5jbGllbnRXaWR0aCkgLSB3aWR0aDtcblxuXHRcdFx0aWYoZGlmZiA8IDApe1xuXHRcdFx0XHQvL3RhYmxlIGlzIHRvbyB3aWRlXG5cdFx0XHRcdGxldCBjb2x1bW4gPSB0aGlzLmNvbHVtbnNbdGhpcy5pbmRleF07XG5cblx0XHRcdFx0aWYoY29sdW1uKXtcblx0XHRcdFx0XHR0aGlzLmhpZGVDb2x1bW4oY29sdW1uKTtcblx0XHRcdFx0XHR0aGlzLmluZGV4ICsrO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0d29ya2luZyA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdH1lbHNlIHtcblxuXHRcdFx0XHQvL3RhYmxlIGhhcyBzcGFyZSBzcGFjZVxuXHRcdFx0XHRsZXQgY29sdW1uID0gdGhpcy5jb2x1bW5zW3RoaXMuaW5kZXggLTFdO1xuXG5cdFx0XHRcdGlmKGNvbHVtbil7XG5cdFx0XHRcdFx0aWYoZGlmZiA+IDApe1xuXHRcdFx0XHRcdFx0aWYoZGlmZiA+PSBjb2x1bW4uZ2V0V2lkdGgoKSl7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0NvbHVtbihjb2x1bW4pO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmluZGV4IC0tO1xuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHR3b3JraW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0d29ya2luZyA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZighdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFjdGl2ZVJvd3NDb3VudCl7XG5cdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZW5kZXJFbXB0eVNjcm9sbCgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGdlbmVyYXRlQ29sbGFwc2VkQ29udGVudCgpe1xuXHRcdHZhciByb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKCk7XG5cblx0XHRyb3dzLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0dGhpcy5nZW5lcmF0ZUNvbGxhcHNlZFJvd0NvbnRlbnQocm93KTtcblx0XHR9KTtcblx0fVxuXG5cdGdlbmVyYXRlQ29sbGFwc2VkUm93Q29udGVudChyb3cpe1xuXHRcdHZhciBlbCwgY29udGVudHM7XG5cblx0XHRpZihyb3cubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0KXtcblx0XHRcdGVsID0gcm93Lm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC5lbGVtZW50O1xuXG5cdFx0XHR3aGlsZShlbC5maXJzdENoaWxkKSBlbC5yZW1vdmVDaGlsZChlbC5maXJzdENoaWxkKTtcblxuXHRcdFx0Y29udGVudHMgPSB0aGlzLmNvbGxhcHNlRm9ybWF0dGVyKHRoaXMuZ2VuZXJhdGVDb2xsYXBzZWRSb3dEYXRhKHJvdykpO1xuXHRcdFx0aWYoY29udGVudHMpe1xuXHRcdFx0XHRlbC5hcHBlbmRDaGlsZChjb250ZW50cyk7XG5cdFx0XHR9XG5cdFx0XHRyb3cuY2FsY0hlaWdodCh0cnVlKTtcblx0XHR9XG5cdH1cblxuXHRnZW5lcmF0ZUNvbGxhcHNlZFJvd0RhdGEocm93KXtcblx0XHR2YXIgZGF0YSA9IHJvdy5nZXREYXRhKCksXG5cdFx0b3V0cHV0ID0gW10sXG5cdFx0bW9ja0NlbGxDb21wb25lbnQ7XG5cblx0XHR0aGlzLmhpZGRlbkNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHR2YXIgdmFsdWUgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShkYXRhKTtcblxuXHRcdFx0aWYoY29sdW1uLmRlZmluaXRpb24udGl0bGUgJiYgY29sdW1uLmZpZWxkKXtcblx0XHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuZm9ybWF0ICYmIHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0Q29sbGFwc2VVc2VGb3JtYXR0ZXJzKXtcblxuXHRcdFx0XHRcdG1vY2tDZWxsQ29tcG9uZW50ID0ge1xuXHRcdFx0XHRcdFx0dmFsdWU6ZmFsc2UsXG5cdFx0XHRcdFx0XHRkYXRhOnt9LFxuXHRcdFx0XHRcdFx0Z2V0VmFsdWU6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdGdldERhdGE6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0Z2V0VHlwZTpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gXCJjZWxsXCI7XG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0Z2V0RWxlbWVudDpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRnZXRSb3c6ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHJvdy5nZXRDb21wb25lbnQoKTtcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRnZXRDb2x1bW46ZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRDb21wb25lbnQoKTtcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRnZXRUYWJsZTooKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0aGlzLnRhYmxlO1xuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gb25SZW5kZXJlZChjYWxsYmFjayl7XG5cdFx0XHRcdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG91dHB1dC5wdXNoKHtcblx0XHRcdFx0XHRcdGZpZWxkOiBjb2x1bW4uZmllbGQsXG5cdFx0XHRcdFx0XHR0aXRsZTogY29sdW1uLmRlZmluaXRpb24udGl0bGUsXG5cdFx0XHRcdFx0XHR2YWx1ZTogY29sdW1uLm1vZHVsZXMuZm9ybWF0LmZvcm1hdHRlci5jYWxsKHRoaXMudGFibGUubW9kdWxlcy5mb3JtYXQsIG1vY2tDZWxsQ29tcG9uZW50LCBjb2x1bW4ubW9kdWxlcy5mb3JtYXQucGFyYW1zLCBvblJlbmRlcmVkKVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0b3V0cHV0LnB1c2goe1xuXHRcdFx0XHRcdFx0ZmllbGQ6IGNvbHVtbi5maWVsZCxcblx0XHRcdFx0XHRcdHRpdGxlOiBjb2x1bW4uZGVmaW5pdGlvbi50aXRsZSxcblx0XHRcdFx0XHRcdHZhbHVlOiB2YWx1ZVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cblx0Zm9ybWF0Q29sbGFwc2VkRGF0YShkYXRhKXtcblx0XHR2YXIgbGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0YWJsZVwiKTtcblxuXHRcdGRhdGEuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXHRcdFx0dmFyIHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0clwiKTtcblx0XHRcdHZhciB0aXRsZURhdGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIik7XG5cdFx0XHR2YXIgdmFsdWVEYXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xuXHRcdFx0dmFyIG5vZGVfY29udGVudDtcblxuXHRcdFx0dmFyIHRpdGxlSGlnaGxpZ2h0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0cm9uZ1wiKTtcblx0XHRcdHRpdGxlRGF0YS5hcHBlbmRDaGlsZCh0aXRsZUhpZ2hsaWdodCk7XG5cdFx0XHRcblx0XHRcdHRoaXMubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKFwiY29sdW1uc3xcIiArIGl0ZW0uZmllbGQsIGZ1bmN0aW9uKHRleHQpe1xuXHRcdFx0XHR0aXRsZUhpZ2hsaWdodC5pbm5lckhUTUwgPSB0ZXh0IHx8IGl0ZW0udGl0bGU7XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYoaXRlbS52YWx1ZSBpbnN0YW5jZW9mIE5vZGUpe1xuXHRcdFx0XHRub2RlX2NvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0XHRub2RlX2NvbnRlbnQuYXBwZW5kQ2hpbGQoaXRlbS52YWx1ZSk7XG5cdFx0XHRcdHZhbHVlRGF0YS5hcHBlbmRDaGlsZChub2RlX2NvbnRlbnQpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR2YWx1ZURhdGEuaW5uZXJIVE1MID0gaXRlbS52YWx1ZTtcblx0XHRcdH1cblxuXHRcdFx0cm93LmFwcGVuZENoaWxkKHRpdGxlRGF0YSk7XG5cdFx0XHRyb3cuYXBwZW5kQ2hpbGQodmFsdWVEYXRhKTtcblx0XHRcdGxpc3QuYXBwZW5kQ2hpbGQocm93KTtcblx0XHR9KTtcblxuXHRcdHJldHVybiBPYmplY3Qua2V5cyhkYXRhKS5sZW5ndGggPyBsaXN0IDogXCJcIjtcblx0fVxufVxuXG5mdW5jdGlvbiByb3dTZWxlY3Rpb24oY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKXtcblx0dmFyIGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuXHR2YXIgYmxvY2tlZCA9IGZhbHNlO1xuXG5cdGNoZWNrYm94LnR5cGUgPSAnY2hlY2tib3gnO1xuXG5cdGNoZWNrYm94LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgXCJTZWxlY3QgUm93XCIpO1xuXHRcblx0aWYodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJzZWxlY3RSb3dcIiwgdHJ1ZSkpe1xuXG5cdFx0Y2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdH0pO1xuXG5cdFx0aWYodHlwZW9mIGNlbGwuZ2V0Um93ID09ICdmdW5jdGlvbicpe1xuXHRcdFx0dmFyIHJvdyA9IGNlbGwuZ2V0Um93KCk7XG5cblx0XHRcdGlmKHJvdyBpbnN0YW5jZW9mIFJvd0NvbXBvbmVudCl7XG5cblx0XHRcdFx0Y2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZSkgPT4ge1xuXHRcdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUm93c1JhbmdlTW9kZSA9PT0gXCJjbGlja1wiKXtcblx0XHRcdFx0XHRcdGlmKCFibG9ja2VkKXtcblx0XHRcdFx0XHRcdFx0cm93LnRvZ2dsZVNlbGVjdCgpO1xuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHRibG9ja2VkID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0cm93LnRvZ2dsZVNlbGVjdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzUmFuZ2VNb2RlID09PSBcImNsaWNrXCIpe1xuXHRcdFx0XHRcdGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuXHRcdFx0XHRcdFx0YmxvY2tlZCA9IHRydWU7XG5cdFx0XHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93LmhhbmRsZUNvbXBsZXhSb3dDbGljayhyb3cuX3JvdywgZSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjaGVja2JveC5jaGVja2VkID0gcm93LmlzU2VsZWN0ZWQgJiYgcm93LmlzU2VsZWN0ZWQoKTtcblx0XHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLnNlbGVjdFJvdy5yZWdpc3RlclJvd1NlbGVjdENoZWNrYm94KHJvdywgY2hlY2tib3gpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjaGVja2JveCA9IFwiXCI7XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZSkgPT4ge1xuXHRcdFx0XHRpZih0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93LnNlbGVjdGVkUm93cy5sZW5ndGgpe1xuXHRcdFx0XHRcdHRoaXMudGFibGUuZGVzZWxlY3RSb3coKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMudGFibGUuc2VsZWN0Um93KGZvcm1hdHRlclBhcmFtcy5yb3dSYW5nZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93LnJlZ2lzdGVySGVhZGVyU2VsZWN0Q2hlY2tib3goY2hlY2tib3gpO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBjaGVja2JveDtcbn1cblxudmFyIGV4dGVuc2lvbnMkMSA9IHtcclxuXHRmb3JtYXQ6e1xyXG5cdFx0Zm9ybWF0dGVyczp7XHJcblx0XHRcdHJvd1NlbGVjdGlvbjpyb3dTZWxlY3Rpb24sXHJcblx0XHR9XHJcblx0fVxyXG59O1xuXG5jbGFzcyBTZWxlY3RSb3cgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcInNlbGVjdFJvd1wiO1xuXHRzdGF0aWMgbW9kdWxlRXh0ZW5zaW9ucyA9IGV4dGVuc2lvbnMkMTtcblx0XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy5zZWxlY3RpbmcgPSBmYWxzZTsgLy9mbGFnIHNlbGVjdGluZyBpbiBwcm9ncmVzc1xuXHRcdHRoaXMubGFzdENsaWNrZWRSb3cgPSBmYWxzZTsgLy9sYXN0IGNsaWNrZWQgcm93XG5cdFx0dGhpcy5zZWxlY3RQcmV2ID0gW107IC8vaG9sZCBwcmV2aW91c2x5IHNlbGVjdGVkIGVsZW1lbnQgZm9yIGRyYWcgZHJvcCBzZWxlY3Rpb25cblx0XHR0aGlzLnNlbGVjdGVkUm93cyA9IFtdOyAvL2hvbGQgc2VsZWN0ZWQgcm93c1xuXHRcdHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50ID0gbnVsbDsgLy8gaG9sZCBoZWFkZXIgc2VsZWN0IGVsZW1lbnRcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJzZWxlY3RhYmxlUm93c1wiLCBcImhpZ2hsaWdodFwiKTsgLy9oaWdobGlnaHQgcm93cyBvbiBob3ZlclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNlbGVjdGFibGVSb3dzUmFuZ2VNb2RlXCIsIFwiZHJhZ1wiKTsgIC8vaGlnaGxpZ2h0IHJvd3Mgb24gaG92ZXJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJzZWxlY3RhYmxlUm93c1JvbGxpbmdTZWxlY3Rpb25cIiwgdHJ1ZSk7IC8vcm9sbCBzZWxlY3Rpb24gb25jZSBtYXhpbXVtIG51bWJlciBvZiBzZWxlY3RhYmxlIHJvd3MgaXMgcmVhY2hlZFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNlbGVjdGFibGVSb3dzUGVyc2lzdGVuY2VcIiwgdHJ1ZSk7IC8vIG1haW50YWluIHNlbGVjdGlvbiB3aGVuIHRhYmxlIHZpZXcgaXMgdXBkYXRlZFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNlbGVjdGFibGVSb3dzQ2hlY2tcIiwgZnVuY3Rpb24oZGF0YSwgcm93KXtyZXR1cm4gdHJ1ZTt9KTsgLy9jaGVjayB3aGV0aGVyIHJvdyBpcyBzZWxlY3RhYmxlXG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJzZWxlY3RSb3dcIiwgdGhpcy5zZWxlY3RSb3dzLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZGVzZWxlY3RSb3dcIiwgdGhpcy5kZXNlbGVjdFJvd3MuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJ0b2dnbGVTZWxlY3RSb3dcIiwgdGhpcy50b2dnbGVSb3cuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRTZWxlY3RlZFJvd3NcIiwgdGhpcy5nZXRTZWxlY3RlZFJvd3MuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRTZWxlY3RlZERhdGFcIiwgdGhpcy5nZXRTZWxlY3RlZERhdGEuYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0Ly9yZWdpc3RlciBjb21wb25lbnQgZnVuY3Rpb25zXG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwicm93XCIsIFwic2VsZWN0XCIsIHRoaXMuc2VsZWN0Um93cy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJyb3dcIiwgXCJkZXNlbGVjdFwiLCB0aGlzLmRlc2VsZWN0Um93cy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJyb3dcIiwgXCJ0b2dnbGVTZWxlY3RcIiwgdGhpcy50b2dnbGVSb3cuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwicm93XCIsIFwiaXNTZWxlY3RlZFwiLCB0aGlzLmlzUm93U2VsZWN0ZWQuYmluZCh0aGlzKSk7XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblxuXHRcdHRoaXMuZGVwcmVjYXRlZE9wdGlvbnNDaGVjaygpO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzID09PSBcImhpZ2hsaWdodFwiICYmIHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUmFuZ2Upe1xuXHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzICE9PSBmYWxzZSl7XG5cdFx0XHR0aGlzLnN1YnNjcmliZShcInJvdy1pbml0XCIsIHRoaXMuaW5pdGlhbGl6ZVJvdy5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93LWRlbGV0aW5nXCIsIHRoaXMucm93RGVsZXRlZC5iaW5kKHRoaXMpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwicm93cy13aXBlXCIsIHRoaXMuY2xlYXJTZWxlY3Rpb25EYXRhLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJyb3dzLXJldHJpZXZlXCIsIHRoaXMucm93UmV0cmlldmUuYmluZCh0aGlzKSk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUm93cyAmJiAhdGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzUGVyc2lzdGVuY2Upe1xuXHRcdFx0XHR0aGlzLnN1YnNjcmliZShcImRhdGEtcmVmcmVzaGluZ1wiLCB0aGlzLmRlc2VsZWN0Um93cy5iaW5kKHRoaXMpKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRkZXByZWNhdGVkT3B0aW9uc0NoZWNrKCl7XG5cdFx0Ly8gdGhpcy5kZXByZWNhdGlvbkNoZWNrKFwic2VsZWN0YWJsZVwiLCBcInNlbGVjdGFibGVSb3dzXCIsIHRydWUpO1xuXHRcdC8vIHRoaXMuZGVwcmVjYXRpb25DaGVjayhcInNlbGVjdGFibGVSb2xsaW5nU2VsZWN0aW9uXCIsIFwic2VsZWN0YWJsZVJvd3NSb2xsaW5nU2VsZWN0aW9uXCIsIHRydWUpO1xuXHRcdC8vIHRoaXMuZGVwcmVjYXRpb25DaGVjayhcInNlbGVjdGFibGVSYW5nZU1vZGVcIiwgXCJzZWxlY3RhYmxlUm93c1JhbmdlTW9kZVwiLCB0cnVlKTtcblx0XHQvLyB0aGlzLmRlcHJlY2F0aW9uQ2hlY2soXCJzZWxlY3RhYmxlUGVyc2lzdGVuY2VcIiwgXCJzZWxlY3RhYmxlUm93c1BlcnNpc3RlbmNlXCIsIHRydWUpO1xuXHRcdC8vIHRoaXMuZGVwcmVjYXRpb25DaGVjayhcInNlbGVjdGFibGVDaGVja1wiLCBcInNlbGVjdGFibGVSb3dzQ2hlY2tcIiwgdHJ1ZSk7XG5cdH1cblx0XG5cdHJvd1JldHJpZXZlKHR5cGUsIHByZXZWYWx1ZSl7XG5cdFx0cmV0dXJuIHR5cGUgPT09IFwic2VsZWN0ZWRcIiA/IHRoaXMuc2VsZWN0ZWRSb3dzIDogcHJldlZhbHVlO1xuXHR9XG5cdFxuXHRyb3dEZWxldGVkKHJvdyl7XG5cdFx0dGhpcy5fZGVzZWxlY3RSb3cocm93LCB0cnVlKTtcblx0fVxuXHRcblx0Y2xlYXJTZWxlY3Rpb25EYXRhKHNpbGVudCl7XG5cdFx0dmFyIHByZXZTZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRSb3dzLmxlbmd0aDtcblxuXHRcdHRoaXMuc2VsZWN0aW5nID0gZmFsc2U7XG5cdFx0dGhpcy5sYXN0Q2xpY2tlZFJvdyA9IGZhbHNlO1xuXHRcdHRoaXMuc2VsZWN0UHJldiA9IFtdO1xuXHRcdHRoaXMuc2VsZWN0ZWRSb3dzID0gW107XG5cdFx0XG5cdFx0aWYocHJldlNlbGVjdGVkICYmIHNpbGVudCAhPT0gdHJ1ZSl7XG5cdFx0XHR0aGlzLl9yb3dTZWxlY3Rpb25DaGFuZ2VkKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRpbml0aWFsaXplUm93KHJvdyl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdHNlbGVjdGFibGUgPSBzZWxmLmNoZWNrUm93U2VsZWN0YWJpbGl0eShyb3cpLFxuXHRcdGVsZW1lbnQgPSByb3cuZ2V0RWxlbWVudCgpO1xuXHRcdFxuXHRcdC8vIHRyaWdnZXIgZW5kIG9mIHJvdyBzZWxlY3Rpb25cblx0XHR2YXIgZW5kU2VsZWN0ID0gZnVuY3Rpb24oKXtcblx0XHRcdFxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRzZWxmLnNlbGVjdGluZyA9IGZhbHNlO1xuXHRcdFx0fSwgNTApO1xuXHRcdFx0XG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGVuZFNlbGVjdCk7XG5cdFx0fTtcblx0XHRcblx0XHRyb3cubW9kdWxlcy5zZWxlY3QgPSB7c2VsZWN0ZWQ6ZmFsc2V9O1xuXG5cdFx0ZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwidGFidWxhdG9yLXNlbGVjdGFibGVcIiwgc2VsZWN0YWJsZSk7XG5cdFx0ZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwidGFidWxhdG9yLXVuc2VsZWN0YWJsZVwiLCAhc2VsZWN0YWJsZSk7XG5cdFx0XG5cdFx0Ly9zZXQgcm93IHNlbGVjdGlvbiBjbGFzc1xuXHRcdGlmKHNlbGYuY2hlY2tSb3dTZWxlY3RhYmlsaXR5KHJvdykpe1x0XHRcdFxuXHRcdFx0aWYoc2VsZi50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzICYmIHNlbGYudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUm93cyAhPSBcImhpZ2hsaWdodFwiKXtcblx0XHRcdFx0aWYoc2VsZi50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzUmFuZ2VNb2RlID09PSBcImNsaWNrXCIpe1xuXHRcdFx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuaGFuZGxlQ29tcGxleFJvd0NsaWNrLmJpbmQodGhpcywgcm93KSk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0XHRcdGlmKCFzZWxmLnRhYmxlLm1vZEV4aXN0cyhcImVkaXRcIikgfHwgIXNlbGYudGFibGUubW9kdWxlcy5lZGl0LmdldEN1cnJlbnRDZWxsKCkpe1xuXHRcdFx0XHRcdFx0XHRzZWxmLnRhYmxlLl9jbGVhclNlbGVjdGlvbigpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZighc2VsZi5zZWxlY3Rpbmcpe1xuXHRcdFx0XHRcdFx0XHRzZWxmLnRvZ2dsZVJvdyhyb3cpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0XHRcdGlmKGUuc2hpZnRLZXkpe1xuXHRcdFx0XHRcdFx0XHRzZWxmLnRhYmxlLl9jbGVhclNlbGVjdGlvbigpO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0c2VsZi5zZWxlY3RpbmcgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0c2VsZi5zZWxlY3RQcmV2ID0gW107XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGVuZFNlbGVjdCk7XG5cdFx0XHRcdFx0XHRcdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGVuZFNlbGVjdCk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRzZWxmLnRvZ2dsZVJvdyhyb3cpO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24oZSl7XG5cdFx0XHRcdFx0XHRpZihzZWxmLnNlbGVjdGluZyl7XG5cdFx0XHRcdFx0XHRcdHNlbGYudGFibGUuX2NsZWFyU2VsZWN0aW9uKCk7XG5cdFx0XHRcdFx0XHRcdHNlbGYudG9nZ2xlUm93KHJvdyk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRpZihzZWxmLnNlbGVjdFByZXZbMV0gPT0gcm93KXtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLnRvZ2dsZVJvdyhzZWxmLnNlbGVjdFByZXZbMF0pO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oZSl7XG5cdFx0XHRcdFx0XHRpZihzZWxmLnNlbGVjdGluZyl7XG5cdFx0XHRcdFx0XHRcdHNlbGYudGFibGUuX2NsZWFyU2VsZWN0aW9uKCk7XG5cdFx0XHRcdFx0XHRcdHNlbGYuc2VsZWN0UHJldi51bnNoaWZ0KHJvdyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGhhbmRsZUNvbXBsZXhSb3dDbGljayhyb3csIGUpe1xuXHRcdGlmKGUuc2hpZnRLZXkpe1xuXHRcdFx0dGhpcy50YWJsZS5fY2xlYXJTZWxlY3Rpb24oKTtcblx0XHRcdHRoaXMubGFzdENsaWNrZWRSb3cgPSB0aGlzLmxhc3RDbGlja2VkUm93IHx8IHJvdztcblx0XHRcdFxuXHRcdFx0dmFyIGxhc3RDbGlja2VkUm93SWR4ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dJbmRleCh0aGlzLmxhc3RDbGlja2VkUm93KTtcblx0XHRcdHZhciByb3dJZHggPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd0luZGV4KHJvdyk7XG5cdFx0XHRcblx0XHRcdHZhciBmcm9tUm93SWR4ID0gbGFzdENsaWNrZWRSb3dJZHggPD0gcm93SWR4ID8gbGFzdENsaWNrZWRSb3dJZHggOiByb3dJZHg7XG5cdFx0XHR2YXIgdG9Sb3dJZHggPSBsYXN0Q2xpY2tlZFJvd0lkeCA+PSByb3dJZHggPyBsYXN0Q2xpY2tlZFJvd0lkeCA6IHJvd0lkeDtcblx0XHRcdFxuXHRcdFx0dmFyIHJvd3MgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5zbGljZSgwKTtcblx0XHRcdHZhciB0b2dnbGVkUm93cyA9IHJvd3Muc3BsaWNlKGZyb21Sb3dJZHgsIHRvUm93SWR4IC0gZnJvbVJvd0lkeCArIDEpO1xuXHRcdFx0XG5cdFx0XHRpZihlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KXtcblx0XHRcdFx0dG9nZ2xlZFJvd3MuZm9yRWFjaCgodG9nZ2xlZFJvdyk9Pntcblx0XHRcdFx0XHRpZih0b2dnbGVkUm93ICE9PSB0aGlzLmxhc3RDbGlja2VkUm93KXtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzICE9PSB0cnVlICYmICF0aGlzLmlzUm93U2VsZWN0ZWQocm93KSl7XG5cdFx0XHRcdFx0XHRcdGlmKHRoaXMuc2VsZWN0ZWRSb3dzLmxlbmd0aCA8IHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUm93cyl7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy50b2dnbGVSb3codG9nZ2xlZFJvdyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdFx0dGhpcy50b2dnbGVSb3codG9nZ2xlZFJvdyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0dGhpcy5sYXN0Q2xpY2tlZFJvdyA9IHJvdztcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5kZXNlbGVjdFJvd3ModW5kZWZpbmVkLCB0cnVlKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUm93cyAhPT0gdHJ1ZSl7XG5cdFx0XHRcdFx0aWYodG9nZ2xlZFJvd3MubGVuZ3RoID4gdGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzKXtcblx0XHRcdFx0XHRcdHRvZ2dsZWRSb3dzID0gdG9nZ2xlZFJvd3Muc2xpY2UoMCwgdGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuc2VsZWN0Um93cyh0b2dnbGVkUm93cyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnRhYmxlLl9jbGVhclNlbGVjdGlvbigpO1xuXHRcdH1cblx0XHRlbHNlIGlmKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpe1xuXHRcdFx0dGhpcy50b2dnbGVSb3cocm93KTtcblx0XHRcdHRoaXMubGFzdENsaWNrZWRSb3cgPSByb3c7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5kZXNlbGVjdFJvd3ModW5kZWZpbmVkLCB0cnVlKTtcblx0XHRcdHRoaXMuc2VsZWN0Um93cyhyb3cpO1xuXHRcdFx0dGhpcy5sYXN0Q2xpY2tlZFJvdyA9IHJvdztcblx0XHR9XG5cdH1cblxuXHRjaGVja1Jvd1NlbGVjdGFiaWxpdHkocm93KXtcblx0XHRpZihyb3cgJiYgcm93LnR5cGUgPT09IFwicm93XCIpe1xuXHRcdFx0cmV0dXJuIHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUm93c0NoZWNrLmNhbGwodGhpcy50YWJsZSwgcm93LmdldENvbXBvbmVudCgpKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0XG5cdC8vdG9nZ2xlIHJvdyBzZWxlY3Rpb25cblx0dG9nZ2xlUm93KHJvdyl7XG5cdFx0aWYodGhpcy5jaGVja1Jvd1NlbGVjdGFiaWxpdHkocm93KSl7XG5cdFx0XHRpZihyb3cubW9kdWxlcy5zZWxlY3QgJiYgcm93Lm1vZHVsZXMuc2VsZWN0LnNlbGVjdGVkKXtcblx0XHRcdFx0dGhpcy5fZGVzZWxlY3RSb3cocm93KTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5fc2VsZWN0Um93KHJvdyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3NlbGVjdCBhIG51bWJlciBvZiByb3dzXG5cdHNlbGVjdFJvd3Mocm93cyl7XG5cdFx0dmFyIGNoYW5nZXMgPSBbXSwgXG5cdFx0cm93TWF0Y2gsIGNoYW5nZTtcblx0XHRcblx0XHRzd2l0Y2godHlwZW9mIHJvd3Mpe1xuXHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRyb3dNYXRjaCA9IHRoaXMudGFibGUucm93TWFuYWdlci5yb3dzO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSBcIm51bWJlclwiOlxuXHRcdFx0XHRyb3dNYXRjaCA9IHRoaXMudGFibGUucm93TWFuYWdlci5maW5kUm93KHJvd3MpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFx0XG5cdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdHJvd01hdGNoID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpbmRSb3cocm93cyk7XG5cdFx0XHRcblx0XHRcdFx0aWYoIXJvd01hdGNoKXtcblx0XHRcdFx0XHRyb3dNYXRjaCA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRSb3dzKHJvd3MpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRyb3dNYXRjaCA9IHJvd3M7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdGlmKEFycmF5LmlzQXJyYXkocm93TWF0Y2gpKXtcblx0XHRcdGlmKHJvd01hdGNoLmxlbmd0aCl7XG5cdFx0XHRcdHJvd01hdGNoLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRcdGNoYW5nZSA9IHRoaXMuX3NlbGVjdFJvdyhyb3csIHRydWUsIHRydWUpO1xuXG5cdFx0XHRcdFx0aWYoY2hhbmdlKXtcblx0XHRcdFx0XHRcdGNoYW5nZXMucHVzaChjaGFuZ2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dGhpcy5fcm93U2VsZWN0aW9uQ2hhbmdlZChmYWxzZSwgY2hhbmdlcyk7XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYocm93TWF0Y2gpe1xuXHRcdFx0XHR0aGlzLl9zZWxlY3RSb3cocm93TWF0Y2gsIGZhbHNlLCB0cnVlKTtcblx0XHRcdH1cblx0XHR9XHRcblx0fVxuXHRcblx0Ly9zZWxlY3QgYW4gaW5kaXZpZHVhbCByb3dcblx0X3NlbGVjdFJvdyhyb3dJbmZvLCBzaWxlbnQsIGZvcmNlKXtcblx0XHQvL2hhbmRsZSBtYXggcm93IGNvdW50XG5cdFx0aWYoIWlzTmFOKHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUm93cykgJiYgdGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzICE9PSB0cnVlICYmICFmb3JjZSl7XG5cdFx0XHRpZih0aGlzLnNlbGVjdGVkUm93cy5sZW5ndGggPj0gdGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzKXtcblx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb3dzUm9sbGluZ1NlbGVjdGlvbil7XG5cdFx0XHRcdFx0dGhpcy5fZGVzZWxlY3RSb3codGhpcy5zZWxlY3RlZFJvd3NbMF0pO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHZhciByb3cgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZmluZFJvdyhyb3dJbmZvKTtcblx0XHRcblx0XHRpZihyb3cpe1xuXHRcdFx0aWYodGhpcy5zZWxlY3RlZFJvd3MuaW5kZXhPZihyb3cpID09IC0xKXtcblx0XHRcdFx0cm93LmdldEVsZW1lbnQoKS5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXNlbGVjdGVkXCIpO1xuXHRcdFx0XHRpZighcm93Lm1vZHVsZXMuc2VsZWN0KXtcblx0XHRcdFx0XHRyb3cubW9kdWxlcy5zZWxlY3QgPSB7fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0cm93Lm1vZHVsZXMuc2VsZWN0LnNlbGVjdGVkID0gdHJ1ZTtcblx0XHRcdFx0aWYocm93Lm1vZHVsZXMuc2VsZWN0LmNoZWNrYm94RWwpe1xuXHRcdFx0XHRcdHJvdy5tb2R1bGVzLnNlbGVjdC5jaGVja2JveEVsLmNoZWNrZWQgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnNlbGVjdGVkUm93cy5wdXNoKHJvdyk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWVTZWxlY3RQcm9wYWdhdGUpe1xuXHRcdFx0XHRcdHRoaXMuY2hpbGRSb3dTZWxlY3Rpb24ocm93LCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwicm93U2VsZWN0ZWRcIiwgcm93LmdldENvbXBvbmVudCgpKTtcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuX3Jvd1NlbGVjdGlvbkNoYW5nZWQoc2lsZW50LCByb3cpO1xuXG5cdFx0XHRcdHJldHVybiByb3c7XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYoIXNpbGVudCl7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIlNlbGVjdGlvbiBFcnJvciAtIE5vIHN1Y2ggcm93IGZvdW5kLCBpZ25vcmluZyBzZWxlY3Rpb246XCIgKyByb3dJbmZvKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGlzUm93U2VsZWN0ZWQocm93KXtcblx0XHRyZXR1cm4gdGhpcy5zZWxlY3RlZFJvd3MuaW5kZXhPZihyb3cpICE9PSAtMTtcblx0fVxuXHRcblx0Ly9kZXNlbGVjdCBhIG51bWJlciBvZiByb3dzXG5cdGRlc2VsZWN0Um93cyhyb3dzLCBzaWxlbnQpe1xuXHRcdHZhciBjaGFuZ2VzID0gW10sIFxuXHRcdHJvd01hdGNoLCBjaGFuZ2U7XG5cdFx0XG5cdFx0c3dpdGNoKHR5cGVvZiByb3dzKXtcblx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0cm93TWF0Y2ggPSBPYmplY3QuYXNzaWduKFtdLCB0aGlzLnNlbGVjdGVkUm93cyk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwibnVtYmVyXCI6XG5cdFx0XHRcdHJvd01hdGNoID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpbmRSb3cocm93cyk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdHJvd01hdGNoID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpbmRSb3cocm93cyk7XG5cdFx0XHRcblx0XHRcdFx0aWYoIXJvd01hdGNoKXtcblx0XHRcdFx0XHRyb3dNYXRjaCA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRSb3dzKHJvd3MpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRyb3dNYXRjaCA9IHJvd3M7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdGlmKEFycmF5LmlzQXJyYXkocm93TWF0Y2gpKXtcblx0XHRcdGlmKHJvd01hdGNoLmxlbmd0aCl7XG5cdFx0XHRcdHJvd01hdGNoLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRcdGNoYW5nZSA9IHRoaXMuX2Rlc2VsZWN0Um93KHJvdywgdHJ1ZSwgdHJ1ZSk7XG5cblx0XHRcdFx0XHRpZihjaGFuZ2Upe1xuXHRcdFx0XHRcdFx0Y2hhbmdlcy5wdXNoKGNoYW5nZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHR0aGlzLl9yb3dTZWxlY3Rpb25DaGFuZ2VkKHNpbGVudCwgW10sIGNoYW5nZXMpO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGlmKHJvd01hdGNoKXtcblx0XHRcdFx0dGhpcy5fZGVzZWxlY3RSb3cocm93TWF0Y2gsIHNpbGVudCwgdHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fVx0XG5cdH1cblx0XG5cdC8vZGVzZWxlY3QgYW4gaW5kaXZpZHVhbCByb3dcblx0X2Rlc2VsZWN0Um93KHJvd0luZm8sIHNpbGVudCl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdHJvdyA9IHNlbGYudGFibGUucm93TWFuYWdlci5maW5kUm93KHJvd0luZm8pLFxuXHRcdGluZGV4LCBlbGVtZW50O1xuXHRcdFxuXHRcdGlmKHJvdyl7XG5cdFx0XHRpbmRleCA9IHNlbGYuc2VsZWN0ZWRSb3dzLmZpbmRJbmRleChmdW5jdGlvbihzZWxlY3RlZFJvdyl7XG5cdFx0XHRcdHJldHVybiBzZWxlY3RlZFJvdyA9PSByb3c7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0aWYoaW5kZXggPiAtMSl7XG5cblx0XHRcdFx0ZWxlbWVudCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihlbGVtZW50KXtcblx0XHRcdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3Itc2VsZWN0ZWRcIik7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmKCFyb3cubW9kdWxlcy5zZWxlY3Qpe1xuXHRcdFx0XHRcdHJvdy5tb2R1bGVzLnNlbGVjdCA9IHt9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRyb3cubW9kdWxlcy5zZWxlY3Quc2VsZWN0ZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocm93Lm1vZHVsZXMuc2VsZWN0LmNoZWNrYm94RWwpe1xuXHRcdFx0XHRcdHJvdy5tb2R1bGVzLnNlbGVjdC5jaGVja2JveEVsLmNoZWNrZWQgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZWxmLnNlbGVjdGVkUm93cy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlU2VsZWN0UHJvcGFnYXRlKXtcblx0XHRcdFx0XHR0aGlzLmNoaWxkUm93U2VsZWN0aW9uKHJvdywgZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJyb3dEZXNlbGVjdGVkXCIsIHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRzZWxmLl9yb3dTZWxlY3Rpb25DaGFuZ2VkKHNpbGVudCwgdW5kZWZpbmVkLCByb3cpO1xuXG5cdFx0XHRcdHJldHVybiByb3c7XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYoIXNpbGVudCl7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkRlc2VsZWN0aW9uIEVycm9yIC0gTm8gc3VjaCByb3cgZm91bmQsIGlnbm9yaW5nIHNlbGVjdGlvbjpcIiArIHJvd0luZm8pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0Z2V0U2VsZWN0ZWREYXRhKCl7XG5cdFx0dmFyIGRhdGEgPSBbXTtcblx0XHRcblx0XHR0aGlzLnNlbGVjdGVkUm93cy5mb3JFYWNoKGZ1bmN0aW9uKHJvdyl7XG5cdFx0XHRkYXRhLnB1c2gocm93LmdldERhdGEoKSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIGRhdGE7XG5cdH1cblx0XG5cdGdldFNlbGVjdGVkUm93cygpe1xuXHRcdHZhciByb3dzID0gW107XG5cdFx0XG5cdFx0dGhpcy5zZWxlY3RlZFJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdFx0cm93cy5wdXNoKHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIHJvd3M7XG5cdH1cblx0XG5cdF9yb3dTZWxlY3Rpb25DaGFuZ2VkKHNpbGVudCwgc2VsZWN0ZWQgPSBbXSwgZGVzZWxlY3RlZCA9IFtdKXtcblx0XHRpZih0aGlzLmhlYWRlckNoZWNrYm94RWxlbWVudCl7XG5cdFx0XHRpZih0aGlzLnNlbGVjdGVkUm93cy5sZW5ndGggPT09IDApe1xuXHRcdFx0XHR0aGlzLmhlYWRlckNoZWNrYm94RWxlbWVudC5jaGVja2VkID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50LmluZGV0ZXJtaW5hdGUgPSBmYWxzZTtcblx0XHRcdH0gZWxzZSBpZih0aGlzLnRhYmxlLnJvd01hbmFnZXIucm93cy5sZW5ndGggPT09IHRoaXMuc2VsZWN0ZWRSb3dzLmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50LmNoZWNrZWQgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLmhlYWRlckNoZWNrYm94RWxlbWVudC5pbmRldGVybWluYXRlID0gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmhlYWRlckNoZWNrYm94RWxlbWVudC5pbmRldGVybWluYXRlID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5oZWFkZXJDaGVja2JveEVsZW1lbnQuY2hlY2tlZCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZighc2lsZW50KXtcblx0XHRcdGlmKCFBcnJheS5pc0FycmF5KHNlbGVjdGVkKSl7XG5cdFx0XHRcdHNlbGVjdGVkID0gW3NlbGVjdGVkXTtcblx0XHRcdH1cblxuXHRcdFx0c2VsZWN0ZWQgPSBzZWxlY3RlZC5tYXAocm93ID0+IHJvdy5nZXRDb21wb25lbnQoKSk7XG5cblx0XHRcdGlmKCFBcnJheS5pc0FycmF5KGRlc2VsZWN0ZWQpKXtcblx0XHRcdFx0ZGVzZWxlY3RlZCA9IFtkZXNlbGVjdGVkXTtcblx0XHRcdH1cblxuXHRcdFx0ZGVzZWxlY3RlZCA9IGRlc2VsZWN0ZWQubWFwKHJvdyA9PiByb3cuZ2V0Q29tcG9uZW50KCkpO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJyb3dTZWxlY3Rpb25DaGFuZ2VkXCIsIHRoaXMuZ2V0U2VsZWN0ZWREYXRhKCksIHRoaXMuZ2V0U2VsZWN0ZWRSb3dzKCksIHNlbGVjdGVkLCBkZXNlbGVjdGVkKTtcblx0XHR9XG5cdH1cblx0XG5cdHJlZ2lzdGVyUm93U2VsZWN0Q2hlY2tib3ggKHJvdywgZWxlbWVudCkge1xuXHRcdGlmKCFyb3cuX3Jvdy5tb2R1bGVzLnNlbGVjdCl7XG5cdFx0XHRyb3cuX3Jvdy5tb2R1bGVzLnNlbGVjdCA9IHt9O1xuXHRcdH1cblx0XHRcblx0XHRyb3cuX3Jvdy5tb2R1bGVzLnNlbGVjdC5jaGVja2JveEVsID0gZWxlbWVudDtcblx0fVxuXHRcblx0cmVnaXN0ZXJIZWFkZXJTZWxlY3RDaGVja2JveCAoZWxlbWVudCkge1xuXHRcdHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50ID0gZWxlbWVudDtcblx0fVxuXHRcblx0Y2hpbGRSb3dTZWxlY3Rpb24ocm93LCBzZWxlY3Qpe1xuXHRcdHZhciBjaGlsZHJlbiA9IHRoaXMudGFibGUubW9kdWxlcy5kYXRhVHJlZS5nZXRDaGlsZHJlbihyb3csIHRydWUsIHRydWUpO1xuXHRcdFxuXHRcdGlmKHNlbGVjdCl7XG5cdFx0XHRmb3IobGV0IGNoaWxkIG9mIGNoaWxkcmVuKXtcblx0XHRcdFx0dGhpcy5fc2VsZWN0Um93KGNoaWxkLCB0cnVlKTtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRmb3IobGV0IGNoaWxkIG9mIGNoaWxkcmVuKXtcblx0XHRcdFx0dGhpcy5fZGVzZWxlY3RSb3coY2hpbGQsIHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG5jbGFzcyBSYW5nZUNvbXBvbmVudCB7XG5cdGNvbnN0cnVjdG9yKHJhbmdlKSB7XG5cdFx0dGhpcy5fcmFuZ2UgPSByYW5nZTtcblxuXHRcdHJldHVybiBuZXcgUHJveHkodGhpcywge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiAodGFyZ2V0LCBuYW1lLCByZWNlaXZlcikge1xuXHRcdFx0XHRpZiAodHlwZW9mIHRhcmdldFtuYW1lXSAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdHJldHVybiB0YXJnZXRbbmFtZV07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRhcmdldC5fcmFuZ2UudGFibGUuY29tcG9uZW50RnVuY3Rpb25CaW5kZXIuaGFuZGxlKFwicmFuZ2VcIiwgdGFyZ2V0Ll9yYW5nZSwgbmFtZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0fSk7XG5cdH1cblxuXHRnZXRFbGVtZW50KCkge1xuXHRcdHJldHVybiB0aGlzLl9yYW5nZS5lbGVtZW50O1xuXHR9XG5cblx0Z2V0RGF0YSgpIHtcblx0XHRyZXR1cm4gdGhpcy5fcmFuZ2UuZ2V0RGF0YSgpO1xuXHR9XG5cblx0Z2V0Q2VsbHMoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3JhbmdlLmdldENlbGxzKHRydWUsIHRydWUpO1xuXHR9XG5cblx0Z2V0U3RydWN0dXJlZENlbGxzKCkge1xuXHRcdHJldHVybiB0aGlzLl9yYW5nZS5nZXRTdHJ1Y3R1cmVkQ2VsbHMoKTtcblx0fVxuXG5cdGdldFJvd3MoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3JhbmdlLmdldFJvd3MoKS5tYXAoKHJvdykgPT4gcm93LmdldENvbXBvbmVudCgpKTtcblx0fVxuXG5cdGdldENvbHVtbnMoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3JhbmdlLmdldENvbHVtbnMoKS5tYXAoKGNvbHVtbikgPT4gY29sdW1uLmdldENvbXBvbmVudCgpKTtcblx0fVxuXHRcblx0Z2V0Qm91bmRzKCkge1xuXHRcdHJldHVybiB0aGlzLl9yYW5nZS5nZXRCb3VuZHMoKTtcblx0fVxuXG5cdGdldFRvcEVkZ2UoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3JhbmdlLnRvcDtcblx0fVxuXG5cdGdldEJvdHRvbUVkZ2UoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3JhbmdlLmJvdHRvbTtcblx0fVxuXG5cdGdldExlZnRFZGdlKCkge1xuXHRcdHJldHVybiB0aGlzLl9yYW5nZS5sZWZ0O1xuXHR9XG5cblx0Z2V0UmlnaHRFZGdlKCkge1xuXHRcdHJldHVybiB0aGlzLl9yYW5nZS5yaWdodDtcblx0fVxuXG5cdHNldEJvdW5kcyhzdGFydCwgZW5kKXtcblx0XHRpZih0aGlzLl9yYW5nZS5kZXN0cm95ZWRHdWFyZChcInNldEJvdW5kc1wiKSl7XG5cdFx0XHR0aGlzLl9yYW5nZS5zZXRCb3VuZHMoc3RhcnQgPyBzdGFydC5fY2VsbCA6IHN0YXJ0LCBlbmQgPyBlbmQuX2NlbGwgOiBlbmQpO1xuXHRcdH1cblx0fVxuXG5cdHNldFN0YXJ0Qm91bmQoc3RhcnQpe1xuXHRcdGlmKHRoaXMuX3JhbmdlLmRlc3Ryb3llZEd1YXJkKFwic2V0U3RhcnRCb3VuZFwiKSl7XG5cdFx0XHR0aGlzLl9yYW5nZS5zZXRFbmRCb3VuZChzdGFydCA/IHN0YXJ0Ll9jZWxsIDogc3RhcnQpO1xuXHRcdFx0dGhpcy5fcmFuZ2UucmFuZ2VNYW5hZ2VyLmxheW91dEVsZW1lbnQoKTtcblx0XHR9XG5cdH1cblxuXHRzZXRFbmRCb3VuZChlbmQpe1xuXHRcdGlmKHRoaXMuX3JhbmdlLmRlc3Ryb3llZEd1YXJkKFwic2V0RW5kQm91bmRcIikpe1xuXHRcdFx0dGhpcy5fcmFuZ2Uuc2V0RW5kQm91bmQoZW5kID8gZW5kLl9jZWxsIDogZW5kKTtcblx0XHRcdHRoaXMuX3JhbmdlLnJhbmdlTWFuYWdlci5sYXlvdXRFbGVtZW50KCk7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYXJWYWx1ZXMoKXtcblx0XHRpZih0aGlzLl9yYW5nZS5kZXN0cm95ZWRHdWFyZChcImNsZWFyVmFsdWVzXCIpKXtcblx0XHRcdHRoaXMuX3JhbmdlLmNsZWFyVmFsdWVzKCk7XG5cdFx0fVxuXHR9XG5cblx0cmVtb3ZlKCl7XG5cdFx0aWYodGhpcy5fcmFuZ2UuZGVzdHJveWVkR3VhcmQoXCJyZW1vdmVcIikpe1xuXHRcdFx0dGhpcy5fcmFuZ2UuZGVzdHJveSh0cnVlKTtcblx0XHR9XG5cdH1cbn1cblxuY2xhc3MgUmFuZ2UgZXh0ZW5kcyBDb3JlRmVhdHVyZXtcblx0Y29uc3RydWN0b3IodGFibGUsIHJhbmdlTWFuYWdlciwgc3RhcnQsIGVuZCkge1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0XHRcblx0XHR0aGlzLnJhbmdlTWFuYWdlciA9IHJhbmdlTWFuYWdlcjtcblx0XHR0aGlzLmVsZW1lbnQgPSBudWxsO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR0aGlzLmluaXRpYWxpemluZyA9IHtcblx0XHRcdHN0YXJ0OmZhbHNlLFxuXHRcdFx0ZW5kOmZhbHNlLFxuXHRcdH07XG5cdFx0dGhpcy5kZXN0cm95ZWQgPSBmYWxzZTtcblx0XHRcblx0XHR0aGlzLnRvcCA9IDA7XG5cdFx0dGhpcy5ib3R0b20gPSAwO1xuXHRcdHRoaXMubGVmdCA9IDA7XG5cdFx0dGhpcy5yaWdodCA9IDA7XG5cdFx0XG5cdFx0dGhpcy50YWJsZSA9IHRhYmxlO1xuXHRcdHRoaXMuc3RhcnQgPSB7cm93OjAsIGNvbDowfTtcblx0XHR0aGlzLmVuZCA9IHtyb3c6MCwgY29sOjB9O1xuXG5cdFx0aWYodGhpcy5yYW5nZU1hbmFnZXIucm93SGVhZGVyKXtcblx0XHRcdHRoaXMubGVmdCA9IDE7XG5cdFx0XHR0aGlzLnJpZ2h0ID0gMTtcblx0XHRcdHRoaXMuc3RhcnQuY29sID0gMTtcblx0XHRcdHRoaXMuZW5kLmNvbCA9IDE7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuaW5pdEVsZW1lbnQoKTtcblx0XHRcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuaW5pdEJvdW5kcyhzdGFydCwgZW5kKTtcblx0XHR9KTtcblx0fVxuXHRcblx0aW5pdEVsZW1lbnQoKXtcblx0XHR0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJhbmdlXCIpO1xuXHR9XG5cdFxuXHRpbml0Qm91bmRzKHN0YXJ0LCBlbmQpe1xuXHRcdHRoaXMuX3VwZGF0ZU1pbk1heCgpO1xuXHRcdFxuXHRcdGlmKHN0YXJ0KXtcblx0XHRcdHRoaXMuc2V0Qm91bmRzKHN0YXJ0LCBlbmQgfHwgc3RhcnQpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLyAgIEJvdW5kYXJ5IFNldHVwICAgIC8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdHNldFN0YXJ0KHJvdywgY29sKSB7XG5cdFx0aWYodGhpcy5zdGFydC5yb3cgIT09IHJvdyB8fCB0aGlzLnN0YXJ0LmNvbCAhPT0gY29sKXtcblx0XHRcdHRoaXMuc3RhcnQucm93ID0gcm93O1xuXHRcdFx0dGhpcy5zdGFydC5jb2wgPSBjb2w7XG5cdFx0XHRcblx0XHRcdHRoaXMuaW5pdGlhbGl6aW5nLnN0YXJ0ID0gdHJ1ZTtcblx0XHRcdHRoaXMuX3VwZGF0ZU1pbk1heCgpO1xuXHRcdH1cblx0fVxuXHRcblx0c2V0RW5kKHJvdywgY29sKSB7XG5cdFx0aWYodGhpcy5lbmQucm93ICE9PSByb3cgfHwgdGhpcy5lbmQuY29sICE9PSBjb2wpe1xuXHRcdFx0dGhpcy5lbmQucm93ID0gcm93O1xuXHRcdFx0dGhpcy5lbmQuY29sID0gY29sO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmluaXRpYWxpemluZy5lbmQgPSB0cnVlO1xuXHRcdFx0dGhpcy5fdXBkYXRlTWluTWF4KCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRzZXRCb3VuZHMoc3RhcnQsIGVuZCwgdmlzaWJsZVJvd3Mpe1xuXHRcdGlmKHN0YXJ0KXtcblx0XHRcdHRoaXMuc2V0U3RhcnRCb3VuZChzdGFydCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuc2V0RW5kQm91bmQoZW5kIHx8IHN0YXJ0KTtcblx0XHR0aGlzLnJhbmdlTWFuYWdlci5sYXlvdXRFbGVtZW50KHZpc2libGVSb3dzKTtcblx0fVxuXHRcblx0c2V0U3RhcnRCb3VuZChlbGVtZW50KXtcblx0XHR2YXIgcm93LCBjb2w7XG5cdFx0XG5cdFx0aWYgKGVsZW1lbnQudHlwZSA9PT0gXCJjb2x1bW5cIikge1xuXHRcdFx0aWYodGhpcy5yYW5nZU1hbmFnZXIuY29sdW1uU2VsZWN0aW9uKXtcblx0XHRcdFx0dGhpcy5zZXRTdGFydCgwLCBlbGVtZW50LmdldFBvc2l0aW9uKCkgLSAxKTtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRyb3cgPSBlbGVtZW50LnJvdy5wb3NpdGlvbiAtIDE7XG5cdFx0XHRjb2wgPSBlbGVtZW50LmNvbHVtbi5nZXRQb3NpdGlvbigpIC0gMTtcblx0XHRcdFxuXHRcdFx0aWYgKGVsZW1lbnQuY29sdW1uID09PSB0aGlzLnJhbmdlTWFuYWdlci5yb3dIZWFkZXIpIHtcblx0XHRcdFx0dGhpcy5zZXRTdGFydChyb3csIDEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zZXRTdGFydChyb3csIGNvbCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRzZXRFbmRCb3VuZChlbGVtZW50KXtcblx0XHR2YXIgcm93c0NvdW50ID0gdGhpcy5fZ2V0VGFibGVSb3dzKCkubGVuZ3RoLFxuXHRcdHJvdywgY29sLCBpc1Jvd0hlYWRlcjtcblx0XHRcblx0XHRpZiAoZWxlbWVudC50eXBlID09PSBcImNvbHVtblwiKSB7XG5cdFx0XHRpZih0aGlzLnJhbmdlTWFuYWdlci5jb2x1bW5TZWxlY3Rpb24pe1xuXHRcdFx0XHRpZiAodGhpcy5yYW5nZU1hbmFnZXIuc2VsZWN0aW5nID09PSBcImNvbHVtblwiKSB7XG5cdFx0XHRcdFx0dGhpcy5zZXRFbmQocm93c0NvdW50IC0gMSwgZWxlbWVudC5nZXRQb3NpdGlvbigpIC0gMSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAodGhpcy5yYW5nZU1hbmFnZXIuc2VsZWN0aW5nID09PSBcImNlbGxcIikge1xuXHRcdFx0XHRcdHRoaXMuc2V0RW5kKDAsIGVsZW1lbnQuZ2V0UG9zaXRpb24oKSAtIDEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0cm93ID0gZWxlbWVudC5yb3cucG9zaXRpb24gLSAxO1xuXHRcdFx0Y29sID0gZWxlbWVudC5jb2x1bW4uZ2V0UG9zaXRpb24oKSAtIDE7XG5cdFx0XHRpc1Jvd0hlYWRlciA9IGVsZW1lbnQuY29sdW1uID09PSB0aGlzLnJhbmdlTWFuYWdlci5yb3dIZWFkZXI7XG5cdFx0XHRcblx0XHRcdGlmICh0aGlzLnJhbmdlTWFuYWdlci5zZWxlY3RpbmcgPT09IFwicm93XCIpIHtcblx0XHRcdFx0dGhpcy5zZXRFbmQocm93LCB0aGlzLl9nZXRUYWJsZUNvbHVtbnMoKS5sZW5ndGggLSAxKTtcblx0XHRcdH0gZWxzZSBpZiAodGhpcy5yYW5nZU1hbmFnZXIuc2VsZWN0aW5nICE9PSBcInJvd1wiICYmIGlzUm93SGVhZGVyKSB7XG5cdFx0XHRcdHRoaXMuc2V0RW5kKHJvdywgMCk7XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMucmFuZ2VNYW5hZ2VyLnNlbGVjdGluZyA9PT0gXCJjb2x1bW5cIikge1xuXHRcdFx0XHR0aGlzLnNldEVuZChyb3dzQ291bnQgLSAxLCBjb2wpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zZXRFbmQocm93LCBjb2wpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0X3VwZGF0ZU1pbk1heCgpIHtcblx0XHR0aGlzLnRvcCA9IE1hdGgubWluKHRoaXMuc3RhcnQucm93LCB0aGlzLmVuZC5yb3cpO1xuXHRcdHRoaXMuYm90dG9tID0gTWF0aC5tYXgodGhpcy5zdGFydC5yb3csIHRoaXMuZW5kLnJvdyk7XG5cdFx0dGhpcy5sZWZ0ID0gTWF0aC5taW4odGhpcy5zdGFydC5jb2wsIHRoaXMuZW5kLmNvbCk7XG5cdFx0dGhpcy5yaWdodCA9IE1hdGgubWF4KHRoaXMuc3RhcnQuY29sLCB0aGlzLmVuZC5jb2wpO1xuXHRcdFxuXHRcdGlmKHRoaXMuaW5pdGlhbGl6ZWQpe1xuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwicmFuZ2VDaGFuZ2VkXCIsIHRoaXMuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGlmKHRoaXMuaW5pdGlhbGl6aW5nLnN0YXJ0ICYmIHRoaXMuaW5pdGlhbGl6aW5nLmVuZCl7XG5cdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJyYW5nZUFkZGVkXCIsIHRoaXMuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0X2dldFRhYmxlQ29sdW1ucygpIHtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldFZpc2libGVDb2x1bW5zQnlJbmRleCgpO1xuXHR9XG5cdFxuXHRfZ2V0VGFibGVSb3dzKCkge1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5maWx0ZXIocm93PT4gcm93LnR5cGUgPT09IFwicm93XCIpO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vICAgICAgUmVuZGVyaW5nICAgICAgLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0bGF5b3V0KCkge1xuXHRcdHZhciBfdkRvbVRvcCA9IHRoaXMudGFibGUucm93TWFuYWdlci5yZW5kZXJlci52RG9tVG9wLFxuXHRcdF92RG9tQm90dG9tID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlbmRlcmVyLnZEb21Cb3R0b20sXG5cdFx0X3ZEb21MZWZ0ID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLnJlbmRlcmVyLmxlZnRDb2wsXG5cdFx0X3ZEb21SaWdodCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5yZW5kZXJlci5yaWdodENvbCxcdFx0XG5cdFx0dG9wLCBib3R0b20sIGxlZnQsIHJpZ2h0LCB0b3BMZWZ0Q2VsbCwgYm90dG9tUmlnaHRDZWxsLCB0b3BMZWZ0Q2VsbEVsLCBib3R0b21SaWdodENlbGxFbCwgdG9wTGVmdFJvd0VsLCBib3R0b21SaWdodFJvd0VsO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJlbmRlckhvcml6b250YWwgPT09IFwidmlydHVhbFwiICYmIHRoaXMucmFuZ2VNYW5hZ2VyLnJvd0hlYWRlcikge1xuXHRcdFx0X3ZEb21SaWdodCArPSAxO1xuXHRcdH1cblx0XHRcblx0XHRpZiAoX3ZEb21Ub3AgPT0gbnVsbCkge1xuXHRcdFx0X3ZEb21Ub3AgPSAwO1xuXHRcdH1cblx0XHRcblx0XHRpZiAoX3ZEb21Cb3R0b20gPT0gbnVsbCkge1xuXHRcdFx0X3ZEb21Cb3R0b20gPSBJbmZpbml0eTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKF92RG9tTGVmdCA9PSBudWxsKSB7XG5cdFx0XHRfdkRvbUxlZnQgPSAwO1xuXHRcdH1cblx0XHRcblx0XHRpZiAoX3ZEb21SaWdodCA9PSBudWxsKSB7XG5cdFx0XHRfdkRvbVJpZ2h0ID0gSW5maW5pdHk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICh0aGlzLm92ZXJsYXBzKF92RG9tTGVmdCwgX3ZEb21Ub3AsIF92RG9tUmlnaHQsIF92RG9tQm90dG9tKSkge1xuXHRcdFx0dG9wID0gTWF0aC5tYXgodGhpcy50b3AsIF92RG9tVG9wKTtcblx0XHRcdGJvdHRvbSA9IE1hdGgubWluKHRoaXMuYm90dG9tLCBfdkRvbUJvdHRvbSk7XG5cdFx0XHRsZWZ0ID0gTWF0aC5tYXgodGhpcy5sZWZ0LCBfdkRvbUxlZnQpO1xuXHRcdFx0cmlnaHQgPSBNYXRoLm1pbih0aGlzLnJpZ2h0LCBfdkRvbVJpZ2h0KTtcblx0XHRcdFxuXHRcdFx0dG9wTGVmdENlbGwgPSB0aGlzLnJhbmdlTWFuYWdlci5nZXRDZWxsKHRvcCwgbGVmdCk7XG5cdFx0XHRib3R0b21SaWdodENlbGwgPSB0aGlzLnJhbmdlTWFuYWdlci5nZXRDZWxsKGJvdHRvbSwgcmlnaHQpO1xuXHRcdFx0dG9wTGVmdENlbGxFbCA9IHRvcExlZnRDZWxsLmdldEVsZW1lbnQoKTtcblx0XHRcdGJvdHRvbVJpZ2h0Q2VsbEVsID0gYm90dG9tUmlnaHRDZWxsLmdldEVsZW1lbnQoKTtcblx0XHRcdHRvcExlZnRSb3dFbCA9IHRvcExlZnRDZWxsLnJvdy5nZXRFbGVtZW50KCk7XG5cdFx0XHRib3R0b21SaWdodFJvd0VsID0gYm90dG9tUmlnaHRDZWxsLnJvdy5nZXRFbGVtZW50KCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJhbmdlLWFjdGl2ZVwiKTtcblx0XHRcdC8vIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwidGFidWxhdG9yLXJhbmdlLWFjdGl2ZVwiLCB0aGlzID09PSB0aGlzLnJhbmdlTWFuYWdlci5hY3RpdmVSYW5nZSk7XG5cblx0XHRcdGlmKHRoaXMudGFibGUucnRsKXtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLnJpZ2h0ID0gdG9wTGVmdFJvd0VsLm9mZnNldFdpZHRoIC0gdG9wTGVmdENlbGxFbC5vZmZzZXRMZWZ0IC0gdG9wTGVmdENlbGxFbC5vZmZzZXRXaWR0aCArIFwicHhcIjtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLndpZHRoID0gdG9wTGVmdENlbGxFbC5vZmZzZXRMZWZ0ICsgdG9wTGVmdENlbGxFbC5vZmZzZXRXaWR0aCAtIGJvdHRvbVJpZ2h0Q2VsbEVsLm9mZnNldExlZnQgKyBcInB4XCI7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gdG9wTGVmdFJvd0VsLm9mZnNldExlZnQgKyB0b3BMZWZ0Q2VsbEVsLm9mZnNldExlZnQgKyBcInB4XCI7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IGJvdHRvbVJpZ2h0Q2VsbEVsLm9mZnNldExlZnQgKyBib3R0b21SaWdodENlbGxFbC5vZmZzZXRXaWR0aCAtIHRvcExlZnRDZWxsRWwub2Zmc2V0TGVmdCArIFwicHhcIjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IHRvcExlZnRSb3dFbC5vZmZzZXRUb3AgKyBcInB4XCI7XG5cdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gYm90dG9tUmlnaHRSb3dFbC5vZmZzZXRUb3AgKyBib3R0b21SaWdodFJvd0VsLm9mZnNldEhlaWdodCAtIHRvcExlZnRSb3dFbC5vZmZzZXRUb3AgKyBcInB4XCI7XG5cdFx0fVxuXHR9XG5cdFxuXHRhdFRvcExlZnQoY2VsbCkge1xuXHRcdHJldHVybiBjZWxsLnJvdy5wb3NpdGlvbiAtIDEgPT09IHRoaXMudG9wICYmIGNlbGwuY29sdW1uLmdldFBvc2l0aW9uKCkgLSAxID09PSB0aGlzLmxlZnQ7XG5cdH1cblx0XG5cdGF0Qm90dG9tUmlnaHQoY2VsbCkge1xuXHRcdHJldHVybiBjZWxsLnJvdy5wb3NpdGlvbiAtIDEgPT09IHRoaXMuYm90dG9tICYmIGNlbGwuY29sdW1uLmdldFBvc2l0aW9uKCkgLSAxID09PSB0aGlzLnJpZ2h0O1xuXHR9XG5cdFxuXHRvY2N1cGllcyhjZWxsKSB7XG5cdFx0cmV0dXJuIHRoaXMub2NjdXBpZXNSb3coY2VsbC5yb3cpICYmIHRoaXMub2NjdXBpZXNDb2x1bW4oY2VsbC5jb2x1bW4pO1xuXHR9XG5cdFxuXHRvY2N1cGllc1Jvdyhyb3cpIHtcblx0XHRyZXR1cm4gdGhpcy50b3AgPD0gcm93LnBvc2l0aW9uIC0gMSAmJiByb3cucG9zaXRpb24gLSAxIDw9IHRoaXMuYm90dG9tO1xuXHR9XG5cdFxuXHRvY2N1cGllc0NvbHVtbihjb2wpIHtcblx0XHRyZXR1cm4gdGhpcy5sZWZ0IDw9IGNvbC5nZXRQb3NpdGlvbigpIC0gMSAmJiBjb2wuZ2V0UG9zaXRpb24oKSAtIDEgPD0gdGhpcy5yaWdodDtcblx0fVxuXHRcblx0b3ZlcmxhcHMobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG5cdFx0aWYgKCh0aGlzLmxlZnQgPiByaWdodCB8fCBsZWZ0ID4gdGhpcy5yaWdodCkgfHwgKHRoaXMudG9wID4gYm90dG9tIHx8IHRvcCA+IHRoaXMuYm90dG9tKSl7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cdFxuXHRnZXREYXRhKCkge1xuXHRcdHZhciBkYXRhID0gW10sXG5cdFx0cm93cyA9IHRoaXMuZ2V0Um93cygpLFxuXHRcdGNvbHVtbnMgPSB0aGlzLmdldENvbHVtbnMoKTtcblx0XHRcblx0XHRyb3dzLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0dmFyIHJvd0RhdGEgPSByb3cuZ2V0RGF0YSgpLFxuXHRcdFx0cmVzdWx0ID0ge307XG5cdFx0XHRcblx0XHRcdGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdHJlc3VsdFtjb2x1bW4uZmllbGRdID0gcm93RGF0YVtjb2x1bW4uZmllbGRdO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdGRhdGEucHVzaChyZXN1bHQpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBkYXRhO1xuXHR9XG5cdFxuXHRnZXRDZWxscyhzdHJ1Y3R1cmVkLCBjb21wb25lbnQpIHtcblx0XHR2YXIgY2VsbHMgPSBbXSxcblx0XHRyb3dzID0gdGhpcy5nZXRSb3dzKCksXG5cdFx0Y29sdW1ucyA9IHRoaXMuZ2V0Q29sdW1ucygpO1xuXHRcdFxuXHRcdGlmIChzdHJ1Y3R1cmVkKSB7XG5cdFx0XHRjZWxscyA9IHJvd3MubWFwKChyb3cpID0+IHtcblx0XHRcdFx0dmFyIGFyciA9IFtdO1xuXHRcdFx0XHRcblx0XHRcdFx0cm93LmdldENlbGxzKCkuZm9yRWFjaCgoY2VsbCkgPT4ge1xuXHRcdFx0XHRcdGlmIChjb2x1bW5zLmluY2x1ZGVzKGNlbGwuY29sdW1uKSkge1xuXHRcdFx0XHRcdFx0YXJyLnB1c2goY29tcG9uZW50ID8gY2VsbC5nZXRDb21wb25lbnQoKSA6IGNlbGwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gYXJyO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdHJvdy5nZXRDZWxscygpLmZvckVhY2goKGNlbGwpID0+IHtcblx0XHRcdFx0XHRpZiAoY29sdW1ucy5pbmNsdWRlcyhjZWxsLmNvbHVtbikpIHtcblx0XHRcdFx0XHRcdGNlbGxzLnB1c2goY29tcG9uZW50ID8gY2VsbC5nZXRDb21wb25lbnQoKSA6IGNlbGwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGNlbGxzO1xuXHR9XG5cdFxuXHRnZXRTdHJ1Y3R1cmVkQ2VsbHMoKSB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0Q2VsbHModHJ1ZSwgdHJ1ZSk7XG5cdH1cblx0XG5cdGdldFJvd3MoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2dldFRhYmxlUm93cygpLnNsaWNlKHRoaXMudG9wLCB0aGlzLmJvdHRvbSArIDEpO1xuXHR9XG5cdFxuXHRnZXRDb2x1bW5zKCkge1xuXHRcdHJldHVybiB0aGlzLl9nZXRUYWJsZUNvbHVtbnMoKS5zbGljZSh0aGlzLmxlZnQsIHRoaXMucmlnaHQgKyAxKTtcblx0fVxuXHRcblx0Y2xlYXJWYWx1ZXMoKXtcblx0XHR2YXIgY2VsbHMgPSB0aGlzLmdldENlbGxzKCk7XG5cdFx0dmFyIGNsZWFyVmFsdWUgPSB0aGlzLnRhYmxlLm9wdGlvbnMuc2VsZWN0YWJsZVJhbmdlQ2xlYXJDZWxsc1ZhbHVlO1xuXHRcdFxuXHRcdHRoaXMudGFibGUuYmxvY2tSZWRyYXcoKTtcblx0XHRcblx0XHRjZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG5cdFx0XHRjZWxsLnNldFZhbHVlKGNsZWFyVmFsdWUpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMudGFibGUucmVzdG9yZVJlZHJhdygpO1xuXHRcdFxuXHR9XG5cdFxuXHRnZXRCb3VuZHMoY29tcG9uZW50KXtcblx0XHR2YXIgY2VsbHMgPSB0aGlzLmdldENlbGxzKGZhbHNlLCBjb21wb25lbnQpLFxuXHRcdG91dHB1dCA9IHtcblx0XHRcdHN0YXJ0Om51bGwsXG5cdFx0XHRlbmQ6bnVsbCxcblx0XHR9O1xuXHRcdFxuXHRcdGlmKGNlbGxzLmxlbmd0aCl7XG5cdFx0XHRvdXRwdXQuc3RhcnQgPSBjZWxsc1swXTtcblx0XHRcdG91dHB1dC5lbmQgPSBjZWxsc1tjZWxscy5sZW5ndGggLSAxXTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJObyBib3VuZHMgZGVmaW5lZCBvbiByYW5nZVwiKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0Z2V0Q29tcG9uZW50KCkge1xuXHRcdGlmICghdGhpcy5jb21wb25lbnQpIHtcblx0XHRcdHRoaXMuY29tcG9uZW50ID0gbmV3IFJhbmdlQ29tcG9uZW50KHRoaXMpO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5jb21wb25lbnQ7XG5cdH1cblx0XG5cdGRlc3Ryb3kobm90aWZ5KSB7XG5cdFx0dGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuXHRcdFxuXHRcdHRoaXMuZWxlbWVudC5yZW1vdmUoKTtcblx0XHRcblx0XHRpZihub3RpZnkpe1xuXHRcdFx0dGhpcy5yYW5nZU1hbmFnZXIucmFuZ2VSZW1vdmVkKHRoaXMpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLmluaXRpYWxpemVkKXtcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInJhbmdlUmVtb3ZlZFwiLCB0aGlzLmdldENvbXBvbmVudCgpKTtcblx0XHR9XG5cdH1cblx0XG5cdGRlc3Ryb3llZEd1YXJkKGZ1bmMpe1xuXHRcdGlmKHRoaXMuZGVzdHJveWVkKXtcblx0XHRcdGNvbnNvbGUud2FybihcIllvdSBjYW5ub3QgY2FsbCB0aGUgXCIgICsgZnVuYyArIFwiIGZ1bmN0aW9uIG9uIGEgZGVzdHJveWVkIHJhbmdlXCIpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gIXRoaXMuZGVzdHJveWVkO1xuXHR9XG59XG5cbnZhciBiaW5kaW5ncyA9IHtcclxuXHRyYW5nZUp1bXBVcDpbXCJjdHJsICsgMzhcIiwgXCJtZXRhICsgMzhcIl0sXHJcblx0cmFuZ2VKdW1wRG93bjpbXCJjdHJsICsgNDBcIiwgXCJtZXRhICsgNDBcIl0sXHJcblx0cmFuZ2VKdW1wTGVmdDpbXCJjdHJsICsgMzdcIiwgXCJtZXRhICsgMzdcIl0sXHJcblx0cmFuZ2VKdW1wUmlnaHQ6W1wiY3RybCArIDM5XCIsIFwibWV0YSArIDM5XCJdLFxyXG5cdHJhbmdlRXhwYW5kVXA6XCJzaGlmdCArIDM4XCIsXHJcblx0cmFuZ2VFeHBhbmREb3duOlwic2hpZnQgKyA0MFwiLFxyXG5cdHJhbmdlRXhwYW5kTGVmdDpcInNoaWZ0ICsgMzdcIixcclxuXHRyYW5nZUV4cGFuZFJpZ2h0Olwic2hpZnQgKyAzOVwiLFxyXG5cdHJhbmdlRXhwYW5kSnVtcFVwOltcImN0cmwgKyBzaGlmdCArIDM4XCIsIFwibWV0YSArIHNoaWZ0ICsgMzhcIl0sXHJcblx0cmFuZ2VFeHBhbmRKdW1wRG93bjpbXCJjdHJsICsgc2hpZnQgKyA0MFwiLCBcIm1ldGEgKyBzaGlmdCArIDQwXCJdLFxyXG5cdHJhbmdlRXhwYW5kSnVtcExlZnQ6W1wiY3RybCArIHNoaWZ0ICsgMzdcIiwgXCJtZXRhICsgc2hpZnQgKyAzN1wiXSxcclxuXHRyYW5nZUV4cGFuZEp1bXBSaWdodDpbXCJjdHJsICsgc2hpZnQgKyAzOVwiLCBcIm1ldGEgKyBzaGlmdCArIDM5XCJdLFxyXG59O1xuXG52YXIgYWN0aW9ucyA9IHtcclxuXHRyYW5nZUp1bXBMZWZ0OiBmdW5jdGlvbihlKXtcclxuXHRcdHRoaXMuZGlzcGF0Y2goXCJrZXliaW5kaW5nLW5hdi1yYW5nZVwiLCBlLCBcImxlZnRcIiwgdHJ1ZSwgZmFsc2UpO1xyXG5cdH0sXHJcblx0cmFuZ2VKdW1wUmlnaHQ6IGZ1bmN0aW9uKGUpe1xyXG5cdFx0dGhpcy5kaXNwYXRjaChcImtleWJpbmRpbmctbmF2LXJhbmdlXCIsIGUsIFwicmlnaHRcIiwgdHJ1ZSwgZmFsc2UpO1xyXG5cdH0sXHJcblx0cmFuZ2VKdW1wVXA6IGZ1bmN0aW9uKGUpe1xyXG5cdFx0dGhpcy5kaXNwYXRjaChcImtleWJpbmRpbmctbmF2LXJhbmdlXCIsIGUsIFwidXBcIiwgdHJ1ZSwgZmFsc2UpO1xyXG5cdH0sXHJcblx0cmFuZ2VKdW1wRG93bjogZnVuY3Rpb24oZSl7XHJcblx0XHR0aGlzLmRpc3BhdGNoKFwia2V5YmluZGluZy1uYXYtcmFuZ2VcIiwgZSwgXCJkb3duXCIsIHRydWUsIGZhbHNlKTtcclxuXHR9LFxyXG5cdHJhbmdlRXhwYW5kTGVmdDogZnVuY3Rpb24oZSl7XHJcblx0XHR0aGlzLmRpc3BhdGNoKFwia2V5YmluZGluZy1uYXYtcmFuZ2VcIiwgZSwgXCJsZWZ0XCIsIGZhbHNlLCB0cnVlKTtcclxuXHR9LFxyXG5cdHJhbmdlRXhwYW5kUmlnaHQ6IGZ1bmN0aW9uKGUpe1xyXG5cdFx0dGhpcy5kaXNwYXRjaChcImtleWJpbmRpbmctbmF2LXJhbmdlXCIsIGUsIFwicmlnaHRcIiwgZmFsc2UsIHRydWUpO1xyXG5cdH0sXHJcblx0cmFuZ2VFeHBhbmRVcDogZnVuY3Rpb24oZSl7XHJcblx0XHR0aGlzLmRpc3BhdGNoKFwia2V5YmluZGluZy1uYXYtcmFuZ2VcIiwgZSwgXCJ1cFwiLCBmYWxzZSwgdHJ1ZSk7XHJcblx0fSxcclxuXHRyYW5nZUV4cGFuZERvd246IGZ1bmN0aW9uKGUpe1xyXG5cdFx0dGhpcy5kaXNwYXRjaChcImtleWJpbmRpbmctbmF2LXJhbmdlXCIsIGUsIFwiZG93blwiLCBmYWxzZSwgdHJ1ZSk7XHJcblx0fSxcclxuXHRyYW5nZUV4cGFuZEp1bXBMZWZ0OiBmdW5jdGlvbihlKXtcclxuXHRcdHRoaXMuZGlzcGF0Y2goXCJrZXliaW5kaW5nLW5hdi1yYW5nZVwiLCBlLCBcImxlZnRcIiwgdHJ1ZSwgdHJ1ZSk7XHJcblx0fSxcclxuXHRyYW5nZUV4cGFuZEp1bXBSaWdodDogZnVuY3Rpb24oZSl7XHJcblx0XHR0aGlzLmRpc3BhdGNoKFwia2V5YmluZGluZy1uYXYtcmFuZ2VcIiwgZSwgXCJyaWdodFwiLCB0cnVlLCB0cnVlKTtcclxuXHR9LFxyXG5cdHJhbmdlRXhwYW5kSnVtcFVwOiBmdW5jdGlvbihlKXtcclxuXHRcdHRoaXMuZGlzcGF0Y2goXCJrZXliaW5kaW5nLW5hdi1yYW5nZVwiLCBlLCBcInVwXCIsIHRydWUsIHRydWUpO1xyXG5cdH0sXHJcblx0cmFuZ2VFeHBhbmRKdW1wRG93bjogZnVuY3Rpb24oZSl7XHJcblx0XHR0aGlzLmRpc3BhdGNoKFwia2V5YmluZGluZy1uYXYtcmFuZ2VcIiwgZSwgXCJkb3duXCIsIHRydWUsIHRydWUpO1xyXG5cdH0sXHJcbn07XG5cbnZhciBwYXN0ZUFjdGlvbnMgPSB7XHJcblx0cmFuZ2U6ZnVuY3Rpb24oZGF0YSl7XHJcblx0XHR2YXIgcm93cyA9IFtdLFxyXG5cdFx0cmFuZ2UgPSB0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0UmFuZ2UuYWN0aXZlUmFuZ2UsXHJcblx0XHRzaW5nbGVDZWxsID0gZmFsc2UsXHJcblx0XHRib3VuZHMsIHN0YXJ0Q2VsbCwgc3RhcnRSb3csIHJvd1dpZHRoLCBkYXRhTGVuZ3RoO1xyXG5cclxuXHRcdGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aDtcclxuXHRcdFxyXG5cdFx0aWYocmFuZ2Upe1xyXG5cdFx0XHRib3VuZHMgPSByYW5nZS5nZXRCb3VuZHMoKTtcclxuXHRcdFx0c3RhcnRDZWxsID0gYm91bmRzLnN0YXJ0O1xyXG5cdFx0XHRcclxuXHRcdFx0aWYoYm91bmRzLnN0YXJ0ID09PSBib3VuZHMuZW5kKXtcclxuXHRcdFx0XHRzaW5nbGVDZWxsID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0aWYoc3RhcnRDZWxsKXtcclxuXHRcdFx0XHRyb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFjdGl2ZVJvd3Muc2xpY2UoKTtcclxuXHRcdFx0XHRzdGFydFJvdyA9IHJvd3MuaW5kZXhPZihzdGFydENlbGwucm93KTtcclxuXHJcblx0XHRcdFx0aWYoc2luZ2xlQ2VsbCl7XHJcblx0XHRcdFx0XHRyb3dXaWR0aCA9IGRhdGEubGVuZ3RoO1xyXG5cdFx0XHRcdH1lbHNlIHtcclxuXHRcdFx0XHRcdHJvd1dpZHRoID0gKHJvd3MuaW5kZXhPZihib3VuZHMuZW5kLnJvdykgLSBzdGFydFJvdykgKyAxO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZihzdGFydFJvdyA+LTEpe1xyXG5cdFx0XHRcdFx0dGhpcy50YWJsZS5ibG9ja1JlZHJhdygpO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRyb3dzID0gcm93cy5zbGljZShzdGFydFJvdywgc3RhcnRSb3cgKyByb3dXaWR0aCk7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdHJvd3MuZm9yRWFjaCgocm93LCBpKSA9PiB7XHJcblx0XHRcdFx0XHRcdHJvdy51cGRhdGVEYXRhKGRhdGFbaSAlIGRhdGFMZW5ndGhdKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHR0aGlzLnRhYmxlLnJlc3RvcmVSZWRyYXcoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0cmV0dXJuIHJvd3M7XHJcblx0fVxyXG59O1xuXG52YXIgcGFzdGVQYXJzZXJzID0ge1xyXG5cdHJhbmdlOmZ1bmN0aW9uKGNsaXBib2FyZCl7XHJcblx0XHR2YXIgZGF0YSA9IFtdLFxyXG5cdFx0cm93cyA9IFtdLFxyXG5cdFx0cmFuZ2UgPSB0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0UmFuZ2UuYWN0aXZlUmFuZ2UsXHJcblx0XHRzaW5nbGVDZWxsID0gZmFsc2UsXHJcblx0XHRib3VuZHMsIHN0YXJ0Q2VsbCwgY29sV2lkdGgsIGNvbHVtbk1hcCwgc3RhcnRDb2w7XHJcblx0XHRcclxuXHRcdGlmKHJhbmdlKXtcclxuXHRcdFx0Ym91bmRzID0gcmFuZ2UuZ2V0Qm91bmRzKCk7XHJcblx0XHRcdHN0YXJ0Q2VsbCA9IGJvdW5kcy5zdGFydDtcclxuXHJcblx0XHRcdGlmKGJvdW5kcy5zdGFydCA9PT0gYm91bmRzLmVuZCl7XHJcblx0XHRcdFx0c2luZ2xlQ2VsbCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdGlmKHN0YXJ0Q2VsbCl7XHJcblx0XHRcdFx0Ly9nZXQgZGF0YSBmcm9tIGNsaXBib2FyZCBpbnRvIGFycmF5IG9mIGNvbHVtbnMgYW5kIHJvd3MuXHJcblx0XHRcdFx0Y2xpcGJvYXJkID0gY2xpcGJvYXJkLnNwbGl0KFwiXFxuXCIpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGNsaXBib2FyZC5mb3JFYWNoKGZ1bmN0aW9uKHJvdyl7XHJcblx0XHRcdFx0XHRkYXRhLnB1c2gocm93LnNwbGl0KFwiXFx0XCIpKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZihkYXRhLmxlbmd0aCl7XHJcblx0XHRcdFx0XHRjb2x1bW5NYXAgPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0VmlzaWJsZUNvbHVtbnNCeUluZGV4KCk7XHJcblx0XHRcdFx0XHRzdGFydENvbCA9IGNvbHVtbk1hcC5pbmRleE9mKHN0YXJ0Q2VsbC5jb2x1bW4pO1xyXG5cclxuXHRcdFx0XHRcdGlmKHN0YXJ0Q29sID4gLTEpe1xyXG5cdFx0XHRcdFx0XHRpZihzaW5nbGVDZWxsKXtcclxuXHRcdFx0XHRcdFx0XHRjb2xXaWR0aCA9IGRhdGFbMF0ubGVuZ3RoO1xyXG5cdFx0XHRcdFx0XHR9ZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0Y29sV2lkdGggPSAoY29sdW1uTWFwLmluZGV4T2YoYm91bmRzLmVuZC5jb2x1bW4pIC0gc3RhcnRDb2wpICsgMTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0Y29sdW1uTWFwID0gY29sdW1uTWFwLnNsaWNlKHN0YXJ0Q29sLCBzdGFydENvbCArIGNvbFdpZHRoKTtcclxuXHJcblx0XHRcdFx0XHRcdGRhdGEuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHZhciByb3cgPSB7fTtcclxuXHRcdFx0XHRcdFx0XHR2YXIgaXRlbUxlbmd0aCA9IGl0ZW0ubGVuZ3RoO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRjb2x1bW5NYXAuZm9yRWFjaChmdW5jdGlvbihjb2wsIGkpe1xyXG5cdFx0XHRcdFx0XHRcdFx0cm93W2NvbC5maWVsZF0gPSBpdGVtW2kgJSBpdGVtTGVuZ3RoXTtcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRyb3dzLnB1c2gocm93KTtcdFxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHRcdHJldHVybiByb3dzO1xyXG5cdFx0XHRcdFx0fVx0XHRcdFx0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcbn07XG5cbnZhciBjb2x1bW5Mb29rdXBzID0ge1xyXG5cdHJhbmdlOmZ1bmN0aW9uKCl7XHJcblx0XHR2YXIgY29sdW1ucyA9IHRoaXMubW9kdWxlcy5zZWxlY3RSYW5nZS5zZWxlY3RlZENvbHVtbnMoKTtcclxuXHJcblx0XHRpZih0aGlzLmNvbHVtbk1hbmFnZXIucm93SGVhZGVyKXtcclxuXHRcdFx0Y29sdW1ucy51bnNoaWZ0KHRoaXMuY29sdW1uTWFuYWdlci5yb3dIZWFkZXIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBjb2x1bW5zO1xyXG5cdH0sXHJcbn07XG5cbnZhciByb3dMb29rdXBzID0ge1xyXG5cdHJhbmdlOmZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gdGhpcy5tb2R1bGVzLnNlbGVjdFJhbmdlLnNlbGVjdGVkUm93cygpO1xyXG5cdH0sXHJcbn07XG5cbnZhciBleHRlbnNpb25zID0ge1xyXG5cdGtleWJpbmRpbmdzOntcclxuXHRcdGJpbmRpbmdzOmJpbmRpbmdzLFxyXG5cdFx0YWN0aW9uczphY3Rpb25zXHJcblx0fSxcclxuXHRjbGlwYm9hcmQ6e1xyXG5cdFx0cGFzdGVBY3Rpb25zOnBhc3RlQWN0aW9ucyxcclxuXHRcdHBhc3RlUGFyc2VyczpwYXN0ZVBhcnNlcnNcclxuXHR9LFxyXG5cdGV4cG9ydDp7XHJcblx0XHRjb2x1bW5Mb29rdXBzOmNvbHVtbkxvb2t1cHMsXHJcblx0XHRyb3dMb29rdXBzOnJvd0xvb2t1cHMsXHJcblx0fVxyXG59O1xuXG5jbGFzcyBTZWxlY3RSYW5nZSBleHRlbmRzIE1vZHVsZSB7XG5cdFxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwic2VsZWN0UmFuZ2VcIjtcblx0c3RhdGljIG1vZHVsZUluaXRPcmRlciA9IDE7XG5cdHN0YXRpYyBtb2R1bGVFeHRlbnNpb25zID0gZXh0ZW5zaW9ucztcblx0XG5cdGNvbnN0cnVjdG9yKHRhYmxlKSB7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMuc2VsZWN0aW5nID0gXCJjZWxsXCI7XG5cdFx0dGhpcy5tb3VzZWRvd24gPSBmYWxzZTtcblx0XHR0aGlzLnJhbmdlcyA9IFtdO1xuXHRcdHRoaXMub3ZlcmxheSA9IG51bGw7XG5cdFx0dGhpcy5yb3dIZWFkZXIgPSBudWxsO1xuXHRcdHRoaXMubGF5b3V0Q2hhbmdlVGltZW91dCA9IG51bGw7XG5cdFx0dGhpcy5jb2x1bW5TZWxlY3Rpb24gPSBmYWxzZTtcblx0XHR0aGlzLnJvd1NlbGVjdGlvbiA9IGZhbHNlO1xuXHRcdHRoaXMubWF4UmFuZ2VzID0gMDtcblx0XHR0aGlzLmFjdGl2ZVJhbmdlID0gZmFsc2U7XG5cdFx0dGhpcy5ibG9ja0tleWRvd24gPSBmYWxzZTtcblx0XHRcblx0XHR0aGlzLmtleURvd25FdmVudCA9IHRoaXMuX2hhbmRsZUtleURvd24uYmluZCh0aGlzKTtcblx0XHR0aGlzLm1vdXNlVXBFdmVudCA9IHRoaXMuX2hhbmRsZU1vdXNlVXAuYmluZCh0aGlzKTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJzZWxlY3RhYmxlUmFuZ2VcIiwgZmFsc2UpOyAvL2VuYWJsZSBzZWxlY3RhYmxlIHJhbmdlXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwic2VsZWN0YWJsZVJhbmdlQ29sdW1uc1wiLCBmYWxzZSk7IC8vZW5hYmxlIHNlbGVjdGFibGUgcmFuZ2Vcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJzZWxlY3RhYmxlUmFuZ2VSb3dzXCIsIGZhbHNlKTsgLy9lbmFibGUgc2VsZWN0YWJsZSByYW5nZVxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNlbGVjdGFibGVSYW5nZUNsZWFyQ2VsbHNcIiwgZmFsc2UpOyAvL2FsbG93IGNsZWFyaW5nIG9mIGFjdGl2ZSByYW5nZVxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNlbGVjdGFibGVSYW5nZUNsZWFyQ2VsbHNWYWx1ZVwiLCB1bmRlZmluZWQpOyAvL3ZhbHVlIGZvciBjbGVhcmVkIGFjdGl2ZSByYW5nZVxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNlbGVjdGFibGVSYW5nZUF1dG9Gb2N1c1wiLCB0cnVlKTsgLy9mb2N1cyBvbiBhIGNlbGwgYWZ0ZXIgcmVzZXRSYW5nZXNcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImdldFJhbmdlc0RhdGFcIiwgdGhpcy5nZXRSYW5nZXNEYXRhLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0UmFuZ2VzXCIsIHRoaXMuZ2V0UmFuZ2VzLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiYWRkUmFuZ2VcIiwgdGhpcy5hZGRSYW5nZUZyb21Db21wb25lbnQuYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiY2VsbFwiLCBcImdldFJhbmdlc1wiLCB0aGlzLmNlbGxHZXRSYW5nZXMuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwicm93XCIsIFwiZ2V0UmFuZ2VzXCIsIHRoaXMucm93R2V0UmFuZ2VzLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNvbHVtblwiLCBcImdldFJhbmdlc1wiLCB0aGlzLmNvbEdldFJhbmdlcy5iaW5kKHRoaXMpKTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLyAgICBJbml0aWFsaXphdGlvbiAgIC8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdGluaXRpYWxpemUoKSB7XG5cdFx0aWYgKHRoaXMub3B0aW9ucyhcInNlbGVjdGFibGVSYW5nZVwiKSkge1x0XG5cdFx0XHRpZighdGhpcy5vcHRpb25zKFwic2VsZWN0YWJsZVJvd3NcIikpe1xuXHRcdFx0XHR0aGlzLm1heFJhbmdlcyA9IHRoaXMub3B0aW9ucyhcInNlbGVjdGFibGVSYW5nZVwiKTtcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZVRhYmxlKCk7XG5cdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZVdhdGNoZXJzKCk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIlNlbGVjdFJhbmdlIGZ1bmN0aW9uYWxpdHkgY2Fubm90IGJlIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCByb3cgc2VsZWN0aW9uXCIpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMoJ2NvbHVtbnMnKS5maW5kSW5kZXgoKGNvbHVtbikgPT4gY29sdW1uLmZyb3plbikgPiAwKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkhhdmluZyBmcm96ZW4gY29sdW1uIGluIGFyYml0cmFyeSBwb3NpdGlvbiB3aXRoIHNlbGVjdFJhbmdlIG9wdGlvbiBtYXkgcmVzdWx0IGluIHVucHJlZGljdGFibGUgYmVoYXZpb3IuXCIpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMoJ2NvbHVtbnMnKS5maWx0ZXIoKGNvbHVtbikgPT4gY29sdW1uLmZyb3plbikgPiAxKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkhhdmluZyBtdWx0aXBsZSBmcm96ZW4gY29sdW1ucyB3aXRoIHNlbGVjdFJhbmdlIG9wdGlvbiBtYXkgcmVzdWx0IGluIHVucHJlZGljdGFibGUgYmVoYXZpb3IuXCIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0XG5cdGluaXRpYWxpemVUYWJsZSgpIHtcdFx0XG5cdFx0dGhpcy5vdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aGlzLm92ZXJsYXkuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1yYW5nZS1vdmVybGF5XCIpO1xuXHRcdFxuXHRcdHRoaXMucmFuZ2VDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMucmFuZ2VDb250YWluZXIuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1yYW5nZS1jb250YWluZXJcIik7XG5cdFx0XG5cdFx0dGhpcy5hY3RpdmVSYW5nZUNlbGxFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aGlzLmFjdGl2ZVJhbmdlQ2VsbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1yYW5nZS1jZWxsLWFjdGl2ZVwiKTtcblx0XHRcblx0XHR0aGlzLm92ZXJsYXkuYXBwZW5kQ2hpbGQodGhpcy5yYW5nZUNvbnRhaW5lcik7XG5cdFx0dGhpcy5vdmVybGF5LmFwcGVuZENoaWxkKHRoaXMuYWN0aXZlUmFuZ2VDZWxsRWxlbWVudCk7XG5cdFx0XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5rZXlEb3duRXZlbnQpO1xuXHRcdFxuXHRcdHRoaXMucmVzZXRSYW5nZXMoKTtcblx0XHRcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLm92ZXJsYXkpO1xuXHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5lbGVtZW50LnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIDApO1xuXHRcdHRoaXMudGFibGUuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJhbmdlc1wiKTtcblx0fVxuXHRcblx0aW5pdGlhbGl6ZVdhdGNoZXJzKCkge1xuXHRcdHRoaXMuY29sdW1uU2VsZWN0aW9uID0gdGhpcy5vcHRpb25zKFwic2VsZWN0YWJsZVJhbmdlQ29sdW1uc1wiKTtcblx0XHR0aGlzLnJvd1NlbGVjdGlvbiA9IHRoaXMub3B0aW9ucyhcInNlbGVjdGFibGVSYW5nZVJvd3NcIik7XG5cdFx0XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4taW5pdFwiLCB0aGlzLmluaXRpYWxpemVDb2x1bW4uYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tbW91c2Vkb3duXCIsIHRoaXMuaGFuZGxlQ29sdW1uTW91c2VEb3duLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLW1vdXNlbW92ZVwiLCB0aGlzLmhhbmRsZUNvbHVtbk1vdXNlTW92ZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1yZXNpemVkXCIsIHRoaXMuaGFuZGxlQ29sdW1uUmVzaXplZC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1tb3ZpbmdcIiwgdGhpcy5oYW5kbGVDb2x1bW5Nb3ZpbmcuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tbW92ZWRcIiwgdGhpcy5oYW5kbGVDb2x1bW5Nb3ZlZC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi13aWR0aFwiLCB0aGlzLmxheW91dENoYW5nZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1oZWlnaHRcIiwgdGhpcy5sYXlvdXRDaGFuZ2UuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tcmVzaXplZFwiLCB0aGlzLmxheW91dENoYW5nZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbnMtbG9hZGVkXCIsIHRoaXMudXBkYXRlSGVhZGVyQ29sdW1uLmJpbmQodGhpcykpO1xuXHRcdFxuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC1oZWlnaHRcIiwgdGhpcy5sYXlvdXRDaGFuZ2UuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLXJlbmRlcmVkXCIsIHRoaXMucmVuZGVyQ2VsbC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtbW91c2Vkb3duXCIsIHRoaXMuaGFuZGxlQ2VsbE1vdXNlRG93bi5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtbW91c2Vtb3ZlXCIsIHRoaXMuaGFuZGxlQ2VsbE1vdXNlTW92ZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtY2xpY2tcIiwgdGhpcy5oYW5kbGVDZWxsQ2xpY2suYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLWVkaXRpbmdcIiwgdGhpcy5oYW5kbGVFZGl0aW5nQ2VsbC5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHR0aGlzLnN1YnNjcmliZShcInBhZ2UtY2hhbmdlZFwiLCB0aGlzLnJlZHJhdy5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHR0aGlzLnN1YnNjcmliZShcInNjcm9sbC12ZXJ0aWNhbFwiLCB0aGlzLmxheW91dENoYW5nZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInNjcm9sbC1ob3Jpem9udGFsXCIsIHRoaXMubGF5b3V0Q2hhbmdlLmJpbmQodGhpcykpO1xuXHRcdFxuXHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1kZXN0cm95XCIsIHRoaXMudGFibGVEZXN0cm95ZWQuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJkYXRhLXByb2Nlc3NlZFwiLCB0aGlzLnJlc2V0UmFuZ2VzLmJpbmQodGhpcykpO1xuXHRcdFxuXHRcdHRoaXMuc3Vic2NyaWJlKFwidGFibGUtbGF5b3V0XCIsIHRoaXMubGF5b3V0RWxlbWVudC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLXJlZHJhd1wiLCB0aGlzLnJlZHJhdy5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcInRhYmxlLWRlc3Ryb3lcIiwgdGhpcy50YWJsZURlc3Ryb3llZC5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHR0aGlzLnN1YnNjcmliZShcImVkaXQtZWRpdG9yLWNsZWFyXCIsIHRoaXMuZmluaXNoRWRpdGluZ0NlbGwuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJlZGl0LWJsdXJcIiwgdGhpcy5yZXN0b3JlRm9jdXMuYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJrZXliaW5kaW5nLW5hdi1wcmV2XCIsIHRoaXMua2V5TmF2aWdhdGUuYmluZCh0aGlzLCBcImxlZnRcIikpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwia2V5YmluZGluZy1uYXYtbmV4dFwiLCB0aGlzLmtleU5hdmlnYXRlLmJpbmQodGhpcywgXCJyaWdodFwiKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJrZXliaW5kaW5nLW5hdi1sZWZ0XCIsIHRoaXMua2V5TmF2aWdhdGUuYmluZCh0aGlzLCBcImxlZnRcIikpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwia2V5YmluZGluZy1uYXYtcmlnaHRcIiwgdGhpcy5rZXlOYXZpZ2F0ZS5iaW5kKHRoaXMsIFwicmlnaHRcIikpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwia2V5YmluZGluZy1uYXYtdXBcIiwgdGhpcy5rZXlOYXZpZ2F0ZS5iaW5kKHRoaXMsIFwidXBcIikpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwia2V5YmluZGluZy1uYXYtZG93blwiLCB0aGlzLmtleU5hdmlnYXRlLmJpbmQodGhpcywgXCJkb3duXCIpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImtleWJpbmRpbmctbmF2LXJhbmdlXCIsIHRoaXMua2V5TmF2aWdhdGVSYW5nZS5iaW5kKHRoaXMpKTtcblx0fVxuXHRcblx0XG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKSB7XG5cdFx0aWYodGhpcy5jb2x1bW5TZWxlY3Rpb24gJiYgY29sdW1uLmRlZmluaXRpb24uaGVhZGVyU29ydCAmJiB0aGlzLm9wdGlvbnMoXCJoZWFkZXJTb3J0Q2xpY2tFbGVtZW50XCIpICE9PSBcImljb25cIil7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJVc2luZyBjb2x1bW4gaGVhZGVyU29ydCB3aXRoIHNlbGVjdGFibGVSYW5nZUNvbHVtbnMgb3B0aW9uIG1heSByZXN1bHQgaW4gdW5wcmVkaWN0YWJsZSBiZWhhdmlvci4gQ29uc2lkZXIgdXNpbmcgaGVhZGVyU29ydENsaWNrRWxlbWVudDogJ2ljb24nLlwiKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmVkaXQpIDtcblx0fVxuXHRcblx0dXBkYXRlSGVhZGVyQ29sdW1uKCl7XG5cdFx0dmFyIGZyb3plbkNvbHM7XG5cblx0XHRpZih0aGlzLnJvd1NlbGVjdGlvbil7XG5cdFx0XHR0aGlzLnJvd0hlYWRlciA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRWaXNpYmxlQ29sdW1uc0J5SW5kZXgoKVswXTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy5yb3dIZWFkZXIpe1xuXHRcdFx0XHR0aGlzLnJvd0hlYWRlci5kZWZpbml0aW9uLmNzc0NsYXNzID0gdGhpcy5yb3dIZWFkZXIuZGVmaW5pdGlvbi5jc3NDbGFzcyArIFwiIHRhYnVsYXRvci1yYW5nZS1yb3ctaGVhZGVyXCI7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLnJvd0hlYWRlci5kZWZpbml0aW9uLmhlYWRlclNvcnQpe1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIlVzaW5nIGNvbHVtbiBoZWFkZXJTb3J0IHdpdGggc2VsZWN0YWJsZVJhbmdlUm93cyBvcHRpb24gbWF5IHJlc3VsdCBpbiB1bnByZWRpY3RhYmxlIGJlaGF2aW9yXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0aGlzLnJvd0hlYWRlci5kZWZpbml0aW9uLmVkaXRvcil7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiVXNpbmcgY29sdW1uIGVkaXRvciB3aXRoIHNlbGVjdGFibGVSYW5nZVJvd3Mgb3B0aW9uIG1heSByZXN1bHQgaW4gdW5wcmVkaWN0YWJsZSBiZWhhdmlvclwiKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vd2FybiBpZiBpbnZhbGlkIGZyb3plbiBjb2x1bW4gY29uZmlndXJhdGlvbiBkZXRlY3RlZFxuXHRcdGlmKHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zICYmIHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLmFjdGl2ZSl7XG5cdFx0XHRmcm96ZW5Db2xzID0gdGhpcy50YWJsZS5tb2R1bGVzLmZyb3plbkNvbHVtbnMuZ2V0RnJvemVuQ29sdW1ucygpO1xuXG5cdFx0XHRpZihmcm96ZW5Db2xzLmxlbmd0aCA+IDEgfHwgKGZyb3plbkNvbHMubGVuZ3RoID09PSAxICYmIGZyb3plbkNvbHNbMF0gIT09IHRoaXMucm93SGVhZGVyKSl7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIlVzaW5nIGZyb3plbiBjb2x1bW5zIHRoYXQgYXJlIG5vdCB0aGUgcmFuZ2UgaGVhZGVyIGluIGNvbWJpbmF0aW9uIHdpdGggdGhlIHNlbGVjdFJhbmdlIG9wdGlvbiBtYXkgcmVzdWx0IGluIHVucHJlZGljdGFibGUgYmVoYXZpb3JcIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vICAgVGFibGUgRnVuY3Rpb25zICAgLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0Z2V0UmFuZ2VzKCl7XG5cdFx0cmV0dXJuIHRoaXMucmFuZ2VzLm1hcCgocmFuZ2UpID0+IHJhbmdlLmdldENvbXBvbmVudCgpKTtcblx0fVxuXHRcblx0Z2V0UmFuZ2VzRGF0YSgpIHtcblx0XHRyZXR1cm4gdGhpcy5yYW5nZXMubWFwKChyYW5nZSkgPT4gcmFuZ2UuZ2V0RGF0YSgpKTtcblx0fVxuXHRcblx0YWRkUmFuZ2VGcm9tQ29tcG9uZW50KHN0YXJ0LCBlbmQpe1xuXHRcdHN0YXJ0ID0gc3RhcnQgPyBzdGFydC5fY2VsbCA6IG51bGw7XG5cdFx0ZW5kID0gZW5kID8gZW5kLl9jZWxsIDogbnVsbDtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5hZGRSYW5nZShzdGFydCwgZW5kKTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLyBDb21wb25lbnQgRnVuY3Rpb25zIC8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdGNlbGxHZXRSYW5nZXMoY2VsbCl7XG5cdFx0dmFyIHJhbmdlcyA9IFtdO1xuXHRcdFxuXHRcdGlmIChjZWxsLmNvbHVtbiA9PT0gdGhpcy5yb3dIZWFkZXIpIHtcblx0XHRcdHJhbmdlcyA9IHRoaXMucmFuZ2VzLmZpbHRlcigocmFuZ2UpID0+IHJhbmdlLm9jY3VwaWVzUm93KGNlbGwucm93KSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJhbmdlcyA9IHRoaXMucmFuZ2VzLmZpbHRlcigocmFuZ2UpID0+IHJhbmdlLm9jY3VwaWVzKGNlbGwpKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHJhbmdlcy5tYXAoKHJhbmdlKSA9PiByYW5nZS5nZXRDb21wb25lbnQoKSk7XG5cdH1cblx0XG5cdHJvd0dldFJhbmdlcyhyb3cpe1xuXHRcdHZhciByYW5nZXMgPSB0aGlzLnJhbmdlcy5maWx0ZXIoKHJhbmdlKSA9PiByYW5nZS5vY2N1cGllc1Jvdyhyb3cpKTtcblx0XHRcblx0XHRyZXR1cm4gcmFuZ2VzLm1hcCgocmFuZ2UpID0+IHJhbmdlLmdldENvbXBvbmVudCgpKTtcblx0fVxuXHRcblx0Y29sR2V0UmFuZ2VzKGNvbCl7XG5cdFx0dmFyIHJhbmdlcyA9IHRoaXMucmFuZ2VzLmZpbHRlcigocmFuZ2UpID0+IHJhbmdlLm9jY3VwaWVzQ29sdW1uKGNvbCkpO1xuXHRcdFxuXHRcdHJldHVybiByYW5nZXMubWFwKChyYW5nZSkgPT4gcmFuZ2UuZ2V0Q29tcG9uZW50KCkpO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vIEV2ZW50IEhhbmRsZXJzIC8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0X2hhbmRsZU1vdXNlVXAoZSl7XG5cdFx0dGhpcy5tb3VzZWRvd24gPSBmYWxzZTtcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLm1vdXNlVXBFdmVudCk7XG5cdH1cblx0XG5cdF9oYW5kbGVLZXlEb3duKGUpIHtcblx0XHRpZiAoIXRoaXMuYmxvY2tLZXlkb3duICYmICghdGhpcy50YWJsZS5tb2R1bGVzLmVkaXQgfHwgKHRoaXMudGFibGUubW9kdWxlcy5lZGl0ICYmICF0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbCkpKSB7XG5cdFx0XHRpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuXHRcdFx0XHQvLyBpcyBlZGl0aW5nIGEgY2VsbD9cblx0XHRcdFx0aWYgKHRoaXMudGFibGUubW9kdWxlcy5lZGl0ICYmIHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5lZGl0Q2VsbCh0aGlzLmdldEFjdGl2ZUNlbGwoKSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmICgoZS5rZXkgPT09IFwiQmFja3NwYWNlXCIgfHwgZS5rZXkgPT09IFwiRGVsZXRlXCIpICYmIHRoaXMub3B0aW9ucyhcInNlbGVjdGFibGVSYW5nZUNsZWFyQ2VsbHNcIikpIHtcblx0XHRcdFx0aWYodGhpcy5hY3RpdmVSYW5nZSl7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmVSYW5nZS5jbGVhclZhbHVlcygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRpbml0aWFsaXplRm9jdXMoY2VsbCl7XG5cdFx0dmFyIHJhbmdlO1xuXG5cdFx0dGhpcy5yZXN0b3JlRm9jdXMoKTtcblx0XHRcblx0XHR0cnl7XG5cdFx0XHRpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7IC8vIElFXG5cdFx0XHRcdHJhbmdlID0gZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTtcblx0XHRcdFx0cmFuZ2UubW92ZVRvRWxlbWVudFRleHQoY2VsbC5nZXRFbGVtZW50KCkpO1xuXHRcdFx0XHRyYW5nZS5zZWxlY3QoKTtcblx0XHRcdH0gZWxzZSBpZiAod2luZG93LmdldFNlbGVjdGlvbikge1xuXHRcdFx0XHRyYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG5cdFx0XHRcdHJhbmdlLnNlbGVjdE5vZGUoY2VsbC5nZXRFbGVtZW50KCkpO1xuXHRcdFx0XHR3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7XG5cdFx0XHRcdHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5hZGRSYW5nZShyYW5nZSk7XG5cdFx0XHR9XG5cdFx0fWNhdGNoKGUpe31cblx0fVxuXHRcblx0cmVzdG9yZUZvY3VzKGVsZW1lbnQpe1xuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LmZvY3VzKCk7XG5cdFx0XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLyBDb2x1bW4gRnVuY3Rpb25hbGl0eSAvLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRoYW5kbGVDb2x1bW5SZXNpemVkKGNvbHVtbikge1xuXHRcdHZhciBzZWxlY3RlZDtcblx0XHRcblx0XHRpZiAodGhpcy5zZWxlY3RpbmcgIT09IFwiY29sdW1uXCIgJiYgdGhpcy5zZWxlY3RpbmcgIT09IFwiYWxsXCIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0c2VsZWN0ZWQgPSB0aGlzLnJhbmdlcy5zb21lKChyYW5nZSkgPT4gcmFuZ2Uub2NjdXBpZXNDb2x1bW4oY29sdW1uKSk7XG5cdFx0XG5cdFx0aWYgKCFzZWxlY3RlZCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnJhbmdlcy5mb3JFYWNoKChyYW5nZSkgPT4ge1xuXHRcdFx0dmFyIHNlbGVjdGVkQ29sdW1ucyA9IHJhbmdlLmdldENvbHVtbnModHJ1ZSk7XG5cdFx0XHRcblx0XHRcdHNlbGVjdGVkQ29sdW1ucy5mb3JFYWNoKChzZWxlY3RlZENvbHVtbikgPT4ge1xuXHRcdFx0XHRpZiAoc2VsZWN0ZWRDb2x1bW4gIT09IGNvbHVtbikge1xuXHRcdFx0XHRcdHNlbGVjdGVkQ29sdW1uLnNldFdpZHRoKGNvbHVtbi53aWR0aCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRoYW5kbGVDb2x1bW5Nb3ZpbmcoX2V2ZW50LCBjb2x1bW4pIHtcblx0XHR0aGlzLnJlc2V0UmFuZ2VzKCkuc2V0Qm91bmRzKGNvbHVtbik7XG5cdFx0dGhpcy5vdmVybGF5LnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuXHR9XG5cblx0aGFuZGxlQ29sdW1uTW92ZWQoZnJvbSwgX3RvLCBfYWZ0ZXIpIHtcblx0XHR0aGlzLmFjdGl2ZVJhbmdlLnNldEJvdW5kcyhmcm9tKTtcblx0XHR0aGlzLmxheW91dEVsZW1lbnQoKTtcblx0fVxuXG5cdGhhbmRsZUNvbHVtbk1vdXNlRG93bihldmVudCwgY29sdW1uKSB7XG5cdFx0aWYgKGV2ZW50LmJ1dHRvbiA9PT0gMiAmJiAodGhpcy5zZWxlY3RpbmcgPT09IFwiY29sdW1uXCIgfHwgdGhpcy5zZWxlY3RpbmcgPT09IFwiYWxsXCIpICYmIHRoaXMuYWN0aXZlUmFuZ2Uub2NjdXBpZXNDb2x1bW4oY29sdW1uKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vSWYgY29sdW1ucyBhcmUgbW92YWJsZSwgYWxsb3cgZHJhZ2dpbmcgY29sdW1ucyBvbmx5IGlmIHRoZXkgYXJlIG5vdFxuXHRcdC8vc2VsZWN0ZWQuIERyYWdnaW5nIHNlbGVjdGVkIGNvbHVtbnMgc2hvdWxkIG1vdmUgdGhlIGNvbHVtbnMgaW5zdGVhZC5cblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZUNvbHVtbnMgJiYgdGhpcy5zZWxlY3RpbmcgPT09IFwiY29sdW1uXCIgJiYgdGhpcy5hY3RpdmVSYW5nZS5vY2N1cGllc0NvbHVtbihjb2x1bW4pKXtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5tb3VzZWRvd24gPSB0cnVlO1xuXHRcdFxuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMubW91c2VVcEV2ZW50KTtcblx0XHRcblx0XHR0aGlzLm5ld1NlbGVjdGlvbihldmVudCwgY29sdW1uKTtcblx0fVxuXHRcblx0aGFuZGxlQ29sdW1uTW91c2VNb3ZlKGUsIGNvbHVtbikge1xuXHRcdGlmIChjb2x1bW4gPT09IHRoaXMucm93SGVhZGVyIHx8ICF0aGlzLm1vdXNlZG93biB8fCB0aGlzLnNlbGVjdGluZyA9PT0gJ2FsbCcpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5hY3RpdmVSYW5nZS5zZXRCb3VuZHMoZmFsc2UsIGNvbHVtbiwgdHJ1ZSk7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vIENlbGwgRnVuY3Rpb25hbGl0eSAvLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRyZW5kZXJDZWxsKGNlbGwpIHtcblx0XHR2YXIgZWwgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0XHRyYW5nZUlkeCA9IHRoaXMucmFuZ2VzLmZpbmRJbmRleCgocmFuZ2UpID0+IHJhbmdlLm9jY3VwaWVzKGNlbGwpKTtcblx0XHRcblx0XHRlbC5jbGFzc0xpc3QudG9nZ2xlKFwidGFidWxhdG9yLXJhbmdlLXNlbGVjdGVkXCIsIHJhbmdlSWR4ICE9PSAtMSk7XG5cdFx0ZWwuY2xhc3NMaXN0LnRvZ2dsZShcInRhYnVsYXRvci1yYW5nZS1vbmx5LWNlbGwtc2VsZWN0ZWRcIiwgdGhpcy5yYW5nZXMubGVuZ3RoID09PSAxICYmIHRoaXMucmFuZ2VzWzBdLmF0VG9wTGVmdChjZWxsKSAmJlx0dGhpcy5yYW5nZXNbMF0uYXRCb3R0b21SaWdodChjZWxsKSk7XG5cdFx0XG5cdFx0ZWwuZGF0YXNldC5yYW5nZSA9IHJhbmdlSWR4O1xuXHR9XG5cdFxuXHRoYW5kbGVDZWxsTW91c2VEb3duKGV2ZW50LCBjZWxsKSB7XG5cdFx0aWYgKGV2ZW50LmJ1dHRvbiA9PT0gMiAmJiAodGhpcy5hY3RpdmVSYW5nZS5vY2N1cGllcyhjZWxsKSB8fCAoKHRoaXMuc2VsZWN0aW5nID09PSBcInJvd1wiIHx8IHRoaXMuc2VsZWN0aW5nID09PSBcImFsbFwiKSAmJiB0aGlzLmFjdGl2ZVJhbmdlLm9jY3VwaWVzUm93KGNlbGwucm93KSkpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMubW91c2Vkb3duID0gdHJ1ZTtcblx0XHRcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLm1vdXNlVXBFdmVudCk7XG5cdFx0XG5cdFx0dGhpcy5uZXdTZWxlY3Rpb24oZXZlbnQsIGNlbGwpO1xuXHR9XG5cdFxuXHRoYW5kbGVDZWxsTW91c2VNb3ZlKGUsIGNlbGwpIHtcblx0XHRpZiAoIXRoaXMubW91c2Vkb3duIHx8IHRoaXMuc2VsZWN0aW5nID09PSBcImFsbFwiKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuYWN0aXZlUmFuZ2Uuc2V0Qm91bmRzKGZhbHNlLCBjZWxsLCB0cnVlKTtcblx0fVxuXHRcblx0aGFuZGxlQ2VsbENsaWNrKGUsIGNlbGwpe1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUZvY3VzKGNlbGwpO1xuXHR9XG5cdFxuXHRoYW5kbGVFZGl0aW5nQ2VsbChjZWxsKSB7XG5cdFx0aWYodGhpcy5hY3RpdmVSYW5nZSl7XG5cdFx0XHR0aGlzLmFjdGl2ZVJhbmdlLnNldEJvdW5kcyhjZWxsKTtcblx0XHR9XG5cdH1cblx0XG5cdGZpbmlzaEVkaXRpbmdDZWxsKCkge1xuXHRcdHRoaXMuYmxvY2tLZXlkb3duID0gdHJ1ZTtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5mb2N1cygpO1xuXHRcdFxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5ibG9ja0tleWRvd24gPSBmYWxzZTtcblx0XHR9LCAxMCk7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8gICAgIE5hdmlnYXRpb24gICAgICAvLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRrZXlOYXZpZ2F0ZShkaXIsIGUpe1xuXHRcdGlmKHRoaXMubmF2aWdhdGUoZmFsc2UsIGZhbHNlLCBkaXIpKTtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdH1cblx0XG5cdGtleU5hdmlnYXRlUmFuZ2UoZSwgZGlyLCBqdW1wLCBleHBhbmQpe1xuXHRcdGlmKHRoaXMubmF2aWdhdGUoanVtcCwgZXhwYW5kLCBkaXIpKTtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdH1cblx0XG5cdG5hdmlnYXRlKGp1bXAsIGV4cGFuZCwgZGlyKSB7XG5cdFx0dmFyIG1vdmVkID0gZmFsc2UsXG5cdFx0cmFuZ2UsIHJhbmdlRWRnZSwgcHJldlJlY3QsIG5leHRSb3csIG5leHRDb2wsIHJvdywgY29sdW1uLFxuXHRcdHJvd1JlY3QsIHJvd01hbmFnZXJSZWN0LCBjb2x1bW5SZWN0LCBjb2x1bW5NYW5hZ2VyUmVjdDtcblx0XHRcblx0XHQvLyBEb24ndCBuYXZpZ2F0ZSB3aGlsZSBlZGl0aW5nXG5cdFx0aWYgKHRoaXMudGFibGUubW9kdWxlcy5lZGl0ICYmIHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIElmIHRoZXJlIGFyZSBtb3JlIHRoYW4gMSByYW5nZSwgdXNlIHRoZSBhY3RpdmUgcmFuZ2UgYW5kIGRlc3Ryb3kgdGhlIG90aGVyc1xuXHRcdGlmICh0aGlzLnJhbmdlcy5sZW5ndGggPiAxKSB7XG5cdFx0XHR0aGlzLnJhbmdlcyA9IHRoaXMucmFuZ2VzLmZpbHRlcigocmFuZ2UpID0+IHtcblx0XHRcdFx0aWYgKHJhbmdlID09PSB0aGlzLmFjdGl2ZVJhbmdlKSB7XG5cdFx0XHRcdFx0cmFuZ2Uuc2V0RW5kKHJhbmdlLnN0YXJ0LnJvdywgcmFuZ2Uuc3RhcnQuY29sKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyYW5nZS5kZXN0cm95KCk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0XHRyYW5nZSA9IHRoaXMuYWN0aXZlUmFuZ2U7XG5cdFx0cHJldlJlY3QgPSB7XG5cdFx0XHR0b3A6IHJhbmdlLnRvcCxcblx0XHRcdGJvdHRvbTogcmFuZ2UuYm90dG9tLFxuXHRcdFx0bGVmdDogcmFuZ2UubGVmdCxcblx0XHRcdHJpZ2h0OiByYW5nZS5yaWdodFxuXHRcdH07XG5cdFx0XG5cdFx0cmFuZ2VFZGdlID0gZXhwYW5kID8gcmFuZ2UuZW5kIDogcmFuZ2Uuc3RhcnQ7XG5cdFx0bmV4dFJvdyA9IHJhbmdlRWRnZS5yb3c7XG5cdFx0bmV4dENvbCA9IHJhbmdlRWRnZS5jb2w7XG5cdFx0XG5cdFx0aWYoanVtcCl7XG5cdFx0XHRzd2l0Y2goZGlyKXtcblx0XHRcdFx0Y2FzZSBcImxlZnRcIjpcblx0XHRcdFx0XHRuZXh0Q29sID0gdGhpcy5maW5kSnVtcENlbGxMZWZ0KHJhbmdlLnN0YXJ0LnJvdywgcmFuZ2VFZGdlLmNvbCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJyaWdodFwiOlxuXHRcdFx0XHRcdG5leHRDb2wgPSB0aGlzLmZpbmRKdW1wQ2VsbFJpZ2h0KHJhbmdlLnN0YXJ0LnJvdywgcmFuZ2VFZGdlLmNvbCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJ1cFwiOlxuXHRcdFx0XHRcdG5leHRSb3cgPSB0aGlzLmZpbmRKdW1wQ2VsbFVwKHJhbmdlRWRnZS5yb3csIHJhbmdlLnN0YXJ0LmNvbCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJkb3duXCI6XG5cdFx0XHRcdFx0bmV4dFJvdyA9IHRoaXMuZmluZEp1bXBDZWxsRG93bihyYW5nZUVkZ2Uucm93LCByYW5nZS5zdGFydC5jb2wpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGlmKGV4cGFuZCl7XG5cdFx0XHRcdGlmICgodGhpcy5zZWxlY3RpbmcgPT09ICdyb3cnICYmIChkaXIgPT09ICdsZWZ0JyB8fCBkaXIgPT09ICdyaWdodCcpKSB8fCAodGhpcy5zZWxlY3RpbmcgPT09ICdjb2x1bW4nICYmIChkaXIgPT09ICd1cCcgfHwgZGlyID09PSAnZG93bicpKSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRzd2l0Y2goZGlyKXtcblx0XHRcdFx0Y2FzZSBcImxlZnRcIjpcblx0XHRcdFx0XHRuZXh0Q29sID0gTWF0aC5tYXgobmV4dENvbCAtIDEsIDApO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwicmlnaHRcIjpcblx0XHRcdFx0XHRuZXh0Q29sID0gTWF0aC5taW4obmV4dENvbCArIDEsIHRoaXMuZ2V0VGFibGVDb2x1bW5zKCkubGVuZ3RoIC0gMSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJ1cFwiOlxuXHRcdFx0XHRcdG5leHRSb3cgPSBNYXRoLm1heChuZXh0Um93IC0gMSwgMCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJkb3duXCI6XG5cdFx0XHRcdFx0bmV4dFJvdyA9IE1hdGgubWluKG5leHRSb3cgKyAxLCB0aGlzLmdldFRhYmxlUm93cygpLmxlbmd0aCAtIDEpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmKHRoaXMucm93SGVhZGVyICYmIG5leHRDb2wgPT09IDApIHtcblx0XHRcdG5leHRDb2wgPSAxO1xuXHRcdH1cblx0XHRcblx0XHRpZighZXhwYW5kKXtcblx0XHRcdHJhbmdlLnNldFN0YXJ0KG5leHRSb3csIG5leHRDb2wpO1xuXHRcdH1cblx0XHRcblx0XHRyYW5nZS5zZXRFbmQobmV4dFJvdywgbmV4dENvbCk7XG5cdFx0XG5cdFx0aWYoIWV4cGFuZCl7XG5cdFx0XHR0aGlzLnNlbGVjdGluZyA9IFwiY2VsbFwiO1xuXHRcdH1cblxuXHRcdG1vdmVkID0gcHJldlJlY3QudG9wICE9PSByYW5nZS50b3AgfHwgcHJldlJlY3QuYm90dG9tICE9PSByYW5nZS5ib3R0b20gfHwgcHJldlJlY3QubGVmdCAhPT0gcmFuZ2UubGVmdCB8fCBwcmV2UmVjdC5yaWdodCAhPT0gcmFuZ2UucmlnaHQ7XG5cblx0XHRpZiAobW92ZWQpIHtcblx0XHRcdHJvdyA9IHRoaXMuZ2V0Um93QnlSYW5nZVBvcyhyYW5nZS5lbmQucm93KTtcblx0XHRcdGNvbHVtbiA9IHRoaXMuZ2V0Q29sdW1uQnlSYW5nZVBvcyhyYW5nZS5lbmQuY29sKTtcblx0XHRcdHJvd1JlY3QgPSByb3cuZ2V0RWxlbWVudCgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0Y29sdW1uUmVjdCA9IGNvbHVtbi5nZXRFbGVtZW50KCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRyb3dNYW5hZ2VyUmVjdCA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRFbGVtZW50KCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRjb2x1bW5NYW5hZ2VyUmVjdCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRFbGVtZW50KCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRcblx0XHRcdGlmKCEocm93UmVjdC50b3AgPj0gcm93TWFuYWdlclJlY3QudG9wICYmIHJvd1JlY3QuYm90dG9tIDw9IHJvd01hbmFnZXJSZWN0LmJvdHRvbSkpe1xuXHRcdFx0XHRpZihyb3cuZ2V0RWxlbWVudCgpLnBhcmVudE5vZGUgJiYgY29sdW1uLmdldEVsZW1lbnQoKS5wYXJlbnROb2RlKXtcblx0XHRcdFx0XHQvLyBVc2UgZmFzdGVyIGF1dG9TY3JvbGwgd2hlbiB0aGUgZWxlbWVudHMgYXJlIG9uIHRoZSBET01cblx0XHRcdFx0XHR0aGlzLmF1dG9TY3JvbGwocmFuZ2UsIHJvdy5nZXRFbGVtZW50KCksIGNvbHVtbi5nZXRFbGVtZW50KCkpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0cm93LmdldENvbXBvbmVudCgpLnNjcm9sbFRvKHVuZGVmaW5lZCwgZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmKCEoY29sdW1uUmVjdC5sZWZ0ID49IGNvbHVtbk1hbmFnZXJSZWN0LmxlZnQgKyB0aGlzLmdldFJvd0hlYWRlcldpZHRoKCkgJiYgY29sdW1uUmVjdC5yaWdodCA8PSBjb2x1bW5NYW5hZ2VyUmVjdC5yaWdodCkpe1xuXHRcdFx0XHRpZihyb3cuZ2V0RWxlbWVudCgpLnBhcmVudE5vZGUgJiYgY29sdW1uLmdldEVsZW1lbnQoKS5wYXJlbnROb2RlKXtcblx0XHRcdFx0XHQvLyBVc2UgZmFzdGVyIGF1dG9TY3JvbGwgd2hlbiB0aGUgZWxlbWVudHMgYXJlIG9uIHRoZSBET01cblx0XHRcdFx0XHR0aGlzLmF1dG9TY3JvbGwocmFuZ2UsIHJvdy5nZXRFbGVtZW50KCksIGNvbHVtbi5nZXRFbGVtZW50KCkpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0Y29sdW1uLmdldENvbXBvbmVudCgpLnNjcm9sbFRvKHVuZGVmaW5lZCwgZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMubGF5b3V0RWxlbWVudCgpO1xuXHRcdFx0XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0XG5cdHJhbmdlUmVtb3ZlZChyZW1vdmVkKXtcblx0XHR0aGlzLnJhbmdlcyA9IHRoaXMucmFuZ2VzLmZpbHRlcigocmFuZ2UpID0+IHJhbmdlICE9PSByZW1vdmVkKTtcblx0XHRcblx0XHRpZih0aGlzLmFjdGl2ZVJhbmdlID09PSByZW1vdmVkKXtcblx0XHRcdGlmKHRoaXMucmFuZ2VzLmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMuYWN0aXZlUmFuZ2UgPSB0aGlzLnJhbmdlc1t0aGlzLnJhbmdlcy5sZW5ndGggLSAxXTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5hZGRSYW5nZSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0aGlzLmxheW91dEVsZW1lbnQoKTtcblx0fVxuXHRcblx0ZmluZEp1bXBSb3coY29sdW1uLCByb3dzLCByZXZlcnNlLCBlbXB0eVN0YXJ0LCBlbXB0eVNpZGUpe1xuXHRcdGlmKHJldmVyc2Upe1xuXHRcdFx0cm93cyA9IHJvd3MucmV2ZXJzZSgpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmZpbmRKdW1wSXRlbShlbXB0eVN0YXJ0LCBlbXB0eVNpZGUsIHJvd3MsIGZ1bmN0aW9uKHJvdyl7cmV0dXJuIHJvdy5nZXREYXRhKClbY29sdW1uLmdldEZpZWxkKCldO30pO1xuXHR9XG5cdFxuXHRmaW5kSnVtcENvbChyb3csIGNvbHVtbnMsIHJldmVyc2UsIGVtcHR5U3RhcnQsIGVtcHR5U2lkZSl7XG5cdFx0aWYocmV2ZXJzZSl7XG5cdFx0XHRjb2x1bW5zID0gY29sdW1ucy5yZXZlcnNlKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuZmluZEp1bXBJdGVtKGVtcHR5U3RhcnQsIGVtcHR5U2lkZSwgY29sdW1ucywgZnVuY3Rpb24oY29sdW1uKXtyZXR1cm4gcm93LmdldERhdGEoKVtjb2x1bW4uZ2V0RmllbGQoKV07fSk7XG5cdH1cblxuXHRmaW5kSnVtcEl0ZW0oZW1wdHlTdGFydCwgZW1wdHlTaWRlLCBpdGVtcywgdmFsdWVSZXNvbHZlcil7XG5cdFx0dmFyIG5leHRJdGVtO1xuXG5cdFx0Zm9yKGxldCBjdXJyZW50SXRlbSBvZiBpdGVtcyl7XG5cdFx0XHRsZXQgY3VycmVudFZhbHVlID0gdmFsdWVSZXNvbHZlcihjdXJyZW50SXRlbSk7XG5cdFx0XHRcblx0XHRcdGlmKGVtcHR5U3RhcnQpe1xuXHRcdFx0XHRuZXh0SXRlbSA9IGN1cnJlbnRJdGVtO1xuXHRcdFx0XHRpZihjdXJyZW50VmFsdWUpe1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKGVtcHR5U2lkZSl7XG5cdFx0XHRcdFx0bmV4dEl0ZW0gPSBjdXJyZW50SXRlbTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihjdXJyZW50VmFsdWUpe1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0aWYoY3VycmVudFZhbHVlKXtcblx0XHRcdFx0XHRcdG5leHRJdGVtID0gY3VycmVudEl0ZW07XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG5leHRJdGVtO1xuXHR9XG5cblx0ZmluZEp1bXBDZWxsTGVmdChyb3dQb3MsIGNvbFBvcyl7XG5cdFx0dmFyIHJvdyA9IHRoaXMuZ2V0Um93QnlSYW5nZVBvcyhyb3dQb3MpLFxuXHRcdGNvbHVtbnMgPSB0aGlzLmdldFRhYmxlQ29sdW1ucygpLFxuXHRcdGlzU3RhcnRpbmdDZWxsRW1wdHkgPSB0aGlzLmlzRW1wdHkocm93LmdldERhdGEoKVtjb2x1bW5zW2NvbFBvc10uZ2V0RmllbGQoKV0pLFxuXHRcdGlzTGVmdE9mU3RhcnRpbmdDZWxsRW1wdHkgPSBjb2x1bW5zW2NvbFBvcyAtIDFdID8gdGhpcy5pc0VtcHR5KHJvdy5nZXREYXRhKClbY29sdW1uc1tjb2xQb3MgLSAxXS5nZXRGaWVsZCgpXSkgOiBmYWxzZSxcblx0XHR0YXJnZXRDb2xzID0gdGhpcy5yb3dIZWFkZXIgPyBjb2x1bW5zLnNsaWNlKDEsIGNvbFBvcykgOiBjb2x1bW5zLnNsaWNlKDAsIGNvbFBvcyksXG5cdFx0anVtcENvbCA9IHRoaXMuZmluZEp1bXBDb2wocm93LCB0YXJnZXRDb2xzLCB0cnVlLCBpc1N0YXJ0aW5nQ2VsbEVtcHR5LCBpc0xlZnRPZlN0YXJ0aW5nQ2VsbEVtcHR5KTtcblx0XHRcblx0XHRpZihqdW1wQ29sKXtcblx0XHRcdHJldHVybiBqdW1wQ29sLmdldFBvc2l0aW9uKCkgLSAxO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gY29sUG9zO1xuXHR9XG5cdFxuXHRmaW5kSnVtcENlbGxSaWdodChyb3dQb3MsIGNvbFBvcyl7XG5cdFx0dmFyIHJvdyA9IHRoaXMuZ2V0Um93QnlSYW5nZVBvcyhyb3dQb3MpLFxuXHRcdGNvbHVtbnMgPSB0aGlzLmdldFRhYmxlQ29sdW1ucygpLFxuXHRcdGlzU3RhcnRpbmdDZWxsRW1wdHkgPSB0aGlzLmlzRW1wdHkocm93LmdldERhdGEoKVtjb2x1bW5zW2NvbFBvc10uZ2V0RmllbGQoKV0pLFxuXHRcdGlzUmlnaHRPZlN0YXJ0aW5nQ2VsbEVtcHR5ID0gY29sdW1uc1tjb2xQb3MgKyAxXSA/IHRoaXMuaXNFbXB0eShyb3cuZ2V0RGF0YSgpW2NvbHVtbnNbY29sUG9zICsgMV0uZ2V0RmllbGQoKV0pIDogZmFsc2UsXG5cdFx0anVtcENvbCA9IHRoaXMuZmluZEp1bXBDb2wocm93LCBjb2x1bW5zLnNsaWNlKGNvbFBvcyArIDEsIGNvbHVtbnMubGVuZ3RoKSwgZmFsc2UsIGlzU3RhcnRpbmdDZWxsRW1wdHksIGlzUmlnaHRPZlN0YXJ0aW5nQ2VsbEVtcHR5KTtcblx0XHRcblx0XHRpZihqdW1wQ29sKXtcblx0XHRcdHJldHVybiBqdW1wQ29sLmdldFBvc2l0aW9uKCkgLSAxO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gY29sUG9zO1xuXHR9XG5cdFxuXHRmaW5kSnVtcENlbGxVcChyb3dQb3MsIGNvbFBvcykge1xuXHRcdHZhciBjb2x1bW4gPSB0aGlzLmdldENvbHVtbkJ5UmFuZ2VQb3MoY29sUG9zKSxcblx0XHRyb3dzID0gdGhpcy5nZXRUYWJsZVJvd3MoKSxcblx0XHRpc1N0YXJ0aW5nQ2VsbEVtcHR5ID0gdGhpcy5pc0VtcHR5KHJvd3Nbcm93UG9zXS5nZXREYXRhKClbY29sdW1uLmdldEZpZWxkKCldKSxcblx0XHRpc1RvcE9mU3RhcnRpbmdDZWxsRW1wdHkgPSByb3dzW3Jvd1BvcyAtIDFdID8gdGhpcy5pc0VtcHR5KHJvd3Nbcm93UG9zIC0gMV0uZ2V0RGF0YSgpW2NvbHVtbi5nZXRGaWVsZCgpXSkgOiBmYWxzZSxcblx0XHRqdW1wUm93ID0gdGhpcy5maW5kSnVtcFJvdyhjb2x1bW4sIHJvd3Muc2xpY2UoMCwgcm93UG9zKSwgdHJ1ZSwgaXNTdGFydGluZ0NlbGxFbXB0eSwgaXNUb3BPZlN0YXJ0aW5nQ2VsbEVtcHR5KTtcblx0XHRcblx0XHRpZihqdW1wUm93KXtcblx0XHRcdHJldHVybiBqdW1wUm93LnBvc2l0aW9uIC0gMTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHJvd1Bvcztcblx0fVxuXHRcblx0ZmluZEp1bXBDZWxsRG93bihyb3dQb3MsIGNvbFBvcykge1xuXHRcdHZhciBjb2x1bW4gPSB0aGlzLmdldENvbHVtbkJ5UmFuZ2VQb3MoY29sUG9zKSxcblx0XHRyb3dzID0gdGhpcy5nZXRUYWJsZVJvd3MoKSxcblx0XHRpc1N0YXJ0aW5nQ2VsbEVtcHR5ID0gdGhpcy5pc0VtcHR5KHJvd3Nbcm93UG9zXS5nZXREYXRhKClbY29sdW1uLmdldEZpZWxkKCldKSxcblx0XHRpc0JvdHRvbU9mU3RhcnRpbmdDZWxsRW1wdHkgPSByb3dzW3Jvd1BvcyArIDFdID8gdGhpcy5pc0VtcHR5KHJvd3Nbcm93UG9zICsgMV0uZ2V0RGF0YSgpW2NvbHVtbi5nZXRGaWVsZCgpXSkgOiBmYWxzZSxcblx0XHRqdW1wUm93ID0gdGhpcy5maW5kSnVtcFJvdyhjb2x1bW4sIHJvd3Muc2xpY2Uocm93UG9zICsgMSwgcm93cy5sZW5ndGgpLCBmYWxzZSwgaXNTdGFydGluZ0NlbGxFbXB0eSwgaXNCb3R0b21PZlN0YXJ0aW5nQ2VsbEVtcHR5KTtcblx0XHRcblx0XHRpZihqdW1wUm93KXtcblx0XHRcdHJldHVybiBqdW1wUm93LnBvc2l0aW9uIC0gMTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHJvd1Bvcztcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLyAgICAgIFNlbGVjdGlvbiAgICAgIC8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0bmV3U2VsZWN0aW9uKGV2ZW50LCBlbGVtZW50KSB7XG5cdFx0dmFyIHJhbmdlO1xuXHRcdFxuXHRcdGlmIChlbGVtZW50LnR5cGUgPT09IFwiY29sdW1uXCIpIHtcblx0XHRcdGlmKCF0aGlzLmNvbHVtblNlbGVjdGlvbil7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKGVsZW1lbnQgPT09IHRoaXMucm93SGVhZGVyKSB7XG5cdFx0XHRcdHJhbmdlID0gdGhpcy5yZXNldFJhbmdlcygpO1xuXHRcdFx0XHR0aGlzLnNlbGVjdGluZyA9IFwiYWxsXCI7XG5cdFx0XHRcdFxuXHRcdFx0XHR2YXIgdG9wTGVmdENlbGwsIGJvdHRvbVJpZ2h0Q2VsbCA9IHRoaXMuZ2V0Q2VsbCgtMSwgLTEpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodGhpcy5yb3dIZWFkZXIpe1xuXHRcdFx0XHRcdHRvcExlZnRDZWxsID0gdGhpcy5nZXRDZWxsKDAsIDEpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0dG9wTGVmdENlbGwgPSB0aGlzLmdldENlbGwoMCwgMCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHJhbmdlLnNldEJvdW5kcyh0b3BMZWZ0Q2VsbCwgYm90dG9tUmlnaHRDZWxsKTtcdFx0XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuc2VsZWN0aW5nID0gXCJjb2x1bW5cIjtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKGVsZW1lbnQuY29sdW1uID09PSB0aGlzLnJvd0hlYWRlcikge1xuXHRcdFx0dGhpcy5zZWxlY3RpbmcgPSBcInJvd1wiO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnNlbGVjdGluZyA9IFwiY2VsbFwiO1xuXHRcdH1cblx0XHRcblx0XHRpZiAoZXZlbnQuc2hpZnRLZXkpIHtcblx0XHRcdHRoaXMuYWN0aXZlUmFuZ2Uuc2V0Qm91bmRzKGZhbHNlLCBlbGVtZW50KTtcblx0XHR9IGVsc2UgaWYgKGV2ZW50LmN0cmxLZXkpIHtcblx0XHRcdHRoaXMuYWRkUmFuZ2UoKS5zZXRCb3VuZHMoZWxlbWVudCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucmVzZXRSYW5nZXMoKS5zZXRCb3VuZHMoZWxlbWVudCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRhdXRvU2Nyb2xsKHJhbmdlLCByb3csIGNvbHVtbikge1xuXHRcdHZhciB0YWJsZUhvbGRlciA9IHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LFxuXHRcdHJlY3QsIHZpZXcsIHdpdGhpbkhvcml6b250YWxWaWV3LCB3aXRoaW5WZXJ0aWNhbFZpZXc7XG5cdFx0XG5cdFx0aWYgKHR5cGVvZiByb3cgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyb3cgPSB0aGlzLmdldFJvd0J5UmFuZ2VQb3MocmFuZ2UuZW5kLnJvdykuZ2V0RWxlbWVudCgpO1xuXHRcdH1cblx0XHRcblx0XHRpZiAodHlwZW9mIGNvbHVtbiA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdGNvbHVtbiA9IHRoaXMuZ2V0Q29sdW1uQnlSYW5nZVBvcyhyYW5nZS5lbmQuY29sKS5nZXRFbGVtZW50KCk7XG5cdFx0fVxuXHRcdFxuXHRcdHJlY3QgPSB7XG5cdFx0XHRsZWZ0OiBjb2x1bW4ub2Zmc2V0TGVmdCxcblx0XHRcdHJpZ2h0OiBjb2x1bW4ub2Zmc2V0TGVmdCArIGNvbHVtbi5vZmZzZXRXaWR0aCxcblx0XHRcdHRvcDogcm93Lm9mZnNldFRvcCxcblx0XHRcdGJvdHRvbTogcm93Lm9mZnNldFRvcCArIHJvdy5vZmZzZXRIZWlnaHQsXG5cdFx0fTtcblx0XHRcblx0XHR2aWV3ID0ge1xuXHRcdFx0bGVmdDogdGFibGVIb2xkZXIuc2Nyb2xsTGVmdCArIHRoaXMuZ2V0Um93SGVhZGVyV2lkdGgoKSxcblx0XHRcdHJpZ2h0OiBNYXRoLmNlaWwodGFibGVIb2xkZXIuc2Nyb2xsTGVmdCArIHRhYmxlSG9sZGVyLmNsaWVudFdpZHRoKSxcblx0XHRcdHRvcDogdGFibGVIb2xkZXIuc2Nyb2xsVG9wLFxuXHRcdFx0Ym90dG9tOlx0dGFibGVIb2xkZXIuc2Nyb2xsVG9wICtcdHRhYmxlSG9sZGVyLm9mZnNldEhlaWdodCAtIHRoaXMudGFibGUucm93TWFuYWdlci5zY3JvbGxiYXJXaWR0aCxcblx0XHR9O1xuXHRcdFxuXHRcdHdpdGhpbkhvcml6b250YWxWaWV3ID0gdmlldy5sZWZ0IDwgcmVjdC5sZWZ0ICYmXHRyZWN0LmxlZnQgPCB2aWV3LnJpZ2h0ICYmIHZpZXcubGVmdCA8IHJlY3QucmlnaHQgJiZcdHJlY3QucmlnaHQgPCB2aWV3LnJpZ2h0O1xuXHRcdFxuXHRcdHdpdGhpblZlcnRpY2FsVmlldyA9IHZpZXcudG9wIDwgcmVjdC50b3AgJiZcdHJlY3QudG9wIDwgdmlldy5ib3R0b20gJiYgdmlldy50b3AgPCByZWN0LmJvdHRvbSAmJlx0cmVjdC5ib3R0b20gPCB2aWV3LmJvdHRvbTtcblx0XHRcblx0XHRpZiAoIXdpdGhpbkhvcml6b250YWxWaWV3KSB7XG5cdFx0XHRpZiAocmVjdC5sZWZ0IDwgdmlldy5sZWZ0KSB7XG5cdFx0XHRcdHRhYmxlSG9sZGVyLnNjcm9sbExlZnQgPSByZWN0LmxlZnQgLSB0aGlzLmdldFJvd0hlYWRlcldpZHRoKCk7XG5cdFx0XHR9IGVsc2UgaWYgKHJlY3QucmlnaHQgPiB2aWV3LnJpZ2h0KSB7XG5cdFx0XHRcdHRhYmxlSG9sZGVyLnNjcm9sbExlZnQgPSBNYXRoLm1pbihyZWN0LnJpZ2h0IC0gdGFibGVIb2xkZXIuY2xpZW50V2lkdGgsIHJlY3QubGVmdCAtIHRoaXMuZ2V0Um93SGVhZGVyV2lkdGgoKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmICghd2l0aGluVmVydGljYWxWaWV3KSB7XG5cdFx0XHRpZiAocmVjdC50b3AgPCB2aWV3LnRvcCkge1xuXHRcdFx0XHR0YWJsZUhvbGRlci5zY3JvbGxUb3AgPSByZWN0LnRvcDtcblx0XHRcdH0gZWxzZSBpZiAocmVjdC5ib3R0b20gPiB2aWV3LmJvdHRvbSkge1xuXHRcdFx0XHR0YWJsZUhvbGRlci5zY3JvbGxUb3AgPSByZWN0LmJvdHRvbSAtIHRhYmxlSG9sZGVyLmNsaWVudEhlaWdodDtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vICAgICAgIExheW91dCAgICAgICAgLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0bGF5b3V0Q2hhbmdlKCl7XG5cdFx0dGhpcy5vdmVybGF5LnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuXHRcdGNsZWFyVGltZW91dCh0aGlzLmxheW91dENoYW5nZVRpbWVvdXQpO1xuXHRcdHRoaXMubGF5b3V0Q2hhbmdlVGltZW91dCA9IHNldFRpbWVvdXQodGhpcy5sYXlvdXRSYW5nZXMuYmluZCh0aGlzKSwgMjAwKTtcblx0fVxuXHRcblx0cmVkcmF3KGZvcmNlKSB7XG5cdFx0aWYgKGZvcmNlKSB7XG5cdFx0XHR0aGlzLnNlbGVjdGluZyA9ICdjZWxsJztcblx0XHRcdHRoaXMucmVzZXRSYW5nZXMoKTtcblx0XHRcdHRoaXMubGF5b3V0RWxlbWVudCgpO1xuXHRcdH1cblx0fVxuXHRcblx0bGF5b3V0RWxlbWVudCh2aXNpYmxlUm93cykge1xuXHRcdHZhciByb3dzO1xuXHRcdFxuXHRcdGlmICh2aXNpYmxlUm93cykge1xuXHRcdFx0cm93cyA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRWaXNpYmxlUm93cyh0cnVlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cm93cyA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRSb3dzKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRpZiAocm93LnR5cGUgPT09IFwicm93XCIpIHtcblx0XHRcdFx0dGhpcy5sYXlvdXRSb3cocm93KTtcblx0XHRcdFx0cm93LmNlbGxzLmZvckVhY2goKGNlbGwpID0+IHRoaXMucmVuZGVyQ2VsbChjZWxsKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0dGhpcy5nZXRUYWJsZUNvbHVtbnMoKS5mb3JFYWNoKChjb2x1bW4pID0+IHtcblx0XHRcdHRoaXMubGF5b3V0Q29sdW1uKGNvbHVtbik7XG5cdFx0fSk7XG5cdFx0XG5cdFx0dGhpcy5sYXlvdXRSYW5nZXMoKTtcblx0fVxuXHRcblx0bGF5b3V0Um93KHJvdykge1xuXHRcdHZhciBlbCA9IHJvdy5nZXRFbGVtZW50KCksXG5cdFx0c2VsZWN0ZWQgPSBmYWxzZSxcblx0XHRvY2N1cGllZCA9IHRoaXMucmFuZ2VzLnNvbWUoKHJhbmdlKSA9PiByYW5nZS5vY2N1cGllc1Jvdyhyb3cpKTtcblx0XHRcblx0XHRpZiAodGhpcy5zZWxlY3RpbmcgPT09IFwicm93XCIpIHtcblx0XHRcdHNlbGVjdGVkID0gb2NjdXBpZWQ7XG5cdFx0fSBlbHNlIGlmICh0aGlzLnNlbGVjdGluZyA9PT0gXCJhbGxcIikge1xuXHRcdFx0c2VsZWN0ZWQgPSB0cnVlO1xuXHRcdH1cblx0XHRcblx0XHRlbC5jbGFzc0xpc3QudG9nZ2xlKFwidGFidWxhdG9yLXJhbmdlLXNlbGVjdGVkXCIsIHNlbGVjdGVkKTtcblx0XHRlbC5jbGFzc0xpc3QudG9nZ2xlKFwidGFidWxhdG9yLXJhbmdlLWhpZ2hsaWdodFwiLCBvY2N1cGllZCk7XG5cdH1cblx0XG5cdGxheW91dENvbHVtbihjb2x1bW4pIHtcblx0XHR2YXIgZWwgPSBjb2x1bW4uZ2V0RWxlbWVudCgpLFx0XHRcblx0XHRzZWxlY3RlZCA9IGZhbHNlLFxuXHRcdG9jY3VwaWVkID0gdGhpcy5yYW5nZXMuc29tZSgocmFuZ2UpID0+IHJhbmdlLm9jY3VwaWVzQ29sdW1uKGNvbHVtbikpO1xuXHRcdFxuXHRcdGlmICh0aGlzLnNlbGVjdGluZyA9PT0gXCJjb2x1bW5cIikge1xuXHRcdFx0c2VsZWN0ZWQgPSBvY2N1cGllZDtcblx0XHR9IGVsc2UgaWYgKHRoaXMuc2VsZWN0aW5nID09PSBcImFsbFwiKSB7XG5cdFx0XHRzZWxlY3RlZCA9IHRydWU7XG5cdFx0fVxuXHRcdFxuXHRcdGVsLmNsYXNzTGlzdC50b2dnbGUoXCJ0YWJ1bGF0b3ItcmFuZ2Utc2VsZWN0ZWRcIiwgc2VsZWN0ZWQpO1xuXHRcdGVsLmNsYXNzTGlzdC50b2dnbGUoXCJ0YWJ1bGF0b3ItcmFuZ2UtaGlnaGxpZ2h0XCIsIG9jY3VwaWVkKTtcblx0fVxuXHRcblx0bGF5b3V0UmFuZ2VzKCkge1xuXHRcdHZhciBhY3RpdmVDZWxsLCBhY3RpdmVDZWxsRWwsIGFjdGl2ZVJvd0VsO1xuXHRcdFxuXHRcdGlmICghdGhpcy50YWJsZS5pbml0aWFsaXplZCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRhY3RpdmVDZWxsID0gdGhpcy5nZXRBY3RpdmVDZWxsKCk7XG5cdFx0XG5cdFx0aWYgKCFhY3RpdmVDZWxsKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0YWN0aXZlQ2VsbEVsID0gYWN0aXZlQ2VsbC5nZXRFbGVtZW50KCk7XG5cdFx0YWN0aXZlUm93RWwgPSBhY3RpdmVDZWxsLnJvdy5nZXRFbGVtZW50KCk7XG5cblx0XHRpZih0aGlzLnRhYmxlLnJ0bCl7XG5cdFx0XHR0aGlzLmFjdGl2ZVJhbmdlQ2VsbEVsZW1lbnQuc3R5bGUucmlnaHQgPSBhY3RpdmVSb3dFbC5vZmZzZXRXaWR0aCAtIGFjdGl2ZUNlbGxFbC5vZmZzZXRMZWZ0IC0gYWN0aXZlQ2VsbEVsLm9mZnNldFdpZHRoICsgXCJweFwiO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuYWN0aXZlUmFuZ2VDZWxsRWxlbWVudC5zdHlsZS5sZWZ0ID0gYWN0aXZlUm93RWwub2Zmc2V0TGVmdCArIGFjdGl2ZUNlbGxFbC5vZmZzZXRMZWZ0ICsgXCJweFwiO1xuXHRcdH1cblxuXHRcdHRoaXMuYWN0aXZlUmFuZ2VDZWxsRWxlbWVudC5zdHlsZS50b3AgPVx0YWN0aXZlUm93RWwub2Zmc2V0VG9wICsgXCJweFwiO1xuXHRcdHRoaXMuYWN0aXZlUmFuZ2VDZWxsRWxlbWVudC5zdHlsZS53aWR0aCA9IGFjdGl2ZUNlbGxFbC5vZmZzZXRXaWR0aCArIFwicHhcIjtcblx0XHR0aGlzLmFjdGl2ZVJhbmdlQ2VsbEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gIGFjdGl2ZVJvd0VsLm9mZnNldEhlaWdodCAgKyBcInB4XCI7XG5cdFx0XG5cdFx0dGhpcy5yYW5nZXMuZm9yRWFjaCgocmFuZ2UpID0+IHJhbmdlLmxheW91dCgpKTtcblx0XHRcblx0XHR0aGlzLm92ZXJsYXkuc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xuXHR9XG5cdFxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLyAgSGVscGVyIEZ1bmN0aW9ucyAgIC8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cdFxuXHRcblx0Z2V0Q2VsbChyb3dJZHgsIGNvbElkeCkge1xuXHRcdHZhciByb3c7XG5cdFx0XG5cdFx0aWYgKGNvbElkeCA8IDApIHtcblx0XHRcdGNvbElkeCA9IHRoaXMuZ2V0VGFibGVDb2x1bW5zKCkubGVuZ3RoICsgY29sSWR4O1xuXHRcdFx0aWYgKGNvbElkeCA8IDApIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmIChyb3dJZHggPCAwKSB7XG5cdFx0XHRyb3dJZHggPSB0aGlzLmdldFRhYmxlUm93cygpLmxlbmd0aCArIHJvd0lkeDtcblx0XHR9XG5cdFx0XG5cdFx0cm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd0Zyb21Qb3NpdGlvbihyb3dJZHggKyAxKTtcblx0XHRcblx0XHRyZXR1cm4gcm93ID8gcm93LmdldENlbGxzKGZhbHNlLCB0cnVlKS5maWx0ZXIoKGNlbGwpID0+IGNlbGwuY29sdW1uLnZpc2libGUpW2NvbElkeF0gOiBudWxsO1xuXHR9XG5cdFxuXHRcblx0Z2V0QWN0aXZlQ2VsbCgpIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRDZWxsKHRoaXMuYWN0aXZlUmFuZ2Uuc3RhcnQucm93LCB0aGlzLmFjdGl2ZVJhbmdlLnN0YXJ0LmNvbCk7XG5cdH1cblx0XG5cdGdldFJvd0J5UmFuZ2VQb3MocG9zKSB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0VGFibGVSb3dzKClbcG9zXTtcblx0fVxuXHRcblx0Z2V0Q29sdW1uQnlSYW5nZVBvcyhwb3MpIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRUYWJsZUNvbHVtbnMoKVtwb3NdO1xuXHR9XG5cdFxuXHRnZXRUYWJsZVJvd3MoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUucm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpLmZpbHRlcihyb3c9PiByb3cudHlwZSA9PT0gXCJyb3dcIik7XG5cdH1cblx0XG5cdGdldFRhYmxlQ29sdW1ucygpIHtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldFZpc2libGVDb2x1bW5zQnlJbmRleCgpO1xuXHR9XG5cdFxuXHRhZGRSYW5nZShzdGFydCwgZW5kKSB7XG5cdFx0dmFyICByYW5nZTtcblx0XHRcblx0XHRpZih0aGlzLm1heFJhbmdlcyAhPT0gdHJ1ZSAmJiB0aGlzLnJhbmdlcy5sZW5ndGggPj0gdGhpcy5tYXhSYW5nZXMpe1xuXHRcdFx0dGhpcy5yYW5nZXMuc2hpZnQoKS5kZXN0cm95KCk7XG5cdFx0fVxuXHRcdFxuXHRcdHJhbmdlID0gbmV3IFJhbmdlKHRoaXMudGFibGUsIHRoaXMsIHN0YXJ0LCBlbmQpO1xuXHRcdFxuXHRcdHRoaXMuYWN0aXZlUmFuZ2UgPSByYW5nZTtcblx0XHR0aGlzLnJhbmdlcy5wdXNoKHJhbmdlKTtcblx0XHR0aGlzLnJhbmdlQ29udGFpbmVyLmFwcGVuZENoaWxkKHJhbmdlLmVsZW1lbnQpO1xuXHRcdFxuXHRcdHJldHVybiByYW5nZTtcblx0fVxuXHRcblx0cmVzZXRSYW5nZXMoKSB7XG5cdFx0dmFyIHJhbmdlLCBjZWxsLCB2aXNpYmxlQ2VsbHM7XG5cdFx0XG5cdFx0dGhpcy5yYW5nZXMuZm9yRWFjaCgocmFuZ2UpID0+IHJhbmdlLmRlc3Ryb3koKSk7XG5cdFx0dGhpcy5yYW5nZXMgPSBbXTtcblx0XHRcblx0XHRyYW5nZSA9IHRoaXMuYWRkUmFuZ2UoKTtcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWN0aXZlUm93cy5sZW5ndGgpe1xuXHRcdFx0dmlzaWJsZUNlbGxzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFjdGl2ZVJvd3NbMF0uY2VsbHMuZmlsdGVyKChjZWxsKSA9PiBjZWxsLmNvbHVtbi52aXNpYmxlKTtcblx0XHRcdGNlbGwgPSB2aXNpYmxlQ2VsbHNbdGhpcy5yb3dIZWFkZXIgPyAxIDogMF07XG5cblx0XHRcdGlmKGNlbGwpe1xuXHRcdFx0XHRyYW5nZS5zZXRCb3VuZHMoY2VsbCk7XG5cdFx0XHRcdGlmKHRoaXMub3B0aW9ucyhcInNlbGVjdGFibGVSYW5nZUF1dG9Gb2N1c1wiKSl7XG5cdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplRm9jdXMoY2VsbCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHJhbmdlO1xuXHR9XG5cdFxuXHR0YWJsZURlc3Ryb3llZCgpe1xuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMubW91c2VVcEV2ZW50KTtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLmtleURvd25FdmVudCk7XG5cdH1cblx0XG5cdHNlbGVjdGVkUm93cyhjb21wb25lbnQpIHtcblx0XHRyZXR1cm4gY29tcG9uZW50ID8gdGhpcy5hY3RpdmVSYW5nZS5nZXRSb3dzKCkubWFwKChyb3cpID0+IHJvdy5nZXRDb21wb25lbnQoKSkgOiB0aGlzLmFjdGl2ZVJhbmdlLmdldFJvd3MoKTtcblx0fVxuXHRcblx0c2VsZWN0ZWRDb2x1bW5zKGNvbXBvbmVudCkge1xuXHRcdHJldHVybiBjb21wb25lbnQgPyB0aGlzLmFjdGl2ZVJhbmdlLmdldENvbHVtbnMoKS5tYXAoKGNvbCkgPT4gY29sLmdldENvbXBvbmVudCgpKSA6IHRoaXMuYWN0aXZlUmFuZ2UuZ2V0Q29sdW1ucygpO1xuXHR9XG5cblx0Z2V0Um93SGVhZGVyV2lkdGgoKXtcblx0XHRpZighdGhpcy5yb3dIZWFkZXIpe1xuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnJvd0hlYWRlci5nZXRFbGVtZW50KCkub2Zmc2V0V2lkdGg7XG5cdH1cblxuXHRpc0VtcHR5KHZhbHVlKSB7XG5cdFx0cmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IFwiXCI7XG5cdH1cbn1cblxuLy9zb3J0IG51bWJlcnNcbmZ1bmN0aW9uIG51bWJlcihhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKXtcblx0dmFyIGFsaWduRW1wdHlWYWx1ZXMgPSBwYXJhbXMuYWxpZ25FbXB0eVZhbHVlcztcblx0dmFyIGRlY2ltYWwgPSBwYXJhbXMuZGVjaW1hbFNlcGFyYXRvcjtcblx0dmFyIHRob3VzYW5kID0gcGFyYW1zLnRob3VzYW5kU2VwYXJhdG9yO1xuXHR2YXIgZW1wdHlBbGlnbiA9IDA7XG5cblx0YSA9IFN0cmluZyhhKTtcblx0YiA9IFN0cmluZyhiKTtcblxuXHRpZih0aG91c2FuZCl7XG5cdFx0YSA9IGEuc3BsaXQodGhvdXNhbmQpLmpvaW4oXCJcIik7XG5cdFx0YiA9IGIuc3BsaXQodGhvdXNhbmQpLmpvaW4oXCJcIik7XG5cdH1cblxuXHRpZihkZWNpbWFsKXtcblx0XHRhID0gYS5zcGxpdChkZWNpbWFsKS5qb2luKFwiLlwiKTtcblx0XHRiID0gYi5zcGxpdChkZWNpbWFsKS5qb2luKFwiLlwiKTtcblx0fVxuXG5cdGEgPSBwYXJzZUZsb2F0KGEpO1xuXHRiID0gcGFyc2VGbG9hdChiKTtcblxuXHQvL2hhbmRsZSBub24gbnVtZXJpYyB2YWx1ZXNcblx0aWYoaXNOYU4oYSkpe1xuXHRcdGVtcHR5QWxpZ24gPSAgaXNOYU4oYikgPyAwIDogLTE7XG5cdH1lbHNlIGlmKGlzTmFOKGIpKXtcblx0XHRlbXB0eUFsaWduID0gIDE7XG5cdH1lbHNlIHtcblx0XHQvL2NvbXBhcmUgdmFsaWQgdmFsdWVzXG5cdFx0cmV0dXJuIGEgLSBiO1xuXHR9XG5cblx0Ly9maXggZW1wdHkgdmFsdWVzIGluIHBvc2l0aW9uXG5cdGlmKChhbGlnbkVtcHR5VmFsdWVzID09PSBcInRvcFwiICYmIGRpciA9PT0gXCJkZXNjXCIpIHx8IChhbGlnbkVtcHR5VmFsdWVzID09PSBcImJvdHRvbVwiICYmIGRpciA9PT0gXCJhc2NcIikpe1xuXHRcdGVtcHR5QWxpZ24gKj0gLTE7XG5cdH1cblxuXHRyZXR1cm4gZW1wdHlBbGlnbjtcbn1cblxuLy9zb3J0IHN0cmluZ3NcbmZ1bmN0aW9uIHN0cmluZyhhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKXtcblx0dmFyIGFsaWduRW1wdHlWYWx1ZXMgPSBwYXJhbXMuYWxpZ25FbXB0eVZhbHVlcztcblx0dmFyIGVtcHR5QWxpZ24gPSAwO1xuXHR2YXIgbG9jYWxlO1xuXG5cdC8vaGFuZGxlIGVtcHR5IHZhbHVlc1xuXHRpZighYSl7XG5cdFx0ZW1wdHlBbGlnbiA9ICAhYiA/IDAgOiAtMTtcblx0fWVsc2UgaWYoIWIpe1xuXHRcdGVtcHR5QWxpZ24gPSAgMTtcblx0fWVsc2Uge1xuXHRcdC8vY29tcGFyZSB2YWxpZCB2YWx1ZXNcblx0XHRzd2l0Y2godHlwZW9mIHBhcmFtcy5sb2NhbGUpe1xuXHRcdFx0Y2FzZSBcImJvb2xlYW5cIjpcblx0XHRcdFx0aWYocGFyYW1zLmxvY2FsZSl7XG5cdFx0XHRcdFx0bG9jYWxlID0gdGhpcy5sYW5nTG9jYWxlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdGxvY2FsZSA9IHBhcmFtcy5sb2NhbGU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdHJldHVybiBTdHJpbmcoYSkudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKFN0cmluZyhiKS50b0xvd2VyQ2FzZSgpLCBsb2NhbGUpO1xuXHR9XG5cblx0Ly9maXggZW1wdHkgdmFsdWVzIGluIHBvc2l0aW9uXG5cdGlmKChhbGlnbkVtcHR5VmFsdWVzID09PSBcInRvcFwiICYmIGRpciA9PT0gXCJkZXNjXCIpIHx8IChhbGlnbkVtcHR5VmFsdWVzID09PSBcImJvdHRvbVwiICYmIGRpciA9PT0gXCJhc2NcIikpe1xuXHRcdGVtcHR5QWxpZ24gKj0gLTE7XG5cdH1cblxuXHRyZXR1cm4gZW1wdHlBbGlnbjtcbn1cblxuLy9zb3J0IGRhdGV0aW1lXG5mdW5jdGlvbiBkYXRldGltZShhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKXtcblx0dmFyIERUID0gdGhpcy50YWJsZS5kZXBlbmRlbmN5UmVnaXN0cnkubG9va3VwKFtcImx1eG9uXCIsIFwiRGF0ZVRpbWVcIl0sIFwiRGF0ZVRpbWVcIik7XG5cdHZhciBmb3JtYXQgPSBwYXJhbXMuZm9ybWF0IHx8IFwiZGQvTU0veXl5eSBISDptbTpzc1wiLFxuXHRhbGlnbkVtcHR5VmFsdWVzID0gcGFyYW1zLmFsaWduRW1wdHlWYWx1ZXMsXG5cdGVtcHR5QWxpZ24gPSAwO1xuXG5cdGlmKHR5cGVvZiBEVCAhPSBcInVuZGVmaW5lZFwiKXtcblx0XHRpZighRFQuaXNEYXRlVGltZShhKSl7XG5cdFx0XHRpZihmb3JtYXQgPT09IFwiaXNvXCIpe1xuXHRcdFx0XHRhID0gRFQuZnJvbUlTTyhTdHJpbmcoYSkpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRhID0gRFQuZnJvbUZvcm1hdChTdHJpbmcoYSksIGZvcm1hdCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYoIURULmlzRGF0ZVRpbWUoYikpe1xuXHRcdFx0aWYoZm9ybWF0ID09PSBcImlzb1wiKXtcblx0XHRcdFx0YiA9IERULmZyb21JU08oU3RyaW5nKGIpKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0YiA9IERULmZyb21Gb3JtYXQoU3RyaW5nKGIpLCBmb3JtYXQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmKCFhLmlzVmFsaWQpe1xuXHRcdFx0ZW1wdHlBbGlnbiA9ICFiLmlzVmFsaWQgPyAwIDogLTE7XG5cdFx0fWVsc2UgaWYoIWIuaXNWYWxpZCl7XG5cdFx0XHRlbXB0eUFsaWduID0gIDE7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Ly9jb21wYXJlIHZhbGlkIHZhbHVlc1xuXHRcdFx0cmV0dXJuIGEgLSBiO1xuXHRcdH1cblxuXHRcdC8vZml4IGVtcHR5IHZhbHVlcyBpbiBwb3NpdGlvblxuXHRcdGlmKChhbGlnbkVtcHR5VmFsdWVzID09PSBcInRvcFwiICYmIGRpciA9PT0gXCJkZXNjXCIpIHx8IChhbGlnbkVtcHR5VmFsdWVzID09PSBcImJvdHRvbVwiICYmIGRpciA9PT0gXCJhc2NcIikpe1xuXHRcdFx0ZW1wdHlBbGlnbiAqPSAtMTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZW1wdHlBbGlnbjtcblxuXHR9ZWxzZSB7XG5cdFx0Y29uc29sZS5lcnJvcihcIlNvcnQgRXJyb3IgLSAnZGF0ZXRpbWUnIHNvcnRlciBpcyBkZXBlbmRhbnQgb24gbHV4b24uanNcIik7XG5cdH1cbn1cblxuLy9zb3J0IGRhdGVcbmZ1bmN0aW9uIGRhdGUoYSwgYiwgYVJvdywgYlJvdywgY29sdW1uLCBkaXIsIHBhcmFtcyl7XG5cdGlmKCFwYXJhbXMuZm9ybWF0KXtcblx0XHRwYXJhbXMuZm9ybWF0ID0gXCJkZC9NTS95eXl5XCI7XG5cdH1cblxuXHRyZXR1cm4gZGF0ZXRpbWUuY2FsbCh0aGlzLCBhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKTtcbn1cblxuLy9zb3J0IHRpbWVzXG5mdW5jdGlvbiB0aW1lKGEsIGIsIGFSb3csIGJSb3csIGNvbHVtbiwgZGlyLCBwYXJhbXMpe1xuXHRpZighcGFyYW1zLmZvcm1hdCl7XG5cdFx0cGFyYW1zLmZvcm1hdCA9IFwiSEg6bW1cIjtcblx0fVxuXG5cdHJldHVybiBkYXRldGltZS5jYWxsKHRoaXMsIGEsIGIsIGFSb3csIGJSb3csIGNvbHVtbiwgZGlyLCBwYXJhbXMpO1xufVxuXG4vL3NvcnQgYm9vbGVhbnNcbmZ1bmN0aW9uIGJvb2xlYW4oYSwgYiwgYVJvdywgYlJvdywgY29sdW1uLCBkaXIsIHBhcmFtcyl7XG5cdHZhciBlbDEgPSBhID09PSB0cnVlIHx8IGEgPT09IFwidHJ1ZVwiIHx8IGEgPT09IFwiVHJ1ZVwiIHx8IGEgPT09IDEgPyAxIDogMDtcblx0dmFyIGVsMiA9IGIgPT09IHRydWUgfHwgYiA9PT0gXCJ0cnVlXCIgfHwgYiA9PT0gXCJUcnVlXCIgfHwgYiA9PT0gMSA/IDEgOiAwO1xuXG5cdHJldHVybiBlbDEgLSBlbDI7XG59XG5cbi8vc29ydCBpZiBlbGVtZW50IGNvbnRhaW5zIGFueSBkYXRhXG5mdW5jdGlvbiBhcnJheShhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKXtcblx0dmFyIHR5cGUgPSBwYXJhbXMudHlwZSB8fCBcImxlbmd0aFwiLFxuXHRhbGlnbkVtcHR5VmFsdWVzID0gcGFyYW1zLmFsaWduRW1wdHlWYWx1ZXMsXG5cdGVtcHR5QWxpZ24gPSAwLFxuXHR0YWJsZSA9IHRoaXMudGFibGUsXG5cdHZhbHVlTWFwO1xuXG5cdGlmKHBhcmFtcy52YWx1ZU1hcCl7XG5cdFx0aWYodHlwZW9mIHBhcmFtcy52YWx1ZU1hcCA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHR2YWx1ZU1hcCA9IGZ1bmN0aW9uKHZhbHVlKXtcblx0XHRcdFx0cmV0dXJuIHZhbHVlLm1hcCgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdHJldHVybiBIZWxwZXJzLnJldHJpZXZlTmVzdGVkRGF0YSh0YWJsZS5vcHRpb25zLm5lc3RlZEZpZWxkU2VwYXJhdG9yLCBwYXJhbXMudmFsdWVNYXAsIGl0ZW0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH07XG5cdFx0fWVsc2Uge1xuXHRcdFx0dmFsdWVNYXAgPSBwYXJhbXMudmFsdWVNYXA7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gY2FsYyh2YWx1ZSl7XG5cdFx0dmFyIHJlc3VsdDtcblx0XHRcblx0XHRpZih2YWx1ZU1hcCl7XG5cdFx0XHR2YWx1ZSA9IHZhbHVlTWFwKHZhbHVlKTtcblx0XHR9XG5cblx0XHRzd2l0Y2godHlwZSl7XG5cdFx0XHRjYXNlIFwibGVuZ3RoXCI6XG5cdFx0XHRcdHJlc3VsdCA9IHZhbHVlLmxlbmd0aDtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJzdW1cIjpcblx0XHRcdFx0cmVzdWx0ID0gdmFsdWUucmVkdWNlKGZ1bmN0aW9uKGMsIGQpe1xuXHRcdFx0XHRcdHJldHVybiBjICsgZDtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwibWF4XCI6XG5cdFx0XHRcdHJlc3VsdCA9IE1hdGgubWF4LmFwcGx5KG51bGwsIHZhbHVlKSA7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwibWluXCI6XG5cdFx0XHRcdHJlc3VsdCA9IE1hdGgubWluLmFwcGx5KG51bGwsIHZhbHVlKSA7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwiYXZnXCI6XG5cdFx0XHRcdHJlc3VsdCA9IHZhbHVlLnJlZHVjZShmdW5jdGlvbihjLCBkKXtcblx0XHRcdFx0XHRyZXR1cm4gYyArIGQ7XG5cdFx0XHRcdH0pIC8gdmFsdWUubGVuZ3RoO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRyZXN1bHQgPSB2YWx1ZS5qb2luKFwiXCIpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9XG5cblx0Ly9oYW5kbGUgbm9uIGFycmF5IHZhbHVlc1xuXHRpZighQXJyYXkuaXNBcnJheShhKSl7XG5cdFx0ZW1wdHlBbGlnbiA9ICFBcnJheS5pc0FycmF5KGIpID8gMCA6IC0xO1xuXHR9ZWxzZSBpZighQXJyYXkuaXNBcnJheShiKSl7XG5cdFx0ZW1wdHlBbGlnbiA9IDE7XG5cdH1lbHNlIHtcblx0XHRpZih0eXBlID09PSBcInN0cmluZ1wiKXtcblx0XHRcdHJldHVybiBTdHJpbmcoY2FsYyhhKSkudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKFN0cmluZyhjYWxjKGIpKS50b0xvd2VyQ2FzZSgpKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gY2FsYyhiKSAtIGNhbGMoYSk7XG5cdFx0fVxuXHR9XG5cblx0Ly9maXggZW1wdHkgdmFsdWVzIGluIHBvc2l0aW9uXG5cdGlmKChhbGlnbkVtcHR5VmFsdWVzID09PSBcInRvcFwiICYmIGRpciA9PT0gXCJkZXNjXCIpIHx8IChhbGlnbkVtcHR5VmFsdWVzID09PSBcImJvdHRvbVwiICYmIGRpciA9PT0gXCJhc2NcIikpe1xuXHRcdGVtcHR5QWxpZ24gKj0gLTE7XG5cdH1cblxuXHRyZXR1cm4gZW1wdHlBbGlnbjtcbn1cblxuLy9zb3J0IGlmIGVsZW1lbnQgY29udGFpbnMgYW55IGRhdGFcbmZ1bmN0aW9uIGV4aXN0cyhhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKXtcblx0dmFyIGVsMSA9IHR5cGVvZiBhID09IFwidW5kZWZpbmVkXCIgPyAwIDogMTtcblx0dmFyIGVsMiA9IHR5cGVvZiBiID09IFwidW5kZWZpbmVkXCIgPyAwIDogMTtcblxuXHRyZXR1cm4gZWwxIC0gZWwyO1xufVxuXG4vL3NvcnQgYWxwaGEgbnVtZXJpYyBzdHJpbmdzXG5mdW5jdGlvbiBhbHBoYW51bShhcywgYnMsIGFSb3csIGJSb3csIGNvbHVtbiwgZGlyLCBwYXJhbXMpe1xuXHR2YXIgYSwgYiwgYTEsIGIxLCBpPSAwLCBMLCByeCA9IC8oXFxkKyl8KFxcRCspL2csIHJkID0gL1xcZC87XG5cdHZhciBhbGlnbkVtcHR5VmFsdWVzID0gcGFyYW1zLmFsaWduRW1wdHlWYWx1ZXM7XG5cdHZhciBlbXB0eUFsaWduID0gMDtcblxuXHQvL2hhbmRsZSBlbXB0eSB2YWx1ZXNcblx0aWYoIWFzICYmIGFzIT09IDApe1xuXHRcdGVtcHR5QWxpZ24gPSAgIWJzICYmIGJzIT09IDAgPyAwIDogLTE7XG5cdH1lbHNlIGlmKCFicyAmJiBicyE9PSAwKXtcblx0XHRlbXB0eUFsaWduID0gIDE7XG5cdH1lbHNlIHtcblxuXHRcdGlmKGlzRmluaXRlKGFzKSAmJiBpc0Zpbml0ZShicykpIHJldHVybiBhcyAtIGJzO1xuXHRcdGEgPSBTdHJpbmcoYXMpLnRvTG93ZXJDYXNlKCk7XG5cdFx0YiA9IFN0cmluZyhicykudG9Mb3dlckNhc2UoKTtcblx0XHRpZihhID09PSBiKSByZXR1cm4gMDtcblx0XHRpZighKHJkLnRlc3QoYSkgJiYgcmQudGVzdChiKSkpIHJldHVybiBhID4gYiA/IDEgOiAtMTtcblx0XHRhID0gYS5tYXRjaChyeCk7XG5cdFx0YiA9IGIubWF0Y2gocngpO1xuXHRcdEwgPSBhLmxlbmd0aCA+IGIubGVuZ3RoID8gYi5sZW5ndGggOiBhLmxlbmd0aDtcblx0XHR3aGlsZShpIDwgTCl7XG5cdFx0XHRhMT0gYVtpXTtcblx0XHRcdGIxPSBiW2krK107XG5cdFx0XHRpZihhMSAhPT0gYjEpe1xuXHRcdFx0XHRpZihpc0Zpbml0ZShhMSkgJiYgaXNGaW5pdGUoYjEpKXtcblx0XHRcdFx0XHRpZihhMS5jaGFyQXQoMCkgPT09IFwiMFwiKSBhMSA9IFwiLlwiICsgYTE7XG5cdFx0XHRcdFx0aWYoYjEuY2hhckF0KDApID09PSBcIjBcIikgYjEgPSBcIi5cIiArIGIxO1xuXHRcdFx0XHRcdHJldHVybiBhMSAtIGIxO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgcmV0dXJuIGExID4gYjEgPyAxIDogLTE7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGEubGVuZ3RoID4gYi5sZW5ndGg7XG5cdH1cblxuXHQvL2ZpeCBlbXB0eSB2YWx1ZXMgaW4gcG9zaXRpb25cblx0aWYoKGFsaWduRW1wdHlWYWx1ZXMgPT09IFwidG9wXCIgJiYgZGlyID09PSBcImRlc2NcIikgfHwgKGFsaWduRW1wdHlWYWx1ZXMgPT09IFwiYm90dG9tXCIgJiYgZGlyID09PSBcImFzY1wiKSl7XG5cdFx0ZW1wdHlBbGlnbiAqPSAtMTtcblx0fVxuXG5cdHJldHVybiBlbXB0eUFsaWduO1xufVxuXG52YXIgZGVmYXVsdFNvcnRlcnMgPSB7XG5cdG51bWJlcjpudW1iZXIsXG5cdHN0cmluZzpzdHJpbmcsXG5cdGRhdGU6ZGF0ZSxcblx0dGltZTp0aW1lLFxuXHRkYXRldGltZTpkYXRldGltZSxcblx0Ym9vbGVhbjpib29sZWFuLFxuXHRhcnJheTphcnJheSxcblx0ZXhpc3RzOmV4aXN0cyxcblx0YWxwaGFudW06YWxwaGFudW1cbn07XG5cbmNsYXNzIFNvcnQgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcInNvcnRcIjtcblxuXHQvL2xvYWQgZGVmYXVsdHNcblx0c3RhdGljIHNvcnRlcnMgPSBkZWZhdWx0U29ydGVycztcblx0XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy5zb3J0TGlzdCA9IFtdOyAvL2hvbGRlciBjdXJyZW50IHNvcnRcblx0XHR0aGlzLmNoYW5nZWQgPSBmYWxzZTsgLy9oYXMgdGhlIHNvcnQgY2hhbmdlZCBzaW5jZSBsYXN0IHJlbmRlclxuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNvcnRNb2RlXCIsIFwibG9jYWxcIik7IC8vbG9jYWwgb3IgcmVtb3RlIHNvcnRpbmdcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJpbml0aWFsU29ydFwiLCBmYWxzZSk7IC8vaW5pdGlhbCBzb3J0aW5nIGNyaXRlcmlhXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwiY29sdW1uSGVhZGVyU29ydE11bHRpXCIsIHRydWUpOyAvL211bHRpcGxlIG9yIHNpbmdsZSBjb2x1bW4gc29ydGluZ1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNvcnRPcmRlclJldmVyc2VcIiwgZmFsc2UpOyAvL3JldmVyc2UgaW50ZXJuYWwgc29ydCBvcmRlcmluZ1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImhlYWRlclNvcnRFbGVtZW50XCIsIFwiPGRpdiBjbGFzcz0ndGFidWxhdG9yLWFycm93Jz48L2Rpdj5cIik7IC8vaGVhZGVyIHNvcnQgZWxlbWVudFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImhlYWRlclNvcnRDbGlja0VsZW1lbnRcIiwgXCJoZWFkZXJcIik7IC8vZWxlbWVudCB3aGljaCB0cmlnZ2VycyBzb3J0IHdoZW4gY2xpY2tlZFxuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJzb3J0ZXJcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInNvcnRlclBhcmFtc1wiKTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyU29ydFwiLCB0cnVlKTtcblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwiaGVhZGVyU29ydFN0YXJ0aW5nRGlyXCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJoZWFkZXJTb3J0VHJpc3RhdGVcIik7XG5cdFx0XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1sYXlvdXRcIiwgdGhpcy5pbml0aWFsaXplQ29sdW1uLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwidGFibGUtYnVpbHRcIiwgdGhpcy50YWJsZUJ1aWx0LmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJEYXRhSGFuZGxlcih0aGlzLnNvcnQuYmluZCh0aGlzKSwgMjApO1xuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwic2V0U29ydFwiLCB0aGlzLnVzZXJTZXRTb3J0LmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0U29ydGVyc1wiLCB0aGlzLmdldFNvcnQuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJjbGVhclNvcnRcIiwgdGhpcy5jbGVhclNvcnQuYmluZCh0aGlzKSk7XG5cdFx0XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnNvcnRNb2RlID09PSBcInJlbW90ZVwiKXtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1wYXJhbXNcIiwgdGhpcy5yZW1vdGVTb3J0UGFyYW1zLmJpbmQodGhpcykpO1xuXHRcdH1cblx0fVxuXHRcblx0dGFibGVCdWlsdCgpe1xuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5pbml0aWFsU29ydCl7XG5cdFx0XHR0aGlzLnNldFNvcnQodGhpcy50YWJsZS5vcHRpb25zLmluaXRpYWxTb3J0KTtcblx0XHR9XG5cdH1cblx0XG5cdHJlbW90ZVNvcnRQYXJhbXMoZGF0YSwgY29uZmlnLCBzaWxlbnQsIHBhcmFtcyl7XG5cdFx0dmFyIHNvcnRlcnMgPSB0aGlzLmdldFNvcnQoKTtcblx0XHRcblx0XHRzb3J0ZXJzLmZvckVhY2goKGl0ZW0pID0+IHtcblx0XHRcdGRlbGV0ZSBpdGVtLmNvbHVtbjtcblx0XHR9KTtcblx0XHRcblx0XHRwYXJhbXMuc29ydCA9IHNvcnRlcnM7XG5cdFx0XG5cdFx0cmV0dXJuIHBhcmFtcztcblx0fVxuXHRcblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBUYWJsZSBGdW5jdGlvbnMgLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHR1c2VyU2V0U29ydChzb3J0TGlzdCwgZGlyKXtcblx0XHR0aGlzLnNldFNvcnQoc29ydExpc3QsIGRpcik7XG5cdFx0Ly8gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNvcnRlclJlZnJlc2goKTtcblx0XHR0aGlzLnJlZnJlc2hTb3J0KCk7XG5cdH1cblx0XG5cdGNsZWFyU29ydCgpe1xuXHRcdHRoaXMuY2xlYXIoKTtcblx0XHQvLyB0aGlzLnRhYmxlLnJvd01hbmFnZXIuc29ydGVyUmVmcmVzaCgpO1xuXHRcdHRoaXMucmVmcmVzaFNvcnQoKTtcblx0fVxuXHRcblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBJbnRlcm5hbCBMb2dpYyAvLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHQvL2luaXRpYWxpemUgY29sdW1uIGhlYWRlciBmb3Igc29ydGluZ1xuXHRpbml0aWFsaXplQ29sdW1uKGNvbHVtbil7XG5cdFx0dmFyIHNvcnRlciA9IGZhbHNlLFxuXHRcdGNvbEVsLFxuXHRcdGFycm93RWw7XG5cdFx0XG5cdFx0c3dpdGNoKHR5cGVvZiBjb2x1bW4uZGVmaW5pdGlvbi5zb3J0ZXIpe1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRpZihTb3J0LnNvcnRlcnNbY29sdW1uLmRlZmluaXRpb24uc29ydGVyXSl7XG5cdFx0XHRcdFx0c29ydGVyID0gU29ydC5zb3J0ZXJzW2NvbHVtbi5kZWZpbml0aW9uLnNvcnRlcl07XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJTb3J0IEVycm9yIC0gTm8gc3VjaCBzb3J0ZXIgZm91bmQ6IFwiLCBjb2x1bW4uZGVmaW5pdGlvbi5zb3J0ZXIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0c29ydGVyID0gY29sdW1uLmRlZmluaXRpb24uc29ydGVyO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdFx0XG5cdFx0Y29sdW1uLm1vZHVsZXMuc29ydCA9IHtcblx0XHRcdHNvcnRlcjpzb3J0ZXIsIGRpcjpcIm5vbmVcIixcblx0XHRcdHBhcmFtczpjb2x1bW4uZGVmaW5pdGlvbi5zb3J0ZXJQYXJhbXMgfHwge30sXG5cdFx0XHRzdGFydGluZ0Rpcjpjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJTb3J0U3RhcnRpbmdEaXIgfHwgXCJhc2NcIixcblx0XHRcdHRyaXN0YXRlOiBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJTb3J0VHJpc3RhdGUsXG5cdFx0fTtcblx0XHRcblx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJTb3J0ICE9PSBmYWxzZSl7XG5cdFx0XHRcblx0XHRcdGNvbEVsID0gY29sdW1uLmdldEVsZW1lbnQoKTtcblx0XHRcdFxuXHRcdFx0Y29sRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1zb3J0YWJsZVwiKTtcblx0XHRcdFxuXHRcdFx0YXJyb3dFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRhcnJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItY29sLXNvcnRlclwiKTtcblx0XHRcdFxuXHRcdFx0c3dpdGNoKHRoaXMudGFibGUub3B0aW9ucy5oZWFkZXJTb3J0Q2xpY2tFbGVtZW50KXtcblx0XHRcdFx0Y2FzZSBcImljb25cIjpcblx0XHRcdFx0XHRhcnJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItY29sLXNvcnRlci1lbGVtZW50XCIpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiaGVhZGVyXCI6XG5cdFx0XHRcdFx0Y29sRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtc29ydGVyLWVsZW1lbnRcIik7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0Y29sRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtc29ydGVyLWVsZW1lbnRcIik7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHN3aXRjaCh0aGlzLnRhYmxlLm9wdGlvbnMuaGVhZGVyU29ydEVsZW1lbnQpe1xuXHRcdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0Ly9kbyBub3RoaW5nXG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFxuXHRcdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdFx0YXJyb3dFbC5hcHBlbmRDaGlsZCh0aGlzLnRhYmxlLm9wdGlvbnMuaGVhZGVyU29ydEVsZW1lbnQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRhcnJvd0VsLmlubmVySFRNTCA9IHRoaXMudGFibGUub3B0aW9ucy5oZWFkZXJTb3J0RWxlbWVudDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly9jcmVhdGUgc29ydGVyIGFycm93XG5cdFx0XHRjb2x1bW4udGl0bGVIb2xkZXJFbGVtZW50LmFwcGVuZENoaWxkKGFycm93RWwpO1xuXHRcdFx0XG5cdFx0XHRjb2x1bW4ubW9kdWxlcy5zb3J0LmVsZW1lbnQgPSBhcnJvd0VsO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnNldENvbHVtbkhlYWRlclNvcnRJY29uKGNvbHVtbiwgXCJub25lXCIpO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMuaGVhZGVyU29ydENsaWNrRWxlbWVudCA9PT0gXCJpY29uXCIpe1xuXHRcdFx0XHRhcnJvd0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly9zb3J0IG9uIGNsaWNrXG5cdFx0XHQodGhpcy50YWJsZS5vcHRpb25zLmhlYWRlclNvcnRDbGlja0VsZW1lbnQgPT09IFwiaWNvblwiID8gYXJyb3dFbCA6IGNvbEVsKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdFx0dmFyIGRpciA9IFwiXCIsXG5cdFx0XHRcdHNvcnRlcnM9W10sXG5cdFx0XHRcdG1hdGNoID0gZmFsc2U7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihjb2x1bW4ubW9kdWxlcy5zb3J0KXtcblx0XHRcdFx0XHRpZihjb2x1bW4ubW9kdWxlcy5zb3J0LnRyaXN0YXRlKXtcblx0XHRcdFx0XHRcdGlmKGNvbHVtbi5tb2R1bGVzLnNvcnQuZGlyID09IFwibm9uZVwiKXtcblx0XHRcdFx0XHRcdFx0ZGlyID0gY29sdW1uLm1vZHVsZXMuc29ydC5zdGFydGluZ0Rpcjtcblx0XHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdFx0aWYoY29sdW1uLm1vZHVsZXMuc29ydC5kaXIgPT0gY29sdW1uLm1vZHVsZXMuc29ydC5zdGFydGluZ0Rpcil7XG5cdFx0XHRcdFx0XHRcdFx0ZGlyID0gY29sdW1uLm1vZHVsZXMuc29ydC5kaXIgPT0gXCJhc2NcIiA/IFwiZGVzY1wiIDogXCJhc2NcIjtcblx0XHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGRpciA9IFwibm9uZVwiO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0c3dpdGNoKGNvbHVtbi5tb2R1bGVzLnNvcnQuZGlyKXtcblx0XHRcdFx0XHRcdFx0Y2FzZSBcImFzY1wiOlxuXHRcdFx0XHRcdFx0XHRcdGRpciA9IFwiZGVzY1wiO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Y2FzZSBcImRlc2NcIjpcblx0XHRcdFx0XHRcdFx0XHRkaXIgPSBcImFzY1wiO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0XHRkaXIgPSBjb2x1bW4ubW9kdWxlcy5zb3J0LnN0YXJ0aW5nRGlyO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkhlYWRlclNvcnRNdWx0aSAmJiAoZS5zaGlmdEtleSB8fCBlLmN0cmxLZXkpKSB7XG5cdFx0XHRcdFx0XHRzb3J0ZXJzID0gdGhpcy5nZXRTb3J0KCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdG1hdGNoID0gc29ydGVycy5maW5kSW5kZXgoKHNvcnRlcikgPT4ge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gc29ydGVyLmZpZWxkID09PSBjb2x1bW4uZ2V0RmllbGQoKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZihtYXRjaCA+IC0xKXtcblx0XHRcdFx0XHRcdFx0c29ydGVyc1ttYXRjaF0uZGlyID0gZGlyO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0bWF0Y2ggPSBzb3J0ZXJzLnNwbGljZShtYXRjaCwgMSlbMF07XG5cdFx0XHRcdFx0XHRcdGlmKGRpciAhPSBcIm5vbmVcIil7XG5cdFx0XHRcdFx0XHRcdFx0c29ydGVycy5wdXNoKG1hdGNoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpZihkaXIgIT0gXCJub25lXCIpe1xuXHRcdFx0XHRcdFx0XHRcdHNvcnRlcnMucHVzaCh7Y29sdW1uOmNvbHVtbiwgZGlyOmRpcn0pO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vYWRkIHRvIGV4aXN0aW5nIHNvcnRcblx0XHRcdFx0XHRcdHRoaXMuc2V0U29ydChzb3J0ZXJzKTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRpZihkaXIgPT0gXCJub25lXCIpe1xuXHRcdFx0XHRcdFx0XHR0aGlzLmNsZWFyKCk7XG5cdFx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vc29ydCBieSBjb2x1bW4gb25seVxuXHRcdFx0XHRcdFx0XHR0aGlzLnNldFNvcnQoY29sdW1uLCBkaXIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIHRoaXMudGFibGUucm93TWFuYWdlci5zb3J0ZXJSZWZyZXNoKCF0aGlzLnNvcnRMaXN0Lmxlbmd0aCk7XG5cdFx0XHRcdFx0dGhpcy5yZWZyZXNoU29ydCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0XG5cdHJlZnJlc2hTb3J0KCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnNvcnRNb2RlID09PSBcInJlbW90ZVwiKXtcblx0XHRcdHRoaXMucmVsb2FkRGF0YShudWxsLCBmYWxzZSwgZmFsc2UpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMucmVmcmVzaERhdGEodHJ1ZSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vVE9ETyAtIFBlcnNpc3QgbGVmdCBwb3NpdGlvbiBvZiByb3cgbWFuYWdlclxuXHRcdC8vIGxlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XG5cdFx0Ly8gdGhpcy5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHR9XG5cdFxuXHQvL2NoZWNrIGlmIHRoZSBzb3J0ZXJzIGhhdmUgY2hhbmdlZCBzaW5jZSBsYXN0IHVzZVxuXHRoYXNDaGFuZ2VkKCl7XG5cdFx0dmFyIGNoYW5nZWQgPSB0aGlzLmNoYW5nZWQ7XG5cdFx0dGhpcy5jaGFuZ2VkID0gZmFsc2U7XG5cdFx0cmV0dXJuIGNoYW5nZWQ7XG5cdH1cblx0XG5cdC8vcmV0dXJuIGN1cnJlbnQgc29ydGVyc1xuXHRnZXRTb3J0KCl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdHNvcnRlcnMgPSBbXTtcblx0XHRcblx0XHRzZWxmLnNvcnRMaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG5cdFx0XHRpZihpdGVtLmNvbHVtbil7XG5cdFx0XHRcdHNvcnRlcnMucHVzaCh7Y29sdW1uOml0ZW0uY29sdW1uLmdldENvbXBvbmVudCgpLCBmaWVsZDppdGVtLmNvbHVtbi5nZXRGaWVsZCgpLCBkaXI6aXRlbS5kaXJ9KTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gc29ydGVycztcblx0fVxuXHRcblx0Ly9jaGFuZ2Ugc29ydCBsaXN0IGFuZCB0cmlnZ2VyIHNvcnRcblx0c2V0U29ydChzb3J0TGlzdCwgZGlyKXtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0bmV3U29ydExpc3QgPSBbXTtcblx0XHRcblx0XHRpZighQXJyYXkuaXNBcnJheShzb3J0TGlzdCkpe1xuXHRcdFx0c29ydExpc3QgPSBbe2NvbHVtbjogc29ydExpc3QsIGRpcjpkaXJ9XTtcblx0XHR9XG5cdFx0XG5cdFx0c29ydExpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcblx0XHRcdHZhciBjb2x1bW47XG5cdFx0XHRcblx0XHRcdGNvbHVtbiA9IHNlbGYudGFibGUuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGl0ZW0uY29sdW1uKTtcblx0XHRcdFxuXHRcdFx0aWYoY29sdW1uKXtcblx0XHRcdFx0aXRlbS5jb2x1bW4gPSBjb2x1bW47XG5cdFx0XHRcdG5ld1NvcnRMaXN0LnB1c2goaXRlbSk7XG5cdFx0XHRcdHNlbGYuY2hhbmdlZCA9IHRydWU7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIlNvcnQgV2FybmluZyAtIFNvcnQgZmllbGQgZG9lcyBub3QgZXhpc3QgYW5kIGlzIGJlaW5nIGlnbm9yZWQ6IFwiLCBpdGVtLmNvbHVtbik7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9KTtcblx0XHRcblx0XHRzZWxmLnNvcnRMaXN0ID0gbmV3U29ydExpc3Q7XG5cdFx0XG5cdFx0dGhpcy5kaXNwYXRjaChcInNvcnQtY2hhbmdlZFwiKTtcblx0fVxuXHRcblx0Ly9jbGVhciBzb3J0ZXJzXG5cdGNsZWFyKCl7XG5cdFx0dGhpcy5zZXRTb3J0KFtdKTtcblx0fVxuXHRcblx0Ly9maW5kIGFwcHJvcHJpYXRlIHNvcnRlciBmb3IgY29sdW1uXG5cdGZpbmRTb3J0ZXIoY29sdW1uKXtcblx0XHR2YXIgcm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFjdGl2ZVJvd3NbMF0sXG5cdFx0c29ydGVyID0gXCJzdHJpbmdcIixcblx0XHRmaWVsZCwgdmFsdWU7XG5cdFx0XG5cdFx0aWYocm93KXtcblx0XHRcdHJvdyA9IHJvdy5nZXREYXRhKCk7XG5cdFx0XHRmaWVsZCA9IGNvbHVtbi5nZXRGaWVsZCgpO1xuXHRcdFx0XG5cdFx0XHRpZihmaWVsZCl7XG5cdFx0XHRcdFxuXHRcdFx0XHR2YWx1ZSA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKHJvdyk7XG5cdFx0XHRcdFxuXHRcdFx0XHRzd2l0Y2godHlwZW9mIHZhbHVlKXtcblx0XHRcdFx0XHRjYXNlIFwidW5kZWZpbmVkXCI6XG5cdFx0XHRcdFx0XHRzb3J0ZXIgPSBcInN0cmluZ1wiO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y2FzZSBcImJvb2xlYW5cIjpcblx0XHRcdFx0XHRcdHNvcnRlciA9IFwiYm9vbGVhblwiO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdGlmKCFpc05hTih2YWx1ZSkgJiYgdmFsdWUgIT09IFwiXCIpe1xuXHRcdFx0XHRcdFx0XHRzb3J0ZXIgPSBcIm51bWJlclwiO1xuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpZih2YWx1ZS5tYXRjaCgvKCheWzAtOV0rW2Etel0rKXwoXlthLXpdK1swLTldKykpKyQvaSkpe1xuXHRcdFx0XHRcdFx0XHRcdHNvcnRlciA9IFwiYWxwaGFudW1cIjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIFNvcnQuc29ydGVyc1tzb3J0ZXJdO1xuXHR9XG5cdFxuXHQvL3dvcmsgdGhyb3VnaCBzb3J0IGxpc3Qgc29ydGluZyBkYXRhXG5cdHNvcnQoZGF0YSwgc29ydE9ubHkpe1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRzb3J0TGlzdCA9IHRoaXMudGFibGUub3B0aW9ucy5zb3J0T3JkZXJSZXZlcnNlID8gc2VsZi5zb3J0TGlzdC5zbGljZSgpLnJldmVyc2UoKSA6IHNlbGYuc29ydExpc3QsXG5cdFx0c29ydExpc3RBY3R1YWwgPSBbXSxcblx0XHRyb3dDb21wb25lbnRzID0gW107XG5cdFx0XG5cdFx0aWYodGhpcy5zdWJzY3JpYmVkRXh0ZXJuYWwoXCJkYXRhU29ydGluZ1wiKSl7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhU29ydGluZ1wiLCBzZWxmLmdldFNvcnQoKSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKCFzb3J0T25seSkge1xuXHRcdFx0c2VsZi5jbGVhckNvbHVtbkhlYWRlcnMoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnNvcnRNb2RlICE9PSBcInJlbW90ZVwiKXtcblx0XHRcdFxuXHRcdFx0Ly9idWlsZCBsaXN0IG9mIHZhbGlkIHNvcnRlcnMgYW5kIHRyaWdnZXIgY29sdW1uIHNwZWNpZmljIGNhbGxiYWNrcyBiZWZvcmUgc29ydCBiZWdpbnNcblx0XHRcdHNvcnRMaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSl7XG5cdFx0XHRcdHZhciBzb3J0T2JqO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoaXRlbS5jb2x1bW4pe1xuXHRcdFx0XHRcdHNvcnRPYmogPSBpdGVtLmNvbHVtbi5tb2R1bGVzLnNvcnQ7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoc29ydE9iail7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vaWYgbm8gc29ydGVyIGhhcyBiZWVuIGRlZmluZWQsIHRha2UgYSBndWVzc1xuXHRcdFx0XHRcdFx0aWYoIXNvcnRPYmouc29ydGVyKXtcblx0XHRcdFx0XHRcdFx0c29ydE9iai5zb3J0ZXIgPSBzZWxmLmZpbmRTb3J0ZXIoaXRlbS5jb2x1bW4pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpdGVtLnBhcmFtcyA9IHR5cGVvZiBzb3J0T2JqLnBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gc29ydE9iai5wYXJhbXMoaXRlbS5jb2x1bW4uZ2V0Q29tcG9uZW50KCksIGl0ZW0uZGlyKSA6IHNvcnRPYmoucGFyYW1zO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRzb3J0TGlzdEFjdHVhbC5wdXNoKGl0ZW0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZighc29ydE9ubHkpIHtcblx0XHRcdFx0XHRcdHNlbGYuc2V0Q29sdW1uSGVhZGVyKGl0ZW0uY29sdW1uLCBpdGVtLmRpcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly9zb3J0IGRhdGFcblx0XHRcdGlmIChzb3J0TGlzdEFjdHVhbC5sZW5ndGgpIHtcblx0XHRcdFx0c2VsZi5fc29ydEl0ZW1zKGRhdGEsIHNvcnRMaXN0QWN0dWFsKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdH1lbHNlIGlmKCFzb3J0T25seSkge1xuXHRcdFx0c29ydExpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpKXtcblx0XHRcdFx0c2VsZi5zZXRDb2x1bW5IZWFkZXIoaXRlbS5jb2x1bW4sIGl0ZW0uZGlyKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdFxuXHRcdGlmKHRoaXMuc3Vic2NyaWJlZEV4dGVybmFsKFwiZGF0YVNvcnRlZFwiKSl7XG5cdFx0XHRkYXRhLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRyb3dDb21wb25lbnRzLnB1c2gocm93LmdldENvbXBvbmVudCgpKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhU29ydGVkXCIsIHNlbGYuZ2V0U29ydCgpLCByb3dDb21wb25lbnRzKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGRhdGE7XG5cdH1cblx0XG5cdC8vY2xlYXIgc29ydCBhcnJvd3Mgb24gY29sdW1uc1xuXHRjbGVhckNvbHVtbkhlYWRlcnMoKXtcblx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0UmVhbENvbHVtbnMoKS5mb3JFYWNoKChjb2x1bW4pID0+IHtcblx0XHRcdGlmKGNvbHVtbi5tb2R1bGVzLnNvcnQpe1xuXHRcdFx0XHRjb2x1bW4ubW9kdWxlcy5zb3J0LmRpciA9IFwibm9uZVwiO1xuXHRcdFx0XHRjb2x1bW4uZ2V0RWxlbWVudCgpLnNldEF0dHJpYnV0ZShcImFyaWEtc29ydFwiLCBcIm5vbmVcIik7XG5cdFx0XHRcdHRoaXMuc2V0Q29sdW1uSGVhZGVyU29ydEljb24oY29sdW1uLCBcIm5vbmVcIik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0XG5cdC8vc2V0IHRoZSBjb2x1bW4gaGVhZGVyIHNvcnQgZGlyZWN0aW9uXG5cdHNldENvbHVtbkhlYWRlcihjb2x1bW4sIGRpcil7XG5cdFx0Y29sdW1uLm1vZHVsZXMuc29ydC5kaXIgPSBkaXI7XG5cdFx0Y29sdW1uLmdldEVsZW1lbnQoKS5zZXRBdHRyaWJ1dGUoXCJhcmlhLXNvcnRcIiwgZGlyID09PSBcImFzY1wiID8gXCJhc2NlbmRpbmdcIiA6IFwiZGVzY2VuZGluZ1wiKTtcblx0XHR0aGlzLnNldENvbHVtbkhlYWRlclNvcnRJY29uKGNvbHVtbiwgZGlyKTtcblx0fVxuXHRcblx0c2V0Q29sdW1uSGVhZGVyU29ydEljb24oY29sdW1uLCBkaXIpe1xuXHRcdHZhciBzb3J0RWwgPSBjb2x1bW4ubW9kdWxlcy5zb3J0LmVsZW1lbnQsXG5cdFx0YXJyb3dFbDtcblx0XHRcblx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJTb3J0ICYmIHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMuaGVhZGVyU29ydEVsZW1lbnQgPT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHR3aGlsZShzb3J0RWwuZmlyc3RDaGlsZCkgc29ydEVsLnJlbW92ZUNoaWxkKHNvcnRFbC5maXJzdENoaWxkKTtcblx0XHRcdFxuXHRcdFx0YXJyb3dFbCA9IHRoaXMudGFibGUub3B0aW9ucy5oZWFkZXJTb3J0RWxlbWVudC5jYWxsKHRoaXMudGFibGUsIGNvbHVtbi5nZXRDb21wb25lbnQoKSwgZGlyKTtcblx0XHRcdFxuXHRcdFx0aWYodHlwZW9mIGFycm93RWwgPT09IFwib2JqZWN0XCIpe1xuXHRcdFx0XHRzb3J0RWwuYXBwZW5kQ2hpbGQoYXJyb3dFbCk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHNvcnRFbC5pbm5lckhUTUwgPSBhcnJvd0VsO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0Ly9zb3J0IGVhY2ggaXRlbSBpbiBzb3J0IGxpc3Rcblx0X3NvcnRJdGVtcyhkYXRhLCBzb3J0TGlzdCl7XG5cdFx0dmFyIHNvcnRlckNvdW50ID0gc29ydExpc3QubGVuZ3RoIC0gMTtcblx0XHRcblx0XHRkYXRhLnNvcnQoKGEsIGIpID0+IHtcblx0XHRcdHZhciByZXN1bHQ7XG5cdFx0XHRcblx0XHRcdGZvcih2YXIgaSA9IHNvcnRlckNvdW50OyBpPj0gMDsgaS0tKXtcblx0XHRcdFx0bGV0IHNvcnRJdGVtID0gc29ydExpc3RbaV07XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXN1bHQgPSB0aGlzLl9zb3J0Um93KGEsIGIsIHNvcnRJdGVtLmNvbHVtbiwgc29ydEl0ZW0uZGlyLCBzb3J0SXRlbS5wYXJhbXMpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYocmVzdWx0ICE9PSAwKXtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH0pO1xuXHR9XG5cdFxuXHQvL3Byb2Nlc3MgaW5kaXZpZHVhbCByb3dzIGZvciBhIHNvcnQgZnVuY3Rpb24gb24gYWN0aXZlIGRhdGFcblx0X3NvcnRSb3coYSwgYiwgY29sdW1uLCBkaXIsIHBhcmFtcyl7XG5cdFx0dmFyIGVsMUNvbXAsIGVsMkNvbXA7XG5cdFx0XG5cdFx0Ly9zd2l0Y2ggZWxlbWVudHMgZGVwZW5kaW5nIG9uIHNlYXJjaCBkaXJlY3Rpb25cblx0XHR2YXIgZWwxID0gZGlyID09IFwiYXNjXCIgPyBhIDogYjtcblx0XHR2YXIgZWwyID0gZGlyID09IFwiYXNjXCIgPyBiIDogYTtcblx0XHRcblx0XHRhID0gY29sdW1uLmdldEZpZWxkVmFsdWUoZWwxLmdldERhdGEoKSk7XG5cdFx0YiA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKGVsMi5nZXREYXRhKCkpO1xuXHRcdFxuXHRcdGEgPSB0eXBlb2YgYSAhPT0gXCJ1bmRlZmluZWRcIiA/IGEgOiBcIlwiO1xuXHRcdGIgPSB0eXBlb2YgYiAhPT0gXCJ1bmRlZmluZWRcIiA/IGIgOiBcIlwiO1xuXHRcdFxuXHRcdGVsMUNvbXAgPSBlbDEuZ2V0Q29tcG9uZW50KCk7XG5cdFx0ZWwyQ29tcCA9IGVsMi5nZXRDb21wb25lbnQoKTtcblx0XHRcblx0XHRyZXR1cm4gY29sdW1uLm1vZHVsZXMuc29ydC5zb3J0ZXIuY2FsbCh0aGlzLCBhLCBiLCBlbDFDb21wLCBlbDJDb21wLCBjb2x1bW4uZ2V0Q29tcG9uZW50KCksIGRpciwgcGFyYW1zKTtcblx0fVxufVxuXG5jbGFzcyBHcmlkQ2FsY3VsYXRvcntcclxuXHRjb25zdHJ1Y3Rvcihjb2x1bW5zLCByb3dzKXtcclxuXHRcdHRoaXMuY29sdW1uQ291bnQgPSBjb2x1bW5zO1xyXG5cdFx0dGhpcy5yb3dDb3VudCA9IHJvd3M7XHJcblxyXG5cdFx0dGhpcy5jb2x1bW5TdHJpbmcgPSBbXTtcclxuXHRcdHRoaXMuY29sdW1ucyA9IFtdO1xyXG5cdFx0dGhpcy5yb3dzID0gW107XHJcblx0fVxyXG5cclxuXHRnZW5Db2x1bW5zKGRhdGEpe1xyXG5cdFx0dmFyIGNvbENvdW50ID0gTWF0aC5tYXgodGhpcy5jb2x1bW5Db3VudCwgTWF0aC5tYXgoLi4uZGF0YS5tYXAoaXRlbSA9PiBpdGVtLmxlbmd0aCkpKTtcclxuXHJcblx0XHR0aGlzLmNvbHVtblN0cmluZyA9IFtdO1xyXG5cdFx0dGhpcy5jb2x1bW5zID0gW107XHJcblxyXG5cdFx0Zm9yKGxldCBpID0gMTsgaSA8PSBjb2xDb3VudDsgaSsrKXtcclxuXHRcdFx0dGhpcy5pbmNyZW1lbnRDaGFyKHRoaXMuY29sdW1uU3RyaW5nLmxlbmd0aCAtIDEpO1xyXG5cdFx0XHR0aGlzLmNvbHVtbnMucHVzaCh0aGlzLmNvbHVtblN0cmluZy5qb2luKFwiXCIpKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5jb2x1bW5zO1xyXG5cdH1cclxuXHJcblx0Z2VuUm93cyhkYXRhKXtcclxuXHRcdHZhciByb3dDb3VudCA9IE1hdGgubWF4KHRoaXMucm93Q291bnQsIGRhdGEubGVuZ3RoKTtcclxuXHJcblx0XHR0aGlzLnJvd3MgPSBbXTtcclxuXHJcblx0XHRmb3IobGV0IGkgPSAxOyBpIDw9IHJvd0NvdW50OyBpKyspe1xyXG5cdFx0XHR0aGlzLnJvd3MucHVzaChpKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0cmV0dXJuIHRoaXMucm93cztcclxuXHR9XHJcblxyXG5cdGluY3JlbWVudENoYXIoaSl7XHJcblx0XHRsZXQgY2hhciA9IHRoaXMuY29sdW1uU3RyaW5nW2ldO1xyXG5cclxuXHRcdGlmKGNoYXIpe1xyXG5cdFx0XHRpZihjaGFyICE9PSBcIlpcIil7XHJcblx0XHRcdFx0dGhpcy5jb2x1bW5TdHJpbmdbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMuY29sdW1uU3RyaW5nW2ldLmNoYXJDb2RlQXQoMCkgKyAxKTtcclxuXHRcdFx0fWVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuY29sdW1uU3RyaW5nW2ldID0gXCJBXCI7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aWYoaSl7XHJcblx0XHRcdFx0XHR0aGlzLmluY3JlbWVudENoYXIoaS0xKTtcclxuXHRcdFx0XHR9ZWxzZSB7XHJcblx0XHRcdFx0XHR0aGlzLmNvbHVtblN0cmluZy5wdXNoKFwiQVwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1lbHNlIHtcclxuXHRcdFx0dGhpcy5jb2x1bW5TdHJpbmcucHVzaChcIkFcIik7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRzZXRSb3dDb3VudChjb3VudCl7XHJcblx0XHR0aGlzLnJvd0NvdW50ID0gY291bnQ7XHJcblx0fVxyXG5cclxuXHRzZXRDb2x1bW5Db3VudChjb3VudCl7XHJcblx0XHR0aGlzLmNvbHVtbkNvdW50ID0gY291bnQ7XHJcblx0fVxyXG59XG5cbmNsYXNzIFNoZWV0Q29tcG9uZW50IHtcclxuXHRjb25zdHJ1Y3RvcihzaGVldCkge1xyXG5cdFx0dGhpcy5fc2hlZXQgPSBzaGVldDtcclxuXHJcblx0XHRyZXR1cm4gbmV3IFByb3h5KHRoaXMsIHtcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbiAodGFyZ2V0LCBuYW1lLCByZWNlaXZlcikge1xyXG5cdFx0XHRcdGlmICh0eXBlb2YgdGFyZ2V0W25hbWVdICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gdGFyZ2V0W25hbWVdO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gdGFyZ2V0Ll9zaGVldC50YWJsZS5jb21wb25lbnRGdW5jdGlvbkJpbmRlci5oYW5kbGUoXCJzaGVldFwiLCB0YXJnZXQuX3NoZWV0LCBuYW1lKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdGdldFRpdGxlKCl7XHJcblx0XHRyZXR1cm4gdGhpcy5fc2hlZXQudGl0bGU7XHJcblx0fVxyXG5cclxuXHRnZXRLZXkoKXtcclxuXHRcdHJldHVybiB0aGlzLl9zaGVldC5rZXk7XHJcblx0fVxyXG5cclxuXHRnZXREZWZpbml0aW9uKCl7XHJcblx0XHRyZXR1cm4gdGhpcy5fc2hlZXQuZ2V0RGVmaW5pdGlvbigpO1xyXG5cdH1cclxuXHJcblx0Z2V0RGF0YSgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9zaGVldC5nZXREYXRhKCk7XHJcblx0fVxyXG5cclxuXHRzZXREYXRhKGRhdGEpIHtcclxuXHRcdHJldHVybiB0aGlzLl9zaGVldC5zZXREYXRhKGRhdGEpO1xyXG5cdH1cclxuXHJcblx0Y2xlYXIoKXtcclxuXHRcdHJldHVybiB0aGlzLl9zaGVldC5jbGVhcigpO1xyXG5cdH1cclxuXHJcblx0cmVtb3ZlKCl7XHJcblx0XHRyZXR1cm4gdGhpcy5fc2hlZXQucmVtb3ZlKCk7XHJcblx0fVxyXG5cdFxyXG5cdGFjdGl2ZSgpe1xyXG5cdFx0cmV0dXJuIHRoaXMuX3NoZWV0LmFjdGl2ZSgpO1xyXG5cdH1cclxuXHJcblx0c2V0VGl0bGUodGl0bGUpe1xyXG5cdFx0cmV0dXJuIHRoaXMuX3NoZWV0LnNldFRpdGxlKHRpdGxlKTtcclxuXHR9XHJcblxyXG5cdHNldFJvd3Mocm93cyl7XHJcblx0XHRyZXR1cm4gdGhpcy5fc2hlZXQuc2V0Um93cyhyb3dzKTtcclxuXHR9XHJcblxyXG5cdHNldENvbHVtbnMoY29sdW1ucyl7XHJcblx0XHRyZXR1cm4gdGhpcy5fc2hlZXQuc2V0Q29sdW1ucyhjb2x1bW5zKTtcclxuXHR9XHJcbn1cblxuY2xhc3MgU2hlZXQgZXh0ZW5kcyBDb3JlRmVhdHVyZXtcclxuXHRjb25zdHJ1Y3RvcihzcHJlYWRzaGVldE1hbmFnZXIsIGRlZmluaXRpb24pIHtcclxuXHRcdHN1cGVyKHNwcmVhZHNoZWV0TWFuYWdlci50YWJsZSk7XHJcblx0XHRcclxuXHRcdHRoaXMuc3ByZWFkc2hlZXRNYW5hZ2VyID0gc3ByZWFkc2hlZXRNYW5hZ2VyO1xyXG5cdFx0dGhpcy5kZWZpbml0aW9uID0gZGVmaW5pdGlvbjtcclxuXHRcdFxyXG5cdFx0dGhpcy50aXRsZSA9IHRoaXMuZGVmaW5pdGlvbi50aXRsZSB8fCBcIlwiO1xyXG5cdFx0dGhpcy5rZXkgPSB0aGlzLmRlZmluaXRpb24ua2V5IHx8IHRoaXMuZGVmaW5pdGlvbi50aXRsZTtcclxuXHRcdHRoaXMucm93Q291bnQgPSB0aGlzLmRlZmluaXRpb24ucm93cztcclxuXHRcdHRoaXMuY29sdW1uQ291bnQgPSB0aGlzLmRlZmluaXRpb24uY29sdW1ucztcclxuXHRcdHRoaXMuZGF0YSA9IHRoaXMuZGVmaW5pdGlvbi5kYXRhIHx8IFtdO1xyXG5cdFx0dGhpcy5lbGVtZW50ID0gbnVsbDtcclxuXHRcdHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcclxuXHRcdFxyXG5cdFx0dGhpcy5ncmlkID0gbmV3IEdyaWRDYWxjdWxhdG9yKHRoaXMuY29sdW1uQ291bnQsIHRoaXMucm93Q291bnQpO1xyXG5cdFx0XHJcblx0XHR0aGlzLmRlZmF1bHRDb2x1bW5EZWZpbml0aW9uID0ge3dpZHRoOjEwMCwgaGVhZGVySG96QWxpZ246XCJjZW50ZXJcIiwgaGVhZGVyU29ydDpmYWxzZX07XHJcblx0XHR0aGlzLmNvbHVtbkRlZmluaXRpb24gPSBPYmplY3QuYXNzaWduKHRoaXMuZGVmYXVsdENvbHVtbkRlZmluaXRpb24sIHRoaXMub3B0aW9ucyhcInNwcmVhZHNoZWV0Q29sdW1uRGVmaW5pdGlvblwiKSk7XHJcblx0XHRcclxuXHRcdHRoaXMuY29sdW1uRGVmcyA9IFtdO1xyXG5cdFx0dGhpcy5yb3dEZWZzID0gW107XHJcblx0XHR0aGlzLmNvbHVtbkZpZWxkcyA9IFtdO1xyXG5cdFx0dGhpcy5jb2x1bW5zID0gW107XHJcblx0XHR0aGlzLnJvd3MgPSBbXTtcclxuXHRcdFxyXG5cdFx0dGhpcy5zY3JvbGxUb3AgPSBudWxsO1xyXG5cdFx0dGhpcy5zY3JvbGxMZWZ0ID0gbnVsbDtcclxuXHRcdFxyXG5cdFx0dGhpcy5pbml0aWFsaXplKCk7XHJcblx0XHRcclxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInNoZWV0QWRkZWRcIiwgdGhpcy5nZXRDb21wb25lbnQoKSk7XHJcblx0fVxyXG5cdFxyXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblx0Ly8vLy8vLy8vIEluaXRpYWxpemF0aW9uIC8vLy8vLy8vLy9cclxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cdFxyXG5cdGluaXRpYWxpemUoKXtcclxuXHRcdHRoaXMuaW5pdGlhbGl6ZUVsZW1lbnQoKTtcclxuXHRcdHRoaXMuaW5pdGlhbGl6ZUNvbHVtbnMoKTtcclxuXHRcdHRoaXMuaW5pdGlhbGl6ZVJvd3MoKTtcclxuXHR9XHJcblx0XHJcblx0cmVpbml0aWFsaXplKCl7XHJcblx0XHR0aGlzLmluaXRpYWxpemVDb2x1bW5zKCk7XHJcblx0XHR0aGlzLmluaXRpYWxpemVSb3dzKCk7XHJcblx0fVxyXG5cdFxyXG5cdGluaXRpYWxpemVFbGVtZW50KCl7XHJcblx0XHR0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG5cdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itc3ByZWFkc2hlZXQtdGFiXCIpO1xyXG5cdFx0dGhpcy5lbGVtZW50LmlubmVyVGV4dCA9IHRoaXMudGl0bGU7XHJcblx0XHRcclxuXHRcdHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnNwcmVhZHNoZWV0TWFuYWdlci5sb2FkU2hlZXQodGhpcyk7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0XHJcblx0aW5pdGlhbGl6ZUNvbHVtbnMoKXtcclxuXHRcdHRoaXMuZ3JpZC5zZXRDb2x1bW5Db3VudCh0aGlzLmNvbHVtbkNvdW50KTtcclxuXHRcdHRoaXMuY29sdW1uRmllbGRzID0gdGhpcy5ncmlkLmdlbkNvbHVtbnModGhpcy5kYXRhKTtcclxuXHRcdFxyXG5cdFx0dGhpcy5jb2x1bW5EZWZzID0gW107XHJcblx0XHRcclxuXHRcdHRoaXMuY29sdW1uRmllbGRzLmZvckVhY2goKHJlZikgPT4ge1xyXG5cdFx0XHR2YXIgZGVmID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb2x1bW5EZWZpbml0aW9uKTtcclxuXHRcdFx0ZGVmLmZpZWxkID0gcmVmO1xyXG5cdFx0XHRkZWYudGl0bGUgPSByZWY7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmNvbHVtbkRlZnMucHVzaChkZWYpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cdFxyXG5cdGluaXRpYWxpemVSb3dzKCl7XHJcblx0XHR2YXIgcmVmcztcclxuXHRcdFxyXG5cdFx0dGhpcy5ncmlkLnNldFJvd0NvdW50KHRoaXMucm93Q291bnQpO1xyXG5cdFx0XHJcblx0XHRyZWZzID0gdGhpcy5ncmlkLmdlblJvd3ModGhpcy5kYXRhKTtcclxuXHRcdFxyXG5cdFx0dGhpcy5yb3dEZWZzID0gW107XHJcblx0XHRcclxuXHRcdHJlZnMuZm9yRWFjaCgocmVmLCBpKSA9PiB7XHJcblx0XHRcdHZhciBkZWYgPSB7XCJfaWRcIjpyZWZ9O1xyXG5cdFx0XHR2YXIgZGF0YSA9IHRoaXMuZGF0YVtpXTtcclxuXHRcdFx0XHJcblx0XHRcdGlmKGRhdGEpe1xyXG5cdFx0XHRcdGRhdGEuZm9yRWFjaCgodmFsLCBqKSA9PiB7XHJcblx0XHRcdFx0XHR2YXIgZmllbGQgPSB0aGlzLmNvbHVtbkZpZWxkc1tqXTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0aWYoZmllbGQpe1xyXG5cdFx0XHRcdFx0XHRkZWZbZmllbGRdID0gdmFsO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLnJvd0RlZnMucHVzaChkZWYpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cdFxyXG5cdHVubG9hZCgpe1xyXG5cdFx0dGhpcy5pc0FjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0dGhpcy5zY3JvbGxUb3AgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuc2Nyb2xsVG9wO1xyXG5cdFx0dGhpcy5zY3JvbGxMZWZ0ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbExlZnQ7XHJcblx0XHR0aGlzLmRhdGEgPSB0aGlzLmdldERhdGEodHJ1ZSk7XHJcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1zcHJlYWRzaGVldC10YWItYWN0aXZlXCIpO1xyXG5cdH1cclxuXHRcclxuXHRsb2FkKCl7XHJcblx0XHRcclxuXHRcdHZhciB3YXNJbmFjdGl2ZSA9ICF0aGlzLmlzQWN0aXZlO1xyXG5cdFx0XHJcblx0XHR0aGlzLmlzQWN0aXZlID0gdHJ1ZTtcclxuXHRcdHRoaXMudGFibGUuYmxvY2tSZWRyYXcoKTtcclxuXHRcdHRoaXMudGFibGUuc2V0RGF0YShbXSk7XHJcblx0XHR0aGlzLnRhYmxlLnNldENvbHVtbnModGhpcy5jb2x1bW5EZWZzKTtcclxuXHRcdHRoaXMudGFibGUuc2V0RGF0YSh0aGlzLnJvd0RlZnMpO1xyXG5cdFx0dGhpcy50YWJsZS5yZXN0b3JlUmVkcmF3KCk7XHJcblx0XHRcclxuXHRcdGlmKHdhc0luYWN0aXZlICYmIHRoaXMuc2Nyb2xsVG9wICE9PSBudWxsKXtcclxuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsTGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcclxuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXNwcmVhZHNoZWV0LXRhYi1hY3RpdmVcIik7XHJcblx0XHRcclxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInNoZWV0TG9hZGVkXCIsIHRoaXMuZ2V0Q29tcG9uZW50KCkpO1xyXG5cdH1cclxuXHRcclxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cdC8vLy8vLy8vIEhlbHBlciBGdW5jdGlvbnMgLy8vLy8vLy8vXHJcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHRcclxuXHRnZXRDb21wb25lbnQoKXtcclxuXHRcdHJldHVybiBuZXcgU2hlZXRDb21wb25lbnQodGhpcyk7XHJcblx0fVxyXG5cdFxyXG5cdGdldERlZmluaXRpb24oKXtcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHRpdGxlOnRoaXMudGl0bGUsXHJcblx0XHRcdGtleTp0aGlzLmtleSxcclxuXHRcdFx0cm93czp0aGlzLnJvd0NvdW50LFxyXG5cdFx0XHRjb2x1bW5zOnRoaXMuY29sdW1uQ291bnQsXHJcblx0XHRcdGRhdGE6dGhpcy5nZXREYXRhKCksXHJcblx0XHR9O1xyXG5cdH1cclxuXHRcclxuXHRnZXREYXRhKGZ1bGwpe1xyXG5cdFx0dmFyIG91dHB1dCA9IFtdLCBcclxuXHRcdHJvd1dpZHRocyxcclxuXHRcdG91dHB1dFdpZHRoLCBvdXRwdXRIZWlnaHQ7XHJcblx0XHRcclxuXHRcdC8vbWFwIGRhdGEgdG8gYXJyYXkgZm9ybWF0XHJcblx0XHR0aGlzLnJvd0RlZnMuZm9yRWFjaCgocm93RGF0YSkgPT4ge1xyXG5cdFx0XHR2YXIgcm93ID0gW107XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmNvbHVtbkZpZWxkcy5mb3JFYWNoKChmaWVsZCkgPT4ge1xyXG5cdFx0XHRcdHJvdy5wdXNoKHJvd0RhdGFbZmllbGRdKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdFxyXG5cdFx0XHRvdXRwdXQucHVzaChyb3cpO1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHRcdC8vdHJpbSBvdXRwdXRcclxuXHRcdGlmKCFmdWxsICYmICF0aGlzLm9wdGlvbnMoXCJzcHJlYWRzaGVldE91dHB1dEZ1bGxcIikpe1xyXG5cdFx0XHRcclxuXHRcdFx0Ly9jYWxjdWxhdGUgdXNlZCBhcmVhIG9mIGRhdGFcclxuXHRcdFx0cm93V2lkdGhzID0gb3V0cHV0Lm1hcChyb3cgPT4gcm93LmZpbmRMYXN0SW5kZXgodmFsID0+IHR5cGVvZiB2YWwgIT09ICd1bmRlZmluZWQnKSArIDEpO1xyXG5cdFx0XHRvdXRwdXRXaWR0aCA9IE1hdGgubWF4KC4uLnJvd1dpZHRocyk7XHJcblx0XHRcdG91dHB1dEhlaWdodCA9IHJvd1dpZHRocy5maW5kTGFzdEluZGV4KHdpZHRoID0+IHdpZHRoID4gMCkgKyAxO1xyXG5cdFx0XHRcclxuXHRcdFx0b3V0cHV0ID0gb3V0cHV0LnNsaWNlKDAsIG91dHB1dEhlaWdodCk7XHJcblx0XHRcdG91dHB1dCA9IG91dHB1dC5tYXAocm93ID0+IHJvdy5zbGljZSgwLCBvdXRwdXRXaWR0aCkpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gb3V0cHV0O1xyXG5cdH1cclxuXHRcclxuXHRzZXREYXRhKGRhdGEpe1xyXG5cdFx0dGhpcy5kYXRhID0gZGF0YTtcclxuXHRcdHRoaXMucmVpbml0aWFsaXplKCk7XHJcblx0XHRcclxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInNoZWV0VXBkYXRlZFwiLCB0aGlzLmdldENvbXBvbmVudCgpKTtcclxuXHRcdFxyXG5cdFx0aWYodGhpcy5pc0FjdGl2ZSl7XHJcblx0XHRcdHRoaXMubG9hZCgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRjbGVhcigpe1xyXG5cdFx0dGhpcy5zZXREYXRhKFtdKTtcclxuXHR9XHJcblx0XHJcblx0c2V0VGl0bGUodGl0bGUpe1xyXG5cdFx0dGhpcy50aXRsZSA9IHRpdGxlO1xyXG5cdFx0dGhpcy5lbGVtZW50LmlubmVyVGV4dCA9IHRpdGxlO1xyXG5cdFx0XHJcblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJzaGVldFVwZGF0ZWRcIiwgdGhpcy5nZXRDb21wb25lbnQoKSk7XHJcblx0fVxyXG5cdFxyXG5cdHNldFJvd3Mocm93cyl7XHJcblx0XHR0aGlzLnJvd0NvdW50ID0gcm93cztcclxuXHRcdHRoaXMuaW5pdGlhbGl6ZVJvd3MoKTtcclxuXHRcdFxyXG5cdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwic2hlZXRVcGRhdGVkXCIsIHRoaXMuZ2V0Q29tcG9uZW50KCkpO1xyXG5cdFx0XHJcblx0XHRpZih0aGlzLmlzQWN0aXZlKXtcclxuXHRcdFx0dGhpcy5sb2FkKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdHNldENvbHVtbnMoY29sdW1ucyl7XHJcblx0XHR0aGlzLmNvbHVtbkNvdW50ID0gY29sdW1ucztcclxuXHRcdHRoaXMucmVpbml0aWFsaXplKCk7XHJcblx0XHRcclxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInNoZWV0VXBkYXRlZFwiLCB0aGlzLmdldENvbXBvbmVudCgpKTtcclxuXHRcdFxyXG5cdFx0aWYodGhpcy5pc0FjdGl2ZSl7XHJcblx0XHRcdHRoaXMubG9hZCgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRyZW1vdmUoKXtcclxuXHRcdHRoaXMuc3ByZWFkc2hlZXRNYW5hZ2VyLnJlbW92ZVNoZWV0KHRoaXMpO1xyXG5cdH1cclxuXHRcclxuXHRkZXN0cm95KCl7XHJcblx0XHRpZih0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSl7XHJcblx0XHRcdHRoaXMuZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudCk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInNoZWV0UmVtb3ZlZFwiLCB0aGlzLmdldENvbXBvbmVudCgpKTtcclxuXHR9XHJcblx0XHJcblx0YWN0aXZlKCl7XHJcblx0XHR0aGlzLnNwcmVhZHNoZWV0TWFuYWdlci5sb2FkU2hlZXQodGhpcyk7XHJcblx0fVxyXG59XG5cbmNsYXNzIFNwcmVhZHNoZWV0IGV4dGVuZHMgTW9kdWxle1xyXG5cdFxyXG5cdHN0YXRpYyBtb2R1bGVOYW1lID0gXCJzcHJlYWRzaGVldFwiO1xyXG5cdFxyXG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcclxuXHRcdHN1cGVyKHRhYmxlKTtcclxuXHRcdFxyXG5cdFx0dGhpcy5zaGVldHMgPSBbXTtcclxuXHRcdHRoaXMuZWxlbWVudCA9IG51bGw7XHJcblx0XHRcclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNwcmVhZHNoZWV0XCIsIGZhbHNlKTsgXHJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJzcHJlYWRzaGVldFJvd3NcIiwgNTApOyBcclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNwcmVhZHNoZWV0Q29sdW1uc1wiLCA1MCk7IFxyXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwic3ByZWFkc2hlZXRDb2x1bW5EZWZpbml0aW9uXCIsIHt9KTsgXHJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJzcHJlYWRzaGVldE91dHB1dEZ1bGxcIiwgZmFsc2UpOyBcclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNwcmVhZHNoZWV0RGF0YVwiLCBmYWxzZSk7IFxyXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwic3ByZWFkc2hlZXRTaGVldHNcIiwgZmFsc2UpOyBcclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcInNwcmVhZHNoZWV0U2hlZXRUYWJzXCIsIGZhbHNlKTsgXHJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJzcHJlYWRzaGVldFNoZWV0VGFic0VsZW1lbnRcIiwgZmFsc2UpOyBcclxuXHRcdFxyXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJzZXRTaGVldHNcIiwgdGhpcy5zZXRTaGVldHMuYmluZCh0aGlzKSk7XHJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImFkZFNoZWV0XCIsIHRoaXMuYWRkU2hlZXQuYmluZCh0aGlzKSk7XHJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImdldFNoZWV0c1wiLCB0aGlzLmdldFNoZWV0cy5iaW5kKHRoaXMpKTtcclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0U2hlZXREZWZpbml0aW9uc1wiLCB0aGlzLmdldFNoZWV0RGVmaW5pdGlvbnMuYmluZCh0aGlzKSk7XHJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInNldFNoZWV0RGF0YVwiLCB0aGlzLnNldFNoZWV0RGF0YS5iaW5kKHRoaXMpKTtcclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0U2hlZXRcIiwgdGhpcy5nZXRTaGVldC5iaW5kKHRoaXMpKTtcclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwiZ2V0U2hlZXREYXRhXCIsIHRoaXMuZ2V0U2hlZXREYXRhLmJpbmQodGhpcykpO1xyXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJjbGVhclNoZWV0XCIsIHRoaXMuY2xlYXJTaGVldC5iaW5kKHRoaXMpKTtcclxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZUZ1bmN0aW9uKFwicmVtb3ZlU2hlZXRcIiwgdGhpcy5yZW1vdmVTaGVldEZ1bmMuYmluZCh0aGlzKSk7XHJcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcImFjdGl2ZVNoZWV0XCIsIHRoaXMuYWN0aXZlU2hlZXRGdW5jLmJpbmQodGhpcykpO1xyXG5cdH1cclxuXHRcclxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cdC8vLy8vLyBNb2R1bGUgSW5pdGlhbGl6YXRpb24gLy8vLy8vXHJcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHRcclxuXHRcclxuXHRpbml0aWFsaXplKCl7XHJcblx0XHRpZih0aGlzLm9wdGlvbnMoXCJzcHJlYWRzaGVldFwiKSl7XHRcclxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1pbml0aWFsaXplZFwiLCB0aGlzLnRhYmxlSW5pdGlhbGl6ZWQuYmluZCh0aGlzKSk7XHJcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiZGF0YS1sb2FkZWRcIiwgdGhpcy5sb2FkUmVtb3RlRGF0YS5iaW5kKHRoaXMpKTtcclxuXHRcdFx0XHJcblx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5pbmRleCA9IFwiX2lkXCI7XHJcblx0XHRcdFxyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMoXCJzcHJlYWRzaGVldERhdGFcIikgJiYgdGhpcy5vcHRpb25zKFwic3ByZWFkc2hlZXRTaGVldHNcIikpe1xyXG5cdFx0XHRcdGNvbnNvbGUud2FybihcIllvdSBjYW5ub3QgdXNlIHNwcmVhZHNoZWV0RGF0YSBhbmQgc3ByZWFkc2hlZXRTaGVldHMgYXQgdGhlIHNhbWUgdGltZSwgaWdub3Jpbmcgc3ByZWFkc2hlZXREYXRhXCIpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5zcHJlYWRzaGVldERhdGEgPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5jb21wYXRpYmlsaXR5Q2hlY2soKTtcclxuXHRcdFx0XHJcblx0XHRcdGlmKHRoaXMub3B0aW9ucyhcInNwcmVhZHNoZWV0U2hlZXRUYWJzXCIpKXtcclxuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVUYWJzZXQoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRjb21wYXRpYmlsaXR5Q2hlY2soKXtcclxuXHRcdGlmKHRoaXMub3B0aW9ucyhcImRhdGFcIikpe1xyXG5cdFx0XHRjb25zb2xlLndhcm4oXCJEbyBub3QgdXNlIHRoZSBkYXRhIG9wdGlvbiB3aGVuIHdvcmtpbmcgd2l0aCBzcHJlYWRzaGVldHMsIHVzZSBlaXRoZXIgc3ByZWFkc2hlZXREYXRhIG9yIHNwcmVhZHNoZWV0U2hlZXRzIHRvIHBhc3MgZGF0YSBpbnRvIHRoZSB0YWJsZVwiKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0aWYodGhpcy5vcHRpb25zKFwicGFnaW5hdGlvblwiKSl7XHJcblx0XHRcdGNvbnNvbGUud2FybihcIlRoZSBzcHJlYWRzaGVldCBtb2R1bGUgaXMgbm90IGNvbXBhdGlibGUgd2l0aCB0aGUgcGFnaW5hdGlvbiBtb2R1bGVcIik7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmKHRoaXMub3B0aW9ucyhcImdyb3VwQnlcIikpe1xyXG5cdFx0XHRjb25zb2xlLndhcm4oXCJUaGUgc3ByZWFkc2hlZXQgbW9kdWxlIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggdGhlIHJvdyBncm91cGluZyBtb2R1bGVcIik7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmKHRoaXMub3B0aW9ucyhcInJlc3BvbnNpdmVDb2xsYXBzZVwiKSl7XHJcblx0XHRcdGNvbnNvbGUud2FybihcIlRoZSBzcHJlYWRzaGVldCBtb2R1bGUgaXMgbm90IGNvbXBhdGlibGUgd2l0aCB0aGUgcmVzcG9uc2l2ZSBjb2xsYXBzZSBtb2R1bGVcIik7XHJcblx0XHR9XHJcblx0fVxyXG5cdGluaXRpYWxpemVUYWJzZXQoKXtcclxuXHRcdHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1zcHJlYWRzaGVldC10YWJzXCIpO1xyXG5cdFx0dmFyIGFsdENvbnRhaW5lciA9IHRoaXMub3B0aW9ucyhcInNwcmVhZHNoZWV0U2hlZXRUYWJzRWxlbWVudFwiKTtcclxuXHRcdFxyXG5cdFx0aWYoYWx0Q29udGFpbmVyICYmICEoYWx0Q29udGFpbmVyIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKXtcclxuXHRcdFx0YWx0Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhbHRDb250YWluZXIpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYoIWFsdENvbnRhaW5lcil7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiVW5hYmxlIHRvIGZpbmQgZWxlbWVudCBtYXRjaGluZyBzcHJlYWRzaGVldFNoZWV0VGFic0VsZW1lbnQgc2VsZWN0b3I6XCIsIHRoaXMub3B0aW9ucyhcInNwcmVhZHNoZWV0U2hlZXRUYWJzRWxlbWVudFwiKSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0aWYoYWx0Q29udGFpbmVyKXtcclxuXHRcdFx0YWx0Q29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCk7XHJcblx0XHR9ZWxzZSB7XHJcblx0XHRcdHRoaXMuZm9vdGVyQXBwZW5kKHRoaXMuZWxlbWVudCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdHRhYmxlSW5pdGlhbGl6ZWQoKXtcclxuXHRcdGlmKHRoaXMuc2hlZXRzLmxlbmd0aCl7XHJcblx0XHRcdHRoaXMubG9hZFNoZWV0KHRoaXMuc2hlZXRzWzBdKTtcclxuXHRcdH1lbHNlIHtcclxuXHRcdFx0XHJcblx0XHRcdGlmKHRoaXMub3B0aW9ucyhcInNwcmVhZHNoZWV0U2hlZXRzXCIpKXtcclxuXHRcdFx0XHR0aGlzLmxvYWRTaGVldHModGhpcy5vcHRpb25zKFwic3ByZWFkc2hlZXRTaGVldHNcIikpO1xyXG5cdFx0XHR9ZWxzZSBpZih0aGlzLm9wdGlvbnMoXCJzcHJlYWRzaGVldERhdGFcIikpe1xyXG5cdFx0XHRcdHRoaXMubG9hZERhdGEodGhpcy5vcHRpb25zKFwic3ByZWFkc2hlZXREYXRhXCIpKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHQvLy8vLy8vLy8vLyBBamF4IFBhcnNpbmcgLy8vLy8vLy8vL1xyXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5cdGxvYWRSZW1vdGVEYXRhKGRhdGEsIGRhdGExLCBkYXRhMil7XHJcblx0XHRjb25zb2xlLmxvZyhcImRhdGFcIiwgZGF0YSwgZGF0YTEsIGRhdGEyKTtcclxuXHJcblx0XHRpZihBcnJheS5pc0FycmF5KGRhdGEpKXtcclxuXHJcblx0XHRcdHRoaXMudGFibGUuZGF0YUxvYWRlci5jbGVhckFsZXJ0KCk7XHJcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImRhdGFMb2FkZWRcIiwgZGF0YSk7XHJcblxyXG5cdFx0XHRpZighZGF0YS5sZW5ndGggfHwgQXJyYXkuaXNBcnJheShkYXRhWzBdKSl7XHJcblx0XHRcdFx0dGhpcy5sb2FkRGF0YShkYXRhKTtcclxuXHRcdFx0fWVsc2Uge1xyXG5cdFx0XHRcdHRoaXMubG9hZFNoZWV0cyhkYXRhKTtcclxuXHRcdFx0fVxyXG5cdFx0fWVsc2Uge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKFwiU3ByZWFkc2hlZXQgTG9hZGluZyBFcnJvciAtIFVuYWJsZSB0byBwcm9jZXNzIHJlbW90ZSBkYXRhIGR1ZSB0byBpbnZhbGlkIGRhdGEgdHlwZSBcXG5FeHBlY3Rpbmc6IGFycmF5IFxcblJlY2VpdmVkOiBcIiwgdHlwZW9mIGRhdGEsIFwiXFxuRGF0YTogICAgIFwiLCBkYXRhKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fVxyXG5cclxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cdC8vLy8vLy8vLyBTaGVldCBNYW5hZ2VtZW50IC8vLy8vLy8vXHJcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHRcclxuXHRcclxuXHRsb2FkRGF0YShkYXRhKXtcclxuXHRcdHZhciBkZWYgPSB7XHJcblx0XHRcdGRhdGE6ZGF0YSxcclxuXHRcdH07XHJcblx0XHRcclxuXHRcdHRoaXMubG9hZFNoZWV0KHRoaXMubmV3U2hlZXQoZGVmKSk7XHJcblx0fVxyXG5cdFxyXG5cdGRlc3Ryb3lTaGVldHMoKXtcclxuXHRcdHRoaXMuc2hlZXRzLmZvckVhY2goKHNoZWV0KSA9PiB7XHJcblx0XHRcdHNoZWV0LmRlc3Ryb3koKTtcclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHR0aGlzLnNoZWV0cyA9IFtdO1xyXG5cdFx0dGhpcy5hY3RpdmVTaGVldCA9IG51bGw7XHJcblx0fVxyXG5cdFxyXG5cdGxvYWRTaGVldHMoc2hlZXRzKXtcdFxyXG5cdFx0aWYoIUFycmF5LmlzQXJyYXkoc2hlZXRzKSl7XHJcblx0XHRcdHNoZWV0cyA9IFtdO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR0aGlzLmRlc3Ryb3lTaGVldHMoKTtcclxuXHRcdFxyXG5cdFx0c2hlZXRzLmZvckVhY2goKGRlZikgPT4ge1xyXG5cdFx0XHR0aGlzLm5ld1NoZWV0KGRlZik7XHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0dGhpcy5sb2FkU2hlZXQodGhpcy5zaGVldHNbMF0pO1xyXG5cdH1cclxuXHRcclxuXHRsb2FkU2hlZXQoc2hlZXQpe1xyXG5cdFx0aWYodGhpcy5hY3RpdmVTaGVldCAhPT0gc2hlZXQpe1xyXG5cdFx0XHRpZih0aGlzLmFjdGl2ZVNoZWV0KXtcclxuXHRcdFx0XHR0aGlzLmFjdGl2ZVNoZWV0LnVubG9hZCgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmFjdGl2ZVNoZWV0ID0gc2hlZXQ7XHJcblx0XHRcdFxyXG5cdFx0XHRzaGVldC5sb2FkKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdG5ld1NoZWV0KGRlZmluaXRpb24gPSB7fSl7XHJcblx0XHR2YXIgc2hlZXQ7XHJcblx0XHRcclxuXHRcdGlmKCFkZWZpbml0aW9uLnJvd3Mpe1xyXG5cdFx0XHRkZWZpbml0aW9uLnJvd3MgPSB0aGlzLm9wdGlvbnMoXCJzcHJlYWRzaGVldFJvd3NcIik7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmKCFkZWZpbml0aW9uLmNvbHVtbnMpe1xyXG5cdFx0XHRkZWZpbml0aW9uLmNvbHVtbnMgPSB0aGlzLm9wdGlvbnMoXCJzcHJlYWRzaGVldENvbHVtbnNcIik7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHNoZWV0ID0gbmV3IFNoZWV0KHRoaXMsIGRlZmluaXRpb24pO1xyXG5cdFx0XHJcblx0XHR0aGlzLnNoZWV0cy5wdXNoKHNoZWV0KTtcclxuXHRcdFxyXG5cdFx0aWYodGhpcy5lbGVtZW50KXtcclxuXHRcdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHNoZWV0LmVsZW1lbnQpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gc2hlZXQ7XHJcblx0fVxyXG5cdFxyXG5cdHJlbW92ZVNoZWV0KHNoZWV0KXtcclxuXHRcdHZhciBpbmRleCA9IHRoaXMuc2hlZXRzLmluZGV4T2Yoc2hlZXQpLFxyXG5cdFx0cHJldlNoZWV0O1xyXG5cdFx0XHJcblx0XHRpZih0aGlzLnNoZWV0cy5sZW5ndGggPiAxKXtcclxuXHRcdFx0aWYoaW5kZXggPiAtMSl7XHJcblx0XHRcdFx0dGhpcy5zaGVldHMuc3BsaWNlKGluZGV4LCAxKTtcclxuXHRcdFx0XHRzaGVldC5kZXN0cm95KCk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aWYodGhpcy5hY3RpdmVTaGVldCA9PT0gc2hlZXQpe1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRwcmV2U2hlZXQgPSB0aGlzLnNoZWV0c1tpbmRleCAtIDFdIHx8IHRoaXMuc2hlZXRzWzBdO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRpZihwcmV2U2hlZXQpe1xyXG5cdFx0XHRcdFx0XHR0aGlzLmxvYWRTaGVldChwcmV2U2hlZXQpO1xyXG5cdFx0XHRcdFx0fWVsc2Uge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmFjdGl2ZVNoZWV0ID0gbnVsbDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1lbHNlIHtcclxuXHRcdFx0Y29uc29sZS53YXJuKFwiVW5hYmxlIHRvIHJlbW92ZSBzaGVldCwgYXQgbGVhc3Qgb25lIHNoZWV0IG11c3QgYmUgYWN0aXZlXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRsb29rdXBTaGVldChrZXkpe1xyXG5cdFx0aWYoIWtleSl7XHJcblx0XHRcdHJldHVybiB0aGlzLmFjdGl2ZVNoZWV0O1xyXG5cdFx0fWVsc2UgaWYoa2V5IGluc3RhbmNlb2YgU2hlZXQpe1xyXG5cdFx0XHRyZXR1cm4ga2V5O1xyXG5cdFx0fWVsc2UgaWYoa2V5IGluc3RhbmNlb2YgU2hlZXRDb21wb25lbnQpe1xyXG5cdFx0XHRyZXR1cm4ga2V5Ll9zaGVldDtcclxuXHRcdH1lbHNlIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuc2hlZXRzLmZpbmQoc2hlZXQgPT4gc2hlZXQua2V5ID09PSBrZXkpIHx8IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRcclxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cdC8vLy8vLy8vIFB1YmxpYyBGdW5jdGlvbnMgLy8vLy8vLy8vXHJcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHRcclxuXHRzZXRTaGVldHMoc2hlZXRzKXtcclxuXHRcdHRoaXMubG9hZFNoZWV0cyhzaGVldHMpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzLmdldFNoZWV0cygpO1xyXG5cdH1cclxuXHJcblx0YWRkU2hlZXQoc2hlZXQpe1xyXG5cdFx0cmV0dXJuIHRoaXMubmV3U2hlZXQoc2hlZXQpLmdldENvbXBvbmVudCgpO1xyXG5cdH1cclxuXHRcclxuXHRnZXRTaGVldERlZmluaXRpb25zKCl7XHJcblx0XHRyZXR1cm4gdGhpcy5zaGVldHMubWFwKHNoZWV0ID0+IHNoZWV0LmdldERlZmluaXRpb24oKSk7XHJcblx0fVxyXG5cdFxyXG5cdGdldFNoZWV0cygpe1xyXG5cdFx0cmV0dXJuIHRoaXMuc2hlZXRzLm1hcChzaGVldCA9PiBzaGVldC5nZXRDb21wb25lbnQoKSk7XHJcblx0fVxyXG5cdFxyXG5cdGdldFNoZWV0KGtleSl7XHJcblx0XHR2YXIgc2hlZXQgPSB0aGlzLmxvb2t1cFNoZWV0KGtleSk7XHJcblx0XHRcclxuXHRcdHJldHVybiBzaGVldCA/IHNoZWV0LmdldENvbXBvbmVudCgpIDogZmFsc2U7XHJcblx0fVxyXG5cdFxyXG5cdHNldFNoZWV0RGF0YShrZXksIGRhdGEpe1xyXG5cdFx0aWYgKGtleSAmJiAhZGF0YSl7XHJcblx0XHRcdGRhdGEgPSBrZXk7XHJcblx0XHRcdGtleSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR2YXIgc2hlZXQgPSB0aGlzLmxvb2t1cFNoZWV0KGtleSk7XHJcblx0XHRcclxuXHRcdHJldHVybiBzaGVldCA/IHNoZWV0LnNldERhdGEoZGF0YSkgOiBmYWxzZTtcdFxyXG5cdH1cclxuXHRcclxuXHRnZXRTaGVldERhdGEoa2V5KXtcclxuXHRcdHZhciBzaGVldCA9IHRoaXMubG9va3VwU2hlZXQoa2V5KTtcclxuXHRcdFxyXG5cdFx0cmV0dXJuIHNoZWV0ID8gc2hlZXQuZ2V0RGF0YSgpIDogZmFsc2U7XHRcclxuXHR9XHJcblx0XHJcblx0Y2xlYXJTaGVldChrZXkpe1xyXG5cdFx0dmFyIHNoZWV0ID0gdGhpcy5sb29rdXBTaGVldChrZXkpO1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gc2hlZXQgPyBzaGVldC5jbGVhcigpIDogZmFsc2U7XHJcblx0fVxyXG5cdFxyXG5cdHJlbW92ZVNoZWV0RnVuYyhrZXkpe1xyXG5cdFx0dmFyIHNoZWV0ID0gdGhpcy5sb29rdXBTaGVldChrZXkpO1xyXG5cdFx0XHJcblx0XHRpZihzaGVldCl7XHJcblx0XHRcdHRoaXMucmVtb3ZlU2hlZXQoc2hlZXQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRhY3RpdmVTaGVldEZ1bmMoa2V5KXtcclxuXHRcdHZhciBzaGVldCA9IHRoaXMubG9va3VwU2hlZXQoa2V5KTtcclxuXHRcdFxyXG5cdFx0cmV0dXJuIHNoZWV0ID8gdGhpcy5sb2FkU2hlZXQoc2hlZXQpIDogZmFsc2U7XHJcblx0fVxyXG59XG5cbmNsYXNzIFRvb2x0aXAgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcInRvb2x0aXBcIjtcblx0XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy50b29sdGlwU3Vic2NyaWJlciA9IG51bGwsXG5cdFx0dGhpcy5oZWFkZXJTdWJzY3JpYmVyID0gbnVsbCxcblx0XHRcblx0XHR0aGlzLnRpbWVvdXQgPSBudWxsO1xuXHRcdHRoaXMucG9wdXBJbnN0YW5jZSA9IG51bGw7XG5cdFx0XG5cdFx0Ly8gdGhpcy5yZWdpc3RlclRhYmxlT3B0aW9uKFwidG9vbHRpcEdlbmVyYXRpb25Nb2RlXCIsIHVuZGVmaW5lZCk7ICAvL2RlcHJlY2F0ZWRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJ0b29sdGlwRGVsYXlcIiwgMzAwKTsgXG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcInRvb2x0aXBcIik7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtbk9wdGlvbihcImhlYWRlclRvb2x0aXBcIik7XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLmRlcHJlY2F0ZWRPcHRpb25zQ2hlY2soKTtcblx0XHRcblx0XHR0aGlzLnN1YnNjcmliZShcImNvbHVtbi1pbml0XCIsIHRoaXMuaW5pdGlhbGl6ZUNvbHVtbi5iaW5kKHRoaXMpKTtcblx0fVxuXHRcblx0ZGVwcmVjYXRlZE9wdGlvbnNDaGVjaygpe1xuXHRcdC8vIHRoaXMuZGVwcmVjYXRpb25DaGVja01zZyhcInRvb2x0aXBHZW5lcmF0aW9uTW9kZVwiLCBcIlRoaXMgb3B0aW9uIGlzIG5vIGxvbmdlciBuZWVkZWQgYXMgdG9vbHRpcHMgYXJlIGFsd2F5cyBnZW5lcmF0ZWQgb24gaG92ZXIgbm93XCIpO1xuXHR9XHRcblx0XG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHRpZihjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJUb29sdGlwICYmICF0aGlzLmhlYWRlclN1YnNjcmliZXIpe1xuXHRcdFx0dGhpcy5oZWFkZXJTdWJzY3JpYmVyID0gdHJ1ZTtcblx0XHRcdFxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tbW91c2Vtb3ZlXCIsIHRoaXMubW91c2Vtb3ZlQ2hlY2suYmluZCh0aGlzLCBcImhlYWRlclRvb2x0aXBcIikpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjb2x1bW4tbW91c2VvdXRcIiwgdGhpcy5tb3VzZW91dENoZWNrLmJpbmQodGhpcywgXCJoZWFkZXJUb29sdGlwXCIpKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoY29sdW1uLmRlZmluaXRpb24udG9vbHRpcCAmJiAhdGhpcy50b29sdGlwU3Vic2NyaWJlcil7XG5cdFx0XHR0aGlzLnRvb2x0aXBTdWJzY3JpYmVyID0gdHJ1ZTtcblx0XHRcdFxuXHRcdFx0dGhpcy5zdWJzY3JpYmUoXCJjZWxsLW1vdXNlbW92ZVwiLCB0aGlzLm1vdXNlbW92ZUNoZWNrLmJpbmQodGhpcywgXCJ0b29sdGlwXCIpKTtcblx0XHRcdHRoaXMuc3Vic2NyaWJlKFwiY2VsbC1tb3VzZW91dFwiLCB0aGlzLm1vdXNlb3V0Q2hlY2suYmluZCh0aGlzLCBcInRvb2x0aXBcIikpO1xuXHRcdH1cblx0fVxuXHRcblx0bW91c2Vtb3ZlQ2hlY2soYWN0aW9uLCBlLCBjb21wb25lbnQpe1xuXHRcdHZhciB0b29sdGlwID0gYWN0aW9uID09PSBcInRvb2x0aXBcIiA/IGNvbXBvbmVudC5jb2x1bW4uZGVmaW5pdGlvbi50b29sdGlwIDogY29tcG9uZW50LmRlZmluaXRpb24uaGVhZGVyVG9vbHRpcDtcblx0XHRcblx0XHRpZih0b29sdGlwKXtcblx0XHRcdHRoaXMuY2xlYXJQb3B1cCgpO1xuXHRcdFx0dGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCh0aGlzLmxvYWRUb29sdGlwLmJpbmQodGhpcywgZSwgY29tcG9uZW50LCB0b29sdGlwKSwgdGhpcy50YWJsZS5vcHRpb25zLnRvb2x0aXBEZWxheSk7XG5cdFx0fVxuXHR9XG5cblx0bW91c2VvdXRDaGVjayhhY3Rpb24sIGUsIGNvbXBvbmVudCl7XG5cdFx0aWYoIXRoaXMucG9wdXBJbnN0YW5jZSl7XG5cdFx0XHR0aGlzLmNsZWFyUG9wdXAoKTtcblx0XHR9XG5cdH1cblx0XG5cdGNsZWFyUG9wdXAoYWN0aW9uLCBlLCBjb21wb25lbnQpe1xuXHRcdGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuXHRcdHRoaXMudGltZW91dCA9IG51bGw7XG5cdFx0XG5cdFx0aWYodGhpcy5wb3B1cEluc3RhbmNlKXtcblx0XHRcdHRoaXMucG9wdXBJbnN0YW5jZS5oaWRlKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRsb2FkVG9vbHRpcChlLCBjb21wb25lbnQsIHRvb2x0aXApe1xuXHRcdHZhciBjb250ZW50c0VsLCByZW5kZXJlZENhbGxiYWNrLCBjb29yZHM7XG5cblx0XHRmdW5jdGlvbiBvblJlbmRlcmVkKGNhbGxiYWNrKXtcblx0XHRcdHJlbmRlcmVkQ2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHR9XG5cdFx0XG5cdFx0aWYodHlwZW9mIHRvb2x0aXAgPT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHR0b29sdGlwID0gdG9vbHRpcChlLCBjb21wb25lbnQuZ2V0Q29tcG9uZW50KCksIG9uUmVuZGVyZWQpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0b29sdGlwIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpe1xuXHRcdFx0Y29udGVudHNFbCA9IHRvb2x0aXA7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29udGVudHNFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRcblx0XHRcdGlmKHRvb2x0aXAgPT09IHRydWUpe1xuXHRcdFx0XHRpZihjb21wb25lbnQgaW5zdGFuY2VvZiBDZWxsKXtcblx0XHRcdFx0XHR0b29sdGlwID0gY29tcG9uZW50LnZhbHVlO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0aWYoY29tcG9uZW50LmRlZmluaXRpb24uZmllbGQpe1xuXHRcdFx0XHRcdFx0dGhpcy5sYW5nQmluZChcImNvbHVtbnN8XCIgKyBjb21wb25lbnQuZGVmaW5pdGlvbi5maWVsZCwgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGNvbnRlbnRzRWwuaW5uZXJIVE1MID0gdG9vbHRpcCA9IHZhbHVlIHx8IGNvbXBvbmVudC5kZWZpbml0aW9uLnRpdGxlO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0dG9vbHRpcCA9IGNvbXBvbmVudC5kZWZpbml0aW9uLnRpdGxlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb250ZW50c0VsLmlubmVySFRNTCA9IHRvb2x0aXA7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRvb2x0aXAgfHwgdG9vbHRpcCA9PT0gMCB8fCB0b29sdGlwID09PSBmYWxzZSl7XG5cdFx0XHRjb250ZW50c0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItdG9vbHRpcFwiKTtcblxuXHRcdFx0Y29udGVudHNFbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGUgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5wb3B1cEluc3RhbmNlID0gdGhpcy5wb3B1cChjb250ZW50c0VsKTtcblx0XHRcdFxuXHRcdFx0aWYodHlwZW9mIHJlbmRlcmVkQ2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdHRoaXMucG9wdXBJbnN0YW5jZS5yZW5kZXJDYWxsYmFjayhyZW5kZXJlZENhbGxiYWNrKTtcblx0XHRcdH1cblxuXHRcdFx0Y29vcmRzID0gdGhpcy5wb3B1cEluc3RhbmNlLmNvbnRhaW5lckV2ZW50Q29vcmRzKGUpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnBvcHVwSW5zdGFuY2Uuc2hvdyhjb29yZHMueCArIDE1LCBjb29yZHMueSArIDE1KS5oaWRlT25CbHVyKCgpID0+IHtcblx0XHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiVG9vbHRpcENsb3NlZFwiLCBjb21wb25lbnQuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0XHR0aGlzLnBvcHVwSW5zdGFuY2UgPSBudWxsO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcIlRvb2x0aXBPcGVuZWRcIiwgY29tcG9uZW50LmdldENvbXBvbmVudCgpKTtcblx0XHR9XG5cdH1cbn1cblxudmFyIGRlZmF1bHRWYWxpZGF0b3JzID0ge1xuXHQvL2lzIGludGVnZXJcblx0aW50ZWdlcjogZnVuY3Rpb24oY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpe1xuXHRcdGlmKHZhbHVlID09PSBcIlwiIHx8IHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHR2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XG5cblx0XHRyZXR1cm4gIWlzTmFOKHZhbHVlKSAmJiBpc0Zpbml0ZSh2YWx1ZSkgJiYgTWF0aC5mbG9vcih2YWx1ZSkgPT09IHZhbHVlO1xuXHR9LFxuXG5cdC8vaXMgZmxvYXRcblx0ZmxvYXQ6IGZ1bmN0aW9uKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKXtcblx0XHRpZih2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdFxuXHRcdHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcblxuXHRcdHJldHVybiAhaXNOYU4odmFsdWUpICYmIGlzRmluaXRlKHZhbHVlKSAmJiB2YWx1ZSAlIDEgIT09IDA7XG5cdH0sXG5cblx0Ly9tdXN0IGJlIGEgbnVtYmVyXG5cdG51bWVyaWM6IGZ1bmN0aW9uKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKXtcblx0XHRpZih2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiAhaXNOYU4odmFsdWUpO1xuXHR9LFxuXG5cdC8vbXVzdCBiZSBhIHN0cmluZ1xuXHRzdHJpbmc6IGZ1bmN0aW9uKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKXtcblx0XHRpZih2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBpc05hTih2YWx1ZSk7XG5cdH0sXG5cblx0Ly9tdXN0IGJlIGFscGhhbnVtZXJpY1xuXHRhbHBoYW51bWVyaWM6IGZ1bmN0aW9uKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKXtcblx0XHRpZih2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0dmFyIHJlZyA9IG5ldyBSZWdFeHAoL15bYS16MC05XSskL2kpO1xuXG5cdFx0cmV0dXJuIHJlZy50ZXN0KHZhbHVlKTtcblx0fSxcblxuXHQvL21heGltdW0gdmFsdWVcblx0bWF4OiBmdW5jdGlvbihjZWxsLCB2YWx1ZSwgcGFyYW1ldGVycyl7XG5cdFx0aWYodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkgPD0gcGFyYW1ldGVycztcblx0fSxcblxuXHQvL21pbmltdW0gdmFsdWVcblx0bWluOiBmdW5jdGlvbihjZWxsLCB2YWx1ZSwgcGFyYW1ldGVycyl7XG5cdFx0aWYodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkgPj0gcGFyYW1ldGVycztcblx0fSxcblxuXHQvL3N0YXJ0cyB3aXRoICB2YWx1ZVxuXHRzdGFydHM6IGZ1bmN0aW9uKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKXtcblx0XHRpZih2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChTdHJpbmcocGFyYW1ldGVycykudG9Mb3dlckNhc2UoKSk7XG5cdH0sXG5cblx0Ly9lbmRzIHdpdGggIHZhbHVlXG5cdGVuZHM6IGZ1bmN0aW9uKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKXtcblx0XHRpZih2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoU3RyaW5nKHBhcmFtZXRlcnMpLnRvTG93ZXJDYXNlKCkpO1xuXHR9LFxuXG5cblx0Ly9taW5pbXVtIHN0cmluZyBsZW5ndGhcblx0bWluTGVuZ3RoOiBmdW5jdGlvbihjZWxsLCB2YWx1ZSwgcGFyYW1ldGVycyl7XG5cdFx0aWYodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gU3RyaW5nKHZhbHVlKS5sZW5ndGggPj0gcGFyYW1ldGVycztcblx0fSxcblxuXHQvL21heGltdW0gc3RyaW5nIGxlbmd0aFxuXHRtYXhMZW5ndGg6IGZ1bmN0aW9uKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKXtcblx0XHRpZih2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBTdHJpbmcodmFsdWUpLmxlbmd0aCA8PSBwYXJhbWV0ZXJzO1xuXHR9LFxuXG5cdC8vaW4gcHJvdmlkZWQgdmFsdWUgbGlzdFxuXHRpbjogZnVuY3Rpb24oY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpe1xuXHRcdGlmKHZhbHVlID09PSBcIlwiIHx8IHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZih0eXBlb2YgcGFyYW1ldGVycyA9PSBcInN0cmluZ1wiKXtcblx0XHRcdHBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzLnNwbGl0KFwifFwiKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gcGFyYW1ldGVycy5pbmRleE9mKHZhbHVlKSA+IC0xO1xuXHR9LFxuXG5cdC8vbXVzdCBtYXRjaCBwcm92aWRlZCByZWdleFxuXHRyZWdleDogZnVuY3Rpb24oY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpe1xuXHRcdGlmKHZhbHVlID09PSBcIlwiIHx8IHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0dmFyIHJlZyA9IG5ldyBSZWdFeHAocGFyYW1ldGVycyk7XG5cblx0XHRyZXR1cm4gcmVnLnRlc3QodmFsdWUpO1xuXHR9LFxuXG5cdC8vdmFsdWUgbXVzdCBiZSB1bmlxdWUgaW4gdGhpcyBjb2x1bW5cblx0dW5pcXVlOiBmdW5jdGlvbihjZWxsLCB2YWx1ZSwgcGFyYW1ldGVycyl7XG5cdFx0aWYodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHR2YXIgdW5pcXVlID0gdHJ1ZTtcblxuXHRcdHZhciBjZWxsRGF0YSA9IGNlbGwuZ2V0RGF0YSgpO1xuXHRcdHZhciBjb2x1bW4gPSBjZWxsLmdldENvbHVtbigpLl9nZXRTZWxmKCk7XG5cblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucm93cy5mb3JFYWNoKGZ1bmN0aW9uKHJvdyl7XG5cdFx0XHR2YXIgZGF0YSA9IHJvdy5nZXREYXRhKCk7XG5cblx0XHRcdGlmKGRhdGEgIT09IGNlbGxEYXRhKXtcblx0XHRcdFx0aWYodmFsdWUgPT0gY29sdW1uLmdldEZpZWxkVmFsdWUoZGF0YSkpe1xuXHRcdFx0XHRcdHVuaXF1ZSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gdW5pcXVlO1xuXHR9LFxuXG5cdC8vbXVzdCBoYXZlIGEgdmFsdWVcblx0cmVxdWlyZWQ6ZnVuY3Rpb24oY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpe1xuXHRcdHJldHVybiB2YWx1ZSAhPT0gXCJcIiAmJiB2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCI7XG5cdH0sXG59O1xuXG5jbGFzcyBWYWxpZGF0ZSBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwidmFsaWRhdGVcIjtcblxuXHQvL2xvYWQgZGVmYXVsdHNcblx0c3RhdGljIHZhbGlkYXRvcnMgPSBkZWZhdWx0VmFsaWRhdG9ycztcblx0XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy5pbnZhbGlkQ2VsbHMgPSBbXTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJ2YWxpZGF0aW9uTW9kZVwiLCBcImJsb2NraW5nXCIpO1xuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJ2YWxpZGF0b3JcIik7XG5cdFx0XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRJbnZhbGlkQ2VsbHNcIiwgdGhpcy5nZXRJbnZhbGlkQ2VsbHMuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJjbGVhckNlbGxWYWxpZGF0aW9uXCIsIHRoaXMudXNlckNsZWFyQ2VsbFZhbGlkYXRpb24uYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJ2YWxpZGF0ZVwiLCB0aGlzLnVzZXJWYWxpZGF0ZS5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHR0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RnVuY3Rpb24oXCJjZWxsXCIsIFwiaXNWYWxpZFwiLCB0aGlzLmNlbGxJc1ZhbGlkLmJpbmQodGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNlbGxcIiwgXCJjbGVhclZhbGlkYXRpb25cIiwgdGhpcy5jbGVhclZhbGlkYXRpb24uYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwiY2VsbFwiLCBcInZhbGlkYXRlXCIsIHRoaXMuY2VsbFZhbGlkYXRlLmJpbmQodGhpcykpO1xuXHRcdFxuXHRcdHRoaXMucmVnaXN0ZXJDb21wb25lbnRGdW5jdGlvbihcImNvbHVtblwiLCBcInZhbGlkYXRlXCIsIHRoaXMuY29sdW1uVmFsaWRhdGUuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckNvbXBvbmVudEZ1bmN0aW9uKFwicm93XCIsIFwidmFsaWRhdGVcIiwgdGhpcy5yb3dWYWxpZGF0ZS5iaW5kKHRoaXMpKTtcblx0fVxuXHRcblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLnN1YnNjcmliZShcImNlbGwtZGVsZXRlXCIsIHRoaXMuY2xlYXJWYWxpZGF0aW9uLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWxheW91dFwiLCB0aGlzLmluaXRpYWxpemVDb2x1bW5DaGVjay5iaW5kKHRoaXMpKTtcblx0XHRcblx0XHR0aGlzLnN1YnNjcmliZShcImVkaXQtc3VjY2Vzc1wiLCB0aGlzLmVkaXRWYWxpZGF0ZS5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1YnNjcmliZShcImVkaXQtZWRpdG9yLWNsZWFyXCIsIHRoaXMuZWRpdG9yQ2xlYXIuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJlZGl0LWVkaXRlZC1jbGVhclwiLCB0aGlzLmVkaXRlZENsZWFyLmJpbmQodGhpcykpO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gRXZlbnQgSGFuZGxpbmcgLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0ZWRpdFZhbGlkYXRlKGNlbGwsIHZhbHVlLCBwcmV2aW91c1ZhbHVlKXtcblx0XHR2YXIgdmFsaWQgPSB0aGlzLnRhYmxlLm9wdGlvbnMudmFsaWRhdGlvbk1vZGUgIT09IFwibWFudWFsXCIgPyB0aGlzLnZhbGlkYXRlKGNlbGwuY29sdW1uLm1vZHVsZXMudmFsaWRhdGUsIGNlbGwsIHZhbHVlKSA6IHRydWU7XG5cdFx0XG5cdFx0Ly8gYWxsb3cgdGltZSBmb3IgZWRpdG9yIHRvIG1ha2UgcmVuZGVyIGNoYW5nZXMgdGhlbiBzdHlsZSBjZWxsXG5cdFx0aWYodmFsaWQgIT09IHRydWUpe1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGNlbGwuZ2V0RWxlbWVudCgpLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItdmFsaWRhdGlvbi1mYWlsXCIpO1xuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJ2YWxpZGF0aW9uRmFpbGVkXCIsIGNlbGwuZ2V0Q29tcG9uZW50KCksIHZhbHVlLCB2YWxpZCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHZhbGlkO1xuXHR9XG5cdFxuXHRlZGl0b3JDbGVhcihjZWxsLCBjYW5jZWxsZWQpe1xuXHRcdGlmKGNhbmNlbGxlZCl7XG5cdFx0XHRpZihjZWxsLmNvbHVtbi5tb2R1bGVzLnZhbGlkYXRlKXtcblx0XHRcdFx0dGhpcy5jZWxsVmFsaWRhdGUoY2VsbCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y2VsbC5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci12YWxpZGF0aW9uLWZhaWxcIik7XG5cdH1cblx0XG5cdGVkaXRlZENsZWFyKGNlbGwpe1xuXHRcdGlmKGNlbGwubW9kdWxlcy52YWxpZGF0ZSl7XG5cdFx0XHRjZWxsLm1vZHVsZXMudmFsaWRhdGUuaW52YWxpZCA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLyBDZWxsIEZ1bmN0aW9ucyAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdGNlbGxJc1ZhbGlkKGNlbGwpe1xuXHRcdHJldHVybiBjZWxsLm1vZHVsZXMudmFsaWRhdGUgPyAoY2VsbC5tb2R1bGVzLnZhbGlkYXRlLmludmFsaWQgfHwgdHJ1ZSkgOiB0cnVlO1xuXHR9XG5cdFxuXHRjZWxsVmFsaWRhdGUoY2VsbCl7XG5cdFx0cmV0dXJuIHRoaXMudmFsaWRhdGUoY2VsbC5jb2x1bW4ubW9kdWxlcy52YWxpZGF0ZSwgY2VsbCwgY2VsbC5nZXRWYWx1ZSgpKTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIENvbHVtbiBGdW5jdGlvbnMgLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdGNvbHVtblZhbGlkYXRlKGNvbHVtbil7XG5cdFx0dmFyIGludmFsaWQgPSBbXTtcblx0XHRcblx0XHRjb2x1bW4uY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuXHRcdFx0aWYodGhpcy5jZWxsVmFsaWRhdGUoY2VsbCkgIT09IHRydWUpe1xuXHRcdFx0XHRpbnZhbGlkLnB1c2goY2VsbC5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIGludmFsaWQubGVuZ3RoID8gaW52YWxpZCA6IHRydWU7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8gUm93IEZ1bmN0aW9ucyAvLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRyb3dWYWxpZGF0ZShyb3cpe1xuXHRcdHZhciBpbnZhbGlkID0gW107XG5cdFx0XG5cdFx0cm93LmNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcblx0XHRcdGlmKHRoaXMuY2VsbFZhbGlkYXRlKGNlbGwpICE9PSB0cnVlKXtcblx0XHRcdFx0aW52YWxpZC5wdXNoKGNlbGwuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBpbnZhbGlkLmxlbmd0aCA/IGludmFsaWQgOiB0cnVlO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vLy8gVGFibGUgRnVuY3Rpb25zIC8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0XG5cdHVzZXJDbGVhckNlbGxWYWxpZGF0aW9uKGNlbGxzKXtcblx0XHRpZighY2VsbHMpe1xuXHRcdFx0Y2VsbHMgPSB0aGlzLmdldEludmFsaWRDZWxscygpO1xuXHRcdH1cblx0XHRcblx0XHRpZighQXJyYXkuaXNBcnJheShjZWxscykpe1xuXHRcdFx0Y2VsbHMgPSBbY2VsbHNdO1xuXHRcdH1cblx0XHRcblx0XHRjZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG5cdFx0XHR0aGlzLmNsZWFyVmFsaWRhdGlvbihjZWxsLl9nZXRTZWxmKCkpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHR1c2VyVmFsaWRhdGUoY2VsbHMpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcblx0XHQvL2NsZWFyIHJvdyBkYXRhXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRyb3cgPSByb3cuZ2V0Q29tcG9uZW50KCk7XG5cdFx0XHRcblx0XHRcdHZhciB2YWxpZCA9IHJvdy52YWxpZGF0ZSgpO1xuXHRcdFx0XG5cdFx0XHRpZih2YWxpZCAhPT0gdHJ1ZSl7XG5cdFx0XHRcdG91dHB1dCA9IG91dHB1dC5jb25jYXQodmFsaWQpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQubGVuZ3RoID8gb3V0cHV0IDogdHJ1ZTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIEludGVybmFsIExvZ2ljIC8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdGluaXRpYWxpemVDb2x1bW5DaGVjayhjb2x1bW4pe1xuXHRcdGlmKHR5cGVvZiBjb2x1bW4uZGVmaW5pdGlvbi52YWxpZGF0b3IgIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0dGhpcy5pbml0aWFsaXplQ29sdW1uKGNvbHVtbik7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3ZhbGlkYXRlXG5cdGluaXRpYWxpemVDb2x1bW4oY29sdW1uKXtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0Y29uZmlnID0gW10sXG5cdFx0dmFsaWRhdG9yO1xuXHRcdFxuXHRcdGlmKGNvbHVtbi5kZWZpbml0aW9uLnZhbGlkYXRvcil7XG5cdFx0XHRcblx0XHRcdGlmKEFycmF5LmlzQXJyYXkoY29sdW1uLmRlZmluaXRpb24udmFsaWRhdG9yKSl7XG5cdFx0XHRcdGNvbHVtbi5kZWZpbml0aW9uLnZhbGlkYXRvci5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0dmFsaWRhdG9yID0gc2VsZi5fZXh0cmFjdFZhbGlkYXRvcihpdGVtKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZih2YWxpZGF0b3Ipe1xuXHRcdFx0XHRcdFx0Y29uZmlnLnB1c2godmFsaWRhdG9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dmFsaWRhdG9yID0gdGhpcy5fZXh0cmFjdFZhbGlkYXRvcihjb2x1bW4uZGVmaW5pdGlvbi52YWxpZGF0b3IpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYodmFsaWRhdG9yKXtcblx0XHRcdFx0XHRjb25maWcucHVzaCh2YWxpZGF0b3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGNvbHVtbi5tb2R1bGVzLnZhbGlkYXRlID0gY29uZmlnLmxlbmd0aCA/IGNvbmZpZyA6IGZhbHNlO1xuXHRcdH1cblx0fVxuXHRcblx0X2V4dHJhY3RWYWxpZGF0b3IodmFsdWUpe1xuXHRcdHZhciB0eXBlLCBwYXJhbXMsIHBvcztcblx0XHRcblx0XHRzd2l0Y2godHlwZW9mIHZhbHVlKXtcblx0XHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdFx0cG9zID0gdmFsdWUuaW5kZXhPZignOicpO1xuXHRcdFx0XG5cdFx0XHRcdGlmKHBvcyA+IC0xKXtcblx0XHRcdFx0XHR0eXBlID0gdmFsdWUuc3Vic3RyaW5nKDAscG9zKTtcblx0XHRcdFx0XHRwYXJhbXMgPSB2YWx1ZS5zdWJzdHJpbmcocG9zKzEpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0dHlwZSA9IHZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2J1aWxkVmFsaWRhdG9yKHR5cGUsIHBhcmFtcyk7XG5cdFx0XHRcblx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fYnVpbGRWYWxpZGF0b3IodmFsdWUpO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdHJldHVybiB0aGlzLl9idWlsZFZhbGlkYXRvcih2YWx1ZS50eXBlLCB2YWx1ZS5wYXJhbWV0ZXJzKTtcblx0XHR9XG5cdH1cblx0XG5cdF9idWlsZFZhbGlkYXRvcih0eXBlLCBwYXJhbXMpe1xuXHRcdFxuXHRcdHZhciBmdW5jID0gdHlwZW9mIHR5cGUgPT0gXCJmdW5jdGlvblwiID8gdHlwZSA6IFZhbGlkYXRlLnZhbGlkYXRvcnNbdHlwZV07XG5cdFx0XG5cdFx0aWYoIWZ1bmMpe1xuXHRcdFx0Y29uc29sZS53YXJuKFwiVmFsaWRhdG9yIFNldHVwIEVycm9yIC0gTm8gbWF0Y2hpbmcgdmFsaWRhdG9yIGZvdW5kOlwiLCB0eXBlKTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR0eXBlOnR5cGVvZiB0eXBlID09IFwiZnVuY3Rpb25cIiA/IFwiZnVuY3Rpb25cIiA6IHR5cGUsXG5cdFx0XHRcdGZ1bmM6ZnVuYyxcblx0XHRcdFx0cGFyYW1zOnBhcmFtcyxcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cdFxuXHR2YWxpZGF0ZSh2YWxpZGF0b3JzLCBjZWxsLCB2YWx1ZSl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdGZhaWxlZFZhbGlkYXRvcnMgPSBbXSxcblx0XHRpbnZhbGlkSW5kZXggPSB0aGlzLmludmFsaWRDZWxscy5pbmRleE9mKGNlbGwpO1xuXHRcdFxuXHRcdGlmKHZhbGlkYXRvcnMpe1xuXHRcdFx0dmFsaWRhdG9ycy5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRcdGlmKCFpdGVtLmZ1bmMuY2FsbChzZWxmLCBjZWxsLmdldENvbXBvbmVudCgpLCB2YWx1ZSwgaXRlbS5wYXJhbXMpKXtcblx0XHRcdFx0XHRmYWlsZWRWYWxpZGF0b3JzLnB1c2goe1xuXHRcdFx0XHRcdFx0dHlwZTppdGVtLnR5cGUsXG5cdFx0XHRcdFx0XHRwYXJhbWV0ZXJzOml0ZW0ucGFyYW1zXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0XHRpZighY2VsbC5tb2R1bGVzLnZhbGlkYXRlKXtcblx0XHRcdGNlbGwubW9kdWxlcy52YWxpZGF0ZSA9IHt9O1xuXHRcdH1cblx0XHRcblx0XHRpZighZmFpbGVkVmFsaWRhdG9ycy5sZW5ndGgpe1xuXHRcdFx0Y2VsbC5tb2R1bGVzLnZhbGlkYXRlLmludmFsaWQgPSBmYWxzZTtcblx0XHRcdGNlbGwuZ2V0RWxlbWVudCgpLmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItdmFsaWRhdGlvbi1mYWlsXCIpO1xuXHRcdFx0XG5cdFx0XHRpZihpbnZhbGlkSW5kZXggPiAtMSl7XG5cdFx0XHRcdHRoaXMuaW52YWxpZENlbGxzLnNwbGljZShpbnZhbGlkSW5kZXgsIDEpO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNlbGwubW9kdWxlcy52YWxpZGF0ZS5pbnZhbGlkID0gZmFpbGVkVmFsaWRhdG9ycztcblx0XHRcdFxuXHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnZhbGlkYXRpb25Nb2RlICE9PSBcIm1hbnVhbFwiKXtcblx0XHRcdFx0Y2VsbC5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci12YWxpZGF0aW9uLWZhaWxcIik7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKGludmFsaWRJbmRleCA9PSAtMSl7XG5cdFx0XHRcdHRoaXMuaW52YWxpZENlbGxzLnB1c2goY2VsbCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmYWlsZWRWYWxpZGF0b3JzLmxlbmd0aCA/IGZhaWxlZFZhbGlkYXRvcnMgOiB0cnVlO1xuXHR9XG5cdFxuXHRnZXRJbnZhbGlkQ2VsbHMoKXtcblx0XHR2YXIgb3V0cHV0ID0gW107XG5cdFx0XG5cdFx0dGhpcy5pbnZhbGlkQ2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuXHRcdFx0b3V0cHV0LnB1c2goY2VsbC5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0Y2xlYXJWYWxpZGF0aW9uKGNlbGwpe1xuXHRcdHZhciBpbnZhbGlkSW5kZXg7XG5cdFx0XG5cdFx0aWYoY2VsbC5tb2R1bGVzLnZhbGlkYXRlICYmIGNlbGwubW9kdWxlcy52YWxpZGF0ZS5pbnZhbGlkKXtcblx0XHRcdFxuXHRcdFx0Y2VsbC5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci12YWxpZGF0aW9uLWZhaWxcIik7XG5cdFx0XHRjZWxsLm1vZHVsZXMudmFsaWRhdGUuaW52YWxpZCA9IGZhbHNlO1xuXHRcdFx0XG5cdFx0XHRpbnZhbGlkSW5kZXggPSB0aGlzLmludmFsaWRDZWxscy5pbmRleE9mKGNlbGwpO1xuXHRcdFx0XG5cdFx0XHRpZihpbnZhbGlkSW5kZXggPiAtMSl7XG5cdFx0XHRcdHRoaXMuaW52YWxpZENlbGxzLnNwbGljZShpbnZhbGlkSW5kZXgsIDEpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG52YXIgYWxsTW9kdWxlcyA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHtcblx0X19wcm90b19fOiBudWxsLFxuXHRBY2Nlc3Nvck1vZHVsZTogQWNjZXNzb3IsXG5cdEFqYXhNb2R1bGU6IEFqYXgsXG5cdENsaXBib2FyZE1vZHVsZTogQ2xpcGJvYXJkLFxuXHRDb2x1bW5DYWxjc01vZHVsZTogQ29sdW1uQ2FsY3MsXG5cdERhdGFUcmVlTW9kdWxlOiBEYXRhVHJlZSxcblx0RG93bmxvYWRNb2R1bGU6IERvd25sb2FkLFxuXHRFZGl0TW9kdWxlOiBFZGl0LFxuXHRFeHBvcnRNb2R1bGU6IEV4cG9ydCxcblx0RmlsdGVyTW9kdWxlOiBGaWx0ZXIsXG5cdEZvcm1hdE1vZHVsZTogRm9ybWF0LFxuXHRGcm96ZW5Db2x1bW5zTW9kdWxlOiBGcm96ZW5Db2x1bW5zLFxuXHRGcm96ZW5Sb3dzTW9kdWxlOiBGcm96ZW5Sb3dzLFxuXHRHcm91cFJvd3NNb2R1bGU6IEdyb3VwUm93cyxcblx0SGlzdG9yeU1vZHVsZTogSGlzdG9yeSxcblx0SHRtbFRhYmxlSW1wb3J0TW9kdWxlOiBIdG1sVGFibGVJbXBvcnQsXG5cdEltcG9ydE1vZHVsZTogSW1wb3J0LFxuXHRJbnRlcmFjdGlvbk1vZHVsZTogSW50ZXJhY3Rpb24sXG5cdEtleWJpbmRpbmdzTW9kdWxlOiBLZXliaW5kaW5ncyxcblx0TWVudU1vZHVsZTogTWVudSxcblx0TW92ZUNvbHVtbnNNb2R1bGU6IE1vdmVDb2x1bW5zLFxuXHRNb3ZlUm93c01vZHVsZTogTW92ZVJvd3MsXG5cdE11dGF0b3JNb2R1bGU6IE11dGF0b3IsXG5cdFBhZ2VNb2R1bGU6IFBhZ2UsXG5cdFBlcnNpc3RlbmNlTW9kdWxlOiBQZXJzaXN0ZW5jZSxcblx0UG9wdXBNb2R1bGU6IFBvcHVwLFxuXHRQcmludE1vZHVsZTogUHJpbnQsXG5cdFJlYWN0aXZlRGF0YU1vZHVsZTogUmVhY3RpdmVEYXRhLFxuXHRSZXNpemVDb2x1bW5zTW9kdWxlOiBSZXNpemVDb2x1bW5zLFxuXHRSZXNpemVSb3dzTW9kdWxlOiBSZXNpemVSb3dzLFxuXHRSZXNpemVUYWJsZU1vZHVsZTogUmVzaXplVGFibGUsXG5cdFJlc3BvbnNpdmVMYXlvdXRNb2R1bGU6IFJlc3BvbnNpdmVMYXlvdXQsXG5cdFNlbGVjdFJhbmdlTW9kdWxlOiBTZWxlY3RSYW5nZSxcblx0U2VsZWN0Um93TW9kdWxlOiBTZWxlY3RSb3csXG5cdFNvcnRNb2R1bGU6IFNvcnQsXG5cdFNwcmVhZHNoZWV0TW9kdWxlOiBTcHJlYWRzaGVldCxcblx0VG9vbHRpcE1vZHVsZTogVG9vbHRpcCxcblx0VmFsaWRhdGVNb2R1bGU6IFZhbGlkYXRlXG59KTtcblxudmFyIGRlZmF1bHRPcHRpb25zID0ge1xuXG5cdGRlYnVnRXZlbnRzRXh0ZXJuYWw6ZmFsc2UsIC8vZmxhZyB0byBjb25zb2xlIGxvZyBldmVudHNcblx0ZGVidWdFdmVudHNJbnRlcm5hbDpmYWxzZSwgLy9mbGFnIHRvIGNvbnNvbGUgbG9nIGV2ZW50c1xuXHRkZWJ1Z0ludmFsaWRPcHRpb25zOnRydWUsIC8vYWxsb3cgdG9nZ2xpbmcgb2YgaW52YWxpZCBvcHRpb24gd2FybmluZ3Ncblx0ZGVidWdJbnZhbGlkQ29tcG9uZW50RnVuY3M6dHJ1ZSwgLy9hbGxvdyB0b2dnbGluZyBvZiBpbnZhbGlkIGNvbXBvbmVudCB3YXJuaW5nc1xuXHRkZWJ1Z0luaXRpYWxpemF0aW9uOnRydWUsIC8vYWxsb3cgdG9nZ2xpbmcgb2YgcHJlIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uIGNhbGwgd2FybmluZ3Ncblx0ZGVidWdEZXByZWNhdGlvbjp0cnVlLCAvL2FsbG93IHRvZ2dsaW5nIG9mIGRlcHJlY2F0aW9uIHdhcm5pbmdzXG5cblx0aGVpZ2h0OmZhbHNlLCAvL2hlaWdodCBvZiB0YWJ1bGF0b3Jcblx0bWluSGVpZ2h0OmZhbHNlLCAvL21pbmltdW0gaGVpZ2h0IG9mIHRhYnVsYXRvclxuXHRtYXhIZWlnaHQ6ZmFsc2UsIC8vbWF4aW11bSBoZWlnaHQgb2YgdGFidWxhdG9yXG5cblx0Y29sdW1uSGVhZGVyVmVydEFsaWduOlwidG9wXCIsIC8vdmVydGljYWwgYWxpZ25tZW50IG9mIGNvbHVtbiBoZWFkZXJzXG5cblx0cG9wdXBDb250YWluZXI6ZmFsc2UsXG5cblx0Y29sdW1uczpbXSwvL3N0b3JlIGZvciBjb2x1bSBoZWFkZXIgaW5mb1xuXHRjb2x1bW5EZWZhdWx0czp7fSwgLy9zdG9yZSBjb2x1bW4gZGVmYXVsdCBwcm9wc1xuXHRyb3dIZWFkZXI6ZmFsc2UsXG5cblx0ZGF0YTpmYWxzZSwgLy9kZWZhdWx0IHN0YXJ0aW5nIGRhdGFcblxuXHRhdXRvQ29sdW1uczpmYWxzZSwgLy9idWlsZCBjb2x1bW5zIGZyb20gZGF0YSByb3cgc3RydWN0dXJlXG5cdGF1dG9Db2x1bW5zRGVmaW5pdGlvbnM6ZmFsc2UsXG5cblx0bmVzdGVkRmllbGRTZXBhcmF0b3I6XCIuXCIsIC8vc2VwYXJhdG9yIGZvciBuZXN0ZWQgZGF0YVxuXG5cdGZvb3RlckVsZW1lbnQ6ZmFsc2UsIC8vaG9sZCBmb290ZXIgZWxlbWVudFxuXG5cdGluZGV4OlwiaWRcIiwgLy9maWxlZCBmb3Igcm93IGluZGV4XG5cblx0dGV4dERpcmVjdGlvbjpcImF1dG9cIixcblxuXHRhZGRSb3dQb3M6XCJib3R0b21cIiwgLy9wb3NpdGlvbiB0byBpbnNlcnQgYmxhbmsgcm93cywgdG9wfGJvdHRvbVxuXG5cdGhlYWRlclZpc2libGU6dHJ1ZSwgLy9oaWRlIGhlYWRlclxuXG5cdHJlbmRlclZlcnRpY2FsOlwidmlydHVhbFwiLFxuXHRyZW5kZXJIb3Jpem9udGFsOlwiYmFzaWNcIixcblx0cmVuZGVyVmVydGljYWxCdWZmZXI6MCwgLy8gc2V0IHZpcnR1YWwgRE9NIGJ1ZmZlciBzaXplXG5cblx0c2Nyb2xsVG9Sb3dQb3NpdGlvbjpcInRvcFwiLFxuXHRzY3JvbGxUb1Jvd0lmVmlzaWJsZTp0cnVlLFxuXG5cdHNjcm9sbFRvQ29sdW1uUG9zaXRpb246XCJsZWZ0XCIsXG5cdHNjcm9sbFRvQ29sdW1uSWZWaXNpYmxlOnRydWUsXG5cblx0cm93Rm9ybWF0dGVyOmZhbHNlLFxuXHRyb3dGb3JtYXR0ZXJQcmludDpudWxsLFxuXHRyb3dGb3JtYXR0ZXJDbGlwYm9hcmQ6bnVsbCxcblx0cm93Rm9ybWF0dGVySHRtbE91dHB1dDpudWxsLFxuXG5cdHJvd0hlaWdodDpudWxsLFxuXG5cdHBsYWNlaG9sZGVyOmZhbHNlLFxuXG5cdGRhdGFMb2FkZXI6dHJ1ZSxcblx0ZGF0YUxvYWRlckxvYWRpbmc6ZmFsc2UsXG5cdGRhdGFMb2FkZXJFcnJvcjpmYWxzZSxcblx0ZGF0YUxvYWRlckVycm9yVGltZW91dDozMDAwLFxuXHRkYXRhU2VuZFBhcmFtczp7fSxcblx0ZGF0YVJlY2VpdmVQYXJhbXM6e30sXG5cblx0ZGVwZW5kZW5jaWVzOnt9LFxufTtcblxuY2xhc3MgT3B0aW9uc0xpc3Qge1xuXHRjb25zdHJ1Y3Rvcih0YWJsZSwgbXNnVHlwZSwgZGVmYXVsdHMgPSB7fSl7XG5cdFx0dGhpcy50YWJsZSA9IHRhYmxlO1xuXHRcdHRoaXMubXNnVHlwZSA9IG1zZ1R5cGU7XG5cdFx0dGhpcy5yZWdpc3RlcmVkRGVmYXVsdHMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0cyk7XG5cdH1cblx0XG5cdHJlZ2lzdGVyKG9wdGlvbiwgdmFsdWUpe1xuXHRcdHRoaXMucmVnaXN0ZXJlZERlZmF1bHRzW29wdGlvbl0gPSB2YWx1ZTtcblx0fVxuXHRcblx0Z2VuZXJhdGUoZGVmYXVsdE9wdGlvbnMsIHVzZXJPcHRpb25zID0ge30pe1xuXHRcdHZhciBvdXRwdXQgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnJlZ2lzdGVyZWREZWZhdWx0cyksXG5cdFx0d2FybiA9IHRoaXMudGFibGUub3B0aW9ucy5kZWJ1Z0ludmFsaWRPcHRpb25zIHx8IHVzZXJPcHRpb25zLmRlYnVnSW52YWxpZE9wdGlvbnMgPT09IHRydWU7XG5cdFx0XG5cdFx0T2JqZWN0LmFzc2lnbihvdXRwdXQsIGRlZmF1bHRPcHRpb25zKTtcblx0XHRcblx0XHRmb3IgKGxldCBrZXkgaW4gdXNlck9wdGlvbnMpe1xuXHRcdFx0aWYoIW91dHB1dC5oYXNPd25Qcm9wZXJ0eShrZXkpKXtcblx0XHRcdFx0aWYod2Fybil7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiSW52YWxpZCBcIiArIHRoaXMubXNnVHlwZSArIFwiIG9wdGlvbjpcIiwga2V5KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdG91dHB1dFtrZXldID0gdXNlck9wdGlvbnMua2V5O1xuXHRcdFx0fVxuXHRcdH1cblx0XG5cdFx0XG5cdFx0Zm9yIChsZXQga2V5IGluIG91dHB1dCl7XG5cdFx0XHRpZihrZXkgaW4gdXNlck9wdGlvbnMpe1xuXHRcdFx0XHRvdXRwdXRba2V5XSA9IHVzZXJPcHRpb25zW2tleV07XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKEFycmF5LmlzQXJyYXkob3V0cHV0W2tleV0pKXtcblx0XHRcdFx0XHRvdXRwdXRba2V5XSA9IE9iamVjdC5hc3NpZ24oW10sIG91dHB1dFtrZXldKTtcblx0XHRcdFx0fWVsc2UgaWYodHlwZW9mIG91dHB1dFtrZXldID09PSBcIm9iamVjdFwiICYmIG91dHB1dFtrZXldICE9PSBudWxsKXtcblx0XHRcdFx0XHRvdXRwdXRba2V5XSA9IE9iamVjdC5hc3NpZ24oe30sIG91dHB1dFtrZXldKTtcblx0XHRcdFx0fWVsc2UgaWYgKHR5cGVvZiBvdXRwdXRba2V5XSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0ZGVsZXRlIG91dHB1dFtrZXldO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cbn1cblxuY2xhc3MgUmVuZGVyZXIgZXh0ZW5kcyBDb3JlRmVhdHVyZXtcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMuZWxlbWVudFZlcnRpY2FsID0gdGFibGUucm93TWFuYWdlci5lbGVtZW50O1xuXHRcdHRoaXMuZWxlbWVudEhvcml6b250YWwgPSB0YWJsZS5jb2x1bW5NYW5hZ2VyLmVsZW1lbnQ7XG5cdFx0dGhpcy50YWJsZUVsZW1lbnQgPSAgdGFibGUucm93TWFuYWdlci50YWJsZUVsZW1lbnQ7XG5cblx0XHR0aGlzLnZlcnRpY2FsRmlsbE1vZGUgPSBcImZpdFwiOyAvLyB1c2VkIGJ5IHJvdyBtYW5hZ2VyIHRvIGRldGVybWluZSBob3cgdG8gc2l6ZSB0aGUgcmVuZGVyIGFyZWEgKFwiZml0XCIgLSBmaXRzIGNvbnRhaW5lciB0byB0aGUgY29udGVudHMsIFwiZmlsbFwiIC0gZmlsbHMgdGhlIGNvbnRhaW5lciB3aXRob3V0IHJlc2l6aW5nIGl0KVxuXHR9XG5cblxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvLy8vLy8vIEludGVybmFsIEJpbmRpbmdzIC8vLy8vLy8vL1xuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdGluaXRpYWxpemUoKXtcblx0XHQvL2luaXRpYWxpemUgY29yZSBmdW5jdGlvbmFsaXR5XG5cdH1cblxuXHRjbGVhclJvd3MoKXtcblx0XHQvL2NsZWFyIGRvd24gZXhpc3Rpbmcgcm93cyBsYXlvdXRcblx0fVxuXG5cdGNsZWFyQ29sdW1ucygpe1xuXHRcdC8vY2xlYXIgZG93biBleGlzdGluZyBjb2x1bW5zIGxheW91dFxuXHR9XG5cblxuXHRyZWluaXRpYWxpemVDb2x1bW5XaWR0aHMoY29sdW1ucyl7XG5cdFx0Ly9yZXNpemUgY29sdW1ucyB0byBmaXQgZGF0YVxuXHR9XG5cblxuXHRyZW5kZXJSb3dzKCl7XG5cdFx0Ly9yZW5kZXIgcm93cyBmcm9tIGEgY2xlYW4gc2xhdGVcblx0fVxuXG5cdHJlbmRlckNvbHVtbnMoKXtcblx0XHQvL3JlbmRlciBjb2x1bW5zIGZyb20gYSBjbGVhbiBzbGF0ZVxuXHR9XG5cblx0cmVyZW5kZXJSb3dzKGNhbGxiYWNrKXtcblx0XHQvLyByZXJlbmRlciByb3dzIGFuZCBrZWVwIHBvc2l0aW9uXG5cdFx0aWYoY2FsbGJhY2spe1xuXHRcdFx0Y2FsbGJhY2soKTtcblx0XHR9XG5cdH1cblxuXHRyZXJlbmRlckNvbHVtbnModXBkYXRlLCBibG9ja1JlZHJhdyl7XG5cdFx0Ly9yZXJlbmRlciBjb2x1bW5zXG5cdH1cblxuXHRyZW5kZXJSb3dDZWxscyhyb3cpe1xuXHRcdC8vcmVuZGVyIHRoZSBjZWxscyBpbiBhIHJvd1xuXHR9XG5cblx0cmVyZW5kZXJSb3dDZWxscyhyb3csIGZvcmNlKXtcblx0XHQvL3JlcmVuZGVyIHRoZSBjZWxscyBpbiBhIHJvd1xuXHR9XG5cblx0c2Nyb2xsQ29sdW1ucyhsZWZ0LCBkaXIpe1xuXHRcdC8vaGFuZGxlIGhvcml6b250YWwgc2Nyb2xsaW5nXG5cdH1cblxuXHRzY3JvbGxSb3dzKHRvcCwgZGlyKXtcblx0XHQvL2hhbmRsZSB2ZXJ0aWNhbCBzY3JvbGxpbmdcblx0fVxuXG5cdHJlc2l6ZSgpe1xuXHRcdC8vY29udGFpbmVyIGhhcyByZXNpemVkLCBjYXJyeSBvdXQgYW55IG5lZWRlZCByZWNhbGN1bGF0aW9ucyAoRE8gTk9UIFJFUkVOREVSIElOIFRISVMgRlVOQ1RJT04pXG5cdH1cblxuXHRzY3JvbGxUb1Jvdyhyb3cpe1xuXHRcdC8vc2Nyb2xsIHRvIGEgc3BlY2lmaWMgcm93XG5cdH1cblxuXHRzY3JvbGxUb1Jvd05lYXJlc3RUb3Aocm93KXtcblx0XHQvL2RldGVybWluZSB3ZWF0aGVyIHRoZSByb3cgaXMgbmVhcmVzdCB0aGUgdG9wIG9yIGJvdHRvbSBvZiB0aGUgdGFibGUsIHJldHVybiB0cnVlIGZvciB0b3Agb3IgZmFsc2UgZm9yIGJvdHRvbVxuXHR9XG5cblx0dmlzaWJsZVJvd3MoaW5jbHVkaW5nQnVmZmVyKXtcblx0XHQvL3JldHVybiB0aGUgdmlzaWJsZSByb3dzXG5cdFx0cmV0dXJuIFtdO1xuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8gSGVscGVyIEZ1bmN0aW9ucyAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXHRyb3dzKCl7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUucm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpO1xuXHR9XG5cblx0c3R5bGVSb3cocm93LCBpbmRleCl7XG5cdFx0dmFyIHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblxuXHRcdGlmKGluZGV4ICUgMil7XG5cdFx0XHRyb3dFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1ldmVuXCIpO1xuXHRcdFx0cm93RWwuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1yb3ctb2RkXCIpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itcm93LW9kZFwiKTtcblx0XHRcdHJvd0VsLmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3Itcm93LWV2ZW5cIik7XG5cdFx0fVxuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLyBFeHRlcm5hbCBUcmlnZ2VycyAvLy8vLy8vLy9cblx0Ly8vLy8vLyAoRE8gTk9UIE9WRVJSSURFKSAvLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXHRjbGVhcigpe1xuXHRcdC8vY2xlYXIgZG93biBleGlzdGluZyBsYXlvdXRcblx0XHR0aGlzLmNsZWFyUm93cygpO1xuXHRcdHRoaXMuY2xlYXJDb2x1bW5zKCk7XG5cdH1cblxuXHRyZW5kZXIoKXtcblx0XHQvL3JlbmRlciBmcm9tIGEgY2xlYW4gc2xhdGVcblx0XHR0aGlzLnJlbmRlclJvd3MoKTtcblx0XHR0aGlzLnJlbmRlckNvbHVtbnMoKTtcblx0fVxuXG5cdHJlcmVuZGVyKGNhbGxiYWNrKXtcblx0XHQvLyByZXJlbmRlciBhbmQga2VlcCBwb3NpdGlvblxuXHRcdHRoaXMucmVyZW5kZXJSb3dzKCk7XG5cdFx0dGhpcy5yZXJlbmRlckNvbHVtbnMoKTtcblx0fVxuXG5cdHNjcm9sbFRvUm93UG9zaXRpb24ocm93LCBwb3NpdGlvbiwgaWZWaXNpYmxlKXtcblx0XHR2YXIgcm93SW5kZXggPSB0aGlzLnJvd3MoKS5pbmRleE9mKHJvdyksXG5cdFx0cm93RWwgPSByb3cuZ2V0RWxlbWVudCgpLFxuXHRcdG9mZnNldCA9IDA7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0aWYocm93SW5kZXggPiAtMSl7XG5cblx0XHRcdFx0aWYodHlwZW9mIGlmVmlzaWJsZSA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0aWZWaXNpYmxlID0gdGhpcy50YWJsZS5vcHRpb25zLnNjcm9sbFRvUm93SWZWaXNpYmxlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9jaGVjayByb3cgdmlzaWJpbGl0eVxuXHRcdFx0XHRpZighaWZWaXNpYmxlKXtcblx0XHRcdFx0XHRpZihIZWxwZXJzLmVsVmlzaWJsZShyb3dFbCkpe1xuXHRcdFx0XHRcdFx0b2Zmc2V0ID0gSGVscGVycy5lbE9mZnNldChyb3dFbCkudG9wIC0gSGVscGVycy5lbE9mZnNldCh0aGlzLmVsZW1lbnRWZXJ0aWNhbCkudG9wO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZihvZmZzZXQgPiAwICYmIG9mZnNldCA8IHRoaXMuZWxlbWVudFZlcnRpY2FsLmNsaWVudEhlaWdodCAtIHJvd0VsLm9mZnNldEhlaWdodCl7XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmKHR5cGVvZiBwb3NpdGlvbiA9PT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHRcdFx0cG9zaXRpb24gPSB0aGlzLnRhYmxlLm9wdGlvbnMuc2Nyb2xsVG9Sb3dQb3NpdGlvbjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmKHBvc2l0aW9uID09PSBcIm5lYXJlc3RcIil7XG5cdFx0XHRcdFx0cG9zaXRpb24gPSB0aGlzLnNjcm9sbFRvUm93TmVhcmVzdFRvcChyb3cpID8gXCJ0b3BcIiA6IFwiYm90dG9tXCI7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvL3Njcm9sbCB0byByb3dcblx0XHRcdFx0dGhpcy5zY3JvbGxUb1Jvdyhyb3cpO1xuXG5cdFx0XHRcdC8vYWxpZ24gdG8gY29ycmVjdCBwb3NpdGlvblxuXHRcdFx0XHRzd2l0Y2gocG9zaXRpb24pe1xuXHRcdFx0XHRcdGNhc2UgXCJtaWRkbGVcIjpcblx0XHRcdFx0XHRjYXNlIFwiY2VudGVyXCI6XG5cblx0XHRcdFx0XHRcdGlmKHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbEhlaWdodCAtIHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbFRvcCA9PSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5jbGllbnRIZWlnaHQpe1xuXHRcdFx0XHRcdFx0XHR0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AgPSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AgKyAocm93RWwub2Zmc2V0VG9wIC0gdGhpcy5lbGVtZW50VmVydGljYWwuc2Nyb2xsVG9wKSAtICgodGhpcy5lbGVtZW50VmVydGljYWwuc2Nyb2xsSGVpZ2h0IC0gcm93RWwub2Zmc2V0VG9wKSAvIDIpO1xuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AgPSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AgLSAodGhpcy5lbGVtZW50VmVydGljYWwuY2xpZW50SGVpZ2h0IC8gMik7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0Y2FzZSBcImJvdHRvbVwiOlxuXG5cdFx0XHRcdFx0XHRpZih0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxIZWlnaHQgLSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AgPT0gdGhpcy5lbGVtZW50VmVydGljYWwuY2xpZW50SGVpZ2h0KXtcblx0XHRcdFx0XHRcdFx0dGhpcy5lbGVtZW50VmVydGljYWwuc2Nyb2xsVG9wID0gdGhpcy5lbGVtZW50VmVydGljYWwuc2Nyb2xsVG9wIC0gKHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbEhlaWdodCAtIHJvd0VsLm9mZnNldFRvcCkgKyByb3dFbC5vZmZzZXRIZWlnaHQ7XG5cdFx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbFRvcCA9IHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbFRvcCAtIHRoaXMuZWxlbWVudFZlcnRpY2FsLmNsaWVudEhlaWdodCArIHJvd0VsLm9mZnNldEhlaWdodDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRjYXNlIFwidG9wXCI6XG5cdFx0XHRcdFx0XHR0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AgPSByb3dFbC5vZmZzZXRUb3A7XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXNvbHZlKCk7XG5cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiU2Nyb2xsIEVycm9yIC0gUm93IG5vdCB2aXNpYmxlXCIpO1xuXHRcdFx0XHRyZWplY3QoXCJTY3JvbGwgRXJyb3IgLSBSb3cgbm90IHZpc2libGVcIik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn1cblxuY2xhc3MgQmFzaWNIb3Jpem9udGFsIGV4dGVuZHMgUmVuZGVyZXJ7XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdH1cblx0XG5cdHJlbmRlclJvd0NlbGxzKHJvdywgaW5GcmFnbWVudCkge1xuXHRcdGNvbnN0IHJvd0ZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cdFx0cm93LmNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcblx0XHRcdHJvd0ZyYWcuYXBwZW5kQ2hpbGQoY2VsbC5nZXRFbGVtZW50KCkpO1xuXHRcdH0pO1xuXHRcdHJvdy5lbGVtZW50LmFwcGVuZENoaWxkKHJvd0ZyYWcpO1xuXHRcdFxuXHRcdGlmKCFpbkZyYWdtZW50KXtcblx0XHRcdHJvdy5jZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG5cdFx0XHRcdGNlbGwuY2VsbFJlbmRlcmVkKCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0XG5cdHJlaW5pdGlhbGl6ZUNvbHVtbldpZHRocyhjb2x1bW5zKXtcblx0XHRjb2x1bW5zLmZvckVhY2goZnVuY3Rpb24oY29sdW1uKXtcblx0XHRcdGNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHRcdH0pO1xuXHR9XG59XG5cbmNsYXNzIFZpcnR1YWxEb21Ib3Jpem9udGFsIGV4dGVuZHMgUmVuZGVyZXJ7XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy5sZWZ0Q29sID0gMDtcblx0XHR0aGlzLnJpZ2h0Q29sID0gMDtcblx0XHR0aGlzLnNjcm9sbExlZnQgPSAwO1xuXHRcdFxuXHRcdHRoaXMudkRvbVNjcm9sbFBvc0xlZnQgPSAwO1xuXHRcdHRoaXMudkRvbVNjcm9sbFBvc1JpZ2h0ID0gMDtcblx0XHRcblx0XHR0aGlzLnZEb21QYWRMZWZ0ID0gMDtcblx0XHR0aGlzLnZEb21QYWRSaWdodCA9IDA7XG5cdFx0XG5cdFx0dGhpcy5maXREYXRhQ29sQXZnID0gMDtcblx0XHRcblx0XHR0aGlzLndpbmRvd0J1ZmZlciA9IDIwMDsgLy9waXhlbCBtYXJnaW4gdG8gbWFrZSBjb2x1bW4gdmlzaWJsZSBiZWZvcmUgaXQgaXMgc2hvd24gb24gc2NyZWVuXG5cdFx0XG5cdFx0dGhpcy52aXNpYmxlUm93cyA9IG51bGw7XG5cdFx0XG5cdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHRcdHRoaXMuaXNGaXREYXRhID0gZmFsc2U7XG5cdFx0XG5cdFx0dGhpcy5jb2x1bW5zID0gW107XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLmNvbXBhdGliaWxpdHlDaGVjaygpO1xuXHRcdHRoaXMubGF5b3V0Q2hlY2soKTtcblx0XHR0aGlzLnZlcnRTY3JvbGxMaXN0ZW4oKTtcblx0fVxuXHRcblx0Y29tcGF0aWJpbGl0eUNoZWNrKCl7XHRcdFxuXHRcdGlmKHRoaXMub3B0aW9ucyhcImxheW91dFwiKSA9PSBcImZpdERhdGFUYWJsZVwiKXtcblx0XHRcdGNvbnNvbGUud2FybihcIkhvcml6b250YWwgVmlydHVhbCBET00gaXMgbm90IGNvbXBhdGlibGUgd2l0aCBmaXREYXRhVGFibGUgbGF5b3V0IG1vZGVcIik7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMub3B0aW9ucyhcInJlc3BvbnNpdmVMYXlvdXRcIikpe1xuXHRcdFx0Y29uc29sZS53YXJuKFwiSG9yaXpvbnRhbCBWaXJ0dWFsIERPTSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHJlc3BvbnNpdmUgY29sdW1uc1wiKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy5vcHRpb25zKFwicnRsXCIpKXtcblx0XHRcdGNvbnNvbGUud2FybihcIkhvcml6b250YWwgVmlydHVhbCBET00gaXMgbm90IGN1cnJlbnRseSBjb21wYXRpYmxlIHdpdGggUlRMIHRleHQgZGlyZWN0aW9uXCIpO1xuXHRcdH1cblx0fVxuXHRcblx0bGF5b3V0Q2hlY2soKXtcblx0XHR0aGlzLmlzRml0RGF0YSA9IHRoaXMub3B0aW9ucyhcImxheW91dFwiKS5zdGFydHNXaXRoKCdmaXREYXRhJyk7XG5cdH1cblx0XG5cdHZlcnRTY3JvbGxMaXN0ZW4oKXtcblx0XHR0aGlzLnN1YnNjcmliZShcInNjcm9sbC12ZXJ0aWNhbFwiLCB0aGlzLmNsZWFyVmlzUm93Q2FjaGUuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJkYXRhLXJlZnJlc2hlZFwiLCB0aGlzLmNsZWFyVmlzUm93Q2FjaGUuYmluZCh0aGlzKSk7XG5cdH1cblx0XG5cdGNsZWFyVmlzUm93Q2FjaGUoKXtcblx0XHR0aGlzLnZpc2libGVSb3dzID0gbnVsbDtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vIFB1YmxpYyBGdW5jdGlvbnMgLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdHJlbmRlckNvbHVtbnMocm93LCBmb3JjZSl7XG5cdFx0dGhpcy5kYXRhQ2hhbmdlKCk7XG5cdH1cblx0XG5cdFxuXHRzY3JvbGxDb2x1bW5zKGxlZnQsIGRpcil7XG5cdFx0aWYodGhpcy5zY3JvbGxMZWZ0ICE9IGxlZnQpe1xuXHRcdFx0dGhpcy5zY3JvbGxMZWZ0ID0gbGVmdDtcblx0XHRcdFxuXHRcdFx0dGhpcy5zY3JvbGwobGVmdCAtICh0aGlzLnZEb21TY3JvbGxQb3NMZWZ0ICsgdGhpcy53aW5kb3dCdWZmZXIpKTtcblx0XHR9XG5cdH1cblx0XG5cdGNhbGNXaW5kb3dCdWZmZXIoKXtcblx0XHR2YXIgYnVmZmVyID0gdGhpcy5lbGVtZW50VmVydGljYWwuY2xpZW50V2lkdGg7XG5cdFx0XG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZvckVhY2goKGNvbHVtbikgPT4ge1xuXHRcdFx0aWYoY29sdW1uLnZpc2libGUpe1xuXHRcdFx0XHR2YXIgd2lkdGggPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHdpZHRoID4gYnVmZmVyKXtcblx0XHRcdFx0XHRidWZmZXIgPSB3aWR0aDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMud2luZG93QnVmZmVyID0gYnVmZmVyICogMjtcblx0fVxuXHRcblx0cmVyZW5kZXJDb2x1bW5zKHVwZGF0ZSwgYmxvY2tSZWRyYXcpe1x0XHRcblx0XHR2YXIgb2xkID0ge1xuXHRcdFx0Y29sczp0aGlzLmNvbHVtbnMsXG5cdFx0XHRsZWZ0Q29sOnRoaXMubGVmdENvbCxcblx0XHRcdHJpZ2h0Q29sOnRoaXMucmlnaHRDb2wsXG5cdFx0fSxcblx0XHRjb2xQb3MgPSAwO1xuXHRcdFxuXHRcdGlmKHVwZGF0ZSAmJiAhdGhpcy5pbml0aWFsaXplZCl7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuY2xlYXIoKTtcblx0XHRcblx0XHR0aGlzLmNhbGNXaW5kb3dCdWZmZXIoKTtcblx0XHRcblx0XHR0aGlzLnNjcm9sbExlZnQgPSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxMZWZ0O1xuXHRcdFxuXHRcdHRoaXMudkRvbVNjcm9sbFBvc0xlZnQgPSB0aGlzLnNjcm9sbExlZnQgLSB0aGlzLndpbmRvd0J1ZmZlcjtcblx0XHR0aGlzLnZEb21TY3JvbGxQb3NSaWdodCA9IHRoaXMuc2Nyb2xsTGVmdCArIHRoaXMuZWxlbWVudFZlcnRpY2FsLmNsaWVudFdpZHRoICsgdGhpcy53aW5kb3dCdWZmZXI7XG5cdFx0XG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZvckVhY2goKGNvbHVtbikgPT4ge1xuXHRcdFx0dmFyIGNvbmZpZyA9IHt9LFxuXHRcdFx0d2lkdGg7XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbi52aXNpYmxlKXtcblx0XHRcdFx0aWYoIWNvbHVtbi5tb2R1bGVzLmZyb3plbil7XHRcdFx0XG5cdFx0XHRcdFx0d2lkdGggPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjb25maWcubGVmdFBvcyA9IGNvbFBvcztcblx0XHRcdFx0XHRjb25maWcucmlnaHRQb3MgPSBjb2xQb3MgKyB3aWR0aDtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjb25maWcud2lkdGggPSB3aWR0aDtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAodGhpcy5pc0ZpdERhdGEpIHtcblx0XHRcdFx0XHRcdGNvbmZpZy5maXREYXRhQ2hlY2sgPSBjb2x1bW4ubW9kdWxlcy52ZG9tSG96ID8gY29sdW1uLm1vZHVsZXMudmRvbUhvei5maXREYXRhQ2hlY2sgOiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZigoY29sUG9zICsgd2lkdGggPiB0aGlzLnZEb21TY3JvbGxQb3NMZWZ0KSAmJiAoY29sUG9zIDwgdGhpcy52RG9tU2Nyb2xsUG9zUmlnaHQpKXtcblx0XHRcdFx0XHRcdC8vY29sdW1uIGlzIHZpc2libGVcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYodGhpcy5sZWZ0Q29sID09IC0xKXtcblx0XHRcdFx0XHRcdFx0dGhpcy5sZWZ0Q29sID0gdGhpcy5jb2x1bW5zLmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0dGhpcy52RG9tUGFkTGVmdCA9IGNvbFBvcztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0dGhpcy5yaWdodENvbCA9IHRoaXMuY29sdW1ucy5sZW5ndGg7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gY29sdW1uIGlzIGhpZGRlblxuXHRcdFx0XHRcdFx0aWYodGhpcy5sZWZ0Q29sICE9PSAtMSl7XG5cdFx0XHRcdFx0XHRcdHRoaXMudkRvbVBhZFJpZ2h0ICs9IHdpZHRoO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLmNvbHVtbnMucHVzaChjb2x1bW4pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbHVtbi5tb2R1bGVzLnZkb21Ib3ogPSBjb25maWc7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29sUG9zICs9IHdpZHRoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0dGhpcy50YWJsZUVsZW1lbnQuc3R5bGUucGFkZGluZ0xlZnQgPSB0aGlzLnZEb21QYWRMZWZ0ICsgXCJweFwiO1xuXHRcdHRoaXMudGFibGVFbGVtZW50LnN0eWxlLnBhZGRpbmdSaWdodCA9IHRoaXMudkRvbVBhZFJpZ2h0ICsgXCJweFwiO1xuXHRcdFxuXHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHRcdFxuXHRcdGlmKCFibG9ja1JlZHJhdyl7XG5cdFx0XHRpZighdXBkYXRlIHx8IHRoaXMucmVpbml0Q2hhbmdlZChvbGQpKXtcblx0XHRcdFx0dGhpcy5yZWluaXRpYWxpemVSb3dzKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XG5cdH1cblx0XG5cdHJlbmRlclJvd0NlbGxzKHJvdyl7XG5cdFx0aWYodGhpcy5pbml0aWFsaXplZCl7XG5cdFx0XHR0aGlzLmluaXRpYWxpemVSb3cocm93KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zdCByb3dGcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXHRcdFx0cm93LmNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcblx0XHRcdFx0cm93RnJhZy5hcHBlbmRDaGlsZChjZWxsLmdldEVsZW1lbnQoKSk7XG5cdFx0XHR9KTtcblx0XHRcdHJvdy5lbGVtZW50LmFwcGVuZENoaWxkKHJvd0ZyYWcpO1xuXHRcdFx0XG5cdFx0XHRyb3cuY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuXHRcdFx0XHRjZWxsLmNlbGxSZW5kZXJlZCgpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZXJlbmRlclJvd0NlbGxzKHJvdywgZm9yY2Upe1xuXHRcdHRoaXMucmVpbml0aWFsaXplUm93KHJvdywgZm9yY2UpO1xuXHR9XG5cdFxuXHRyZWluaXRpYWxpemVDb2x1bW5XaWR0aHMoY29sdW1ucyl7XG5cdFx0Zm9yKGxldCBpID0gdGhpcy5sZWZ0Q29sOyBpIDw9IHRoaXMucmlnaHRDb2w7IGkrKyl7XG5cdFx0XHRsZXQgY29sID0gdGhpcy5jb2x1bW5zW2ldO1xuXHRcdFx0XG5cdFx0XHRpZihjb2wpe1xuXHRcdFx0XHRjb2wucmVpbml0aWFsaXplV2lkdGgoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vIEludGVybmFsIFJlbmRlcmluZyAvLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRkZWluaXRpYWxpemUoKXtcblx0XHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdH1cblx0XG5cdGNsZWFyKCl7XG5cdFx0dGhpcy5jb2x1bW5zID0gW107XG5cdFx0XG5cdFx0dGhpcy5sZWZ0Q29sID0gLTE7XG5cdFx0dGhpcy5yaWdodENvbCA9IDA7XG5cdFx0XG5cdFx0dGhpcy52RG9tU2Nyb2xsUG9zTGVmdCA9IDA7XG5cdFx0dGhpcy52RG9tU2Nyb2xsUG9zUmlnaHQgPSAwO1xuXHRcdHRoaXMudkRvbVBhZExlZnQgPSAwO1xuXHRcdHRoaXMudkRvbVBhZFJpZ2h0ID0gMDtcblx0fVxuXHRcblx0ZGF0YUNoYW5nZSgpe1xuXHRcdHZhciBjaGFuZ2UgPSBmYWxzZSxcblx0XHRyb3csIHJvd0VsO1xuXHRcdFxuXHRcdGlmKHRoaXMuaXNGaXREYXRhKXtcblx0XHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5jb2x1bW5zQnlJbmRleC5mb3JFYWNoKChjb2x1bW4pID0+IHtcblx0XHRcdFx0aWYoIWNvbHVtbi5kZWZpbml0aW9uLndpZHRoICYmIGNvbHVtbi52aXNpYmxlKXtcblx0XHRcdFx0XHRjaGFuZ2UgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0aWYoY2hhbmdlICYmIHRoaXMudGFibGUucm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpLmxlbmd0aCl7XG5cdFx0XHRcdHRoaXMudkRvbVNjcm9sbFBvc1JpZ2h0ID0gdGhpcy5zY3JvbGxMZWZ0ICsgdGhpcy5lbGVtZW50VmVydGljYWwuY2xpZW50V2lkdGggKyB0aGlzLndpbmRvd0J1ZmZlcjtcblx0XHRcdFx0XG5cdFx0XHRcdHJvdyA9IHRoaXMuY2hhaW4oXCJyb3dzLXNhbXBsZVwiLCBbMV0sIFtdLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMudGFibGUucm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpO1xuXHRcdFx0XHR9KVswXTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKHJvdyl7XG5cdFx0XHRcdFx0cm93RWwgPSByb3cuZ2V0RWxlbWVudCgpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJvdy5nZW5lcmF0ZUNlbGxzKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0dGhpcy50YWJsZUVsZW1lbnQuYXBwZW5kQ2hpbGQocm93RWwpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGZvcihsZXQgY29sRW5kID0gMDsgY29sRW5kIDwgcm93LmNlbGxzLmxlbmd0aDsgY29sRW5kKyspe1xuXHRcdFx0XHRcdFx0bGV0IGNlbGwgPSByb3cuY2VsbHNbY29sRW5kXTtcblx0XHRcdFx0XHRcdHJvd0VsLmFwcGVuZENoaWxkKGNlbGwuZ2V0RWxlbWVudCgpKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Y2VsbC5jb2x1bW4ucmVpbml0aWFsaXplV2lkdGgoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0cm93RWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyb3dFbCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0dGhpcy5yZXJlbmRlckNvbHVtbnMoZmFsc2UsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYodGhpcy5vcHRpb25zKFwibGF5b3V0XCIpID09PSBcImZpdENvbHVtbnNcIil7XG5cdFx0XHRcdHRoaXMubGF5b3V0UmVmcmVzaCgpO1xuXHRcdFx0XHR0aGlzLnJlcmVuZGVyQ29sdW1ucyhmYWxzZSwgdHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRyZWluaXRDaGFuZ2VkKG9sZCl7XG5cdFx0dmFyIG1hdGNoID0gdHJ1ZTtcblx0XHRcblx0XHRpZihvbGQuY29scy5sZW5ndGggIT09IHRoaXMuY29sdW1ucy5sZW5ndGggfHwgb2xkLmxlZnRDb2wgIT09IHRoaXMubGVmdENvbCB8fCBvbGQucmlnaHRDb2wgIT09IHRoaXMucmlnaHRDb2wpe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdFxuXHRcdG9sZC5jb2xzLmZvckVhY2goKGNvbCwgaSkgPT4ge1xuXHRcdFx0aWYoY29sICE9PSB0aGlzLmNvbHVtbnNbaV0pe1xuXHRcdFx0XHRtYXRjaCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiAhbWF0Y2g7XG5cdH1cblx0XG5cdHJlaW5pdGlhbGl6ZVJvd3MoKXtcblx0XHR2YXIgdmlzaWJsZVJvd3MgPSB0aGlzLmdldFZpc2libGVSb3dzKCksXG5cdFx0b3RoZXJSb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd3MoKS5maWx0ZXIocm93ID0+ICF2aXNpYmxlUm93cy5pbmNsdWRlcyhyb3cpKTtcblx0XHRcblx0XHR2aXNpYmxlUm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdHRoaXMucmVpbml0aWFsaXplUm93KHJvdywgdHJ1ZSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0b3RoZXJSb3dzLmZvckVhY2goKHJvdykgPT57XG5cdFx0XHRyb3cuZGVpbml0aWFsaXplKCk7XG5cdFx0fSk7XG5cdH1cblx0XG5cdGdldFZpc2libGVSb3dzKCl7XG5cdFx0aWYgKCF0aGlzLnZpc2libGVSb3dzKXtcblx0XHRcdHRoaXMudmlzaWJsZVJvd3MgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0VmlzaWJsZVJvd3MoKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMudmlzaWJsZVJvd3M7XHRcblx0fVxuXHRcblx0c2Nyb2xsKGRpZmYpe1xuXHRcdHRoaXMudkRvbVNjcm9sbFBvc0xlZnQgKz0gZGlmZjtcblx0XHR0aGlzLnZEb21TY3JvbGxQb3NSaWdodCArPSBkaWZmO1xuXHRcdFxuXHRcdGlmKE1hdGguYWJzKGRpZmYpID4gKHRoaXMud2luZG93QnVmZmVyIC8gMikpe1xuXHRcdFx0dGhpcy5yZXJlbmRlckNvbHVtbnMoKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZihkaWZmID4gMCl7XG5cdFx0XHRcdC8vc2Nyb2xsIHJpZ2h0XG5cdFx0XHRcdHRoaXMuYWRkQ29sUmlnaHQoKTtcblx0XHRcdFx0dGhpcy5yZW1vdmVDb2xMZWZ0KCk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdC8vc2Nyb2xsIGxlZnRcblx0XHRcdFx0dGhpcy5hZGRDb2xMZWZ0KCk7XG5cdFx0XHRcdHRoaXMucmVtb3ZlQ29sUmlnaHQoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGNvbFBvc2l0aW9uQWRqdXN0IChzdGFydCwgZW5kLCBkaWZmKXtcblx0XHRmb3IobGV0IGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKXtcblx0XHRcdGxldCBjb2x1bW4gPSB0aGlzLmNvbHVtbnNbaV07XG5cdFx0XHRcblx0XHRcdGNvbHVtbi5tb2R1bGVzLnZkb21Ib3oubGVmdFBvcyArPSBkaWZmO1xuXHRcdFx0Y29sdW1uLm1vZHVsZXMudmRvbUhvei5yaWdodFBvcyArPSBkaWZmO1xuXHRcdH1cblx0fVxuXHRcblx0YWRkQ29sUmlnaHQoKXtcblx0XHR2YXIgY2hhbmdlcyA9IGZhbHNlLFxuXHRcdHdvcmtpbmcgPSB0cnVlO1xuXHRcdFxuXHRcdHdoaWxlKHdvcmtpbmcpe1xuXHRcdFx0XG5cdFx0XHRsZXQgY29sdW1uID0gdGhpcy5jb2x1bW5zW3RoaXMucmlnaHRDb2wgKyAxXTtcblx0XHRcdFxuXHRcdFx0aWYoY29sdW1uKXtcblx0XHRcdFx0aWYoY29sdW1uLm1vZHVsZXMudmRvbUhvei5sZWZ0UG9zIDw9IHRoaXMudkRvbVNjcm9sbFBvc1JpZ2h0KXtcblx0XHRcdFx0XHRjaGFuZ2VzID0gdHJ1ZTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLmdldFZpc2libGVSb3dzKCkuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdFx0XHRpZihyb3cudHlwZSAhPT0gXCJncm91cFwiKXtcblx0XHRcdFx0XHRcdFx0dmFyIGNlbGwgPSByb3cuZ2V0Q2VsbChjb2x1bW4pO1xuXHRcdFx0XHRcdFx0XHRyb3cuZ2V0RWxlbWVudCgpLmluc2VydEJlZm9yZShjZWxsLmdldEVsZW1lbnQoKSwgcm93LmdldENlbGwodGhpcy5jb2x1bW5zW3RoaXMucmlnaHRDb2xdKS5nZXRFbGVtZW50KCkubmV4dFNpYmxpbmcpO1xuXHRcdFx0XHRcdFx0XHRjZWxsLmNlbGxSZW5kZXJlZCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMuZml0RGF0YUNvbEFjdHVhbFdpZHRoQ2hlY2soY29sdW1uKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLnJpZ2h0Q29sKys7IC8vIERvbid0IG1vdmUgdGhpcyBiZWxvdyB0aGUgPj0gY2hlY2sgYmVsb3dcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLmdldFZpc2libGVSb3dzKCkuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdFx0XHRpZihyb3cudHlwZSAhPT0gXCJncm91cFwiKXtcblx0XHRcdFx0XHRcdFx0cm93Lm1vZHVsZXMudmRvbUhvei5yaWdodENvbCA9IHRoaXMucmlnaHRDb2w7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYodGhpcy5yaWdodENvbCA+PSAodGhpcy5jb2x1bW5zLmxlbmd0aCAtIDEpKXtcblx0XHRcdFx0XHRcdHRoaXMudkRvbVBhZFJpZ2h0ID0gMDtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnZEb21QYWRSaWdodCAtPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHRcdFx0XHR9XHRcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR3b3JraW5nID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGNoYW5nZXMpe1xuXHRcdFx0dGhpcy50YWJsZUVsZW1lbnQuc3R5bGUucGFkZGluZ1JpZ2h0ID0gdGhpcy52RG9tUGFkUmlnaHQgKyBcInB4XCI7XG5cdFx0fVxuXHR9XG5cdFxuXHRhZGRDb2xMZWZ0KCl7XG5cdFx0dmFyIGNoYW5nZXMgPSBmYWxzZSxcblx0XHR3b3JraW5nID0gdHJ1ZTtcblx0XHRcblx0XHR3aGlsZSh3b3JraW5nKXtcblx0XHRcdGxldCBjb2x1bW4gPSB0aGlzLmNvbHVtbnNbdGhpcy5sZWZ0Q29sIC0gMV07XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbil7XG5cdFx0XHRcdGlmKGNvbHVtbi5tb2R1bGVzLnZkb21Ib3oucmlnaHRQb3MgPj0gdGhpcy52RG9tU2Nyb2xsUG9zTGVmdCl7XG5cdFx0XHRcdFx0Y2hhbmdlcyA9IHRydWU7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0dGhpcy5nZXRWaXNpYmxlUm93cygpLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRcdFx0aWYocm93LnR5cGUgIT09IFwiZ3JvdXBcIil7XG5cdFx0XHRcdFx0XHRcdHZhciBjZWxsID0gcm93LmdldENlbGwoY29sdW1uKTtcblx0XHRcdFx0XHRcdFx0cm93LmdldEVsZW1lbnQoKS5pbnNlcnRCZWZvcmUoY2VsbC5nZXRFbGVtZW50KCksIHJvdy5nZXRDZWxsKHRoaXMuY29sdW1uc1t0aGlzLmxlZnRDb2xdKS5nZXRFbGVtZW50KCkpO1xuXHRcdFx0XHRcdFx0XHRjZWxsLmNlbGxSZW5kZXJlZCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMubGVmdENvbC0tOyAvLyBkb24ndCBtb3ZlIHRoaXMgYmVsb3cgdGhlIDw9IGNoZWNrIGJlbG93XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0dGhpcy5nZXRWaXNpYmxlUm93cygpLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRcdFx0aWYocm93LnR5cGUgIT09IFwiZ3JvdXBcIil7XG5cdFx0XHRcdFx0XHRcdHJvdy5tb2R1bGVzLnZkb21Ib3oubGVmdENvbCA9IHRoaXMubGVmdENvbDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZih0aGlzLmxlZnRDb2wgPD0gMCl7IC8vIHJlcGxpY2F0aW5nIGxvZ2ljIGluIGFkZENvbFJpZ2h0XG5cdFx0XHRcdFx0XHR0aGlzLnZEb21QYWRMZWZ0ID0gMDtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnZEb21QYWRMZWZ0IC09IGNvbHVtbi5nZXRXaWR0aCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRsZXQgZGlmZiA9IHRoaXMuZml0RGF0YUNvbEFjdHVhbFdpZHRoQ2hlY2soY29sdW1uKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihkaWZmKXtcblx0XHRcdFx0XHRcdHRoaXMuc2Nyb2xsTGVmdCA9IHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbExlZnQgPSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxMZWZ0ICsgZGlmZjtcblx0XHRcdFx0XHRcdHRoaXMudkRvbVBhZFJpZ2h0IC09IGRpZmY7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0d29ya2luZyA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYoY2hhbmdlcyl7XG5cdFx0XHR0aGlzLnRhYmxlRWxlbWVudC5zdHlsZS5wYWRkaW5nTGVmdCA9IHRoaXMudkRvbVBhZExlZnQgKyBcInB4XCI7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZW1vdmVDb2xSaWdodCgpe1xuXHRcdHZhciBjaGFuZ2VzID0gZmFsc2UsXG5cdFx0d29ya2luZyA9IHRydWU7XG5cdFx0XG5cdFx0d2hpbGUod29ya2luZyl7XG5cdFx0XHRsZXQgY29sdW1uID0gdGhpcy5jb2x1bW5zW3RoaXMucmlnaHRDb2xdO1xuXHRcdFx0XG5cdFx0XHRpZihjb2x1bW4pe1xuXHRcdFx0XHRpZihjb2x1bW4ubW9kdWxlcy52ZG9tSG96LmxlZnRQb3MgPiB0aGlzLnZEb21TY3JvbGxQb3NSaWdodCl7XG5cdFx0XHRcdFx0Y2hhbmdlcyA9IHRydWU7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0dGhpcy5nZXRWaXNpYmxlUm93cygpLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRcdFx0aWYocm93LnR5cGUgIT09IFwiZ3JvdXBcIil7XG5cdFx0XHRcdFx0XHRcdHZhciBjZWxsID0gcm93LmdldENlbGwoY29sdW1uKTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0cm93LmdldEVsZW1lbnQoKS5yZW1vdmVDaGlsZChjZWxsLmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4KSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiQ291bGQgbm90IHJlbW92ZUNvbFJpZ2h0XCIsIGV4Lm1lc3NhZ2UpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0dGhpcy52RG9tUGFkUmlnaHQgKz0gY29sdW1uLmdldFdpZHRoKCk7XG5cdFx0XHRcdFx0dGhpcy5yaWdodENvbCAtLTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLmdldFZpc2libGVSb3dzKCkuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdFx0XHRpZihyb3cudHlwZSAhPT0gXCJncm91cFwiKXtcblx0XHRcdFx0XHRcdFx0cm93Lm1vZHVsZXMudmRvbUhvei5yaWdodENvbCA9IHRoaXMucmlnaHRDb2w7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHR3b3JraW5nID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0d29ya2luZyA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZihjaGFuZ2VzKXtcblx0XHRcdHRoaXMudGFibGVFbGVtZW50LnN0eWxlLnBhZGRpbmdSaWdodCA9IHRoaXMudkRvbVBhZFJpZ2h0ICsgXCJweFwiO1xuXHRcdH1cblx0fVxuXHRcblx0cmVtb3ZlQ29sTGVmdCgpe1xuXHRcdHZhciBjaGFuZ2VzID0gZmFsc2UsXG5cdFx0d29ya2luZyA9IHRydWU7XG5cdFx0XG5cdFx0d2hpbGUod29ya2luZyl7XG5cdFx0XHRsZXQgY29sdW1uID0gdGhpcy5jb2x1bW5zW3RoaXMubGVmdENvbF07XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbil7XG5cdFx0XHRcdGlmKGNvbHVtbi5tb2R1bGVzLnZkb21Ib3oucmlnaHRQb3MgPCB0aGlzLnZEb21TY3JvbGxQb3NMZWZ0KXtcblx0XHRcdFx0XHRjaGFuZ2VzID0gdHJ1ZTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLmdldFZpc2libGVSb3dzKCkuZm9yRWFjaCgocm93KSA9PiB7XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYocm93LnR5cGUgIT09IFwiZ3JvdXBcIil7XG5cdFx0XHRcdFx0XHRcdHZhciBjZWxsID0gcm93LmdldENlbGwoY29sdW1uKTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0cm93LmdldEVsZW1lbnQoKS5yZW1vdmVDaGlsZChjZWxsLmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4KSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiQ291bGQgbm90IHJlbW92ZUNvbExlZnRcIiwgZXgubWVzc2FnZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLnZEb21QYWRMZWZ0ICs9IGNvbHVtbi5nZXRXaWR0aCgpO1xuXHRcdFx0XHRcdHRoaXMubGVmdENvbCArKztcblx0XHRcdFx0XHRcblx0XHRcdFx0XHR0aGlzLmdldFZpc2libGVSb3dzKCkuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdFx0XHRpZihyb3cudHlwZSAhPT0gXCJncm91cFwiKXtcblx0XHRcdFx0XHRcdFx0cm93Lm1vZHVsZXMudmRvbUhvei5sZWZ0Q29sID0gdGhpcy5sZWZ0Q29sO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0d29ya2luZyA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYoY2hhbmdlcyl7XG5cdFx0XHR0aGlzLnRhYmxlRWxlbWVudC5zdHlsZS5wYWRkaW5nTGVmdCA9IHRoaXMudkRvbVBhZExlZnQgKyBcInB4XCI7XG5cdFx0fVxuXHR9XG5cdFxuXHRmaXREYXRhQ29sQWN0dWFsV2lkdGhDaGVjayhjb2x1bW4pe1xuXHRcdHZhciBuZXdXaWR0aCwgd2lkdGhEaWZmO1xuXHRcdFxuXHRcdGlmKGNvbHVtbi5tb2R1bGVzLnZkb21Ib3ouZml0RGF0YUNoZWNrKXtcblx0XHRcdGNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHRcdFx0XG5cdFx0XHRuZXdXaWR0aCA9IGNvbHVtbi5nZXRXaWR0aCgpO1xuXHRcdFx0d2lkdGhEaWZmID0gbmV3V2lkdGggLSBjb2x1bW4ubW9kdWxlcy52ZG9tSG96LndpZHRoO1xuXHRcdFx0XG5cdFx0XHRpZih3aWR0aERpZmYpe1xuXHRcdFx0XHRjb2x1bW4ubW9kdWxlcy52ZG9tSG96LnJpZ2h0UG9zICs9IHdpZHRoRGlmZjtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMudmRvbUhvei53aWR0aCA9IG5ld1dpZHRoO1xuXHRcdFx0XHR0aGlzLmNvbFBvc2l0aW9uQWRqdXN0KHRoaXMuY29sdW1ucy5pbmRleE9mKGNvbHVtbikgKyAxLCB0aGlzLmNvbHVtbnMubGVuZ3RoLCB3aWR0aERpZmYpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb2x1bW4ubW9kdWxlcy52ZG9tSG96LmZpdERhdGFDaGVjayA9IGZhbHNlO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gd2lkdGhEaWZmO1xuXHR9XG5cdFxuXHRpbml0aWFsaXplUm93KHJvdyl7XG5cdFx0aWYocm93LnR5cGUgIT09IFwiZ3JvdXBcIil7XG5cdFx0XHRyb3cubW9kdWxlcy52ZG9tSG96ID0ge1xuXHRcdFx0XHRsZWZ0Q29sOnRoaXMubGVmdENvbCxcblx0XHRcdFx0cmlnaHRDb2w6dGhpcy5yaWdodENvbCxcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zKXtcblx0XHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmZyb3plbkNvbHVtbnMubGVmdENvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hcHBlbmRDZWxsKHJvdywgY29sdW1uKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGZvcihsZXQgaSA9IHRoaXMubGVmdENvbDsgaSA8PSB0aGlzLnJpZ2h0Q29sOyBpKyspe1xuXHRcdFx0XHR0aGlzLmFwcGVuZENlbGwocm93LCB0aGlzLmNvbHVtbnNbaV0pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnRhYmxlLm1vZHVsZXMuZnJvemVuQ29sdW1ucyl7XG5cdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLnJpZ2h0Q29sdW1ucy5mb3JFYWNoKChjb2x1bW4pID0+IHtcblx0XHRcdFx0XHR0aGlzLmFwcGVuZENlbGwocm93LCBjb2x1bW4pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdGFwcGVuZENlbGwocm93LCBjb2x1bW4pe1xuXHRcdGlmKGNvbHVtbiAmJiBjb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRsZXQgY2VsbCA9IHJvdy5nZXRDZWxsKGNvbHVtbik7XG5cdFx0XHRcblx0XHRcdHJvdy5nZXRFbGVtZW50KCkuYXBwZW5kQ2hpbGQoY2VsbC5nZXRFbGVtZW50KCkpO1xuXHRcdFx0Y2VsbC5jZWxsUmVuZGVyZWQoKTtcblx0XHR9XG5cdH1cblx0XG5cdHJlaW5pdGlhbGl6ZVJvdyhyb3csIGZvcmNlKXtcblx0XHRpZihyb3cudHlwZSAhPT0gXCJncm91cFwiKXtcblx0XHRcdGlmKGZvcmNlIHx8ICFyb3cubW9kdWxlcy52ZG9tSG96IHx8IHJvdy5tb2R1bGVzLnZkb21Ib3oubGVmdENvbCAhPT0gdGhpcy5sZWZ0Q29sIHx8IHJvdy5tb2R1bGVzLnZkb21Ib3oucmlnaHRDb2wgIT09IHRoaXMucmlnaHRDb2wpe1xuXHRcdFx0XHRcblx0XHRcdFx0dmFyIHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblx0XHRcdFx0d2hpbGUocm93RWwuZmlyc3RDaGlsZCkgcm93RWwucmVtb3ZlQ2hpbGQocm93RWwuZmlyc3RDaGlsZCk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVSb3cocm93KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxuY2xhc3MgQ29sdW1uTWFuYWdlciBleHRlbmRzIENvcmVGZWF0dXJlIHtcblx0XG5cdGNvbnN0cnVjdG9yICh0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMuYmxvY2tIb3pTY3JvbGxFdmVudCA9IGZhbHNlO1xuXHRcdHRoaXMuaGVhZGVyc0VsZW1lbnQgPSBudWxsO1xuXHRcdHRoaXMuY29udGVudHNFbGVtZW50ID0gbnVsbDtcblx0XHR0aGlzLnJvd0hlYWRlciA9IG51bGw7XG5cdFx0dGhpcy5lbGVtZW50ID0gbnVsbCA7IC8vY29udGFpbmluZyBlbGVtZW50XG5cdFx0dGhpcy5jb2x1bW5zID0gW107IC8vIGNvbHVtbiBkZWZpbml0aW9uIG9iamVjdFxuXHRcdHRoaXMuY29sdW1uc0J5SW5kZXggPSBbXTsgLy9jb2x1bW5zIGJ5IGluZGV4XG5cdFx0dGhpcy5jb2x1bW5zQnlGaWVsZCA9IHt9OyAvL2NvbHVtbnMgYnkgZmllbGRcblx0XHR0aGlzLnNjcm9sbExlZnQgPSAwO1xuXHRcdHRoaXMub3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcy50YWJsZSwgXCJjb2x1bW4gZGVmaW5pdGlvblwiLCBkZWZhdWx0Q29sdW1uT3B0aW9ucyk7XG5cdFx0XG5cdFx0dGhpcy5yZWRyYXdCbG9jayA9IGZhbHNlOyAvL3ByZXZlbnQgcmVkcmF3cyB0byBhbGxvdyBtdWx0aXBsZSBkYXRhIG1hbmlwdWxhdGlvbnMgYmVmb3JlIGNvbnRpbnVpbmdcblx0XHR0aGlzLnJlZHJhd0Jsb2NrVXBkYXRlID0gbnVsbDsgLy9zdG9yZSBsYXRlc3QgcmVkcmF3IHVwZGF0ZSBvbmx5IHN0YXR1c1xuXHRcdFxuXHRcdHRoaXMucmVuZGVyZXIgPSBudWxsO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLyBTZXR1cCBGdW5jdGlvbnMgLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLmluaXRpYWxpemVSZW5kZXJlcigpO1xuXHRcdFxuXHRcdHRoaXMuaGVhZGVyc0VsZW1lbnQgPSB0aGlzLmNyZWF0ZUhlYWRlcnNFbGVtZW50KCk7XG5cdFx0dGhpcy5jb250ZW50c0VsZW1lbnQgPSB0aGlzLmNyZWF0ZUhlYWRlckNvbnRlbnRzRWxlbWVudCgpO1xuXHRcdHRoaXMuZWxlbWVudCA9IHRoaXMuY3JlYXRlSGVhZGVyRWxlbWVudCgpO1xuXHRcdFxuXHRcdHRoaXMuY29udGVudHNFbGVtZW50Lmluc2VydEJlZm9yZSh0aGlzLmhlYWRlcnNFbGVtZW50LCB0aGlzLmNvbnRlbnRzRWxlbWVudC5maXJzdENoaWxkKTtcblx0XHR0aGlzLmVsZW1lbnQuaW5zZXJ0QmVmb3JlKHRoaXMuY29udGVudHNFbGVtZW50LCB0aGlzLmVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdFx0XG5cdFx0dGhpcy5pbml0aWFsaXplU2Nyb2xsV2hlZWxXYXRjaGVyKCk7XG5cdFx0XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJzY3JvbGwtaG9yaXpvbnRhbFwiLCB0aGlzLnNjcm9sbEhvcml6b250YWwuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJzY3JvbGxiYXItdmVydGljYWxcIiwgdGhpcy5wYWRWZXJ0aWNhbFNjcm9sbGJhci5iaW5kKHRoaXMpKTtcblx0fVxuXHRcblx0cGFkVmVydGljYWxTY3JvbGxiYXIod2lkdGgpe1xuXHRcdGlmKHRoaXMudGFibGUucnRsKXtcblx0XHRcdHRoaXMuaGVhZGVyc0VsZW1lbnQuc3R5bGUubWFyZ2luTGVmdCA9IHdpZHRoICsgXCJweFwiO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuaGVhZGVyc0VsZW1lbnQuc3R5bGUubWFyZ2luUmlnaHQgPSB3aWR0aCArIFwicHhcIjtcblx0XHR9XG5cdH1cblx0XG5cdGluaXRpYWxpemVSZW5kZXJlcigpe1xuXHRcdHZhciByZW5kZXJDbGFzcztcblx0XHRcblx0XHR2YXIgcmVuZGVyZXJzID0ge1xuXHRcdFx0XCJ2aXJ0dWFsXCI6IFZpcnR1YWxEb21Ib3Jpem9udGFsLFxuXHRcdFx0XCJiYXNpY1wiOiBCYXNpY0hvcml6b250YWwsXG5cdFx0fTtcblx0XHRcblx0XHRpZih0eXBlb2YgdGhpcy50YWJsZS5vcHRpb25zLnJlbmRlckhvcml6b250YWwgPT09IFwic3RyaW5nXCIpe1xuXHRcdFx0cmVuZGVyQ2xhc3MgPSByZW5kZXJlcnNbdGhpcy50YWJsZS5vcHRpb25zLnJlbmRlckhvcml6b250YWxdO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJlbmRlckNsYXNzID0gdGhpcy50YWJsZS5vcHRpb25zLnJlbmRlckhvcml6b250YWw7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHJlbmRlckNsYXNzKXtcblx0XHRcdHRoaXMucmVuZGVyZXIgPSBuZXcgcmVuZGVyQ2xhc3ModGhpcy50YWJsZSwgdGhpcy5lbGVtZW50LCB0aGlzLnRhYmxlRWxlbWVudCk7XG5cdFx0XHR0aGlzLnJlbmRlcmVyLmluaXRpYWxpemUoKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIGZpbmQgbWF0Y2hpbmcgcmVuZGVyZXI6XCIsIHRoaXMudGFibGUub3B0aW9ucy5yZW5kZXJIb3Jpem9udGFsKTtcblx0XHR9XG5cdH1cblx0XG5cdFxuXHRjcmVhdGVIZWFkZXJzRWxlbWVudCAoKXtcblx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFxuXHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItaGVhZGVyc1wiKTtcblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwicm93XCIpO1xuXHRcdFxuXHRcdHJldHVybiBlbDtcblx0fVxuXHRcblx0Y3JlYXRlSGVhZGVyQ29udGVudHNFbGVtZW50ICgpe1xuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XG5cdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1oZWFkZXItY29udGVudHNcIik7XG5cdFx0ZWwuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcInJvd2dyb3VwXCIpO1xuXHRcdFxuXHRcdHJldHVybiBlbDtcblx0fVxuXHRcblx0Y3JlYXRlSGVhZGVyRWxlbWVudCAoKXtcblx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFxuXHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItaGVhZGVyXCIpO1xuXHRcdGVsLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJyb3dncm91cFwiKTtcblx0XHRcblx0XHRpZighdGhpcy50YWJsZS5vcHRpb25zLmhlYWRlclZpc2libGUpe1xuXHRcdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1oZWFkZXItaGlkZGVuXCIpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gZWw7XG5cdH1cblx0XG5cdC8vcmV0dXJuIGNvbnRhaW5pbmcgZWxlbWVudFxuXHRnZXRFbGVtZW50KCl7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fVxuXHRcblx0Ly9yZXR1cm4gY29udGFpbmluZyBjb250ZW50cyBlbGVtZW50XG5cdGdldENvbnRlbnRzRWxlbWVudCgpe1xuXHRcdHJldHVybiB0aGlzLmNvbnRlbnRzRWxlbWVudDtcblx0fVxuXHRcblx0XG5cdC8vcmV0dXJuIGhlYWRlciBjb250YWluaW5nIGVsZW1lbnRcblx0Z2V0SGVhZGVyc0VsZW1lbnQoKXtcblx0XHRyZXR1cm4gdGhpcy5oZWFkZXJzRWxlbWVudDtcblx0fVxuXHRcblx0Ly9zY3JvbGwgaG9yaXpvbnRhbGx5IHRvIG1hdGNoIHRhYmxlIGJvZHlcblx0c2Nyb2xsSG9yaXpvbnRhbChsZWZ0KXtcblx0XHR0aGlzLmNvbnRlbnRzRWxlbWVudC5zY3JvbGxMZWZ0ID0gbGVmdDtcblx0XHRcblx0XHR0aGlzLnNjcm9sbExlZnQgPSBsZWZ0O1xuXHRcdFxuXHRcdHRoaXMucmVuZGVyZXIuc2Nyb2xsQ29sdW1ucyhsZWZ0KTtcblx0fVxuXHRcblx0aW5pdGlhbGl6ZVNjcm9sbFdoZWVsV2F0Y2hlcigpe1xuXHRcdHRoaXMuY29udGVudHNFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCAoZSkgPT4ge1xuXHRcdFx0dmFyIGxlZnQ7XG5cdFx0XHRcblx0XHRcdGlmKGUuZGVsdGFYKXtcblx0XHRcdFx0bGVmdCA9IHRoaXMuY29udGVudHNFbGVtZW50LnNjcm9sbExlZnQgKyBlLmRlbHRhWDtcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHRcdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLyBDb2x1bW4gU2V0dXAgRnVuY3Rpb25zIC8vLy8vLy8vLy8vLy9cblx0Z2VuZXJhdGVDb2x1bW5zRnJvbVJvd0RhdGEoZGF0YSl7XG5cdFx0dmFyIGNvbHMgPSBbXSxcblx0XHRjb2xsUHJvZ3Jlc3MgPSB7fSxcblx0XHRyb3dTYW1wbGUgPSB0aGlzLnRhYmxlLm9wdGlvbnMuYXV0b0NvbHVtbnMgPT09IFwiZnVsbFwiID8gZGF0YSA6IFtkYXRhWzBdXSxcblx0XHRkZWZpbml0aW9ucyA9IHRoaXMudGFibGUub3B0aW9ucy5hdXRvQ29sdW1uc0RlZmluaXRpb25zO1xuXHRcdFxuXHRcdGlmKGRhdGEgJiYgZGF0YS5sZW5ndGgpe1xuXHRcdFx0XG5cdFx0XHRyb3dTYW1wbGUuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdFxuXHRcdFx0XHRPYmplY3Qua2V5cyhyb3cpLmZvckVhY2goKGtleSwgaW5kZXgpID0+IHtcblx0XHRcdFx0XHRsZXQgdmFsdWUgPSByb3dba2V5XSxcblx0XHRcdFx0XHRjb2w7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoIWNvbGxQcm9ncmVzc1trZXldKXtcblx0XHRcdFx0XHRcdGNvbCA9IHtcblx0XHRcdFx0XHRcdFx0ZmllbGQ6a2V5LFxuXHRcdFx0XHRcdFx0XHR0aXRsZTprZXksXG5cdFx0XHRcdFx0XHRcdHNvcnRlcjp0aGlzLmNhbGN1bGF0ZVNvcnRlckZyb21WYWx1ZSh2YWx1ZSksXG5cdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRjb2xzLnNwbGljZShpbmRleCwgMCwgY29sKTtcblx0XHRcdFx0XHRcdGNvbGxQcm9ncmVzc1trZXldID0gdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiID8gY29sIDogdHJ1ZTtcblx0XHRcdFx0XHR9ZWxzZSBpZihjb2xsUHJvZ3Jlc3Nba2V5XSAhPT0gdHJ1ZSl7XG5cdFx0XHRcdFx0XHRpZih0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0XHRcdFx0XHRjb2xsUHJvZ3Jlc3Nba2V5XS5zb3J0ZXIgPSB0aGlzLmNhbGN1bGF0ZVNvcnRlckZyb21WYWx1ZSh2YWx1ZSk7XG5cdFx0XHRcdFx0XHRcdGNvbGxQcm9ncmVzc1trZXldID0gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdGlmKGRlZmluaXRpb25zKXtcblx0XHRcdFx0XG5cdFx0XHRcdHN3aXRjaCh0eXBlb2YgZGVmaW5pdGlvbnMpe1xuXHRcdFx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMgPSBkZWZpbml0aW9ucy5jYWxsKHRoaXMudGFibGUsIGNvbHMpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y2FzZSBcIm9iamVjdFwiOlxuXHRcdFx0XHRcdFx0aWYoQXJyYXkuaXNBcnJheShkZWZpbml0aW9ucykpe1xuXHRcdFx0XHRcdFx0XHRjb2xzLmZvckVhY2goKGNvbCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBtYXRjaCA9IGRlZmluaXRpb25zLmZpbmQoKGRlZikgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGRlZi5maWVsZCA9PT0gY29sLmZpZWxkO1xuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdGlmKG1hdGNoKXtcblx0XHRcdFx0XHRcdFx0XHRcdE9iamVjdC5hc3NpZ24oY29sLCBtYXRjaCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGNvbHMuZm9yRWFjaCgoY29sKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0aWYoZGVmaW5pdGlvbnNbY29sLmZpZWxkXSl7XG5cdFx0XHRcdFx0XHRcdFx0XHRPYmplY3QuYXNzaWduKGNvbCwgZGVmaW5pdGlvbnNbY29sLmZpZWxkXSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMgPSBjb2xzO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMgPSBjb2xzO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnNldENvbHVtbnModGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMpO1xuXHRcdH1cblx0fVxuXHRcblx0Y2FsY3VsYXRlU29ydGVyRnJvbVZhbHVlKHZhbHVlKXtcblx0XHR2YXIgc29ydGVyO1xuXHRcdFxuXHRcdHN3aXRjaCh0eXBlb2YgdmFsdWUpe1xuXHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRzb3J0ZXIgPSBcInN0cmluZ1wiO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSBcImJvb2xlYW5cIjpcblx0XHRcdFx0c29ydGVyID0gXCJib29sZWFuXCI7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwibnVtYmVyXCI6XG5cdFx0XHRcdHNvcnRlciA9IFwibnVtYmVyXCI7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdGlmKEFycmF5LmlzQXJyYXkodmFsdWUpKXtcblx0XHRcdFx0XHRzb3J0ZXIgPSBcImFycmF5XCI7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRzb3J0ZXIgPSBcInN0cmluZ1wiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRpZighaXNOYU4odmFsdWUpICYmIHZhbHVlICE9PSBcIlwiKXtcblx0XHRcdFx0XHRzb3J0ZXIgPSBcIm51bWJlclwiO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0aWYodmFsdWUubWF0Y2goLygoXlswLTldK1thLXpdKyl8KF5bYS16XStbMC05XSspKSskL2kpKXtcblx0XHRcdFx0XHRcdHNvcnRlciA9IFwiYWxwaGFudW1cIjtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRzb3J0ZXIgPSBcInN0cmluZ1wiO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHNvcnRlcjtcblx0fVxuXHRcblx0c2V0Q29sdW1ucyhjb2xzLCByb3cpe1xuXHRcdHdoaWxlKHRoaXMuaGVhZGVyc0VsZW1lbnQuZmlyc3RDaGlsZCkgdGhpcy5oZWFkZXJzRWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLmhlYWRlcnNFbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdFxuXHRcdHRoaXMuY29sdW1ucyA9IFtdO1xuXHRcdHRoaXMuY29sdW1uc0J5SW5kZXggPSBbXTtcblx0XHR0aGlzLmNvbHVtbnNCeUZpZWxkID0ge307XG5cdFx0XG5cdFx0dGhpcy5kaXNwYXRjaChcImNvbHVtbnMtbG9hZGluZ1wiKTtcblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJjb2x1bW5zTG9hZGluZ1wiKTtcblx0XHRcblx0XHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucm93SGVhZGVyKXtcblx0XHRcdHRoaXMucm93SGVhZGVyID0gbmV3IENvbHVtbih0aGlzLnRhYmxlLm9wdGlvbnMucm93SGVhZGVyID09PSB0cnVlID8ge30gOiB0aGlzLnRhYmxlLm9wdGlvbnMucm93SGVhZGVyLCB0aGlzLCB0cnVlKTtcblx0XHRcdHRoaXMuY29sdW1ucy5wdXNoKHRoaXMucm93SGVhZGVyKTtcblx0XHRcdHRoaXMuaGVhZGVyc0VsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5yb3dIZWFkZXIuZ2V0RWxlbWVudCgpKTtcblx0XHRcdHRoaXMucm93SGVhZGVyLmNvbHVtblJlbmRlcmVkKCk7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbHMuZm9yRWFjaCgoZGVmLCBpKSA9PiB7XG5cdFx0XHR0aGlzLl9hZGRDb2x1bW4oZGVmKTtcblx0XHR9KTtcblx0XHRcblx0XHR0aGlzLl9yZUluZGV4Q29sdW1ucygpO1xuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2goXCJjb2x1bW5zLWxvYWRlZFwiKTtcblxuXHRcdGlmKHRoaXMuc3Vic2NyaWJlZEV4dGVybmFsKFwiY29sdW1uc0xvYWRlZFwiKSl7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJjb2x1bW5zTG9hZGVkXCIsIHRoaXMuZ2V0Q29tcG9uZW50cygpKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5yZXJlbmRlckNvbHVtbnMoZmFsc2UsIHRydWUpO1xuXHRcdFxuXHRcdHRoaXMucmVkcmF3KHRydWUpO1xuXHR9XG5cdFxuXHRfYWRkQ29sdW1uKGRlZmluaXRpb24sIGJlZm9yZSwgbmV4dFRvQ29sdW1uKXtcblx0XHR2YXIgY29sdW1uID0gbmV3IENvbHVtbihkZWZpbml0aW9uLCB0aGlzKSxcblx0XHRjb2xFbCA9IGNvbHVtbi5nZXRFbGVtZW50KCksXG5cdFx0aW5kZXggPSBuZXh0VG9Db2x1bW4gPyB0aGlzLmZpbmRDb2x1bW5JbmRleChuZXh0VG9Db2x1bW4pIDogbmV4dFRvQ29sdW1uO1xuXHRcdFxuXHRcdC8vcHJldmVudCBhZGRpbmcgb2Ygcm93cyBpbiBmcm9udCBvZiByb3cgaGVhZGVyXG5cdFx0aWYoYmVmb3JlICYmIHRoaXMucm93SGVhZGVyICYmICghbmV4dFRvQ29sdW1uIHx8IG5leHRUb0NvbHVtbiA9PT0gdGhpcy5yb3dIZWFkZXIpKXtcblx0XHRcdGJlZm9yZSA9IGZhbHNlO1xuXHRcdFx0bmV4dFRvQ29sdW1uID0gdGhpcy5yb3dIZWFkZXI7XG5cdFx0XHRpbmRleCA9IDA7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKG5leHRUb0NvbHVtbiAmJiBpbmRleCA+IC0xKXtcblx0XHRcdHZhciB0b3BDb2x1bW4gPSBuZXh0VG9Db2x1bW4uZ2V0VG9wQ29sdW1uKCk7XG5cdFx0XHR2YXIgcGFyZW50SW5kZXggPSB0aGlzLmNvbHVtbnMuaW5kZXhPZih0b3BDb2x1bW4pO1xuXHRcdFx0dmFyIG5leHRFbCA9IHRvcENvbHVtbi5nZXRFbGVtZW50KCk7XG5cdFx0XHRcblx0XHRcdGlmKGJlZm9yZSl7XG5cdFx0XHRcdHRoaXMuY29sdW1ucy5zcGxpY2UocGFyZW50SW5kZXgsIDAsIGNvbHVtbik7XG5cdFx0XHRcdG5leHRFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjb2xFbCwgbmV4dEVsKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5jb2x1bW5zLnNwbGljZShwYXJlbnRJbmRleCArIDEsIDAsIGNvbHVtbik7XG5cdFx0XHRcdG5leHRFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjb2xFbCwgbmV4dEVsLm5leHRTaWJsaW5nKTtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRpZihiZWZvcmUpe1xuXHRcdFx0XHR0aGlzLmNvbHVtbnMudW5zaGlmdChjb2x1bW4pO1xuXHRcdFx0XHR0aGlzLmhlYWRlcnNFbGVtZW50Lmluc2VydEJlZm9yZShjb2x1bW4uZ2V0RWxlbWVudCgpLCB0aGlzLmhlYWRlcnNFbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmNvbHVtbnMucHVzaChjb2x1bW4pO1xuXHRcdFx0XHR0aGlzLmhlYWRlcnNFbGVtZW50LmFwcGVuZENoaWxkKGNvbHVtbi5nZXRFbGVtZW50KCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRjb2x1bW4uY29sdW1uUmVuZGVyZWQoKTtcblx0XHRcblx0XHRyZXR1cm4gY29sdW1uO1xuXHR9XG5cdFxuXHRyZWdpc3RlckNvbHVtbkZpZWxkKGNvbCl7XG5cdFx0aWYoY29sLmRlZmluaXRpb24uZmllbGQpe1xuXHRcdFx0dGhpcy5jb2x1bW5zQnlGaWVsZFtjb2wuZGVmaW5pdGlvbi5maWVsZF0gPSBjb2w7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZWdpc3RlckNvbHVtblBvc2l0aW9uKGNvbCl7XG5cdFx0dGhpcy5jb2x1bW5zQnlJbmRleC5wdXNoKGNvbCk7XG5cdH1cblx0XG5cdF9yZUluZGV4Q29sdW1ucygpe1xuXHRcdHRoaXMuY29sdW1uc0J5SW5kZXggPSBbXTtcblx0XHRcblx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdFx0Y29sdW1uLnJlUmVnaXN0ZXJQb3NpdGlvbigpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHQvL2Vuc3VyZSBjb2x1bW4gaGVhZGVycyB0YWtlIHVwIHRoZSBjb3JyZWN0IGFtb3VudCBvZiBzcGFjZSBpbiBjb2x1bW4gZ3JvdXBzXG5cdHZlcnRpY2FsQWxpZ25IZWFkZXJzKCl7XG5cdFx0dmFyIG1pbkhlaWdodCA9IDA7XG5cdFx0XG5cdFx0aWYoIXRoaXMucmVkcmF3QmxvY2spe1xuXHRcdFx0XG5cdFx0XHR0aGlzLmhlYWRlcnNFbGVtZW50LnN0eWxlLmhlaWdodD1cIlwiO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdGNvbHVtbi5jbGVhclZlcnRpY2FsQWxpZ24oKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdHZhciBoZWlnaHQgPSBjb2x1bW4uZ2V0SGVpZ2h0KCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihoZWlnaHQgPiBtaW5IZWlnaHQpe1xuXHRcdFx0XHRcdG1pbkhlaWdodCA9IGhlaWdodDtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMuaGVhZGVyc0VsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gbWluSGVpZ2h0ICsgXCJweFwiO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdGNvbHVtbi52ZXJ0aWNhbEFsaWduKHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5IZWFkZXJWZXJ0QWxpZ24sIG1pbkhlaWdodCk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFkanVzdFRhYmxlU2l6ZSgpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLyBDb2x1bW4gRGV0YWlscyAvLy8vLy8vLy8vLy8vLy8vL1xuXHRmaW5kQ29sdW1uKHN1YmplY3Qpe1xuXHRcdHZhciBjb2x1bW5zO1xuXHRcdFxuXHRcdGlmKHR5cGVvZiBzdWJqZWN0ID09IFwib2JqZWN0XCIpe1xuXHRcdFx0XG5cdFx0XHRpZihzdWJqZWN0IGluc3RhbmNlb2YgQ29sdW1uKXtcblx0XHRcdFx0Ly9zdWJqZWN0IGlzIGNvbHVtbiBlbGVtZW50XG5cdFx0XHRcdHJldHVybiBzdWJqZWN0O1xuXHRcdFx0fWVsc2UgaWYoc3ViamVjdCBpbnN0YW5jZW9mIENvbHVtbkNvbXBvbmVudCl7XG5cdFx0XHRcdC8vc3ViamVjdCBpcyBwdWJsaWMgY29sdW1uIGNvbXBvbmVudFxuXHRcdFx0XHRyZXR1cm4gc3ViamVjdC5fZ2V0U2VsZigpIHx8IGZhbHNlO1xuXHRcdFx0fWVsc2UgaWYodHlwZW9mIEhUTUxFbGVtZW50ICE9PSBcInVuZGVmaW5lZFwiICYmIHN1YmplY3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb2x1bW5zID0gW107XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRcdFx0Y29sdW1ucy5wdXNoKGNvbHVtbik7XG5cdFx0XHRcdFx0Y29sdW1ucyA9IGNvbHVtbnMuY29uY2F0KGNvbHVtbi5nZXRDb2x1bW5zKHRydWUpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvL3N1YmplY3QgaXMgYSBIVE1MIGVsZW1lbnQgb2YgdGhlIGNvbHVtbiBoZWFkZXJcblx0XHRcdFx0bGV0IG1hdGNoID0gY29sdW1ucy5maW5kKChjb2x1bW4pID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gY29sdW1uLmVsZW1lbnQgPT09IHN1YmplY3Q7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIG1hdGNoIHx8IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0fWVsc2Uge1xuXHRcdFx0Ly9zdWJqZWN0IHNob3VsZCBiZSB0cmVhdGVkIGFzIHRoZSBmaWVsZCBuYW1lIG9mIHRoZSBjb2x1bW5cblx0XHRcdHJldHVybiB0aGlzLmNvbHVtbnNCeUZpZWxkW3N1YmplY3RdIHx8IGZhbHNlO1xuXHRcdH1cblx0XHRcblx0XHQvL2NhdGNoIGFsbCBmb3IgYW55IG90aGVyIHR5cGUgb2YgaW5wdXRcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0XG5cdGdldENvbHVtbkJ5RmllbGQoZmllbGQpe1xuXHRcdHJldHVybiB0aGlzLmNvbHVtbnNCeUZpZWxkW2ZpZWxkXTtcblx0fVxuXHRcblx0Z2V0Q29sdW1uc0J5RmllbGRSb290KHJvb3Qpe1xuXHRcdHZhciBtYXRjaGVzID0gW107XG5cdFx0XG5cdFx0T2JqZWN0LmtleXModGhpcy5jb2x1bW5zQnlGaWVsZCkuZm9yRWFjaCgoZmllbGQpID0+IHtcblx0XHRcdHZhciBmaWVsZFJvb3QgPSB0aGlzLnRhYmxlLm9wdGlvbnMubmVzdGVkRmllbGRTZXBhcmF0b3IgPyBmaWVsZC5zcGxpdCh0aGlzLnRhYmxlLm9wdGlvbnMubmVzdGVkRmllbGRTZXBhcmF0b3IpWzBdIDogZmllbGQ7XG5cdFx0XHRpZihmaWVsZFJvb3QgPT09IHJvb3Qpe1xuXHRcdFx0XHRtYXRjaGVzLnB1c2godGhpcy5jb2x1bW5zQnlGaWVsZFtmaWVsZF0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBtYXRjaGVzO1xuXHR9XG5cdFxuXHRnZXRDb2x1bW5CeUluZGV4KGluZGV4KXtcblx0XHRyZXR1cm4gdGhpcy5jb2x1bW5zQnlJbmRleFtpbmRleF07XG5cdH1cblx0XG5cdGdldEZpcnN0VmlzaWJsZUNvbHVtbigpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMuY29sdW1uc0J5SW5kZXguZmluZEluZGV4KChjb2wpID0+IHtcblx0XHRcdHJldHVybiBjb2wudmlzaWJsZTtcblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gaW5kZXggPiAtMSA/IHRoaXMuY29sdW1uc0J5SW5kZXhbaW5kZXhdIDogZmFsc2U7XG5cdH1cblx0XG5cdGdldFZpc2libGVDb2x1bW5zQnlJbmRleCgpIHtcblx0XHRyZXR1cm4gdGhpcy5jb2x1bW5zQnlJbmRleC5maWx0ZXIoKGNvbCkgPT4gY29sLnZpc2libGUpO1xuXHR9XG5cdFxuXHRnZXRDb2x1bW5zKCl7XG5cdFx0cmV0dXJuIHRoaXMuY29sdW1ucztcblx0fVxuXHRcblx0ZmluZENvbHVtbkluZGV4KGNvbHVtbil7XG5cdFx0cmV0dXJuIHRoaXMuY29sdW1uc0J5SW5kZXguZmluZEluZGV4KChjb2wpID0+IHtcblx0XHRcdHJldHVybiBjb2x1bW4gPT09IGNvbDtcblx0XHR9KTtcblx0fVxuXHRcblx0Ly9yZXR1cm4gYWxsIGNvbHVtbnMgdGhhdCBhcmUgbm90IGdyb3Vwc1xuXHRnZXRSZWFsQ29sdW1ucygpe1xuXHRcdHJldHVybiB0aGlzLmNvbHVtbnNCeUluZGV4O1xuXHR9XG5cdFxuXHQvL3RyYXZlcnNlIGFjcm9zcyBjb2x1bW5zIGFuZCBjYWxsIGFjdGlvblxuXHR0cmF2ZXJzZShjYWxsYmFjayl7XG5cdFx0dGhpcy5jb2x1bW5zQnlJbmRleC5mb3JFYWNoKChjb2x1bW4saSkgPT57XG5cdFx0XHRjYWxsYmFjayhjb2x1bW4sIGkpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHQvL2dldCBkZWZpbml0aW9ucyBvZiBhY3R1YWwgY29sdW1uc1xuXHRnZXREZWZpbml0aW9ucyhhY3RpdmUpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcblx0XHR0aGlzLmNvbHVtbnNCeUluZGV4LmZvckVhY2goKGNvbHVtbikgPT4ge1xuXHRcdFx0aWYoIWFjdGl2ZSB8fCAoYWN0aXZlICYmIGNvbHVtbi52aXNpYmxlKSl7XG5cdFx0XHRcdG91dHB1dC5wdXNoKGNvbHVtbi5nZXREZWZpbml0aW9uKCkpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblx0XG5cdC8vZ2V0IGZ1bGwgbmVzdGVkIGRlZmluaXRpb24gdHJlZVxuXHRnZXREZWZpbml0aW9uVHJlZSgpe1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcblx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRvdXRwdXQucHVzaChjb2x1bW4uZ2V0RGVmaW5pdGlvbih0cnVlKSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0Z2V0Q29tcG9uZW50cyhzdHJ1Y3R1cmVkKXtcblx0XHR2YXIgb3V0cHV0ID0gW10sXG5cdFx0Y29sdW1ucyA9IHN0cnVjdHVyZWQgPyB0aGlzLmNvbHVtbnMgOiB0aGlzLmNvbHVtbnNCeUluZGV4O1xuXHRcdFxuXHRcdGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG5cdFx0XHRvdXRwdXQucHVzaChjb2x1bW4uZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblx0XG5cdGdldFdpZHRoKCl7XG5cdFx0dmFyIHdpZHRoID0gMDtcblx0XHRcblx0XHR0aGlzLmNvbHVtbnNCeUluZGV4LmZvckVhY2goKGNvbHVtbikgPT4ge1xuXHRcdFx0aWYoY29sdW1uLnZpc2libGUpe1xuXHRcdFx0XHR3aWR0aCArPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gd2lkdGg7XG5cdH1cblx0XG5cdG1vdmVDb2x1bW4oZnJvbSwgdG8sIGFmdGVyKXtcblx0XHR0by5lbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGZyb20uZWxlbWVudCwgdG8uZWxlbWVudCk7XG5cdFx0XG5cdFx0aWYoYWZ0ZXIpe1xuXHRcdFx0dG8uZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0by5lbGVtZW50LCBmcm9tLmVsZW1lbnQpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLm1vdmVDb2x1bW5BY3R1YWwoZnJvbSwgdG8sIGFmdGVyKTtcblx0XHRcblx0XHR0aGlzLnZlcnRpY2FsQWxpZ25IZWFkZXJzKCk7XG5cdFx0XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlaW5pdGlhbGl6ZSgpO1xuXHR9XG5cdFxuXHRtb3ZlQ29sdW1uQWN0dWFsKGZyb20sIHRvLCBhZnRlcil7XG5cdFx0aWYoZnJvbS5wYXJlbnQuaXNHcm91cCl7XG5cdFx0XHR0aGlzLl9tb3ZlQ29sdW1uSW5BcnJheShmcm9tLnBhcmVudC5jb2x1bW5zLCBmcm9tLCB0bywgYWZ0ZXIpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuX21vdmVDb2x1bW5JbkFycmF5KHRoaXMuY29sdW1ucywgZnJvbSwgdG8sIGFmdGVyKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5fbW92ZUNvbHVtbkluQXJyYXkodGhpcy5jb2x1bW5zQnlJbmRleCwgZnJvbSwgdG8sIGFmdGVyLCB0cnVlKTtcblx0XHRcblx0XHR0aGlzLnJlcmVuZGVyQ29sdW1ucyh0cnVlKTtcblx0XHRcblx0XHR0aGlzLmRpc3BhdGNoKFwiY29sdW1uLW1vdmVkXCIsIGZyb20sIHRvLCBhZnRlcik7XG5cdFx0XG5cdFx0aWYodGhpcy5zdWJzY3JpYmVkRXh0ZXJuYWwoXCJjb2x1bW5Nb3ZlZFwiKSl7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJjb2x1bW5Nb3ZlZFwiLCBmcm9tLmdldENvbXBvbmVudCgpLCB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29tcG9uZW50cygpKTtcblx0XHR9XG5cdH1cblx0XG5cdF9tb3ZlQ29sdW1uSW5BcnJheShjb2x1bW5zLCBmcm9tLCB0bywgYWZ0ZXIsIHVwZGF0ZVJvd3Mpe1xuXHRcdHZhclx0ZnJvbUluZGV4ID0gY29sdW1ucy5pbmRleE9mKGZyb20pLFxuXHRcdHRvSW5kZXgsIHJvd3MgPSBbXTtcblx0XHRcblx0XHRpZiAoZnJvbUluZGV4ID4gLTEpIHtcblx0XHRcdFxuXHRcdFx0Y29sdW1ucy5zcGxpY2UoZnJvbUluZGV4LCAxKTtcblx0XHRcdFxuXHRcdFx0dG9JbmRleCA9IGNvbHVtbnMuaW5kZXhPZih0byk7XG5cdFx0XHRcblx0XHRcdGlmICh0b0luZGV4ID4gLTEpIHtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGFmdGVyKXtcblx0XHRcdFx0XHR0b0luZGV4ID0gdG9JbmRleCsxO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0b0luZGV4ID0gZnJvbUluZGV4O1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb2x1bW5zLnNwbGljZSh0b0luZGV4LCAwLCBmcm9tKTtcblx0XHRcdFxuXHRcdFx0aWYodXBkYXRlUm93cyl7XG5cdFx0XHRcdFxuXHRcdFx0XHRyb3dzID0gdGhpcy5jaGFpbihcImNvbHVtbi1tb3Zpbmctcm93c1wiLCBbZnJvbSwgdG8sIGFmdGVyXSwgbnVsbCwgW10pIHx8IFtdO1xuXHRcdFx0XHRcblx0XHRcdFx0cm93cyA9IHJvd3MuY29uY2F0KHRoaXMudGFibGUucm93TWFuYWdlci5yb3dzKTtcblx0XHRcdFx0XG5cdFx0XHRcdHJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdFx0XHRcdGlmKHJvdy5jZWxscy5sZW5ndGgpe1xuXHRcdFx0XHRcdFx0dmFyIGNlbGwgPSByb3cuY2VsbHMuc3BsaWNlKGZyb21JbmRleCwgMSlbMF07XG5cdFx0XHRcdFx0XHRyb3cuY2VsbHMuc3BsaWNlKHRvSW5kZXgsIDAsIGNlbGwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0c2Nyb2xsVG9Db2x1bW4oY29sdW1uLCBwb3NpdGlvbiwgaWZWaXNpYmxlKXtcblx0XHR2YXIgbGVmdCA9IDAsXG5cdFx0b2Zmc2V0ID0gY29sdW1uLmdldExlZnRPZmZzZXQoKSxcblx0XHRhZGp1c3QgPSAwLFxuXHRcdGNvbEVsID0gY29sdW1uLmdldEVsZW1lbnQoKTtcblx0XHRcblx0XHRcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XG5cdFx0XHRpZih0eXBlb2YgcG9zaXRpb24gPT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0XHRwb3NpdGlvbiA9IHRoaXMudGFibGUub3B0aW9ucy5zY3JvbGxUb0NvbHVtblBvc2l0aW9uO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0eXBlb2YgaWZWaXNpYmxlID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdFx0aWZWaXNpYmxlID0gdGhpcy50YWJsZS5vcHRpb25zLnNjcm9sbFRvQ29sdW1uSWZWaXNpYmxlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihjb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRcdFxuXHRcdFx0XHQvL2FsaWduIHRvIGNvcnJlY3QgcG9zaXRpb25cblx0XHRcdFx0c3dpdGNoKHBvc2l0aW9uKXtcblx0XHRcdFx0XHRjYXNlIFwibWlkZGxlXCI6XG5cdFx0XHRcdFx0Y2FzZSBcImNlbnRlclwiOlxuXHRcdFx0XHRcdFx0YWRqdXN0ID0gLXRoaXMuZWxlbWVudC5jbGllbnRXaWR0aCAvIDI7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjYXNlIFwicmlnaHRcIjpcblx0XHRcdFx0XHRcdGFkanVzdCA9IGNvbEVsLmNsaWVudFdpZHRoIC0gdGhpcy5oZWFkZXJzRWxlbWVudC5jbGllbnRXaWR0aDtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvL2NoZWNrIGNvbHVtbiB2aXNpYmlsaXR5XG5cdFx0XHRcdGlmKCFpZlZpc2libGUpe1xuXHRcdFx0XHRcdGlmKG9mZnNldCA+IDAgJiYgb2Zmc2V0ICsgY29sRWwub2Zmc2V0V2lkdGggPCB0aGlzLmVsZW1lbnQuY2xpZW50V2lkdGgpe1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly9jYWxjdWxhdGUgc2Nyb2xsIHBvc2l0aW9uXG5cdFx0XHRcdGxlZnQgPSBvZmZzZXQgKyBhZGp1c3Q7XG5cdFx0XHRcdFxuXHRcdFx0XHRsZWZ0ID0gTWF0aC5tYXgoTWF0aC5taW4obGVmdCwgdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsV2lkdGggLSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRXaWR0aCksMCk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcblx0XHRcdFx0dGhpcy5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHRcdFx0XHRcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJTY3JvbGwgRXJyb3IgLSBDb2x1bW4gbm90IHZpc2libGVcIik7XG5cdFx0XHRcdHJlamVjdChcIlNjcm9sbCBFcnJvciAtIENvbHVtbiBub3QgdmlzaWJsZVwiKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdH0pO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vIENlbGwgTWFuYWdlbWVudCAvLy8vLy8vLy8vLy8vLy8vL1xuXHRnZW5lcmF0ZUNlbGxzKHJvdyl7XG5cdFx0dmFyIGNlbGxzID0gW107XG5cdFx0XG5cdFx0dGhpcy5jb2x1bW5zQnlJbmRleC5mb3JFYWNoKChjb2x1bW4pID0+IHtcblx0XHRcdGNlbGxzLnB1c2goY29sdW1uLmdlbmVyYXRlQ2VsbChyb3cpKTtcblx0XHR9KTtcblx0XHRcblx0XHRyZXR1cm4gY2VsbHM7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8gQ29sdW1uIE1hbmFnZW1lbnQgLy8vLy8vLy8vLy8vLy8vLy9cblx0Z2V0RmxleEJhc2VXaWR0aCgpe1xuXHRcdHZhciB0b3RhbFdpZHRoID0gdGhpcy50YWJsZS5lbGVtZW50LmNsaWVudFdpZHRoLCAvL3RhYmxlIGVsZW1lbnQgd2lkdGhcblx0XHRmaXhlZFdpZHRoID0gMDtcblx0XHRcblx0XHQvL2FkanVzdCBmb3IgdmVydGljYWwgc2Nyb2xsYmFyIGlmIHByZXNlbnRcblx0XHRpZih0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxIZWlnaHQgPiB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRIZWlnaHQpe1xuXHRcdFx0dG90YWxXaWR0aCAtPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5vZmZzZXRXaWR0aCAtIHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LmNsaWVudFdpZHRoO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmNvbHVtbnNCeUluZGV4LmZvckVhY2goZnVuY3Rpb24oY29sdW1uKXtcblx0XHRcdHZhciB3aWR0aCwgbWluV2lkdGgsIGNvbFdpZHRoO1xuXHRcdFx0XG5cdFx0XHRpZihjb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRcdFxuXHRcdFx0XHR3aWR0aCA9IGNvbHVtbi5kZWZpbml0aW9uLndpZHRoIHx8IDA7XG5cdFx0XHRcdFxuXHRcdFx0XHRtaW5XaWR0aCA9IHBhcnNlSW50KGNvbHVtbi5taW5XaWR0aCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZih0eXBlb2Yod2lkdGgpID09IFwic3RyaW5nXCIpe1xuXHRcdFx0XHRcdGlmKHdpZHRoLmluZGV4T2YoXCIlXCIpID4gLTEpe1xuXHRcdFx0XHRcdFx0Y29sV2lkdGggPSAodG90YWxXaWR0aCAvIDEwMCkgKiBwYXJzZUludCh3aWR0aCkgO1xuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdGNvbFdpZHRoID0gcGFyc2VJbnQod2lkdGgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvbFdpZHRoID0gd2lkdGg7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGZpeGVkV2lkdGggKz0gY29sV2lkdGggPiBtaW5XaWR0aCA/IGNvbFdpZHRoIDogbWluV2lkdGg7XG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBmaXhlZFdpZHRoO1xuXHR9XG5cdFxuXHRhZGRDb2x1bW4oZGVmaW5pdGlvbiwgYmVmb3JlLCBuZXh0VG9Db2x1bW4pe1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHR2YXIgY29sdW1uID0gdGhpcy5fYWRkQ29sdW1uKGRlZmluaXRpb24sIGJlZm9yZSwgbmV4dFRvQ29sdW1uKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5fcmVJbmRleENvbHVtbnMoKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5kaXNwYXRjaChcImNvbHVtbi1hZGRcIiwgZGVmaW5pdGlvbiwgYmVmb3JlLCBuZXh0VG9Db2x1bW4pO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLmxheW91dE1vZGUoKSAhPSBcImZpdENvbHVtbnNcIil7XG5cdFx0XHRcdGNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnJlZHJhdyh0cnVlKTtcblx0XHRcdFxuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlaW5pdGlhbGl6ZSgpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnJlcmVuZGVyQ29sdW1ucygpO1xuXHRcdFx0XG5cdFx0XHRyZXNvbHZlKGNvbHVtbik7XG5cdFx0fSk7XG5cdH1cblx0XG5cdC8vcmVtb3ZlIGNvbHVtbiBmcm9tIHN5c3RlbVxuXHRkZXJlZ2lzdGVyQ29sdW1uKGNvbHVtbil7XG5cdFx0dmFyIGZpZWxkID0gY29sdW1uLmdldEZpZWxkKCksXG5cdFx0aW5kZXg7XG5cdFx0XG5cdFx0Ly9yZW1vdmUgZnJvbSBmaWVsZCBsaXN0XG5cdFx0aWYoZmllbGQpe1xuXHRcdFx0ZGVsZXRlIHRoaXMuY29sdW1uc0J5RmllbGRbZmllbGRdO1xuXHRcdH1cblx0XHRcblx0XHQvL3JlbW92ZSBmcm9tIGluZGV4IGxpc3Rcblx0XHRpbmRleCA9IHRoaXMuY29sdW1uc0J5SW5kZXguaW5kZXhPZihjb2x1bW4pO1xuXHRcdFxuXHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0dGhpcy5jb2x1bW5zQnlJbmRleC5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdH1cblx0XHRcblx0XHQvL3JlbW92ZSBmcm9tIGNvbHVtbiBsaXN0XG5cdFx0aW5kZXggPSB0aGlzLmNvbHVtbnMuaW5kZXhPZihjb2x1bW4pO1xuXHRcdFxuXHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0dGhpcy5jb2x1bW5zLnNwbGljZShpbmRleCwgMSk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMudmVydGljYWxBbGlnbkhlYWRlcnMoKTtcblx0XHRcblx0XHR0aGlzLnJlZHJhdygpO1xuXHR9XG5cdFxuXHRyZXJlbmRlckNvbHVtbnModXBkYXRlLCBzaWxlbnQpe1xuXHRcdGlmKCF0aGlzLnJlZHJhd0Jsb2NrKXtcblx0XHRcdHRoaXMucmVuZGVyZXIucmVyZW5kZXJDb2x1bW5zKHVwZGF0ZSwgc2lsZW50KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZih1cGRhdGUgPT09IGZhbHNlIHx8ICh1cGRhdGUgPT09IHRydWUgJiYgdGhpcy5yZWRyYXdCbG9ja1VwZGF0ZSA9PT0gbnVsbCkpe1xuXHRcdFx0XHR0aGlzLnJlZHJhd0Jsb2NrVXBkYXRlID0gdXBkYXRlO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0YmxvY2tSZWRyYXcoKXtcblx0XHR0aGlzLnJlZHJhd0Jsb2NrID0gdHJ1ZTtcblx0XHR0aGlzLnJlZHJhd0Jsb2NrVXBkYXRlID0gbnVsbDtcblx0fVxuXHRcblx0cmVzdG9yZVJlZHJhdygpe1xuXHRcdHRoaXMucmVkcmF3QmxvY2sgPSBmYWxzZTtcblx0XHR0aGlzLnZlcnRpY2FsQWxpZ25IZWFkZXJzKCk7XG5cdFx0dGhpcy5yZW5kZXJlci5yZXJlbmRlckNvbHVtbnModGhpcy5yZWRyYXdCbG9ja1VwZGF0ZSk7XG5cdFx0XG5cdH1cblx0XG5cdC8vcmVkcmF3IGNvbHVtbnNcblx0cmVkcmF3KGZvcmNlKXtcblx0XHRpZihIZWxwZXJzLmVsVmlzaWJsZSh0aGlzLmVsZW1lbnQpKXtcblx0XHRcdHRoaXMudmVydGljYWxBbGlnbkhlYWRlcnMoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoZm9yY2Upe1xuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlc2V0U2Nyb2xsKCk7XG5cdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVpbml0aWFsaXplKCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKCF0aGlzLmNvbmZpcm0oXCJ0YWJsZS1yZWRyYXdpbmdcIiwgZm9yY2UpKXtcblx0XHRcdHRoaXMubGF5b3V0UmVmcmVzaChmb3JjZSk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2goXCJ0YWJsZS1yZWRyYXdcIiwgZm9yY2UpO1xuXHRcdFxuXHRcdHRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5yZWRyYXcoKTtcblx0fVxufVxuXG5jbGFzcyBCYXNpY1ZlcnRpY2FsIGV4dGVuZHMgUmVuZGVyZXJ7XG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cdFx0XG5cdFx0dGhpcy52ZXJ0aWNhbEZpbGxNb2RlID0gXCJmaWxsXCI7XG5cdFx0XG5cdFx0dGhpcy5zY3JvbGxUb3AgPSAwO1xuXHRcdHRoaXMuc2Nyb2xsTGVmdCA9IDA7XG5cdFx0XG5cdFx0dGhpcy5zY3JvbGxUb3AgPSAwO1xuXHRcdHRoaXMuc2Nyb2xsTGVmdCA9IDA7XG5cdH1cblx0XG5cdGNsZWFyUm93cygpe1xuXHRcdHZhciBlbGVtZW50ID0gdGhpcy50YWJsZUVsZW1lbnQ7XG5cdFx0XG5cdFx0Ly8gZWxlbWVudC5jaGlsZHJlbi5kZXRhY2goKTtcblx0XHR3aGlsZShlbGVtZW50LmZpcnN0Q2hpbGQpIGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5maXJzdENoaWxkKTtcblx0XHRcblx0XHRlbGVtZW50LnNjcm9sbFRvcCA9IDA7XG5cdFx0ZWxlbWVudC5zY3JvbGxMZWZ0ID0gMDtcblx0XHRcblx0XHRlbGVtZW50LnN0eWxlLm1pbldpZHRoID0gXCJcIjtcblx0XHRlbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9IFwiXCI7XG5cdFx0ZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcblx0XHRlbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSBcIlwiO1xuXHR9XG5cdFxuXHRyZW5kZXJSb3dzKCkge1xuXHRcdHZhciBlbGVtZW50ID0gdGhpcy50YWJsZUVsZW1lbnQsXG5cdFx0b25seUdyb3VwSGVhZGVycyA9IHRydWUsXG5cdFx0dGFibGVGcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxuXHRcdHJvd3MgPSB0aGlzLnJvd3MoKTtcblx0XHRcblx0XHRyb3dzLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHtcblx0XHRcdHRoaXMuc3R5bGVSb3cocm93LCBpbmRleCk7XG5cdFx0XHRyb3cuaW5pdGlhbGl6ZShmYWxzZSwgdHJ1ZSk7XG5cdFx0XHRcblx0XHRcdGlmIChyb3cudHlwZSAhPT0gXCJncm91cFwiKSB7XG5cdFx0XHRcdG9ubHlHcm91cEhlYWRlcnMgPSBmYWxzZTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGFibGVGcmFnLmFwcGVuZENoaWxkKHJvdy5nZXRFbGVtZW50KCkpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdGVsZW1lbnQuYXBwZW5kQ2hpbGQodGFibGVGcmFnKTtcblx0XHRcblx0XHRyb3dzLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0cm93LnJlbmRlcmVkKCk7XG5cdFx0XHRcblx0XHRcdGlmKCFyb3cuaGVpZ2h0SW5pdGlhbGl6ZWQpIHtcblx0XHRcdFx0cm93LmNhbGNIZWlnaHQodHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0cm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdGlmKCFyb3cuaGVpZ2h0SW5pdGlhbGl6ZWQpIHtcblx0XHRcdFx0cm93LnNldENlbGxIZWlnaHQoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHRpZihvbmx5R3JvdXBIZWFkZXJzKXtcblx0XHRcdGVsZW1lbnQuc3R5bGUubWluV2lkdGggPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0V2lkdGgoKSArIFwicHhcIjtcblx0XHR9ZWxzZSB7XG5cdFx0XHRlbGVtZW50LnN0eWxlLm1pbldpZHRoID0gXCJcIjtcblx0XHR9XG5cdH1cblx0XG5cdFxuXHRyZXJlbmRlclJvd3MoY2FsbGJhY2spe1x0XG5cdFx0dGhpcy5jbGVhclJvd3MoKTtcblx0XHRcblx0XHRpZihjYWxsYmFjayl7XG5cdFx0XHRjYWxsYmFjaygpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnJlbmRlclJvd3MoKTtcblxuXHRcdGlmKCF0aGlzLnJvd3MoKS5sZW5ndGgpe1xuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnRhYmxlRW1wdHkoKTtcblx0XHR9XG5cdH1cblx0XG5cdHNjcm9sbFRvUm93TmVhcmVzdFRvcChyb3cpe1xuXHRcdHZhciByb3dUb3AgPSBIZWxwZXJzLmVsT2Zmc2V0KHJvdy5nZXRFbGVtZW50KCkpLnRvcDtcblx0XHRcblx0XHRyZXR1cm4gIShNYXRoLmFicyh0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AgLSByb3dUb3ApID4gTWF0aC5hYnModGhpcy5lbGVtZW50VmVydGljYWwuc2Nyb2xsVG9wICsgdGhpcy5lbGVtZW50VmVydGljYWwuY2xpZW50SGVpZ2h0IC0gcm93VG9wKSk7XG5cdH1cblx0XG5cdHNjcm9sbFRvUm93KHJvdyl7XG5cdFx0dmFyIHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblx0XHRcblx0XHR0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AgPSBIZWxwZXJzLmVsT2Zmc2V0KHJvd0VsKS50b3AgLSBIZWxwZXJzLmVsT2Zmc2V0KHRoaXMuZWxlbWVudFZlcnRpY2FsKS50b3AgKyB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3A7XG5cdH1cblx0XG5cdHZpc2libGVSb3dzKGluY2x1ZGluZ0J1ZmZlcil7XG5cdFx0cmV0dXJuIHRoaXMucm93cygpO1xuXHR9XG5cdFxufVxuXG5jbGFzcyBWaXJ0dWFsRG9tVmVydGljYWwgZXh0ZW5kcyBSZW5kZXJlcntcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblxuXHRcdHRoaXMudmVydGljYWxGaWxsTW9kZSA9IFwiZmlsbFwiO1xuXG5cdFx0dGhpcy5zY3JvbGxUb3AgPSAwO1xuXHRcdHRoaXMuc2Nyb2xsTGVmdCA9IDA7XG5cblx0XHR0aGlzLnZEb21Sb3dIZWlnaHQgPSAyMDsgLy9hcHByb3hpbWF0aW9uIG9mIHJvdyBoZWlnaHRzIGZvciBwYWRkaW5nXG5cblx0XHR0aGlzLnZEb21Ub3AgPSAwOyAvL2hvbGQgcG9zaXRpb24gZm9yIGZpcnN0IHJlbmRlcmVkIHJvdyBpbiB0aGUgdmlydHVhbCBET01cblx0XHR0aGlzLnZEb21Cb3R0b20gPSAwOyAvL2hvbGQgcG9zaXRpb24gZm9yIGxhc3QgcmVuZGVyZWQgcm93IGluIHRoZSB2aXJ0dWFsIERPTVxuXG5cdFx0dGhpcy52RG9tU2Nyb2xsUG9zVG9wID0gMDsgLy9sYXN0IHNjcm9sbCBwb3NpdGlvbiBvZiB0aGUgdkRvbSB0b3A7XG5cdFx0dGhpcy52RG9tU2Nyb2xsUG9zQm90dG9tID0gMDsgLy9sYXN0IHNjcm9sbCBwb3NpdGlvbiBvZiB0aGUgdkRvbSBib3R0b207XG5cblx0XHR0aGlzLnZEb21Ub3BQYWQgPSAwOyAvL2hvbGQgdmFsdWUgb2YgcGFkZGluZyBmb3IgdG9wIG9mIHZpcnR1YWwgRE9NXG5cdFx0dGhpcy52RG9tQm90dG9tUGFkID0gMDsgLy9ob2xkIHZhbHVlIG9mIHBhZGRpbmcgZm9yIGJvdHRvbSBvZiB2aXJ0dWFsIERPTVxuXG5cdFx0dGhpcy52RG9tTWF4UmVuZGVyQ2hhaW4gPSA5MDsgLy90aGUgbWF4aW11bSBudW1iZXIgb2YgZG9tIGVsZW1lbnRzIHRoYXQgY2FuIGJlIHJlbmRlcmVkIGluIDEgZ29cblxuXHRcdHRoaXMudkRvbVdpbmRvd0J1ZmZlciA9IDA7IC8vd2luZG93IHJvdyBidWZmZXIgYmVmb3JlIHJlbW92aW5nIGVsZW1lbnRzLCB0byBzbW9vdGggc2Nyb2xsaW5nXG5cblx0XHR0aGlzLnZEb21XaW5kb3dNaW5Ub3RhbFJvd3MgPSAyMDsgLy9taW5pbXVtIG51bWJlciBvZiByb3dzIHRvIGJlIGdlbmVyYXRlZCBpbiB2aXJ0dWFsIGRvbSAocHJldmVudCBidWZmZXJpbmcgaXNzdWVzIG9uIHRhYmxlcyB3aXRoIHRhbGwgcm93cylcblx0XHR0aGlzLnZEb21XaW5kb3dNaW5NYXJnaW5Sb3dzID0gNTsgLy9taW5pbXVtIG51bWJlciBvZiByb3dzIHRvIGJlIGdlbmVyYXRlZCBpbiB2aXJ0dWFsIGRvbSBtYXJnaW5cblxuXHRcdHRoaXMudkRvbVRvcE5ld1Jvd3MgPSBbXTsgLy9yb3dzIHRvIG5vcm1hbGl6ZSBhZnRlciBhcHBlbmRpbmcgdG8gb3B0aW1pemUgcmVuZGVyIHNwZWVkXG5cdFx0dGhpcy52RG9tQm90dG9tTmV3Um93cyA9IFtdOyAvL3Jvd3MgdG8gbm9ybWFsaXplIGFmdGVyIGFwcGVuZGluZyB0byBvcHRpbWl6ZSByZW5kZXIgc3BlZWRcblx0fVxuXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLyBQdWJsaWMgRnVuY3Rpb25zIC8vLy8vLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblx0Y2xlYXJSb3dzKCl7XG5cdFx0dmFyIGVsZW1lbnQgPSB0aGlzLnRhYmxlRWxlbWVudDtcblxuXHRcdC8vIGVsZW1lbnQuY2hpbGRyZW4uZGV0YWNoKCk7XG5cdFx0d2hpbGUoZWxlbWVudC5maXJzdENoaWxkKSBlbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cblx0XHRlbGVtZW50LnN0eWxlLnBhZGRpbmdUb3AgPSBcIlwiO1xuXHRcdGVsZW1lbnQuc3R5bGUucGFkZGluZ0JvdHRvbSA9IFwiXCI7XG5cdFx0ZWxlbWVudC5zdHlsZS5taW5IZWlnaHQgPSBcIlwiO1xuXHRcdGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG5cdFx0ZWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gXCJcIjtcblxuXHRcdHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbFRvcCA9IDA7XG5cdFx0dGhpcy5lbGVtZW50VmVydGljYWwuc2Nyb2xsTGVmdCA9IDA7XG5cblx0XHR0aGlzLnNjcm9sbFRvcCA9IDA7XG5cdFx0dGhpcy5zY3JvbGxMZWZ0ID0gMDtcblxuXHRcdHRoaXMudkRvbVRvcCA9IDA7XG5cdFx0dGhpcy52RG9tQm90dG9tID0gMDtcblx0XHR0aGlzLnZEb21Ub3BQYWQgPSAwO1xuXHRcdHRoaXMudkRvbUJvdHRvbVBhZCA9IDA7XG5cdFx0dGhpcy52RG9tU2Nyb2xsUG9zVG9wID0gMDtcblx0XHR0aGlzLnZEb21TY3JvbGxQb3NCb3R0b20gPSAwO1xuXHR9XG5cblx0cmVuZGVyUm93cygpe1xuXHRcdHRoaXMuX3ZpcnR1YWxSZW5kZXJGaWxsKCk7XG5cdH1cblxuXHRyZXJlbmRlclJvd3MoY2FsbGJhY2spe1xuXHRcdHZhciBzY3JvbGxUb3AgPSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3A7XG5cdFx0dmFyIHRvcFJvdyA9IGZhbHNlO1xuXHRcdHZhciB0b3BPZmZzZXQgPSBmYWxzZTtcblxuXHRcdHZhciBsZWZ0ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbExlZnQ7XG5cblx0XHR2YXIgcm93cyA9IHRoaXMucm93cygpO1xuXG5cdFx0Zm9yKHZhciBpID0gdGhpcy52RG9tVG9wOyBpIDw9IHRoaXMudkRvbUJvdHRvbTsgaSsrKXtcblxuXHRcdFx0aWYocm93c1tpXSl7XG5cdFx0XHRcdHZhciBkaWZmID0gc2Nyb2xsVG9wIC0gcm93c1tpXS5nZXRFbGVtZW50KCkub2Zmc2V0VG9wO1xuXG5cdFx0XHRcdGlmKHRvcE9mZnNldCA9PT0gZmFsc2UgfHwgTWF0aC5hYnMoZGlmZikgPCB0b3BPZmZzZXQpe1xuXHRcdFx0XHRcdHRvcE9mZnNldCA9IGRpZmY7XG5cdFx0XHRcdFx0dG9wUm93ID0gaTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdHJvdy5kZWluaXRpYWxpemVIZWlnaHQoKTtcblx0XHR9KTtcblxuXHRcdGlmKGNhbGxiYWNrKXtcblx0XHRcdGNhbGxiYWNrKCk7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5yb3dzKCkubGVuZ3RoKXtcblx0XHRcdHRoaXMuX3ZpcnR1YWxSZW5kZXJGaWxsKCh0b3BSb3cgPT09IGZhbHNlID8gdGhpcy5yb3dzLmxlbmd0aCAtIDEgOiB0b3BSb3cpLCB0cnVlLCB0b3BPZmZzZXQgfHwgMCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5jbGVhcigpO1xuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnRhYmxlRW1wdHkoKTtcblx0XHR9XG5cblx0XHR0aGlzLnNjcm9sbENvbHVtbnMobGVmdCk7XG5cdH1cblxuXHRzY3JvbGxDb2x1bW5zKGxlZnQpe1xuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHR9XG5cblx0c2Nyb2xsUm93cyh0b3AsIGRpcil7XG5cdFx0dmFyIHRvcERpZmYgPSB0b3AgLSB0aGlzLnZEb21TY3JvbGxQb3NUb3A7XG5cdFx0dmFyIGJvdHRvbURpZmYgPSB0b3AgLSB0aGlzLnZEb21TY3JvbGxQb3NCb3R0b207XG5cdFx0dmFyIG1hcmdpbiA9IHRoaXMudkRvbVdpbmRvd0J1ZmZlciAqIDI7XG5cdFx0dmFyIHJvd3MgPSB0aGlzLnJvd3MoKTtcblxuXHRcdHRoaXMuc2Nyb2xsVG9wID0gdG9wO1xuXG5cdFx0aWYoLXRvcERpZmYgPiBtYXJnaW4gfHwgYm90dG9tRGlmZiA+IG1hcmdpbil7XG5cdFx0XHQvL2lmIGJpZyBzY3JvbGwgcmVkcmF3IHRhYmxlO1xuXHRcdFx0dmFyIGxlZnQgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuc2Nyb2xsTGVmdDtcblx0XHRcdHRoaXMuX3ZpcnR1YWxSZW5kZXJGaWxsKE1hdGguZmxvb3IoKHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbFRvcCAvIHRoaXMuZWxlbWVudFZlcnRpY2FsLnNjcm9sbEhlaWdodCkgKiByb3dzLmxlbmd0aCkpO1xuXHRcdFx0dGhpcy5zY3JvbGxDb2x1bW5zKGxlZnQpO1xuXHRcdH1lbHNlIHtcblxuXHRcdFx0aWYoZGlyKXtcblx0XHRcdFx0Ly9zY3JvbGxpbmcgdXBcblx0XHRcdFx0aWYodG9wRGlmZiA8IDApe1xuXHRcdFx0XHRcdHRoaXMuX2FkZFRvcFJvdyhyb3dzLCAtdG9wRGlmZik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZihib3R0b21EaWZmIDwgMCl7XG5cdFx0XHRcdFx0Ly9oaWRlIGJvdHRvbSByb3cgaWYgbmVlZGVkXG5cdFx0XHRcdFx0aWYodGhpcy52RG9tU2Nyb2xsSGVpZ2h0IC0gdGhpcy5zY3JvbGxUb3AgPiB0aGlzLnZEb21XaW5kb3dCdWZmZXIpe1xuXHRcdFx0XHRcdFx0dGhpcy5fcmVtb3ZlQm90dG9tUm93KHJvd3MsIC1ib3R0b21EaWZmKTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnZEb21TY3JvbGxQb3NCb3R0b20gPSB0aGlzLnNjcm9sbFRvcDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblxuXHRcdFx0XHRpZihib3R0b21EaWZmID49IDApe1xuXHRcdFx0XHRcdHRoaXMuX2FkZEJvdHRvbVJvdyhyb3dzLCBib3R0b21EaWZmKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vc2Nyb2xsaW5nIGRvd25cblx0XHRcdFx0aWYodG9wRGlmZiA+PSAwKXtcblx0XHRcdFx0XHQvL2hpZGUgdG9wIHJvdyBpZiBuZWVkZWRcblx0XHRcdFx0XHRpZih0aGlzLnNjcm9sbFRvcCA+IHRoaXMudkRvbVdpbmRvd0J1ZmZlcil7XG5cdFx0XHRcdFx0XHR0aGlzLl9yZW1vdmVUb3BSb3cocm93cywgdG9wRGlmZik7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0dGhpcy52RG9tU2Nyb2xsUG9zVG9wID0gdGhpcy5zY3JvbGxUb3A7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmVzaXplKCl7XG5cdFx0dGhpcy52RG9tV2luZG93QnVmZmVyID0gdGhpcy50YWJsZS5vcHRpb25zLnJlbmRlclZlcnRpY2FsQnVmZmVyIHx8IHRoaXMuZWxlbWVudFZlcnRpY2FsLmNsaWVudEhlaWdodDtcblx0fVxuXG5cdHNjcm9sbFRvUm93TmVhcmVzdFRvcChyb3cpe1xuXHRcdHZhciByb3dJbmRleCA9IHRoaXMucm93cygpLmluZGV4T2Yocm93KTtcblxuXHRcdHJldHVybiAhKE1hdGguYWJzKHRoaXMudkRvbVRvcCAtIHJvd0luZGV4KSA+IE1hdGguYWJzKHRoaXMudkRvbUJvdHRvbSAtIHJvd0luZGV4KSk7XG5cdH1cblxuXHRzY3JvbGxUb1Jvdyhyb3cpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMucm93cygpLmluZGV4T2Yocm93KTtcblxuXHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0dGhpcy5fdmlydHVhbFJlbmRlckZpbGwoaW5kZXgsIHRydWUpO1xuXHRcdH1cblx0fVxuXG5cdHZpc2libGVSb3dzKGluY2x1ZGluZ0J1ZmZlcil7XG5cdFx0dmFyIHRvcEVkZ2UgPSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxUb3AsXG5cdFx0Ym90dG9tRWRnZSA9IHRoaXMuZWxlbWVudFZlcnRpY2FsLmNsaWVudEhlaWdodCArIHRvcEVkZ2UsXG5cdFx0dG9wRm91bmQgPSBmYWxzZSxcblx0XHR0b3BSb3cgPSAwLFxuXHRcdGJvdHRvbVJvdyA9IDAsXG5cdFx0cm93cyA9IHRoaXMucm93cygpO1xuXG5cdFx0aWYoaW5jbHVkaW5nQnVmZmVyKXtcblx0XHRcdHRvcFJvdyA9IHRoaXMudkRvbVRvcDtcblx0XHRcdGJvdHRvbVJvdyA9IHRoaXMudkRvbUJvdHRvbTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRmb3IodmFyIGkgPSB0aGlzLnZEb21Ub3A7IGkgPD0gdGhpcy52RG9tQm90dG9tOyBpKyspe1xuXHRcdFx0XHRpZihyb3dzW2ldKXtcblx0XHRcdFx0XHRpZighdG9wRm91bmQpe1xuXHRcdFx0XHRcdFx0aWYoKHRvcEVkZ2UgLSByb3dzW2ldLmdldEVsZW1lbnQoKS5vZmZzZXRUb3ApID49IDApe1xuXHRcdFx0XHRcdFx0XHR0b3BSb3cgPSBpO1xuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0b3BGb3VuZCA9IHRydWU7XG5cblx0XHRcdFx0XHRcdFx0aWYoYm90dG9tRWRnZSAtIHJvd3NbaV0uZ2V0RWxlbWVudCgpLm9mZnNldFRvcCA+PSAwKXtcblx0XHRcdFx0XHRcdFx0XHRib3R0b21Sb3cgPSBpO1xuXHRcdFx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRpZihib3R0b21FZGdlIC0gcm93c1tpXS5nZXRFbGVtZW50KCkub2Zmc2V0VG9wID49IDApe1xuXHRcdFx0XHRcdFx0XHRib3R0b21Sb3cgPSBpO1xuXHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gcm93cy5zbGljZSh0b3BSb3csIGJvdHRvbVJvdyArIDEpO1xuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8gSW50ZXJuYWwgUmVuZGVyaW5nIC8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXHQvL2Z1bGwgdmlydHVhbCByZW5kZXJcblx0X3ZpcnR1YWxSZW5kZXJGaWxsKHBvc2l0aW9uLCBmb3JjZU1vdmUsIG9mZnNldCkge1xuXHRcdHZhclx0ZWxlbWVudCA9IHRoaXMudGFibGVFbGVtZW50LFxuXHRcdGhvbGRlciA9IHRoaXMuZWxlbWVudFZlcnRpY2FsLFxuXHRcdHRvcFBhZCA9IDAsXG5cdFx0cm93c0hlaWdodCA9IDAsXG5cdFx0cm93SGVpZ2h0ID0gMCxcblx0XHRoZWlnaHRPY2N1cGllZCA9IDAsXG5cdFx0dG9wUGFkSGVpZ2h0ID0gMCxcblx0XHRpID0gMCxcblx0XHRyb3dzID0gdGhpcy5yb3dzKCksXG5cdFx0cm93c0NvdW50ID0gcm93cy5sZW5ndGgsXG5cdFx0aW5kZXggPSAwLFxuXHRcdHJvdyxcblx0XHRyb3dGcmFnbWVudCxcblx0XHRyZW5kZXJlZFJvd3MgPSBbXSxcblx0XHR0b3RhbFJvd3NSZW5kZXJlZCA9IDAsXG5cdFx0cm93c1RvUmVuZGVyID0gMCxcblx0XHRmaXhlZEhlaWdodCA9IHRoaXMudGFibGUucm93TWFuYWdlci5maXhlZEhlaWdodCxcblx0XHRjb250YWluZXJIZWlnaHQgPSB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5jbGllbnRIZWlnaHQsIFxuXHRcdGF2Z1Jvd0hlaWdodCA9IHRoaXMudGFibGUub3B0aW9ucy5yb3dIZWlnaHQsIFxuXHRcdHJlc2l6ZWQgPSB0cnVlO1xuXG5cdFx0cG9zaXRpb24gPSBwb3NpdGlvbiB8fCAwO1xuXG5cdFx0b2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XG5cblx0XHRpZighcG9zaXRpb24pe1xuXHRcdFx0dGhpcy5jbGVhcigpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHdoaWxlKGVsZW1lbnQuZmlyc3RDaGlsZCkgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50LmZpcnN0Q2hpbGQpO1xuXG5cdFx0XHQvL2NoZWNrIGlmIHBvc2l0aW9uIGlzIHRvbyBjbG9zZSB0byBib3R0b20gb2YgdGFibGVcblx0XHRcdGhlaWdodE9jY3VwaWVkID0gKHJvd3NDb3VudCAtIHBvc2l0aW9uICsgMSkgKiB0aGlzLnZEb21Sb3dIZWlnaHQ7XG5cblx0XHRcdGlmKGhlaWdodE9jY3VwaWVkIDwgY29udGFpbmVySGVpZ2h0KXtcblx0XHRcdFx0cG9zaXRpb24gLT0gTWF0aC5jZWlsKChjb250YWluZXJIZWlnaHQgLSBoZWlnaHRPY2N1cGllZCkgLyB0aGlzLnZEb21Sb3dIZWlnaHQpO1xuXHRcdFx0XHRpZihwb3NpdGlvbiA8IDApe1xuXHRcdFx0XHRcdHBvc2l0aW9uID0gMDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvL2NhbGN1bGF0ZSBpbml0aWFsIHBhZFxuXHRcdFx0dG9wUGFkID0gTWF0aC5taW4oTWF0aC5tYXgoTWF0aC5mbG9vcih0aGlzLnZEb21XaW5kb3dCdWZmZXIgLyB0aGlzLnZEb21Sb3dIZWlnaHQpLCAgdGhpcy52RG9tV2luZG93TWluTWFyZ2luUm93cyksIHBvc2l0aW9uKTtcblx0XHRcdHBvc2l0aW9uIC09IHRvcFBhZDtcblx0XHR9XG5cblx0XHRpZihyb3dzQ291bnQgJiYgSGVscGVycy5lbFZpc2libGUodGhpcy5lbGVtZW50VmVydGljYWwpKXtcblx0XHRcdHRoaXMudkRvbVRvcCA9IHBvc2l0aW9uO1xuXHRcdFx0dGhpcy52RG9tQm90dG9tID0gcG9zaXRpb24gLTE7XG5cblx0XHRcdGlmKGZpeGVkSGVpZ2h0IHx8IHRoaXMudGFibGUub3B0aW9ucy5tYXhIZWlnaHQpIHtcblx0XHRcdFx0aWYoYXZnUm93SGVpZ2h0KSB7XG5cdFx0XHRcdFx0cm93c1RvUmVuZGVyID0gKGNvbnRhaW5lckhlaWdodCAvIGF2Z1Jvd0hlaWdodCkgKyAodGhpcy52RG9tV2luZG93QnVmZmVyIC8gYXZnUm93SGVpZ2h0KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyb3dzVG9SZW5kZXIgPSBNYXRoLm1heCh0aGlzLnZEb21XaW5kb3dNaW5Ub3RhbFJvd3MsIE1hdGguY2VpbChyb3dzVG9SZW5kZXIpKTtcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRyb3dzVG9SZW5kZXIgPSByb3dzQ291bnQ7XG5cdFx0XHR9XG5cblx0XHRcdHdoaWxlKCgocm93c1RvUmVuZGVyID09IHJvd3NDb3VudCB8fCByb3dzSGVpZ2h0IDw9IGNvbnRhaW5lckhlaWdodCArIHRoaXMudkRvbVdpbmRvd0J1ZmZlcikgfHwgdG90YWxSb3dzUmVuZGVyZWQgPCB0aGlzLnZEb21XaW5kb3dNaW5Ub3RhbFJvd3MpICYmIHRoaXMudkRvbUJvdHRvbSA8IHJvd3NDb3VudCAtMSkge1xuXHRcdFx0XHRyZW5kZXJlZFJvd3MgPSBbXTtcblx0XHRcdFx0cm93RnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cblx0XHRcdFx0aSA9IDA7XG5cblx0XHRcdFx0d2hpbGUgKChpIDwgcm93c1RvUmVuZGVyKSAmJiB0aGlzLnZEb21Cb3R0b20gPCByb3dzQ291bnQgLTEpIHtcdFxuXHRcdFx0XHRcdGluZGV4ID0gdGhpcy52RG9tQm90dG9tICsgMSxcblx0XHRcdFx0XHRyb3cgPSByb3dzW2luZGV4XTtcblxuXHRcdFx0XHRcdHRoaXMuc3R5bGVSb3cocm93LCBpbmRleCk7XG5cblx0XHRcdFx0XHRyb3cuaW5pdGlhbGl6ZShmYWxzZSwgdHJ1ZSk7XG5cdFx0XHRcdFx0aWYoIXJvdy5oZWlnaHRJbml0aWFsaXplZCAmJiAhdGhpcy50YWJsZS5vcHRpb25zLnJvd0hlaWdodCl7XG5cdFx0XHRcdFx0XHRyb3cuY2xlYXJDZWxsSGVpZ2h0KCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cm93RnJhZ21lbnQuYXBwZW5kQ2hpbGQocm93LmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdFx0cmVuZGVyZWRSb3dzLnB1c2gocm93KTtcblx0XHRcdFx0XHR0aGlzLnZEb21Cb3R0b20gKys7XG5cdFx0XHRcdFx0aSsrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYoIXJlbmRlcmVkUm93cy5sZW5ndGgpe1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZWxlbWVudC5hcHBlbmRDaGlsZChyb3dGcmFnbWVudCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBOT1RFOiBUaGUgbmV4dCAzIGxvb3BzIGFyZSBzZXBhcmF0ZSBvbiBwdXJwb3NlXG5cdFx0XHRcdC8vIFRoaXMgaXMgdG8gYmF0Y2ggdXAgdGhlIGRvbSB3cml0ZXMgYW5kIHJlYWRzIHdoaWNoIGRyYXN0aWNhbGx5IGltcHJvdmVzIHBlcmZvcm1hbmNlIFxuXG5cdFx0XHRcdHJlbmRlcmVkUm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdFx0XHRyb3cucmVuZGVyZWQoKTtcblxuXHRcdFx0XHRcdGlmKCFyb3cuaGVpZ2h0SW5pdGlhbGl6ZWQpIHtcblx0XHRcdFx0XHRcdHJvdy5jYWxjSGVpZ2h0KHRydWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0cmVuZGVyZWRSb3dzLmZvckVhY2goKHJvdykgPT4ge1xuXHRcdFx0XHRcdGlmKCFyb3cuaGVpZ2h0SW5pdGlhbGl6ZWQpIHtcblx0XHRcdFx0XHRcdHJvdy5zZXRDZWxsSGVpZ2h0KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRyZW5kZXJlZFJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRcdFx0cm93SGVpZ2h0ID0gcm93LmdldEhlaWdodCgpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKHRvdGFsUm93c1JlbmRlcmVkIDwgdG9wUGFkKXtcblx0XHRcdFx0XHRcdHRvcFBhZEhlaWdodCArPSByb3dIZWlnaHQ7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0cm93c0hlaWdodCArPSByb3dIZWlnaHQ7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYocm93SGVpZ2h0ID4gdGhpcy52RG9tV2luZG93QnVmZmVyKXtcblx0XHRcdFx0XHRcdHRoaXMudkRvbVdpbmRvd0J1ZmZlciA9IHJvd0hlaWdodCAqIDI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRvdGFsUm93c1JlbmRlcmVkKys7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHJlc2l6ZWQgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWRqdXN0VGFibGVTaXplKCk7XG5cdFx0XHRcdGNvbnRhaW5lckhlaWdodCA9IHRoaXMuZWxlbWVudFZlcnRpY2FsLmNsaWVudEhlaWdodDtcblx0XHRcdFx0aWYocmVzaXplZCAmJiAoZml4ZWRIZWlnaHQgfHwgdGhpcy50YWJsZS5vcHRpb25zLm1heEhlaWdodCkpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRhdmdSb3dIZWlnaHQgPSByb3dzSGVpZ2h0IC8gdG90YWxSb3dzUmVuZGVyZWQ7XG5cdFx0XHRcdFx0cm93c1RvUmVuZGVyID0gTWF0aC5tYXgodGhpcy52RG9tV2luZG93TWluVG90YWxSb3dzLCBNYXRoLmNlaWwoKGNvbnRhaW5lckhlaWdodCAvIGF2Z1Jvd0hlaWdodCkgKyAodGhpcy52RG9tV2luZG93QnVmZmVyIC8gYXZnUm93SGVpZ2h0KSkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmKCFwb3NpdGlvbil7XG5cdFx0XHRcdHRoaXMudkRvbVRvcFBhZCA9IDA7XG5cdFx0XHRcdC8vYWRqdXN0IHJvdyBoZWlnaHQgdG8gbWF0Y2ggYXZlcmFnZSBvZiByZW5kZXJlZCBlbGVtZW50c1xuXHRcdFx0XHR0aGlzLnZEb21Sb3dIZWlnaHQgPSBNYXRoLmZsb29yKChyb3dzSGVpZ2h0ICsgdG9wUGFkSGVpZ2h0KSAvIHRvdGFsUm93c1JlbmRlcmVkKTtcblx0XHRcdFx0dGhpcy52RG9tQm90dG9tUGFkID0gdGhpcy52RG9tUm93SGVpZ2h0ICogKHJvd3NDb3VudCAtIHRoaXMudkRvbUJvdHRvbSAtMSk7XG5cblx0XHRcdFx0dGhpcy52RG9tU2Nyb2xsSGVpZ2h0ID0gdG9wUGFkSGVpZ2h0ICsgcm93c0hlaWdodCArIHRoaXMudkRvbUJvdHRvbVBhZCAtIGNvbnRhaW5lckhlaWdodDtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy52RG9tVG9wUGFkID0gIWZvcmNlTW92ZSA/IHRoaXMuc2Nyb2xsVG9wIC0gdG9wUGFkSGVpZ2h0IDogKHRoaXMudkRvbVJvd0hlaWdodCAqIHRoaXMudkRvbVRvcCkgKyBvZmZzZXQ7XG5cdFx0XHRcdHRoaXMudkRvbUJvdHRvbVBhZCA9IHRoaXMudkRvbUJvdHRvbSA9PSByb3dzQ291bnQtMSA/IDAgOiBNYXRoLm1heCh0aGlzLnZEb21TY3JvbGxIZWlnaHQgLSB0aGlzLnZEb21Ub3BQYWQgLSByb3dzSGVpZ2h0IC0gdG9wUGFkSGVpZ2h0LCAwKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0ZWxlbWVudC5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy52RG9tVG9wUGFkK1wicHhcIjtcblx0XHRcdGVsZW1lbnQuc3R5bGUucGFkZGluZ0JvdHRvbSA9IHRoaXMudkRvbUJvdHRvbVBhZCtcInB4XCI7XG5cblx0XHRcdGlmKGZvcmNlTW92ZSl7XG5cdFx0XHRcdHRoaXMuc2Nyb2xsVG9wID0gdGhpcy52RG9tVG9wUGFkICsgKHRvcFBhZEhlaWdodCkgKyBvZmZzZXQgLSAodGhpcy5lbGVtZW50VmVydGljYWwuc2Nyb2xsV2lkdGggPiB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5jbGllbnRXaWR0aCA/IHRoaXMuZWxlbWVudFZlcnRpY2FsLm9mZnNldEhlaWdodCAtIGNvbnRhaW5lckhlaWdodCA6IDApO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnNjcm9sbFRvcCA9IE1hdGgubWluKHRoaXMuc2Nyb2xsVG9wLCB0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxIZWlnaHQgLSBjb250YWluZXJIZWlnaHQpO1xuXG5cdFx0XHQvL2FkanVzdCBmb3IgaG9yaXpvbnRhbCBzY3JvbGxiYXIgaWYgcHJlc2VudCAoYW5kIG5vdCBhdCB0b3Agb2YgdGFibGUpXG5cdFx0XHRpZih0aGlzLmVsZW1lbnRWZXJ0aWNhbC5zY3JvbGxXaWR0aCA+IHRoaXMuZWxlbWVudFZlcnRpY2FsLmNsaWVudFdpZHRoICYmIGZvcmNlTW92ZSl7XG5cdFx0XHRcdHRoaXMuc2Nyb2xsVG9wICs9IHRoaXMuZWxlbWVudFZlcnRpY2FsLm9mZnNldEhlaWdodCAtIGNvbnRhaW5lckhlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy52RG9tU2Nyb2xsUG9zVG9wID0gdGhpcy5zY3JvbGxUb3A7XG5cdFx0XHR0aGlzLnZEb21TY3JvbGxQb3NCb3R0b20gPSB0aGlzLnNjcm9sbFRvcDtcblxuXHRcdFx0aG9sZGVyLnNjcm9sbFRvcCA9IHRoaXMuc2Nyb2xsVG9wO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwicmVuZGVyLXZpcnR1YWwtZmlsbFwiKTtcblx0XHR9XG5cdH1cblxuXHRfYWRkVG9wUm93KHJvd3MsIGZpbGxhYmxlU3BhY2Upe1xuXHRcdHZhciB0YWJsZSA9IHRoaXMudGFibGVFbGVtZW50LFxuXHRcdGFkZGVkUm93cyA9IFtdLFxuXHRcdHBhZGRpbmdBZGp1c3QgPSAwLFxuXHRcdGluZGV4ID0gdGhpcy52RG9tVG9wIC0xLFxuXHRcdGkgPSAwLFxuXHRcdHdvcmtpbmcgPSB0cnVlO1xuXG5cdFx0d2hpbGUod29ya2luZyl7XG5cdFx0XHRpZih0aGlzLnZEb21Ub3Ape1xuXHRcdFx0XHRsZXQgcm93ID0gcm93c1tpbmRleF0sXG5cdFx0XHRcdHJvd0hlaWdodCwgaW5pdGlhbGl6ZWQ7XG5cblx0XHRcdFx0aWYocm93ICYmIGkgPCB0aGlzLnZEb21NYXhSZW5kZXJDaGFpbil7XG5cdFx0XHRcdFx0cm93SGVpZ2h0ID0gcm93LmdldEhlaWdodCgpIHx8IHRoaXMudkRvbVJvd0hlaWdodDtcblx0XHRcdFx0XHRpbml0aWFsaXplZCA9IHJvdy5pbml0aWFsaXplZDtcblxuXHRcdFx0XHRcdGlmKGZpbGxhYmxlU3BhY2UgPj0gcm93SGVpZ2h0KXtcblxuXHRcdFx0XHRcdFx0dGhpcy5zdHlsZVJvdyhyb3csIGluZGV4KTtcblx0XHRcdFx0XHRcdHRhYmxlLmluc2VydEJlZm9yZShyb3cuZ2V0RWxlbWVudCgpLCB0YWJsZS5maXJzdENoaWxkKTtcblxuXHRcdFx0XHRcdFx0aWYoIXJvdy5pbml0aWFsaXplZCB8fCAhcm93LmhlaWdodEluaXRpYWxpemVkKXtcblx0XHRcdFx0XHRcdFx0YWRkZWRSb3dzLnB1c2gocm93KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cm93LmluaXRpYWxpemUoKTtcblxuXHRcdFx0XHRcdFx0aWYoIWluaXRpYWxpemVkKXtcblx0XHRcdFx0XHRcdFx0cm93SGVpZ2h0ID0gcm93LmdldEVsZW1lbnQoKS5vZmZzZXRIZWlnaHQ7XG5cblx0XHRcdFx0XHRcdFx0aWYocm93SGVpZ2h0ID4gdGhpcy52RG9tV2luZG93QnVmZmVyKXtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnZEb21XaW5kb3dCdWZmZXIgPSByb3dIZWlnaHQgKiAyO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZpbGxhYmxlU3BhY2UgLT0gcm93SGVpZ2h0O1xuXHRcdFx0XHRcdFx0cGFkZGluZ0FkanVzdCArPSByb3dIZWlnaHQ7XG5cblx0XHRcdFx0XHRcdHRoaXMudkRvbVRvcC0tO1xuXHRcdFx0XHRcdFx0aW5kZXgtLTtcblx0XHRcdFx0XHRcdGkrKztcblxuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmb3IgKGxldCByb3cgb2YgYWRkZWRSb3dzKXtcblx0XHRcdHJvdy5jbGVhckNlbGxIZWlnaHQoKTtcblx0XHR9XG5cblx0XHR0aGlzLl9xdWlja05vcm1hbGl6ZVJvd0hlaWdodChhZGRlZFJvd3MpO1xuXG5cdFx0aWYocGFkZGluZ0FkanVzdCl7XG5cdFx0XHR0aGlzLnZEb21Ub3BQYWQgLT0gcGFkZGluZ0FkanVzdDtcblxuXHRcdFx0aWYodGhpcy52RG9tVG9wUGFkIDwgMCl7XG5cdFx0XHRcdHRoaXMudkRvbVRvcFBhZCA9IGluZGV4ICogdGhpcy52RG9tUm93SGVpZ2h0O1xuXHRcdFx0fVxuXG5cdFx0XHRpZihpbmRleCA8IDEpe1xuXHRcdFx0XHR0aGlzLnZEb21Ub3BQYWQgPSAwO1xuXHRcdFx0fVxuXG5cdFx0XHR0YWJsZS5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy52RG9tVG9wUGFkICsgXCJweFwiO1xuXHRcdFx0dGhpcy52RG9tU2Nyb2xsUG9zVG9wIC09IHBhZGRpbmdBZGp1c3Q7XG5cdFx0fVxuXHR9XG5cblx0X3JlbW92ZVRvcFJvdyhyb3dzLCBmaWxsYWJsZVNwYWNlKXtcblx0XHR2YXIgcmVtb3ZhYmxlUm93cyA9IFtdLFxuXHRcdHBhZGRpbmdBZGp1c3QgPSAwLFxuXHRcdGkgPSAwLFxuXHRcdHdvcmtpbmcgPSB0cnVlO1xuXG5cdFx0d2hpbGUod29ya2luZyl7XG5cdFx0XHRsZXQgcm93ID0gcm93c1t0aGlzLnZEb21Ub3BdLFxuXHRcdFx0cm93SGVpZ2h0O1xuXG5cdFx0XHRpZihyb3cgJiYgaSA8IHRoaXMudkRvbU1heFJlbmRlckNoYWluKXtcblx0XHRcdFx0cm93SGVpZ2h0ID0gcm93LmdldEhlaWdodCgpIHx8IHRoaXMudkRvbVJvd0hlaWdodDtcblxuXHRcdFx0XHRpZihmaWxsYWJsZVNwYWNlID49IHJvd0hlaWdodCl7XG5cdFx0XHRcdFx0dGhpcy52RG9tVG9wKys7XG5cblx0XHRcdFx0XHRmaWxsYWJsZVNwYWNlIC09IHJvd0hlaWdodDtcblx0XHRcdFx0XHRwYWRkaW5nQWRqdXN0ICs9IHJvd0hlaWdodDtcblxuXHRcdFx0XHRcdHJlbW92YWJsZVJvd3MucHVzaChyb3cpO1xuXHRcdFx0XHRcdGkrKztcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR3b3JraW5nID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Zm9yIChsZXQgcm93IG9mIHJlbW92YWJsZVJvd3Mpe1xuXHRcdFx0bGV0IHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblxuXHRcdFx0aWYocm93RWwucGFyZW50Tm9kZSl7XG5cdFx0XHRcdHJvd0VsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocm93RWwpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmKHBhZGRpbmdBZGp1c3Qpe1xuXHRcdFx0dGhpcy52RG9tVG9wUGFkICs9IHBhZGRpbmdBZGp1c3Q7XG5cdFx0XHR0aGlzLnRhYmxlRWxlbWVudC5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy52RG9tVG9wUGFkICsgXCJweFwiO1xuXHRcdFx0dGhpcy52RG9tU2Nyb2xsUG9zVG9wICs9IHRoaXMudkRvbVRvcCA/IHBhZGRpbmdBZGp1c3QgOiBwYWRkaW5nQWRqdXN0ICsgdGhpcy52RG9tV2luZG93QnVmZmVyO1xuXHRcdH1cblx0fVxuXG5cdF9hZGRCb3R0b21Sb3cocm93cywgZmlsbGFibGVTcGFjZSl7XG5cdFx0dmFyIHRhYmxlID0gdGhpcy50YWJsZUVsZW1lbnQsXG5cdFx0YWRkZWRSb3dzID0gW10sXG5cdFx0cGFkZGluZ0FkanVzdCA9IDAsXG5cdFx0aW5kZXggPSB0aGlzLnZEb21Cb3R0b20gKyAxLFxuXHRcdGkgPSAwLFxuXHRcdHdvcmtpbmcgPSB0cnVlO1xuXG5cdFx0d2hpbGUod29ya2luZyl7XG5cdFx0XHRsZXQgcm93ID0gcm93c1tpbmRleF0sXG5cdFx0XHRyb3dIZWlnaHQsIGluaXRpYWxpemVkO1xuXG5cdFx0XHRpZihyb3cgJiYgaSA8IHRoaXMudkRvbU1heFJlbmRlckNoYWluKXtcblx0XHRcdFx0cm93SGVpZ2h0ID0gcm93LmdldEhlaWdodCgpIHx8IHRoaXMudkRvbVJvd0hlaWdodDtcblx0XHRcdFx0aW5pdGlhbGl6ZWQgPSByb3cuaW5pdGlhbGl6ZWQ7XG5cblx0XHRcdFx0aWYoZmlsbGFibGVTcGFjZSA+PSByb3dIZWlnaHQpe1xuXG5cdFx0XHRcdFx0dGhpcy5zdHlsZVJvdyhyb3csIGluZGV4KTtcblx0XHRcdFx0XHR0YWJsZS5hcHBlbmRDaGlsZChyb3cuZ2V0RWxlbWVudCgpKTtcblxuXHRcdFx0XHRcdGlmKCFyb3cuaW5pdGlhbGl6ZWQgfHwgIXJvdy5oZWlnaHRJbml0aWFsaXplZCl7XG5cdFx0XHRcdFx0XHRhZGRlZFJvd3MucHVzaChyb3cpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJvdy5pbml0aWFsaXplKCk7XG5cblx0XHRcdFx0XHRpZighaW5pdGlhbGl6ZWQpe1xuXHRcdFx0XHRcdFx0cm93SGVpZ2h0ID0gcm93LmdldEVsZW1lbnQoKS5vZmZzZXRIZWlnaHQ7XG5cblx0XHRcdFx0XHRcdGlmKHJvd0hlaWdodCA+IHRoaXMudkRvbVdpbmRvd0J1ZmZlcil7XG5cdFx0XHRcdFx0XHRcdHRoaXMudkRvbVdpbmRvd0J1ZmZlciA9IHJvd0hlaWdodCAqIDI7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZmlsbGFibGVTcGFjZSAtPSByb3dIZWlnaHQ7XG5cdFx0XHRcdFx0cGFkZGluZ0FkanVzdCArPSByb3dIZWlnaHQ7XG5cblx0XHRcdFx0XHR0aGlzLnZEb21Cb3R0b20rKztcblx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHRcdGkrKztcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR3b3JraW5nID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Zm9yIChsZXQgcm93IG9mIGFkZGVkUm93cyl7XG5cdFx0XHRyb3cuY2xlYXJDZWxsSGVpZ2h0KCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fcXVpY2tOb3JtYWxpemVSb3dIZWlnaHQoYWRkZWRSb3dzKTtcblxuXHRcdGlmKHBhZGRpbmdBZGp1c3Qpe1xuXHRcdFx0dGhpcy52RG9tQm90dG9tUGFkIC09IHBhZGRpbmdBZGp1c3Q7XG5cblx0XHRcdGlmKHRoaXMudkRvbUJvdHRvbVBhZCA8IDAgfHwgaW5kZXggPT0gcm93cy5sZW5ndGggLTEpe1xuXHRcdFx0XHR0aGlzLnZEb21Cb3R0b21QYWQgPSAwO1xuXHRcdFx0fVxuXG5cdFx0XHR0YWJsZS5zdHlsZS5wYWRkaW5nQm90dG9tID0gdGhpcy52RG9tQm90dG9tUGFkICsgXCJweFwiO1xuXHRcdFx0dGhpcy52RG9tU2Nyb2xsUG9zQm90dG9tICs9IHBhZGRpbmdBZGp1c3Q7XG5cdFx0fVxuXHR9XG5cblx0X3JlbW92ZUJvdHRvbVJvdyhyb3dzLCBmaWxsYWJsZVNwYWNlKXtcblx0XHR2YXIgcmVtb3ZhYmxlUm93cyA9IFtdLFxuXHRcdHBhZGRpbmdBZGp1c3QgPSAwLFxuXHRcdGkgPSAwLFxuXHRcdHdvcmtpbmcgPSB0cnVlO1xuXG5cdFx0d2hpbGUod29ya2luZyl7XG5cdFx0XHRsZXQgcm93ID0gcm93c1t0aGlzLnZEb21Cb3R0b21dLFxuXHRcdFx0cm93SGVpZ2h0O1xuXG5cdFx0XHRpZihyb3cgJiYgaSA8IHRoaXMudkRvbU1heFJlbmRlckNoYWluKXtcblx0XHRcdFx0cm93SGVpZ2h0ID0gcm93LmdldEhlaWdodCgpIHx8IHRoaXMudkRvbVJvd0hlaWdodDtcblxuXHRcdFx0XHRpZihmaWxsYWJsZVNwYWNlID49IHJvd0hlaWdodCl7XG5cdFx0XHRcdFx0dGhpcy52RG9tQm90dG9tIC0tO1xuXG5cdFx0XHRcdFx0ZmlsbGFibGVTcGFjZSAtPSByb3dIZWlnaHQ7XG5cdFx0XHRcdFx0cGFkZGluZ0FkanVzdCArPSByb3dIZWlnaHQ7XG5cblx0XHRcdFx0XHRyZW1vdmFibGVSb3dzLnB1c2gocm93KTtcblx0XHRcdFx0XHRpKys7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHR3b3JraW5nID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0d29ya2luZyA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZvciAobGV0IHJvdyBvZiByZW1vdmFibGVSb3dzKXtcblx0XHRcdGxldCByb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cblx0XHRcdGlmKHJvd0VsLnBhcmVudE5vZGUpe1xuXHRcdFx0XHRyb3dFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvd0VsKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZihwYWRkaW5nQWRqdXN0KXtcblx0XHRcdHRoaXMudkRvbUJvdHRvbVBhZCArPSBwYWRkaW5nQWRqdXN0O1xuXG5cdFx0XHRpZih0aGlzLnZEb21Cb3R0b21QYWQgPCAwKXtcblx0XHRcdFx0dGhpcy52RG9tQm90dG9tUGFkID0gMDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy50YWJsZUVsZW1lbnQuc3R5bGUucGFkZGluZ0JvdHRvbSA9IHRoaXMudkRvbUJvdHRvbVBhZCArIFwicHhcIjtcblx0XHRcdHRoaXMudkRvbVNjcm9sbFBvc0JvdHRvbSAtPSBwYWRkaW5nQWRqdXN0O1xuXHRcdH1cblx0fVxuXG5cdF9xdWlja05vcm1hbGl6ZVJvd0hlaWdodChyb3dzKXtcblx0XHRmb3IobGV0IHJvdyBvZiByb3dzKXtcblx0XHRcdHJvdy5jYWxjSGVpZ2h0KCk7XG5cdFx0fVxuXG5cdFx0Zm9yKGxldCByb3cgb2Ygcm93cyl7XG5cdFx0XHRyb3cuc2V0Q2VsbEhlaWdodCgpO1xuXHRcdH1cblx0fVxufVxuXG5jbGFzcyBSb3dNYW5hZ2VyIGV4dGVuZHMgQ29yZUZlYXR1cmV7XG5cdFxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMuZWxlbWVudCA9IHRoaXMuY3JlYXRlSG9sZGVyRWxlbWVudCgpOyAvL2NvbnRhaW5pbmcgZWxlbWVudFxuXHRcdHRoaXMudGFibGVFbGVtZW50ID0gdGhpcy5jcmVhdGVUYWJsZUVsZW1lbnQoKTsgLy90YWJsZSBlbGVtZW50XG5cdFx0dGhpcy5oZWlnaHRGaXhlciA9IHRoaXMuY3JlYXRlVGFibGVFbGVtZW50KCk7IC8vdGFibGUgZWxlbWVudFxuXHRcdHRoaXMucGxhY2Vob2xkZXIgPSBudWxsOyAvL3BsYWNlaG9sZGVyIGVsZW1lbnRcblx0XHR0aGlzLnBsYWNlaG9sZGVyQ29udGVudHMgPSBudWxsOyAvL3BsYWNlaG9sZGVyIGVsZW1lbnRcblx0XHRcblx0XHR0aGlzLmZpcnN0UmVuZGVyID0gZmFsc2U7IC8vaGFuZGxlIGZpcnN0IHJlbmRlclxuXHRcdHRoaXMucmVuZGVyTW9kZSA9IFwidmlydHVhbFwiOyAvL2N1cnJlbnQgcmVuZGVyaW5nIG1vZGVcblx0XHR0aGlzLmZpeGVkSGVpZ2h0ID0gZmFsc2U7IC8vY3VycmVudCByZW5kZXJpbmcgbW9kZVxuXHRcdFxuXHRcdHRoaXMucm93cyA9IFtdOyAvL2hvbGQgcm93IGRhdGEgb2JqZWN0c1xuXHRcdHRoaXMuYWN0aXZlUm93c1BpcGVsaW5lID0gW107IC8vaG9sZCBjYWxjdWxhdGlvbiBvZiBhY3RpdmUgcm93c1xuXHRcdHRoaXMuYWN0aXZlUm93cyA9IFtdOyAvL3Jvd3MgY3VycmVudGx5IGF2YWlsYWJsZSB0byBvbiBkaXNwbGF5IGluIHRoZSB0YWJsZVxuXHRcdHRoaXMuYWN0aXZlUm93c0NvdW50ID0gMDsgLy9jb3VudCBvZiBhY3RpdmUgcm93c1xuXHRcdFxuXHRcdHRoaXMuZGlzcGxheVJvd3MgPSBbXTsgLy9yb3dzIGN1cnJlbnRseSBvbiBkaXNwbGF5IGluIHRoZSB0YWJsZVxuXHRcdHRoaXMuZGlzcGxheVJvd3NDb3VudCA9IDA7IC8vY291bnQgb2YgZGlzcGxheSByb3dzXG5cdFx0XG5cdFx0dGhpcy5zY3JvbGxUb3AgPSAwO1xuXHRcdHRoaXMuc2Nyb2xsTGVmdCA9IDA7XG5cdFx0XG5cdFx0dGhpcy5yZWRyYXdCbG9jayA9IGZhbHNlOyAvL3ByZXZlbnQgcmVkcmF3cyB0byBhbGxvdyBtdWx0aXBsZSBkYXRhIG1hbmlwdWxhdGlvbnMgYmVmb3JlIGNvbnRpbnVpbmdcblx0XHR0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZyA9IGZhbHNlOyAvL3N0b3JlIGxhdGVzdCByZWRyYXcgZnVuY3Rpb24gY2FsbHMgZm9yIHdoZW4gcmVkcmF3IGlzIG5lZWRlZFxuXHRcdHRoaXMucmVkcmF3QmxvY2tSZW5kZXJJblBvc2l0aW9uID0gZmFsc2U7IC8vc3RvcmUgbGF0ZXN0IHJlZHJhdyBmdW5jdGlvbiBjYWxscyBmb3Igd2hlbiByZWRyYXcgaXMgbmVlZGVkXG5cdFx0XG5cdFx0dGhpcy5kYXRhUGlwZWxpbmUgPSBbXTsgLy9ob2xkIGRhdGEgcGlwZWxpbmUgdGFza3Ncblx0XHR0aGlzLmRpc3BsYXlQaXBlbGluZSA9IFtdOyAvL2hvbGQgZGF0YSBkaXNwbGF5IHBpcGVsaW5lIHRhc2tzXG5cdFx0XG5cdFx0dGhpcy5zY3JvbGxiYXJXaWR0aCA9IDA7XG5cdFx0XG5cdFx0dGhpcy5yZW5kZXJlciA9IG51bGw7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8gU2V0dXAgRnVuY3Rpb25zIC8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRjcmVhdGVIb2xkZXJFbGVtZW50ICgpe1xuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XG5cdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci10YWJsZWhvbGRlclwiKTtcblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCAwKTtcblx0XHQvLyBlbC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwicm93Z3JvdXBcIik7XG5cdFx0XG5cdFx0cmV0dXJuIGVsO1xuXHR9XG5cdFxuXHRjcmVhdGVUYWJsZUVsZW1lbnQgKCl7XG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXRhYmxlXCIpO1xuXHRcdGVsLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJyb3dncm91cFwiKTtcblx0XHRcblx0XHRyZXR1cm4gZWw7XG5cdH1cblx0XG5cdGluaXRpYWxpemVQbGFjZWhvbGRlcigpe1xuXHRcdHZhciBwbGFjZWhvbGRlciA9IHRoaXMudGFibGUub3B0aW9ucy5wbGFjZWhvbGRlcjtcblx0XHRcblx0XHRpZih0eXBlb2YgcGxhY2Vob2xkZXIgPT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRwbGFjZWhvbGRlciA9IHBsYWNlaG9sZGVyLmNhbGwodGhpcy50YWJsZSk7XG5cdFx0fVxuXHRcdFxuXHRcdHBsYWNlaG9sZGVyID0gdGhpcy5jaGFpbihcInBsYWNlaG9sZGVyXCIsIFtwbGFjZWhvbGRlcl0sIHBsYWNlaG9sZGVyLCBwbGFjZWhvbGRlcikgfHwgcGxhY2Vob2xkZXI7XG5cdFx0XG5cdFx0Ly9jb25maWd1cmUgcGxhY2Vob2xkZXIgZWxlbWVudFxuXHRcdGlmKHBsYWNlaG9sZGVyKXtcdFxuXHRcdFx0bGV0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcGxhY2Vob2xkZXJcIik7XG5cdFx0XHRcblx0XHRcdGlmKHR5cGVvZiBwbGFjZWhvbGRlciA9PSBcInN0cmluZ1wiKXtcblx0XHRcdFx0bGV0IGNvbnRlbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdFx0Y29udGVudHMuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wbGFjZWhvbGRlci1jb250ZW50c1wiKTtcblx0XHRcdFx0Y29udGVudHMuaW5uZXJIVE1MID0gcGxhY2Vob2xkZXI7XG5cdFx0XHRcdFxuXHRcdFx0XHRlbC5hcHBlbmRDaGlsZChjb250ZW50cyk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnBsYWNlaG9sZGVyQ29udGVudHMgPSBjb250ZW50cztcblx0XHRcdFx0XG5cdFx0XHR9ZWxzZSBpZih0eXBlb2YgSFRNTEVsZW1lbnQgIT09IFwidW5kZWZpbmVkXCIgJiYgcGxhY2Vob2xkZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7XG5cdFx0XHRcdFxuXHRcdFx0XHRlbC5hcHBlbmRDaGlsZChwbGFjZWhvbGRlcik7XG5cdFx0XHRcdHRoaXMucGxhY2Vob2xkZXJDb250ZW50cyA9IHBsYWNlaG9sZGVyO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJJbnZhbGlkIHBsYWNlaG9sZGVyIHByb3ZpZGVkLCBtdXN0IGJlIHN0cmluZyBvciBIVE1MIEVsZW1lbnRcIiwgcGxhY2Vob2xkZXIpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5lbCA9IG51bGw7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMucGxhY2Vob2xkZXIgPSBlbDtcblx0XHR9XG5cdH1cblx0XG5cdC8vcmV0dXJuIGNvbnRhaW5pbmcgZWxlbWVudFxuXHRnZXRFbGVtZW50KCl7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fVxuXHRcblx0Ly9yZXR1cm4gdGFibGUgZWxlbWVudFxuXHRnZXRUYWJsZUVsZW1lbnQoKXtcblx0XHRyZXR1cm4gdGhpcy50YWJsZUVsZW1lbnQ7XG5cdH1cblx0XG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLmluaXRpYWxpemVQbGFjZWhvbGRlcigpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZVJlbmRlcmVyKCk7XG5cdFx0XG5cdFx0Ly9pbml0aWFsaXplIG1hbmFnZXJcblx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy50YWJsZUVsZW1lbnQpO1xuXHRcdFxuXHRcdHRoaXMuZmlyc3RSZW5kZXIgPSB0cnVlO1xuXHRcdFxuXHRcdC8vc2Nyb2xsIGhlYWRlciBhbG9uZyB3aXRoIHRhYmxlIGJvZHlcblx0XHR0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCAoKSA9PiB7XG5cdFx0XHR2YXIgbGVmdCA9IHRoaXMuZWxlbWVudC5zY3JvbGxMZWZ0LFxuXHRcdFx0bGVmdERpciA9IHRoaXMuc2Nyb2xsTGVmdCA+IGxlZnQsXG5cdFx0XHR0b3AgPSB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wLFxuXHRcdFx0dG9wRGlyID0gdGhpcy5zY3JvbGxUb3AgPiB0b3A7XG5cdFx0XHRcblx0XHRcdC8vaGFuZGxlIGhvcml6b250YWwgc2Nyb2xsaW5nXG5cdFx0XHRpZih0aGlzLnNjcm9sbExlZnQgIT0gbGVmdCl7XG5cdFx0XHRcdHRoaXMuc2Nyb2xsTGVmdCA9IGxlZnQ7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmRpc3BhdGNoKFwic2Nyb2xsLWhvcml6b250YWxcIiwgbGVmdCwgbGVmdERpcik7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInNjcm9sbEhvcml6b250YWxcIiwgbGVmdCwgbGVmdERpcik7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLl9wb3NpdGlvblBsYWNlaG9sZGVyKCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vaGFuZGxlIHZlcnRpY2FsIHNjcm9sbGluZ1xuXHRcdFx0aWYodGhpcy5zY3JvbGxUb3AgIT0gdG9wKXtcblx0XHRcdFx0dGhpcy5zY3JvbGxUb3AgPSB0b3A7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnJlbmRlcmVyLnNjcm9sbFJvd3ModG9wLCB0b3BEaXIpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5kaXNwYXRjaChcInNjcm9sbC12ZXJ0aWNhbFwiLCB0b3AsIHRvcERpcik7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInNjcm9sbFZlcnRpY2FsXCIsIHRvcCwgdG9wRGlyKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vIFJvdyBNYW5pcHVsYXRpb24gLy8vLy8vLy8vLy8vLy8vLy8vXG5cdGZpbmRSb3coc3ViamVjdCl7XG5cdFx0aWYodHlwZW9mIHN1YmplY3QgPT0gXCJvYmplY3RcIil7XG5cdFx0XHRpZihzdWJqZWN0IGluc3RhbmNlb2YgUm93KXtcblx0XHRcdFx0Ly9zdWJqZWN0IGlzIHJvdyBlbGVtZW50XG5cdFx0XHRcdHJldHVybiBzdWJqZWN0O1xuXHRcdFx0fWVsc2UgaWYoc3ViamVjdCBpbnN0YW5jZW9mIFJvd0NvbXBvbmVudCl7XG5cdFx0XHRcdC8vc3ViamVjdCBpcyBwdWJsaWMgcm93IGNvbXBvbmVudFxuXHRcdFx0XHRyZXR1cm4gc3ViamVjdC5fZ2V0U2VsZigpIHx8IGZhbHNlO1xuXHRcdFx0fWVsc2UgaWYodHlwZW9mIEhUTUxFbGVtZW50ICE9PSBcInVuZGVmaW5lZFwiICYmIHN1YmplY3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7XG5cdFx0XHRcdC8vc3ViamVjdCBpcyBhIEhUTUwgZWxlbWVudCBvZiB0aGUgcm93XG5cdFx0XHRcdGxldCBtYXRjaCA9IHRoaXMucm93cy5maW5kKChyb3cpID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gcm93LmdldEVsZW1lbnQoKSA9PT0gc3ViamVjdDtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gbWF0Y2ggfHwgZmFsc2U7XG5cdFx0XHR9ZWxzZSBpZihzdWJqZWN0ID09PSBudWxsKXtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1lbHNlIGlmKHR5cGVvZiBzdWJqZWN0ID09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1lbHNlIHtcblx0XHRcdC8vc3ViamVjdCBzaG91bGQgYmUgdHJlYXRlZCBhcyB0aGUgaW5kZXggb2YgdGhlIHJvd1xuXHRcdFx0bGV0IG1hdGNoID0gdGhpcy5yb3dzLmZpbmQoKHJvdykgPT4ge1xuXHRcdFx0XHRyZXR1cm4gcm93LmRhdGFbdGhpcy50YWJsZS5vcHRpb25zLmluZGV4XSA9PSBzdWJqZWN0O1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHJldHVybiBtYXRjaCB8fCBmYWxzZTtcblx0XHR9XG5cdFx0XG5cdFx0Ly9jYXRjaCBhbGwgZm9yIGFueSBvdGhlciB0eXBlIG9mIGlucHV0XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cdFxuXHRnZXRSb3dGcm9tRGF0YU9iamVjdChkYXRhKXtcblx0XHR2YXIgbWF0Y2ggPSB0aGlzLnJvd3MuZmluZCgocm93KSA9PiB7XG5cdFx0XHRyZXR1cm4gcm93LmRhdGEgPT09IGRhdGE7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIG1hdGNoIHx8IGZhbHNlO1xuXHR9XG5cdFxuXHRnZXRSb3dGcm9tUG9zaXRpb24ocG9zaXRpb24pe1xuXHRcdHJldHVybiB0aGlzLmdldERpc3BsYXlSb3dzKCkuZmluZCgocm93KSA9PiB7XG5cdFx0XHRyZXR1cm4gcm93LnR5cGUgPT09IFwicm93XCIgJiYgcm93LmdldFBvc2l0aW9uKCkgPT09IHBvc2l0aW9uICYmIHJvdy5pc0Rpc3BsYXllZCgpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRzY3JvbGxUb1Jvdyhyb3csIHBvc2l0aW9uLCBpZlZpc2libGUpe1xuXHRcdHJldHVybiB0aGlzLnJlbmRlcmVyLnNjcm9sbFRvUm93UG9zaXRpb24ocm93LCBwb3NpdGlvbiwgaWZWaXNpYmxlKTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vIERhdGEgSGFuZGxpbmcgLy8vLy8vLy8vLy8vLy8vLy8vXG5cdHNldERhdGEoZGF0YSwgcmVuZGVySW5Qb3NpdGlvbiwgY29sdW1uc0NoYW5nZWQpe1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xuXHRcdFx0aWYocmVuZGVySW5Qb3NpdGlvbiAmJiB0aGlzLmdldERpc3BsYXlSb3dzKCkubGVuZ3RoKXtcblx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb24pe1xuXHRcdFx0XHRcdHRoaXMuX3NldERhdGFBY3R1YWwoZGF0YSwgdHJ1ZSk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigoKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLl9zZXREYXRhQWN0dWFsKGRhdGEpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5hdXRvQ29sdW1ucyAmJiBjb2x1bW5zQ2hhbmdlZCAmJiB0aGlzLnRhYmxlLmluaXRpYWxpemVkKXtcblx0XHRcdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2VuZXJhdGVDb2x1bW5zRnJvbVJvd0RhdGEoZGF0YSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5yZXNldFNjcm9sbCgpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5fc2V0RGF0YUFjdHVhbChkYXRhKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cmVzb2x2ZSgpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRfc2V0RGF0YUFjdHVhbChkYXRhLCByZW5kZXJJblBvc2l0aW9uKXtcblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhUHJvY2Vzc2luZ1wiLCBkYXRhKTtcblx0XHRcblx0XHR0aGlzLl93aXBlRWxlbWVudHMoKTtcblx0XHRcblx0XHRpZihBcnJheS5pc0FycmF5KGRhdGEpKXtcblx0XHRcdHRoaXMuZGlzcGF0Y2goXCJkYXRhLXByb2Nlc3NpbmdcIiwgZGF0YSk7XG5cdFx0XHRcblx0XHRcdGRhdGEuZm9yRWFjaCgoZGVmLCBpKSA9PiB7XG5cdFx0XHRcdGlmKGRlZiAmJiB0eXBlb2YgZGVmID09PSBcIm9iamVjdFwiKXtcblx0XHRcdFx0XHR2YXIgcm93ID0gbmV3IFJvdyhkZWYsIHRoaXMpO1xuXHRcdFx0XHRcdHRoaXMucm93cy5wdXNoKHJvdyk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJEYXRhIExvYWRpbmcgV2FybmluZyAtIEludmFsaWQgcm93IGRhdGEgZGV0ZWN0ZWQgYW5kIGlnbm9yZWQsIGV4cGVjdGluZyBvYmplY3QgYnV0IHJlY2VpdmVkOlwiLCBkZWYpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5yZWZyZXNoQWN0aXZlRGF0YShmYWxzZSwgZmFsc2UsIHJlbmRlckluUG9zaXRpb24pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwiZGF0YS1wcm9jZXNzZWRcIiwgZGF0YSk7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhUHJvY2Vzc2VkXCIsIGRhdGEpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJEYXRhIExvYWRpbmcgRXJyb3IgLSBVbmFibGUgdG8gcHJvY2VzcyBkYXRhIGR1ZSB0byBpbnZhbGlkIGRhdGEgdHlwZSBcXG5FeHBlY3Rpbmc6IGFycmF5IFxcblJlY2VpdmVkOiBcIiwgdHlwZW9mIGRhdGEsIFwiXFxuRGF0YTogICAgIFwiLCBkYXRhKTtcblx0XHR9XG5cdH1cblx0XG5cdF93aXBlRWxlbWVudHMoKXtcblx0XHR0aGlzLmRpc3BhdGNoKFwicm93cy13aXBlXCIpO1xuXHRcdFxuXHRcdHRoaXMuZGVzdHJveSgpO1xuXHRcdFxuXHRcdHRoaXMuYWRqdXN0VGFibGVTaXplKCk7XG5cdFx0XG5cdFx0dGhpcy5kaXNwYXRjaChcInJvd3Mtd2lwZWRcIik7XG5cdH1cblx0XG5cdGRlc3Ryb3koKXtcblx0XHR0aGlzLnJvd3MuZm9yRWFjaCgocm93KSA9PiB7XG5cdFx0XHRyb3cud2lwZSgpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMucm93cyA9IFtdO1xuXHRcdHRoaXMuYWN0aXZlUm93cyA9IFtdO1xuXHRcdHRoaXMuYWN0aXZlUm93c1BpcGVsaW5lID0gW107XG5cdFx0dGhpcy5hY3RpdmVSb3dzQ291bnQgPSAwO1xuXHRcdHRoaXMuZGlzcGxheVJvd3MgPSBbXTtcblx0XHR0aGlzLmRpc3BsYXlSb3dzQ291bnQgPSAwO1xuXHR9XG5cdFxuXHRkZWxldGVSb3cocm93LCBibG9ja1JlZHJhdyl7XG5cdFx0dmFyIGFsbEluZGV4ID0gdGhpcy5yb3dzLmluZGV4T2Yocm93KSxcblx0XHRhY3RpdmVJbmRleCA9IHRoaXMuYWN0aXZlUm93cy5pbmRleE9mKHJvdyk7XG5cdFx0XG5cdFx0aWYoYWN0aXZlSW5kZXggPiAtMSl7XG5cdFx0XHR0aGlzLmFjdGl2ZVJvd3Muc3BsaWNlKGFjdGl2ZUluZGV4LCAxKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYoYWxsSW5kZXggPiAtMSl7XG5cdFx0XHR0aGlzLnJvd3Muc3BsaWNlKGFsbEluZGV4LCAxKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5zZXRBY3RpdmVSb3dzKHRoaXMuYWN0aXZlUm93cyk7XG5cdFx0XG5cdFx0dGhpcy5kaXNwbGF5Um93SXRlcmF0b3IoKHJvd3MpID0+IHtcblx0XHRcdHZhciBkaXNwbGF5SW5kZXggPSByb3dzLmluZGV4T2Yocm93KTtcblx0XHRcdFxuXHRcdFx0aWYoZGlzcGxheUluZGV4ID4gLTEpe1xuXHRcdFx0XHRyb3dzLnNwbGljZShkaXNwbGF5SW5kZXgsIDEpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdGlmKCFibG9ja1JlZHJhdyl7XG5cdFx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnJlZ2VuZXJhdGVSb3dQb3NpdGlvbnMoKTtcblx0XHRcblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJyb3dEZWxldGVkXCIsIHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdFx0XG5cdFx0aWYoIXRoaXMuZGlzcGxheVJvd3NDb3VudCl7XG5cdFx0XHR0aGlzLnRhYmxlRW1wdHkoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYodGhpcy5zdWJzY3JpYmVkRXh0ZXJuYWwoXCJkYXRhQ2hhbmdlZFwiKSl7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhQ2hhbmdlZFwiLCB0aGlzLmdldERhdGEoKSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRhZGRSb3coZGF0YSwgcG9zLCBpbmRleCwgYmxvY2tSZWRyYXcpe1xuXHRcdHZhciByb3cgPSB0aGlzLmFkZFJvd0FjdHVhbChkYXRhLCBwb3MsIGluZGV4LCBibG9ja1JlZHJhdyk7XG5cdFx0cmV0dXJuIHJvdztcblx0fVxuXHRcblx0Ly9hZGQgbXVsdGlwbGUgcm93c1xuXHRhZGRSb3dzKGRhdGEsIHBvcywgaW5kZXgsIHJlZnJlc2hEaXNwbGF5T25seSl7XG5cdFx0dmFyIHJvd3MgPSBbXTtcblx0XHRcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0cG9zID0gdGhpcy5maW5kQWRkUm93UG9zKHBvcyk7XG5cdFx0XHRcblx0XHRcdGlmKCFBcnJheS5pc0FycmF5KGRhdGEpKXtcblx0XHRcdFx0ZGF0YSA9IFtkYXRhXTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoKHR5cGVvZiBpbmRleCA9PSBcInVuZGVmaW5lZFwiICYmIHBvcykgfHwgKHR5cGVvZiBpbmRleCAhPT0gXCJ1bmRlZmluZWRcIiAmJiAhcG9zKSl7XG5cdFx0XHRcdGRhdGEucmV2ZXJzZSgpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRkYXRhLmZvckVhY2goKGl0ZW0sIGkpID0+IHtcblx0XHRcdFx0dmFyIHJvdyA9IHRoaXMuYWRkUm93KGl0ZW0sIHBvcywgaW5kZXgsIHRydWUpO1xuXHRcdFx0XHRyb3dzLnB1c2gocm93KTtcblx0XHRcdFx0dGhpcy5kaXNwYXRjaChcInJvdy1hZGRlZFwiLCByb3csIGl0ZW0sIHBvcywgaW5kZXgpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMucmVmcmVzaEFjdGl2ZURhdGEocmVmcmVzaERpc3BsYXlPbmx5ID8gXCJkaXNwbGF5UGlwZWxpbmVcIiA6IGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XG5cdFx0XHRcblx0XHRcdHRoaXMucmVnZW5lcmF0ZVJvd1Bvc2l0aW9ucygpO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLmRpc3BsYXlSb3dzQ291bnQpe1xuXHRcdFx0XHR0aGlzLl9jbGVhclBsYWNlaG9sZGVyKCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJlc29sdmUocm93cyk7XG5cdFx0fSk7XG5cdH1cblx0XG5cdGZpbmRBZGRSb3dQb3MocG9zKXtcblx0XHRpZih0eXBlb2YgcG9zID09PSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdHBvcyA9IHRoaXMudGFibGUub3B0aW9ucy5hZGRSb3dQb3M7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHBvcyA9PT0gXCJwb3NcIil7XG5cdFx0XHRwb3MgPSB0cnVlO1xuXHRcdH1cblx0XHRcblx0XHRpZihwb3MgPT09IFwiYm90dG9tXCIpe1xuXHRcdFx0cG9zID0gZmFsc2U7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBwb3M7XG5cdH1cblx0XG5cdGFkZFJvd0FjdHVhbChkYXRhLCBwb3MsIGluZGV4LCBibG9ja1JlZHJhdyl7XG5cdFx0dmFyIHJvdyA9IGRhdGEgaW5zdGFuY2VvZiBSb3cgPyBkYXRhIDogbmV3IFJvdyhkYXRhIHx8IHt9LCB0aGlzKSxcblx0XHR0b3AgPSB0aGlzLmZpbmRBZGRSb3dQb3MocG9zKSxcblx0XHRhbGxJbmRleCA9IC0xLFxuXHRcdGFjdGl2ZUluZGV4LCBjaGFpblJlc3VsdDtcblx0XHRcblx0XHRpZighaW5kZXgpe1xuXHRcdFx0Y2hhaW5SZXN1bHQgPSB0aGlzLmNoYWluKFwicm93LWFkZGluZy1wb3NpdGlvblwiLCBbcm93LCB0b3BdLCBudWxsLCB7aW5kZXgsIHRvcH0pO1xuXHRcdFx0XG5cdFx0XHRpbmRleCA9IGNoYWluUmVzdWx0LmluZGV4O1xuXHRcdFx0dG9wID0gY2hhaW5SZXN1bHQudG9wO1xuXHRcdH1cblx0XHRcblx0XHRpZih0eXBlb2YgaW5kZXggIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0aW5kZXggPSB0aGlzLmZpbmRSb3coaW5kZXgpO1xuXHRcdH1cblx0XHRcblx0XHRpbmRleCA9IHRoaXMuY2hhaW4oXCJyb3ctYWRkaW5nLWluZGV4XCIsIFtyb3csIGluZGV4LCB0b3BdLCBudWxsLCBpbmRleCk7XG5cdFx0XG5cdFx0aWYoaW5kZXgpe1xuXHRcdFx0YWxsSW5kZXggPSB0aGlzLnJvd3MuaW5kZXhPZihpbmRleCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGluZGV4ICYmIGFsbEluZGV4ID4gLTEpe1xuXHRcdFx0YWN0aXZlSW5kZXggPSB0aGlzLmFjdGl2ZVJvd3MuaW5kZXhPZihpbmRleCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGlzcGxheVJvd0l0ZXJhdG9yKGZ1bmN0aW9uKHJvd3Mpe1xuXHRcdFx0XHR2YXIgZGlzcGxheUluZGV4ID0gcm93cy5pbmRleE9mKGluZGV4KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGRpc3BsYXlJbmRleCA+IC0xKXtcblx0XHRcdFx0XHRyb3dzLnNwbGljZSgodG9wID8gZGlzcGxheUluZGV4IDogZGlzcGxheUluZGV4ICsgMSksIDAsIHJvdyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRpZihhY3RpdmVJbmRleCA+IC0xKXtcblx0XHRcdFx0dGhpcy5hY3RpdmVSb3dzLnNwbGljZSgodG9wID8gYWN0aXZlSW5kZXggOiBhY3RpdmVJbmRleCArIDEpLCAwLCByb3cpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnJvd3Muc3BsaWNlKCh0b3AgPyBhbGxJbmRleCA6IGFsbEluZGV4ICsgMSksIDAsIHJvdyk7XG5cdFx0XHRcblx0XHR9ZWxzZSB7XG5cdFx0XHRcblx0XHRcdGlmKHRvcCl7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmRpc3BsYXlSb3dJdGVyYXRvcihmdW5jdGlvbihyb3dzKXtcblx0XHRcdFx0XHRyb3dzLnVuc2hpZnQocm93KTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmFjdGl2ZVJvd3MudW5zaGlmdChyb3cpO1xuXHRcdFx0XHR0aGlzLnJvd3MudW5zaGlmdChyb3cpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmRpc3BsYXlSb3dJdGVyYXRvcihmdW5jdGlvbihyb3dzKXtcblx0XHRcdFx0XHRyb3dzLnB1c2gocm93KTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmFjdGl2ZVJvd3MucHVzaChyb3cpO1xuXHRcdFx0XHR0aGlzLnJvd3MucHVzaChyb3cpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0aGlzLnNldEFjdGl2ZVJvd3ModGhpcy5hY3RpdmVSb3dzKTtcblx0XHRcblx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJyb3dBZGRlZFwiLCByb3cuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFxuXHRcdGlmKHRoaXMuc3Vic2NyaWJlZEV4dGVybmFsKFwiZGF0YUNoYW5nZWRcIikpe1xuXHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiZGF0YUNoYW5nZWRcIiwgdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERhdGEoKSk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKCFibG9ja1JlZHJhdyl7XG5cdFx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gcm93O1xuXHR9XG5cdFxuXHRtb3ZlUm93KGZyb20sIHRvLCBhZnRlcil7XG5cdFx0dGhpcy5kaXNwYXRjaChcInJvdy1tb3ZlXCIsIGZyb20sIHRvLCBhZnRlcik7XG5cdFx0XG5cdFx0dGhpcy5tb3ZlUm93QWN0dWFsKGZyb20sIHRvLCBhZnRlcik7XG5cdFx0XG5cdFx0dGhpcy5yZWdlbmVyYXRlUm93UG9zaXRpb25zKCk7XG5cdFx0XG5cdFx0dGhpcy5kaXNwYXRjaChcInJvdy1tb3ZlZFwiLCBmcm9tLCB0bywgYWZ0ZXIpO1xuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInJvd01vdmVkXCIsIGZyb20uZ2V0Q29tcG9uZW50KCkpO1xuXHR9XG5cdFxuXHRtb3ZlUm93QWN0dWFsKGZyb20sIHRvLCBhZnRlcil7XG5cdFx0dGhpcy5tb3ZlUm93SW5BcnJheSh0aGlzLnJvd3MsIGZyb20sIHRvLCBhZnRlcik7XG5cdFx0dGhpcy5tb3ZlUm93SW5BcnJheSh0aGlzLmFjdGl2ZVJvd3MsIGZyb20sIHRvLCBhZnRlcik7XG5cdFx0XG5cdFx0dGhpcy5kaXNwbGF5Um93SXRlcmF0b3IoKHJvd3MpID0+IHtcblx0XHRcdHRoaXMubW92ZVJvd0luQXJyYXkocm93cywgZnJvbSwgdG8sIGFmdGVyKTtcblx0XHR9KTtcblx0XHRcblx0XHR0aGlzLmRpc3BhdGNoKFwicm93LW1vdmluZ1wiLCBmcm9tLCB0bywgYWZ0ZXIpO1xuXHR9XG5cdFxuXHRtb3ZlUm93SW5BcnJheShyb3dzLCBmcm9tLCB0bywgYWZ0ZXIpe1xuXHRcdHZhclx0ZnJvbUluZGV4LCB0b0luZGV4LCBzdGFydCwgZW5kO1xuXHRcdFxuXHRcdGlmKGZyb20gIT09IHRvKXtcblx0XHRcdFxuXHRcdFx0ZnJvbUluZGV4ID0gcm93cy5pbmRleE9mKGZyb20pO1xuXHRcdFx0XG5cdFx0XHRpZiAoZnJvbUluZGV4ID4gLTEpIHtcblx0XHRcdFx0XG5cdFx0XHRcdHJvd3Muc3BsaWNlKGZyb21JbmRleCwgMSk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0b0luZGV4ID0gcm93cy5pbmRleE9mKHRvKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmICh0b0luZGV4ID4gLTEpIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihhZnRlcil7XG5cdFx0XHRcdFx0XHRyb3dzLnNwbGljZSh0b0luZGV4KzEsIDAsIGZyb20pO1xuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdHJvd3Muc3BsaWNlKHRvSW5kZXgsIDAsIGZyb20pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHJvd3Muc3BsaWNlKGZyb21JbmRleCwgMCwgZnJvbSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly9yZXN0eWxlIHJvd3Ncblx0XHRcdGlmKHJvd3MgPT09IHRoaXMuZ2V0RGlzcGxheVJvd3MoKSl7XG5cdFx0XHRcdFxuXHRcdFx0XHRzdGFydCA9IGZyb21JbmRleCA8IHRvSW5kZXggPyBmcm9tSW5kZXggOiB0b0luZGV4O1xuXHRcdFx0XHRlbmQgPSB0b0luZGV4ID4gZnJvbUluZGV4ID8gdG9JbmRleCA6IGZyb21JbmRleCArMTtcblx0XHRcdFx0XG5cdFx0XHRcdGZvcihsZXQgaSA9IHN0YXJ0OyBpIDw9IGVuZDsgaSsrKXtcblx0XHRcdFx0XHRpZihyb3dzW2ldKXtcblx0XHRcdFx0XHRcdHRoaXMuc3R5bGVSb3cocm93c1tpXSwgaSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRjbGVhckRhdGEoKXtcblx0XHR0aGlzLnNldERhdGEoW10pO1xuXHR9XG5cdFxuXHRnZXRSb3dJbmRleChyb3cpe1xuXHRcdHJldHVybiB0aGlzLmZpbmRSb3dJbmRleChyb3csIHRoaXMucm93cyk7XG5cdH1cblx0XG5cdGdldERpc3BsYXlSb3dJbmRleChyb3cpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMuZ2V0RGlzcGxheVJvd3MoKS5pbmRleE9mKHJvdyk7XG5cdFx0cmV0dXJuIGluZGV4ID4gLTEgPyBpbmRleCA6IGZhbHNlO1xuXHR9XG5cdFxuXHRuZXh0RGlzcGxheVJvdyhyb3csIHJvd09ubHkpe1xuXHRcdHZhciBpbmRleCA9IHRoaXMuZ2V0RGlzcGxheVJvd0luZGV4KHJvdyksXG5cdFx0bmV4dFJvdyA9IGZhbHNlO1xuXHRcdFxuXHRcdFxuXHRcdGlmKGluZGV4ICE9PSBmYWxzZSAmJiBpbmRleCA8IHRoaXMuZGlzcGxheVJvd3NDb3VudCAtMSl7XG5cdFx0XHRuZXh0Um93ID0gdGhpcy5nZXREaXNwbGF5Um93cygpW2luZGV4KzFdO1xuXHRcdH1cblx0XHRcblx0XHRpZihuZXh0Um93ICYmICghKG5leHRSb3cgaW5zdGFuY2VvZiBSb3cpIHx8IG5leHRSb3cudHlwZSAhPSBcInJvd1wiKSl7XG5cdFx0XHRyZXR1cm4gdGhpcy5uZXh0RGlzcGxheVJvdyhuZXh0Um93LCByb3dPbmx5KTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG5leHRSb3c7XG5cdH1cblx0XG5cdHByZXZEaXNwbGF5Um93KHJvdywgcm93T25seSl7XG5cdFx0dmFyIGluZGV4ID0gdGhpcy5nZXREaXNwbGF5Um93SW5kZXgocm93KSxcblx0XHRwcmV2Um93ID0gZmFsc2U7XG5cdFx0XG5cdFx0aWYoaW5kZXgpe1xuXHRcdFx0cHJldlJvdyA9IHRoaXMuZ2V0RGlzcGxheVJvd3MoKVtpbmRleC0xXTtcblx0XHR9XG5cdFx0XG5cdFx0aWYocm93T25seSAmJiBwcmV2Um93ICYmICghKHByZXZSb3cgaW5zdGFuY2VvZiBSb3cpIHx8IHByZXZSb3cudHlwZSAhPSBcInJvd1wiKSl7XG5cdFx0XHRyZXR1cm4gdGhpcy5wcmV2RGlzcGxheVJvdyhwcmV2Um93LCByb3dPbmx5KTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHByZXZSb3c7XG5cdH1cblx0XG5cdGZpbmRSb3dJbmRleChyb3csIGxpc3Qpe1xuXHRcdHZhciByb3dJbmRleDtcblx0XHRcblx0XHRyb3cgPSB0aGlzLmZpbmRSb3cocm93KTtcblx0XHRcblx0XHRpZihyb3cpe1xuXHRcdFx0cm93SW5kZXggPSBsaXN0LmluZGV4T2Yocm93KTtcblx0XHRcdFxuXHRcdFx0aWYocm93SW5kZXggPiAtMSl7XG5cdFx0XHRcdHJldHVybiByb3dJbmRleDtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cdFxuXHRnZXREYXRhKGFjdGl2ZSwgdHJhbnNmb3JtKXtcblx0XHR2YXIgb3V0cHV0ID0gW10sXG5cdFx0cm93cyA9IHRoaXMuZ2V0Um93cyhhY3RpdmUpO1xuXHRcdFxuXHRcdHJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdFx0aWYocm93LnR5cGUgPT0gXCJyb3dcIil7XG5cdFx0XHRcdG91dHB1dC5wdXNoKHJvdy5nZXREYXRhKHRyYW5zZm9ybSB8fCBcImRhdGFcIikpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblx0XG5cdGdldENvbXBvbmVudHMoYWN0aXZlKXtcblx0XHR2YXJcdG91dHB1dCA9IFtdLFxuXHRcdHJvd3MgPSB0aGlzLmdldFJvd3MoYWN0aXZlKTtcblx0XHRcblx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24ocm93KXtcblx0XHRcdG91dHB1dC5wdXNoKHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0Z2V0RGF0YUNvdW50KGFjdGl2ZSl7XG5cdFx0dmFyIHJvd3MgPSB0aGlzLmdldFJvd3MoYWN0aXZlKTtcblx0XHRcblx0XHRyZXR1cm4gcm93cy5sZW5ndGg7XG5cdH1cblx0XG5cdHNjcm9sbEhvcml6b250YWwobGVmdCl7XG5cdFx0dGhpcy5zY3JvbGxMZWZ0ID0gbGVmdDtcblx0XHR0aGlzLmVsZW1lbnQuc2Nyb2xsTGVmdCA9IGxlZnQ7XG5cdFx0XG5cdFx0dGhpcy5kaXNwYXRjaChcInNjcm9sbC1ob3Jpem9udGFsXCIsIGxlZnQpO1xuXHR9XG5cdFxuXHRyZWdpc3RlckRhdGFQaXBlbGluZUhhbmRsZXIoaGFuZGxlciwgcHJpb3JpdHkpe1xuXHRcdGlmKHR5cGVvZiBwcmlvcml0eSAhPT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHR0aGlzLmRhdGFQaXBlbGluZS5wdXNoKHtoYW5kbGVyLCBwcmlvcml0eX0pO1xuXHRcdFx0dGhpcy5kYXRhUGlwZWxpbmUuc29ydCgoYSwgYikgPT4ge1xuXHRcdFx0XHRyZXR1cm4gYS5wcmlvcml0eSAtIGIucHJpb3JpdHk7XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiRGF0YSBwaXBlbGluZSBoYW5kbGVycyBtdXN0IGhhdmUgYSBwcmlvcml0eSBpbiBvcmRlciB0byBiZSByZWdpc3RlcmVkXCIpO1xuXHRcdH1cblx0fVxuXHRcblx0cmVnaXN0ZXJEaXNwbGF5UGlwZWxpbmVIYW5kbGVyKGhhbmRsZXIsIHByaW9yaXR5KXtcblx0XHRpZih0eXBlb2YgcHJpb3JpdHkgIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0dGhpcy5kaXNwbGF5UGlwZWxpbmUucHVzaCh7aGFuZGxlciwgcHJpb3JpdHl9KTtcblx0XHRcdHRoaXMuZGlzcGxheVBpcGVsaW5lLnNvcnQoKGEsIGIpID0+IHtcblx0XHRcdFx0cmV0dXJuIGEucHJpb3JpdHkgLSBiLnByaW9yaXR5O1xuXHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS5lcnJvcihcIkRpc3BsYXkgcGlwZWxpbmUgaGFuZGxlcnMgbXVzdCBoYXZlIGEgcHJpb3JpdHkgaW4gb3JkZXIgdG8gYmUgcmVnaXN0ZXJlZFwiKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vc2V0IGFjdGl2ZSBkYXRhIHNldFxuXHRyZWZyZXNoQWN0aXZlRGF0YShoYW5kbGVyLCBza2lwU3RhZ2UsIHJlbmRlckluUG9zaXRpb24pe1xuXHRcdHZhciB0YWJsZSA9IHRoaXMudGFibGUsXG5cdFx0c3RhZ2UgPSBcIlwiLFxuXHRcdGluZGV4ID0gMCxcblx0XHRjYXNjYWRlT3JkZXIgPSBbXCJhbGxcIiwgXCJkYXRhUGlwZWxpbmVcIiwgXCJkaXNwbGF5XCIsIFwiZGlzcGxheVBpcGVsaW5lXCIsIFwiZW5kXCJdO1xuXHRcdFxuXHRcdGlmKCF0aGlzLnRhYmxlLmRlc3Ryb3llZCl7XG5cdFx0XHRpZih0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKXtcblx0XHRcdFx0aW5kZXggPSB0aGlzLmRhdGFQaXBlbGluZS5maW5kSW5kZXgoKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gaXRlbS5oYW5kbGVyID09PSBoYW5kbGVyO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0XHRcdHN0YWdlID0gXCJkYXRhUGlwZWxpbmVcIjtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihza2lwU3RhZ2Upe1xuXHRcdFx0XHRcdFx0aWYoaW5kZXggPT0gdGhpcy5kYXRhUGlwZWxpbmUubGVuZ3RoIC0gMSl7XG5cdFx0XHRcdFx0XHRcdHN0YWdlID0gXCJkaXNwbGF5XCI7XG5cdFx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGluZGV4Kys7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0aW5kZXggPSB0aGlzLmRpc3BsYXlQaXBlbGluZS5maW5kSW5kZXgoKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRcdHJldHVybiBpdGVtLmhhbmRsZXIgPT09IGhhbmRsZXI7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoaW5kZXggPiAtMSl7XG5cdFx0XHRcdFx0XHRzdGFnZSA9IFwiZGlzcGxheVBpcGVsaW5lXCI7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmKHNraXBTdGFnZSl7XG5cdFx0XHRcdFx0XHRcdGlmKGluZGV4ID09IHRoaXMuZGlzcGxheVBpcGVsaW5lLmxlbmd0aCAtIDEpe1xuXHRcdFx0XHRcdFx0XHRcdHN0YWdlID0gXCJlbmRcIjtcblx0XHRcdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGluZGV4Kys7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHJlZnJlc2ggZGF0YSwgaW52YWxpZCBoYW5kbGVyIHByb3ZpZGVkXCIsIGhhbmRsZXIpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRzdGFnZSA9IGhhbmRsZXIgfHwgXCJhbGxcIjtcblx0XHRcdFx0aW5kZXggPSAwO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnJlZHJhd0Jsb2NrKXtcblx0XHRcdFx0aWYoIXRoaXMucmVkcmF3QmxvY2tSZXN0b3JlQ29uZmlnIHx8ICh0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZyAmJiAoKHRoaXMucmVkcmF3QmxvY2tSZXN0b3JlQ29uZmlnLnN0YWdlID09PSBzdGFnZSAmJiBpbmRleCA8IHRoaXMucmVkcmF3QmxvY2tSZXN0b3JlQ29uZmlnLmluZGV4KSB8fCAoY2FzY2FkZU9yZGVyLmluZGV4T2Yoc3RhZ2UpIDwgY2FzY2FkZU9yZGVyLmluZGV4T2YodGhpcy5yZWRyYXdCbG9ja1Jlc3RvcmVDb25maWcuc3RhZ2UpKSkpKXtcblx0XHRcdFx0XHR0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZyA9IHtcblx0XHRcdFx0XHRcdGhhbmRsZXI6IGhhbmRsZXIsXG5cdFx0XHRcdFx0XHRza2lwU3RhZ2U6IHNraXBTdGFnZSxcblx0XHRcdFx0XHRcdHJlbmRlckluUG9zaXRpb246IHJlbmRlckluUG9zaXRpb24sXG5cdFx0XHRcdFx0XHRzdGFnZTpzdGFnZSxcblx0XHRcdFx0XHRcdGluZGV4OmluZGV4LFxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYoSGVscGVycy5lbFZpc2libGUodGhpcy5lbGVtZW50KSl7XG5cdFx0XHRcdFx0aWYocmVuZGVySW5Qb3NpdGlvbil7XG5cdFx0XHRcdFx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbih0aGlzLnJlZnJlc2hQaXBlbGluZXMuYmluZCh0aGlzLCBoYW5kbGVyLCBzdGFnZSwgaW5kZXgsIHJlbmRlckluUG9zaXRpb24pKTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlZnJlc2hQaXBlbGluZXMoaGFuZGxlciwgc3RhZ2UsIGluZGV4LCByZW5kZXJJblBvc2l0aW9uKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYoIWhhbmRsZXIpe1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIucmVuZGVyZXIucmVuZGVyQ29sdW1ucygpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHR0aGlzLnJlbmRlclRhYmxlKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmKHRhYmxlLm9wdGlvbnMubGF5b3V0Q29sdW1uc09uTmV3RGF0YSl7XG5cdFx0XHRcdFx0XHRcdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5yZWRyYXcodHJ1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5yZWZyZXNoUGlwZWxpbmVzKGhhbmRsZXIsIHN0YWdlLCBpbmRleCwgcmVuZGVySW5Qb3NpdGlvbik7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2goXCJkYXRhLXJlZnJlc2hlZFwiKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdHJlZnJlc2hQaXBlbGluZXMoaGFuZGxlciwgc3RhZ2UsIGluZGV4LCByZW5kZXJJblBvc2l0aW9uKXtcblx0XHR0aGlzLmRpc3BhdGNoKFwiZGF0YS1yZWZyZXNoaW5nXCIpO1xuXHRcdFxuXHRcdGlmKCFoYW5kbGVyIHx8ICF0aGlzLmFjdGl2ZVJvd3NQaXBlbGluZVswXSl7XG5cdFx0XHR0aGlzLmFjdGl2ZVJvd3NQaXBlbGluZVswXSA9IHRoaXMucm93cy5zbGljZSgwKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly9jYXNjYWRlIHRocm91Z2ggZGF0YSByZWZyZXNoIHN0YWdlc1xuXHRcdHN3aXRjaChzdGFnZSl7XG5cdFx0XHRjYXNlIFwiYWxsXCI6XG5cdFx0XHQvL2hhbmRsZSBjYXNlIHdoZXJlIGFsbCBkYXRhIG5lZWRzIHJlZnJlc2hpbmdcblx0XHRcdFxuXHRcdFx0Y2FzZSBcImRhdGFQaXBlbGluZVwiOlxuXHRcdFx0XHRmb3IobGV0IGkgPSBpbmRleDsgaSA8IHRoaXMuZGF0YVBpcGVsaW5lLmxlbmd0aDsgaSsrKXtcblx0XHRcdFx0XHRsZXQgcmVzdWx0ID0gdGhpcy5kYXRhUGlwZWxpbmVbaV0uaGFuZGxlcih0aGlzLmFjdGl2ZVJvd3NQaXBlbGluZVtpXS5zbGljZSgwKSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMuYWN0aXZlUm93c1BpcGVsaW5lW2kgKyAxXSA9IHJlc3VsdCB8fCB0aGlzLmFjdGl2ZVJvd3NQaXBlbGluZVtpXS5zbGljZSgwKTtcblx0XHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRcdHRoaXMuc2V0QWN0aXZlUm93cyh0aGlzLmFjdGl2ZVJvd3NQaXBlbGluZVt0aGlzLmRhdGFQaXBlbGluZS5sZW5ndGhdKTtcblx0XHRcdFxuXHRcdFx0Y2FzZSBcImRpc3BsYXlcIjpcblx0XHRcdFx0aW5kZXggPSAwO1xuXHRcdFx0XHR0aGlzLnJlc2V0RGlzcGxheVJvd3MoKTtcblx0XHRcdFxuXHRcdFx0Y2FzZSBcImRpc3BsYXlQaXBlbGluZVwiOlxuXHRcdFx0XHRmb3IobGV0IGkgPSBpbmRleDsgaSA8IHRoaXMuZGlzcGxheVBpcGVsaW5lLmxlbmd0aDsgaSsrKXtcblx0XHRcdFx0XHRsZXQgcmVzdWx0ID0gdGhpcy5kaXNwbGF5UGlwZWxpbmVbaV0uaGFuZGxlcigoaSA/IHRoaXMuZ2V0RGlzcGxheVJvd3MoaSAtIDEpIDogdGhpcy5hY3RpdmVSb3dzKS5zbGljZSgwKSwgcmVuZGVySW5Qb3NpdGlvbik7XG5cdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMuc2V0RGlzcGxheVJvd3MocmVzdWx0IHx8IHRoaXMuZ2V0RGlzcGxheVJvd3MoaSAtIDEpLnNsaWNlKDApLCBpKTtcblx0XHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjYXNlIFwiZW5kXCI6XG5cdFx0XHQvL2Nhc2UgdG8gaGFuZGxlIHNjZW5hcmlvIHdoZW4gdHJ5aW5nIHRvIHNraXAgcGFzdCBlbmQgc3RhZ2Vcblx0XHRcdFx0dGhpcy5yZWdlbmVyYXRlUm93UG9zaXRpb25zKCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKHRoaXMuZ2V0RGlzcGxheVJvd3MoKS5sZW5ndGgpe1xuXHRcdFx0dGhpcy5fY2xlYXJQbGFjZWhvbGRlcigpO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9yZWdlbmVyYXRlIHJvdyBwb3NpdGlvbnNcblx0cmVnZW5lcmF0ZVJvd1Bvc2l0aW9ucygpe1xuXHRcdHZhciByb3dzID0gdGhpcy5nZXREaXNwbGF5Um93cygpO1xuXHRcdHZhciBpbmRleCA9IDE7XG5cdFx0XG5cdFx0cm93cy5mb3JFYWNoKChyb3cpID0+IHtcblx0XHRcdGlmIChyb3cudHlwZSA9PT0gXCJyb3dcIil7XG5cdFx0XHRcdHJvdy5zZXRQb3NpdGlvbihpbmRleCk7XG5cdFx0XHRcdGluZGV4Kys7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0XG5cdHNldEFjdGl2ZVJvd3MoYWN0aXZlUm93cyl7XG5cdFx0dGhpcy5hY3RpdmVSb3dzID0gdGhpcy5hY3RpdmVSb3dzID0gT2JqZWN0LmFzc2lnbihbXSwgYWN0aXZlUm93cyk7XG5cdFx0dGhpcy5hY3RpdmVSb3dzQ291bnQgPSB0aGlzLmFjdGl2ZVJvd3MubGVuZ3RoO1xuXHR9XG5cdFxuXHQvL3Jlc2V0IGRpc3BsYXkgcm93cyBhcnJheVxuXHRyZXNldERpc3BsYXlSb3dzKCl7XG5cdFx0dGhpcy5kaXNwbGF5Um93cyA9IFtdO1xuXHRcdFxuXHRcdHRoaXMuZGlzcGxheVJvd3MucHVzaCh0aGlzLmFjdGl2ZVJvd3Muc2xpY2UoMCkpO1xuXHRcdFxuXHRcdHRoaXMuZGlzcGxheVJvd3NDb3VudCA9IHRoaXMuZGlzcGxheVJvd3NbMF0ubGVuZ3RoO1xuXHR9XG5cdFxuXHQvL3NldCBkaXNwbGF5IHJvdyBwaXBlbGluZSBkYXRhXG5cdHNldERpc3BsYXlSb3dzKGRpc3BsYXlSb3dzLCBpbmRleCl7XG5cdFx0dGhpcy5kaXNwbGF5Um93c1tpbmRleF0gPSBkaXNwbGF5Um93cztcblx0XHRcblx0XHRpZihpbmRleCA9PSB0aGlzLmRpc3BsYXlSb3dzLmxlbmd0aCAtMSl7XG5cdFx0XHR0aGlzLmRpc3BsYXlSb3dzQ291bnQgPSB0aGlzLmRpc3BsYXlSb3dzW3RoaXMuZGlzcGxheVJvd3MubGVuZ3RoIC0xXS5sZW5ndGg7XG5cdFx0fVxuXHR9XG5cdFxuXHRnZXREaXNwbGF5Um93cyhpbmRleCl7XG5cdFx0aWYodHlwZW9mIGluZGV4ID09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0cmV0dXJuIHRoaXMuZGlzcGxheVJvd3MubGVuZ3RoID8gdGhpcy5kaXNwbGF5Um93c1t0aGlzLmRpc3BsYXlSb3dzLmxlbmd0aCAtMV0gOiBbXTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5kaXNwbGF5Um93c1tpbmRleF0gfHwgW107XG5cdFx0fVxuXHR9XG5cdFxuXHRnZXRWaXNpYmxlUm93cyhjaGFpbiwgdmlld2FibGUpe1xuXHRcdHZhciByb3dzID0gIE9iamVjdC5hc3NpZ24oW10sIHRoaXMucmVuZGVyZXIudmlzaWJsZVJvd3MoIXZpZXdhYmxlKSk7XG5cdFx0XG5cdFx0aWYoY2hhaW4pe1xuXHRcdFx0cm93cyA9IHRoaXMuY2hhaW4oXCJyb3dzLXZpc2libGVcIiwgW3ZpZXdhYmxlXSwgcm93cywgcm93cyk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiByb3dzO1xuXHR9XG5cdFxuXHQvL3JlcGVhdCBhY3Rpb24gYWNyb3NzIGRpc3BsYXkgcm93c1xuXHRkaXNwbGF5Um93SXRlcmF0b3IoY2FsbGJhY2spe1xuXHRcdHRoaXMuYWN0aXZlUm93c1BpcGVsaW5lLmZvckVhY2goY2FsbGJhY2spO1xuXHRcdHRoaXMuZGlzcGxheVJvd3MuZm9yRWFjaChjYWxsYmFjayk7XG5cdFx0XG5cdFx0dGhpcy5kaXNwbGF5Um93c0NvdW50ID0gdGhpcy5kaXNwbGF5Um93c1t0aGlzLmRpc3BsYXlSb3dzLmxlbmd0aCAtMV0ubGVuZ3RoO1xuXHR9XG5cdFxuXHQvL3JldHVybiBvbmx5IGFjdHVhbCByb3dzIChub3QgZ3JvdXAgaGVhZGVycyBldGMpXG5cdGdldFJvd3ModHlwZSl7XG5cdFx0dmFyIHJvd3MgPSBbXTtcblx0XHRcblx0XHRzd2l0Y2godHlwZSl7XG5cdFx0XHRjYXNlIFwiYWN0aXZlXCI6XG5cdFx0XHRcdHJvd3MgPSB0aGlzLmFjdGl2ZVJvd3M7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwiZGlzcGxheVwiOlxuXHRcdFx0XHRyb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRjYXNlIFwidmlzaWJsZVwiOlxuXHRcdFx0XHRyb3dzID0gdGhpcy5nZXRWaXNpYmxlUm93cyhmYWxzZSwgdHJ1ZSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRyb3dzID0gdGhpcy5jaGFpbihcInJvd3MtcmV0cmlldmVcIiwgdHlwZSwgbnVsbCwgdGhpcy5yb3dzKSB8fCB0aGlzLnJvd3M7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiByb3dzO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLyBUYWJsZSBSZW5kZXJpbmcgLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly90cmlnZ2VyIHJlcmVuZGVyIG9mIHRhYmxlIGluIGN1cnJlbnQgcG9zaXRpb25cblx0cmVSZW5kZXJJblBvc2l0aW9uKGNhbGxiYWNrKXtcblx0XHRpZih0aGlzLnJlZHJhd0Jsb2NrKXtcblx0XHRcdGlmKGNhbGxiYWNrKXtcblx0XHRcdFx0Y2FsbGJhY2soKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5yZWRyYXdCbG9ja1JlbmRlckluUG9zaXRpb24gPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInJlbmRlclN0YXJ0ZWRcIik7XG5cdFx0XHRcblx0XHRcdHRoaXMucmVuZGVyZXIucmVyZW5kZXJSb3dzKGNhbGxiYWNrKTtcblx0XHRcdFxuXHRcdFx0aWYoIXRoaXMuZml4ZWRIZWlnaHQpe1xuXHRcdFx0XHR0aGlzLmFkanVzdFRhYmxlU2l6ZSgpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnNjcm9sbEJhckNoZWNrKCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInJlbmRlckNvbXBsZXRlXCIpO1xuXHRcdH1cblx0fVxuXHRcblx0c2Nyb2xsQmFyQ2hlY2soKXtcblx0XHR2YXIgc2Nyb2xsYmFyV2lkdGggPSAwO1xuXHRcdFxuXHRcdC8vYWRqdXN0IGZvciB2ZXJ0aWNhbCBzY3JvbGxiYXIgbW92aW5nIHRhYmxlIHdoZW4gcHJlc2VudFxuXHRcdGlmKHRoaXMuZWxlbWVudC5zY3JvbGxIZWlnaHQgPiB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0KXtcblx0XHRcdHNjcm9sbGJhcldpZHRoID0gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoIC0gdGhpcy5lbGVtZW50LmNsaWVudFdpZHRoO1xuXHRcdH1cblx0XHRcblx0XHRpZihzY3JvbGxiYXJXaWR0aCAhPT0gdGhpcy5zY3JvbGxiYXJXaWR0aCl7XG5cdFx0XHR0aGlzLnNjcm9sbGJhcldpZHRoID0gc2Nyb2xsYmFyV2lkdGg7XG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwic2Nyb2xsYmFyLXZlcnRpY2FsXCIsIHNjcm9sbGJhcldpZHRoKTtcblx0XHR9XG5cdH1cblx0XG5cdGluaXRpYWxpemVSZW5kZXJlcigpe1xuXHRcdHZhciByZW5kZXJDbGFzcztcblx0XHRcblx0XHR2YXIgcmVuZGVyZXJzID0ge1xuXHRcdFx0XCJ2aXJ0dWFsXCI6IFZpcnR1YWxEb21WZXJ0aWNhbCxcblx0XHRcdFwiYmFzaWNcIjogQmFzaWNWZXJ0aWNhbCxcblx0XHR9O1xuXHRcdFxuXHRcdGlmKHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMucmVuZGVyVmVydGljYWwgPT09IFwic3RyaW5nXCIpe1xuXHRcdFx0cmVuZGVyQ2xhc3MgPSByZW5kZXJlcnNbdGhpcy50YWJsZS5vcHRpb25zLnJlbmRlclZlcnRpY2FsXTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZW5kZXJDbGFzcyA9IHRoaXMudGFibGUub3B0aW9ucy5yZW5kZXJWZXJ0aWNhbDtcblx0XHR9XG5cdFx0XG5cdFx0aWYocmVuZGVyQ2xhc3Mpe1xuXHRcdFx0dGhpcy5yZW5kZXJNb2RlID0gdGhpcy50YWJsZS5vcHRpb25zLnJlbmRlclZlcnRpY2FsO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnJlbmRlcmVyID0gbmV3IHJlbmRlckNsYXNzKHRoaXMudGFibGUsIHRoaXMuZWxlbWVudCwgdGhpcy50YWJsZUVsZW1lbnQpO1xuXHRcdFx0dGhpcy5yZW5kZXJlci5pbml0aWFsaXplKCk7XG5cdFx0XHRcblx0XHRcdGlmKCh0aGlzLnRhYmxlLmVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IHRoaXMudGFibGUub3B0aW9ucy5oZWlnaHQpICYmICEodGhpcy50YWJsZS5vcHRpb25zLm1pbkhlaWdodCAmJiB0aGlzLnRhYmxlLm9wdGlvbnMubWF4SGVpZ2h0KSl7XG5cdFx0XHRcdHRoaXMuZml4ZWRIZWlnaHQgPSB0cnVlO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLmZpeGVkSGVpZ2h0ID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBmaW5kIG1hdGNoaW5nIHJlbmRlcmVyOlwiLCB0aGlzLnRhYmxlLm9wdGlvbnMucmVuZGVyVmVydGljYWwpO1xuXHRcdH1cblx0fVxuXHRcblx0Z2V0UmVuZGVyTW9kZSgpe1xuXHRcdHJldHVybiB0aGlzLnJlbmRlck1vZGU7XG5cdH1cblx0XG5cdHJlbmRlclRhYmxlKCl7XG5cdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwicmVuZGVyU3RhcnRlZFwiKTtcblx0XHRcblx0XHR0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wID0gMDtcblx0XHRcblx0XHR0aGlzLl9jbGVhclRhYmxlKCk7XG5cdFx0XG5cdFx0aWYodGhpcy5kaXNwbGF5Um93c0NvdW50KXtcblx0XHRcdHRoaXMucmVuZGVyZXIucmVuZGVyUm93cygpO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLmZpcnN0UmVuZGVyKXtcblx0XHRcdFx0dGhpcy5maXJzdFJlbmRlciA9IGZhbHNlO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoIXRoaXMuZml4ZWRIZWlnaHQpe1xuXHRcdFx0XHRcdHRoaXMuYWRqdXN0VGFibGVTaXplKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMubGF5b3V0UmVmcmVzaCh0cnVlKTtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLnJlbmRlckVtcHR5U2Nyb2xsKCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKCF0aGlzLmZpeGVkSGVpZ2h0KXtcblx0XHRcdHRoaXMuYWRqdXN0VGFibGVTaXplKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2goXCJ0YWJsZS1sYXlvdXRcIik7XG5cdFx0XG5cdFx0aWYoIXRoaXMuZGlzcGxheVJvd3NDb3VudCl7XG5cdFx0XHR0aGlzLl9zaG93UGxhY2Vob2xkZXIoKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5zY3JvbGxCYXJDaGVjaygpO1xuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcInJlbmRlckNvbXBsZXRlXCIpO1xuXHR9XG5cdFxuXHQvL3Nob3cgc2Nyb2xsYmFycyBvbiBlbXB0eSB0YWJsZSBkaXZcblx0cmVuZGVyRW1wdHlTY3JvbGwoKXtcblx0XHRpZih0aGlzLnBsYWNlaG9sZGVyKXtcblx0XHRcdHRoaXMudGFibGVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLnRhYmxlRWxlbWVudC5zdHlsZS5taW5XaWR0aCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRXaWR0aCgpICsgXCJweFwiO1xuXHRcdFx0Ly8gdGhpcy50YWJsZUVsZW1lbnQuc3R5bGUubWluSGVpZ2h0ID0gXCIxcHhcIjtcblx0XHRcdC8vIHRoaXMudGFibGVFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuXHRcdH1cblx0fVxuXHRcblx0X2NsZWFyVGFibGUoKXtcdFxuXHRcdHRoaXMuX2NsZWFyUGxhY2Vob2xkZXIoKTtcblx0XHRcblx0XHR0aGlzLnNjcm9sbFRvcCA9IDA7XG5cdFx0dGhpcy5zY3JvbGxMZWZ0ID0gMDtcblx0XHRcblx0XHR0aGlzLnJlbmRlcmVyLmNsZWFyUm93cygpO1xuXHR9XG5cdFxuXHR0YWJsZUVtcHR5KCl7XG5cdFx0dGhpcy5yZW5kZXJFbXB0eVNjcm9sbCgpO1xuXHRcdHRoaXMuX3Nob3dQbGFjZWhvbGRlcigpO1xuXHR9XG5cblx0Y2hlY2tQbGFjZWhvbGRlcigpe1xuXHRcdGlmKHRoaXMuZGlzcGxheVJvd3NDb3VudCl7XG5cdFx0XHR0aGlzLl9jbGVhclBsYWNlaG9sZGVyKCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy50YWJsZUVtcHR5KCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRfc2hvd1BsYWNlaG9sZGVyKCl7XG5cdFx0aWYodGhpcy5wbGFjZWhvbGRlcil7XG5cdFx0XHRpZih0aGlzLnBsYWNlaG9sZGVyICYmIHRoaXMucGxhY2Vob2xkZXIucGFyZW50Tm9kZSl7XG5cdFx0XHRcdHRoaXMucGxhY2Vob2xkZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnBsYWNlaG9sZGVyKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5pbml0aWFsaXplUGxhY2Vob2xkZXIoKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5wbGFjZWhvbGRlci5zZXRBdHRyaWJ1dGUoXCJ0YWJ1bGF0b3ItcmVuZGVyLW1vZGVcIiwgdGhpcy5yZW5kZXJNb2RlKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5nZXRFbGVtZW50KCkuYXBwZW5kQ2hpbGQodGhpcy5wbGFjZWhvbGRlcik7XG5cdFx0XHR0aGlzLl9wb3NpdGlvblBsYWNlaG9sZGVyKCk7XG5cblx0XHRcdHRoaXMuYWRqdXN0VGFibGVTaXplKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRfY2xlYXJQbGFjZWhvbGRlcigpe1xuXHRcdGlmKHRoaXMucGxhY2Vob2xkZXIgJiYgdGhpcy5wbGFjZWhvbGRlci5wYXJlbnROb2RlKXtcblx0XHRcdHRoaXMucGxhY2Vob2xkZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnBsYWNlaG9sZGVyKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gY2xlYXIgZW1wdHkgdGFibGUgcGxhY2Vob2xkZXIgbWluXG5cdFx0dGhpcy50YWJsZUVsZW1lbnQuc3R5bGUubWluV2lkdGggPSBcIlwiO1xuXHRcdHRoaXMudGFibGVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuXHR9XG5cdFxuXHRfcG9zaXRpb25QbGFjZWhvbGRlcigpe1xuXHRcdGlmKHRoaXMucGxhY2Vob2xkZXIgJiYgdGhpcy5wbGFjZWhvbGRlci5wYXJlbnROb2RlKXtcblx0XHRcdHRoaXMucGxhY2Vob2xkZXIuc3R5bGUud2lkdGggPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0V2lkdGgoKSArIFwicHhcIjtcblx0XHRcdHRoaXMucGxhY2Vob2xkZXJDb250ZW50cy5zdHlsZS53aWR0aCA9IHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LmNsaWVudFdpZHRoICsgXCJweFwiO1xuXHRcdFx0dGhpcy5wbGFjZWhvbGRlckNvbnRlbnRzLnN0eWxlLm1hcmdpbkxlZnQgPSB0aGlzLnNjcm9sbExlZnQgKyBcInB4XCI7XG5cdFx0fVxuXHR9XG5cdFxuXHRzdHlsZVJvdyhyb3csIGluZGV4KXtcblx0XHR2YXIgcm93RWwgPSByb3cuZ2V0RWxlbWVudCgpO1xuXHRcdFxuXHRcdGlmKGluZGV4ICUgMil7XG5cdFx0XHRyb3dFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1ldmVuXCIpO1xuXHRcdFx0cm93RWwuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1yb3ctb2RkXCIpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itcm93LW9kZFwiKTtcblx0XHRcdHJvd0VsLmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3Itcm93LWV2ZW5cIik7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL25vcm1hbGl6ZSBoZWlnaHQgb2YgYWN0aXZlIHJvd3Ncblx0bm9ybWFsaXplSGVpZ2h0KGZvcmNlKXtcblx0XHR0aGlzLmFjdGl2ZVJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdFx0cm93Lm5vcm1hbGl6ZUhlaWdodChmb3JjZSk7XG5cdFx0fSk7XG5cdH1cblx0XG5cdC8vYWRqdXN0IHRoZSBoZWlnaHQgb2YgdGhlIHRhYmxlIGhvbGRlciB0byBmaXQgaW4gdGhlIFRhYnVsYXRvciBlbGVtZW50XG5cdGFkanVzdFRhYmxlU2l6ZSgpe1xuXHRcdGxldCBpbml0aWFsSGVpZ2h0ID0gdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCwgbWluSGVpZ2h0O1xuXHRcdGxldCByZXNpemVkID0gZmFsc2U7XG5cdFx0XG5cdFx0aWYodGhpcy5yZW5kZXJlci52ZXJ0aWNhbEZpbGxNb2RlID09PSBcImZpbGxcIil7XG5cdFx0XHRsZXQgb3RoZXJIZWlnaHQgPSAgTWF0aC5mbG9vcih0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0RWxlbWVudCgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCArICh0aGlzLnRhYmxlLmZvb3Rlck1hbmFnZXIgJiYgdGhpcy50YWJsZS5mb290ZXJNYW5hZ2VyLmFjdGl2ZSAmJiAhdGhpcy50YWJsZS5mb290ZXJNYW5hZ2VyLmV4dGVybmFsID8gdGhpcy50YWJsZS5mb290ZXJNYW5hZ2VyLmdldEVsZW1lbnQoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgOiAwKSk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMuZml4ZWRIZWlnaHQpe1xuXHRcdFx0XHRtaW5IZWlnaHQgPSBpc05hTih0aGlzLnRhYmxlLm9wdGlvbnMubWluSGVpZ2h0KSA/IHRoaXMudGFibGUub3B0aW9ucy5taW5IZWlnaHQgOiB0aGlzLnRhYmxlLm9wdGlvbnMubWluSGVpZ2h0ICsgXCJweFwiO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc3QgaGVpZ2h0ID0gXCJjYWxjKDEwMCUgLSBcIiArIG90aGVySGVpZ2h0ICsgXCJweClcIjtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9IG1pbkhlaWdodCB8fCBcImNhbGMoMTAwJSAtIFwiICsgb3RoZXJIZWlnaHQgKyBcInB4KVwiO1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gaGVpZ2h0O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiXCI7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5zdHlsZS5oZWlnaHQgPVxuXHRcdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gb3RoZXJIZWlnaHQgKyBcInB4XCI7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5yZW5kZXJlci5yZXNpemUoKTtcblx0XHRcdFxuXHRcdFx0Ly9jaGVjayBpZiB0aGUgdGFibGUgaGFzIGNoYW5nZWQgc2l6ZSB3aGVuIGRlYWxpbmcgd2l0aCB2YXJpYWJsZSBoZWlnaHQgdGFibGVzXG5cdFx0XHRpZighdGhpcy5maXhlZEhlaWdodCAmJiBpbml0aWFsSGVpZ2h0ICE9IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQpe1xuXHRcdFx0XHRyZXNpemVkID0gdHJ1ZTtcblx0XHRcdFx0aWYodGhpcy5zdWJzY3JpYmVkKFwidGFibGUtcmVzaXplXCIpKXtcblx0XHRcdFx0XHR0aGlzLmRpc3BhdGNoKFwidGFibGUtcmVzaXplXCIpO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5yZWRyYXcoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnNjcm9sbEJhckNoZWNrKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuX3Bvc2l0aW9uUGxhY2Vob2xkZXIoKTtcblx0XHRyZXR1cm4gcmVzaXplZDtcblx0fVxuXHRcblx0Ly9yZWluaXRpYWxpemUgYWxsIHJvd3Ncblx0cmVpbml0aWFsaXplKCl7XG5cdFx0dGhpcy5yb3dzLmZvckVhY2goZnVuY3Rpb24ocm93KXtcblx0XHRcdHJvdy5yZWluaXRpYWxpemUodHJ1ZSk7XG5cdFx0fSk7XG5cdH1cblx0XG5cdC8vcHJldmVudCB0YWJsZSBmcm9tIGJlaW5nIHJlZHJhd25cblx0YmxvY2tSZWRyYXcgKCl7XG5cdFx0dGhpcy5yZWRyYXdCbG9jayA9IHRydWU7XG5cdFx0dGhpcy5yZWRyYXdCbG9ja1Jlc3RvcmVDb25maWcgPSBmYWxzZTtcblx0fVxuXHRcblx0Ly9yZXN0b3JlIHRhYmxlIHJlZHJhd2luZ1xuXHRyZXN0b3JlUmVkcmF3ICgpe1xuXHRcdHRoaXMucmVkcmF3QmxvY2sgPSBmYWxzZTtcblx0XHRcblx0XHRpZih0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZyl7XG5cdFx0XHR0aGlzLnJlZnJlc2hBY3RpdmVEYXRhKHRoaXMucmVkcmF3QmxvY2tSZXN0b3JlQ29uZmlnLmhhbmRsZXIsIHRoaXMucmVkcmF3QmxvY2tSZXN0b3JlQ29uZmlnLnNraXBTdGFnZSwgdGhpcy5yZWRyYXdCbG9ja1Jlc3RvcmVDb25maWcucmVuZGVySW5Qb3NpdGlvbik7XG5cdFx0XHRcblx0XHRcdHRoaXMucmVkcmF3QmxvY2tSZXN0b3JlQ29uZmlnID0gZmFsc2U7XG5cdFx0fWVsc2Uge1xuXHRcdFx0aWYodGhpcy5yZWRyYXdCbG9ja1JlbmRlckluUG9zaXRpb24pe1xuXHRcdFx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0aGlzLnJlZHJhd0Jsb2NrUmVuZGVySW5Qb3NpdGlvbiA9IGZhbHNlO1xuXHR9XG5cdFxuXHQvL3JlZHJhdyB0YWJsZVxuXHRyZWRyYXcgKGZvcmNlKXtcblx0XHR0aGlzLmFkanVzdFRhYmxlU2l6ZSgpO1xuXHRcdHRoaXMudGFibGUudGFibGVXaWR0aCA9IHRoaXMudGFibGUuZWxlbWVudC5jbGllbnRXaWR0aDtcblx0XHRcblx0XHRpZighZm9yY2Upe1x0XG5cdFx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHRcdFx0dGhpcy5zY3JvbGxIb3Jpem9udGFsKHRoaXMuc2Nyb2xsTGVmdCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5yZW5kZXJUYWJsZSgpO1xuXHRcdH1cblx0fVxuXHRcblx0cmVzZXRTY3JvbGwoKXtcblx0XHR0aGlzLmVsZW1lbnQuc2Nyb2xsTGVmdCA9IDA7XG5cdFx0dGhpcy5lbGVtZW50LnNjcm9sbFRvcCA9IDA7XG5cdFx0XG5cdFx0aWYodGhpcy50YWJsZS5icm93c2VyID09PSBcImllXCIpe1xuXHRcdFx0dmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtcblx0XHRcdGV2ZW50LmluaXRFdmVudChcInNjcm9sbFwiLCBmYWxzZSwgdHJ1ZSk7XG5cdFx0XHR0aGlzLmVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5lbGVtZW50LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzY3JvbGwnKSk7XG5cdFx0fVxuXHR9XG59XG5cbmNsYXNzIEZvb3Rlck1hbmFnZXIgZXh0ZW5kcyBDb3JlRmVhdHVyZXtcblxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXG5cdFx0dGhpcy5hY3RpdmUgPSBmYWxzZTtcblx0XHR0aGlzLmVsZW1lbnQgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoKTsgLy9jb250YWluaW5nIGVsZW1lbnRcblx0XHR0aGlzLmNvbnRhaW5lckVsZW1lbnQgPSB0aGlzLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQoKTsgLy9jb250YWluaW5nIGVsZW1lbnRcblx0XHR0aGlzLmV4dGVybmFsID0gZmFsc2U7XG5cdH1cblxuXHRpbml0aWFsaXplKCl7XG5cdFx0dGhpcy5pbml0aWFsaXplRWxlbWVudCgpO1xuXHR9XG5cblx0Y3JlYXRlRWxlbWVudCgpe1xuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWZvb3RlclwiKTtcblxuXHRcdHJldHVybiBlbDtcblx0fVxuXG5cdFxuXHRjcmVhdGVDb250YWluZXJFbGVtZW50KCl7XG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZm9vdGVyLWNvbnRlbnRzXCIpO1xuXG5cdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGVsKTtcblxuXHRcdHJldHVybiBlbDtcblx0fVxuXG5cdGluaXRpYWxpemVFbGVtZW50KCl7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmZvb3RlckVsZW1lbnQpe1xuXG5cdFx0XHRzd2l0Y2godHlwZW9mIHRoaXMudGFibGUub3B0aW9ucy5mb290ZXJFbGVtZW50KXtcblx0XHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5mb290ZXJFbGVtZW50WzBdID09PSBcIjxcIil7XG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lckVsZW1lbnQuaW5uZXJIVE1MID0gdGhpcy50YWJsZS5vcHRpb25zLmZvb3RlckVsZW1lbnQ7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0dGhpcy5leHRlcm5hbCA9IHRydWU7XG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMudGFibGUub3B0aW9ucy5mb290ZXJFbGVtZW50KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQgPSB0aGlzLnRhYmxlLm9wdGlvbnMuZm9vdGVyRWxlbWVudDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRnZXRFbGVtZW50KCl7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fVxuXG5cdGFwcGVuZChlbGVtZW50KXtcblx0XHR0aGlzLmFjdGl2YXRlKCk7XG5cblx0XHR0aGlzLmNvbnRhaW5lckVsZW1lbnQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFkanVzdFRhYmxlU2l6ZSgpO1xuXHR9XG5cblx0cHJlcGVuZChlbGVtZW50KXtcblx0XHR0aGlzLmFjdGl2YXRlKCk7XG5cblx0XHR0aGlzLmVsZW1lbnQuaW5zZXJ0QmVmb3JlKGVsZW1lbnQsIHRoaXMuZWxlbWVudC5maXJzdENoaWxkKTtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWRqdXN0VGFibGVTaXplKCk7XG5cdH1cblxuXHRyZW1vdmUoZWxlbWVudCl7XG5cdFx0ZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuXHRcdHRoaXMuZGVhY3RpdmF0ZSgpO1xuXHR9XG5cblx0ZGVhY3RpdmF0ZShmb3JjZSl7XG5cdFx0aWYoIXRoaXMuZWxlbWVudC5maXJzdENoaWxkIHx8IGZvcmNlKXtcblx0XHRcdGlmKCF0aGlzLmV4dGVybmFsKXtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KTtcblx0XHRcdH1cblx0XHRcdHRoaXMuYWN0aXZlID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0YWN0aXZhdGUoKXtcblx0XHRpZighdGhpcy5hY3RpdmUpe1xuXHRcdFx0dGhpcy5hY3RpdmUgPSB0cnVlO1xuXHRcdFx0aWYoIXRoaXMuZXh0ZXJuYWwpe1xuXHRcdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5nZXRFbGVtZW50KCkpO1xuXHRcdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICcnO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJlZHJhdygpe1xuXHRcdHRoaXMuZGlzcGF0Y2goXCJmb290ZXItcmVkcmF3XCIpO1xuXHR9XG59XG5cbmNsYXNzIEludGVyYWN0aW9uTWFuYWdlciBleHRlbmRzIENvcmVGZWF0dXJlIHtcblx0XG5cdGNvbnN0cnVjdG9yICh0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMuZWwgPSBudWxsO1xuXHRcdFxuXHRcdHRoaXMuYWJvcnRDbGFzc2VzID0gW1widGFidWxhdG9yLWhlYWRlcnNcIiwgXCJ0YWJ1bGF0b3ItdGFibGVcIl07XG5cdFx0XG5cdFx0dGhpcy5wcmV2aW91c1RhcmdldHMgPSB7fTtcblx0XHRcblx0XHR0aGlzLmxpc3RlbmVycyA9IFtcblx0XHRcdFwiY2xpY2tcIixcblx0XHRcdFwiZGJsY2xpY2tcIixcblx0XHRcdFwiY29udGV4dG1lbnVcIixcblx0XHRcdFwibW91c2VlbnRlclwiLFxuXHRcdFx0XCJtb3VzZWxlYXZlXCIsXG5cdFx0XHRcIm1vdXNlb3ZlclwiLFxuXHRcdFx0XCJtb3VzZW91dFwiLFxuXHRcdFx0XCJtb3VzZW1vdmVcIixcblx0XHRcdFwibW91c2V1cFwiLFxuXHRcdFx0XCJtb3VzZWRvd25cIixcblx0XHRcdFwidG91Y2hzdGFydFwiLFxuXHRcdFx0XCJ0b3VjaGVuZFwiLFxuXHRcdF07XG5cdFx0XG5cdFx0dGhpcy5jb21wb25lbnRNYXAgPSB7XG5cdFx0XHRcInRhYnVsYXRvci1jZWxsXCI6XCJjZWxsXCIsXG5cdFx0XHRcInRhYnVsYXRvci1yb3dcIjpcInJvd1wiLFxuXHRcdFx0XCJ0YWJ1bGF0b3ItZ3JvdXBcIjpcImdyb3VwXCIsXG5cdFx0XHRcInRhYnVsYXRvci1jb2xcIjpcImNvbHVtblwiLFxuXHRcdH07XG5cdFx0XG5cdFx0dGhpcy5wc2V1ZG9UcmFja2VycyA9IHtcblx0XHRcdFwicm93XCI6e1xuXHRcdFx0XHRzdWJzY3JpYmVyOm51bGwsXG5cdFx0XHRcdHRhcmdldDpudWxsLFxuXHRcdFx0fSxcblx0XHRcdFwiY2VsbFwiOntcblx0XHRcdFx0c3Vic2NyaWJlcjpudWxsLFxuXHRcdFx0XHR0YXJnZXQ6bnVsbCxcblx0XHRcdH0sXG5cdFx0XHRcImdyb3VwXCI6e1xuXHRcdFx0XHRzdWJzY3JpYmVyOm51bGwsXG5cdFx0XHRcdHRhcmdldDpudWxsLFxuXHRcdFx0fSxcblx0XHRcdFwiY29sdW1uXCI6e1xuXHRcdFx0XHRzdWJzY3JpYmVyOm51bGwsXG5cdFx0XHRcdHRhcmdldDpudWxsLFxuXHRcdFx0fSxcblx0XHR9O1xuXHRcdFxuXHRcdHRoaXMucHNldWRvVHJhY2tpbmcgPSBmYWxzZTtcblx0fVxuXHRcblx0aW5pdGlhbGl6ZSgpe1xuXHRcdHRoaXMuZWwgPSB0aGlzLnRhYmxlLmVsZW1lbnQ7XG5cdFx0XG5cdFx0dGhpcy5idWlsZExpc3RlbmVyTWFwKCk7XG5cdFx0dGhpcy5iaW5kU3Vic2NyaXB0aW9uV2F0Y2hlcnMoKTtcblx0fVxuXHRcblx0YnVpbGRMaXN0ZW5lck1hcCgpe1xuXHRcdHZhciBsaXN0ZW5lck1hcCA9IHt9O1xuXHRcdFxuXHRcdHRoaXMubGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7XG5cdFx0XHRsaXN0ZW5lck1hcFtsaXN0ZW5lcl0gPSB7XG5cdFx0XHRcdGhhbmRsZXI6bnVsbCxcblx0XHRcdFx0Y29tcG9uZW50czpbXSxcblx0XHRcdH07XG5cdFx0fSk7XG5cdFx0XG5cdFx0dGhpcy5saXN0ZW5lcnMgPSBsaXN0ZW5lck1hcDtcblx0fVxuXHRcblx0YmluZFBzZXVkb0V2ZW50cygpe1xuXHRcdE9iamVjdC5rZXlzKHRoaXMucHNldWRvVHJhY2tlcnMpLmZvckVhY2goKGtleSkgPT4ge1xuXHRcdFx0dGhpcy5wc2V1ZG9UcmFja2Vyc1trZXldLnN1YnNjcmliZXIgPSB0aGlzLnBzZXVkb01vdXNlRW50ZXIuYmluZCh0aGlzLCBrZXkpO1xuXHRcdFx0dGhpcy5zdWJzY3JpYmUoa2V5ICsgXCItbW91c2VvdmVyXCIsIHRoaXMucHNldWRvVHJhY2tlcnNba2V5XS5zdWJzY3JpYmVyKTtcblx0XHR9KTtcblx0XHRcblx0XHR0aGlzLnBzZXVkb1RyYWNraW5nID0gdHJ1ZTtcblx0fVxuXHRcblx0cHNldWRvTW91c2VFbnRlcihrZXksIGUsIHRhcmdldCl7XG5cdFx0aWYodGhpcy5wc2V1ZG9UcmFja2Vyc1trZXldLnRhcmdldCAhPT0gdGFyZ2V0KXtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy5wc2V1ZG9UcmFja2Vyc1trZXldLnRhcmdldCl7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2goa2V5ICsgXCItbW91c2VsZWF2ZVwiLCBlLCB0aGlzLnBzZXVkb1RyYWNrZXJzW2tleV0udGFyZ2V0KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy5wc2V1ZG9Nb3VzZUxlYXZlKGtleSwgZSk7XG5cdFx0XHRcblx0XHRcdHRoaXMucHNldWRvVHJhY2tlcnNba2V5XS50YXJnZXQgPSB0YXJnZXQ7XG5cdFx0XHRcblx0XHRcdHRoaXMuZGlzcGF0Y2goa2V5ICsgXCItbW91c2VlbnRlclwiLCBlLCB0YXJnZXQpO1xuXHRcdH1cblx0fVxuXHRcblx0cHNldWRvTW91c2VMZWF2ZShrZXksIGUpe1xuXHRcdHZhciBsZWF2ZUxpc3QgPSBPYmplY3Qua2V5cyh0aGlzLnBzZXVkb1RyYWNrZXJzKSxcblx0XHRsaW5rZWRLZXlzID0ge1xuXHRcdFx0XCJyb3dcIjpbXCJjZWxsXCJdLFxuXHRcdFx0XCJjZWxsXCI6W1wicm93XCJdLFxuXHRcdH07XG5cdFx0XG5cdFx0bGVhdmVMaXN0ID0gbGVhdmVMaXN0LmZpbHRlcigoaXRlbSkgPT4ge1xuXHRcdFx0dmFyIGxpbmtzID0gbGlua2VkS2V5c1trZXldO1xuXHRcdFx0cmV0dXJuIGl0ZW0gIT09IGtleSAmJiAoIWxpbmtzIHx8IChsaW5rcyAmJiAhbGlua3MuaW5jbHVkZXMoaXRlbSkpKTtcblx0XHR9KTtcblx0XHRcblx0XHRcblx0XHRsZWF2ZUxpc3QuZm9yRWFjaCgoa2V5KSA9PiB7XG5cdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcy5wc2V1ZG9UcmFja2Vyc1trZXldLnRhcmdldDtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy5wc2V1ZG9UcmFja2Vyc1trZXldLnRhcmdldCl7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2goa2V5ICsgXCItbW91c2VsZWF2ZVwiLCBlLCB0YXJnZXQpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5wc2V1ZG9UcmFja2Vyc1trZXldLnRhcmdldCA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0XG5cdFxuXHRiaW5kU3Vic2NyaXB0aW9uV2F0Y2hlcnMoKXtcblx0XHR2YXIgbGlzdGVuZXJzID0gT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLFxuXHRcdGNvbXBvbmVudHMgPSBPYmplY3QudmFsdWVzKHRoaXMuY29tcG9uZW50TWFwKTtcblx0XHRcblx0XHRmb3IobGV0IGNvbXAgb2YgY29tcG9uZW50cyl7XG5cdFx0XHRmb3IobGV0IGxpc3RlbmVyIG9mIGxpc3RlbmVycyl7XG5cdFx0XHRcdGxldCBrZXkgPSBjb21wICsgXCItXCIgKyBsaXN0ZW5lcjtcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuc3Vic2NyaXB0aW9uQ2hhbmdlKGtleSwgdGhpcy5zdWJzY3JpcHRpb25DaGFuZ2VkLmJpbmQodGhpcywgY29tcCwgbGlzdGVuZXIpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5zdWJzY3JpYmUoXCJ0YWJsZS1kZXN0cm95XCIsIHRoaXMuY2xlYXJXYXRjaGVycy5iaW5kKHRoaXMpKTtcblx0fVxuXHRcblx0c3Vic2NyaXB0aW9uQ2hhbmdlZChjb21wb25lbnQsIGtleSwgYWRkZWQpe1xuXHRcdHZhciBsaXN0ZW5lciA9IHRoaXMubGlzdGVuZXJzW2tleV0uY29tcG9uZW50cyxcblx0XHRpbmRleCA9IGxpc3RlbmVyLmluZGV4T2YoY29tcG9uZW50KSxcblx0XHRjaGFuZ2VkID0gZmFsc2U7XG5cdFx0XG5cdFx0aWYoYWRkZWQpe1xuXHRcdFx0aWYoaW5kZXggPT09IC0xKXtcblx0XHRcdFx0bGlzdGVuZXIucHVzaChjb21wb25lbnQpO1xuXHRcdFx0XHRjaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRpZighdGhpcy5zdWJzY3JpYmVkKGNvbXBvbmVudCArIFwiLVwiICsga2V5KSl7XG5cdFx0XHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0XHRcdGxpc3RlbmVyLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0Y2hhbmdlZCA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYoKGtleSA9PT0gXCJtb3VzZWVudGVyXCIgfHwga2V5ID09PSBcIm1vdXNlbGVhdmVcIikgJiYgIXRoaXMucHNldWRvVHJhY2tpbmcpe1xuXHRcdFx0dGhpcy5iaW5kUHNldWRvRXZlbnRzKCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmKGNoYW5nZWQpe1xuXHRcdFx0dGhpcy51cGRhdGVFdmVudExpc3RlbmVycygpO1xuXHRcdH1cblx0fVxuXHRcblx0dXBkYXRlRXZlbnRMaXN0ZW5lcnMoKXtcblx0XHRmb3IobGV0IGtleSBpbiB0aGlzLmxpc3RlbmVycyl7XG5cdFx0XHRsZXQgbGlzdGVuZXIgPSB0aGlzLmxpc3RlbmVyc1trZXldO1xuXHRcdFx0XG5cdFx0XHRpZihsaXN0ZW5lci5jb21wb25lbnRzLmxlbmd0aCl7XG5cdFx0XHRcdGlmKCFsaXN0ZW5lci5oYW5kbGVyKXtcblx0XHRcdFx0XHRsaXN0ZW5lci5oYW5kbGVyID0gdGhpcy50cmFjay5iaW5kKHRoaXMsIGtleSk7XG5cdFx0XHRcdFx0dGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGtleSwgbGlzdGVuZXIuaGFuZGxlcik7XG5cdFx0XHRcdFx0Ly8gdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGtleSwgbGlzdGVuZXIuaGFuZGxlciwge3Bhc3NpdmU6IHRydWV9KVxuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKGxpc3RlbmVyLmhhbmRsZXIpe1xuXHRcdFx0XHRcdHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihrZXksIGxpc3RlbmVyLmhhbmRsZXIpO1xuXHRcdFx0XHRcdGxpc3RlbmVyLmhhbmRsZXIgPSBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHR0cmFjayh0eXBlLCBlKXtcblx0XHR2YXIgcGF0aCA9IChlLmNvbXBvc2VkUGF0aCAmJiBlLmNvbXBvc2VkUGF0aCgpKSB8fCBlLnBhdGg7XG5cdFx0XG5cdFx0dmFyIHRhcmdldHMgPSB0aGlzLmZpbmRUYXJnZXRzKHBhdGgpO1xuXHRcdHRhcmdldHMgPSB0aGlzLmJpbmRDb21wb25lbnRzKHR5cGUsIHRhcmdldHMpO1xuXHRcdFxuXHRcdHRoaXMudHJpZ2dlckV2ZW50cyh0eXBlLCBlLCB0YXJnZXRzKTtcblx0XHRcblx0XHRpZih0aGlzLnBzZXVkb1RyYWNraW5nICYmICh0eXBlID09IFwibW91c2VvdmVyXCIgfHwgdHlwZSA9PSBcIm1vdXNlbGVhdmVcIikgJiYgIU9iamVjdC5rZXlzKHRhcmdldHMpLmxlbmd0aCl7XG5cdFx0XHR0aGlzLnBzZXVkb01vdXNlTGVhdmUoXCJub25lXCIsIGUpO1xuXHRcdH1cblx0fVxuXHRcblx0ZmluZFRhcmdldHMocGF0aCl7XG5cdFx0dmFyIHRhcmdldHMgPSB7fTtcblx0XHRcblx0XHRsZXQgY29tcG9uZW50TWFwID0gT2JqZWN0LmtleXModGhpcy5jb21wb25lbnRNYXApO1xuXHRcdFxuXHRcdGZvciAobGV0IGVsIG9mIHBhdGgpIHtcblx0XHRcdGxldCBjbGFzc0xpc3QgPSBlbC5jbGFzc0xpc3QgPyBbLi4uZWwuY2xhc3NMaXN0XSA6IFtdO1xuXHRcdFx0XG5cdFx0XHRsZXQgYWJvcnQgPSBjbGFzc0xpc3QuZmlsdGVyKChpdGVtKSA9PiB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmFib3J0Q2xhc3Nlcy5pbmNsdWRlcyhpdGVtKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRpZihhYm9ydC5sZW5ndGgpe1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bGV0IGVsVGFyZ2V0cyA9IGNsYXNzTGlzdC5maWx0ZXIoKGl0ZW0pID0+IHtcblx0XHRcdFx0cmV0dXJuIGNvbXBvbmVudE1hcC5pbmNsdWRlcyhpdGVtKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRmb3IgKGxldCB0YXJnZXQgb2YgZWxUYXJnZXRzKSB7XG5cdFx0XHRcdGlmKCF0YXJnZXRzW3RoaXMuY29tcG9uZW50TWFwW3RhcmdldF1dKXtcblx0XHRcdFx0XHR0YXJnZXRzW3RoaXMuY29tcG9uZW50TWFwW3RhcmdldF1dID0gZWw7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZih0YXJnZXRzLmdyb3VwICYmIHRhcmdldHMuZ3JvdXAgPT09IHRhcmdldHMucm93KXtcblx0XHRcdGRlbGV0ZSB0YXJnZXRzLnJvdztcblx0XHR9XG5cblx0XHRyZXR1cm4gdGFyZ2V0cztcblx0fVxuXHRcblx0YmluZENvbXBvbmVudHModHlwZSwgdGFyZ2V0cyl7XG5cdFx0Ly9lbnN1cmUgcm93IGNvbXBvbmVudCBpcyBsb29rZWQgdXAgYmVmb3JlIGNlbGxcblx0XHR2YXIga2V5cyA9IE9iamVjdC5rZXlzKHRhcmdldHMpLnJldmVyc2UoKSxcblx0XHRsaXN0ZW5lciA9IHRoaXMubGlzdGVuZXJzW3R5cGVdLFxuXHRcdG1hdGNoZXMgPSB7fSxcblx0XHRvdXRwdXQgPSB7fSxcblx0XHR0YXJnZXRNYXRjaGVzID0ge307XG5cdFxuXHRcdGZvcihsZXQga2V5IG9mIGtleXMpe1xuXHRcdFx0bGV0IGNvbXBvbmVudCxcblx0XHRcdHRhcmdldCA9IHRhcmdldHNba2V5XSxcblx0XHRcdHByZXZpb3VzVGFyZ2V0ID0gdGhpcy5wcmV2aW91c1RhcmdldHNba2V5XTtcblx0XHRcdFxuXHRcdFx0aWYocHJldmlvdXNUYXJnZXQgJiYgcHJldmlvdXNUYXJnZXQudGFyZ2V0ID09PSB0YXJnZXQpe1xuXHRcdFx0XHRjb21wb25lbnQgPSBwcmV2aW91c1RhcmdldC5jb21wb25lbnQ7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdHN3aXRjaChrZXkpe1xuXHRcdFx0XHRcdGNhc2UgXCJyb3dcIjpcblx0XHRcdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0XHRcdGlmKGxpc3RlbmVyLmNvbXBvbmVudHMuaW5jbHVkZXMoXCJyb3dcIikgfHwgbGlzdGVuZXIuY29tcG9uZW50cy5pbmNsdWRlcyhcImNlbGxcIikgfHwgbGlzdGVuZXIuY29tcG9uZW50cy5pbmNsdWRlcyhcImdyb3VwXCIpKXtcblx0XHRcdFx0XHRcdFx0bGV0IHJvd3MgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0VmlzaWJsZVJvd3ModHJ1ZSk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Y29tcG9uZW50ID0gcm93cy5maW5kKChyb3cpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gcm93LmdldEVsZW1lbnQoKSA9PT0gdGFyZ2V0O1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRpZih0YXJnZXRzW1wicm93XCJdICYmIHRhcmdldHNbXCJyb3dcIl0ucGFyZW50Tm9kZSAmJiB0YXJnZXRzW1wicm93XCJdLnBhcmVudE5vZGUuY2xvc2VzdChcIi50YWJ1bGF0b3Itcm93XCIpKXtcblx0XHRcdFx0XHRcdFx0XHR0YXJnZXRzW2tleV0gPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y2FzZSBcImNvbHVtblwiOlxuXHRcdFx0XHRcdFx0aWYobGlzdGVuZXIuY29tcG9uZW50cy5pbmNsdWRlcyhcImNvbHVtblwiKSl7XG5cdFx0XHRcdFx0XHRcdGNvbXBvbmVudCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKHRhcmdldCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjYXNlIFwiY2VsbFwiOlxuXHRcdFx0XHRcdFx0aWYobGlzdGVuZXIuY29tcG9uZW50cy5pbmNsdWRlcyhcImNlbGxcIikpe1xuXHRcdFx0XHRcdFx0XHRpZihtYXRjaGVzW1wicm93XCJdIGluc3RhbmNlb2YgUm93KXtcblx0XHRcdFx0XHRcdFx0XHRjb21wb25lbnQgPSBtYXRjaGVzW1wicm93XCJdLmZpbmRDZWxsKHRhcmdldCk7XG5cdFx0XHRcdFx0XHRcdH1lbHNlIHtcdFxuXHRcdFx0XHRcdFx0XHRcdGlmKHRhcmdldHNbXCJyb3dcIl0pe1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiRXZlbnQgVGFyZ2V0IExvb2t1cCBFcnJvciAtIFRoZSByb3cgdGhpcyBjZWxsIGlzIGF0dGFjaGVkIHRvIGNhbm5vdCBiZSBmb3VuZCwgaGFzIHRoZSB0YWJsZSBiZWVuIHJlaW5pdGlhbGl6ZWQgd2l0aG91dCBiZWluZyBkZXN0cm95ZWQgZmlyc3Q/XCIpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoY29tcG9uZW50KXtcblx0XHRcdFx0bWF0Y2hlc1trZXldID0gY29tcG9uZW50O1xuXHRcdFx0XHR0YXJnZXRNYXRjaGVzW2tleV0gPSB7XG5cdFx0XHRcdFx0dGFyZ2V0OnRhcmdldCxcblx0XHRcdFx0XHRjb21wb25lbnQ6Y29tcG9uZW50LFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0aGlzLnByZXZpb3VzVGFyZ2V0cyA9IHRhcmdldE1hdGNoZXM7XG5cblx0XHQvL3JldmVyc2Ugb3JkZXIga2V5cyBhcmUgc2V0IGluIHNvIGV2ZW50cyB0cmlnZ2VyIGluIGNvcnJlY3Qgc2VxdWVuY2Vcblx0XHRPYmplY3Qua2V5cyh0YXJnZXRzKS5mb3JFYWNoKChrZXkpID0+IHtcblx0XHRcdGxldCB2YWx1ZSA9IG1hdGNoZXNba2V5XTtcblx0XHRcdG91dHB1dFtrZXldID0gdmFsdWU7XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0dHJpZ2dlckV2ZW50cyh0eXBlLCBlLCB0YXJnZXRzKXtcblx0XHR2YXIgbGlzdGVuZXIgPSB0aGlzLmxpc3RlbmVyc1t0eXBlXTtcblxuXHRcdGZvcihsZXQga2V5IGluIHRhcmdldHMpe1xuXHRcdFx0aWYodGFyZ2V0c1trZXldICYmIGxpc3RlbmVyLmNvbXBvbmVudHMuaW5jbHVkZXMoa2V5KSl7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2goa2V5ICsgXCItXCIgKyB0eXBlLCBlLCB0YXJnZXRzW2tleV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0Y2xlYXJXYXRjaGVycygpe1xuXHRcdGZvcihsZXQga2V5IGluIHRoaXMubGlzdGVuZXJzKXtcblx0XHRcdGxldCBsaXN0ZW5lciA9IHRoaXMubGlzdGVuZXJzW2tleV07XG5cdFx0XHRcblx0XHRcdGlmKGxpc3RlbmVyLmhhbmRsZXIpe1xuXHRcdFx0XHR0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoa2V5LCBsaXN0ZW5lci5oYW5kbGVyKTtcblx0XHRcdFx0bGlzdGVuZXIuaGFuZGxlciA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG5cbmNsYXNzIENvbXBvbmVudEZ1bmN0aW9uQmluZGVye1xuXG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHR0aGlzLnRhYmxlID0gdGFibGU7XG5cblx0XHR0aGlzLmJpbmRpbmdzID0ge307XG5cdH1cblxuXHRiaW5kKHR5cGUsIGZ1bmNOYW1lLCBoYW5kbGVyKXtcblx0XHRpZighdGhpcy5iaW5kaW5nc1t0eXBlXSl7XG5cdFx0XHR0aGlzLmJpbmRpbmdzW3R5cGVdID0ge307XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5iaW5kaW5nc1t0eXBlXVtmdW5jTmFtZV0pe1xuXHRcdFx0Y29uc29sZS53YXJuKFwiVW5hYmxlIHRvIGJpbmQgY29tcG9uZW50IGhhbmRsZXIsIGEgbWF0Y2hpbmcgZnVuY3Rpb24gbmFtZSBpcyBhbHJlYWR5IGJvdW5kXCIsIHR5cGUsIGZ1bmNOYW1lLCBoYW5kbGVyKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLmJpbmRpbmdzW3R5cGVdW2Z1bmNOYW1lXSA9IGhhbmRsZXI7XG5cdFx0fVxuXHR9XG5cblx0aGFuZGxlKHR5cGUsIGNvbXBvbmVudCwgbmFtZSl7XG5cdFx0aWYodGhpcy5iaW5kaW5nc1t0eXBlXSAmJiB0aGlzLmJpbmRpbmdzW3R5cGVdW25hbWVdICYmIHR5cGVvZiB0aGlzLmJpbmRpbmdzW3R5cGVdW25hbWVdLmJpbmQgPT09ICdmdW5jdGlvbicpe1xuXHRcdFx0cmV0dXJuIHRoaXMuYmluZGluZ3NbdHlwZV1bbmFtZV0uYmluZChudWxsLCBjb21wb25lbnQpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGlmKG5hbWUgIT09IFwidGhlblwiICYmIHR5cGVvZiBuYW1lID09PSBcInN0cmluZ1wiICYmICFuYW1lLnN0YXJ0c1dpdGgoXCJfXCIpKXtcblx0XHRcdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLmRlYnVnSW52YWxpZENvbXBvbmVudEZ1bmNzKXtcblx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwiVGhlIFwiICsgdHlwZSArIFwiIGNvbXBvbmVudCBkb2VzIG5vdCBoYXZlIGEgXCIgKyBuYW1lICsgXCIgZnVuY3Rpb24sIGhhdmUgeW91IGNoZWNrZWQgdGhhdCB5b3UgaGF2ZSB0aGUgY29ycmVjdCBUYWJ1bGF0b3IgbW9kdWxlIGluc3RhbGxlZD9cIik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxuY2xhc3MgRGF0YUxvYWRlciBleHRlbmRzIENvcmVGZWF0dXJle1xuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUpO1xuXHRcdFxuXHRcdHRoaXMucmVxdWVzdE9yZGVyID0gMDsgLy9wcmV2ZW50IHJlcXVlc3RzIGNvbWluZyBvdXQgb2Ygc2VxdWVuY2UgaWYgb3ZlcnJpZGRlbiBieSBhbm90aGVyIGxvYWQgcmVxdWVzdFxuXHRcdHRoaXMubG9hZGluZyA9IGZhbHNlO1xuXHR9XG5cdFxuXHRpbml0aWFsaXplKCl7fVxuXHRcblx0bG9hZChkYXRhLCBwYXJhbXMsIGNvbmZpZywgcmVwbGFjZSwgc2lsZW50LCBjb2x1bW5zQ2hhbmdlZCl7XG5cdFx0dmFyIHJlcXVlc3RObyA9ICsrdGhpcy5yZXF1ZXN0T3JkZXI7XG5cblx0XHRpZih0aGlzLnRhYmxlLmRlc3Ryb3llZCl7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2hFeHRlcm5hbChcImRhdGFMb2FkaW5nXCIsIGRhdGEpO1xuXHRcdFxuXHRcdC8vcGFyc2UganNvbiBkYXRhIHRvIGFycmF5XG5cdFx0aWYgKGRhdGEgJiYgKGRhdGEuaW5kZXhPZihcIntcIikgPT0gMCB8fCBkYXRhLmluZGV4T2YoXCJbXCIpID09IDApKXtcblx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdH1cblx0XHRcblx0XHRpZih0aGlzLmNvbmZpcm0oXCJkYXRhLWxvYWRpbmdcIiwgW2RhdGEsIHBhcmFtcywgY29uZmlnLCBzaWxlbnRdKSl7XG5cdFx0XHR0aGlzLmxvYWRpbmcgPSB0cnVlO1xuXHRcdFx0XG5cdFx0XHRpZighc2lsZW50KXtcblx0XHRcdFx0dGhpcy5hbGVydExvYWRlcigpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvL2dldCBwYXJhbXMgZm9yIHJlcXVlc3Rcblx0XHRcdHBhcmFtcyA9IHRoaXMuY2hhaW4oXCJkYXRhLXBhcmFtc1wiLCBbZGF0YSwgY29uZmlnLCBzaWxlbnRdLCBwYXJhbXMgfHwge30sIHBhcmFtcyB8fCB7fSk7XG5cdFx0XHRcblx0XHRcdHBhcmFtcyA9IHRoaXMubWFwUGFyYW1zKHBhcmFtcywgdGhpcy50YWJsZS5vcHRpb25zLmRhdGFTZW5kUGFyYW1zKTtcblx0XHRcdFxuXHRcdFx0dmFyIHJlc3VsdCA9IHRoaXMuY2hhaW4oXCJkYXRhLWxvYWRcIiwgW2RhdGEsIHBhcmFtcywgY29uZmlnLCBzaWxlbnRdLCBmYWxzZSwgUHJvbWlzZS5yZXNvbHZlKFtdKSk7XG5cdFx0XHRcblx0XHRcdHJldHVybiByZXN1bHQudGhlbigocmVzcG9uc2UpID0+IHtcblx0XHRcdFx0aWYoIXRoaXMudGFibGUuZGVzdHJveWVkKXtcblx0XHRcdFx0XHRpZighQXJyYXkuaXNBcnJheShyZXNwb25zZSkgJiYgdHlwZW9mIHJlc3BvbnNlID09IFwib2JqZWN0XCIpe1xuXHRcdFx0XHRcdFx0cmVzcG9uc2UgPSB0aGlzLm1hcFBhcmFtcyhyZXNwb25zZSwgdGhpcy5vYmplY3RJbnZlcnQodGhpcy50YWJsZS5vcHRpb25zLmRhdGFSZWNlaXZlUGFyYW1zKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHZhciByb3dEYXRhID0gdGhpcy5jaGFpbihcImRhdGEtbG9hZGVkXCIsIFtyZXNwb25zZV0sIG51bGwsIHJlc3BvbnNlKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihyZXF1ZXN0Tm8gPT0gdGhpcy5yZXF1ZXN0T3JkZXIpe1xuXHRcdFx0XHRcdFx0dGhpcy5jbGVhckFsZXJ0KCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmKHJvd0RhdGEgIT09IGZhbHNlKXtcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwiZGF0YUxvYWRlZFwiLCByb3dEYXRhKTtcblx0XHRcdFx0XHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNldERhdGEocm93RGF0YSwgIHJlcGxhY2UsIHR5cGVvZiBjb2x1bW5zQ2hhbmdlZCA9PT0gXCJ1bmRlZmluZWRcIiA/ICFyZXBsYWNlIDogY29sdW1uc0NoYW5nZWQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkRhdGEgTG9hZCBSZXNwb25zZSBCbG9ja2VkIC0gQW4gYWN0aXZlIGRhdGEgbG9hZCByZXF1ZXN0IHdhcyBibG9ja2VkIGJ5IGFuIGF0dGVtcHQgdG8gY2hhbmdlIHRhYmxlIGRhdGEgd2hpbGUgdGhlIHJlcXVlc3Qgd2FzIGJlaW5nIG1hZGVcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiRGF0YSBMb2FkIFJlc3BvbnNlIEJsb2NrZWQgLSBUYWJsZSBoYXMgYmVlbiBkZXN0cm95ZWRcIik7XG5cdFx0XHRcdH1cblx0XHRcdH0pLmNhdGNoKChlcnJvcikgPT4ge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwiRGF0YSBMb2FkIEVycm9yOiBcIiwgZXJyb3IpO1xuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhTG9hZEVycm9yXCIsIGVycm9yKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKCFzaWxlbnQpe1xuXHRcdFx0XHRcdHRoaXMuYWxlcnRFcnJvcigpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHR0aGlzLmNsZWFyQWxlcnQoKTtcblx0XHRcdFx0fSwgdGhpcy50YWJsZS5vcHRpb25zLmRhdGFMb2FkZXJFcnJvclRpbWVvdXQpO1xuXHRcdFx0fSlcblx0XHRcdFx0LmZpbmFsbHkoKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMubG9hZGluZyA9IGZhbHNlO1xuXHRcdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLmRpc3BhdGNoRXh0ZXJuYWwoXCJkYXRhTG9hZGVkXCIsIGRhdGEpO1xuXHRcdFx0XG5cdFx0XHRpZighZGF0YSl7XG5cdFx0XHRcdGRhdGEgPSBbXTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNldERhdGEoZGF0YSwgcmVwbGFjZSwgdHlwZW9mIGNvbHVtbnNDaGFuZ2VkID09PSBcInVuZGVmaW5lZFwiID8gIXJlcGxhY2UgOiBjb2x1bW5zQ2hhbmdlZCk7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRtYXBQYXJhbXMocGFyYW1zLCBtYXApe1xuXHRcdHZhciBvdXRwdXQgPSB7fTtcblx0XHRcblx0XHRmb3IobGV0IGtleSBpbiBwYXJhbXMpe1xuXHRcdFx0b3V0cHV0W21hcC5oYXNPd25Qcm9wZXJ0eShrZXkpID8gbWFwW2tleV0gOiBrZXldID0gcGFyYW1zW2tleV07XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblx0XG5cdG9iamVjdEludmVydChvYmope1xuXHRcdHZhciBvdXRwdXQgPSB7fTtcblx0XHRcblx0XHRmb3IobGV0IGtleSBpbiBvYmope1xuXHRcdFx0b3V0cHV0W29ialtrZXldXSA9IGtleTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXHRcblx0YmxvY2tBY3RpdmVMb2FkKCl7XG5cdFx0dGhpcy5yZXF1ZXN0T3JkZXIrKztcblx0fVxuXHRcblx0YWxlcnRMb2FkZXIoKXtcblx0XHR2YXIgc2hvdWxkTG9hZCA9IHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YUxvYWRlciA9PT0gXCJmdW5jdGlvblwiID8gdGhpcy50YWJsZS5vcHRpb25zLmRhdGFMb2FkZXIoKSA6IHRoaXMudGFibGUub3B0aW9ucy5kYXRhTG9hZGVyO1xuXHRcdFxuXHRcdGlmKHNob3VsZExvYWQpe1xuXHRcdFx0dGhpcy50YWJsZS5hbGVydE1hbmFnZXIuYWxlcnQodGhpcy50YWJsZS5vcHRpb25zLmRhdGFMb2FkZXJMb2FkaW5nIHx8IHRoaXMubGFuZ1RleHQoXCJkYXRhfGxvYWRpbmdcIikpO1xuXHRcdH1cblx0fVxuXHRcblx0YWxlcnRFcnJvcigpe1xuXHRcdHRoaXMudGFibGUuYWxlcnRNYW5hZ2VyLmFsZXJ0KHRoaXMudGFibGUub3B0aW9ucy5kYXRhTG9hZGVyRXJyb3IgfHwgdGhpcy5sYW5nVGV4dChcImRhdGF8ZXJyb3JcIiksIFwiZXJyb3JcIik7XG5cdH1cblx0XG5cdGNsZWFyQWxlcnQoKXtcblx0XHR0aGlzLnRhYmxlLmFsZXJ0TWFuYWdlci5jbGVhcigpO1xuXHR9XG59XG5cbmNsYXNzIEV4dGVybmFsRXZlbnRCdXMge1xuXG5cdGNvbnN0cnVjdG9yKHRhYmxlLCBvcHRpb25zTGlzdCwgZGVidWcpe1xuXHRcdHRoaXMudGFibGUgPSB0YWJsZTtcblx0XHR0aGlzLmV2ZW50cyA9IHt9O1xuXHRcdHRoaXMub3B0aW9uc0xpc3QgPSBvcHRpb25zTGlzdCB8fCB7fTtcblx0XHR0aGlzLnN1YnNjcmlwdGlvbk5vdGlmaWVycyA9IHt9O1xuXG5cdFx0dGhpcy5kaXNwYXRjaCA9IGRlYnVnID8gdGhpcy5fZGVidWdEaXNwYXRjaC5iaW5kKHRoaXMpIDogdGhpcy5fZGlzcGF0Y2guYmluZCh0aGlzKTtcblx0XHR0aGlzLmRlYnVnID0gZGVidWc7XG5cdH1cblxuXHRzdWJzY3JpcHRpb25DaGFuZ2Uoa2V5LCBjYWxsYmFjayl7XG5cdFx0aWYoIXRoaXMuc3Vic2NyaXB0aW9uTm90aWZpZXJzW2tleV0pe1xuXHRcdFx0dGhpcy5zdWJzY3JpcHRpb25Ob3RpZmllcnNba2V5XSA9IFtdO1xuXHRcdH1cblxuXHRcdHRoaXMuc3Vic2NyaXB0aW9uTm90aWZpZXJzW2tleV0ucHVzaChjYWxsYmFjayk7XG5cblx0XHRpZih0aGlzLnN1YnNjcmliZWQoa2V5KSl7XG5cdFx0XHR0aGlzLl9ub3RpZnlTdWJzY3JpcHRpb25DaGFuZ2Uoa2V5LCB0cnVlKTtcblx0XHR9XG5cdH1cblxuXHRzdWJzY3JpYmUoa2V5LCBjYWxsYmFjayl7XG5cdFx0aWYoIXRoaXMuZXZlbnRzW2tleV0pe1xuXHRcdFx0dGhpcy5ldmVudHNba2V5XSA9IFtdO1xuXHRcdH1cblxuXHRcdHRoaXMuZXZlbnRzW2tleV0ucHVzaChjYWxsYmFjayk7XG5cblx0XHR0aGlzLl9ub3RpZnlTdWJzY3JpcHRpb25DaGFuZ2Uoa2V5LCB0cnVlKTtcblx0fVxuXG5cdHVuc3Vic2NyaWJlKGtleSwgY2FsbGJhY2spe1xuXHRcdHZhciBpbmRleDtcblxuXHRcdGlmKHRoaXMuZXZlbnRzW2tleV0pe1xuXHRcdFx0aWYoY2FsbGJhY2spe1xuXHRcdFx0XHRpbmRleCA9IHRoaXMuZXZlbnRzW2tleV0uZmluZEluZGV4KChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0gPT09IGNhbGxiYWNrO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZihpbmRleCA+IC0xKXtcblx0XHRcdFx0XHR0aGlzLmV2ZW50c1trZXldLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJDYW5ub3QgcmVtb3ZlIGV2ZW50LCBubyBtYXRjaGluZyBldmVudCBmb3VuZDpcIiwga2V5LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGRlbGV0ZSB0aGlzLmV2ZW50c1trZXldO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNhbm5vdCByZW1vdmUgZXZlbnQsIG5vIGV2ZW50cyBzZXQgb246XCIsIGtleSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5fbm90aWZ5U3Vic2NyaXB0aW9uQ2hhbmdlKGtleSwgZmFsc2UpO1xuXHR9XG5cblx0c3Vic2NyaWJlZChrZXkpe1xuXHRcdHJldHVybiB0aGlzLmV2ZW50c1trZXldICYmIHRoaXMuZXZlbnRzW2tleV0ubGVuZ3RoO1xuXHR9XG5cblx0X25vdGlmeVN1YnNjcmlwdGlvbkNoYW5nZShrZXksIHN1YnNjcmliZWQpe1xuXHRcdHZhciBub3RpZmllcnMgPSB0aGlzLnN1YnNjcmlwdGlvbk5vdGlmaWVyc1trZXldO1xuXG5cdFx0aWYobm90aWZpZXJzKXtcblx0XHRcdG5vdGlmaWVycy5mb3JFYWNoKChjYWxsYmFjayk9Pntcblx0XHRcdFx0Y2FsbGJhY2soc3Vic2NyaWJlZCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHRfZGlzcGF0Y2goKXtcblx0XHR2YXIgYXJncyA9IEFycmF5LmZyb20oYXJndW1lbnRzKSxcblx0XHRrZXkgPSBhcmdzLnNoaWZ0KCksXG5cdFx0cmVzdWx0O1xuXG5cdFx0aWYodGhpcy5ldmVudHNba2V5XSl7XG5cdFx0XHR0aGlzLmV2ZW50c1trZXldLmZvckVhY2goKGNhbGxiYWNrLCBpKSA9PiB7XG5cdFx0XHRcdGxldCBjYWxsUmVzdWx0ID0gY2FsbGJhY2suYXBwbHkodGhpcy50YWJsZSwgYXJncyk7XG5cblx0XHRcdFx0aWYoIWkpe1xuXHRcdFx0XHRcdHJlc3VsdCA9IGNhbGxSZXN1bHQ7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHRfZGVidWdEaXNwYXRjaCgpe1xuXHRcdHZhciBhcmdzID0gQXJyYXkuZnJvbShhcmd1bWVudHMpLFxuXHRcdGtleSA9IGFyZ3NbMF07XG5cblx0XHRhcmdzWzBdID0gXCJFeHRlcm5hbEV2ZW50OlwiICsgYXJnc1swXTtcblxuXHRcdGlmKHRoaXMuZGVidWcgPT09IHRydWUgfHwgdGhpcy5kZWJ1Zy5pbmNsdWRlcyhrZXkpKXtcblx0XHRcdGNvbnNvbGUubG9nKC4uLmFyZ3MpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLl9kaXNwYXRjaCguLi5hcmd1bWVudHMpO1xuXHR9XG59XG5cbmNsYXNzIEludGVybmFsRXZlbnRCdXMge1xuXG5cdGNvbnN0cnVjdG9yKGRlYnVnKXtcblx0XHR0aGlzLmV2ZW50cyA9IHt9O1xuXHRcdHRoaXMuc3Vic2NyaXB0aW9uTm90aWZpZXJzID0ge307XG5cblx0XHR0aGlzLmRpc3BhdGNoID0gZGVidWcgPyB0aGlzLl9kZWJ1Z0Rpc3BhdGNoLmJpbmQodGhpcykgOiB0aGlzLl9kaXNwYXRjaC5iaW5kKHRoaXMpO1xuXHRcdHRoaXMuY2hhaW4gPSBkZWJ1ZyA/IHRoaXMuX2RlYnVnQ2hhaW4uYmluZCh0aGlzKSA6IHRoaXMuX2NoYWluLmJpbmQodGhpcyk7XG5cdFx0dGhpcy5jb25maXJtID0gZGVidWcgPyB0aGlzLl9kZWJ1Z0NvbmZpcm0uYmluZCh0aGlzKSA6IHRoaXMuX2NvbmZpcm0uYmluZCh0aGlzKTtcblx0XHR0aGlzLmRlYnVnID0gZGVidWc7XG5cdH1cblxuXHRzdWJzY3JpcHRpb25DaGFuZ2Uoa2V5LCBjYWxsYmFjayl7XG5cdFx0aWYoIXRoaXMuc3Vic2NyaXB0aW9uTm90aWZpZXJzW2tleV0pe1xuXHRcdFx0dGhpcy5zdWJzY3JpcHRpb25Ob3RpZmllcnNba2V5XSA9IFtdO1xuXHRcdH1cblxuXHRcdHRoaXMuc3Vic2NyaXB0aW9uTm90aWZpZXJzW2tleV0ucHVzaChjYWxsYmFjayk7XG5cblx0XHRpZih0aGlzLnN1YnNjcmliZWQoa2V5KSl7XG5cdFx0XHR0aGlzLl9ub3RpZnlTdWJzY3JpcHRpb25DaGFuZ2Uoa2V5LCB0cnVlKTtcblx0XHR9XG5cdH1cblxuXHRzdWJzY3JpYmUoa2V5LCBjYWxsYmFjaywgcHJpb3JpdHkgPSAxMDAwMCl7XG5cdFx0aWYoIXRoaXMuZXZlbnRzW2tleV0pe1xuXHRcdFx0dGhpcy5ldmVudHNba2V5XSA9IFtdO1xuXHRcdH1cblxuXHRcdHRoaXMuZXZlbnRzW2tleV0ucHVzaCh7Y2FsbGJhY2ssIHByaW9yaXR5fSk7XG5cblx0XHR0aGlzLmV2ZW50c1trZXldLnNvcnQoKGEsIGIpID0+IHtcblx0XHRcdHJldHVybiBhLnByaW9yaXR5IC0gYi5wcmlvcml0eTtcblx0XHR9KTtcblxuXHRcdHRoaXMuX25vdGlmeVN1YnNjcmlwdGlvbkNoYW5nZShrZXksIHRydWUpO1xuXHR9XG5cblx0dW5zdWJzY3JpYmUoa2V5LCBjYWxsYmFjayl7XG5cdFx0dmFyIGluZGV4O1xuXG5cdFx0aWYodGhpcy5ldmVudHNba2V5XSl7XG5cdFx0XHRpZihjYWxsYmFjayl7XG5cdFx0XHRcdGluZGV4ID0gdGhpcy5ldmVudHNba2V5XS5maW5kSW5kZXgoKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gaXRlbS5jYWxsYmFjayA9PT0gY2FsbGJhY2s7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0XHRcdHRoaXMuZXZlbnRzW2tleV0uc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkNhbm5vdCByZW1vdmUgZXZlbnQsIG5vIG1hdGNoaW5nIGV2ZW50IGZvdW5kOlwiLCBrZXksIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJDYW5ub3QgcmVtb3ZlIGV2ZW50LCBubyBldmVudHMgc2V0IG9uOlwiLCBrZXkpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuX25vdGlmeVN1YnNjcmlwdGlvbkNoYW5nZShrZXksIGZhbHNlKTtcblx0fVxuXG5cdHN1YnNjcmliZWQoa2V5KXtcblx0XHRyZXR1cm4gdGhpcy5ldmVudHNba2V5XSAmJiB0aGlzLmV2ZW50c1trZXldLmxlbmd0aDtcblx0fVxuXG5cdF9jaGFpbihrZXksIGFyZ3MsIGluaXRpYWxWYWx1ZSwgZmFsbGJhY2spe1xuXHRcdHZhciB2YWx1ZSA9IGluaXRpYWxWYWx1ZTtcblxuXHRcdGlmKCFBcnJheS5pc0FycmF5KGFyZ3MpKXtcblx0XHRcdGFyZ3MgPSBbYXJnc107XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5zdWJzY3JpYmVkKGtleSkpe1xuXHRcdFx0dGhpcy5ldmVudHNba2V5XS5mb3JFYWNoKChzdWJzY3JpYmVyLCBpKSA9PiB7XG5cdFx0XHRcdHZhbHVlID0gc3Vic2NyaWJlci5jYWxsYmFjay5hcHBseSh0aGlzLCBhcmdzLmNvbmNhdChbdmFsdWVdKSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJldHVybiB0eXBlb2YgZmFsbGJhY2sgPT09IFwiZnVuY3Rpb25cIiA/IGZhbGxiYWNrKCkgOiBmYWxsYmFjaztcblx0XHR9XG5cdH1cblxuXHRfY29uZmlybShrZXksIGFyZ3Mpe1xuXHRcdHZhciBjb25maXJtZWQgPSBmYWxzZTtcblxuXHRcdGlmKCFBcnJheS5pc0FycmF5KGFyZ3MpKXtcblx0XHRcdGFyZ3MgPSBbYXJnc107XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5zdWJzY3JpYmVkKGtleSkpe1xuXHRcdFx0dGhpcy5ldmVudHNba2V5XS5mb3JFYWNoKChzdWJzY3JpYmVyLCBpKSA9PiB7XG5cdFx0XHRcdGlmKHN1YnNjcmliZXIuY2FsbGJhY2suYXBwbHkodGhpcywgYXJncykpe1xuXHRcdFx0XHRcdGNvbmZpcm1lZCA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBjb25maXJtZWQ7XG5cdH1cblxuXHRfbm90aWZ5U3Vic2NyaXB0aW9uQ2hhbmdlKGtleSwgc3Vic2NyaWJlZCl7XG5cdFx0dmFyIG5vdGlmaWVycyA9IHRoaXMuc3Vic2NyaXB0aW9uTm90aWZpZXJzW2tleV07XG5cblx0XHRpZihub3RpZmllcnMpe1xuXHRcdFx0bm90aWZpZXJzLmZvckVhY2goKGNhbGxiYWNrKT0+e1xuXHRcdFx0XHRjYWxsYmFjayhzdWJzY3JpYmVkKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdF9kaXNwYXRjaCgpe1xuXHRcdHZhciBhcmdzID0gQXJyYXkuZnJvbShhcmd1bWVudHMpLFxuXHRcdGtleSA9IGFyZ3Muc2hpZnQoKTtcblxuXHRcdGlmKHRoaXMuZXZlbnRzW2tleV0pe1xuXHRcdFx0dGhpcy5ldmVudHNba2V5XS5mb3JFYWNoKChzdWJzY3JpYmVyKSA9PiB7XG5cdFx0XHRcdHN1YnNjcmliZXIuY2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHRfZGVidWdEaXNwYXRjaCgpe1xuXHRcdHZhciBhcmdzID0gQXJyYXkuZnJvbShhcmd1bWVudHMpLFxuXHRcdGtleSA9IGFyZ3NbMF07XG5cblx0XHRhcmdzWzBdID0gXCJJbnRlcm5hbEV2ZW50OlwiICsga2V5O1xuXG5cdFx0aWYodGhpcy5kZWJ1ZyA9PT0gdHJ1ZSB8fCB0aGlzLmRlYnVnLmluY2x1ZGVzKGtleSkpe1xuXHRcdFx0Y29uc29sZS5sb2coLi4uYXJncyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuX2Rpc3BhdGNoKC4uLmFyZ3VtZW50cyk7XG5cdH1cblxuXHRfZGVidWdDaGFpbigpe1xuXHRcdHZhciBhcmdzID0gQXJyYXkuZnJvbShhcmd1bWVudHMpLFxuXHRcdGtleSA9IGFyZ3NbMF07XG5cblx0XHRhcmdzWzBdID0gXCJJbnRlcm5hbEV2ZW50OlwiICsga2V5O1xuXG5cdFx0aWYodGhpcy5kZWJ1ZyA9PT0gdHJ1ZSB8fCB0aGlzLmRlYnVnLmluY2x1ZGVzKGtleSkpe1xuXHRcdFx0Y29uc29sZS5sb2coLi4uYXJncyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuX2NoYWluKC4uLmFyZ3VtZW50cyk7XG5cdH1cblxuXHRfZGVidWdDb25maXJtKCl7XG5cdFx0dmFyIGFyZ3MgPSBBcnJheS5mcm9tKGFyZ3VtZW50cyksXG5cdFx0a2V5ID0gYXJnc1swXTtcblxuXHRcdGFyZ3NbMF0gPSBcIkludGVybmFsRXZlbnQ6XCIgKyBrZXk7XG5cblx0XHRpZih0aGlzLmRlYnVnID09PSB0cnVlIHx8IHRoaXMuZGVidWcuaW5jbHVkZXMoa2V5KSl7XG5cdFx0XHRjb25zb2xlLmxvZyguLi5hcmdzKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5fY29uZmlybSguLi5hcmd1bWVudHMpO1xuXHR9XG59XG5cbmNsYXNzIERlcHJlY2F0aW9uQWR2aXNvciBleHRlbmRzIENvcmVGZWF0dXJle1xuXHRcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0fVxuXHRcblx0X3dhcm5Vc2VyKCl7XG5cdFx0aWYodGhpcy5vcHRpb25zKFwiZGVidWdEZXByZWNhdGlvblwiKSl7XG5cdFx0XHRjb25zb2xlLndhcm4oLi4uYXJndW1lbnRzKTtcblx0XHR9XG5cdH1cblx0XG5cdGNoZWNrKG9sZE9wdGlvbiwgbmV3T3B0aW9uLCBjb252ZXJ0KXtcblx0XHR2YXIgbXNnID0gXCJcIjtcblx0XHRcblx0XHRpZih0eXBlb2YgdGhpcy5vcHRpb25zKG9sZE9wdGlvbikgIT09IFwidW5kZWZpbmVkXCIpe1xuXHRcdFx0bXNnID0gXCJEZXByZWNhdGVkIFNldHVwIE9wdGlvbiAtIFVzZSBvZiB0aGUgJWNcIiArIG9sZE9wdGlvbiArIFwiJWMgb3B0aW9uIGlzIG5vdyBkZXByZWNhdGVkXCI7XG5cdFx0XHRcblx0XHRcdGlmKG5ld09wdGlvbil7XG5cdFx0XHRcdG1zZyA9IG1zZyArIFwiLCBQbGVhc2UgdXNlIHRoZSAlY1wiICsgbmV3T3B0aW9uICsgXCIlYyBvcHRpb24gaW5zdGVhZFwiO1xuXHRcdFx0XHR0aGlzLl93YXJuVXNlcihtc2csICdmb250LXdlaWdodDogYm9sZDsnLCAnZm9udC13ZWlnaHQ6IG5vcm1hbDsnLCAnZm9udC13ZWlnaHQ6IGJvbGQ7JywgJ2ZvbnQtd2VpZ2h0OiBub3JtYWw7Jyk7XG5cblx0XHRcdFx0aWYoY29udmVydCl7XG5cdFx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zW25ld09wdGlvbl0gPSB0aGlzLnRhYmxlLm9wdGlvbnNbb2xkT3B0aW9uXTtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHR0aGlzLl93YXJuVXNlcihtc2csICdmb250LXdlaWdodDogYm9sZDsnLCAnZm9udC13ZWlnaHQ6IG5vcm1hbDsnKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0fVxuXHRcblx0Y2hlY2tNc2cob2xkT3B0aW9uLCBtc2cpe1xuXHRcdGlmKHR5cGVvZiB0aGlzLm9wdGlvbnMob2xkT3B0aW9uKSAhPT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0XHR0aGlzLl93YXJuVXNlcihcIiVjRGVwcmVjYXRlZCBTZXR1cCBPcHRpb24gLSBVc2Ugb2YgdGhlICVjXCIgKyBvbGRPcHRpb24gKyBcIiAlYyBvcHRpb24gaXMgbm93IGRlcHJlY2F0ZWQsIFwiICsgbXNnLCAnZm9udC13ZWlnaHQ6IG5vcm1hbDsnLCAnZm9udC13ZWlnaHQ6IGJvbGQ7JywgJ2ZvbnQtd2VpZ2h0OiBub3JtYWw7Jyk7XG5cdFx0XHRcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0XG5cdG1zZyhtc2cpe1xuXHRcdHRoaXMuX3dhcm5Vc2VyKG1zZyk7XG5cdH1cbn1cblxuY2xhc3MgRGVwZW5kZW5jeVJlZ2lzdHJ5IGV4dGVuZHMgQ29yZUZlYXR1cmV7XHJcblx0XHJcblx0Y29uc3RydWN0b3IodGFibGUpe1xyXG5cdFx0c3VwZXIodGFibGUpO1xyXG5cdFx0XHJcblx0XHR0aGlzLmRlcHMgPSB7fTtcclxuXHRcdFxyXG5cdFx0dGhpcy5wcm9wcyA9IHtcclxuXHRcdFx0XHJcblx0XHR9O1xyXG5cdH1cclxuXHRcclxuXHRpbml0aWFsaXplKCl7XHJcblx0XHR0aGlzLmRlcHMgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLm9wdGlvbnMoXCJkZXBlbmRlbmNpZXNcIikpO1xyXG5cdH1cclxuXHRcclxuXHRsb29rdXAoa2V5LCBwcm9wLCBzaWxlbnQpe1xyXG5cdFx0aWYoQXJyYXkuaXNBcnJheShrZXkpKXtcclxuXHRcdFx0Zm9yIChjb25zdCBpdGVtIG9mIGtleSkge1xyXG5cdFx0XHRcdHZhciBtYXRjaCA9IHRoaXMubG9va3VwKGl0ZW0sIHByb3AsIHRydWUpO1xyXG5cclxuXHRcdFx0XHRpZihtYXRjaCl7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKG1hdGNoKXtcclxuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7XHJcblx0XHRcdH1lbHNlIHtcclxuXHRcdFx0XHR0aGlzLmVycm9yKGtleSk7XHJcblx0XHRcdH1cclxuXHRcdH1lbHNlIHtcclxuXHRcdFx0aWYocHJvcCl7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMubG9va3VwUHJvcChrZXksIHByb3AsIHNpbGVudCk7XHJcblx0XHRcdH1lbHNlIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5sb29rdXBLZXkoa2V5LCBzaWxlbnQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGxvb2t1cFByb3Aoa2V5LCBwcm9wLCBzaWxlbnQpe1xyXG5cdFx0dmFyIGRlcGVuZGVuY3k7XHJcblx0XHRcclxuXHRcdGlmKHRoaXMucHJvcHNba2V5XSAmJiB0aGlzLnByb3BzW2tleV1bcHJvcF0pe1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5wcm9wc1trZXldW3Byb3BdO1xyXG5cdFx0fWVsc2Uge1xyXG5cdFx0XHRkZXBlbmRlbmN5ID0gdGhpcy5sb29rdXBLZXkoa2V5LCBzaWxlbnQpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYoZGVwZW5kZW5jeSl7XHJcblx0XHRcdFx0aWYoIXRoaXMucHJvcHNba2V5XSl7XHJcblx0XHRcdFx0XHR0aGlzLnByb3BzW2tleV0gPSB7fTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0dGhpcy5wcm9wc1trZXldW3Byb3BdID0gZGVwZW5kZW5jeVtwcm9wXSB8fCBkZXBlbmRlbmN5O1xyXG5cdFx0XHRcdHJldHVybiB0aGlzLnByb3BzW2tleV1bcHJvcF07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0bG9va3VwS2V5KGtleSwgc2lsZW50KXtcclxuXHRcdHZhciBkZXBlbmRlbmN5O1xyXG5cdFx0XHJcblx0XHRpZih0aGlzLmRlcHNba2V5XSl7XHJcblx0XHRcdGRlcGVuZGVuY3kgPSB0aGlzLmRlcHNba2V5XTtcclxuXHRcdH1lbHNlIGlmKHdpbmRvd1trZXldKXtcclxuXHRcdFx0dGhpcy5kZXBzW2tleV0gPSB3aW5kb3dba2V5XTtcclxuXHRcdFx0ZGVwZW5kZW5jeSA9IHRoaXMuZGVwc1trZXldO1xyXG5cdFx0fWVsc2Uge1xyXG5cdFx0XHRpZighc2lsZW50KXtcclxuXHRcdFx0XHR0aGlzLmVycm9yKGtleSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0cmV0dXJuIGRlcGVuZGVuY3k7XHJcblx0fVxyXG5cclxuXHRlcnJvcihrZXkpe1xyXG5cdFx0Y29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBmaW5kIGRlcGVuZGVuY3lcIiwga2V5LCBcIlBsZWFzZSBjaGVjayBkb2N1bWVudGF0aW9uIGFuZCBlbnN1cmUgeW91IGhhdmUgaW1wb3J0ZWQgdGhlIHJlcXVpcmVkIGxpYnJhcnkgaW50byB5b3VyIHByb2plY3RcIik7XHJcblx0fVxyXG59XG5cbi8vcmVzaXplIGNvbHVtbnMgdG8gZml0IGRhdGEgdGhleSBjb250YWluXG5mdW5jdGlvbiBmaXREYXRhKGNvbHVtbnMsIGZvcmNlZCl7XG5cdGlmKGZvcmNlZCl7XG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLnJlbmRlcmVyLnJlaW5pdGlhbGl6ZUNvbHVtbldpZHRocyhjb2x1bW5zKTtcblx0fVxuXHRcblx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZXNwb25zaXZlTGF5b3V0XCIsIHRydWUpKXtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC51cGRhdGUoKTtcblx0fVxufVxuXG4vL3Jlc2l6ZSBjb2x1bW5zIHRvIGZpdCBkYXRhIHRoZXkgY29udGFpbiBhbmQgc3RyZXRjaCByb3cgdG8gZmlsbCB0YWJsZSwgYWxzbyB1c2VkIGZvciBmaXREYXRhVGFibGVcbmZ1bmN0aW9uIGZpdERhdGFHZW5lcmFsKGNvbHVtbnMsIGZvcmNlZCl7XG5cdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdGNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHR9KTtcblxuXHRpZih0aGlzLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInJlc3BvbnNpdmVMYXlvdXRcIiwgdHJ1ZSkpe1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LnVwZGF0ZSgpO1xuXHR9XG59XG5cbi8vcmVzaXplIGNvbHVtbnMgdG8gZml0IGRhdGEgdGhlIGNvbnRhaW4gYW5kIHN0cmV0Y2ggbGFzdCBjb2x1bW4gdG8gZmlsbCB0YWJsZVxuZnVuY3Rpb24gZml0RGF0YVN0cmV0Y2goY29sdW1ucywgZm9yY2VkKXtcblx0dmFyIGNvbHNXaWR0aCA9IDAsXG5cdHRhYmxlV2lkdGggPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRXaWR0aCxcblx0Z2FwID0gMCxcblx0bGFzdENvbCA9IGZhbHNlO1xuXG5cdGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uLCBpKSA9PiB7XG5cdFx0aWYoIWNvbHVtbi53aWR0aEZpeGVkKXtcblx0XHRcdGNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHRcdH1cblxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0ID8gY29sdW1uLm1vZHVsZXMucmVzcG9uc2l2ZS52aXNpYmxlIDogY29sdW1uLnZpc2libGUpe1xuXHRcdFx0bGFzdENvbCA9IGNvbHVtbjtcblx0XHR9XG5cblx0XHRpZihjb2x1bW4udmlzaWJsZSl7XG5cdFx0XHRjb2xzV2lkdGggKz0gY29sdW1uLmdldFdpZHRoKCk7XG5cdFx0fVxuXHR9KTtcblxuXHRpZihsYXN0Q29sKXtcblx0XHRnYXAgPSB0YWJsZVdpZHRoIC0gY29sc1dpZHRoICsgbGFzdENvbC5nZXRXaWR0aCgpO1xuXG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZXNwb25zaXZlTGF5b3V0XCIsIHRydWUpKXtcblx0XHRcdGxhc3RDb2wuc2V0V2lkdGgoMCk7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC51cGRhdGUoKTtcblx0XHR9XG5cblx0XHRpZihnYXAgPiAwKXtcblx0XHRcdGxhc3RDb2wuc2V0V2lkdGgoZ2FwKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRsYXN0Q29sLnJlaW5pdGlhbGl6ZVdpZHRoKCk7XG5cdFx0fVxuXHR9ZWxzZSB7XG5cdFx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZXNwb25zaXZlTGF5b3V0XCIsIHRydWUpKXtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LnVwZGF0ZSgpO1xuXHRcdH1cblx0fVxufVxuXG4vL3Jlc2l6ZSBjb2x1bW5zIHRvIGZpdFxuZnVuY3Rpb24gZml0Q29sdW1ucyhjb2x1bW5zLCBmb3JjZWQpe1xuXHR2YXIgdG90YWxXaWR0aCA9IHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoOyAvL3RhYmxlIGVsZW1lbnQgd2lkdGhcblx0dmFyIGZpeGVkV2lkdGggPSAwOyAvL3RvdGFsIHdpZHRoIG9mIGNvbHVtbnMgd2l0aCBhIGRlZmluZWQgd2lkdGhcblx0dmFyIGZsZXhXaWR0aCA9IDA7IC8vdG90YWwgd2lkdGggYXZhaWxhYmxlIHRvIGZsZXhpYmxlIGNvbHVtbnNcblx0dmFyIGZsZXhHcm93VW5pdHMgPSAwOyAvL3RvdGFsIG51bWJlciBvZiB3aWR0aEdyb3cgYmxvY2tzIGFjcm9zcyBhbGwgY29sdW1uc1xuXHR2YXIgZmxleENvbFdpZHRoID0gMDsgLy9kZXNpcmVkIHdpZHRoIG9mIGZsZXhpYmxlIGNvbHVtbnNcblx0dmFyIGZsZXhDb2x1bW5zID0gW107IC8vYXJyYXkgb2YgZmxleGlibGUgd2lkdGggY29sdW1uc1xuXHR2YXIgZml4ZWRTaHJpbmtDb2x1bW5zID0gW107IC8vYXJyYXkgb2YgZml4ZWQgd2lkdGggY29sdW1ucyB0aGF0IGNhbiBzaHJpbmtcblx0dmFyIGZsZXhTaHJpbmtVbml0cyA9IDA7IC8vdG90YWwgbnVtYmVyIG9mIHdpZHRoU2hyaW5rIGJsb2NrcyBhY3Jvc3MgYWxsIGNvbHVtbnNcblx0dmFyIG92ZXJmbG93V2lkdGggPSAwOyAvL2hvcml6b250YWwgb3ZlcmZsb3cgd2lkdGhcblx0dmFyIGdhcEZpbGwgPSAwOyAvL251bWJlciBvZiBwaXhlbHMgdG8gYmUgYWRkZWQgdG8gZmluYWwgY29sdW1uIHRvIGNsb3NlIGFuZCBoYWxmIHBpeGVsIGdhcHNcblxuXHRmdW5jdGlvbiBjYWxjV2lkdGgod2lkdGgpe1xuXHRcdHZhciBjb2xXaWR0aDtcblxuXHRcdGlmKHR5cGVvZih3aWR0aCkgPT0gXCJzdHJpbmdcIil7XG5cdFx0XHRpZih3aWR0aC5pbmRleE9mKFwiJVwiKSA+IC0xKXtcblx0XHRcdFx0Y29sV2lkdGggPSAodG90YWxXaWR0aCAvIDEwMCkgKiBwYXJzZUludCh3aWR0aCk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGNvbFdpZHRoID0gcGFyc2VJbnQod2lkdGgpO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNvbFdpZHRoID0gd2lkdGg7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbFdpZHRoO1xuXHR9XG5cblx0Ly9lbnN1cmUgY29sdW1ucyByZXNpemUgdG8gdGFrZSB1cCB0aGUgY29ycmVjdCBhbW91bnQgb2Ygc3BhY2Vcblx0ZnVuY3Rpb24gc2NhbGVDb2x1bW5zKGNvbHVtbnMsIGZyZWVTcGFjZSwgY29sV2lkdGgsIHNocmlua0NvbHMpe1xuXHRcdHZhciBvdmVyc2l6ZUNvbHMgPSBbXSxcblx0XHRvdmVyc2l6ZVNwYWNlID0gMCxcblx0XHRyZW1haW5pbmdTcGFjZSA9IDAsXG5cdFx0bmV4dENvbFdpZHRoID0gMCxcblx0XHRyZW1haW5pbmdGbGV4R3Jvd1VuaXRzID0gZmxleEdyb3dVbml0cyxcblx0XHRnYXAgPSAwLFxuXHRcdGNoYW5nZVVuaXRzID0gMCxcblx0XHR1bmRlcnNpemVDb2xzID0gW107XG5cblx0XHRmdW5jdGlvbiBjYWxjR3Jvdyhjb2wpe1xuXHRcdFx0cmV0dXJuIChjb2xXaWR0aCAqIChjb2wuY29sdW1uLmRlZmluaXRpb24ud2lkdGhHcm93IHx8IDEpKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjYWxjU2hyaW5rKGNvbCl7XG5cdFx0XHRyZXR1cm4gIChjYWxjV2lkdGgoY29sLndpZHRoKSAtIChjb2xXaWR0aCAqIChjb2wuY29sdW1uLmRlZmluaXRpb24ud2lkdGhTaHJpbmsgfHwgMCkpKTtcblx0XHR9XG5cblx0XHRjb2x1bW5zLmZvckVhY2goZnVuY3Rpb24oY29sLCBpKXtcblx0XHRcdHZhciB3aWR0aCA9IHNocmlua0NvbHMgPyBjYWxjU2hyaW5rKGNvbCkgOiBjYWxjR3Jvdyhjb2wpO1xuXHRcdFx0aWYoY29sLmNvbHVtbi5taW5XaWR0aCA+PSB3aWR0aCl7XG5cdFx0XHRcdG92ZXJzaXplQ29scy5wdXNoKGNvbCk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGlmKGNvbC5jb2x1bW4ubWF4V2lkdGggJiYgY29sLmNvbHVtbi5tYXhXaWR0aCA8IHdpZHRoKXtcblx0XHRcdFx0XHRjb2wud2lkdGggPSBjb2wuY29sdW1uLm1heFdpZHRoO1xuXHRcdFx0XHRcdGZyZWVTcGFjZSAtPSBjb2wuY29sdW1uLm1heFdpZHRoO1xuXG5cdFx0XHRcdFx0cmVtYWluaW5nRmxleEdyb3dVbml0cyAtPSBzaHJpbmtDb2xzID8gKGNvbC5jb2x1bW4uZGVmaW5pdGlvbi53aWR0aFNocmluayB8fCAxKSA6IChjb2wuY29sdW1uLmRlZmluaXRpb24ud2lkdGhHcm93IHx8IDEpO1xuXG5cdFx0XHRcdFx0aWYocmVtYWluaW5nRmxleEdyb3dVbml0cyl7XG5cdFx0XHRcdFx0XHRjb2xXaWR0aCA9IE1hdGguZmxvb3IoZnJlZVNwYWNlL3JlbWFpbmluZ0ZsZXhHcm93VW5pdHMpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHVuZGVyc2l6ZUNvbHMucHVzaChjb2wpO1xuXHRcdFx0XHRcdGNoYW5nZVVuaXRzICs9IHNocmlua0NvbHMgPyAoY29sLmNvbHVtbi5kZWZpbml0aW9uLndpZHRoU2hyaW5rIHx8IDEpIDogKGNvbC5jb2x1bW4uZGVmaW5pdGlvbi53aWR0aEdyb3cgfHwgMSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGlmKG92ZXJzaXplQ29scy5sZW5ndGgpe1xuXHRcdFx0b3ZlcnNpemVDb2xzLmZvckVhY2goZnVuY3Rpb24oY29sKXtcblx0XHRcdFx0b3ZlcnNpemVTcGFjZSArPSBzaHJpbmtDb2xzID8gIGNvbC53aWR0aCAtIGNvbC5jb2x1bW4ubWluV2lkdGggOiBjb2wuY29sdW1uLm1pbldpZHRoO1xuXHRcdFx0XHRjb2wud2lkdGggPSBjb2wuY29sdW1uLm1pbldpZHRoO1xuXHRcdFx0fSk7XG5cblx0XHRcdHJlbWFpbmluZ1NwYWNlID0gZnJlZVNwYWNlIC0gb3ZlcnNpemVTcGFjZTtcblxuXHRcdFx0bmV4dENvbFdpZHRoID0gY2hhbmdlVW5pdHMgPyBNYXRoLmZsb29yKHJlbWFpbmluZ1NwYWNlL2NoYW5nZVVuaXRzKSA6IHJlbWFpbmluZ1NwYWNlO1xuXG5cdFx0XHRnYXAgPSBzY2FsZUNvbHVtbnModW5kZXJzaXplQ29scywgcmVtYWluaW5nU3BhY2UsIG5leHRDb2xXaWR0aCwgc2hyaW5rQ29scyk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Z2FwID0gY2hhbmdlVW5pdHMgPyBmcmVlU3BhY2UgLSAoTWF0aC5mbG9vcihmcmVlU3BhY2UvY2hhbmdlVW5pdHMpICogY2hhbmdlVW5pdHMpIDogZnJlZVNwYWNlO1xuXG5cdFx0XHR1bmRlcnNpemVDb2xzLmZvckVhY2goZnVuY3Rpb24oY29sdW1uKXtcblx0XHRcdFx0Y29sdW1uLndpZHRoID0gc2hyaW5rQ29scyA/IGNhbGNTaHJpbmsoY29sdW1uKSA6IGNhbGNHcm93KGNvbHVtbik7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZ2FwO1xuXHR9XG5cblx0aWYodGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZXNwb25zaXZlTGF5b3V0XCIsIHRydWUpKXtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC51cGRhdGUoKTtcblx0fVxuXG5cdC8vYWRqdXN0IGZvciB2ZXJ0aWNhbCBzY3JvbGxiYXIgaWYgcHJlc2VudFxuXHRpZih0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxIZWlnaHQgPiB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRIZWlnaHQpe1xuXHRcdHRvdGFsV2lkdGggLT0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQub2Zmc2V0V2lkdGggLSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRXaWR0aDtcblx0fVxuXG5cdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2x1bW4pe1xuXHRcdHZhciB3aWR0aCwgbWluV2lkdGgsIGNvbFdpZHRoO1xuXG5cdFx0aWYoY29sdW1uLnZpc2libGUpe1xuXG5cdFx0XHR3aWR0aCA9IGNvbHVtbi5kZWZpbml0aW9uLndpZHRoO1xuXHRcdFx0bWluV2lkdGggPSAgcGFyc2VJbnQoY29sdW1uLm1pbldpZHRoKTtcblxuXHRcdFx0aWYod2lkdGgpe1xuXG5cdFx0XHRcdGNvbFdpZHRoID0gY2FsY1dpZHRoKHdpZHRoKTtcblxuXHRcdFx0XHRmaXhlZFdpZHRoICs9IGNvbFdpZHRoID4gbWluV2lkdGggPyBjb2xXaWR0aCA6IG1pbldpZHRoO1xuXG5cdFx0XHRcdGlmKGNvbHVtbi5kZWZpbml0aW9uLndpZHRoU2hyaW5rKXtcblx0XHRcdFx0XHRmaXhlZFNocmlua0NvbHVtbnMucHVzaCh7XG5cdFx0XHRcdFx0XHRjb2x1bW46Y29sdW1uLFxuXHRcdFx0XHRcdFx0d2lkdGg6Y29sV2lkdGggPiBtaW5XaWR0aCA/IGNvbFdpZHRoIDogbWluV2lkdGhcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRmbGV4U2hyaW5rVW5pdHMgKz0gY29sdW1uLmRlZmluaXRpb24ud2lkdGhTaHJpbms7XG5cdFx0XHRcdH1cblxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRmbGV4Q29sdW1ucy5wdXNoKHtcblx0XHRcdFx0XHRjb2x1bW46Y29sdW1uLFxuXHRcdFx0XHRcdHdpZHRoOjAsXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRmbGV4R3Jvd1VuaXRzICs9IGNvbHVtbi5kZWZpbml0aW9uLndpZHRoR3JvdyB8fCAxO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0Ly9jYWxjdWxhdGUgYXZhaWxhYmxlIHNwYWNlXG5cdGZsZXhXaWR0aCA9IHRvdGFsV2lkdGggLSBmaXhlZFdpZHRoO1xuXG5cdC8vY2FsY3VsYXRlIGNvcnJlY3QgY29sdW1uIHNpemVcblx0ZmxleENvbFdpZHRoID0gTWF0aC5mbG9vcihmbGV4V2lkdGggLyBmbGV4R3Jvd1VuaXRzKTtcblxuXHQvL2dlbmVyYXRlIGNvbHVtbiB3aWR0aHNcblx0Z2FwRmlsbCA9IHNjYWxlQ29sdW1ucyhmbGV4Q29sdW1ucywgZmxleFdpZHRoLCBmbGV4Q29sV2lkdGgsIGZhbHNlKTtcblxuXHQvL2luY3JlYXNlIHdpZHRoIG9mIGxhc3QgY29sdW1uIHRvIGFjY291bnQgZm9yIHJvdW5kaW5nIGVycm9yc1xuXHRpZihmbGV4Q29sdW1ucy5sZW5ndGggJiYgZ2FwRmlsbCA+IDApe1xuXHRcdGZsZXhDb2x1bW5zW2ZsZXhDb2x1bW5zLmxlbmd0aC0xXS53aWR0aCArPSBnYXBGaWxsO1xuXHR9XG5cblx0Ly9jYWxjdWxhdGUgc3BhY2UgZm9yIGNvbHVtbnMgdG8gYmUgc2hydW5rIGludG9cblx0ZmxleENvbHVtbnMuZm9yRWFjaChmdW5jdGlvbihjb2wpe1xuXHRcdGZsZXhXaWR0aCAtPSBjb2wud2lkdGg7XG5cdH0pO1xuXG5cdG92ZXJmbG93V2lkdGggPSBNYXRoLmFicyhnYXBGaWxsKSArIGZsZXhXaWR0aDtcblxuXHQvL3NocmluayBvdmVyc2l6ZSBjb2x1bW5zIGlmIHRoZXJlIGlzIG5vIGF2YWlsYWJsZSBzcGFjZVxuXHRpZihvdmVyZmxvd1dpZHRoID4gMCAmJiBmbGV4U2hyaW5rVW5pdHMpe1xuXHRcdGdhcEZpbGwgPSBzY2FsZUNvbHVtbnMoZml4ZWRTaHJpbmtDb2x1bW5zLCBvdmVyZmxvd1dpZHRoLCBNYXRoLmZsb29yKG92ZXJmbG93V2lkdGggLyBmbGV4U2hyaW5rVW5pdHMpLCB0cnVlKTtcblx0fVxuXG5cdC8vZGVjcmVhc2Ugd2lkdGggb2YgbGFzdCBjb2x1bW4gdG8gYWNjb3VudCBmb3Igcm91bmRpbmcgZXJyb3JzXG5cdGlmKGdhcEZpbGwgJiYgZml4ZWRTaHJpbmtDb2x1bW5zLmxlbmd0aCl7XG5cdFx0Zml4ZWRTaHJpbmtDb2x1bW5zW2ZpeGVkU2hyaW5rQ29sdW1ucy5sZW5ndGgtMV0ud2lkdGggLT0gZ2FwRmlsbDtcblx0fVxuXG5cdGZsZXhDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24oY29sKXtcblx0XHRjb2wuY29sdW1uLnNldFdpZHRoKGNvbC53aWR0aCk7XG5cdH0pO1xuXG5cdGZpeGVkU2hyaW5rQ29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbCl7XG5cdFx0Y29sLmNvbHVtbi5zZXRXaWR0aChjb2wud2lkdGgpO1xuXHR9KTtcbn1cblxudmFyIGRlZmF1bHRNb2RlcyA9IHtcblx0Zml0RGF0YTpmaXREYXRhLFxuXHRmaXREYXRhRmlsbDpmaXREYXRhR2VuZXJhbCxcblx0Zml0RGF0YVRhYmxlOmZpdERhdGFHZW5lcmFsLFxuXHRmaXREYXRhU3RyZXRjaDpmaXREYXRhU3RyZXRjaCxcblx0Zml0Q29sdW1uczpmaXRDb2x1bW5zICxcbn07XG5cbmNsYXNzIExheW91dCBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwibGF5b3V0XCI7XG5cblx0Ly9sb2FkIGRlZmF1bHRzXG5cdHN0YXRpYyBtb2RlcyA9IGRlZmF1bHRNb2RlcztcblxuXHRjb25zdHJ1Y3Rvcih0YWJsZSl7XG5cdFx0c3VwZXIodGFibGUsIFwibGF5b3V0XCIpO1xuXG5cdFx0dGhpcy5tb2RlID0gbnVsbDtcblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImxheW91dFwiLCBcImZpdERhdGFcIik7IC8vbGF5b3V0IHR5cGVcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJsYXlvdXRDb2x1bW5zT25OZXdEYXRhXCIsIGZhbHNlKTsgLy91cGRhdGUgY29sdW1uIHdpZHRocyBvbiBzZXREYXRhXG5cblx0XHR0aGlzLnJlZ2lzdGVyQ29sdW1uT3B0aW9uKFwid2lkdGhHcm93XCIpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb2x1bW5PcHRpb24oXCJ3aWR0aFNocmlua1wiKTtcblx0fVxuXG5cdC8vaW5pdGlhbGl6ZSBsYXlvdXQgc3lzdGVtXG5cdGluaXRpYWxpemUoKXtcblx0XHR2YXIgbGF5b3V0ID0gdGhpcy50YWJsZS5vcHRpb25zLmxheW91dDtcblxuXHRcdGlmKExheW91dC5tb2Rlc1tsYXlvdXRdKXtcblx0XHRcdHRoaXMubW9kZSA9IGxheW91dDtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJMYXlvdXQgRXJyb3IgLSBpbnZhbGlkIG1vZGUgc2V0LCBkZWZhdWx0aW5nIHRvICdmaXREYXRhJyA6IFwiICsgbGF5b3V0KTtcblx0XHRcdHRoaXMubW9kZSA9ICdmaXREYXRhJztcblx0XHR9XG5cblx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGFidWxhdG9yLWxheW91dFwiLCB0aGlzLm1vZGUpO1xuXHRcdHRoaXMuc3Vic2NyaWJlKFwiY29sdW1uLWluaXRcIiwgdGhpcy5pbml0aWFsaXplQ29sdW1uLmJpbmQodGhpcykpO1xuXHR9XG5cblx0aW5pdGlhbGl6ZUNvbHVtbihjb2x1bW4pe1xuXHRcdGlmKGNvbHVtbi5kZWZpbml0aW9uLndpZHRoR3Jvdyl7XG5cdFx0XHRjb2x1bW4uZGVmaW5pdGlvbi53aWR0aEdyb3cgPSBOdW1iZXIoY29sdW1uLmRlZmluaXRpb24ud2lkdGhHcm93KTtcblx0XHR9XG5cdFx0aWYoY29sdW1uLmRlZmluaXRpb24ud2lkdGhTaHJpbmspe1xuXHRcdFx0Y29sdW1uLmRlZmluaXRpb24ud2lkdGhTaHJpbmsgPSBOdW1iZXIoY29sdW1uLmRlZmluaXRpb24ud2lkdGhTaHJpbmspO1xuXHRcdH1cblx0fVxuXG5cdGdldE1vZGUoKXtcblx0XHRyZXR1cm4gdGhpcy5tb2RlO1xuXHR9XG5cblx0Ly90cmlnZ2VyIHRhYmxlIGxheW91dFxuXHRsYXlvdXQoZGF0YUNoYW5nZWQpe1xuXG5cdFx0dmFyIHZhcmlhYmxlSGVpZ2h0ID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZpbmQoKGNvbHVtbikgPT4gY29sdW1uLmRlZmluaXRpb24udmFyaWFibGVIZWlnaHQgfHwgY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyID09PSBcInRleHRhcmVhXCIpO1xuXHRcdFxuXHRcdHRoaXMuZGlzcGF0Y2goXCJsYXlvdXQtcmVmcmVzaGluZ1wiKTtcblx0XHRMYXlvdXQubW9kZXNbdGhpcy5tb2RlXS5jYWxsKHRoaXMsIHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5jb2x1bW5zQnlJbmRleCwgZGF0YUNoYW5nZWQpO1xuXG5cdFx0aWYodmFyaWFibGVIZWlnaHQpe1xuXHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLm5vcm1hbGl6ZUhlaWdodCh0cnVlKTtcblx0XHR9XG5cblx0XHR0aGlzLmRpc3BhdGNoKFwibGF5b3V0LXJlZnJlc2hlZFwiKTtcblx0fVxufVxuXG52YXIgZGVmYXVsdExhbmdzID0ge1xuXHRcImRlZmF1bHRcIjp7IC8vaG9sZCBkZWZhdWx0IGxvY2FsZSB0ZXh0XG5cdFx0XCJncm91cHNcIjp7XG5cdFx0XHRcIml0ZW1cIjpcIml0ZW1cIixcblx0XHRcdFwiaXRlbXNcIjpcIml0ZW1zXCIsXG5cdFx0fSxcblx0XHRcImNvbHVtbnNcIjp7XG5cdFx0fSxcblx0XHRcImRhdGFcIjp7XG5cdFx0XHRcImxvYWRpbmdcIjpcIkxvYWRpbmdcIixcblx0XHRcdFwiZXJyb3JcIjpcIkVycm9yXCIsXG5cdFx0fSxcblx0XHRcInBhZ2luYXRpb25cIjp7XG5cdFx0XHRcInBhZ2Vfc2l6ZVwiOlwiUGFnZSBTaXplXCIsXG5cdFx0XHRcInBhZ2VfdGl0bGVcIjpcIlNob3cgUGFnZVwiLFxuXHRcdFx0XCJmaXJzdFwiOlwiRmlyc3RcIixcblx0XHRcdFwiZmlyc3RfdGl0bGVcIjpcIkZpcnN0IFBhZ2VcIixcblx0XHRcdFwibGFzdFwiOlwiTGFzdFwiLFxuXHRcdFx0XCJsYXN0X3RpdGxlXCI6XCJMYXN0IFBhZ2VcIixcblx0XHRcdFwicHJldlwiOlwiUHJldlwiLFxuXHRcdFx0XCJwcmV2X3RpdGxlXCI6XCJQcmV2IFBhZ2VcIixcblx0XHRcdFwibmV4dFwiOlwiTmV4dFwiLFxuXHRcdFx0XCJuZXh0X3RpdGxlXCI6XCJOZXh0IFBhZ2VcIixcblx0XHRcdFwiYWxsXCI6XCJBbGxcIixcblx0XHRcdFwiY291bnRlclwiOntcblx0XHRcdFx0XCJzaG93aW5nXCI6IFwiU2hvd2luZ1wiLFxuXHRcdFx0XHRcIm9mXCI6IFwib2ZcIixcblx0XHRcdFx0XCJyb3dzXCI6IFwicm93c1wiLFxuXHRcdFx0XHRcInBhZ2VzXCI6IFwicGFnZXNcIixcblx0XHRcdH1cblx0XHR9LFxuXHRcdFwiaGVhZGVyRmlsdGVyc1wiOntcblx0XHRcdFwiZGVmYXVsdFwiOlwiZmlsdGVyIGNvbHVtbi4uLlwiLFxuXHRcdFx0XCJjb2x1bW5zXCI6e31cblx0XHR9XG5cdH0sXG59O1xuXG5jbGFzcyBMb2NhbGl6ZSBleHRlbmRzIE1vZHVsZXtcblxuXHRzdGF0aWMgbW9kdWxlTmFtZSA9IFwibG9jYWxpemVcIjtcblxuXHQvL2xvYWQgZGVmYXVsdHNcblx0c3RhdGljIGxhbmdzID0gZGVmYXVsdExhbmdzO1xuXG5cdGNvbnN0cnVjdG9yKHRhYmxlKXtcblx0XHRzdXBlcih0YWJsZSk7XG5cblx0XHR0aGlzLmxvY2FsZSA9IFwiZGVmYXVsdFwiOyAvL2N1cnJlbnQgbG9jYWxlXG5cdFx0dGhpcy5sYW5nID0gZmFsc2U7IC8vY3VycmVudCBsYW5ndWFnZVxuXHRcdHRoaXMuYmluZGluZ3MgPSB7fTsgLy91cGRhdGUgZXZlbnRzIHRvIGNhbGwgd2hlbiBsb2NhbGUgaXMgY2hhbmdlZFxuXHRcdHRoaXMubGFuZ0xpc3QgPSB7fTtcblxuXHRcdHRoaXMucmVnaXN0ZXJUYWJsZU9wdGlvbihcImxvY2FsZVwiLCBmYWxzZSk7IC8vY3VycmVudCBzeXN0ZW0gbGFuZ3VhZ2Vcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVPcHRpb24oXCJsYW5nc1wiLCB7fSk7XG5cdH1cblxuXHRpbml0aWFsaXplKCl7XG5cdFx0dGhpcy5sYW5nTGlzdCA9IEhlbHBlcnMuZGVlcENsb25lKExvY2FsaXplLmxhbmdzKTtcblxuXHRcdGlmKHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5EZWZhdWx0cy5oZWFkZXJGaWx0ZXJQbGFjZWhvbGRlciAhPT0gZmFsc2Upe1xuXHRcdFx0dGhpcy5zZXRIZWFkZXJGaWx0ZXJQbGFjZWhvbGRlcih0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1uRGVmYXVsdHMuaGVhZGVyRmlsdGVyUGxhY2Vob2xkZXIpO1xuXHRcdH1cblxuXHRcdGZvcihsZXQgbG9jYWxlIGluIHRoaXMudGFibGUub3B0aW9ucy5sYW5ncyl7XG5cdFx0XHR0aGlzLmluc3RhbGxMYW5nKGxvY2FsZSwgdGhpcy50YWJsZS5vcHRpb25zLmxhbmdzW2xvY2FsZV0pO1xuXHRcdH1cblxuXHRcdHRoaXMuc2V0TG9jYWxlKHRoaXMudGFibGUub3B0aW9ucy5sb2NhbGUpO1xuXG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJzZXRMb2NhbGVcIiwgdGhpcy5zZXRMb2NhbGUuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRMb2NhbGVcIiwgdGhpcy5nZXRMb2NhbGUuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlclRhYmxlRnVuY3Rpb24oXCJnZXRMYW5nXCIsIHRoaXMuZ2V0TGFuZy5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdC8vc2V0IGhlYWRlciBwbGFjZWhvbGRlclxuXHRzZXRIZWFkZXJGaWx0ZXJQbGFjZWhvbGRlcihwbGFjZWhvbGRlcil7XG5cdFx0dGhpcy5sYW5nTGlzdC5kZWZhdWx0LmhlYWRlckZpbHRlcnMuZGVmYXVsdCA9IHBsYWNlaG9sZGVyO1xuXHR9XG5cblx0Ly9zZXR1cCBhIGxhbmcgZGVzY3JpcHRpb24gb2JqZWN0XG5cdGluc3RhbGxMYW5nKGxvY2FsZSwgbGFuZyl7XG5cdFx0aWYodGhpcy5sYW5nTGlzdFtsb2NhbGVdKXtcblx0XHRcdHRoaXMuX3NldExhbmdQcm9wKHRoaXMubGFuZ0xpc3RbbG9jYWxlXSwgbGFuZyk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5sYW5nTGlzdFtsb2NhbGVdID0gbGFuZztcblx0XHR9XG5cdH1cblxuXHRfc2V0TGFuZ1Byb3AobGFuZywgdmFsdWVzKXtcblx0XHRmb3IobGV0IGtleSBpbiB2YWx1ZXMpe1xuXHRcdFx0aWYobGFuZ1trZXldICYmIHR5cGVvZiBsYW5nW2tleV0gPT0gXCJvYmplY3RcIil7XG5cdFx0XHRcdHRoaXMuX3NldExhbmdQcm9wKGxhbmdba2V5XSwgdmFsdWVzW2tleV0pO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRsYW5nW2tleV0gPSB2YWx1ZXNba2V5XTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvL3NldCBjdXJyZW50IGxvY2FsZVxuXHRzZXRMb2NhbGUoZGVzaXJlZExvY2FsZSl7XG5cdFx0ZGVzaXJlZExvY2FsZSA9IGRlc2lyZWRMb2NhbGUgfHwgXCJkZWZhdWx0XCI7XG5cblx0XHQvL2ZpbGwgaW4gYW55IG1hdGNoaW5nIGxhbmd1YWdlIHZhbHVlc1xuXHRcdGZ1bmN0aW9uIHRyYXZlcnNlTGFuZyh0cmFucywgcGF0aCl7XG5cdFx0XHRmb3IodmFyIHByb3AgaW4gdHJhbnMpe1xuXHRcdFx0XHRpZih0eXBlb2YgdHJhbnNbcHJvcF0gPT0gXCJvYmplY3RcIil7XG5cdFx0XHRcdFx0aWYoIXBhdGhbcHJvcF0pe1xuXHRcdFx0XHRcdFx0cGF0aFtwcm9wXSA9IHt9O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0cmF2ZXJzZUxhbmcodHJhbnNbcHJvcF0sIHBhdGhbcHJvcF0pO1xuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0cGF0aFtwcm9wXSA9IHRyYW5zW3Byb3BdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9kZXRlcm1pbmluZyBjb3JyZWN0IGxvY2FsZSB0byBsb2FkXG5cdFx0aWYoZGVzaXJlZExvY2FsZSA9PT0gdHJ1ZSAmJiBuYXZpZ2F0b3IubGFuZ3VhZ2Upe1xuXHRcdFx0Ly9nZXQgbG9jYWwgZnJvbSBzeXN0ZW1cblx0XHRcdGRlc2lyZWRMb2NhbGUgPSBuYXZpZ2F0b3IubGFuZ3VhZ2UudG9Mb3dlckNhc2UoKTtcblx0XHR9XG5cblx0XHRpZihkZXNpcmVkTG9jYWxlKXtcblx0XHRcdC8vaWYgbG9jYWxlIGlzIG5vdCBzZXQsIGNoZWNrIGZvciBtYXRjaGluZyB0b3AgbGV2ZWwgbG9jYWxlIGVsc2UgdXNlIGRlZmF1bHRcblx0XHRcdGlmKCF0aGlzLmxhbmdMaXN0W2Rlc2lyZWRMb2NhbGVdKXtcblx0XHRcdFx0bGV0IHByZWZpeCA9IGRlc2lyZWRMb2NhbGUuc3BsaXQoXCItXCIpWzBdO1xuXG5cdFx0XHRcdGlmKHRoaXMubGFuZ0xpc3RbcHJlZml4XSl7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiTG9jYWxpemF0aW9uIEVycm9yIC0gRXhhY3QgbWF0Y2hpbmcgbG9jYWxlIG5vdCBmb3VuZCwgdXNpbmcgY2xvc2VzdCBtYXRjaDogXCIsIGRlc2lyZWRMb2NhbGUsIHByZWZpeCk7XG5cdFx0XHRcdFx0ZGVzaXJlZExvY2FsZSA9IHByZWZpeDtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkxvY2FsaXphdGlvbiBFcnJvciAtIE1hdGNoaW5nIGxvY2FsZSBub3QgZm91bmQsIHVzaW5nIGRlZmF1bHQ6IFwiLCBkZXNpcmVkTG9jYWxlKTtcblx0XHRcdFx0XHRkZXNpcmVkTG9jYWxlID0gXCJkZWZhdWx0XCI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLmxvY2FsZSA9IGRlc2lyZWRMb2NhbGU7XG5cblx0XHQvL2xvYWQgZGVmYXVsdCBsYW5nIHRlbXBsYXRlXG5cdFx0dGhpcy5sYW5nID0gSGVscGVycy5kZWVwQ2xvbmUodGhpcy5sYW5nTGlzdC5kZWZhdWx0IHx8IHt9KTtcblxuXHRcdGlmKGRlc2lyZWRMb2NhbGUgIT0gXCJkZWZhdWx0XCIpe1xuXHRcdFx0dHJhdmVyc2VMYW5nKHRoaXMubGFuZ0xpc3RbZGVzaXJlZExvY2FsZV0sIHRoaXMubGFuZyk7XG5cdFx0fVxuXG5cdFx0dGhpcy5kaXNwYXRjaEV4dGVybmFsKFwibG9jYWxpemVkXCIsIHRoaXMubG9jYWxlLCB0aGlzLmxhbmcpO1xuXG5cdFx0dGhpcy5fZXhlY3V0ZUJpbmRpbmdzKCk7XG5cdH1cblxuXHQvL2dldCBjdXJyZW50IGxvY2FsZVxuXHRnZXRMb2NhbGUobG9jYWxlKXtcblx0XHRyZXR1cm4gdGhpcy5sb2NhbGU7XG5cdH1cblxuXHQvL2dldCBsYW5nIG9iamVjdCBmb3IgZ2l2ZW4gbG9jYWwgb3IgY3VycmVudCBpZiBub25lIHByb3ZpZGVkXG5cdGdldExhbmcobG9jYWxlKXtcblx0XHRyZXR1cm4gbG9jYWxlID8gdGhpcy5sYW5nTGlzdFtsb2NhbGVdIDogdGhpcy5sYW5nO1xuXHR9XG5cblx0Ly9nZXQgdGV4dCBmb3IgY3VycmVudCBsb2NhbGVcblx0Z2V0VGV4dChwYXRoLCB2YWx1ZSl7XG5cdFx0dmFyIGZpbGxQYXRoID0gdmFsdWUgPyBwYXRoICsgXCJ8XCIgKyB2YWx1ZSA6IHBhdGgsXG5cdFx0cGF0aEFycmF5ID0gZmlsbFBhdGguc3BsaXQoXCJ8XCIpLFxuXHRcdHRleHQgPSB0aGlzLl9nZXRMYW5nRWxlbWVudChwYXRoQXJyYXksIHRoaXMubG9jYWxlKTtcblxuXHRcdC8vIGlmKHRleHQgPT09IGZhbHNlKXtcblx0XHQvLyBcdGNvbnNvbGUud2FybihcIkxvY2FsaXphdGlvbiBFcnJvciAtIE1hdGNoaW5nIGxvY2FsaXplZCB0ZXh0IG5vdCBmb3VuZCBmb3IgZ2l2ZW4gcGF0aDogXCIsIHBhdGgpO1xuXHRcdC8vIH1cblxuXHRcdHJldHVybiB0ZXh0IHx8IFwiXCI7XG5cdH1cblxuXHQvL3RyYXZlcnNlIGxhbmdzIG9iamVjdCBhbmQgZmluZCBsb2NhbGl6ZWQgY29weVxuXHRfZ2V0TGFuZ0VsZW1lbnQocGF0aCwgbG9jYWxlKXtcblx0XHR2YXIgcm9vdCA9IHRoaXMubGFuZztcblxuXHRcdHBhdGguZm9yRWFjaChmdW5jdGlvbihsZXZlbCl7XG5cdFx0XHR2YXIgcm9vdFBhdGg7XG5cblx0XHRcdGlmKHJvb3Qpe1xuXHRcdFx0XHRyb290UGF0aCA9IHJvb3RbbGV2ZWxdO1xuXG5cdFx0XHRcdGlmKHR5cGVvZiByb290UGF0aCAhPSBcInVuZGVmaW5lZFwiKXtcblx0XHRcdFx0XHRyb290ID0gcm9vdFBhdGg7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHRyb290ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiByb290O1xuXHR9XG5cblx0Ly9zZXQgdXBkYXRlIGJpbmRpbmdcblx0YmluZChwYXRoLCBjYWxsYmFjayl7XG5cdFx0aWYoIXRoaXMuYmluZGluZ3NbcGF0aF0pe1xuXHRcdFx0dGhpcy5iaW5kaW5nc1twYXRoXSA9IFtdO1xuXHRcdH1cblxuXHRcdHRoaXMuYmluZGluZ3NbcGF0aF0ucHVzaChjYWxsYmFjayk7XG5cblx0XHRjYWxsYmFjayh0aGlzLmdldFRleHQocGF0aCksIHRoaXMubGFuZyk7XG5cdH1cblxuXHQvL2l0ZXJhdGUgdGhyb3VnaCBiaW5kaW5ncyBhbmQgdHJpZ2dlciB1cGRhdGVzXG5cdF9leGVjdXRlQmluZGluZ3MoKXtcblx0XHRmb3IobGV0IHBhdGggaW4gdGhpcy5iaW5kaW5ncyl7XG5cdFx0XHR0aGlzLmJpbmRpbmdzW3BhdGhdLmZvckVhY2goKGJpbmRpbmcpID0+IHtcblx0XHRcdFx0YmluZGluZyh0aGlzLmdldFRleHQocGF0aCksIHRoaXMubGFuZyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cbn1cblxuY2xhc3MgQ29tbXMgZXh0ZW5kcyBNb2R1bGV7XG5cblx0c3RhdGljIG1vZHVsZU5hbWUgPSBcImNvbW1zXCI7XG5cblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcblx0fVxuXG5cdGluaXRpYWxpemUoKXtcblx0XHR0aGlzLnJlZ2lzdGVyVGFibGVGdW5jdGlvbihcInRhYmxlQ29tbXNcIiwgdGhpcy5yZWNlaXZlLmJpbmQodGhpcykpO1xuXHR9XG5cblx0Z2V0Q29ubmVjdGlvbnMoc2VsZWN0b3JzKXtcblx0XHR2YXIgY29ubmVjdGlvbnMgPSBbXSxcblx0XHRjb25uZWN0aW9uO1xuXG5cdFx0Y29ubmVjdGlvbiA9IHRoaXMudGFibGUuY29uc3RydWN0b3IucmVnaXN0cnkubG9va3VwVGFibGUoc2VsZWN0b3JzKTtcblxuXHRcdGNvbm5lY3Rpb24uZm9yRWFjaCgoY29uKSA9Pntcblx0XHRcdGlmKHRoaXMudGFibGUgIT09IGNvbil7XG5cdFx0XHRcdGNvbm5lY3Rpb25zLnB1c2goY29uKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBjb25uZWN0aW9ucztcblx0fVxuXG5cdHNlbmQoc2VsZWN0b3JzLCBtb2R1bGUsIGFjdGlvbiwgZGF0YSl7XG5cdFx0dmFyIGNvbm5lY3Rpb25zID0gdGhpcy5nZXRDb25uZWN0aW9ucyhzZWxlY3RvcnMpO1xuXG5cdFx0Y29ubmVjdGlvbnMuZm9yRWFjaCgoY29ubmVjdGlvbikgPT4ge1xuXHRcdFx0Y29ubmVjdGlvbi50YWJsZUNvbW1zKHRoaXMudGFibGUuZWxlbWVudCwgbW9kdWxlLCBhY3Rpb24sIGRhdGEpO1xuXHRcdH0pO1xuXG5cdFx0aWYoIWNvbm5lY3Rpb25zLmxlbmd0aCAmJiBzZWxlY3RvcnMpe1xuXHRcdFx0Y29uc29sZS53YXJuKFwiVGFibGUgQ29ubmVjdGlvbiBFcnJvciAtIE5vIHRhYmxlcyBtYXRjaGluZyBzZWxlY3RvciBmb3VuZFwiLCBzZWxlY3RvcnMpO1xuXHRcdH1cblx0fVxuXG5cdHJlY2VpdmUodGFibGUsIG1vZHVsZSwgYWN0aW9uLCBkYXRhKXtcblx0XHRpZih0aGlzLnRhYmxlLm1vZEV4aXN0cyhtb2R1bGUpKXtcblx0XHRcdHJldHVybiB0aGlzLnRhYmxlLm1vZHVsZXNbbW9kdWxlXS5jb21tc1JlY2VpdmVkKHRhYmxlLCBhY3Rpb24sIGRhdGEpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkludGVyLXRhYmxlIENvbW1zIEVycm9yIC0gbm8gc3VjaCBtb2R1bGU6XCIsIG1vZHVsZSk7XG5cdFx0fVxuXHR9XG59XG5cbnZhciBjb3JlTW9kdWxlcyA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHtcblx0X19wcm90b19fOiBudWxsLFxuXHRDb21tc01vZHVsZTogQ29tbXMsXG5cdExheW91dE1vZHVsZTogTGF5b3V0LFxuXHRMb2NhbGl6ZU1vZHVsZTogTG9jYWxpemVcbn0pO1xuXG5jbGFzcyBUYWJsZVJlZ2lzdHJ5IHtcblx0c3RhdGljIHJlZ2lzdHJ5ID0ge1xuXHRcdHRhYmxlczpbXSxcblx0XHRcblx0XHRyZWdpc3Rlcih0YWJsZSl7XG5cdFx0XHRUYWJsZVJlZ2lzdHJ5LnJlZ2lzdHJ5LnRhYmxlcy5wdXNoKHRhYmxlKTtcblx0XHR9LFxuXHRcdFxuXHRcdGRlcmVnaXN0ZXIodGFibGUpe1xuXHRcdFx0dmFyIGluZGV4ID0gVGFibGVSZWdpc3RyeS5yZWdpc3RyeS50YWJsZXMuaW5kZXhPZih0YWJsZSk7XG5cdFx0XHRcblx0XHRcdGlmKGluZGV4ID4gLTEpe1xuXHRcdFx0XHRUYWJsZVJlZ2lzdHJ5LnJlZ2lzdHJ5LnRhYmxlcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0XG5cdFx0bG9va3VwVGFibGUocXVlcnksIHNpbGVudCl7XG5cdFx0XHR2YXIgcmVzdWx0cyA9IFtdLFxuXHRcdFx0bWF0Y2hlcywgbWF0Y2g7XG5cdFx0XHRcblx0XHRcdGlmKHR5cGVvZiBxdWVyeSA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHRcdG1hdGNoZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKG1hdGNoZXMubGVuZ3RoKXtcblx0XHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbWF0Y2hlcy5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdFx0XHRtYXRjaCA9IFRhYmxlUmVnaXN0cnkucmVnaXN0cnkubWF0Y2hFbGVtZW50KG1hdGNoZXNbaV0pO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZihtYXRjaCl7XG5cdFx0XHRcdFx0XHRcdHJlc3VsdHMucHVzaChtYXRjaCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fWVsc2UgaWYoKHR5cGVvZiBIVE1MRWxlbWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBxdWVyeSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB8fCBxdWVyeSBpbnN0YW5jZW9mIFRhYmxlUmVnaXN0cnkpe1xuXHRcdFx0XHRtYXRjaCA9IFRhYmxlUmVnaXN0cnkucmVnaXN0cnkubWF0Y2hFbGVtZW50KHF1ZXJ5KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKG1hdGNoKXtcblx0XHRcdFx0XHRyZXN1bHRzLnB1c2gobWF0Y2gpO1xuXHRcdFx0XHR9XG5cdFx0XHR9ZWxzZSBpZihBcnJheS5pc0FycmF5KHF1ZXJ5KSl7XG5cdFx0XHRcdHF1ZXJ5LmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG5cdFx0XHRcdFx0cmVzdWx0cyA9IHJlc3VsdHMuY29uY2F0KFRhYmxlUmVnaXN0cnkucmVnaXN0cnkubG9va3VwVGFibGUoaXRlbSkpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYoIXNpbGVudCl7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiVGFibGUgQ29ubmVjdGlvbiBFcnJvciAtIEludmFsaWQgU2VsZWN0b3JcIiwgcXVlcnkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdH0sXG5cdFx0XG5cdFx0bWF0Y2hFbGVtZW50KGVsZW1lbnQpe1xuXHRcdFx0cmV0dXJuIFRhYmxlUmVnaXN0cnkucmVnaXN0cnkudGFibGVzLmZpbmQoZnVuY3Rpb24odGFibGUpe1xuXHRcdFx0XHRyZXR1cm4gZWxlbWVudCBpbnN0YW5jZW9mIFRhYmxlUmVnaXN0cnkgPyB0YWJsZSA9PT0gZWxlbWVudCA6IHRhYmxlLmVsZW1lbnQgPT09IGVsZW1lbnQ7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0XHRcblx0c3RhdGljIGZpbmRUYWJsZShxdWVyeSl7XG5cdFx0dmFyIHJlc3VsdHMgPSBUYWJsZVJlZ2lzdHJ5LnJlZ2lzdHJ5Lmxvb2t1cFRhYmxlKHF1ZXJ5LCB0cnVlKTtcblx0XHRyZXR1cm4gQXJyYXkuaXNBcnJheShyZXN1bHRzKSAmJiAhcmVzdWx0cy5sZW5ndGggPyBmYWxzZSA6IHJlc3VsdHM7XG5cdH1cbn1cblxuY2xhc3MgTW9kdWxlQmluZGVyIGV4dGVuZHMgVGFibGVSZWdpc3RyeSB7XG5cdFxuXHRzdGF0aWMgbW9kdWxlQmluZGluZ3MgPSB7fTtcblx0c3RhdGljIG1vZHVsZUV4dGVuc2lvbnMgPSB7fTtcblx0c3RhdGljIG1vZHVsZXNSZWdpc3RlcmVkID0gZmFsc2U7XG5cdFxuXHRzdGF0aWMgZGVmYXVsdE1vZHVsZXMgPSBmYWxzZTtcblx0XG5cdGNvbnN0cnVjdG9yKCl7XG5cdFx0c3VwZXIoKTtcblx0fVxuXHRcblx0c3RhdGljIGluaXRpYWxpemVNb2R1bGVCaW5kZXIoZGVmYXVsdE1vZHVsZXMpe1xuXHRcdGlmKCFNb2R1bGVCaW5kZXIubW9kdWxlc1JlZ2lzdGVyZWQpe1xuXHRcdFx0TW9kdWxlQmluZGVyLm1vZHVsZXNSZWdpc3RlcmVkID0gdHJ1ZTtcblx0XHRcdE1vZHVsZUJpbmRlci5fcmVnaXN0ZXJNb2R1bGVzKGNvcmVNb2R1bGVzLCB0cnVlKTtcblx0XHRcdFxuXHRcdFx0aWYoZGVmYXVsdE1vZHVsZXMpe1xuXHRcdFx0XHRNb2R1bGVCaW5kZXIuX3JlZ2lzdGVyTW9kdWxlcyhkZWZhdWx0TW9kdWxlcyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRzdGF0aWMgX2V4dGVuZE1vZHVsZShuYW1lLCBwcm9wZXJ0eSwgdmFsdWVzKXtcblx0XHRpZihNb2R1bGVCaW5kZXIubW9kdWxlQmluZGluZ3NbbmFtZV0pe1xuXHRcdFx0dmFyIHNvdXJjZSA9IE1vZHVsZUJpbmRlci5tb2R1bGVCaW5kaW5nc1tuYW1lXVtwcm9wZXJ0eV07XG5cdFx0XHRcblx0XHRcdGlmKHNvdXJjZSl7XG5cdFx0XHRcdGlmKHR5cGVvZiB2YWx1ZXMgPT0gXCJvYmplY3RcIil7XG5cdFx0XHRcdFx0Zm9yKGxldCBrZXkgaW4gdmFsdWVzKXtcblx0XHRcdFx0XHRcdHNvdXJjZVtrZXldID0gdmFsdWVzW2tleV07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiTW9kdWxlIEVycm9yIC0gSW52YWxpZCB2YWx1ZSB0eXBlLCBpdCBtdXN0IGJlIGFuIG9iamVjdFwiKTtcblx0XHRcdFx0fVxuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJNb2R1bGUgRXJyb3IgLSBwcm9wZXJ0eSBkb2VzIG5vdCBleGlzdDpcIiwgcHJvcGVydHkpO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIk1vZHVsZSBFcnJvciAtIG1vZHVsZSBkb2VzIG5vdCBleGlzdDpcIiwgbmFtZSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRzdGF0aWMgX3JlZ2lzdGVyTW9kdWxlcyhtb2R1bGVzLCBjb3JlKXtcblx0XHR2YXIgbW9kcyA9IE9iamVjdC52YWx1ZXMobW9kdWxlcyk7XG5cdFx0XG5cdFx0aWYoY29yZSl7XG5cdFx0XHRtb2RzLmZvckVhY2goKG1vZCkgPT4ge1xuXHRcdFx0XHRtb2QucHJvdG90eXBlLm1vZHVsZUNvcmUgPSB0cnVlO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdE1vZHVsZUJpbmRlci5fcmVnaXN0ZXJNb2R1bGUobW9kcyk7XG5cdH1cblx0XG5cdHN0YXRpYyBfcmVnaXN0ZXJNb2R1bGUobW9kdWxlcyl7XG5cdFx0aWYoIUFycmF5LmlzQXJyYXkobW9kdWxlcykpe1xuXHRcdFx0bW9kdWxlcyA9IFttb2R1bGVzXTtcblx0XHR9XG5cdFx0XG5cdFx0bW9kdWxlcy5mb3JFYWNoKChtb2QpID0+IHtcblx0XHRcdE1vZHVsZUJpbmRlci5fcmVnaXN0ZXJNb2R1bGVCaW5kaW5nKG1vZCk7XG5cdFx0XHRNb2R1bGVCaW5kZXIuX3JlZ2lzdGVyTW9kdWxlRXh0ZW5zaW9ucyhtb2QpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRzdGF0aWMgX3JlZ2lzdGVyTW9kdWxlQmluZGluZyhtb2Qpe1xuXHRcdGlmKG1vZC5tb2R1bGVOYW1lKXtcblx0XHRcdE1vZHVsZUJpbmRlci5tb2R1bGVCaW5kaW5nc1ttb2QubW9kdWxlTmFtZV0gPSBtb2Q7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBiaW5kIG1vZHVsZSwgbm8gbW9kdWxlTmFtZSBkZWZpbmVkXCIsIG1vZC5tb2R1bGVOYW1lKTtcblx0XHR9XG5cdH1cblx0XG5cdHN0YXRpYyBfcmVnaXN0ZXJNb2R1bGVFeHRlbnNpb25zKG1vZCl7XG5cdFx0dmFyIGV4dGVuc2lvbnMgPSBtb2QubW9kdWxlRXh0ZW5zaW9ucztcblx0XHRcblx0XHRpZihtb2QubW9kdWxlRXh0ZW5zaW9ucyl7XG5cdFx0XHRmb3IgKGxldCBtb2RLZXkgaW4gZXh0ZW5zaW9ucykge1xuXHRcdFx0XHRsZXQgZXh0ID0gZXh0ZW5zaW9uc1ttb2RLZXldO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoTW9kdWxlQmluZGVyLm1vZHVsZUJpbmRpbmdzW21vZEtleV0pe1xuXHRcdFx0XHRcdGZvciAobGV0IHByb3BLZXkgaW4gZXh0KSB7XG5cdFx0XHRcdFx0XHRNb2R1bGVCaW5kZXIuX2V4dGVuZE1vZHVsZShtb2RLZXksIHByb3BLZXksIGV4dFtwcm9wS2V5XSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0aWYoIU1vZHVsZUJpbmRlci5tb2R1bGVFeHRlbnNpb25zW21vZEtleV0pe1xuXHRcdFx0XHRcdFx0TW9kdWxlQmluZGVyLm1vZHVsZUV4dGVuc2lvbnNbbW9kS2V5XSA9IHt9O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRmb3IgKGxldCBwcm9wS2V5IGluIGV4dCkge1xuXHRcdFx0XHRcdFx0aWYoIU1vZHVsZUJpbmRlci5tb2R1bGVFeHRlbnNpb25zW21vZEtleV1bcHJvcEtleV0pe1xuXHRcdFx0XHRcdFx0XHRNb2R1bGVCaW5kZXIubW9kdWxlRXh0ZW5zaW9uc1ttb2RLZXldW3Byb3BLZXldID0ge307XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdE9iamVjdC5hc3NpZ24oTW9kdWxlQmluZGVyLm1vZHVsZUV4dGVuc2lvbnNbbW9kS2V5XVtwcm9wS2V5XSwgZXh0W3Byb3BLZXldKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRNb2R1bGVCaW5kZXIuX2V4dGVuZE1vZHVsZUZyb21RdWV1ZShtb2QpO1xuXHR9XG5cdFxuXHRzdGF0aWMgX2V4dGVuZE1vZHVsZUZyb21RdWV1ZShtb2Qpe1xuXHRcdHZhciBleHRlbnNpb25zID0gTW9kdWxlQmluZGVyLm1vZHVsZUV4dGVuc2lvbnNbbW9kLm1vZHVsZU5hbWVdO1xuXHRcdFxuXHRcdGlmKGV4dGVuc2lvbnMpe1xuXHRcdFx0Zm9yIChsZXQgcHJvcEtleSBpbiBleHRlbnNpb25zKSB7XG5cdFx0XHRcdE1vZHVsZUJpbmRlci5fZXh0ZW5kTW9kdWxlKG1vZC5tb2R1bGVOYW1lLCBwcm9wS2V5LCBleHRlbnNpb25zW3Byb3BLZXldKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8vZW5zdXJlIHRoYXQgbW9kdWxlIGFyZSBib3VuZCB0byBpbnN0YW50aWF0ZWQgZnVuY3Rpb25cblx0X2JpbmRNb2R1bGVzKCl7XG5cdFx0dmFyIG9yZGVyZWRTdGFydE1vZHMgPSBbXSxcblx0XHRvcmRlcmVkRW5kTW9kcyA9IFtdLFxuXHRcdHVuT3JkZXJlZE1vZHMgPSBbXTtcblx0XHRcblx0XHR0aGlzLm1vZHVsZXMgPSB7fTtcblx0XHRcblx0XHRmb3IodmFyIG5hbWUgaW4gTW9kdWxlQmluZGVyLm1vZHVsZUJpbmRpbmdzKXtcblx0XHRcdGxldCBtb2QgPSBNb2R1bGVCaW5kZXIubW9kdWxlQmluZGluZ3NbbmFtZV07XG5cdFx0XHRsZXQgbW9kdWxlID0gbmV3IG1vZCh0aGlzKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5tb2R1bGVzW25hbWVdID0gbW9kdWxlO1xuXHRcdFx0XG5cdFx0XHRpZihtb2QucHJvdG90eXBlLm1vZHVsZUNvcmUpe1xuXHRcdFx0XHR0aGlzLm1vZHVsZXNDb3JlLnB1c2gobW9kdWxlKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0aWYobW9kLm1vZHVsZUluaXRPcmRlcil7XG5cdFx0XHRcdFx0aWYobW9kLm1vZHVsZUluaXRPcmRlciA8IDApe1xuXHRcdFx0XHRcdFx0b3JkZXJlZFN0YXJ0TW9kcy5wdXNoKG1vZHVsZSk7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0b3JkZXJlZEVuZE1vZHMucHVzaChtb2R1bGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHVuT3JkZXJlZE1vZHMucHVzaChtb2R1bGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdG9yZGVyZWRTdGFydE1vZHMuc29ydCgoYSwgYikgPT4gYS5tb2R1bGVJbml0T3JkZXIgPiBiLm1vZHVsZUluaXRPcmRlciA/IDEgOiAtMSk7XG5cdFx0b3JkZXJlZEVuZE1vZHMuc29ydCgoYSwgYikgPT4gYS5tb2R1bGVJbml0T3JkZXIgPiBiLm1vZHVsZUluaXRPcmRlciA/IDEgOiAtMSk7XG5cdFx0XG5cdFx0dGhpcy5tb2R1bGVzUmVndWxhciA9IG9yZGVyZWRTdGFydE1vZHMuY29uY2F0KHVuT3JkZXJlZE1vZHMuY29uY2F0KG9yZGVyZWRFbmRNb2RzKSk7XG5cdH1cbn1cblxuY2xhc3MgQWxlcnQgZXh0ZW5kcyBDb3JlRmVhdHVyZXtcblx0Y29uc3RydWN0b3IodGFibGUpe1xuXHRcdHN1cGVyKHRhYmxlKTtcbiAgICAgICAgXG5cdFx0dGhpcy5lbGVtZW50ID0gdGhpcy5fY3JlYXRlQWxlcnRFbGVtZW50KCk7XG5cdFx0dGhpcy5tc2dFbGVtZW50ID0gdGhpcy5fY3JlYXRlTXNnRWxlbWVudCgpO1xuXHRcdHRoaXMudHlwZSA9IG51bGw7XG4gICAgICAgIFxuXHRcdHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLm1zZ0VsZW1lbnQpO1xuXHR9XG4gICAgXG5cdF9jcmVhdGVBbGVydEVsZW1lbnQoKXtcblx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItYWxlcnRcIik7XG5cdFx0cmV0dXJuIGVsO1xuXHR9XG4gICAgXG5cdF9jcmVhdGVNc2dFbGVtZW50KCl7XG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWFsZXJ0LW1zZ1wiKTtcblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiYWxlcnRcIik7XG5cdFx0cmV0dXJuIGVsO1xuXHR9XG4gICAgXG5cdF90eXBlQ2xhc3MoKXtcblx0XHRyZXR1cm4gXCJ0YWJ1bGF0b3ItYWxlcnQtc3RhdGUtXCIgKyB0aGlzLnR5cGU7XG5cdH1cbiAgICBcblx0YWxlcnQoY29udGVudCwgdHlwZSA9IFwibXNnXCIpe1xuXHRcdGlmKGNvbnRlbnQpe1xuXHRcdFx0dGhpcy5jbGVhcigpO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoKFwiYWxlcnQtc2hvd1wiLCB0eXBlKTtcbiAgICAgICAgICAgIFxuXHRcdFx0dGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgICAgIFxuXHRcdFx0d2hpbGUodGhpcy5tc2dFbGVtZW50LmZpcnN0Q2hpbGQpIHRoaXMubXNnRWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLm1zZ0VsZW1lbnQuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICBcblx0XHRcdHRoaXMubXNnRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3R5cGVDbGFzcygpKTtcbiAgICAgICAgICAgIFxuXHRcdFx0aWYodHlwZW9mIGNvbnRlbnQgPT09IFwiZnVuY3Rpb25cIil7XG5cdFx0XHRcdGNvbnRlbnQgPSBjb250ZW50KCk7XG5cdFx0XHR9XG4gICAgICAgICAgICBcblx0XHRcdGlmKGNvbnRlbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7XG5cdFx0XHRcdHRoaXMubXNnRWxlbWVudC5hcHBlbmRDaGlsZChjb250ZW50KTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0dGhpcy5tc2dFbGVtZW50LmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0XHR9XG4gICAgICAgICAgICBcblx0XHRcdHRoaXMudGFibGUuZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdH1cblx0fVxuICAgIFxuXHRjbGVhcigpe1xuXHRcdHRoaXMuZGlzcGF0Y2goXCJhbGVydC1oaWRlXCIsIHRoaXMudHlwZSk7XG5cblx0XHRpZih0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSl7XG5cdFx0XHR0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdH1cbiAgICAgICAgXG5cdFx0dGhpcy5tc2dFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fdHlwZUNsYXNzKCkpO1xuXHR9XG59XG5cbmNsYXNzIFRhYnVsYXRvciBleHRlbmRzIE1vZHVsZUJpbmRlcntcblxuXHQvL2RlZmF1bHQgc2V0dXAgb3B0aW9uc1xuXHRzdGF0aWMgZGVmYXVsdE9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcblxuXHRzdGF0aWMgZXh0ZW5kTW9kdWxlKCl7XG5cdFx0VGFidWxhdG9yLmluaXRpYWxpemVNb2R1bGVCaW5kZXIoKTtcblx0XHRUYWJ1bGF0b3IuX2V4dGVuZE1vZHVsZSguLi5hcmd1bWVudHMpO1xuXHR9XG5cblx0c3RhdGljIHJlZ2lzdGVyTW9kdWxlKCl7XG5cdFx0VGFidWxhdG9yLmluaXRpYWxpemVNb2R1bGVCaW5kZXIoKTtcblx0XHRUYWJ1bGF0b3IuX3JlZ2lzdGVyTW9kdWxlKC4uLmFyZ3VtZW50cyk7XG5cdH1cblxuXHRjb25zdHJ1Y3RvcihlbGVtZW50LCBvcHRpb25zLCBtb2R1bGVzKXtcblx0XHRzdXBlcigpO1xuXG5cdFx0VGFidWxhdG9yLmluaXRpYWxpemVNb2R1bGVCaW5kZXIobW9kdWxlcyk7XG5cblx0XHR0aGlzLm9wdGlvbnMgPSB7fTtcblx0XHRcblx0XHR0aGlzLmNvbHVtbk1hbmFnZXIgPSBudWxsOyAvLyBob2xkIENvbHVtbiBNYW5hZ2VyXG5cdFx0dGhpcy5yb3dNYW5hZ2VyID0gbnVsbDsgLy9ob2xkIFJvdyBNYW5hZ2VyXG5cdFx0dGhpcy5mb290ZXJNYW5hZ2VyID0gbnVsbDsgLy9ob2xkZXIgRm9vdGVyIE1hbmFnZXJcblx0XHR0aGlzLmFsZXJ0TWFuYWdlciA9IG51bGw7IC8vaG9sZCBBbGVydCBNYW5hZ2VyXG5cdFx0dGhpcy52ZG9tSG96ICA9IG51bGw7IC8vaG9sZGVyIGhvcml6b250YWwgdmlydHVhbCBkb21cblx0XHR0aGlzLmV4dGVybmFsRXZlbnRzID0gbnVsbDsgLy9oYW5kbGUgZXh0ZXJuYWwgZXZlbnQgbWVzc2FnaW5nXG5cdFx0dGhpcy5ldmVudEJ1cyA9IG51bGw7IC8vaGFuZGxlIGludGVybmFsIGV2ZW50IG1lc3NhZ2luZ1xuXHRcdHRoaXMuaW50ZXJhY3Rpb25Nb25pdG9yID0gZmFsc2U7IC8vdHJhY2sgdXNlciBpbnRlcmFjdGlvblxuXHRcdHRoaXMuYnJvd3NlciA9IFwiXCI7IC8vaG9sZCBjdXJyZW50IGJyb3dzZXIgdHlwZVxuXHRcdHRoaXMuYnJvd3NlclNsb3cgPSBmYWxzZTsgLy9oYW5kbGUgcmVkdWNlZCBmdW5jdGlvbmFsaXR5IGZvciBzbG93ZXIgYnJvd3NlcnNcblx0XHR0aGlzLmJyb3dzZXJNb2JpbGUgPSBmYWxzZTsgLy9jaGVjayBpZiBydW5uaW5nIG9uIG1vYmlsZSwgcHJldmVudCByZXNpemUgY2FuY2VsbGluZyBlZGl0IG9uIGtleWJvYXJkIGFwcGVhcmFuY2Vcblx0XHR0aGlzLnJ0bCA9IGZhbHNlOyAvL2NoZWNrIGlmIHRoZSB0YWJsZSBpcyBpbiBSVEwgbW9kZVxuXHRcdHRoaXMub3JpZ2luYWxFbGVtZW50ID0gbnVsbDsgLy9ob2xkIG9yaWdpbmFsIHRhYmxlIGVsZW1lbnQgaWYgaXQgaGFzIGJlZW4gcmVwbGFjZWRcblx0XHRcblx0XHR0aGlzLmNvbXBvbmVudEZ1bmN0aW9uQmluZGVyID0gbmV3IENvbXBvbmVudEZ1bmN0aW9uQmluZGVyKHRoaXMpOyAvL2JpbmQgY29tcG9uZW50IGZ1bmN0aW9uc1xuXHRcdHRoaXMuZGF0YUxvYWRlciA9IGZhbHNlOyAvL2JpbmQgY29tcG9uZW50IGZ1bmN0aW9uc1xuXHRcdFxuXHRcdHRoaXMubW9kdWxlcyA9IHt9OyAvL2hvbGQgYWxsIG1vZHVsZXMgYm91bmQgdG8gdGhpcyB0YWJsZVxuXHRcdHRoaXMubW9kdWxlc0NvcmUgPSBbXTsgLy9ob2xkIGNvcmUgbW9kdWxlcyBib3VuZCB0byB0aGlzIHRhYmxlIChmb3IgaW5pdGlhbGl6YXRpb24gcHVycG9zZXMpXG5cdFx0dGhpcy5tb2R1bGVzUmVndWxhciA9IFtdOyAvL2hvbGQgcmVndWxhciBtb2R1bGVzIGJvdW5kIHRvIHRoaXMgdGFibGUgKGZvciBpbml0aWFsaXphdGlvbiBwdXJwb3Nlcylcblx0XHRcblx0XHR0aGlzLmRlcHJlY2F0aW9uQWR2aXNvciA9IG5ldyBEZXByZWNhdGlvbkFkdmlzb3IodGhpcyk7XG5cdFx0dGhpcy5vcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdCh0aGlzLCBcInRhYmxlIGNvbnN0cnVjdG9yXCIpO1xuXG5cdFx0dGhpcy5kZXBlbmRlbmN5UmVnaXN0cnkgPSBuZXcgRGVwZW5kZW5jeVJlZ2lzdHJ5KHRoaXMpO1xuXHRcdFxuXHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR0aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xuXHRcdFxuXHRcdGlmKHRoaXMuaW5pdGlhbGl6ZUVsZW1lbnQoZWxlbWVudCkpe1xuXHRcdFx0XG5cdFx0XHR0aGlzLmluaXRpYWxpemVDb3JlU3lzdGVtcyhvcHRpb25zKTtcblx0XHRcdFxuXHRcdFx0Ly9kZWxheSB0YWJsZSBjcmVhdGlvbiB0byBhbGxvdyBldmVudCBiaW5kaW5ncyBpbW1lZGlhdGVseSBhZnRlciB0aGUgY29uc3RydWN0b3Jcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLl9jcmVhdGUoKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmNvbnN0cnVjdG9yLnJlZ2lzdHJ5LnJlZ2lzdGVyKHRoaXMpOyAvL3JlZ2lzdGVyIHRhYmxlIGZvciBpbnRlci1kZXZpY2UgY29tbXVuaWNhdGlvblxuXHR9XG5cdFxuXHRpbml0aWFsaXplRWxlbWVudChlbGVtZW50KXtcblx0XHRpZih0eXBlb2YgSFRNTEVsZW1lbnQgIT09IFwidW5kZWZpbmVkXCIgJiYgZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KXtcblx0XHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9ZWxzZSBpZih0eXBlb2YgZWxlbWVudCA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHR0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQpO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLmVsZW1lbnQpe1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcIlRhYnVsYXRvciBDcmVhdGlvbiBFcnJvciAtIG5vIGVsZW1lbnQgZm91bmQgbWF0Y2hpbmcgc2VsZWN0b3I6IFwiLCBlbGVtZW50KTtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJUYWJ1bGF0b3IgQ3JlYXRpb24gRXJyb3IgLSBJbnZhbGlkIGVsZW1lbnQgcHJvdmlkZWQ6XCIsIGVsZW1lbnQpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXHRcblx0aW5pdGlhbGl6ZUNvcmVTeXN0ZW1zKG9wdGlvbnMpe1xuXHRcdHRoaXMuY29sdW1uTWFuYWdlciA9IG5ldyBDb2x1bW5NYW5hZ2VyKHRoaXMpO1xuXHRcdHRoaXMucm93TWFuYWdlciA9IG5ldyBSb3dNYW5hZ2VyKHRoaXMpO1xuXHRcdHRoaXMuZm9vdGVyTWFuYWdlciA9IG5ldyBGb290ZXJNYW5hZ2VyKHRoaXMpO1xuXHRcdHRoaXMuZGF0YUxvYWRlciA9IG5ldyBEYXRhTG9hZGVyKHRoaXMpO1xuXHRcdHRoaXMuYWxlcnRNYW5hZ2VyID0gbmV3IEFsZXJ0KHRoaXMpO1xuXHRcdFxuXHRcdHRoaXMuX2JpbmRNb2R1bGVzKCk7XG5cdFx0XG5cdFx0dGhpcy5vcHRpb25zID0gdGhpcy5vcHRpb25zTGlzdC5nZW5lcmF0ZShUYWJ1bGF0b3IuZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuXHRcdFxuXHRcdHRoaXMuX2NsZWFyT2JqZWN0UG9pbnRlcnMoKTtcblx0XHRcblx0XHR0aGlzLl9tYXBEZXByZWNhdGVkRnVuY3Rpb25hbGl0eSgpO1xuXHRcdFxuXHRcdHRoaXMuZXh0ZXJuYWxFdmVudHMgPSBuZXcgRXh0ZXJuYWxFdmVudEJ1cyh0aGlzLCB0aGlzLm9wdGlvbnMsIHRoaXMub3B0aW9ucy5kZWJ1Z0V2ZW50c0V4dGVybmFsKTtcblx0XHR0aGlzLmV2ZW50QnVzID0gbmV3IEludGVybmFsRXZlbnRCdXModGhpcy5vcHRpb25zLmRlYnVnRXZlbnRzSW50ZXJuYWwpO1xuXHRcdFxuXHRcdHRoaXMuaW50ZXJhY3Rpb25Nb25pdG9yID0gbmV3IEludGVyYWN0aW9uTWFuYWdlcih0aGlzKTtcblx0XHRcblx0XHR0aGlzLmRhdGFMb2FkZXIuaW5pdGlhbGl6ZSgpO1xuXHRcdHRoaXMuZm9vdGVyTWFuYWdlci5pbml0aWFsaXplKCk7XG5cblx0XHR0aGlzLmRlcGVuZGVuY3lSZWdpc3RyeS5pbml0aWFsaXplKCk7XG5cdH1cblx0XG5cdC8vY29udmVydCBkZXByZWNhdGVkIGZ1bmN0aW9uYWxpdHkgdG8gbmV3IGZ1bmN0aW9uc1xuXHRfbWFwRGVwcmVjYXRlZEZ1bmN0aW9uYWxpdHkoKXtcblx0XHQvL2FsbCBwcmV2aW91c2x5IGRlcHJlY2F0ZWQgZnVuY3Rpb25hbGl0eSByZW1vdmVkIGluIHRoZSA2LjAgcmVsZWFzZVxuXHR9XG5cdFxuXHRfY2xlYXJTZWxlY3Rpb24oKXtcblx0XHRcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ibG9jay1zZWxlY3RcIik7XG5cdFx0XG5cdFx0aWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcblx0XHRcdGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkpIHsgIC8vIENocm9tZVxuXHRcdFx0XHR3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkoKTtcblx0XHRcdH0gZWxzZSBpZiAod2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcykgeyAgLy8gRmlyZWZveFxuXHRcdFx0XHR3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHsgIC8vIElFP1xuXHRcdFx0ZG9jdW1lbnQuc2VsZWN0aW9uLmVtcHR5KCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblx0fVxuXHRcblx0Ly9jcmVhdGUgdGFibGVcblx0X2NyZWF0ZSgpe1xuXHRcdHRoaXMuZXh0ZXJuYWxFdmVudHMuZGlzcGF0Y2goXCJ0YWJsZUJ1aWxkaW5nXCIpO1xuXHRcdHRoaXMuZXZlbnRCdXMuZGlzcGF0Y2goXCJ0YWJsZS1idWlsZGluZ1wiKTtcblx0XHRcblx0XHR0aGlzLl9ydGxDaGVjaygpO1xuXHRcdFxuXHRcdHRoaXMuX2J1aWxkRWxlbWVudCgpO1xuXHRcdFxuXHRcdHRoaXMuX2luaXRpYWxpemVUYWJsZSgpO1xuXG5cdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cdFx0XG5cdFx0dGhpcy5fbG9hZEluaXRpYWxEYXRhKClcblx0XHRcdC5maW5hbGx5KCgpID0+IHtcblx0XHRcdFx0dGhpcy5ldmVudEJ1cy5kaXNwYXRjaChcInRhYmxlLWluaXRpYWxpemVkXCIpO1xuXHRcdFx0XHR0aGlzLmV4dGVybmFsRXZlbnRzLmRpc3BhdGNoKFwidGFibGVCdWlsdFwiKTtcblx0XHRcdH0pO1x0XG5cdH1cblx0XG5cdF9ydGxDaGVjaygpe1xuXHRcdHZhciBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCk7XG5cdFx0XG5cdFx0c3dpdGNoKHRoaXMub3B0aW9ucy50ZXh0RGlyZWN0aW9uKXtcblx0XHRcdGNhc2VcImF1dG9cIjpcblx0XHRcdFx0aWYoc3R5bGUuZGlyZWN0aW9uICE9PSBcInJ0bFwiKXtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjYXNlIFwicnRsXCI6XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJ0bFwiKTtcblx0XHRcdFx0dGhpcy5ydGwgPSB0cnVlO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFxuXHRcdFx0Y2FzZSBcImx0clwiOlxuXHRcdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1sdHJcIik7XG5cdFx0XHRcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHRoaXMucnRsID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL2NsZWFyIHBvaW50ZXJzIHRvIG9iamVjdHMgaW4gZGVmYXVsdCBjb25maWcgb2JqZWN0XG5cdF9jbGVhck9iamVjdFBvaW50ZXJzKCl7XG5cdFx0dGhpcy5vcHRpb25zLmNvbHVtbnMgPSB0aGlzLm9wdGlvbnMuY29sdW1ucy5zbGljZSgwKTtcblx0XHRcblx0XHRpZihBcnJheS5pc0FycmF5KHRoaXMub3B0aW9ucy5kYXRhKSAmJiAhdGhpcy5vcHRpb25zLnJlYWN0aXZlRGF0YSl7XG5cdFx0XHR0aGlzLm9wdGlvbnMuZGF0YSA9IHRoaXMub3B0aW9ucy5kYXRhLnNsaWNlKDApO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9idWlsZCB0YWJ1bGF0b3IgZWxlbWVudFxuXHRfYnVpbGRFbGVtZW50KCl7XG5cdFx0dmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQsXG5cdFx0b3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcblx0XHRuZXdFbGVtZW50O1xuXHRcdFxuXHRcdGlmKGVsZW1lbnQudGFnTmFtZSA9PT0gXCJUQUJMRVwiKXtcblx0XHRcdHRoaXMub3JpZ2luYWxFbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuXHRcdFx0bmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRcblx0XHRcdC8vdHJhbnNmZXIgYXR0cmlidXRlcyB0byBuZXcgZWxlbWVudFxuXHRcdFx0dmFyIGF0dHJpYnV0ZXMgPSBlbGVtZW50LmF0dHJpYnV0ZXM7XG5cdFx0XHRcblx0XHRcdC8vIGxvb3AgdGhyb3VnaCBhdHRyaWJ1dGVzIGFuZCBhcHBseSB0aGVtIG9uIGRpdlxuXHRcdFx0Zm9yKHZhciBpIGluIGF0dHJpYnV0ZXMpe1xuXHRcdFx0XHRpZih0eXBlb2YgYXR0cmlidXRlc1tpXSA9PSBcIm9iamVjdFwiKXtcblx0XHRcdFx0XHRuZXdFbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyaWJ1dGVzW2ldLm5hbWUsIGF0dHJpYnV0ZXNbaV0udmFsdWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIHJlcGxhY2UgdGFibGUgd2l0aCBkaXYgZWxlbWVudFxuXHRcdFx0ZWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChuZXdFbGVtZW50LCBlbGVtZW50KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5lbGVtZW50ID0gZWxlbWVudCA9IG5ld0VsZW1lbnQ7XG5cdFx0fVxuXHRcdFxuXHRcdGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvclwiKTtcblx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJncmlkXCIpO1xuXHRcdFxuXHRcdC8vZW1wdHkgZWxlbWVudFxuXHRcdHdoaWxlKGVsZW1lbnQuZmlyc3RDaGlsZCkgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdFxuXHRcdC8vc2V0IHRhYmxlIGhlaWdodFxuXHRcdGlmKG9wdGlvbnMuaGVpZ2h0KXtcblx0XHRcdG9wdGlvbnMuaGVpZ2h0ID0gaXNOYU4ob3B0aW9ucy5oZWlnaHQpID8gb3B0aW9ucy5oZWlnaHQgOiBvcHRpb25zLmhlaWdodCArIFwicHhcIjtcblx0XHRcdGVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQ7XG5cdFx0fVxuXHRcdFxuXHRcdC8vc2V0IHRhYmxlIG1pbiBoZWlnaHRcblx0XHRpZihvcHRpb25zLm1pbkhlaWdodCAhPT0gZmFsc2Upe1xuXHRcdFx0b3B0aW9ucy5taW5IZWlnaHQgPSBpc05hTihvcHRpb25zLm1pbkhlaWdodCkgPyBvcHRpb25zLm1pbkhlaWdodCA6IG9wdGlvbnMubWluSGVpZ2h0ICsgXCJweFwiO1xuXHRcdFx0ZWxlbWVudC5zdHlsZS5taW5IZWlnaHQgPSBvcHRpb25zLm1pbkhlaWdodDtcblx0XHR9XG5cdFx0XG5cdFx0Ly9zZXQgdGFibGUgbWF4SGVpZ2h0XG5cdFx0aWYob3B0aW9ucy5tYXhIZWlnaHQgIT09IGZhbHNlKXtcblx0XHRcdG9wdGlvbnMubWF4SGVpZ2h0ID0gaXNOYU4ob3B0aW9ucy5tYXhIZWlnaHQpID8gb3B0aW9ucy5tYXhIZWlnaHQgOiBvcHRpb25zLm1heEhlaWdodCArIFwicHhcIjtcblx0XHRcdGVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gb3B0aW9ucy5tYXhIZWlnaHQ7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL2luaXRpYWxpemUgY29yZSBzeXN0ZW1zIGFuZCBtb2R1bGVzXG5cdF9pbml0aWFsaXplVGFibGUoKXtcblx0XHR2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcblx0XHRvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXHRcdFxuXHRcdHRoaXMuaW50ZXJhY3Rpb25Nb25pdG9yLmluaXRpYWxpemUoKTtcblx0XHRcblx0XHR0aGlzLmNvbHVtbk1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xuXHRcdHRoaXMucm93TWFuYWdlci5pbml0aWFsaXplKCk7XG5cdFx0XG5cdFx0dGhpcy5fZGV0ZWN0QnJvd3NlcigpO1xuXHRcdFxuXHRcdC8vaW5pdGlhbGl6ZSBjb3JlIG1vZHVsZXNcblx0XHR0aGlzLm1vZHVsZXNDb3JlLmZvckVhY2goKG1vZCkgPT4ge1xuXHRcdFx0bW9kLmluaXRpYWxpemUoKTtcblx0XHR9KTtcblx0XHRcblx0XHQvL2J1aWxkIHRhYmxlIGVsZW1lbnRzXG5cdFx0ZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmNvbHVtbk1hbmFnZXIuZ2V0RWxlbWVudCgpKTtcblx0XHRlbGVtZW50LmFwcGVuZENoaWxkKHRoaXMucm93TWFuYWdlci5nZXRFbGVtZW50KCkpO1xuXHRcdFxuXHRcdGlmKG9wdGlvbnMuZm9vdGVyRWxlbWVudCl7XG5cdFx0XHR0aGlzLmZvb3Rlck1hbmFnZXIuYWN0aXZhdGUoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYob3B0aW9ucy5hdXRvQ29sdW1ucyAmJiBvcHRpb25zLmRhdGEpe1xuXHRcdFx0XG5cdFx0XHR0aGlzLmNvbHVtbk1hbmFnZXIuZ2VuZXJhdGVDb2x1bW5zRnJvbVJvd0RhdGEodGhpcy5vcHRpb25zLmRhdGEpO1xuXHRcdH1cblx0XHRcblx0XHQvL2luaXRpYWxpemUgcmVndWxhciBtb2R1bGVzXG5cdFx0dGhpcy5tb2R1bGVzUmVndWxhci5mb3JFYWNoKChtb2QpID0+IHtcblx0XHRcdG1vZC5pbml0aWFsaXplKCk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0dGhpcy5jb2x1bW5NYW5hZ2VyLnNldENvbHVtbnMob3B0aW9ucy5jb2x1bW5zKTtcblx0XHRcblx0XHR0aGlzLmV2ZW50QnVzLmRpc3BhdGNoKFwidGFibGUtYnVpbHRcIik7XG5cdH1cblx0XG5cdF9sb2FkSW5pdGlhbERhdGEoKXtcblx0XHRyZXR1cm4gdGhpcy5kYXRhTG9hZGVyLmxvYWQodGhpcy5vcHRpb25zLmRhdGEpXG5cdFx0XHQuZmluYWxseSgoKSA9PiB7XG5cdFx0XHRcdHRoaXMuY29sdW1uTWFuYWdlci52ZXJ0aWNhbEFsaWduSGVhZGVycygpO1xuXHRcdFx0fSk7XHRcdFxuXHR9XG5cdFxuXHQvL2RlY29uc3RydWN0b3Jcblx0ZGVzdHJveSgpe1xuXHRcdHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuXHRcdFxuXHRcdHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcblx0XHRcblx0XHR0aGlzLmNvbnN0cnVjdG9yLnJlZ2lzdHJ5LmRlcmVnaXN0ZXIodGhpcyk7IC8vZGVyZWdpc3RlciB0YWJsZSBmcm9tIGludGVyLWRldmljZSBjb21tdW5pY2F0aW9uXG5cdFx0XG5cdFx0dGhpcy5ldmVudEJ1cy5kaXNwYXRjaChcInRhYmxlLWRlc3Ryb3lcIik7XG5cdFx0XG5cdFx0Ly9jbGVhciByb3cgZGF0YVxuXHRcdHRoaXMucm93TWFuYWdlci5kZXN0cm95KCk7XG5cdFx0XG5cdFx0Ly9jbGVhciBET01cblx0XHR3aGlsZShlbGVtZW50LmZpcnN0Q2hpbGQpIGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5maXJzdENoaWxkKTtcblx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3JcIik7XG5cblx0XHR0aGlzLmV4dGVybmFsRXZlbnRzLmRpc3BhdGNoKFwidGFibGVEZXN0cm95ZWRcIik7XG5cdH1cblx0XG5cdF9kZXRlY3RCcm93c2VyKCl7XG5cdFx0dmFyIHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudHx8bmF2aWdhdG9yLnZlbmRvcnx8d2luZG93Lm9wZXJhO1xuXHRcdFxuXHRcdGlmKHVhLmluZGV4T2YoXCJUcmlkZW50XCIpID4gLTEpe1xuXHRcdFx0dGhpcy5icm93c2VyID0gXCJpZVwiO1xuXHRcdFx0dGhpcy5icm93c2VyU2xvdyA9IHRydWU7XG5cdFx0fWVsc2UgaWYodWEuaW5kZXhPZihcIkVkZ2VcIikgPiAtMSl7XG5cdFx0XHR0aGlzLmJyb3dzZXIgPSBcImVkZ2VcIjtcblx0XHRcdHRoaXMuYnJvd3NlclNsb3cgPSB0cnVlO1xuXHRcdH1lbHNlIGlmKHVhLmluZGV4T2YoXCJGaXJlZm94XCIpID4gLTEpe1xuXHRcdFx0dGhpcy5icm93c2VyID0gXCJmaXJlZm94XCI7XG5cdFx0XHR0aGlzLmJyb3dzZXJTbG93ID0gZmFsc2U7XG5cdFx0fWVsc2UgaWYodWEuaW5kZXhPZihcIk1hYyBPU1wiKSA+IC0xKXtcblx0XHRcdHRoaXMuYnJvd3NlciA9IFwic2FmYXJpXCI7XG5cdFx0XHR0aGlzLmJyb3dzZXJTbG93ID0gZmFsc2U7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5icm93c2VyID0gXCJvdGhlclwiO1xuXHRcdFx0dGhpcy5icm93c2VyU2xvdyA9IGZhbHNlO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmJyb3dzZXJNb2JpbGUgPSAvKGFuZHJvaWR8YmJcXGQrfG1lZWdvKS4rbW9iaWxlfGF2YW50Z298YmFkYVxcL3xibGFja2JlcnJ5fGJsYXplcnxjb21wYWx8ZWxhaW5lfGZlbm5lY3xoaXB0b3B8aWVtb2JpbGV8aXAoaG9uZXxvZCl8aXJpc3xraW5kbGV8bGdlIHxtYWVtb3xtaWRwfG1tcHxtb2JpbGUuK2ZpcmVmb3h8bmV0ZnJvbnR8b3BlcmEgbShvYnxpbilpfHBhbG0oIG9zKT98cGhvbmV8cChpeGl8cmUpXFwvfHBsdWNrZXJ8cG9ja2V0fHBzcHxzZXJpZXMoNHw2KTB8c3ltYmlhbnx0cmVvfHVwXFwuKGJyb3dzZXJ8bGluayl8dm9kYWZvbmV8d2FwfHdpbmRvd3MgY2V8eGRhfHhpaW5vfGFuZHJvaWR8aXBhZHxwbGF5Ym9va3xzaWxrL2kudGVzdCh1YSl8fC8xMjA3fDYzMTB8NjU5MHwzZ3NvfDR0aHB8NTBbMS02XWl8Nzcwc3w4MDJzfGEgd2F8YWJhY3xhYyhlcnxvb3xzLSl8YWkoa298cm4pfGFsKGF2fGNhfGNvKXxhbW9pfGFuKGV4fG55fHl3KXxhcHR1fGFyKGNofGdvKXxhcyh0ZXx1cyl8YXR0d3xhdShkaXwtbXxyIHxzICl8YXZhbnxiZShja3xsbHxucSl8YmkobGJ8cmQpfGJsKGFjfGF6KXxicihlfHYpd3xidW1ifGJ3LShufHUpfGM1NVxcL3xjYXBpfGNjd2F8Y2RtLXxjZWxsfGNodG18Y2xkY3xjbWQtfGNvKG1wfG5kKXxjcmF3fGRhKGl0fGxsfG5nKXxkYnRlfGRjLXN8ZGV2aXxkaWNhfGRtb2J8ZG8oY3xwKW98ZHMoMTJ8LWQpfGVsKDQ5fGFpKXxlbShsMnx1bCl8ZXIoaWN8azApfGVzbDh8ZXooWzQtN10wfG9zfHdhfHplKXxmZXRjfGZseSgtfF8pfGcxIHV8ZzU2MHxnZW5lfGdmLTV8Zy1tb3xnbyhcXC53fG9kKXxncihhZHx1bil8aGFpZXxoY2l0fGhkLShtfHB8dCl8aGVpLXxoaShwdHx0YSl8aHAoIGl8aXApfGhzLWN8aHQoYygtfCB8X3xhfGd8cHxzfHQpfHRwKXxodShhd3x0Yyl8aS0oMjB8Z298bWEpfGkyMzB8aWFjKCB8LXxcXC8pfGlicm98aWRlYXxpZzAxfGlrb218aW0xa3xpbm5vfGlwYXF8aXJpc3xqYSh0fHYpYXxqYnJvfGplbXV8amlnc3xrZGRpfGtlaml8a2d0KCB8XFwvKXxrbG9ufGtwdCB8a3djLXxreW8oY3xrKXxsZShub3x4aSl8bGcoIGd8XFwvKGt8bHx1KXw1MHw1NHwtW2Etd10pfGxpYnd8bHlueHxtMS13fG0zZ2F8bTUwXFwvfG1hKHRlfHVpfHhvKXxtYygwMXwyMXxjYSl8bS1jcnxtZShyY3xyaSl8bWkobzh8b2F8dHMpfG1tZWZ8bW8oMDF8MDJ8Yml8ZGV8ZG98dCgtfCB8b3x2KXx6eil8bXQoNTB8cDF8diApfG13YnB8bXl3YXxuMTBbMC0yXXxuMjBbMi0zXXxuMzAoMHwyKXxuNTAoMHwyfDUpfG43KDAoMHwxKXwxMCl8bmUoKGN8bSktfG9ufHRmfHdmfHdnfHd0KXxub2soNnxpKXxuenBofG8yaW18b3AodGl8d3YpfG9yYW58b3dnMXxwODAwfHBhbihhfGR8dCl8cGR4Z3xwZygxM3wtKFsxLThdfGMpKXxwaGlsfHBpcmV8cGwoYXl8dWMpfHBuLTJ8cG8oY2t8cnR8c2UpfHByb3h8cHNpb3xwdC1nfHFhLWF8cWMoMDd8MTJ8MjF8MzJ8NjB8LVsyLTddfGktKXxxdGVrfHIzODB8cjYwMHxyYWtzfHJpbTl8cm8odmV8em8pfHM1NVxcL3xzYShnZXxtYXxtbXxtc3xueXx2YSl8c2MoMDF8aC18b298cC0pfHNka1xcL3xzZShjKC18MHwxKXw0N3xtY3xuZHxyaSl8c2doLXxzaGFyfHNpZSgtfG0pfHNrLTB8c2woNDV8aWQpfHNtKGFsfGFyfGIzfGl0fHQ1KXxzbyhmdHxueSl8c3AoMDF8aC18di18diApfHN5KDAxfG1iKXx0MigxOHw1MCl8dDYoMDB8MTB8MTgpfHRhKGd0fGxrKXx0Y2wtfHRkZy18dGVsKGl8bSl8dGltLXx0LW1vfHRvKHBsfHNoKXx0cyg3MHxtLXxtM3xtNSl8dHgtOXx1cChcXC5ifGcxfHNpKXx1dHN0fHY0MDB8djc1MHx2ZXJpfHZpKHJnfHRlKXx2ayg0MHw1WzAtM118LXYpfHZtNDB8dm9kYXx2dWxjfHZ4KDUyfDUzfDYwfDYxfDcwfDgwfDgxfDgzfDg1fDk4KXx3M2MoLXwgKXx3ZWJjfHdoaXR8d2koZyB8bmN8bncpfHdtbGJ8d29udXx4NzAwfHlhcy18eW91cnx6ZXRvfHp0ZS0vaS50ZXN0KHVhLnNsaWNlKDAsNCkpO1xuXHR9XG5cdFxuXHRpbml0R3VhcmQoZnVuYywgbXNnKXtcblx0XHR2YXIgc3RhY2ssIGxpbmU7XG5cdFx0XG5cdFx0aWYodGhpcy5vcHRpb25zLmRlYnVnSW5pdGlhbGl6YXRpb24gJiYgIXRoaXMuaW5pdGlhbGl6ZWQpe1xuXHRcdFx0aWYoIWZ1bmMpe1xuXHRcdFx0XHRzdGFjayA9IG5ldyBFcnJvcigpLnN0YWNrLnNwbGl0KFwiXFxuXCIpO1xuXHRcdFx0XHRcblx0XHRcdFx0bGluZSA9IHN0YWNrWzBdID09IFwiRXJyb3JcIiA/IHN0YWNrWzJdIDogc3RhY2tbMV07XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihsaW5lWzBdID09IFwiIFwiKXtcblx0XHRcdFx0XHRmdW5jID0gbGluZS50cmltKCkuc3BsaXQoXCIgXCIpWzFdLnNwbGl0KFwiLlwiKVsxXTtcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdGZ1bmMgPSBsaW5lLnRyaW0oKS5zcGxpdChcIkBcIilbMF07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Y29uc29sZS53YXJuKFwiVGFibGUgTm90IEluaXRpYWxpemVkIC0gQ2FsbGluZyB0aGUgXCIgKyBmdW5jICsgXCIgZnVuY3Rpb24gYmVmb3JlIHRoZSB0YWJsZSBpcyBpbml0aWFsaXplZCBtYXkgcmVzdWx0IGluIGluY29uc2lzdGVudCBiZWhhdmlvciwgUGxlYXNlIHdhaXQgZm9yIHRoZSBgdGFibGVCdWlsdGAgZXZlbnQgYmVmb3JlIGNhbGxpbmcgdGhpcyBmdW5jdGlvbi5cIiArIChtc2cgPyBcIiBcIiArIG1zZyA6IFwiXCIpKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuaW5pdGlhbGl6ZWQ7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLyBEYXRhIEhhbmRsaW5nIC8vLy8vLy8vLy8vLy8vLy8vL1xuXHQvL2Jsb2NrIHRhYmxlIHJlZHJhd2luZ1xuXHRibG9ja1JlZHJhdygpe1xuXHRcdHRoaXMuaW5pdEd1YXJkKCk7XG5cblx0XHR0aGlzLmV2ZW50QnVzLmRpc3BhdGNoKFwicmVkcmF3LWJsb2NraW5nXCIpO1xuXHRcdFxuXHRcdHRoaXMucm93TWFuYWdlci5ibG9ja1JlZHJhdygpO1xuXHRcdHRoaXMuY29sdW1uTWFuYWdlci5ibG9ja1JlZHJhdygpO1xuXG5cdFx0dGhpcy5ldmVudEJ1cy5kaXNwYXRjaChcInJlZHJhdy1ibG9ja2VkXCIpO1xuXHR9XG5cdFxuXHQvL3Jlc3RvcmUgdGFibGUgcmVkcmF3aW5nXG5cdHJlc3RvcmVSZWRyYXcoKXtcblx0XHR0aGlzLmluaXRHdWFyZCgpO1xuXG5cdFx0dGhpcy5ldmVudEJ1cy5kaXNwYXRjaChcInJlZHJhdy1yZXN0b3JpbmdcIik7XG5cblx0XHR0aGlzLnJvd01hbmFnZXIucmVzdG9yZVJlZHJhdygpO1xuXHRcdHRoaXMuY29sdW1uTWFuYWdlci5yZXN0b3JlUmVkcmF3KCk7XG5cblx0XHR0aGlzLmV2ZW50QnVzLmRpc3BhdGNoKFwicmVkcmF3LXJlc3RvcmVkXCIpO1xuXHR9XG5cdFxuXHQvL2xvYWQgZGF0YVxuXHRzZXREYXRhKGRhdGEsIHBhcmFtcywgY29uZmlnKXtcblx0XHR0aGlzLmluaXRHdWFyZChmYWxzZSwgXCJUbyBzZXQgaW5pdGlhbCBkYXRhIHBsZWFzZSB1c2UgdGhlICdkYXRhJyBwcm9wZXJ0eSBpbiB0aGUgdGFibGUgY29uc3RydWN0b3IuXCIpO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmRhdGFMb2FkZXIubG9hZChkYXRhLCBwYXJhbXMsIGNvbmZpZywgZmFsc2UpO1xuXHR9XG5cdFxuXHQvL2NsZWFyIGRhdGFcblx0Y2xlYXJEYXRhKCl7XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHR0aGlzLmRhdGFMb2FkZXIuYmxvY2tBY3RpdmVMb2FkKCk7XG5cdFx0dGhpcy5yb3dNYW5hZ2VyLmNsZWFyRGF0YSgpO1xuXHR9XG5cdFxuXHQvL2dldCB0YWJsZSBkYXRhIGFycmF5XG5cdGdldERhdGEoYWN0aXZlKXtcblx0XHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLmdldERhdGEoYWN0aXZlKTtcblx0fVxuXHRcblx0Ly9nZXQgdGFibGUgZGF0YSBhcnJheSBjb3VudFxuXHRnZXREYXRhQ291bnQoYWN0aXZlKXtcblx0XHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLmdldERhdGFDb3VudChhY3RpdmUpO1xuXHR9XG5cdFxuXHQvL3JlcGxhY2UgZGF0YSwga2VlcGluZyB0YWJsZSBpbiBwb3NpdGlvbiB3aXRoIHNhbWUgc29ydFxuXHRyZXBsYWNlRGF0YShkYXRhLCBwYXJhbXMsIGNvbmZpZyl7XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5kYXRhTG9hZGVyLmxvYWQoZGF0YSwgcGFyYW1zLCBjb25maWcsIHRydWUsIHRydWUpO1xuXHR9XG5cdFxuXHQvL3VwZGF0ZSB0YWJsZSBkYXRhXG5cdHVwZGF0ZURhdGEoZGF0YSl7XG5cdFx0dmFyIHJlc3BvbnNlcyA9IDA7XG5cdFx0XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0dGhpcy5kYXRhTG9hZGVyLmJsb2NrQWN0aXZlTG9hZCgpO1xuXHRcdFx0XG5cdFx0XHRpZih0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihkYXRhICYmIGRhdGEubGVuZ3RoID4gMCl7XG5cdFx0XHRcdGRhdGEuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdHZhciByb3cgPSB0aGlzLnJvd01hbmFnZXIuZmluZFJvdyhpdGVtW3RoaXMub3B0aW9ucy5pbmRleF0pO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKHJvdyl7XG5cdFx0XHRcdFx0XHRyZXNwb25zZXMrKztcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0cm93LnVwZGF0ZURhdGEoaXRlbSlcblx0XHRcdFx0XHRcdFx0LnRoZW4oKCk9Pntcblx0XHRcdFx0XHRcdFx0XHRyZXNwb25zZXMtLTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0aWYoIXJlc3BvbnNlcyl7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0XHQuY2F0Y2goKGUpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRyZWplY3QoXCJVcGRhdGUgRXJyb3IgLSBVbmFibGUgdG8gdXBkYXRlIHJvd1wiLCBpdGVtLCBlKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0cmVqZWN0KFwiVXBkYXRlIEVycm9yIC0gVW5hYmxlIHRvIGZpbmQgcm93XCIsIGl0ZW0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIlVwZGF0ZSBFcnJvciAtIE5vIGRhdGEgcHJvdmlkZWRcIik7XG5cdFx0XHRcdHJlamVjdChcIlVwZGF0ZSBFcnJvciAtIE5vIGRhdGEgcHJvdmlkZWRcIik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0XG5cdGFkZERhdGEoZGF0YSwgcG9zLCBpbmRleCl7XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0dGhpcy5kYXRhTG9hZGVyLmJsb2NrQWN0aXZlTG9hZCgpO1xuXHRcdFx0XG5cdFx0XHRpZih0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZihkYXRhKXtcblx0XHRcdFx0dGhpcy5yb3dNYW5hZ2VyLmFkZFJvd3MoZGF0YSwgcG9zLCBpbmRleClcblx0XHRcdFx0XHQudGhlbigocm93cykgPT4ge1xuXHRcdFx0XHRcdFx0dmFyIG91dHB1dCA9IFtdO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0cm93cy5mb3JFYWNoKGZ1bmN0aW9uKHJvdyl7XG5cdFx0XHRcdFx0XHRcdG91dHB1dC5wdXNoKHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHJlc29sdmUob3V0cHV0KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiVXBkYXRlIEVycm9yIC0gTm8gZGF0YSBwcm92aWRlZFwiKTtcblx0XHRcdFx0cmVqZWN0KFwiVXBkYXRlIEVycm9yIC0gTm8gZGF0YSBwcm92aWRlZFwiKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0Ly91cGRhdGUgdGFibGUgZGF0YVxuXHR1cGRhdGVPckFkZERhdGEoZGF0YSl7XG5cdFx0dmFyIHJvd3MgPSBbXSxcblx0XHRyZXNwb25zZXMgPSAwO1xuXHRcdFxuXHRcdHRoaXMuaW5pdEd1YXJkKCk7XG5cdFx0XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdHRoaXMuZGF0YUxvYWRlci5ibG9ja0FjdGl2ZUxvYWQoKTtcblx0XHRcdFxuXHRcdFx0aWYodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpe1xuXHRcdFx0XHRkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoZGF0YSAmJiBkYXRhLmxlbmd0aCA+IDApe1xuXHRcdFx0XHRkYXRhLmZvckVhY2goKGl0ZW0pID0+IHtcblx0XHRcdFx0XHR2YXIgcm93ID0gdGhpcy5yb3dNYW5hZ2VyLmZpbmRSb3coaXRlbVt0aGlzLm9wdGlvbnMuaW5kZXhdKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRyZXNwb25zZXMrKztcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihyb3cpe1xuXHRcdFx0XHRcdFx0cm93LnVwZGF0ZURhdGEoaXRlbSlcblx0XHRcdFx0XHRcdFx0LnRoZW4oKCk9Pntcblx0XHRcdFx0XHRcdFx0XHRyZXNwb25zZXMtLTtcblx0XHRcdFx0XHRcdFx0XHRyb3dzLnB1c2gocm93LmdldENvbXBvbmVudCgpKTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0aWYoIXJlc3BvbnNlcyl7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKHJvd3MpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdFx0dGhpcy5yb3dNYW5hZ2VyLmFkZFJvd3MoaXRlbSlcblx0XHRcdFx0XHRcdFx0LnRoZW4oKG5ld1Jvd3MpPT57XG5cdFx0XHRcdFx0XHRcdFx0cmVzcG9uc2VzLS07XG5cdFx0XHRcdFx0XHRcdFx0cm93cy5wdXNoKG5ld1Jvd3NbMF0uZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHRpZighcmVzcG9uc2VzKXtcblx0XHRcdFx0XHRcdFx0XHRcdHJlc29sdmUocm93cyk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJVcGRhdGUgRXJyb3IgLSBObyBkYXRhIHByb3ZpZGVkXCIpO1xuXHRcdFx0XHRyZWplY3QoXCJVcGRhdGUgRXJyb3IgLSBObyBkYXRhIHByb3ZpZGVkXCIpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdFxuXHQvL2dldCByb3cgb2JqZWN0XG5cdGdldFJvdyhpbmRleCl7XG5cdFx0dmFyIHJvdyA9IHRoaXMucm93TWFuYWdlci5maW5kUm93KGluZGV4KTtcblx0XHRcblx0XHRpZihyb3cpe1xuXHRcdFx0cmV0dXJuIHJvdy5nZXRDb21wb25lbnQoKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJGaW5kIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kOlwiLCBpbmRleCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL2dldCByb3cgb2JqZWN0XG5cdGdldFJvd0Zyb21Qb3NpdGlvbihwb3NpdGlvbil7XG5cdFx0dmFyIHJvdyA9IHRoaXMucm93TWFuYWdlci5nZXRSb3dGcm9tUG9zaXRpb24ocG9zaXRpb24pO1xuXHRcdFxuXHRcdGlmKHJvdyl7XG5cdFx0XHRyZXR1cm4gcm93LmdldENvbXBvbmVudCgpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkZpbmQgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmQ6XCIsIHBvc2l0aW9uKTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblx0XG5cdC8vZGVsZXRlIHJvdyBmcm9tIHRhYmxlXG5cdGRlbGV0ZVJvdyhpbmRleCl7XG5cdFx0dmFyIGZvdW5kUm93cyA9IFtdO1xuXHRcdFxuXHRcdHRoaXMuaW5pdEd1YXJkKCk7XG5cdFx0XG5cdFx0aWYoIUFycmF5LmlzQXJyYXkoaW5kZXgpKXtcblx0XHRcdGluZGV4ID0gW2luZGV4XTtcblx0XHR9XG5cdFx0XG5cdFx0Ly9maW5kIG1hdGNoaW5nIHJvd3Ncblx0XHRmb3IobGV0IGl0ZW0gb2YgaW5kZXgpe1xuXHRcdFx0bGV0IHJvdyA9IHRoaXMucm93TWFuYWdlci5maW5kUm93KGl0ZW0sIHRydWUpO1xuXHRcdFx0XG5cdFx0XHRpZihyb3cpe1xuXHRcdFx0XHRmb3VuZFJvd3MucHVzaChyb3cpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwiRGVsZXRlIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kOlwiLCBpdGVtKTtcblx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KFwiRGVsZXRlIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kXCIpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvL3NvcnQgcm93cyBpbnRvIGNvcnJlY3Qgb3JkZXIgdG8gZW5zdXJlIHNtb290aCBkZWxldGUgZnJvbSB0YWJsZVxuXHRcdGZvdW5kUm93cy5zb3J0KChhLCBiKSA9PiB7XG5cdFx0XHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLnJvd3MuaW5kZXhPZihhKSA+IHRoaXMucm93TWFuYWdlci5yb3dzLmluZGV4T2YoYikgPyAxIDogLTE7XG5cdFx0fSk7XG5cdFx0XG5cdFx0Ly9kZWxldGUgcm93c1xuXHRcdGZvdW5kUm93cy5mb3JFYWNoKChyb3cpID0+e1xuXHRcdFx0cm93LmRlbGV0ZSgpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMucm93TWFuYWdlci5yZVJlbmRlckluUG9zaXRpb24oKTtcblx0XHRcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdH1cblx0XG5cdC8vYWRkIHJvdyB0byB0YWJsZVxuXHRhZGRSb3coZGF0YSwgcG9zLCBpbmRleCl7XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRpZih0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHRkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMucm93TWFuYWdlci5hZGRSb3dzKGRhdGEsIHBvcywgaW5kZXgsIHRydWUpXG5cdFx0XHQudGhlbigocm93cyk9Pntcblx0XHRcdFx0cmV0dXJuIHJvd3NbMF0uZ2V0Q29tcG9uZW50KCk7XG5cdFx0XHR9KTtcblx0fVxuXHRcblx0Ly91cGRhdGUgYSByb3cgaWYgaXQgZXhpc3RzIG90aGVyd2lzZSBjcmVhdGUgaXRcblx0dXBkYXRlT3JBZGRSb3coaW5kZXgsIGRhdGEpe1xuXHRcdHZhciByb3cgPSB0aGlzLnJvd01hbmFnZXIuZmluZFJvdyhpbmRleCk7XG5cdFx0XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRpZih0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHRkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYocm93KXtcblx0XHRcdHJldHVybiByb3cudXBkYXRlRGF0YShkYXRhKVxuXHRcdFx0XHQudGhlbigoKT0+e1xuXHRcdFx0XHRcdHJldHVybiByb3cuZ2V0Q29tcG9uZW50KCk7XG5cdFx0XHRcdH0pO1xuXHRcdH1lbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLnJvd01hbmFnZXIuYWRkUm93cyhkYXRhKVxuXHRcdFx0XHQudGhlbigocm93cyk9Pntcblx0XHRcdFx0XHRyZXR1cm4gcm93c1swXS5nZXRDb21wb25lbnQoKTtcblx0XHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3VwZGF0ZSByb3cgZGF0YVxuXHR1cGRhdGVSb3coaW5kZXgsIGRhdGEpe1xuXHRcdHZhciByb3cgPSB0aGlzLnJvd01hbmFnZXIuZmluZFJvdyhpbmRleCk7XG5cdFx0XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRpZih0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIil7XG5cdFx0XHRkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYocm93KXtcblx0XHRcdHJldHVybiByb3cudXBkYXRlRGF0YShkYXRhKVxuXHRcdFx0XHQudGhlbigoKT0+e1xuXHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUocm93LmdldENvbXBvbmVudCgpKTtcblx0XHRcdFx0fSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiVXBkYXRlIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kOlwiLCBpbmRleCk7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJVcGRhdGUgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmRcIik7XG5cdFx0fVxuXHR9XG5cdFxuXHQvL3Njcm9sbCB0byByb3cgaW4gRE9NXG5cdHNjcm9sbFRvUm93KGluZGV4LCBwb3NpdGlvbiwgaWZWaXNpYmxlKXtcblx0XHR2YXIgcm93ID0gdGhpcy5yb3dNYW5hZ2VyLmZpbmRSb3coaW5kZXgpO1xuXHRcdFxuXHRcdGlmKHJvdyl7XG5cdFx0XHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLnNjcm9sbFRvUm93KHJvdywgcG9zaXRpb24sIGlmVmlzaWJsZSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiU2Nyb2xsIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kOlwiLCBpbmRleCk7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJTY3JvbGwgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmRcIik7XG5cdFx0fVxuXHR9XG5cdFxuXHRtb3ZlUm93KGZyb20sIHRvLCBhZnRlcil7XG5cdFx0dmFyIGZyb21Sb3cgPSB0aGlzLnJvd01hbmFnZXIuZmluZFJvdyhmcm9tKTtcblx0XHRcblx0XHR0aGlzLmluaXRHdWFyZCgpO1xuXHRcdFxuXHRcdGlmKGZyb21Sb3cpe1xuXHRcdFx0ZnJvbVJvdy5tb3ZlVG9Sb3codG8sIGFmdGVyKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJNb3ZlIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kOlwiLCBmcm9tKTtcblx0XHR9XG5cdH1cblx0XG5cdGdldFJvd3MoYWN0aXZlKXtcblx0XHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLmdldENvbXBvbmVudHMoYWN0aXZlKTtcdFxuXHR9XG5cdFxuXHQvL2dldCBwb3NpdGlvbiBvZiByb3cgaW4gdGFibGVcblx0Z2V0Um93UG9zaXRpb24oaW5kZXgpe1xuXHRcdHZhciByb3cgPSB0aGlzLnJvd01hbmFnZXIuZmluZFJvdyhpbmRleCk7XG5cdFx0XG5cdFx0aWYocm93KXtcblx0XHRcdHJldHVybiByb3cuZ2V0UG9zaXRpb24oKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJQb3NpdGlvbiBFcnJvciAtIE5vIG1hdGNoaW5nIHJvdyBmb3VuZDpcIiwgaW5kZXgpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vIENvbHVtbiBGdW5jdGlvbnMgIC8vLy8vLy8vLy8vLy8vL1xuXHRzZXRDb2x1bW5zKGRlZmluaXRpb24pe1xuXHRcdHRoaXMuaW5pdEd1YXJkKGZhbHNlLCBcIlRvIHNldCBpbml0aWFsIGNvbHVtbnMgcGxlYXNlIHVzZSB0aGUgJ2NvbHVtbnMnIHByb3BlcnR5IGluIHRoZSB0YWJsZSBjb25zdHJ1Y3RvclwiKTtcblx0XHRcblx0XHR0aGlzLmNvbHVtbk1hbmFnZXIuc2V0Q29sdW1ucyhkZWZpbml0aW9uKTtcblx0fVxuXHRcblx0Z2V0Q29sdW1ucyhzdHJ1Y3R1cmVkKXtcblx0XHRyZXR1cm4gdGhpcy5jb2x1bW5NYW5hZ2VyLmdldENvbXBvbmVudHMoc3RydWN0dXJlZCk7XG5cdH1cblx0XG5cdGdldENvbHVtbihmaWVsZCl7XG5cdFx0dmFyIGNvbHVtbiA9IHRoaXMuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGZpZWxkKTtcblx0XHRcblx0XHRpZihjb2x1bW4pe1xuXHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRDb21wb25lbnQoKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJGaW5kIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmaWVsZCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cdFxuXHRnZXRDb2x1bW5EZWZpbml0aW9ucygpe1xuXHRcdHJldHVybiB0aGlzLmNvbHVtbk1hbmFnZXIuZ2V0RGVmaW5pdGlvblRyZWUoKTtcblx0fVxuXHRcblx0c2hvd0NvbHVtbihmaWVsZCl7XG5cdFx0dmFyIGNvbHVtbiA9IHRoaXMuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGZpZWxkKTtcblx0XHRcblx0XHR0aGlzLmluaXRHdWFyZCgpO1xuXHRcdFxuXHRcdGlmKGNvbHVtbil7XG5cdFx0XHRjb2x1bW4uc2hvdygpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBTaG93IEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmaWVsZCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cdFxuXHRoaWRlQ29sdW1uKGZpZWxkKXtcblx0XHR2YXIgY29sdW1uID0gdGhpcy5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZmllbGQpOyBcblx0XHRcblx0XHR0aGlzLmluaXRHdWFyZCgpO1xuXHRcdFxuXHRcdGlmKGNvbHVtbil7XG5cdFx0XHRjb2x1bW4uaGlkZSgpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBIaWRlIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmaWVsZCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cdFxuXHR0b2dnbGVDb2x1bW4oZmllbGQpe1xuXHRcdHZhciBjb2x1bW4gPSB0aGlzLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihmaWVsZCk7XG5cdFx0XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRpZihjb2x1bW4pe1xuXHRcdFx0aWYoY29sdW1uLnZpc2libGUpe1xuXHRcdFx0XHRjb2x1bW4uaGlkZSgpO1xuXHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRjb2x1bW4uc2hvdygpO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBWaXNpYmlsaXR5IFRvZ2dsZSBFcnJvciAtIE5vIG1hdGNoaW5nIGNvbHVtbiBmb3VuZDpcIiwgZmllbGQpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXHRcblx0YWRkQ29sdW1uKGRlZmluaXRpb24sIGJlZm9yZSwgZmllbGQpe1xuXHRcdHZhciBjb2x1bW4gPSB0aGlzLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihmaWVsZCk7XG5cdFx0XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5jb2x1bW5NYW5hZ2VyLmFkZENvbHVtbihkZWZpbml0aW9uLCBiZWZvcmUsIGNvbHVtbilcblx0XHRcdC50aGVuKChjb2x1bW4pID0+IHtcblx0XHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRDb21wb25lbnQoKTtcblx0XHRcdH0pO1xuXHR9XG5cdFxuXHRkZWxldGVDb2x1bW4oZmllbGQpe1xuXHRcdHZhciBjb2x1bW4gPSB0aGlzLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihmaWVsZCk7XG5cdFx0XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRpZihjb2x1bW4pe1xuXHRcdFx0cmV0dXJuIGNvbHVtbi5kZWxldGUoKTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJDb2x1bW4gRGVsZXRlIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmaWVsZCk7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcblx0XHR9XG5cdH1cblx0XG5cdHVwZGF0ZUNvbHVtbkRlZmluaXRpb24oZmllbGQsIGRlZmluaXRpb24pe1xuXHRcdHZhciBjb2x1bW4gPSB0aGlzLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihmaWVsZCk7XG5cdFx0XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRpZihjb2x1bW4pe1xuXHRcdFx0cmV0dXJuIGNvbHVtbi51cGRhdGVEZWZpbml0aW9uKGRlZmluaXRpb24pO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBVcGRhdGUgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGZpZWxkKTtcblx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuXHRcdH1cblx0fVxuXHRcblx0bW92ZUNvbHVtbihmcm9tLCB0bywgYWZ0ZXIpe1xuXHRcdHZhciBmcm9tQ29sdW1uID0gdGhpcy5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZnJvbSksXG5cdFx0dG9Db2x1bW4gPSB0aGlzLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbih0byk7XG5cdFx0XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblx0XHRcblx0XHRpZihmcm9tQ29sdW1uKXtcblx0XHRcdGlmKHRvQ29sdW1uKXtcblx0XHRcdFx0dGhpcy5jb2x1bW5NYW5hZ2VyLm1vdmVDb2x1bW4oZnJvbUNvbHVtbiwgdG9Db2x1bW4sIGFmdGVyKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiTW92ZSBFcnJvciAtIE5vIG1hdGNoaW5nIGNvbHVtbiBmb3VuZDpcIiwgdG9Db2x1bW4pO1xuXHRcdFx0fVxuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIk1vdmUgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGZyb20pO1xuXHRcdH1cblx0fVxuXHRcblx0Ly9zY3JvbGwgdG8gY29sdW1uIGluIERPTVxuXHRzY3JvbGxUb0NvbHVtbihmaWVsZCwgcG9zaXRpb24sIGlmVmlzaWJsZSl7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdHZhciBjb2x1bW4gPSB0aGlzLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihmaWVsZCk7XG5cdFx0XHRcblx0XHRcdGlmKGNvbHVtbil7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNvbHVtbk1hbmFnZXIuc2Nyb2xsVG9Db2x1bW4oY29sdW1uLCBwb3NpdGlvbiwgaWZWaXNpYmxlKTtcblx0XHRcdH1lbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiU2Nyb2xsIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmaWVsZCk7XG5cdFx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChcIlNjcm9sbCBFcnJvciAtIE5vIG1hdGNoaW5nIGNvbHVtbiBmb3VuZFwiKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vIEdlbmVyYWwgUHVibGljIEZ1bmN0aW9ucyAvLy8vLy8vLy8vLy9cblx0Ly9yZWRyYXcgbGlzdCB3aXRob3V0IHVwZGF0aW5nIGRhdGFcblx0cmVkcmF3KGZvcmNlKXtcblx0XHR0aGlzLmluaXRHdWFyZCgpO1xuXG5cdFx0dGhpcy5jb2x1bW5NYW5hZ2VyLnJlZHJhdyhmb3JjZSk7XG5cdFx0dGhpcy5yb3dNYW5hZ2VyLnJlZHJhdyhmb3JjZSk7XG5cdH1cblx0XG5cdHNldEhlaWdodChoZWlnaHQpe1xuXHRcdHRoaXMub3B0aW9ucy5oZWlnaHQgPSBpc05hTihoZWlnaHQpID8gaGVpZ2h0IDogaGVpZ2h0ICsgXCJweFwiO1xuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLm9wdGlvbnMuaGVpZ2h0O1xuXHRcdHRoaXMucm93TWFuYWdlci5pbml0aWFsaXplUmVuZGVyZXIoKTtcblx0XHR0aGlzLnJvd01hbmFnZXIucmVkcmF3KHRydWUpO1xuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLyBFdmVudCBCdXMgLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0b24oa2V5LCBjYWxsYmFjayl7XG5cdFx0dGhpcy5leHRlcm5hbEV2ZW50cy5zdWJzY3JpYmUoa2V5LCBjYWxsYmFjayk7XG5cdH1cblx0XG5cdG9mZihrZXksIGNhbGxiYWNrKXtcblx0XHR0aGlzLmV4dGVybmFsRXZlbnRzLnVuc3Vic2NyaWJlKGtleSwgY2FsbGJhY2spO1xuXHR9XG5cdFxuXHRkaXNwYXRjaEV2ZW50KCl7XG5cdFx0dmFyIGFyZ3MgPSBBcnJheS5mcm9tKGFyZ3VtZW50cyk7XG5cdFx0YXJncy5zaGlmdCgpO1xuXHRcdFxuXHRcdHRoaXMuZXh0ZXJuYWxFdmVudHMuZGlzcGF0Y2goLi4uYXJndW1lbnRzKTtcblx0fVxuXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vIEFsZXJ0cyAvLy8vLy8vLy8vLy8vLy8vLy8vXG5cblx0YWxlcnQoY29udGVudHMsIHR5cGUpe1xuXHRcdHRoaXMuaW5pdEd1YXJkKCk7XG5cblx0XHR0aGlzLmFsZXJ0TWFuYWdlci5hbGVydChjb250ZW50cywgdHlwZSk7XG5cdH1cblxuXHRjbGVhckFsZXJ0KCl7XG5cdFx0dGhpcy5pbml0R3VhcmQoKTtcblxuXHRcdHRoaXMuYWxlcnRNYW5hZ2VyLmNsZWFyKCk7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vIEV4dGVuc2lvbiBNYW5hZ2VtZW50IC8vLy8vLy8vLy8vLy8vXG5cdG1vZEV4aXN0cyhwbHVnaW4sIHJlcXVpcmVkKXtcblx0XHRpZih0aGlzLm1vZHVsZXNbcGx1Z2luXSl7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRpZihyZXF1aXJlZCl7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJUYWJ1bGF0b3IgTW9kdWxlIE5vdCBJbnN0YWxsZWQ6IFwiICsgcGx1Z2luKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblx0XG5cdG1vZHVsZShrZXkpe1xuXHRcdHZhciBtb2QgPSB0aGlzLm1vZHVsZXNba2V5XTtcblx0XHRcblx0XHRpZighbW9kKXtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJUYWJ1bGF0b3IgbW9kdWxlIG5vdCBpbnN0YWxsZWQ6IFwiICsga2V5KTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG1vZDtcblx0fVxufVxuXG52YXIgVGFidWxhdG9yJDEgPSBUYWJ1bGF0b3I7XG5cbi8vdGFidWxhdG9yIHdpdGggYWxsIG1vZHVsZXMgaW5zdGFsbGVkXG5cbmNsYXNzIFRhYnVsYXRvckZ1bGwgZXh0ZW5kcyBUYWJ1bGF0b3IkMSB7XG5cdHN0YXRpYyBleHRlbmRNb2R1bGUoKXtcblx0XHRUYWJ1bGF0b3IkMS5pbml0aWFsaXplTW9kdWxlQmluZGVyKGFsbE1vZHVsZXMpO1xuXHRcdFRhYnVsYXRvciQxLl9leHRlbmRNb2R1bGUoLi4uYXJndW1lbnRzKTtcblx0fVxuXG5cdHN0YXRpYyByZWdpc3Rlck1vZHVsZSgpe1xuXHRcdFRhYnVsYXRvciQxLmluaXRpYWxpemVNb2R1bGVCaW5kZXIoYWxsTW9kdWxlcyk7XG5cdFx0VGFidWxhdG9yJDEuX3JlZ2lzdGVyTW9kdWxlKC4uLmFyZ3VtZW50cyk7XG5cdH1cblxuXHRjb25zdHJ1Y3RvcihlbGVtZW50LCBvcHRpb25zLCBtb2R1bGVzKXtcblx0XHRzdXBlcihlbGVtZW50LCBvcHRpb25zLCBhbGxNb2R1bGVzKTtcblx0fVxufVxuXG52YXIgVGFidWxhdG9yRnVsbCQxID0gVGFidWxhdG9yRnVsbDtcblxuY2xhc3MgUHNldWRvUm93IHtcblxuXHRjb25zdHJ1Y3RvciAodHlwZSl7XG5cdFx0dGhpcy50eXBlID0gdHlwZTtcblx0XHR0aGlzLmVsZW1lbnQgPSB0aGlzLl9jcmVhdGVFbGVtZW50KCk7XG5cdH1cblxuXHRfY3JlYXRlRWxlbWVudCgpe1xuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1yb3dcIik7XG5cdFx0cmV0dXJuIGVsO1xuXHR9XG5cblx0Z2V0RWxlbWVudCgpe1xuXHRcdHJldHVybiB0aGlzLmVsZW1lbnQ7XG5cdH1cblxuXHRnZXRDb21wb25lbnQoKXtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRnZXREYXRhKCl7XG5cdFx0cmV0dXJuIHt9O1xuXHR9XG5cblx0Z2V0SGVpZ2h0KCl7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudC5vdXRlckhlaWdodDtcblx0fVxuXG5cdGluaXRpYWxpemUoKXt9XG5cblx0cmVpbml0aWFsaXplKCl7fVxuXG5cdG5vcm1hbGl6ZUhlaWdodCgpe31cblxuXHRnZW5lcmF0ZUNlbGxzKCl7fVxuXG5cdHJlaW5pdGlhbGl6ZUhlaWdodCgpe31cblxuXHRjYWxjSGVpZ2h0KCl7fVxuXG5cdHNldENlbGxIZWlnaHQoKXt9XG5cblx0Y2xlYXJDZWxsSGVpZ2h0KCl7fVxuXG5cdHJlbmRlcmVkKCl7fVxufVxuXG5leHBvcnQgeyBBY2Nlc3NvciBhcyBBY2Nlc3Nvck1vZHVsZSwgQWpheCBhcyBBamF4TW9kdWxlLCBDYWxjQ29tcG9uZW50LCBDZWxsQ29tcG9uZW50LCBDbGlwYm9hcmQgYXMgQ2xpcGJvYXJkTW9kdWxlLCBDb2x1bW5DYWxjcyBhcyBDb2x1bW5DYWxjc01vZHVsZSwgQ29sdW1uQ29tcG9uZW50LCBEYXRhVHJlZSBhcyBEYXRhVHJlZU1vZHVsZSwgRG93bmxvYWQgYXMgRG93bmxvYWRNb2R1bGUsIEVkaXQgYXMgRWRpdE1vZHVsZSwgRXhwb3J0IGFzIEV4cG9ydE1vZHVsZSwgRmlsdGVyIGFzIEZpbHRlck1vZHVsZSwgRm9ybWF0IGFzIEZvcm1hdE1vZHVsZSwgRnJvemVuQ29sdW1ucyBhcyBGcm96ZW5Db2x1bW5zTW9kdWxlLCBGcm96ZW5Sb3dzIGFzIEZyb3plblJvd3NNb2R1bGUsIEdyb3VwQ29tcG9uZW50LCBHcm91cFJvd3MgYXMgR3JvdXBSb3dzTW9kdWxlLCBIaXN0b3J5IGFzIEhpc3RvcnlNb2R1bGUsIEh0bWxUYWJsZUltcG9ydCBhcyBIdG1sVGFibGVJbXBvcnRNb2R1bGUsIEltcG9ydCBhcyBJbXBvcnRNb2R1bGUsIEludGVyYWN0aW9uIGFzIEludGVyYWN0aW9uTW9kdWxlLCBLZXliaW5kaW5ncyBhcyBLZXliaW5kaW5nc01vZHVsZSwgTWVudSBhcyBNZW51TW9kdWxlLCBNb2R1bGUsIE1vdmVDb2x1bW5zIGFzIE1vdmVDb2x1bW5zTW9kdWxlLCBNb3ZlUm93cyBhcyBNb3ZlUm93c01vZHVsZSwgTXV0YXRvciBhcyBNdXRhdG9yTW9kdWxlLCBQYWdlIGFzIFBhZ2VNb2R1bGUsIFBlcnNpc3RlbmNlIGFzIFBlcnNpc3RlbmNlTW9kdWxlLCBQb3B1cCBhcyBQb3B1cE1vZHVsZSwgUHJpbnQgYXMgUHJpbnRNb2R1bGUsIFBzZXVkb1JvdywgUmFuZ2VDb21wb25lbnQsIFJlYWN0aXZlRGF0YSBhcyBSZWFjdGl2ZURhdGFNb2R1bGUsIFJlbmRlcmVyLCBSZXNpemVDb2x1bW5zIGFzIFJlc2l6ZUNvbHVtbnNNb2R1bGUsIFJlc2l6ZVJvd3MgYXMgUmVzaXplUm93c01vZHVsZSwgUmVzaXplVGFibGUgYXMgUmVzaXplVGFibGVNb2R1bGUsIFJlc3BvbnNpdmVMYXlvdXQgYXMgUmVzcG9uc2l2ZUxheW91dE1vZHVsZSwgUm93Q29tcG9uZW50LCBTZWxlY3RSYW5nZSBhcyBTZWxlY3RSYW5nZU1vZHVsZSwgU2VsZWN0Um93IGFzIFNlbGVjdFJvd01vZHVsZSwgU2hlZXRDb21wb25lbnQsIFNvcnQgYXMgU29ydE1vZHVsZSwgU3ByZWFkc2hlZXQgYXMgU3ByZWFkc2hlZXRNb2R1bGUsIFRhYnVsYXRvciQxIGFzIFRhYnVsYXRvciwgVGFidWxhdG9yRnVsbCQxIGFzIFRhYnVsYXRvckZ1bGwsIFRvb2x0aXAgYXMgVG9vbHRpcE1vZHVsZSwgVmFsaWRhdGUgYXMgVmFsaWRhdGVNb2R1bGUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYnVsYXRvcl9lc20uanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/tabulator-tables/dist/js/tabulator_esm.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/clients/WebSocketClient.js":
/*!***************************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/clients/WebSocketClient.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ WebSocketClient)\n/* harmony export */ });\n/* harmony import */ var _utils_log_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/log.js */ \"./node_modules/webpack-dev-server/client/utils/log.js\");\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nvar WebSocketClient = /*#__PURE__*/function () {\n  /**\n   * @param {string} url\n   */\n  function WebSocketClient(url) {\n    _classCallCheck(this, WebSocketClient);\n    this.client = new WebSocket(url);\n    this.client.onerror = function (error) {\n      _utils_log_js__WEBPACK_IMPORTED_MODULE_0__.log.error(error);\n    };\n  }\n\n  /**\n   * @param {(...args: any[]) => void} f\n   */\n  _createClass(WebSocketClient, [{\n    key: \"onOpen\",\n    value: function onOpen(f) {\n      this.client.onopen = f;\n    }\n\n    /**\n     * @param {(...args: any[]) => void} f\n     */\n  }, {\n    key: \"onClose\",\n    value: function onClose(f) {\n      this.client.onclose = f;\n    }\n\n    // call f with the message string as the first argument\n    /**\n     * @param {(...args: any[]) => void} f\n     */\n  }, {\n    key: \"onMessage\",\n    value: function onMessage(f) {\n      this.client.onmessage = function (e) {\n        f(e.data);\n      };\n    }\n  }]);\n  return WebSocketClient;\n}();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9jbGllbnRzL1dlYlNvY2tldENsaWVudC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLGtEQUFrRCwwQ0FBMEM7QUFDNUYsNENBQTRDLGdCQUFnQixrQkFBa0IsT0FBTywyQkFBMkIsd0RBQXdELGdDQUFnQyx1REFBdUQ7QUFDL1AsOERBQThELHNFQUFzRSw4REFBOEQsa0RBQWtELGlCQUFpQixHQUFHO0FBQ3hRLCtCQUErQix1Q0FBdUM7QUFDdEUscUNBQXFDLCtEQUErRCxzQ0FBc0MsMEJBQTBCLCtDQUErQyx5Q0FBeUMsdUVBQXVFO0FBQzdSO0FBQ3RDO0FBQ0E7QUFDQSxhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sOENBQUc7QUFDVDtBQUNBOztBQUVBO0FBQ0EsYUFBYSwwQkFBMEI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSwwQkFBMEI7QUFDekM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsMEJBQTBCO0FBQ3pDO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vbm9kZV9tb2R1bGVzL3dlYnBhY2stZGV2LXNlcnZlci9jbGllbnQvY2xpZW50cy9XZWJTb2NrZXRDbGllbnQuanM/NjI2YiJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBfdG9Qcm9wZXJ0eUtleShkZXNjcmlwdG9yLmtleSksIGRlc2NyaXB0b3IpOyB9IH1cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCBcInByb3RvdHlwZVwiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5mdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleShhcmcpIHsgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsIFwic3RyaW5nXCIpOyByZXR1cm4gdHlwZW9mIGtleSA9PT0gXCJzeW1ib2xcIiA/IGtleSA6IFN0cmluZyhrZXkpOyB9XG5mdW5jdGlvbiBfdG9QcmltaXRpdmUoaW5wdXQsIGhpbnQpIHsgaWYgKHR5cGVvZiBpbnB1dCAhPT0gXCJvYmplY3RcIiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0OyB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmIChwcmltICE9PSB1bmRlZmluZWQpIHsgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCBcImRlZmF1bHRcIik7IGlmICh0eXBlb2YgcmVzICE9PSBcIm9iamVjdFwiKSByZXR1cm4gcmVzOyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS5cIik7IH0gcmV0dXJuIChoaW50ID09PSBcInN0cmluZ1wiID8gU3RyaW5nIDogTnVtYmVyKShpbnB1dCk7IH1cbmltcG9ydCB7IGxvZyB9IGZyb20gXCIuLi91dGlscy9sb2cuanNcIjtcbnZhciBXZWJTb2NrZXRDbGllbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICAgKi9cbiAgZnVuY3Rpb24gV2ViU29ja2V0Q2xpZW50KHVybCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXZWJTb2NrZXRDbGllbnQpO1xuICAgIHRoaXMuY2xpZW50ID0gbmV3IFdlYlNvY2tldCh1cmwpO1xuICAgIHRoaXMuY2xpZW50Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcihlcnJvcik7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZH0gZlxuICAgKi9cbiAgX2NyZWF0ZUNsYXNzKFdlYlNvY2tldENsaWVudCwgW3tcbiAgICBrZXk6IFwib25PcGVuXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9uT3BlbihmKSB7XG4gICAgICB0aGlzLmNsaWVudC5vbm9wZW4gPSBmO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7KC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkfSBmXG4gICAgICovXG4gIH0sIHtcbiAgICBrZXk6IFwib25DbG9zZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNsb3NlKGYpIHtcbiAgICAgIHRoaXMuY2xpZW50Lm9uY2xvc2UgPSBmO1xuICAgIH1cblxuICAgIC8vIGNhbGwgZiB3aXRoIHRoZSBtZXNzYWdlIHN0cmluZyBhcyB0aGUgZmlyc3QgYXJndW1lbnRcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZH0gZlxuICAgICAqL1xuICB9LCB7XG4gICAga2V5OiBcIm9uTWVzc2FnZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbk1lc3NhZ2UoZikge1xuICAgICAgdGhpcy5jbGllbnQub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZihlLmRhdGEpO1xuICAgICAgfTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIFdlYlNvY2tldENsaWVudDtcbn0oKTtcbmV4cG9ydCB7IFdlYlNvY2tldENsaWVudCBhcyBkZWZhdWx0IH07Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/clients/WebSocketClient.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/index.js?protocol=ws%3A&hostname=0.0.0.0&port=3000&pathname=%2Fws&logging=none&overlay=true&reconnect=10&hot=true&live-reload=true":
/*!***********************************************************************************************************************************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/index.js?protocol=ws%3A&hostname=0.0.0.0&port=3000&pathname=%2Fws&logging=none&overlay=true&reconnect=10&hot=true&live-reload=true ***!
  \***********************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{var __resourceQuery = \"?protocol=ws%3A&hostname=0.0.0.0&port=3000&pathname=%2Fws&logging=none&overlay=true&reconnect=10&hot=true&live-reload=true\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var webpack_hot_log_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! webpack/hot/log.js */ \"./node_modules/webpack/hot/log.js\");\n/* harmony import */ var webpack_hot_log_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(webpack_hot_log_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_stripAnsi_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/stripAnsi.js */ \"./node_modules/webpack-dev-server/client/utils/stripAnsi.js\");\n/* harmony import */ var _utils_parseURL_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/parseURL.js */ \"./node_modules/webpack-dev-server/client/utils/parseURL.js\");\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./socket.js */ \"./node_modules/webpack-dev-server/client/socket.js\");\n/* harmony import */ var _overlay_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./overlay.js */ \"./node_modules/webpack-dev-server/client/overlay.js\");\n/* harmony import */ var _utils_log_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils/log.js */ \"./node_modules/webpack-dev-server/client/utils/log.js\");\n/* harmony import */ var _utils_sendMessage_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils/sendMessage.js */ \"./node_modules/webpack-dev-server/client/utils/sendMessage.js\");\n/* harmony import */ var _utils_reloadApp_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils/reloadApp.js */ \"./node_modules/webpack-dev-server/client/utils/reloadApp.js\");\n/* harmony import */ var _utils_createSocketURL_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./utils/createSocketURL.js */ \"./node_modules/webpack-dev-server/client/utils/createSocketURL.js\");\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n/* global __resourceQuery, __webpack_hash__ */\n/// <reference types=\"webpack/module\" />\n\n\n\n\n\n\n\n\n\n\n/**\n * @typedef {Object} OverlayOptions\n * @property {boolean | (error: Error) => boolean} [warnings]\n * @property {boolean | (error: Error) => boolean} [errors]\n * @property {boolean | (error: Error) => boolean} [runtimeErrors]\n * @property {string} [trustedTypesPolicyName]\n */\n\n/**\n * @typedef {Object} Options\n * @property {boolean} hot\n * @property {boolean} liveReload\n * @property {boolean} progress\n * @property {boolean | OverlayOptions} overlay\n * @property {string} [logging]\n * @property {number} [reconnect]\n */\n\n/**\n * @typedef {Object} Status\n * @property {boolean} isUnloading\n * @property {string} currentHash\n * @property {string} [previousHash]\n */\n\n/**\n * @param {boolean | { warnings?: boolean | string; errors?: boolean | string; runtimeErrors?: boolean | string; }} overlayOptions\n */\nvar decodeOverlayOptions = function decodeOverlayOptions(overlayOptions) {\n  if (typeof overlayOptions === \"object\") {\n    [\"warnings\", \"errors\", \"runtimeErrors\"].forEach(function (property) {\n      if (typeof overlayOptions[property] === \"string\") {\n        var overlayFilterFunctionString = decodeURIComponent(overlayOptions[property]);\n\n        // eslint-disable-next-line no-new-func\n        var overlayFilterFunction = new Function(\"message\", \"var callback = \".concat(overlayFilterFunctionString, \"\\n        return callback(message)\"));\n        overlayOptions[property] = overlayFilterFunction;\n      }\n    });\n  }\n};\n\n/**\n * @type {Status}\n */\nvar status = {\n  isUnloading: false,\n  // TODO Workaround for webpack v4, `__webpack_hash__` is not replaced without HotModuleReplacement\n  // eslint-disable-next-line camelcase\n  currentHash:  true ? __webpack_require__.h() : 0\n};\n\n/** @type {Options} */\nvar options = {\n  hot: false,\n  liveReload: false,\n  progress: false,\n  overlay: false\n};\nvar parsedResourceQuery = (0,_utils_parseURL_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(__resourceQuery);\nvar enabledFeatures = {\n  \"Hot Module Replacement\": false,\n  \"Live Reloading\": false,\n  Progress: false,\n  Overlay: false\n};\nif (parsedResourceQuery.hot === \"true\") {\n  options.hot = true;\n  enabledFeatures[\"Hot Module Replacement\"] = true;\n}\nif (parsedResourceQuery[\"live-reload\"] === \"true\") {\n  options.liveReload = true;\n  enabledFeatures[\"Live Reloading\"] = true;\n}\nif (parsedResourceQuery.progress === \"true\") {\n  options.progress = true;\n  enabledFeatures.Progress = true;\n}\nif (parsedResourceQuery.overlay) {\n  try {\n    options.overlay = JSON.parse(parsedResourceQuery.overlay);\n  } catch (e) {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.error(\"Error parsing overlay options from resource query:\", e);\n  }\n\n  // Fill in default \"true\" params for partially-specified objects.\n  if (typeof options.overlay === \"object\") {\n    options.overlay = _objectSpread({\n      errors: true,\n      warnings: true,\n      runtimeErrors: true\n    }, options.overlay);\n    decodeOverlayOptions(options.overlay);\n  }\n  enabledFeatures.Overlay = true;\n}\nif (parsedResourceQuery.logging) {\n  options.logging = parsedResourceQuery.logging;\n}\nif (typeof parsedResourceQuery.reconnect !== \"undefined\") {\n  options.reconnect = Number(parsedResourceQuery.reconnect);\n}\n\n/**\n * @param {string} level\n */\nfunction setAllLogLevel(level) {\n  // This is needed because the HMR logger operate separately from dev server logger\n  webpack_hot_log_js__WEBPACK_IMPORTED_MODULE_0___default().setLogLevel(level === \"verbose\" || level === \"log\" ? \"info\" : level);\n  (0,_utils_log_js__WEBPACK_IMPORTED_MODULE_5__.setLogLevel)(level);\n}\nif (options.logging) {\n  setAllLogLevel(options.logging);\n}\n(0,_utils_log_js__WEBPACK_IMPORTED_MODULE_5__.logEnabledFeatures)(enabledFeatures);\nself.addEventListener(\"beforeunload\", function () {\n  status.isUnloading = true;\n});\nvar overlay = typeof window !== \"undefined\" ? (0,_overlay_js__WEBPACK_IMPORTED_MODULE_4__.createOverlay)(typeof options.overlay === \"object\" ? {\n  trustedTypesPolicyName: options.overlay.trustedTypesPolicyName,\n  catchRuntimeError: options.overlay.runtimeErrors\n} : {\n  trustedTypesPolicyName: false,\n  catchRuntimeError: options.overlay\n}) : {\n  send: function send() {}\n};\nvar onSocketMessage = {\n  hot: function hot() {\n    if (parsedResourceQuery.hot === \"false\") {\n      return;\n    }\n    options.hot = true;\n  },\n  liveReload: function liveReload() {\n    if (parsedResourceQuery[\"live-reload\"] === \"false\") {\n      return;\n    }\n    options.liveReload = true;\n  },\n  invalid: function invalid() {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.info(\"App updated. Recompiling...\");\n\n    // Fixes #1042. overlay doesn't clear if errors are fixed but warnings remain.\n    if (options.overlay) {\n      overlay.send({\n        type: \"DISMISS\"\n      });\n    }\n    (0,_utils_sendMessage_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(\"Invalid\");\n  },\n  /**\n   * @param {string} hash\n   */\n  hash: function hash(_hash) {\n    status.previousHash = status.currentHash;\n    status.currentHash = _hash;\n  },\n  logging: setAllLogLevel,\n  /**\n   * @param {boolean} value\n   */\n  overlay: function overlay(value) {\n    if (typeof document === \"undefined\") {\n      return;\n    }\n    options.overlay = value;\n    decodeOverlayOptions(options.overlay);\n  },\n  /**\n   * @param {number} value\n   */\n  reconnect: function reconnect(value) {\n    if (parsedResourceQuery.reconnect === \"false\") {\n      return;\n    }\n    options.reconnect = value;\n  },\n  /**\n   * @param {boolean} value\n   */\n  progress: function progress(value) {\n    options.progress = value;\n  },\n  /**\n   * @param {{ pluginName?: string, percent: number, msg: string }} data\n   */\n  \"progress-update\": function progressUpdate(data) {\n    if (options.progress) {\n      _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.info(\"\".concat(data.pluginName ? \"[\".concat(data.pluginName, \"] \") : \"\").concat(data.percent, \"% - \").concat(data.msg, \".\"));\n    }\n    (0,_utils_sendMessage_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(\"Progress\", data);\n  },\n  \"still-ok\": function stillOk() {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.info(\"Nothing changed.\");\n    if (options.overlay) {\n      overlay.send({\n        type: \"DISMISS\"\n      });\n    }\n    (0,_utils_sendMessage_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(\"StillOk\");\n  },\n  ok: function ok() {\n    (0,_utils_sendMessage_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(\"Ok\");\n    if (options.overlay) {\n      overlay.send({\n        type: \"DISMISS\"\n      });\n    }\n    (0,_utils_reloadApp_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(options, status);\n  },\n  // TODO: remove in v5 in favor of 'static-changed'\n  /**\n   * @param {string} file\n   */\n  \"content-changed\": function contentChanged(file) {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.info(\"\".concat(file ? \"\\\"\".concat(file, \"\\\"\") : \"Content\", \" from static directory was changed. Reloading...\"));\n    self.location.reload();\n  },\n  /**\n   * @param {string} file\n   */\n  \"static-changed\": function staticChanged(file) {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.info(\"\".concat(file ? \"\\\"\".concat(file, \"\\\"\") : \"Content\", \" from static directory was changed. Reloading...\"));\n    self.location.reload();\n  },\n  /**\n   * @param {Error[]} warnings\n   * @param {any} params\n   */\n  warnings: function warnings(_warnings, params) {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.warn(\"Warnings while compiling.\");\n    var printableWarnings = _warnings.map(function (error) {\n      var _formatProblem = (0,_overlay_js__WEBPACK_IMPORTED_MODULE_4__.formatProblem)(\"warning\", error),\n        header = _formatProblem.header,\n        body = _formatProblem.body;\n      return \"\".concat(header, \"\\n\").concat((0,_utils_stripAnsi_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(body));\n    });\n    (0,_utils_sendMessage_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(\"Warnings\", printableWarnings);\n    for (var i = 0; i < printableWarnings.length; i++) {\n      _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.warn(printableWarnings[i]);\n    }\n    var overlayWarningsSetting = typeof options.overlay === \"boolean\" ? options.overlay : options.overlay && options.overlay.warnings;\n    if (overlayWarningsSetting) {\n      var warningsToDisplay = typeof overlayWarningsSetting === \"function\" ? _warnings.filter(overlayWarningsSetting) : _warnings;\n      if (warningsToDisplay.length) {\n        overlay.send({\n          type: \"BUILD_ERROR\",\n          level: \"warning\",\n          messages: _warnings\n        });\n      }\n    }\n    if (params && params.preventReloading) {\n      return;\n    }\n    (0,_utils_reloadApp_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(options, status);\n  },\n  /**\n   * @param {Error[]} errors\n   */\n  errors: function errors(_errors) {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.error(\"Errors while compiling. Reload prevented.\");\n    var printableErrors = _errors.map(function (error) {\n      var _formatProblem2 = (0,_overlay_js__WEBPACK_IMPORTED_MODULE_4__.formatProblem)(\"error\", error),\n        header = _formatProblem2.header,\n        body = _formatProblem2.body;\n      return \"\".concat(header, \"\\n\").concat((0,_utils_stripAnsi_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(body));\n    });\n    (0,_utils_sendMessage_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(\"Errors\", printableErrors);\n    for (var i = 0; i < printableErrors.length; i++) {\n      _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.error(printableErrors[i]);\n    }\n    var overlayErrorsSettings = typeof options.overlay === \"boolean\" ? options.overlay : options.overlay && options.overlay.errors;\n    if (overlayErrorsSettings) {\n      var errorsToDisplay = typeof overlayErrorsSettings === \"function\" ? _errors.filter(overlayErrorsSettings) : _errors;\n      if (errorsToDisplay.length) {\n        overlay.send({\n          type: \"BUILD_ERROR\",\n          level: \"error\",\n          messages: _errors\n        });\n      }\n    }\n  },\n  /**\n   * @param {Error} error\n   */\n  error: function error(_error) {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.error(_error);\n  },\n  close: function close() {\n    _utils_log_js__WEBPACK_IMPORTED_MODULE_5__.log.info(\"Disconnected!\");\n    if (options.overlay) {\n      overlay.send({\n        type: \"DISMISS\"\n      });\n    }\n    (0,_utils_sendMessage_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(\"Close\");\n  }\n};\nvar socketURL = (0,_utils_createSocketURL_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(parsedResourceQuery);\n(0,_socket_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(socketURL, onSocketMessage, options.reconnect);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9pbmRleC5qcz9wcm90b2NvbD13cyUzQSZob3N0bmFtZT0wLjAuMC4wJnBvcnQ9MzAwMCZwYXRobmFtZT0lMkZ3cyZsb2dnaW5nPW5vbmUmb3ZlcmxheT10cnVlJnJlY29ubmVjdD0xMCZob3Q9dHJ1ZSZsaXZlLXJlbG9hZD10cnVlIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLDJDQUEyQyxnQ0FBZ0Msb0NBQW9DLG9EQUFvRCw2REFBNkQsaUVBQWlFLHNDQUFzQztBQUN2VSxpQ0FBaUMsZ0JBQWdCLHNCQUFzQixPQUFPLHVEQUF1RCw2REFBNkQsNENBQTRDLG9LQUFvSyxtRkFBbUYsS0FBSztBQUMxZSw0Q0FBNEMsMkJBQTJCLGtCQUFrQixrQ0FBa0Msb0VBQW9FLEtBQUssT0FBTyxvQkFBb0I7QUFDL04sK0JBQStCLHVDQUF1QztBQUN0RSxxQ0FBcUMsK0RBQStELHNDQUFzQywwQkFBMEIsK0NBQStDLHlDQUF5Qyx1RUFBdUU7QUFDblU7QUFDQTtBQUMrQztBQUNGO0FBQ0Y7QUFDVjtBQUMyQjtBQUNVO0FBQ3JCO0FBQ0o7QUFDWTs7QUFFekQ7QUFDQSxhQUFhLFFBQVE7QUFDckIsY0FBYyxxQ0FBcUM7QUFDbkQsY0FBYyxxQ0FBcUM7QUFDbkQsY0FBYyxxQ0FBcUM7QUFDbkQsY0FBYyxRQUFRO0FBQ3RCOztBQUVBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCLGNBQWMsU0FBUztBQUN2QixjQUFjLFNBQVM7QUFDdkIsY0FBYyxTQUFTO0FBQ3ZCLGNBQWMsMEJBQTBCO0FBQ3hDLGNBQWMsUUFBUTtBQUN0QixjQUFjLFFBQVE7QUFDdEI7O0FBRUE7QUFDQSxhQUFhLFFBQVE7QUFDckIsY0FBYyxTQUFTO0FBQ3ZCLGNBQWMsUUFBUTtBQUN0QixjQUFjLFFBQVE7QUFDdEI7O0FBRUE7QUFDQSxXQUFXLFlBQVksNkJBQTZCLDJCQUEyQixxQ0FBcUM7QUFDcEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsS0FBdUMsR0FBRyx1QkFBZ0IsR0FBRyxDQUFFO0FBQzlFOztBQUVBLFdBQVcsU0FBUztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsOERBQVEsQ0FBQyxlQUFlO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixJQUFJLDhDQUFHO0FBQ1A7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLEVBQUUscUVBQXlCO0FBQzNCLEVBQUUsMERBQVc7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFrQjtBQUNsQjtBQUNBO0FBQ0EsQ0FBQztBQUNELDhDQUE4QywwREFBYTtBQUMzRDtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsSUFBSSw4Q0FBRzs7QUFFUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLElBQUksaUVBQVc7QUFDZixHQUFHO0FBQ0g7QUFDQSxhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGFBQWEsU0FBUztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxhQUFhLFNBQVM7QUFDdEI7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsZUFBZSxxREFBcUQ7QUFDcEU7QUFDQTtBQUNBO0FBQ0EsTUFBTSw4Q0FBRztBQUNUO0FBQ0EsSUFBSSxpRUFBVztBQUNmLEdBQUc7QUFDSDtBQUNBLElBQUksOENBQUc7QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxJQUFJLGlFQUFXO0FBQ2YsR0FBRztBQUNIO0FBQ0EsSUFBSSxpRUFBVztBQUNmO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLElBQUksK0RBQVM7QUFDYixHQUFHO0FBQ0g7QUFDQTtBQUNBLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0EsSUFBSSw4Q0FBRztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQSxJQUFJLDhDQUFHO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQSxhQUFhLFNBQVM7QUFDdEIsYUFBYSxLQUFLO0FBQ2xCO0FBQ0E7QUFDQSxJQUFJLDhDQUFHO0FBQ1A7QUFDQSwyQkFBMkIsMERBQWE7QUFDeEM7QUFDQTtBQUNBLDRDQUE0QywrREFBUztBQUNyRCxLQUFLO0FBQ0wsSUFBSSxpRUFBVztBQUNmLG9CQUFvQiw4QkFBOEI7QUFDbEQsTUFBTSw4Q0FBRztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSwrREFBUztBQUNiLEdBQUc7QUFDSDtBQUNBLGFBQWEsU0FBUztBQUN0QjtBQUNBO0FBQ0EsSUFBSSw4Q0FBRztBQUNQO0FBQ0EsNEJBQTRCLDBEQUFhO0FBQ3pDO0FBQ0E7QUFDQSw0Q0FBNEMsK0RBQVM7QUFDckQsS0FBSztBQUNMLElBQUksaUVBQVc7QUFDZixvQkFBb0IsNEJBQTRCO0FBQ2hELE1BQU0sOENBQUc7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGFBQWEsT0FBTztBQUNwQjtBQUNBO0FBQ0EsSUFBSSw4Q0FBRztBQUNQLEdBQUc7QUFDSDtBQUNBLElBQUksOENBQUc7QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxJQUFJLGlFQUFXO0FBQ2Y7QUFDQTtBQUNBLGdCQUFnQixxRUFBZTtBQUMvQixzREFBTSIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9pbmRleC5qcz85ODIyIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBlbnVtZXJhYmxlT25seSAmJiAoc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pKSwga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9XG5mdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gbnVsbCAhPSBhcmd1bWVudHNbaV0gPyBhcmd1bWVudHNbaV0gOiB7fTsgaSAlIDIgPyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gcmV0dXJuIHRhcmdldDsgfVxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBrZXkgPSBfdG9Qcm9wZXJ0eUtleShrZXkpOyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH1cbmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGFyZykgeyB2YXIga2V5ID0gX3RvUHJpbWl0aXZlKGFyZywgXCJzdHJpbmdcIik7IHJldHVybiB0eXBlb2Yga2V5ID09PSBcInN5bWJvbFwiID8ga2V5IDogU3RyaW5nKGtleSk7IH1cbmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkgeyBpZiAodHlwZW9mIGlucHV0ICE9PSBcIm9iamVjdFwiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7IHZhciBwcmltID0gaW5wdXRbU3ltYm9sLnRvUHJpbWl0aXZlXTsgaWYgKHByaW0gIT09IHVuZGVmaW5lZCkgeyB2YXIgcmVzID0gcHJpbS5jYWxsKGlucHV0LCBoaW50IHx8IFwiZGVmYXVsdFwiKTsgaWYgKHR5cGVvZiByZXMgIT09IFwib2JqZWN0XCIpIHJldHVybiByZXM7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLlwiKTsgfSByZXR1cm4gKGhpbnQgPT09IFwic3RyaW5nXCIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTsgfVxuLyogZ2xvYmFsIF9fcmVzb3VyY2VRdWVyeSwgX193ZWJwYWNrX2hhc2hfXyAqL1xuLy8vIDxyZWZlcmVuY2UgdHlwZXM9XCJ3ZWJwYWNrL21vZHVsZVwiIC8+XG5pbXBvcnQgd2VicGFja0hvdExvZyBmcm9tIFwid2VicGFjay9ob3QvbG9nLmpzXCI7XG5pbXBvcnQgc3RyaXBBbnNpIGZyb20gXCIuL3V0aWxzL3N0cmlwQW5zaS5qc1wiO1xuaW1wb3J0IHBhcnNlVVJMIGZyb20gXCIuL3V0aWxzL3BhcnNlVVJMLmpzXCI7XG5pbXBvcnQgc29ja2V0IGZyb20gXCIuL3NvY2tldC5qc1wiO1xuaW1wb3J0IHsgZm9ybWF0UHJvYmxlbSwgY3JlYXRlT3ZlcmxheSB9IGZyb20gXCIuL292ZXJsYXkuanNcIjtcbmltcG9ydCB7IGxvZywgbG9nRW5hYmxlZEZlYXR1cmVzLCBzZXRMb2dMZXZlbCB9IGZyb20gXCIuL3V0aWxzL2xvZy5qc1wiO1xuaW1wb3J0IHNlbmRNZXNzYWdlIGZyb20gXCIuL3V0aWxzL3NlbmRNZXNzYWdlLmpzXCI7XG5pbXBvcnQgcmVsb2FkQXBwIGZyb20gXCIuL3V0aWxzL3JlbG9hZEFwcC5qc1wiO1xuaW1wb3J0IGNyZWF0ZVNvY2tldFVSTCBmcm9tIFwiLi91dGlscy9jcmVhdGVTb2NrZXRVUkwuanNcIjtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBPdmVybGF5T3B0aW9uc1xuICogQHByb3BlcnR5IHtib29sZWFuIHwgKGVycm9yOiBFcnJvcikgPT4gYm9vbGVhbn0gW3dhcm5pbmdzXVxuICogQHByb3BlcnR5IHtib29sZWFuIHwgKGVycm9yOiBFcnJvcikgPT4gYm9vbGVhbn0gW2Vycm9yc11cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbiB8IChlcnJvcjogRXJyb3IpID0+IGJvb2xlYW59IFtydW50aW1lRXJyb3JzXVxuICogQHByb3BlcnR5IHtzdHJpbmd9IFt0cnVzdGVkVHlwZXNQb2xpY3lOYW1lXVxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gT3B0aW9uc1xuICogQHByb3BlcnR5IHtib29sZWFufSBob3RcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gbGl2ZVJlbG9hZFxuICogQHByb3BlcnR5IHtib29sZWFufSBwcm9ncmVzc1xuICogQHByb3BlcnR5IHtib29sZWFuIHwgT3ZlcmxheU9wdGlvbnN9IG92ZXJsYXlcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbbG9nZ2luZ11cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbcmVjb25uZWN0XVxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU3RhdHVzXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGlzVW5sb2FkaW5nXG4gKiBAcHJvcGVydHkge3N0cmluZ30gY3VycmVudEhhc2hcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbcHJldmlvdXNIYXNoXVxuICovXG5cbi8qKlxuICogQHBhcmFtIHtib29sZWFuIHwgeyB3YXJuaW5ncz86IGJvb2xlYW4gfCBzdHJpbmc7IGVycm9ycz86IGJvb2xlYW4gfCBzdHJpbmc7IHJ1bnRpbWVFcnJvcnM/OiBib29sZWFuIHwgc3RyaW5nOyB9fSBvdmVybGF5T3B0aW9uc1xuICovXG52YXIgZGVjb2RlT3ZlcmxheU9wdGlvbnMgPSBmdW5jdGlvbiBkZWNvZGVPdmVybGF5T3B0aW9ucyhvdmVybGF5T3B0aW9ucykge1xuICBpZiAodHlwZW9mIG92ZXJsYXlPcHRpb25zID09PSBcIm9iamVjdFwiKSB7XG4gICAgW1wid2FybmluZ3NcIiwgXCJlcnJvcnNcIiwgXCJydW50aW1lRXJyb3JzXCJdLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICBpZiAodHlwZW9mIG92ZXJsYXlPcHRpb25zW3Byb3BlcnR5XSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgb3ZlcmxheUZpbHRlckZ1bmN0aW9uU3RyaW5nID0gZGVjb2RlVVJJQ29tcG9uZW50KG92ZXJsYXlPcHRpb25zW3Byb3BlcnR5XSk7XG5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW5ldy1mdW5jXG4gICAgICAgIHZhciBvdmVybGF5RmlsdGVyRnVuY3Rpb24gPSBuZXcgRnVuY3Rpb24oXCJtZXNzYWdlXCIsIFwidmFyIGNhbGxiYWNrID0gXCIuY29uY2F0KG92ZXJsYXlGaWx0ZXJGdW5jdGlvblN0cmluZywgXCJcXG4gICAgICAgIHJldHVybiBjYWxsYmFjayhtZXNzYWdlKVwiKSk7XG4gICAgICAgIG92ZXJsYXlPcHRpb25zW3Byb3BlcnR5XSA9IG92ZXJsYXlGaWx0ZXJGdW5jdGlvbjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufTtcblxuLyoqXG4gKiBAdHlwZSB7U3RhdHVzfVxuICovXG52YXIgc3RhdHVzID0ge1xuICBpc1VubG9hZGluZzogZmFsc2UsXG4gIC8vIFRPRE8gV29ya2Fyb3VuZCBmb3Igd2VicGFjayB2NCwgYF9fd2VicGFja19oYXNoX19gIGlzIG5vdCByZXBsYWNlZCB3aXRob3V0IEhvdE1vZHVsZVJlcGxhY2VtZW50XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgY3VycmVudEhhc2g6IHR5cGVvZiBfX3dlYnBhY2tfaGFzaF9fICE9PSBcInVuZGVmaW5lZFwiID8gX193ZWJwYWNrX2hhc2hfXyA6IFwiXCJcbn07XG5cbi8qKiBAdHlwZSB7T3B0aW9uc30gKi9cbnZhciBvcHRpb25zID0ge1xuICBob3Q6IGZhbHNlLFxuICBsaXZlUmVsb2FkOiBmYWxzZSxcbiAgcHJvZ3Jlc3M6IGZhbHNlLFxuICBvdmVybGF5OiBmYWxzZVxufTtcbnZhciBwYXJzZWRSZXNvdXJjZVF1ZXJ5ID0gcGFyc2VVUkwoX19yZXNvdXJjZVF1ZXJ5KTtcbnZhciBlbmFibGVkRmVhdHVyZXMgPSB7XG4gIFwiSG90IE1vZHVsZSBSZXBsYWNlbWVudFwiOiBmYWxzZSxcbiAgXCJMaXZlIFJlbG9hZGluZ1wiOiBmYWxzZSxcbiAgUHJvZ3Jlc3M6IGZhbHNlLFxuICBPdmVybGF5OiBmYWxzZVxufTtcbmlmIChwYXJzZWRSZXNvdXJjZVF1ZXJ5LmhvdCA9PT0gXCJ0cnVlXCIpIHtcbiAgb3B0aW9ucy5ob3QgPSB0cnVlO1xuICBlbmFibGVkRmVhdHVyZXNbXCJIb3QgTW9kdWxlIFJlcGxhY2VtZW50XCJdID0gdHJ1ZTtcbn1cbmlmIChwYXJzZWRSZXNvdXJjZVF1ZXJ5W1wibGl2ZS1yZWxvYWRcIl0gPT09IFwidHJ1ZVwiKSB7XG4gIG9wdGlvbnMubGl2ZVJlbG9hZCA9IHRydWU7XG4gIGVuYWJsZWRGZWF0dXJlc1tcIkxpdmUgUmVsb2FkaW5nXCJdID0gdHJ1ZTtcbn1cbmlmIChwYXJzZWRSZXNvdXJjZVF1ZXJ5LnByb2dyZXNzID09PSBcInRydWVcIikge1xuICBvcHRpb25zLnByb2dyZXNzID0gdHJ1ZTtcbiAgZW5hYmxlZEZlYXR1cmVzLlByb2dyZXNzID0gdHJ1ZTtcbn1cbmlmIChwYXJzZWRSZXNvdXJjZVF1ZXJ5Lm92ZXJsYXkpIHtcbiAgdHJ5IHtcbiAgICBvcHRpb25zLm92ZXJsYXkgPSBKU09OLnBhcnNlKHBhcnNlZFJlc291cmNlUXVlcnkub3ZlcmxheSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2cuZXJyb3IoXCJFcnJvciBwYXJzaW5nIG92ZXJsYXkgb3B0aW9ucyBmcm9tIHJlc291cmNlIHF1ZXJ5OlwiLCBlKTtcbiAgfVxuXG4gIC8vIEZpbGwgaW4gZGVmYXVsdCBcInRydWVcIiBwYXJhbXMgZm9yIHBhcnRpYWxseS1zcGVjaWZpZWQgb2JqZWN0cy5cbiAgaWYgKHR5cGVvZiBvcHRpb25zLm92ZXJsYXkgPT09IFwib2JqZWN0XCIpIHtcbiAgICBvcHRpb25zLm92ZXJsYXkgPSBfb2JqZWN0U3ByZWFkKHtcbiAgICAgIGVycm9yczogdHJ1ZSxcbiAgICAgIHdhcm5pbmdzOiB0cnVlLFxuICAgICAgcnVudGltZUVycm9yczogdHJ1ZVxuICAgIH0sIG9wdGlvbnMub3ZlcmxheSk7XG4gICAgZGVjb2RlT3ZlcmxheU9wdGlvbnMob3B0aW9ucy5vdmVybGF5KTtcbiAgfVxuICBlbmFibGVkRmVhdHVyZXMuT3ZlcmxheSA9IHRydWU7XG59XG5pZiAocGFyc2VkUmVzb3VyY2VRdWVyeS5sb2dnaW5nKSB7XG4gIG9wdGlvbnMubG9nZ2luZyA9IHBhcnNlZFJlc291cmNlUXVlcnkubG9nZ2luZztcbn1cbmlmICh0eXBlb2YgcGFyc2VkUmVzb3VyY2VRdWVyeS5yZWNvbm5lY3QgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgb3B0aW9ucy5yZWNvbm5lY3QgPSBOdW1iZXIocGFyc2VkUmVzb3VyY2VRdWVyeS5yZWNvbm5lY3QpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBsZXZlbFxuICovXG5mdW5jdGlvbiBzZXRBbGxMb2dMZXZlbChsZXZlbCkge1xuICAvLyBUaGlzIGlzIG5lZWRlZCBiZWNhdXNlIHRoZSBITVIgbG9nZ2VyIG9wZXJhdGUgc2VwYXJhdGVseSBmcm9tIGRldiBzZXJ2ZXIgbG9nZ2VyXG4gIHdlYnBhY2tIb3RMb2cuc2V0TG9nTGV2ZWwobGV2ZWwgPT09IFwidmVyYm9zZVwiIHx8IGxldmVsID09PSBcImxvZ1wiID8gXCJpbmZvXCIgOiBsZXZlbCk7XG4gIHNldExvZ0xldmVsKGxldmVsKTtcbn1cbmlmIChvcHRpb25zLmxvZ2dpbmcpIHtcbiAgc2V0QWxsTG9nTGV2ZWwob3B0aW9ucy5sb2dnaW5nKTtcbn1cbmxvZ0VuYWJsZWRGZWF0dXJlcyhlbmFibGVkRmVhdHVyZXMpO1xuc2VsZi5hZGRFdmVudExpc3RlbmVyKFwiYmVmb3JldW5sb2FkXCIsIGZ1bmN0aW9uICgpIHtcbiAgc3RhdHVzLmlzVW5sb2FkaW5nID0gdHJ1ZTtcbn0pO1xudmFyIG92ZXJsYXkgPSB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gY3JlYXRlT3ZlcmxheSh0eXBlb2Ygb3B0aW9ucy5vdmVybGF5ID09PSBcIm9iamVjdFwiID8ge1xuICB0cnVzdGVkVHlwZXNQb2xpY3lOYW1lOiBvcHRpb25zLm92ZXJsYXkudHJ1c3RlZFR5cGVzUG9saWN5TmFtZSxcbiAgY2F0Y2hSdW50aW1lRXJyb3I6IG9wdGlvbnMub3ZlcmxheS5ydW50aW1lRXJyb3JzXG59IDoge1xuICB0cnVzdGVkVHlwZXNQb2xpY3lOYW1lOiBmYWxzZSxcbiAgY2F0Y2hSdW50aW1lRXJyb3I6IG9wdGlvbnMub3ZlcmxheVxufSkgOiB7XG4gIHNlbmQ6IGZ1bmN0aW9uIHNlbmQoKSB7fVxufTtcbnZhciBvblNvY2tldE1lc3NhZ2UgPSB7XG4gIGhvdDogZnVuY3Rpb24gaG90KCkge1xuICAgIGlmIChwYXJzZWRSZXNvdXJjZVF1ZXJ5LmhvdCA9PT0gXCJmYWxzZVwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG9wdGlvbnMuaG90ID0gdHJ1ZTtcbiAgfSxcbiAgbGl2ZVJlbG9hZDogZnVuY3Rpb24gbGl2ZVJlbG9hZCgpIHtcbiAgICBpZiAocGFyc2VkUmVzb3VyY2VRdWVyeVtcImxpdmUtcmVsb2FkXCJdID09PSBcImZhbHNlXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgb3B0aW9ucy5saXZlUmVsb2FkID0gdHJ1ZTtcbiAgfSxcbiAgaW52YWxpZDogZnVuY3Rpb24gaW52YWxpZCgpIHtcbiAgICBsb2cuaW5mbyhcIkFwcCB1cGRhdGVkLiBSZWNvbXBpbGluZy4uLlwiKTtcblxuICAgIC8vIEZpeGVzICMxMDQyLiBvdmVybGF5IGRvZXNuJ3QgY2xlYXIgaWYgZXJyb3JzIGFyZSBmaXhlZCBidXQgd2FybmluZ3MgcmVtYWluLlxuICAgIGlmIChvcHRpb25zLm92ZXJsYXkpIHtcbiAgICAgIG92ZXJsYXkuc2VuZCh7XG4gICAgICAgIHR5cGU6IFwiRElTTUlTU1wiXG4gICAgICB9KTtcbiAgICB9XG4gICAgc2VuZE1lc3NhZ2UoXCJJbnZhbGlkXCIpO1xuICB9LFxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGhhc2hcbiAgICovXG4gIGhhc2g6IGZ1bmN0aW9uIGhhc2goX2hhc2gpIHtcbiAgICBzdGF0dXMucHJldmlvdXNIYXNoID0gc3RhdHVzLmN1cnJlbnRIYXNoO1xuICAgIHN0YXR1cy5jdXJyZW50SGFzaCA9IF9oYXNoO1xuICB9LFxuICBsb2dnaW5nOiBzZXRBbGxMb2dMZXZlbCxcbiAgLyoqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsdWVcbiAgICovXG4gIG92ZXJsYXk6IGZ1bmN0aW9uIG92ZXJsYXkodmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG9wdGlvbnMub3ZlcmxheSA9IHZhbHVlO1xuICAgIGRlY29kZU92ZXJsYXlPcHRpb25zKG9wdGlvbnMub3ZlcmxheSk7XG4gIH0sXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAgICovXG4gIHJlY29ubmVjdDogZnVuY3Rpb24gcmVjb25uZWN0KHZhbHVlKSB7XG4gICAgaWYgKHBhcnNlZFJlc291cmNlUXVlcnkucmVjb25uZWN0ID09PSBcImZhbHNlXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgb3B0aW9ucy5yZWNvbm5lY3QgPSB2YWx1ZTtcbiAgfSxcbiAgLyoqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsdWVcbiAgICovXG4gIHByb2dyZXNzOiBmdW5jdGlvbiBwcm9ncmVzcyh2YWx1ZSkge1xuICAgIG9wdGlvbnMucHJvZ3Jlc3MgPSB2YWx1ZTtcbiAgfSxcbiAgLyoqXG4gICAqIEBwYXJhbSB7eyBwbHVnaW5OYW1lPzogc3RyaW5nLCBwZXJjZW50OiBudW1iZXIsIG1zZzogc3RyaW5nIH19IGRhdGFcbiAgICovXG4gIFwicHJvZ3Jlc3MtdXBkYXRlXCI6IGZ1bmN0aW9uIHByb2dyZXNzVXBkYXRlKGRhdGEpIHtcbiAgICBpZiAob3B0aW9ucy5wcm9ncmVzcykge1xuICAgICAgbG9nLmluZm8oXCJcIi5jb25jYXQoZGF0YS5wbHVnaW5OYW1lID8gXCJbXCIuY29uY2F0KGRhdGEucGx1Z2luTmFtZSwgXCJdIFwiKSA6IFwiXCIpLmNvbmNhdChkYXRhLnBlcmNlbnQsIFwiJSAtIFwiKS5jb25jYXQoZGF0YS5tc2csIFwiLlwiKSk7XG4gICAgfVxuICAgIHNlbmRNZXNzYWdlKFwiUHJvZ3Jlc3NcIiwgZGF0YSk7XG4gIH0sXG4gIFwic3RpbGwtb2tcIjogZnVuY3Rpb24gc3RpbGxPaygpIHtcbiAgICBsb2cuaW5mbyhcIk5vdGhpbmcgY2hhbmdlZC5cIik7XG4gICAgaWYgKG9wdGlvbnMub3ZlcmxheSkge1xuICAgICAgb3ZlcmxheS5zZW5kKHtcbiAgICAgICAgdHlwZTogXCJESVNNSVNTXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kTWVzc2FnZShcIlN0aWxsT2tcIik7XG4gIH0sXG4gIG9rOiBmdW5jdGlvbiBvaygpIHtcbiAgICBzZW5kTWVzc2FnZShcIk9rXCIpO1xuICAgIGlmIChvcHRpb25zLm92ZXJsYXkpIHtcbiAgICAgIG92ZXJsYXkuc2VuZCh7XG4gICAgICAgIHR5cGU6IFwiRElTTUlTU1wiXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmVsb2FkQXBwKG9wdGlvbnMsIHN0YXR1cyk7XG4gIH0sXG4gIC8vIFRPRE86IHJlbW92ZSBpbiB2NSBpbiBmYXZvciBvZiAnc3RhdGljLWNoYW5nZWQnXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsZVxuICAgKi9cbiAgXCJjb250ZW50LWNoYW5nZWRcIjogZnVuY3Rpb24gY29udGVudENoYW5nZWQoZmlsZSkge1xuICAgIGxvZy5pbmZvKFwiXCIuY29uY2F0KGZpbGUgPyBcIlxcXCJcIi5jb25jYXQoZmlsZSwgXCJcXFwiXCIpIDogXCJDb250ZW50XCIsIFwiIGZyb20gc3RhdGljIGRpcmVjdG9yeSB3YXMgY2hhbmdlZC4gUmVsb2FkaW5nLi4uXCIpKTtcbiAgICBzZWxmLmxvY2F0aW9uLnJlbG9hZCgpO1xuICB9LFxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVcbiAgICovXG4gIFwic3RhdGljLWNoYW5nZWRcIjogZnVuY3Rpb24gc3RhdGljQ2hhbmdlZChmaWxlKSB7XG4gICAgbG9nLmluZm8oXCJcIi5jb25jYXQoZmlsZSA/IFwiXFxcIlwiLmNvbmNhdChmaWxlLCBcIlxcXCJcIikgOiBcIkNvbnRlbnRcIiwgXCIgZnJvbSBzdGF0aWMgZGlyZWN0b3J5IHdhcyBjaGFuZ2VkLiBSZWxvYWRpbmcuLi5cIikpO1xuICAgIHNlbGYubG9jYXRpb24ucmVsb2FkKCk7XG4gIH0sXG4gIC8qKlxuICAgKiBAcGFyYW0ge0Vycm9yW119IHdhcm5pbmdzXG4gICAqIEBwYXJhbSB7YW55fSBwYXJhbXNcbiAgICovXG4gIHdhcm5pbmdzOiBmdW5jdGlvbiB3YXJuaW5ncyhfd2FybmluZ3MsIHBhcmFtcykge1xuICAgIGxvZy53YXJuKFwiV2FybmluZ3Mgd2hpbGUgY29tcGlsaW5nLlwiKTtcbiAgICB2YXIgcHJpbnRhYmxlV2FybmluZ3MgPSBfd2FybmluZ3MubWFwKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgdmFyIF9mb3JtYXRQcm9ibGVtID0gZm9ybWF0UHJvYmxlbShcIndhcm5pbmdcIiwgZXJyb3IpLFxuICAgICAgICBoZWFkZXIgPSBfZm9ybWF0UHJvYmxlbS5oZWFkZXIsXG4gICAgICAgIGJvZHkgPSBfZm9ybWF0UHJvYmxlbS5ib2R5O1xuICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KGhlYWRlciwgXCJcXG5cIikuY29uY2F0KHN0cmlwQW5zaShib2R5KSk7XG4gICAgfSk7XG4gICAgc2VuZE1lc3NhZ2UoXCJXYXJuaW5nc1wiLCBwcmludGFibGVXYXJuaW5ncyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcmludGFibGVXYXJuaW5ncy5sZW5ndGg7IGkrKykge1xuICAgICAgbG9nLndhcm4ocHJpbnRhYmxlV2FybmluZ3NbaV0pO1xuICAgIH1cbiAgICB2YXIgb3ZlcmxheVdhcm5pbmdzU2V0dGluZyA9IHR5cGVvZiBvcHRpb25zLm92ZXJsYXkgPT09IFwiYm9vbGVhblwiID8gb3B0aW9ucy5vdmVybGF5IDogb3B0aW9ucy5vdmVybGF5ICYmIG9wdGlvbnMub3ZlcmxheS53YXJuaW5ncztcbiAgICBpZiAob3ZlcmxheVdhcm5pbmdzU2V0dGluZykge1xuICAgICAgdmFyIHdhcm5pbmdzVG9EaXNwbGF5ID0gdHlwZW9mIG92ZXJsYXlXYXJuaW5nc1NldHRpbmcgPT09IFwiZnVuY3Rpb25cIiA/IF93YXJuaW5ncy5maWx0ZXIob3ZlcmxheVdhcm5pbmdzU2V0dGluZykgOiBfd2FybmluZ3M7XG4gICAgICBpZiAod2FybmluZ3NUb0Rpc3BsYXkubGVuZ3RoKSB7XG4gICAgICAgIG92ZXJsYXkuc2VuZCh7XG4gICAgICAgICAgdHlwZTogXCJCVUlMRF9FUlJPUlwiLFxuICAgICAgICAgIGxldmVsOiBcIndhcm5pbmdcIixcbiAgICAgICAgICBtZXNzYWdlczogX3dhcm5pbmdzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAocGFyYW1zICYmIHBhcmFtcy5wcmV2ZW50UmVsb2FkaW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJlbG9hZEFwcChvcHRpb25zLCBzdGF0dXMpO1xuICB9LFxuICAvKipcbiAgICogQHBhcmFtIHtFcnJvcltdfSBlcnJvcnNcbiAgICovXG4gIGVycm9yczogZnVuY3Rpb24gZXJyb3JzKF9lcnJvcnMpIHtcbiAgICBsb2cuZXJyb3IoXCJFcnJvcnMgd2hpbGUgY29tcGlsaW5nLiBSZWxvYWQgcHJldmVudGVkLlwiKTtcbiAgICB2YXIgcHJpbnRhYmxlRXJyb3JzID0gX2Vycm9ycy5tYXAoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICB2YXIgX2Zvcm1hdFByb2JsZW0yID0gZm9ybWF0UHJvYmxlbShcImVycm9yXCIsIGVycm9yKSxcbiAgICAgICAgaGVhZGVyID0gX2Zvcm1hdFByb2JsZW0yLmhlYWRlcixcbiAgICAgICAgYm9keSA9IF9mb3JtYXRQcm9ibGVtMi5ib2R5O1xuICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KGhlYWRlciwgXCJcXG5cIikuY29uY2F0KHN0cmlwQW5zaShib2R5KSk7XG4gICAgfSk7XG4gICAgc2VuZE1lc3NhZ2UoXCJFcnJvcnNcIiwgcHJpbnRhYmxlRXJyb3JzKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByaW50YWJsZUVycm9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgbG9nLmVycm9yKHByaW50YWJsZUVycm9yc1tpXSk7XG4gICAgfVxuICAgIHZhciBvdmVybGF5RXJyb3JzU2V0dGluZ3MgPSB0eXBlb2Ygb3B0aW9ucy5vdmVybGF5ID09PSBcImJvb2xlYW5cIiA/IG9wdGlvbnMub3ZlcmxheSA6IG9wdGlvbnMub3ZlcmxheSAmJiBvcHRpb25zLm92ZXJsYXkuZXJyb3JzO1xuICAgIGlmIChvdmVybGF5RXJyb3JzU2V0dGluZ3MpIHtcbiAgICAgIHZhciBlcnJvcnNUb0Rpc3BsYXkgPSB0eXBlb2Ygb3ZlcmxheUVycm9yc1NldHRpbmdzID09PSBcImZ1bmN0aW9uXCIgPyBfZXJyb3JzLmZpbHRlcihvdmVybGF5RXJyb3JzU2V0dGluZ3MpIDogX2Vycm9ycztcbiAgICAgIGlmIChlcnJvcnNUb0Rpc3BsYXkubGVuZ3RoKSB7XG4gICAgICAgIG92ZXJsYXkuc2VuZCh7XG4gICAgICAgICAgdHlwZTogXCJCVUlMRF9FUlJPUlwiLFxuICAgICAgICAgIGxldmVsOiBcImVycm9yXCIsXG4gICAgICAgICAgbWVzc2FnZXM6IF9lcnJvcnNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICAvKipcbiAgICogQHBhcmFtIHtFcnJvcn0gZXJyb3JcbiAgICovXG4gIGVycm9yOiBmdW5jdGlvbiBlcnJvcihfZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoX2Vycm9yKTtcbiAgfSxcbiAgY2xvc2U6IGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgIGxvZy5pbmZvKFwiRGlzY29ubmVjdGVkIVwiKTtcbiAgICBpZiAob3B0aW9ucy5vdmVybGF5KSB7XG4gICAgICBvdmVybGF5LnNlbmQoe1xuICAgICAgICB0eXBlOiBcIkRJU01JU1NcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRNZXNzYWdlKFwiQ2xvc2VcIik7XG4gIH1cbn07XG52YXIgc29ja2V0VVJMID0gY3JlYXRlU29ja2V0VVJMKHBhcnNlZFJlc291cmNlUXVlcnkpO1xuc29ja2V0KHNvY2tldFVSTCwgb25Tb2NrZXRNZXNzYWdlLCBvcHRpb25zLnJlY29ubmVjdCk7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/index.js?protocol=ws%3A&hostname=0.0.0.0&port=3000&pathname=%2Fws&logging=none&overlay=true&reconnect=10&hot=true&live-reload=true\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/modules/logger/index.js":
/*!************************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/modules/logger/index.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("{/******/ (function() { // webpackBootstrap\n/******/ \t\"use strict\";\n/******/ \tvar __webpack_modules__ = ({\n\n/***/ \"./client-src/modules/logger/SyncBailHookFake.js\":\n/*!*******************************************************!*\\\n  !*** ./client-src/modules/logger/SyncBailHookFake.js ***!\n  \\*******************************************************/\n/***/ (function(module) {\n\n\n\n/**\n * Client stub for tapable SyncBailHook\n */\nmodule.exports = function clientTapableSyncBailHook() {\n  return {\n    call: function call() {}\n  };\n};\n\n/***/ }),\n\n/***/ \"./node_modules/webpack/lib/logging/Logger.js\":\n/*!****************************************************!*\\\n  !*** ./node_modules/webpack/lib/logging/Logger.js ***!\n  \\****************************************************/\n/***/ (function(__unused_webpack_module, exports) {\n\n/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _iterableToArray(iter) {\n  if (typeof (typeof Symbol !== \"undefined\" ? Symbol : function (i) { return i; }) !== \"undefined\" && iter[(typeof Symbol !== \"undefined\" ? Symbol : function (i) { return i; }).iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[(typeof Symbol !== \"undefined\" ? Symbol : function (i) { return i; }).toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nvar LogType = Object.freeze({\n  error: /** @type {\"error\"} */\"error\",\n  // message, c style arguments\n  warn: /** @type {\"warn\"} */\"warn\",\n  // message, c style arguments\n  info: /** @type {\"info\"} */\"info\",\n  // message, c style arguments\n  log: /** @type {\"log\"} */\"log\",\n  // message, c style arguments\n  debug: /** @type {\"debug\"} */\"debug\",\n  // message, c style arguments\n\n  trace: /** @type {\"trace\"} */\"trace\",\n  // no arguments\n\n  group: /** @type {\"group\"} */\"group\",\n  // [label]\n  groupCollapsed: /** @type {\"groupCollapsed\"} */\"groupCollapsed\",\n  // [label]\n  groupEnd: /** @type {\"groupEnd\"} */\"groupEnd\",\n  // [label]\n\n  profile: /** @type {\"profile\"} */\"profile\",\n  // [profileName]\n  profileEnd: /** @type {\"profileEnd\"} */\"profileEnd\",\n  // [profileName]\n\n  time: /** @type {\"time\"} */\"time\",\n  // name, time as [seconds, nanoseconds]\n\n  clear: /** @type {\"clear\"} */\"clear\",\n  // no arguments\n  status: /** @type {\"status\"} */\"status\" // message, arguments\n});\n\nexports.LogType = LogType;\n\n/** @typedef {typeof LogType[keyof typeof LogType]} LogTypeEnum */\n\nvar LOG_SYMBOL = (typeof Symbol !== \"undefined\" ? Symbol : function (i) { return i; })(\"webpack logger raw log method\");\nvar TIMERS_SYMBOL = (typeof Symbol !== \"undefined\" ? Symbol : function (i) { return i; })(\"webpack logger times\");\nvar TIMERS_AGGREGATES_SYMBOL = (typeof Symbol !== \"undefined\" ? Symbol : function (i) { return i; })(\"webpack logger aggregated times\");\nvar WebpackLogger = /*#__PURE__*/function () {\n  /**\n   * @param {function(LogTypeEnum, any[]=): void} log log function\n   * @param {function(string | function(): string): WebpackLogger} getChildLogger function to create child logger\n   */\n  function WebpackLogger(log, getChildLogger) {\n    _classCallCheck(this, WebpackLogger);\n    this[LOG_SYMBOL] = log;\n    this.getChildLogger = getChildLogger;\n  }\n  _createClass(WebpackLogger, [{\n    key: \"error\",\n    value: function error() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      this[LOG_SYMBOL](LogType.error, args);\n    }\n  }, {\n    key: \"warn\",\n    value: function warn() {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      this[LOG_SYMBOL](LogType.warn, args);\n    }\n  }, {\n    key: \"info\",\n    value: function info() {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      this[LOG_SYMBOL](LogType.info, args);\n    }\n  }, {\n    key: \"log\",\n    value: function log() {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n      this[LOG_SYMBOL](LogType.log, args);\n    }\n  }, {\n    key: \"debug\",\n    value: function debug() {\n      for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n        args[_key5] = arguments[_key5];\n      }\n      this[LOG_SYMBOL](LogType.debug, args);\n    }\n  }, {\n    key: \"assert\",\n    value: function assert(assertion) {\n      if (!assertion) {\n        for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n          args[_key6 - 1] = arguments[_key6];\n        }\n        this[LOG_SYMBOL](LogType.error, args);\n      }\n    }\n  }, {\n    key: \"trace\",\n    value: function trace() {\n      this[LOG_SYMBOL](LogType.trace, [\"Trace\"]);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this[LOG_SYMBOL](LogType.clear);\n    }\n  }, {\n    key: \"status\",\n    value: function status() {\n      for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n        args[_key7] = arguments[_key7];\n      }\n      this[LOG_SYMBOL](LogType.status, args);\n    }\n  }, {\n    key: \"group\",\n    value: function group() {\n      for (var _len8 = arguments.length, args = new Array(_len8), _key8 = 0; _key8 < _len8; _key8++) {\n        args[_key8] = arguments[_key8];\n      }\n      this[LOG_SYMBOL](LogType.group, args);\n    }\n  }, {\n    key: \"groupCollapsed\",\n    value: function groupCollapsed() {\n      for (var _len9 = arguments.length, args = new Array(_len9), _key9 = 0; _key9 < _len9; _key9++) {\n        args[_key9] = arguments[_key9];\n      }\n      this[LOG_SYMBOL](LogType.groupCollapsed, args);\n    }\n  }, {\n    key: \"groupEnd\",\n    value: function groupEnd() {\n      for (var _len10 = arguments.length, args = new Array(_len10), _key10 = 0; _key10 < _len10; _key10++) {\n        args[_key10] = arguments[_key10];\n      }\n      this[LOG_SYMBOL](LogType.groupEnd, args);\n    }\n  }, {\n    key: \"profile\",\n    value: function profile(label) {\n      this[LOG_SYMBOL](LogType.profile, [label]);\n    }\n  }, {\n    key: \"profileEnd\",\n    value: function profileEnd(label) {\n      this[LOG_SYMBOL](LogType.profileEnd, [label]);\n    }\n  }, {\n    key: \"time\",\n    value: function time(label) {\n      this[TIMERS_SYMBOL] = this[TIMERS_SYMBOL] || new Map();\n      this[TIMERS_SYMBOL].set(label, process.hrtime());\n    }\n  }, {\n    key: \"timeLog\",\n    value: function timeLog(label) {\n      var prev = this[TIMERS_SYMBOL] && this[TIMERS_SYMBOL].get(label);\n      if (!prev) {\n        throw new Error(\"No such label '\".concat(label, \"' for WebpackLogger.timeLog()\"));\n      }\n      var time = process.hrtime(prev);\n      this[LOG_SYMBOL](LogType.time, [label].concat(_toConsumableArray(time)));\n    }\n  }, {\n    key: \"timeEnd\",\n    value: function timeEnd(label) {\n      var prev = this[TIMERS_SYMBOL] && this[TIMERS_SYMBOL].get(label);\n      if (!prev) {\n        throw new Error(\"No such label '\".concat(label, \"' for WebpackLogger.timeEnd()\"));\n      }\n      var time = process.hrtime(prev);\n      this[TIMERS_SYMBOL].delete(label);\n      this[LOG_SYMBOL](LogType.time, [label].concat(_toConsumableArray(time)));\n    }\n  }, {\n    key: \"timeAggregate\",\n    value: function timeAggregate(label) {\n      var prev = this[TIMERS_SYMBOL] && this[TIMERS_SYMBOL].get(label);\n      if (!prev) {\n        throw new Error(\"No such label '\".concat(label, \"' for WebpackLogger.timeAggregate()\"));\n      }\n      var time = process.hrtime(prev);\n      this[TIMERS_SYMBOL].delete(label);\n      this[TIMERS_AGGREGATES_SYMBOL] = this[TIMERS_AGGREGATES_SYMBOL] || new Map();\n      var current = this[TIMERS_AGGREGATES_SYMBOL].get(label);\n      if (current !== undefined) {\n        if (time[1] + current[1] > 1e9) {\n          time[0] += current[0] + 1;\n          time[1] = time[1] - 1e9 + current[1];\n        } else {\n          time[0] += current[0];\n          time[1] += current[1];\n        }\n      }\n      this[TIMERS_AGGREGATES_SYMBOL].set(label, time);\n    }\n  }, {\n    key: \"timeAggregateEnd\",\n    value: function timeAggregateEnd(label) {\n      if (this[TIMERS_AGGREGATES_SYMBOL] === undefined) return;\n      var time = this[TIMERS_AGGREGATES_SYMBOL].get(label);\n      if (time === undefined) return;\n      this[TIMERS_AGGREGATES_SYMBOL].delete(label);\n      this[LOG_SYMBOL](LogType.time, [label].concat(_toConsumableArray(time)));\n    }\n  }]);\n  return WebpackLogger;\n}();\nexports.Logger = WebpackLogger;\n\n/***/ }),\n\n/***/ \"./node_modules/webpack/lib/logging/createConsoleLogger.js\":\n/*!*****************************************************************!*\\\n  !*** ./node_modules/webpack/lib/logging/createConsoleLogger.js ***!\n  \\*****************************************************************/\n/***/ (function(module, __unused_webpack_exports, __nested_webpack_require_11285__) {\n\n/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _iterableToArray(iter) {\n  if (typeof (typeof Symbol !== \"undefined\" ? Symbol : function (i) { return i; }) !== \"undefined\" && iter[(typeof Symbol !== \"undefined\" ? Symbol : function (i) { return i; }).iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nvar _require = __nested_webpack_require_11285__(/*! ./Logger */ \"./node_modules/webpack/lib/logging/Logger.js\"),\n  LogType = _require.LogType;\n\n/** @typedef {import(\"../../declarations/WebpackOptions\").FilterItemTypes} FilterItemTypes */\n/** @typedef {import(\"../../declarations/WebpackOptions\").FilterTypes} FilterTypes */\n/** @typedef {import(\"./Logger\").LogTypeEnum} LogTypeEnum */\n\n/** @typedef {function(string): boolean} FilterFunction */\n\n/**\n * @typedef {Object} LoggerConsole\n * @property {function(): void} clear\n * @property {function(): void} trace\n * @property {(...args: any[]) => void} info\n * @property {(...args: any[]) => void} log\n * @property {(...args: any[]) => void} warn\n * @property {(...args: any[]) => void} error\n * @property {(...args: any[]) => void=} debug\n * @property {(...args: any[]) => void=} group\n * @property {(...args: any[]) => void=} groupCollapsed\n * @property {(...args: any[]) => void=} groupEnd\n * @property {(...args: any[]) => void=} status\n * @property {(...args: any[]) => void=} profile\n * @property {(...args: any[]) => void=} profileEnd\n * @property {(...args: any[]) => void=} logTime\n */\n\n/**\n * @typedef {Object} LoggerOptions\n * @property {false|true|\"none\"|\"error\"|\"warn\"|\"info\"|\"log\"|\"verbose\"} level loglevel\n * @property {FilterTypes|boolean} debug filter for debug logging\n * @property {LoggerConsole} console the console to log to\n */\n\n/**\n * @param {FilterItemTypes} item an input item\n * @returns {FilterFunction} filter function\n */\nvar filterToFunction = function filterToFunction(item) {\n  if (typeof item === \"string\") {\n    var regExp = new RegExp(\"[\\\\\\\\/]\".concat(item.replace(\n    // eslint-disable-next-line no-useless-escape\n    /[-[\\]{}()*+?.\\\\^$|]/g, \"\\\\$&\"), \"([\\\\\\\\/]|$|!|\\\\?)\"));\n    return function (ident) {\n      return regExp.test(ident);\n    };\n  }\n  if (item && typeof item === \"object\" && typeof item.test === \"function\") {\n    return function (ident) {\n      return item.test(ident);\n    };\n  }\n  if (typeof item === \"function\") {\n    return item;\n  }\n  if (typeof item === \"boolean\") {\n    return function () {\n      return item;\n    };\n  }\n};\n\n/**\n * @enum {number}\n */\nvar LogLevel = {\n  none: 6,\n  false: 6,\n  error: 5,\n  warn: 4,\n  info: 3,\n  log: 2,\n  true: 2,\n  verbose: 1\n};\n\n/**\n * @param {LoggerOptions} options options object\n * @returns {function(string, LogTypeEnum, any[]): void} logging function\n */\nmodule.exports = function (_ref) {\n  var _ref$level = _ref.level,\n    level = _ref$level === void 0 ? \"info\" : _ref$level,\n    _ref$debug = _ref.debug,\n    debug = _ref$debug === void 0 ? false : _ref$debug,\n    console = _ref.console;\n  var debugFilters = typeof debug === \"boolean\" ? [function () {\n    return debug;\n  }] : /** @type {FilterItemTypes[]} */[].concat(debug).map(filterToFunction);\n  /** @type {number} */\n  var loglevel = LogLevel[\"\".concat(level)] || 0;\n\n  /**\n   * @param {string} name name of the logger\n   * @param {LogTypeEnum} type type of the log entry\n   * @param {any[]} args arguments of the log entry\n   * @returns {void}\n   */\n  var logger = function logger(name, type, args) {\n    var labeledArgs = function labeledArgs() {\n      if (Array.isArray(args)) {\n        if (args.length > 0 && typeof args[0] === \"string\") {\n          return [\"[\".concat(name, \"] \").concat(args[0])].concat(_toConsumableArray(args.slice(1)));\n        } else {\n          return [\"[\".concat(name, \"]\")].concat(_toConsumableArray(args));\n        }\n      } else {\n        return [];\n      }\n    };\n    var debug = debugFilters.some(function (f) {\n      return f(name);\n    });\n    switch (type) {\n      case LogType.debug:\n        if (!debug) return;\n        // eslint-disable-next-line node/no-unsupported-features/node-builtins\n        if (typeof console.debug === \"function\") {\n          // eslint-disable-next-line node/no-unsupported-features/node-builtins\n          console.debug.apply(console, _toConsumableArray(labeledArgs()));\n        } else {\n          console.log.apply(console, _toConsumableArray(labeledArgs()));\n        }\n        break;\n      case LogType.log:\n        if (!debug && loglevel > LogLevel.log) return;\n        console.log.apply(console, _toConsumableArray(labeledArgs()));\n        break;\n      case LogType.info:\n        if (!debug && loglevel > LogLevel.info) return;\n        console.info.apply(console, _toConsumableArray(labeledArgs()));\n        break;\n      case LogType.warn:\n        if (!debug && loglevel > LogLevel.warn) return;\n        console.warn.apply(console, _toConsumableArray(labeledArgs()));\n        break;\n      case LogType.error:\n        if (!debug && loglevel > LogLevel.error) return;\n        console.error.apply(console, _toConsumableArray(labeledArgs()));\n        break;\n      case LogType.trace:\n        if (!debug) return;\n        console.trace();\n        break;\n      case LogType.groupCollapsed:\n        if (!debug && loglevel > LogLevel.log) return;\n        if (!debug && loglevel > LogLevel.verbose) {\n          // eslint-disable-next-line node/no-unsupported-features/node-builtins\n          if (typeof console.groupCollapsed === \"function\") {\n            // eslint-disable-next-line node/no-unsupported-features/node-builtins\n            console.groupCollapsed.apply(console, _toConsumableArray(labeledArgs()));\n          } else {\n            console.log.apply(console, _toConsumableArray(labeledArgs()));\n          }\n          break;\n        }\n      // falls through\n      case LogType.group:\n        if (!debug && loglevel > LogLevel.log) return;\n        // eslint-disable-next-line node/no-unsupported-features/node-builtins\n        if (typeof console.group === \"function\") {\n          // eslint-disable-next-line node/no-unsupported-features/node-builtins\n          console.group.apply(console, _toConsumableArray(labeledArgs()));\n        } else {\n          console.log.apply(console, _toConsumableArray(labeledArgs()));\n        }\n        break;\n      case LogType.groupEnd:\n        if (!debug && loglevel > LogLevel.log) return;\n        // eslint-disable-next-line node/no-unsupported-features/node-builtins\n        if (typeof console.groupEnd === \"function\") {\n          // eslint-disable-next-line node/no-unsupported-features/node-builtins\n          console.groupEnd();\n        }\n        break;\n      case LogType.time:\n        {\n          if (!debug && loglevel > LogLevel.log) return;\n          var ms = args[1] * 1000 + args[2] / 1000000;\n          var msg = \"[\".concat(name, \"] \").concat(args[0], \": \").concat(ms, \" ms\");\n          if (typeof console.logTime === \"function\") {\n            console.logTime(msg);\n          } else {\n            console.log(msg);\n          }\n          break;\n        }\n      case LogType.profile:\n        // eslint-disable-next-line node/no-unsupported-features/node-builtins\n        if (typeof console.profile === \"function\") {\n          // eslint-disable-next-line node/no-unsupported-features/node-builtins\n          console.profile.apply(console, _toConsumableArray(labeledArgs()));\n        }\n        break;\n      case LogType.profileEnd:\n        // eslint-disable-next-line node/no-unsupported-features/node-builtins\n        if (typeof console.profileEnd === \"function\") {\n          // eslint-disable-next-line node/no-unsupported-features/node-builtins\n          console.profileEnd.apply(console, _toConsumableArray(labeledArgs()));\n        }\n        break;\n      case LogType.clear:\n        if (!debug && loglevel > LogLevel.log) return;\n        // eslint-disable-next-line node/no-unsupported-features/node-builtins\n        if (typeof console.clear === \"function\") {\n          // eslint-disable-next-line node/no-unsupported-features/node-builtins\n          console.clear();\n        }\n        break;\n      case LogType.status:\n        if (!debug && loglevel > LogLevel.info) return;\n        if (typeof console.status === \"function\") {\n          if (args.length === 0) {\n            console.status();\n          } else {\n            console.status.apply(console, _toConsumableArray(labeledArgs()));\n          }\n        } else {\n          if (args.length !== 0) {\n            console.info.apply(console, _toConsumableArray(labeledArgs()));\n          }\n        }\n        break;\n      default:\n        throw new Error(\"Unexpected LogType \".concat(type));\n    }\n  };\n  return logger;\n};\n\n/***/ }),\n\n/***/ \"./node_modules/webpack/lib/logging/runtime.js\":\n/*!*****************************************************!*\\\n  !*** ./node_modules/webpack/lib/logging/runtime.js ***!\n  \\*****************************************************/\n/***/ (function(__unused_webpack_module, exports, __nested_webpack_require_21334__) {\n\n/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\n\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nvar SyncBailHook = __nested_webpack_require_21334__(/*! tapable/lib/SyncBailHook */ \"./client-src/modules/logger/SyncBailHookFake.js\");\nvar _require = __nested_webpack_require_21334__(/*! ./Logger */ \"./node_modules/webpack/lib/logging/Logger.js\"),\n  Logger = _require.Logger;\nvar createConsoleLogger = __nested_webpack_require_21334__(/*! ./createConsoleLogger */ \"./node_modules/webpack/lib/logging/createConsoleLogger.js\");\n\n/** @type {createConsoleLogger.LoggerOptions} */\nvar currentDefaultLoggerOptions = {\n  level: \"info\",\n  debug: false,\n  console: console\n};\nvar currentDefaultLogger = createConsoleLogger(currentDefaultLoggerOptions);\n\n/**\n * @param {string} name name of the logger\n * @returns {Logger} a logger\n */\nexports.getLogger = function (name) {\n  return new Logger(function (type, args) {\n    if (exports.hooks.log.call(name, type, args) === undefined) {\n      currentDefaultLogger(name, type, args);\n    }\n  }, function (childName) {\n    return exports.getLogger(\"\".concat(name, \"/\").concat(childName));\n  });\n};\n\n/**\n * @param {createConsoleLogger.LoggerOptions} options new options, merge with old options\n * @returns {void}\n */\nexports.configureDefaultLogger = function (options) {\n  _extends(currentDefaultLoggerOptions, options);\n  currentDefaultLogger = createConsoleLogger(currentDefaultLoggerOptions);\n};\nexports.hooks = {\n  log: new SyncBailHook([\"origin\", \"type\", \"args\"])\n};\n\n/***/ })\n\n/******/ \t});\n/************************************************************************/\n/******/ \t// The module cache\n/******/ \tvar __webpack_module_cache__ = {};\n/******/ \t\n/******/ \t// The require function\n/******/ \tfunction __nested_webpack_require_23461__(moduleId) {\n/******/ \t\t// Check if module is in cache\n/******/ \t\tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \t\tif (cachedModule !== undefined) {\n/******/ \t\t\treturn cachedModule.exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\t\t// no module.id needed\n/******/ \t\t\t// no module.loaded needed\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/ \t\n/******/ \t\t// Execute the module function\n/******/ \t\t__webpack_modules__[moduleId](module, module.exports, __nested_webpack_require_23461__);\n/******/ \t\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/ \t\n/************************************************************************/\n/******/ \t/* webpack/runtime/define property getters */\n/******/ \t!function() {\n/******/ \t\t// define getter functions for harmony exports\n/******/ \t\t__nested_webpack_require_23461__.d = function(exports, definition) {\n/******/ \t\t\tfor(var key in definition) {\n/******/ \t\t\t\tif(__nested_webpack_require_23461__.o(definition, key) && !__nested_webpack_require_23461__.o(exports, key)) {\n/******/ \t\t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t\t}\n/******/ \t\t\t}\n/******/ \t\t};\n/******/ \t}();\n/******/ \t\n/******/ \t/* webpack/runtime/hasOwnProperty shorthand */\n/******/ \t!function() {\n/******/ \t\t__nested_webpack_require_23461__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }\n/******/ \t}();\n/******/ \t\n/******/ \t/* webpack/runtime/make namespace object */\n/******/ \t!function() {\n/******/ \t\t// define __esModule on exports\n/******/ \t\t__nested_webpack_require_23461__.r = function(exports) {\n/******/ \t\t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t\t}\n/******/ \t\t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t\t};\n/******/ \t}();\n/******/ \t\n/************************************************************************/\nvar __nested_webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n!function() {\n/*!********************************************!*\\\n  !*** ./client-src/modules/logger/index.js ***!\n  \\********************************************/\n__nested_webpack_require_23461__.r(__nested_webpack_exports__);\n/* harmony export */ __nested_webpack_require_23461__.d(__nested_webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* reexport default export from named module */ webpack_lib_logging_runtime_js__WEBPACK_IMPORTED_MODULE_0__; }\n/* harmony export */ });\n/* harmony import */ var webpack_lib_logging_runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_23461__(/*! webpack/lib/logging/runtime.js */ \"./node_modules/webpack/lib/logging/runtime.js\");\n\n}();\nvar __webpack_export_target__ = exports;\nfor(var i in __nested_webpack_exports__) __webpack_export_target__[i] = __nested_webpack_exports__[i];\nif(__nested_webpack_exports__.__esModule) Object.defineProperty(__webpack_export_target__, \"__esModule\", { value: true });\n/******/ })()\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9tb2R1bGVzL2xvZ2dlci9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBQSx1QkFBdUI7QUFDdkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsV0FBVyxtRkFBbUYsV0FBVztBQUMvSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsU0FBUztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGtCQUFrQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRFQUE0RSxXQUFXO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsU0FBUztBQUM3QjtBQUNBLG1CQUFtQixRQUFRO0FBQzNCO0FBQ0EsbUJBQW1CLFFBQVE7QUFDM0I7QUFDQSxrQkFBa0IsT0FBTztBQUN6QjtBQUNBLG9CQUFvQixTQUFTO0FBQzdCOztBQUVBLG9CQUFvQixTQUFTO0FBQzdCOztBQUVBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0EsNkJBQTZCLGtCQUFrQjtBQUMvQztBQUNBLHVCQUF1QixZQUFZO0FBQ25DOztBQUVBLHNCQUFzQixXQUFXO0FBQ2pDO0FBQ0EseUJBQXlCLGNBQWM7QUFDdkM7O0FBRUEsbUJBQW1CLFFBQVE7QUFDM0I7O0FBRUEsb0JBQW9CLFNBQVM7QUFDN0I7QUFDQSxxQkFBcUIsVUFBVTtBQUMvQixDQUFDOztBQUVEOztBQUVBLGNBQWMsc0NBQXNDOztBQUVwRCwwRUFBMEUsV0FBVztBQUNyRiw2RUFBNkUsV0FBVztBQUN4Rix3RkFBd0YsV0FBVztBQUNuRztBQUNBO0FBQ0EsYUFBYSxxQ0FBcUM7QUFDbEQsYUFBYSxzREFBc0Q7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLGFBQWE7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDZFQUE2RSxlQUFlO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSw2RUFBNkUsZUFBZTtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsNkVBQTZFLGVBQWU7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDZFQUE2RSxlQUFlO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLG1HQUFtRyxlQUFlO0FBQ2xIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDZFQUE2RSxlQUFlO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSw2RUFBNkUsZUFBZTtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsNkVBQTZFLGVBQWU7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGdGQUFnRixpQkFBaUI7QUFDakc7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLENBQUM7QUFDRDs7QUFFQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELGdDQUFtQjs7QUFFckU7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsV0FBVyxtRkFBbUYsV0FBVztBQUMvSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsU0FBUztBQUNsRDtBQUNBO0FBQ0EsZUFBZSxnQ0FBbUI7QUFDbEM7O0FBRUEsY0FBYyw2REFBNkQ7QUFDM0UsY0FBYyx5REFBeUQ7QUFDdkUsY0FBYyxnQ0FBZ0M7O0FBRTlDLGNBQWMsMkJBQTJCOztBQUV6QztBQUNBLGFBQWEsUUFBUTtBQUNyQixjQUFjLGtCQUFrQjtBQUNoQyxjQUFjLGtCQUFrQjtBQUNoQyxjQUFjLDBCQUEwQjtBQUN4QyxjQUFjLDBCQUEwQjtBQUN4QyxjQUFjLDBCQUEwQjtBQUN4QyxjQUFjLDBCQUEwQjtBQUN4QyxjQUFjLDJCQUEyQjtBQUN6QyxjQUFjLDJCQUEyQjtBQUN6QyxjQUFjLDJCQUEyQjtBQUN6QyxjQUFjLDJCQUEyQjtBQUN6QyxjQUFjLDJCQUEyQjtBQUN6QyxjQUFjLDJCQUEyQjtBQUN6QyxjQUFjLDJCQUEyQjtBQUN6QyxjQUFjLDJCQUEyQjtBQUN6Qzs7QUFFQTtBQUNBLGFBQWEsUUFBUTtBQUNyQixjQUFjLHlEQUF5RDtBQUN2RSxjQUFjLHFCQUFxQjtBQUNuQyxjQUFjLGVBQWU7QUFDN0I7O0FBRUE7QUFDQSxXQUFXLGlCQUFpQjtBQUM1QixhQUFhLGdCQUFnQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVyxlQUFlO0FBQzFCLGFBQWEsNENBQTRDO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsZUFBZSxtQkFBbUI7QUFDckMsYUFBYSxRQUFRO0FBQ3JCOztBQUVBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCLGFBQWEsYUFBYTtBQUMxQixhQUFhLE9BQU87QUFDcEIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELGdDQUFtQjs7QUFFckU7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0Esb0JBQW9CLHNCQUFzQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGdDQUFtQjtBQUN0QyxlQUFlLGdDQUFtQjtBQUNsQztBQUNBLDBCQUEwQixnQ0FBbUI7O0FBRTdDLFdBQVcsbUNBQW1DO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0EsV0FBVyxtQ0FBbUM7QUFDOUMsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBTzs7QUFFUCxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixnQ0FBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsZ0NBQW1CO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZ0NBQW1CO0FBQzlCO0FBQ0EsZ0JBQWdCLGdDQUFtQix3QkFBd0IsZ0NBQW1CO0FBQzlFLG9EQUFvRCx3Q0FBd0M7QUFDNUY7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZ0NBQW1CLDJCQUEyQjtBQUN6RCxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGdDQUFtQjtBQUM5QjtBQUNBLGtFQUFrRSxpQkFBaUI7QUFDbkY7QUFDQSwyREFBMkQsYUFBYTtBQUN4RTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsSUFBSSwwQkFBbUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFtQixHQUFHLDBCQUFtQjtBQUN6QyxxQkFBcUIsZ0NBQW1CLEdBQUcsMEJBQW1CO0FBQzlELCtDQUErQztBQUMvQyxzQkFBc0I7QUFDdEIsdUZBQXVGLGdDQUFtQjs7QUFFMUcsQ0FBQztBQUNEO0FBQ0EsYUFBYSwwQkFBbUIsaUNBQWlDLDBCQUFtQjtBQUNwRixHQUFHLDBCQUFtQiw4RUFBOEUsYUFBYTtBQUNqSCxVQUFVO0FBQ1YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vbm9kZV9tb2R1bGVzL3dlYnBhY2stZGV2LXNlcnZlci9jbGllbnQvbW9kdWxlcy9sb2dnZXIvaW5kZXguanM/ZTJhNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24oKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0XCJ1c2Ugc3RyaWN0XCI7XG4vKioqKioqLyBcdHZhciBfX3dlYnBhY2tfbW9kdWxlc19fID0gKHtcblxuLyoqKi8gXCIuL2NsaWVudC1zcmMvbW9kdWxlcy9sb2dnZXIvU3luY0JhaWxIb29rRmFrZS5qc1wiOlxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL2NsaWVudC1zcmMvbW9kdWxlcy9sb2dnZXIvU3luY0JhaWxIb29rRmFrZS5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUpIHtcblxuXG5cbi8qKlxuICogQ2xpZW50IHN0dWIgZm9yIHRhcGFibGUgU3luY0JhaWxIb29rXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY2xpZW50VGFwYWJsZVN5bmNCYWlsSG9vaygpIHtcbiAgcmV0dXJuIHtcbiAgICBjYWxsOiBmdW5jdGlvbiBjYWxsKCkge31cbiAgfTtcbn07XG5cbi8qKiovIH0pLFxuXG4vKioqLyBcIi4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvTG9nZ2VyLmpzXCI6XG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvTG9nZ2VyLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cbi8qXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG5cblxuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7XG4gIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7XG59XG5mdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikge1xuICBpZiAoIW8pIHJldHVybjtcbiAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcbiAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuICBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lO1xuICBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTtcbiAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xufVxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7XG4gIGlmICh0eXBlb2YgKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgPyBTeW1ib2wgOiBmdW5jdGlvbiAoaSkgeyByZXR1cm4gaTsgfSkgIT09IFwidW5kZWZpbmVkXCIgJiYgaXRlclsodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiA/IFN5bWJvbCA6IGZ1bmN0aW9uIChpKSB7IHJldHVybiBpOyB9KS5pdGVyYXRvcl0gIT0gbnVsbCB8fCBpdGVyW1wiQEBpdGVyYXRvclwiXSAhPSBudWxsKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTtcbn1cbmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7XG59XG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikge1xuICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSBhcnIyW2ldID0gYXJyW2ldO1xuICByZXR1cm4gYXJyMjtcbn1cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICB9XG59XG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcbiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBfdG9Qcm9wZXJ0eUtleShkZXNjcmlwdG9yLmtleSksIGRlc2NyaXB0b3IpO1xuICB9XG59XG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb25zdHJ1Y3RvciwgXCJwcm90b3R5cGVcIiwge1xuICAgIHdyaXRhYmxlOiBmYWxzZVxuICB9KTtcbiAgcmV0dXJuIENvbnN0cnVjdG9yO1xufVxuZnVuY3Rpb24gX3RvUHJvcGVydHlLZXkoYXJnKSB7XG4gIHZhciBrZXkgPSBfdG9QcmltaXRpdmUoYXJnLCBcInN0cmluZ1wiKTtcbiAgcmV0dXJuIHR5cGVvZiBrZXkgPT09IFwic3ltYm9sXCIgPyBrZXkgOiBTdHJpbmcoa2V5KTtcbn1cbmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkge1xuICBpZiAodHlwZW9mIGlucHV0ICE9PSBcIm9iamVjdFwiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7XG4gIHZhciBwcmltID0gaW5wdXRbKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgPyBTeW1ib2wgOiBmdW5jdGlvbiAoaSkgeyByZXR1cm4gaTsgfSkudG9QcmltaXRpdmVdO1xuICBpZiAocHJpbSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCBcImRlZmF1bHRcIik7XG4gICAgaWYgKHR5cGVvZiByZXMgIT09IFwib2JqZWN0XCIpIHJldHVybiByZXM7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuXCIpO1xuICB9XG4gIHJldHVybiAoaGludCA9PT0gXCJzdHJpbmdcIiA/IFN0cmluZyA6IE51bWJlcikoaW5wdXQpO1xufVxudmFyIExvZ1R5cGUgPSBPYmplY3QuZnJlZXplKHtcbiAgZXJyb3I6IC8qKiBAdHlwZSB7XCJlcnJvclwifSAqL1wiZXJyb3JcIixcbiAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHNcbiAgd2FybjogLyoqIEB0eXBlIHtcIndhcm5cIn0gKi9cIndhcm5cIixcbiAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHNcbiAgaW5mbzogLyoqIEB0eXBlIHtcImluZm9cIn0gKi9cImluZm9cIixcbiAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHNcbiAgbG9nOiAvKiogQHR5cGUge1wibG9nXCJ9ICovXCJsb2dcIixcbiAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHNcbiAgZGVidWc6IC8qKiBAdHlwZSB7XCJkZWJ1Z1wifSAqL1wiZGVidWdcIixcbiAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHNcblxuICB0cmFjZTogLyoqIEB0eXBlIHtcInRyYWNlXCJ9ICovXCJ0cmFjZVwiLFxuICAvLyBubyBhcmd1bWVudHNcblxuICBncm91cDogLyoqIEB0eXBlIHtcImdyb3VwXCJ9ICovXCJncm91cFwiLFxuICAvLyBbbGFiZWxdXG4gIGdyb3VwQ29sbGFwc2VkOiAvKiogQHR5cGUge1wiZ3JvdXBDb2xsYXBzZWRcIn0gKi9cImdyb3VwQ29sbGFwc2VkXCIsXG4gIC8vIFtsYWJlbF1cbiAgZ3JvdXBFbmQ6IC8qKiBAdHlwZSB7XCJncm91cEVuZFwifSAqL1wiZ3JvdXBFbmRcIixcbiAgLy8gW2xhYmVsXVxuXG4gIHByb2ZpbGU6IC8qKiBAdHlwZSB7XCJwcm9maWxlXCJ9ICovXCJwcm9maWxlXCIsXG4gIC8vIFtwcm9maWxlTmFtZV1cbiAgcHJvZmlsZUVuZDogLyoqIEB0eXBlIHtcInByb2ZpbGVFbmRcIn0gKi9cInByb2ZpbGVFbmRcIixcbiAgLy8gW3Byb2ZpbGVOYW1lXVxuXG4gIHRpbWU6IC8qKiBAdHlwZSB7XCJ0aW1lXCJ9ICovXCJ0aW1lXCIsXG4gIC8vIG5hbWUsIHRpbWUgYXMgW3NlY29uZHMsIG5hbm9zZWNvbmRzXVxuXG4gIGNsZWFyOiAvKiogQHR5cGUge1wiY2xlYXJcIn0gKi9cImNsZWFyXCIsXG4gIC8vIG5vIGFyZ3VtZW50c1xuICBzdGF0dXM6IC8qKiBAdHlwZSB7XCJzdGF0dXNcIn0gKi9cInN0YXR1c1wiIC8vIG1lc3NhZ2UsIGFyZ3VtZW50c1xufSk7XG5cbmV4cG9ydHMuTG9nVHlwZSA9IExvZ1R5cGU7XG5cbi8qKiBAdHlwZWRlZiB7dHlwZW9mIExvZ1R5cGVba2V5b2YgdHlwZW9mIExvZ1R5cGVdfSBMb2dUeXBlRW51bSAqL1xuXG52YXIgTE9HX1NZTUJPTCA9ICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiID8gU3ltYm9sIDogZnVuY3Rpb24gKGkpIHsgcmV0dXJuIGk7IH0pKFwid2VicGFjayBsb2dnZXIgcmF3IGxvZyBtZXRob2RcIik7XG52YXIgVElNRVJTX1NZTUJPTCA9ICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiID8gU3ltYm9sIDogZnVuY3Rpb24gKGkpIHsgcmV0dXJuIGk7IH0pKFwid2VicGFjayBsb2dnZXIgdGltZXNcIik7XG52YXIgVElNRVJTX0FHR1JFR0FURVNfU1lNQk9MID0gKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgPyBTeW1ib2wgOiBmdW5jdGlvbiAoaSkgeyByZXR1cm4gaTsgfSkoXCJ3ZWJwYWNrIGxvZ2dlciBhZ2dyZWdhdGVkIHRpbWVzXCIpO1xudmFyIFdlYnBhY2tMb2dnZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAvKipcbiAgICogQHBhcmFtIHtmdW5jdGlvbihMb2dUeXBlRW51bSwgYW55W109KTogdm9pZH0gbG9nIGxvZyBmdW5jdGlvblxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZyB8IGZ1bmN0aW9uKCk6IHN0cmluZyk6IFdlYnBhY2tMb2dnZXJ9IGdldENoaWxkTG9nZ2VyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBjaGlsZCBsb2dnZXJcbiAgICovXG4gIGZ1bmN0aW9uIFdlYnBhY2tMb2dnZXIobG9nLCBnZXRDaGlsZExvZ2dlcikge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXZWJwYWNrTG9nZ2VyKTtcbiAgICB0aGlzW0xPR19TWU1CT0xdID0gbG9nO1xuICAgIHRoaXMuZ2V0Q2hpbGRMb2dnZXIgPSBnZXRDaGlsZExvZ2dlcjtcbiAgfVxuICBfY3JlYXRlQ2xhc3MoV2VicGFja0xvZ2dlciwgW3tcbiAgICBrZXk6IFwiZXJyb3JcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXJyb3IoKSB7XG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICAgIH1cbiAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5lcnJvciwgYXJncyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndhcm5cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gd2FybigpIHtcbiAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMiksIF9rZXkyID0gMDsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykge1xuICAgICAgICBhcmdzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gICAgICB9XG4gICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUud2FybiwgYXJncyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluZm9cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5mbygpIHtcbiAgICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMyksIF9rZXkzID0gMDsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykge1xuICAgICAgICBhcmdzW19rZXkzXSA9IGFyZ3VtZW50c1tfa2V5M107XG4gICAgICB9XG4gICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUuaW5mbywgYXJncyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImxvZ1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBsb2coKSB7XG4gICAgICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjQpLCBfa2V5NCA9IDA7IF9rZXk0IDwgX2xlbjQ7IF9rZXk0KyspIHtcbiAgICAgICAgYXJnc1tfa2V5NF0gPSBhcmd1bWVudHNbX2tleTRdO1xuICAgICAgfVxuICAgICAgdGhpc1tMT0dfU1lNQk9MXShMb2dUeXBlLmxvZywgYXJncyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImRlYnVnXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRlYnVnKCkge1xuICAgICAgZm9yICh2YXIgX2xlbjUgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW41KSwgX2tleTUgPSAwOyBfa2V5NSA8IF9sZW41OyBfa2V5NSsrKSB7XG4gICAgICAgIGFyZ3NbX2tleTVdID0gYXJndW1lbnRzW19rZXk1XTtcbiAgICAgIH1cbiAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5kZWJ1ZywgYXJncyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImFzc2VydFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBhc3NlcnQoYXNzZXJ0aW9uKSB7XG4gICAgICBpZiAoIWFzc2VydGlvbikge1xuICAgICAgICBmb3IgKHZhciBfbGVuNiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjYgPiAxID8gX2xlbjYgLSAxIDogMCksIF9rZXk2ID0gMTsgX2tleTYgPCBfbGVuNjsgX2tleTYrKykge1xuICAgICAgICAgIGFyZ3NbX2tleTYgLSAxXSA9IGFyZ3VtZW50c1tfa2V5Nl07XG4gICAgICAgIH1cbiAgICAgICAgdGhpc1tMT0dfU1lNQk9MXShMb2dUeXBlLmVycm9yLCBhcmdzKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidHJhY2VcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdHJhY2UoKSB7XG4gICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUudHJhY2UsIFtcIlRyYWNlXCJdKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY2xlYXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUuY2xlYXIpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzdGF0dXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc3RhdHVzKCkge1xuICAgICAgZm9yICh2YXIgX2xlbjcgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW43KSwgX2tleTcgPSAwOyBfa2V5NyA8IF9sZW43OyBfa2V5NysrKSB7XG4gICAgICAgIGFyZ3NbX2tleTddID0gYXJndW1lbnRzW19rZXk3XTtcbiAgICAgIH1cbiAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5zdGF0dXMsIGFyZ3MpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJncm91cFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBncm91cCgpIHtcbiAgICAgIGZvciAodmFyIF9sZW44ID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuOCksIF9rZXk4ID0gMDsgX2tleTggPCBfbGVuODsgX2tleTgrKykge1xuICAgICAgICBhcmdzW19rZXk4XSA9IGFyZ3VtZW50c1tfa2V5OF07XG4gICAgICB9XG4gICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUuZ3JvdXAsIGFyZ3MpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJncm91cENvbGxhcHNlZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBncm91cENvbGxhcHNlZCgpIHtcbiAgICAgIGZvciAodmFyIF9sZW45ID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuOSksIF9rZXk5ID0gMDsgX2tleTkgPCBfbGVuOTsgX2tleTkrKykge1xuICAgICAgICBhcmdzW19rZXk5XSA9IGFyZ3VtZW50c1tfa2V5OV07XG4gICAgICB9XG4gICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUuZ3JvdXBDb2xsYXBzZWQsIGFyZ3MpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJncm91cEVuZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBncm91cEVuZCgpIHtcbiAgICAgIGZvciAodmFyIF9sZW4xMCA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjEwKSwgX2tleTEwID0gMDsgX2tleTEwIDwgX2xlbjEwOyBfa2V5MTArKykge1xuICAgICAgICBhcmdzW19rZXkxMF0gPSBhcmd1bWVudHNbX2tleTEwXTtcbiAgICAgIH1cbiAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5ncm91cEVuZCwgYXJncyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInByb2ZpbGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvZmlsZShsYWJlbCkge1xuICAgICAgdGhpc1tMT0dfU1lNQk9MXShMb2dUeXBlLnByb2ZpbGUsIFtsYWJlbF0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJwcm9maWxlRW5kXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHByb2ZpbGVFbmQobGFiZWwpIHtcbiAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5wcm9maWxlRW5kLCBbbGFiZWxdKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidGltZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0aW1lKGxhYmVsKSB7XG4gICAgICB0aGlzW1RJTUVSU19TWU1CT0xdID0gdGhpc1tUSU1FUlNfU1lNQk9MXSB8fCBuZXcgTWFwKCk7XG4gICAgICB0aGlzW1RJTUVSU19TWU1CT0xdLnNldChsYWJlbCwgcHJvY2Vzcy5ocnRpbWUoKSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInRpbWVMb2dcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdGltZUxvZyhsYWJlbCkge1xuICAgICAgdmFyIHByZXYgPSB0aGlzW1RJTUVSU19TWU1CT0xdICYmIHRoaXNbVElNRVJTX1NZTUJPTF0uZ2V0KGxhYmVsKTtcbiAgICAgIGlmICghcHJldikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBzdWNoIGxhYmVsICdcIi5jb25jYXQobGFiZWwsIFwiJyBmb3IgV2VicGFja0xvZ2dlci50aW1lTG9nKClcIikpO1xuICAgICAgfVxuICAgICAgdmFyIHRpbWUgPSBwcm9jZXNzLmhydGltZShwcmV2KTtcbiAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS50aW1lLCBbbGFiZWxdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkodGltZSkpKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidGltZUVuZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0aW1lRW5kKGxhYmVsKSB7XG4gICAgICB2YXIgcHJldiA9IHRoaXNbVElNRVJTX1NZTUJPTF0gJiYgdGhpc1tUSU1FUlNfU1lNQk9MXS5nZXQobGFiZWwpO1xuICAgICAgaWYgKCFwcmV2KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHN1Y2ggbGFiZWwgJ1wiLmNvbmNhdChsYWJlbCwgXCInIGZvciBXZWJwYWNrTG9nZ2VyLnRpbWVFbmQoKVwiKSk7XG4gICAgICB9XG4gICAgICB2YXIgdGltZSA9IHByb2Nlc3MuaHJ0aW1lKHByZXYpO1xuICAgICAgdGhpc1tUSU1FUlNfU1lNQk9MXS5kZWxldGUobGFiZWwpO1xuICAgICAgdGhpc1tMT0dfU1lNQk9MXShMb2dUeXBlLnRpbWUsIFtsYWJlbF0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheSh0aW1lKSkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ0aW1lQWdncmVnYXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHRpbWVBZ2dyZWdhdGUobGFiZWwpIHtcbiAgICAgIHZhciBwcmV2ID0gdGhpc1tUSU1FUlNfU1lNQk9MXSAmJiB0aGlzW1RJTUVSU19TWU1CT0xdLmdldChsYWJlbCk7XG4gICAgICBpZiAoIXByZXYpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gc3VjaCBsYWJlbCAnXCIuY29uY2F0KGxhYmVsLCBcIicgZm9yIFdlYnBhY2tMb2dnZXIudGltZUFnZ3JlZ2F0ZSgpXCIpKTtcbiAgICAgIH1cbiAgICAgIHZhciB0aW1lID0gcHJvY2Vzcy5ocnRpbWUocHJldik7XG4gICAgICB0aGlzW1RJTUVSU19TWU1CT0xdLmRlbGV0ZShsYWJlbCk7XG4gICAgICB0aGlzW1RJTUVSU19BR0dSRUdBVEVTX1NZTUJPTF0gPSB0aGlzW1RJTUVSU19BR0dSRUdBVEVTX1NZTUJPTF0gfHwgbmV3IE1hcCgpO1xuICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzW1RJTUVSU19BR0dSRUdBVEVTX1NZTUJPTF0uZ2V0KGxhYmVsKTtcbiAgICAgIGlmIChjdXJyZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKHRpbWVbMV0gKyBjdXJyZW50WzFdID4gMWU5KSB7XG4gICAgICAgICAgdGltZVswXSArPSBjdXJyZW50WzBdICsgMTtcbiAgICAgICAgICB0aW1lWzFdID0gdGltZVsxXSAtIDFlOSArIGN1cnJlbnRbMV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGltZVswXSArPSBjdXJyZW50WzBdO1xuICAgICAgICAgIHRpbWVbMV0gKz0gY3VycmVudFsxXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpc1tUSU1FUlNfQUdHUkVHQVRFU19TWU1CT0xdLnNldChsYWJlbCwgdGltZSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInRpbWVBZ2dyZWdhdGVFbmRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdGltZUFnZ3JlZ2F0ZUVuZChsYWJlbCkge1xuICAgICAgaWYgKHRoaXNbVElNRVJTX0FHR1JFR0FURVNfU1lNQk9MXSA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG4gICAgICB2YXIgdGltZSA9IHRoaXNbVElNRVJTX0FHR1JFR0FURVNfU1lNQk9MXS5nZXQobGFiZWwpO1xuICAgICAgaWYgKHRpbWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuICAgICAgdGhpc1tUSU1FUlNfQUdHUkVHQVRFU19TWU1CT0xdLmRlbGV0ZShsYWJlbCk7XG4gICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUudGltZSwgW2xhYmVsXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRpbWUpKSk7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBXZWJwYWNrTG9nZ2VyO1xufSgpO1xuZXhwb3J0cy5Mb2dnZXIgPSBXZWJwYWNrTG9nZ2VyO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gXCIuL25vZGVfbW9kdWxlcy93ZWJwYWNrL2xpYi9sb2dnaW5nL2NyZWF0ZUNvbnNvbGVMb2dnZXIuanNcIjpcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvY3JlYXRlQ29uc29sZUxvZ2dlci5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuLypcblx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcblx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxuKi9cblxuXG5cbmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHtcbiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTtcbn1cbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7XG4gIGlmICghbykgcmV0dXJuO1xuICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xuICB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7XG4gIGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7XG4gIGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pO1xuICBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7XG59XG5mdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHtcbiAgaWYgKHR5cGVvZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiA/IFN5bWJvbCA6IGZ1bmN0aW9uIChpKSB7IHJldHVybiBpOyB9KSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBpdGVyWyh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiID8gU3ltYm9sIDogZnVuY3Rpb24gKGkpIHsgcmV0dXJuIGk7IH0pLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbXCJAQGl0ZXJhdG9yXCJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpO1xufVxuZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikge1xuICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkoYXJyKTtcbn1cbmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7XG4gIGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIGFycjJbaV0gPSBhcnJbaV07XG4gIHJldHVybiBhcnIyO1xufVxudmFyIF9yZXF1aXJlID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9Mb2dnZXIgKi8gXCIuL25vZGVfbW9kdWxlcy93ZWJwYWNrL2xpYi9sb2dnaW5nL0xvZ2dlci5qc1wiKSxcbiAgTG9nVHlwZSA9IF9yZXF1aXJlLkxvZ1R5cGU7XG5cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KFwiLi4vLi4vZGVjbGFyYXRpb25zL1dlYnBhY2tPcHRpb25zXCIpLkZpbHRlckl0ZW1UeXBlc30gRmlsdGVySXRlbVR5cGVzICovXG4vKiogQHR5cGVkZWYge2ltcG9ydChcIi4uLy4uL2RlY2xhcmF0aW9ucy9XZWJwYWNrT3B0aW9uc1wiKS5GaWx0ZXJUeXBlc30gRmlsdGVyVHlwZXMgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KFwiLi9Mb2dnZXJcIikuTG9nVHlwZUVudW19IExvZ1R5cGVFbnVtICovXG5cbi8qKiBAdHlwZWRlZiB7ZnVuY3Rpb24oc3RyaW5nKTogYm9vbGVhbn0gRmlsdGVyRnVuY3Rpb24gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBMb2dnZXJDb25zb2xlXG4gKiBAcHJvcGVydHkge2Z1bmN0aW9uKCk6IHZvaWR9IGNsZWFyXG4gKiBAcHJvcGVydHkge2Z1bmN0aW9uKCk6IHZvaWR9IHRyYWNlXG4gKiBAcHJvcGVydHkgeyguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZH0gaW5mb1xuICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWR9IGxvZ1xuICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWR9IHdhcm5cbiAqIEBwcm9wZXJ0eSB7KC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkfSBlcnJvclxuICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBkZWJ1Z1xuICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBncm91cFxuICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBncm91cENvbGxhcHNlZFxuICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBncm91cEVuZFxuICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBzdGF0dXNcbiAqIEBwcm9wZXJ0eSB7KC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkPX0gcHJvZmlsZVxuICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBwcm9maWxlRW5kXG4gKiBAcHJvcGVydHkgeyguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZD19IGxvZ1RpbWVcbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IExvZ2dlck9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7ZmFsc2V8dHJ1ZXxcIm5vbmVcInxcImVycm9yXCJ8XCJ3YXJuXCJ8XCJpbmZvXCJ8XCJsb2dcInxcInZlcmJvc2VcIn0gbGV2ZWwgbG9nbGV2ZWxcbiAqIEBwcm9wZXJ0eSB7RmlsdGVyVHlwZXN8Ym9vbGVhbn0gZGVidWcgZmlsdGVyIGZvciBkZWJ1ZyBsb2dnaW5nXG4gKiBAcHJvcGVydHkge0xvZ2dlckNvbnNvbGV9IGNvbnNvbGUgdGhlIGNvbnNvbGUgdG8gbG9nIHRvXG4gKi9cblxuLyoqXG4gKiBAcGFyYW0ge0ZpbHRlckl0ZW1UeXBlc30gaXRlbSBhbiBpbnB1dCBpdGVtXG4gKiBAcmV0dXJucyB7RmlsdGVyRnVuY3Rpb259IGZpbHRlciBmdW5jdGlvblxuICovXG52YXIgZmlsdGVyVG9GdW5jdGlvbiA9IGZ1bmN0aW9uIGZpbHRlclRvRnVuY3Rpb24oaXRlbSkge1xuICBpZiAodHlwZW9mIGl0ZW0gPT09IFwic3RyaW5nXCIpIHtcbiAgICB2YXIgcmVnRXhwID0gbmV3IFJlZ0V4cChcIltcXFxcXFxcXC9dXCIuY29uY2F0KGl0ZW0ucmVwbGFjZShcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdXNlbGVzcy1lc2NhcGVcbiAgICAvWy1bXFxde30oKSorPy5cXFxcXiR8XS9nLCBcIlxcXFwkJlwiKSwgXCIoW1xcXFxcXFxcL118JHwhfFxcXFw/KVwiKSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpZGVudCkge1xuICAgICAgcmV0dXJuIHJlZ0V4cC50ZXN0KGlkZW50KTtcbiAgICB9O1xuICB9XG4gIGlmIChpdGVtICYmIHR5cGVvZiBpdGVtID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBpdGVtLnRlc3QgPT09IFwiZnVuY3Rpb25cIikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoaWRlbnQpIHtcbiAgICAgIHJldHVybiBpdGVtLnRlc3QoaWRlbnQpO1xuICAgIH07XG4gIH1cbiAgaWYgKHR5cGVvZiBpdGVtID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICByZXR1cm4gaXRlbTtcbiAgfVxuICBpZiAodHlwZW9mIGl0ZW0gPT09IFwiYm9vbGVhblwiKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBpdGVtO1xuICAgIH07XG4gIH1cbn07XG5cbi8qKlxuICogQGVudW0ge251bWJlcn1cbiAqL1xudmFyIExvZ0xldmVsID0ge1xuICBub25lOiA2LFxuICBmYWxzZTogNixcbiAgZXJyb3I6IDUsXG4gIHdhcm46IDQsXG4gIGluZm86IDMsXG4gIGxvZzogMixcbiAgdHJ1ZTogMixcbiAgdmVyYm9zZTogMVxufTtcblxuLyoqXG4gKiBAcGFyYW0ge0xvZ2dlck9wdGlvbnN9IG9wdGlvbnMgb3B0aW9ucyBvYmplY3RcbiAqIEByZXR1cm5zIHtmdW5jdGlvbihzdHJpbmcsIExvZ1R5cGVFbnVtLCBhbnlbXSk6IHZvaWR9IGxvZ2dpbmcgZnVuY3Rpb25cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoX3JlZikge1xuICB2YXIgX3JlZiRsZXZlbCA9IF9yZWYubGV2ZWwsXG4gICAgbGV2ZWwgPSBfcmVmJGxldmVsID09PSB2b2lkIDAgPyBcImluZm9cIiA6IF9yZWYkbGV2ZWwsXG4gICAgX3JlZiRkZWJ1ZyA9IF9yZWYuZGVidWcsXG4gICAgZGVidWcgPSBfcmVmJGRlYnVnID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYkZGVidWcsXG4gICAgY29uc29sZSA9IF9yZWYuY29uc29sZTtcbiAgdmFyIGRlYnVnRmlsdGVycyA9IHR5cGVvZiBkZWJ1ZyA9PT0gXCJib29sZWFuXCIgPyBbZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBkZWJ1ZztcbiAgfV0gOiAvKiogQHR5cGUge0ZpbHRlckl0ZW1UeXBlc1tdfSAqL1tdLmNvbmNhdChkZWJ1ZykubWFwKGZpbHRlclRvRnVuY3Rpb24pO1xuICAvKiogQHR5cGUge251bWJlcn0gKi9cbiAgdmFyIGxvZ2xldmVsID0gTG9nTGV2ZWxbXCJcIi5jb25jYXQobGV2ZWwpXSB8fCAwO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBuYW1lIG9mIHRoZSBsb2dnZXJcbiAgICogQHBhcmFtIHtMb2dUeXBlRW51bX0gdHlwZSB0eXBlIG9mIHRoZSBsb2cgZW50cnlcbiAgICogQHBhcmFtIHthbnlbXX0gYXJncyBhcmd1bWVudHMgb2YgdGhlIGxvZyBlbnRyeVxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIHZhciBsb2dnZXIgPSBmdW5jdGlvbiBsb2dnZXIobmFtZSwgdHlwZSwgYXJncykge1xuICAgIHZhciBsYWJlbGVkQXJncyA9IGZ1bmN0aW9uIGxhYmVsZWRBcmdzKCkge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJncykpIHtcbiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gMCAmJiB0eXBlb2YgYXJnc1swXSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIHJldHVybiBbXCJbXCIuY29uY2F0KG5hbWUsIFwiXSBcIikuY29uY2F0KGFyZ3NbMF0pXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFyZ3Muc2xpY2UoMSkpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gW1wiW1wiLmNvbmNhdChuYW1lLCBcIl1cIildLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoYXJncykpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgZGVidWcgPSBkZWJ1Z0ZpbHRlcnMuc29tZShmdW5jdGlvbiAoZikge1xuICAgICAgcmV0dXJuIGYobmFtZSk7XG4gICAgfSk7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIExvZ1R5cGUuZGVidWc6XG4gICAgICAgIGlmICghZGVidWcpIHJldHVybjtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGluc1xuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuZGVidWcgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnNcbiAgICAgICAgICBjb25zb2xlLmRlYnVnLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgTG9nVHlwZS5sb2c6XG4gICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC5sb2cpIHJldHVybjtcbiAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ1R5cGUuaW5mbzpcbiAgICAgICAgaWYgKCFkZWJ1ZyAmJiBsb2dsZXZlbCA+IExvZ0xldmVsLmluZm8pIHJldHVybjtcbiAgICAgICAgY29uc29sZS5pbmZvLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBMb2dUeXBlLndhcm46XG4gICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC53YXJuKSByZXR1cm47XG4gICAgICAgIGNvbnNvbGUud2Fybi5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgTG9nVHlwZS5lcnJvcjpcbiAgICAgICAgaWYgKCFkZWJ1ZyAmJiBsb2dsZXZlbCA+IExvZ0xldmVsLmVycm9yKSByZXR1cm47XG4gICAgICAgIGNvbnNvbGUuZXJyb3IuYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ1R5cGUudHJhY2U6XG4gICAgICAgIGlmICghZGVidWcpIHJldHVybjtcbiAgICAgICAgY29uc29sZS50cmFjZSgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgTG9nVHlwZS5ncm91cENvbGxhcHNlZDpcbiAgICAgICAgaWYgKCFkZWJ1ZyAmJiBsb2dsZXZlbCA+IExvZ0xldmVsLmxvZykgcmV0dXJuO1xuICAgICAgICBpZiAoIWRlYnVnICYmIGxvZ2xldmVsID4gTG9nTGV2ZWwudmVyYm9zZSkge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnNcbiAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGluc1xuICAgICAgICAgICAgY29uc29sZS5ncm91cENvbGxhcHNlZC5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgLy8gZmFsbHMgdGhyb3VnaFxuICAgICAgY2FzZSBMb2dUeXBlLmdyb3VwOlxuICAgICAgICBpZiAoIWRlYnVnICYmIGxvZ2xldmVsID4gTG9nTGV2ZWwubG9nKSByZXR1cm47XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnNcbiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLmdyb3VwID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm9kZS9uby11bnN1cHBvcnRlZC1mZWF0dXJlcy9ub2RlLWJ1aWx0aW5zXG4gICAgICAgICAgY29uc29sZS5ncm91cC5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ1R5cGUuZ3JvdXBFbmQ6XG4gICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC5sb2cpIHJldHVybjtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGluc1xuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuZ3JvdXBFbmQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnNcbiAgICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ1R5cGUudGltZTpcbiAgICAgICAge1xuICAgICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC5sb2cpIHJldHVybjtcbiAgICAgICAgICB2YXIgbXMgPSBhcmdzWzFdICogMTAwMCArIGFyZ3NbMl0gLyAxMDAwMDAwO1xuICAgICAgICAgIHZhciBtc2cgPSBcIltcIi5jb25jYXQobmFtZSwgXCJdIFwiKS5jb25jYXQoYXJnc1swXSwgXCI6IFwiKS5jb25jYXQobXMsIFwiIG1zXCIpO1xuICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5sb2dUaW1lID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nVGltZShtc2cpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgY2FzZSBMb2dUeXBlLnByb2ZpbGU6XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnNcbiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLnByb2ZpbGUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnNcbiAgICAgICAgICBjb25zb2xlLnByb2ZpbGUuYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgTG9nVHlwZS5wcm9maWxlRW5kOlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm9kZS9uby11bnN1cHBvcnRlZC1mZWF0dXJlcy9ub2RlLWJ1aWx0aW5zXG4gICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5wcm9maWxlRW5kID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm9kZS9uby11bnN1cHBvcnRlZC1mZWF0dXJlcy9ub2RlLWJ1aWx0aW5zXG4gICAgICAgICAgY29uc29sZS5wcm9maWxlRW5kLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ1R5cGUuY2xlYXI6XG4gICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC5sb2cpIHJldHVybjtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGluc1xuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuY2xlYXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnNcbiAgICAgICAgICBjb25zb2xlLmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ1R5cGUuc3RhdHVzOlxuICAgICAgICBpZiAoIWRlYnVnICYmIGxvZ2xldmVsID4gTG9nTGV2ZWwuaW5mbykgcmV0dXJuO1xuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuc3RhdHVzID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUuc3RhdHVzKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuc3RhdHVzLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgY29uc29sZS5pbmZvLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBMb2dUeXBlIFwiLmNvbmNhdCh0eXBlKSk7XG4gICAgfVxuICB9O1xuICByZXR1cm4gbG9nZ2VyO1xufTtcblxuLyoqKi8gfSksXG5cbi8qKiovIFwiLi9ub2RlX21vZHVsZXMvd2VicGFjay9saWIvbG9nZ2luZy9ydW50aW1lLmpzXCI6XG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy93ZWJwYWNrL2xpYi9sb2dnaW5nL3J1bnRpbWUuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbi8qXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG5cblxuXG5mdW5jdGlvbiBfZXh0ZW5kcygpIHtcbiAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduID8gT2JqZWN0LmFzc2lnbi5iaW5kKCkgOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7XG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xuICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbnZhciBTeW5jQmFpbEhvb2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISB0YXBhYmxlL2xpYi9TeW5jQmFpbEhvb2sgKi8gXCIuL2NsaWVudC1zcmMvbW9kdWxlcy9sb2dnZXIvU3luY0JhaWxIb29rRmFrZS5qc1wiKTtcbnZhciBfcmVxdWlyZSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vTG9nZ2VyICovIFwiLi9ub2RlX21vZHVsZXMvd2VicGFjay9saWIvbG9nZ2luZy9Mb2dnZXIuanNcIiksXG4gIExvZ2dlciA9IF9yZXF1aXJlLkxvZ2dlcjtcbnZhciBjcmVhdGVDb25zb2xlTG9nZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9jcmVhdGVDb25zb2xlTG9nZ2VyICovIFwiLi9ub2RlX21vZHVsZXMvd2VicGFjay9saWIvbG9nZ2luZy9jcmVhdGVDb25zb2xlTG9nZ2VyLmpzXCIpO1xuXG4vKiogQHR5cGUge2NyZWF0ZUNvbnNvbGVMb2dnZXIuTG9nZ2VyT3B0aW9uc30gKi9cbnZhciBjdXJyZW50RGVmYXVsdExvZ2dlck9wdGlvbnMgPSB7XG4gIGxldmVsOiBcImluZm9cIixcbiAgZGVidWc6IGZhbHNlLFxuICBjb25zb2xlOiBjb25zb2xlXG59O1xudmFyIGN1cnJlbnREZWZhdWx0TG9nZ2VyID0gY3JlYXRlQ29uc29sZUxvZ2dlcihjdXJyZW50RGVmYXVsdExvZ2dlck9wdGlvbnMpO1xuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIG5hbWUgb2YgdGhlIGxvZ2dlclxuICogQHJldHVybnMge0xvZ2dlcn0gYSBsb2dnZXJcbiAqL1xuZXhwb3J0cy5nZXRMb2dnZXIgPSBmdW5jdGlvbiAobmFtZSkge1xuICByZXR1cm4gbmV3IExvZ2dlcihmdW5jdGlvbiAodHlwZSwgYXJncykge1xuICAgIGlmIChleHBvcnRzLmhvb2tzLmxvZy5jYWxsKG5hbWUsIHR5cGUsIGFyZ3MpID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGN1cnJlbnREZWZhdWx0TG9nZ2VyKG5hbWUsIHR5cGUsIGFyZ3MpO1xuICAgIH1cbiAgfSwgZnVuY3Rpb24gKGNoaWxkTmFtZSkge1xuICAgIHJldHVybiBleHBvcnRzLmdldExvZ2dlcihcIlwiLmNvbmNhdChuYW1lLCBcIi9cIikuY29uY2F0KGNoaWxkTmFtZSkpO1xuICB9KTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtjcmVhdGVDb25zb2xlTG9nZ2VyLkxvZ2dlck9wdGlvbnN9IG9wdGlvbnMgbmV3IG9wdGlvbnMsIG1lcmdlIHdpdGggb2xkIG9wdGlvbnNcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5leHBvcnRzLmNvbmZpZ3VyZURlZmF1bHRMb2dnZXIgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICBfZXh0ZW5kcyhjdXJyZW50RGVmYXVsdExvZ2dlck9wdGlvbnMsIG9wdGlvbnMpO1xuICBjdXJyZW50RGVmYXVsdExvZ2dlciA9IGNyZWF0ZUNvbnNvbGVMb2dnZXIoY3VycmVudERlZmF1bHRMb2dnZXJPcHRpb25zKTtcbn07XG5leHBvcnRzLmhvb2tzID0ge1xuICBsb2c6IG5ldyBTeW5jQmFpbEhvb2soW1wib3JpZ2luXCIsIFwidHlwZVwiLCBcImFyZ3NcIl0pXG59O1xuXG4vKioqLyB9KVxuXG4vKioqKioqLyBcdH0pO1xuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG4vKioqKioqLyBcdFxuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG4vKioqKioqLyBcdFx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG4vKioqKioqLyBcdFx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi8gXHRcbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovIFx0XG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovIFx0XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gXHQvKiB3ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMgKi9cbi8qKioqKiovIFx0IWZ1bmN0aW9uKCkge1xuLyoqKioqKi8gXHRcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBkZWZpbml0aW9uKSB7XG4vKioqKioqLyBcdFx0XHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG4vKioqKioqLyBcdFx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuLyoqKioqKi8gXHRcdFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG4vKioqKioqLyBcdFx0XHRcdH1cbi8qKioqKiovIFx0XHRcdH1cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi8gXHR9KCk7XG4vKioqKioqLyBcdFxuLyoqKioqKi8gXHQvKiB3ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kICovXG4vKioqKioqLyBcdCFmdW5jdGlvbigpIHtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmosIHByb3ApIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOyB9XG4vKioqKioqLyBcdH0oKTtcbi8qKioqKiovIFx0XG4vKioqKioqLyBcdC8qIHdlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QgKi9cbi8qKioqKiovIFx0IWZ1bmN0aW9uKCkge1xuLyoqKioqKi8gXHRcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4vKioqKioqLyBcdFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbi8qKioqKiovIFx0XHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4vKioqKioqLyBcdFx0XHR9XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqKioqKi8gXHRcdH07XG4vKioqKioqLyBcdH0oKTtcbi8qKioqKiovIFx0XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xudmFyIF9fd2VicGFja19leHBvcnRzX18gPSB7fTtcbi8vIFRoaXMgZW50cnkgbmVlZCB0byBiZSB3cmFwcGVkIGluIGFuIElJRkUgYmVjYXVzZSBpdCBuZWVkIHRvIGJlIGlzb2xhdGVkIGFnYWluc3Qgb3RoZXIgbW9kdWxlcyBpbiB0aGUgY2h1bmsuXG4hZnVuY3Rpb24oKSB7XG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL2NsaWVudC1zcmMvbW9kdWxlcy9sb2dnZXIvaW5kZXguanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO1xuLyogaGFybW9ueSBleHBvcnQgKi8gX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIHtcbi8qIGhhcm1vbnkgZXhwb3J0ICovICAgXCJkZWZhdWx0XCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgZGVmYXVsdCBleHBvcnQgZnJvbSBuYW1lZCBtb2R1bGUgKi8gd2VicGFja19saWJfbG9nZ2luZ19ydW50aW1lX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX187IH1cbi8qIGhhcm1vbnkgZXhwb3J0ICovIH0pO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIHdlYnBhY2tfbGliX2xvZ2dpbmdfcnVudGltZV9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgd2VicGFjay9saWIvbG9nZ2luZy9ydW50aW1lLmpzICovIFwiLi9ub2RlX21vZHVsZXMvd2VicGFjay9saWIvbG9nZ2luZy9ydW50aW1lLmpzXCIpO1xuXG59KCk7XG52YXIgX193ZWJwYWNrX2V4cG9ydF90YXJnZXRfXyA9IGV4cG9ydHM7XG5mb3IodmFyIGkgaW4gX193ZWJwYWNrX2V4cG9ydHNfXykgX193ZWJwYWNrX2V4cG9ydF90YXJnZXRfX1tpXSA9IF9fd2VicGFja19leHBvcnRzX19baV07XG5pZihfX3dlYnBhY2tfZXhwb3J0c19fLl9fZXNNb2R1bGUpIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfZXhwb3J0X3RhcmdldF9fLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKioqKiovIH0pKClcbjsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/modules/logger/index.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/overlay.js":
/*!***********************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/overlay.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createOverlay: () => (/* binding */ createOverlay),\n/* harmony export */   formatProblem: () => (/* binding */ formatProblem)\n/* harmony export */ });\n/* harmony import */ var ansi_html_community__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ansi-html-community */ \"./node_modules/ansi-html-community/index.js\");\n/* harmony import */ var ansi_html_community__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ansi_html_community__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var html_entities__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! html-entities */ \"./node_modules/html-entities/dist/esm/index.js\");\n/* harmony import */ var _overlay_runtime_error_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./overlay/runtime-error.js */ \"./node_modules/webpack-dev-server/client/overlay/runtime-error.js\");\n/* harmony import */ var _overlay_state_machine_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./overlay/state-machine.js */ \"./node_modules/webpack-dev-server/client/overlay/state-machine.js\");\n/* harmony import */ var _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./overlay/styles.js */ \"./node_modules/webpack-dev-server/client/overlay/styles.js\");\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n// The error overlay is inspired (and mostly copied) from Create React App (https://github.com/facebookincubator/create-react-app)\n// They, in turn, got inspired by webpack-hot-middleware (https://github.com/glenjamin/webpack-hot-middleware).\n\n\n\n\n\n\nvar colors = {\n  reset: [\"transparent\", \"transparent\"],\n  black: \"181818\",\n  red: \"E36049\",\n  green: \"B3CB74\",\n  yellow: \"FFD080\",\n  blue: \"7CAFC2\",\n  magenta: \"7FACCA\",\n  cyan: \"C3C2EF\",\n  lightgrey: \"EBE7E3\",\n  darkgrey: \"6D7891\"\n};\nansi_html_community__WEBPACK_IMPORTED_MODULE_0___default().setColors(colors);\n\n/**\n * @param {string} type\n * @param {string  | { file?: string, moduleName?: string, loc?: string, message?: string; stack?: string[] }} item\n * @returns {{ header: string, body: string }}\n */\nfunction formatProblem(type, item) {\n  var header = type === \"warning\" ? \"WARNING\" : \"ERROR\";\n  var body = \"\";\n  if (typeof item === \"string\") {\n    body += item;\n  } else {\n    var file = item.file || \"\";\n    // eslint-disable-next-line no-nested-ternary\n    var moduleName = item.moduleName ? item.moduleName.indexOf(\"!\") !== -1 ? \"\".concat(item.moduleName.replace(/^(\\s|\\S)*!/, \"\"), \" (\").concat(item.moduleName, \")\") : \"\".concat(item.moduleName) : \"\";\n    var loc = item.loc;\n    header += \"\".concat(moduleName || file ? \" in \".concat(moduleName ? \"\".concat(moduleName).concat(file ? \" (\".concat(file, \")\") : \"\") : file).concat(loc ? \" \".concat(loc) : \"\") : \"\");\n    body += item.message || \"\";\n  }\n  if (Array.isArray(item.stack)) {\n    item.stack.forEach(function (stack) {\n      if (typeof stack === \"string\") {\n        body += \"\\r\\n\".concat(stack);\n      }\n    });\n  }\n  return {\n    header: header,\n    body: body\n  };\n}\n\n/**\n * @typedef {Object} CreateOverlayOptions\n * @property {string | null} trustedTypesPolicyName\n * @property {boolean | (error: Error) => void} [catchRuntimeError]\n */\n\n/**\n *\n * @param {CreateOverlayOptions} options\n */\nvar createOverlay = function createOverlay(options) {\n  /** @type {HTMLIFrameElement | null | undefined} */\n  var iframeContainerElement;\n  /** @type {HTMLDivElement | null | undefined} */\n  var containerElement;\n  /** @type {HTMLDivElement | null | undefined} */\n  var headerElement;\n  /** @type {Array<(element: HTMLDivElement) => void>} */\n  var onLoadQueue = [];\n  /** @type {TrustedTypePolicy | undefined} */\n  var overlayTrustedTypesPolicy;\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @param {CSSStyleDeclaration} style\n   */\n  function applyStyle(element, style) {\n    Object.keys(style).forEach(function (prop) {\n      element.style[prop] = style[prop];\n    });\n  }\n\n  /**\n   * @param {string | null} trustedTypesPolicyName\n   */\n  function createContainer(trustedTypesPolicyName) {\n    // Enable Trusted Types if they are available in the current browser.\n    if (window.trustedTypes) {\n      overlayTrustedTypesPolicy = window.trustedTypes.createPolicy(trustedTypesPolicyName || \"webpack-dev-server#overlay\", {\n        createHTML: function createHTML(value) {\n          return value;\n        }\n      });\n    }\n    iframeContainerElement = document.createElement(\"iframe\");\n    iframeContainerElement.id = \"webpack-dev-server-client-overlay\";\n    iframeContainerElement.src = \"about:blank\";\n    applyStyle(iframeContainerElement, _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__.iframeStyle);\n    iframeContainerElement.onload = function () {\n      var contentElement = /** @type {Document} */\n      /** @type {HTMLIFrameElement} */\n      iframeContainerElement.contentDocument.createElement(\"div\");\n      containerElement = /** @type {Document} */\n      /** @type {HTMLIFrameElement} */\n      iframeContainerElement.contentDocument.createElement(\"div\");\n      contentElement.id = \"webpack-dev-server-client-overlay-div\";\n      applyStyle(contentElement, _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__.containerStyle);\n      headerElement = document.createElement(\"div\");\n      headerElement.innerText = \"Compiled with problems:\";\n      applyStyle(headerElement, _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__.headerStyle);\n      var closeButtonElement = document.createElement(\"button\");\n      applyStyle(closeButtonElement, _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__.dismissButtonStyle);\n      closeButtonElement.innerText = \"\";\n      closeButtonElement.ariaLabel = \"Dismiss\";\n      closeButtonElement.addEventListener(\"click\", function () {\n        // eslint-disable-next-line no-use-before-define\n        overlayService.send({\n          type: \"DISMISS\"\n        });\n      });\n      contentElement.appendChild(headerElement);\n      contentElement.appendChild(closeButtonElement);\n      contentElement.appendChild(containerElement);\n\n      /** @type {Document} */\n      /** @type {HTMLIFrameElement} */\n      iframeContainerElement.contentDocument.body.appendChild(contentElement);\n      onLoadQueue.forEach(function (onLoad) {\n        onLoad( /** @type {HTMLDivElement} */contentElement);\n      });\n      onLoadQueue = [];\n\n      /** @type {HTMLIFrameElement} */\n      iframeContainerElement.onload = null;\n    };\n    document.body.appendChild(iframeContainerElement);\n  }\n\n  /**\n   * @param {(element: HTMLDivElement) => void} callback\n   * @param {string | null} trustedTypesPolicyName\n   */\n  function ensureOverlayExists(callback, trustedTypesPolicyName) {\n    if (containerElement) {\n      containerElement.innerHTML = \"\";\n      // Everything is ready, call the callback right away.\n      callback(containerElement);\n      return;\n    }\n    onLoadQueue.push(callback);\n    if (iframeContainerElement) {\n      return;\n    }\n    createContainer(trustedTypesPolicyName);\n  }\n\n  // Successful compilation.\n  function hide() {\n    if (!iframeContainerElement) {\n      return;\n    }\n\n    // Clean up and reset internal state.\n    document.body.removeChild(iframeContainerElement);\n    iframeContainerElement = null;\n    containerElement = null;\n  }\n\n  // Compilation with errors (e.g. syntax error or missing modules).\n  /**\n   * @param {string} type\n   * @param {Array<string  | { moduleIdentifier?: string, moduleName?: string, loc?: string, message?: string }>} messages\n   * @param {string | null} trustedTypesPolicyName\n   * @param {'build' | 'runtime'} messageSource\n   */\n  function show(type, messages, trustedTypesPolicyName, messageSource) {\n    ensureOverlayExists(function () {\n      headerElement.innerText = messageSource === \"runtime\" ? \"Uncaught runtime errors:\" : \"Compiled with problems:\";\n      messages.forEach(function (message) {\n        var entryElement = document.createElement(\"div\");\n        var msgStyle = type === \"warning\" ? _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__.msgStyles.warning : _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__.msgStyles.error;\n        applyStyle(entryElement, _objectSpread(_objectSpread({}, msgStyle), {}, {\n          padding: \"1rem 1rem 1.5rem 1rem\"\n        }));\n        var typeElement = document.createElement(\"div\");\n        var _formatProblem = formatProblem(type, message),\n          header = _formatProblem.header,\n          body = _formatProblem.body;\n        typeElement.innerText = header;\n        applyStyle(typeElement, _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__.msgTypeStyle);\n        if (message.moduleIdentifier) {\n          applyStyle(typeElement, {\n            cursor: \"pointer\"\n          });\n          // element.dataset not supported in IE\n          typeElement.setAttribute(\"data-can-open\", true);\n          typeElement.addEventListener(\"click\", function () {\n            fetch(\"/webpack-dev-server/open-editor?fileName=\".concat(message.moduleIdentifier));\n          });\n        }\n\n        // Make it look similar to our terminal.\n        var text = ansi_html_community__WEBPACK_IMPORTED_MODULE_0___default()((0,html_entities__WEBPACK_IMPORTED_MODULE_1__.encode)(body));\n        var messageTextNode = document.createElement(\"div\");\n        applyStyle(messageTextNode, _overlay_styles_js__WEBPACK_IMPORTED_MODULE_4__.msgTextStyle);\n        messageTextNode.innerHTML = overlayTrustedTypesPolicy ? overlayTrustedTypesPolicy.createHTML(text) : text;\n        entryElement.appendChild(typeElement);\n        entryElement.appendChild(messageTextNode);\n\n        /** @type {HTMLDivElement} */\n        containerElement.appendChild(entryElement);\n      });\n    }, trustedTypesPolicyName);\n  }\n  var overlayService = (0,_overlay_state_machine_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])({\n    showOverlay: function showOverlay(_ref) {\n      var _ref$level = _ref.level,\n        level = _ref$level === void 0 ? \"error\" : _ref$level,\n        messages = _ref.messages,\n        messageSource = _ref.messageSource;\n      return show(level, messages, options.trustedTypesPolicyName, messageSource);\n    },\n    hideOverlay: hide\n  });\n  if (options.catchRuntimeError) {\n    /**\n     * @param {Error | undefined} error\n     * @param {string} fallbackMessage\n     */\n    var handleError = function handleError(error, fallbackMessage) {\n      var errorObject = error instanceof Error ? error : new Error(error || fallbackMessage);\n      var shouldDisplay = typeof options.catchRuntimeError === \"function\" ? options.catchRuntimeError(errorObject) : true;\n      if (shouldDisplay) {\n        overlayService.send({\n          type: \"RUNTIME_ERROR\",\n          messages: [{\n            message: errorObject.message,\n            stack: (0,_overlay_runtime_error_js__WEBPACK_IMPORTED_MODULE_2__.parseErrorToStacks)(errorObject)\n          }]\n        });\n      }\n    };\n    (0,_overlay_runtime_error_js__WEBPACK_IMPORTED_MODULE_2__.listenToRuntimeError)(function (errorEvent) {\n      // error property may be empty in older browser like IE\n      var error = errorEvent.error,\n        message = errorEvent.message;\n      if (!error && !message) {\n        return;\n      }\n      handleError(error, message);\n    });\n    (0,_overlay_runtime_error_js__WEBPACK_IMPORTED_MODULE_2__.listenToUnhandledRejection)(function (promiseRejectionEvent) {\n      var reason = promiseRejectionEvent.reason;\n      handleError(reason, \"Unknown promise rejection reason\");\n    });\n  }\n  return overlayService;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9vdmVybGF5LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsMkNBQTJDLGdDQUFnQyxvQ0FBb0Msb0RBQW9ELDZEQUE2RCxpRUFBaUUsc0NBQXNDO0FBQ3ZVLGlDQUFpQyxnQkFBZ0Isc0JBQXNCLE9BQU8sdURBQXVELDZEQUE2RCw0Q0FBNEMsb0tBQW9LLG1GQUFtRixLQUFLO0FBQzFlLDRDQUE0QywyQkFBMkIsa0JBQWtCLGtDQUFrQyxvRUFBb0UsS0FBSyxPQUFPLG9CQUFvQjtBQUMvTiwrQkFBK0IsdUNBQXVDO0FBQ3RFLHFDQUFxQywrREFBK0Qsc0NBQXNDLDBCQUEwQiwrQ0FBK0MseUNBQXlDLHVFQUF1RTtBQUNuVTtBQUNBOztBQUUyQztBQUNKO0FBQzJFO0FBQ3BEO0FBQzRFO0FBQzFJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFrQjs7QUFFbEI7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxZQUFZLG9FQUFvRSxvQkFBb0I7QUFDL0csZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCLGNBQWMsZUFBZTtBQUM3QixjQUFjLGtDQUFrQztBQUNoRDs7QUFFQTtBQUNBO0FBQ0EsV0FBVyxzQkFBc0I7QUFDakM7QUFDQTtBQUNBLGFBQWEsc0NBQXNDO0FBQ25EO0FBQ0EsYUFBYSxtQ0FBbUM7QUFDaEQ7QUFDQSxhQUFhLG1DQUFtQztBQUNoRDtBQUNBLGFBQWEsMENBQTBDO0FBQ3ZEO0FBQ0EsYUFBYSwrQkFBK0I7QUFDNUM7O0FBRUE7QUFDQTtBQUNBLGFBQWEsYUFBYTtBQUMxQixhQUFhLHFCQUFxQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBLGFBQWEsZUFBZTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDJEQUFXO0FBQ2xEO0FBQ0Esc0NBQXNDLFVBQVU7QUFDaEQsaUJBQWlCLG1CQUFtQjtBQUNwQztBQUNBLG9DQUFvQyxVQUFVO0FBQzlDLGlCQUFpQixtQkFBbUI7QUFDcEM7QUFDQTtBQUNBLGlDQUFpQyw4REFBYztBQUMvQztBQUNBO0FBQ0EsZ0NBQWdDLDJEQUFXO0FBQzNDO0FBQ0EscUNBQXFDLGtFQUFrQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQSxpQkFBaUIsVUFBVTtBQUMzQixpQkFBaUIsbUJBQW1CO0FBQ3BDO0FBQ0E7QUFDQSwyQkFBMkIsZ0JBQWdCO0FBQzNDLE9BQU87QUFDUDs7QUFFQSxpQkFBaUIsbUJBQW1CO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsYUFBYSxtQ0FBbUM7QUFDaEQsYUFBYSxlQUFlO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhLFFBQVE7QUFDckIsYUFBYSxrQkFBa0IsZ0ZBQWdGLEdBQUc7QUFDbEgsYUFBYSxlQUFlO0FBQzVCLGFBQWEscUJBQXFCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0Qyx5REFBUyxXQUFXLHlEQUFTO0FBQ3pFLCtEQUErRCxlQUFlO0FBQzlFO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsNERBQVk7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBO0FBQ0EsbUJBQW1CLDBEQUFRLENBQUMscURBQU07QUFDbEM7QUFDQSxvQ0FBb0MsNERBQVk7QUFDaEQ7QUFDQTtBQUNBOztBQUVBLG1CQUFtQixnQkFBZ0I7QUFDbkM7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsdUJBQXVCLHFFQUFvQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGVBQWUsbUJBQW1CO0FBQ2xDLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsNkVBQWtCO0FBQ3JDLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLElBQUksK0VBQW9CO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUkscUZBQTBCO0FBQzlCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy93ZWJwYWNrLWRldi1zZXJ2ZXIvY2xpZW50L292ZXJsYXkuanM/ZmEwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgZW51bWVyYWJsZU9ubHkgJiYgKHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfVxuZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IG51bGwgIT0gYXJndW1lbnRzW2ldID8gYXJndW1lbnRzW2ldIDoge307IGkgJSAyID8gb3duS2V5cyhPYmplY3Qoc291cmNlKSwgITApLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSkgOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSkgOiBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IHJldHVybiB0YXJnZXQ7IH1cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9XG5mdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleShhcmcpIHsgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsIFwic3RyaW5nXCIpOyByZXR1cm4gdHlwZW9mIGtleSA9PT0gXCJzeW1ib2xcIiA/IGtleSA6IFN0cmluZyhrZXkpOyB9XG5mdW5jdGlvbiBfdG9QcmltaXRpdmUoaW5wdXQsIGhpbnQpIHsgaWYgKHR5cGVvZiBpbnB1dCAhPT0gXCJvYmplY3RcIiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0OyB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmIChwcmltICE9PSB1bmRlZmluZWQpIHsgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCBcImRlZmF1bHRcIik7IGlmICh0eXBlb2YgcmVzICE9PSBcIm9iamVjdFwiKSByZXR1cm4gcmVzOyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS5cIik7IH0gcmV0dXJuIChoaW50ID09PSBcInN0cmluZ1wiID8gU3RyaW5nIDogTnVtYmVyKShpbnB1dCk7IH1cbi8vIFRoZSBlcnJvciBvdmVybGF5IGlzIGluc3BpcmVkIChhbmQgbW9zdGx5IGNvcGllZCkgZnJvbSBDcmVhdGUgUmVhY3QgQXBwIChodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2tpbmN1YmF0b3IvY3JlYXRlLXJlYWN0LWFwcClcbi8vIFRoZXksIGluIHR1cm4sIGdvdCBpbnNwaXJlZCBieSB3ZWJwYWNrLWhvdC1taWRkbGV3YXJlIChodHRwczovL2dpdGh1Yi5jb20vZ2xlbmphbWluL3dlYnBhY2staG90LW1pZGRsZXdhcmUpLlxuXG5pbXBvcnQgYW5zaUhUTUwgZnJvbSBcImFuc2ktaHRtbC1jb21tdW5pdHlcIjtcbmltcG9ydCB7IGVuY29kZSB9IGZyb20gXCJodG1sLWVudGl0aWVzXCI7XG5pbXBvcnQgeyBsaXN0ZW5Ub1J1bnRpbWVFcnJvciwgbGlzdGVuVG9VbmhhbmRsZWRSZWplY3Rpb24sIHBhcnNlRXJyb3JUb1N0YWNrcyB9IGZyb20gXCIuL292ZXJsYXkvcnVudGltZS1lcnJvci5qc1wiO1xuaW1wb3J0IGNyZWF0ZU92ZXJsYXlNYWNoaW5lIGZyb20gXCIuL292ZXJsYXkvc3RhdGUtbWFjaGluZS5qc1wiO1xuaW1wb3J0IHsgY29udGFpbmVyU3R5bGUsIGRpc21pc3NCdXR0b25TdHlsZSwgaGVhZGVyU3R5bGUsIGlmcmFtZVN0eWxlLCBtc2dTdHlsZXMsIG1zZ1RleHRTdHlsZSwgbXNnVHlwZVN0eWxlIH0gZnJvbSBcIi4vb3ZlcmxheS9zdHlsZXMuanNcIjtcbnZhciBjb2xvcnMgPSB7XG4gIHJlc2V0OiBbXCJ0cmFuc3BhcmVudFwiLCBcInRyYW5zcGFyZW50XCJdLFxuICBibGFjazogXCIxODE4MThcIixcbiAgcmVkOiBcIkUzNjA0OVwiLFxuICBncmVlbjogXCJCM0NCNzRcIixcbiAgeWVsbG93OiBcIkZGRDA4MFwiLFxuICBibHVlOiBcIjdDQUZDMlwiLFxuICBtYWdlbnRhOiBcIjdGQUNDQVwiLFxuICBjeWFuOiBcIkMzQzJFRlwiLFxuICBsaWdodGdyZXk6IFwiRUJFN0UzXCIsXG4gIGRhcmtncmV5OiBcIjZENzg5MVwiXG59O1xuYW5zaUhUTUwuc2V0Q29sb3JzKGNvbG9ycyk7XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEBwYXJhbSB7c3RyaW5nICB8IHsgZmlsZT86IHN0cmluZywgbW9kdWxlTmFtZT86IHN0cmluZywgbG9jPzogc3RyaW5nLCBtZXNzYWdlPzogc3RyaW5nOyBzdGFjaz86IHN0cmluZ1tdIH19IGl0ZW1cbiAqIEByZXR1cm5zIHt7IGhlYWRlcjogc3RyaW5nLCBib2R5OiBzdHJpbmcgfX1cbiAqL1xuZnVuY3Rpb24gZm9ybWF0UHJvYmxlbSh0eXBlLCBpdGVtKSB7XG4gIHZhciBoZWFkZXIgPSB0eXBlID09PSBcIndhcm5pbmdcIiA/IFwiV0FSTklOR1wiIDogXCJFUlJPUlwiO1xuICB2YXIgYm9keSA9IFwiXCI7XG4gIGlmICh0eXBlb2YgaXRlbSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGJvZHkgKz0gaXRlbTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgZmlsZSA9IGl0ZW0uZmlsZSB8fCBcIlwiO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1uZXN0ZWQtdGVybmFyeVxuICAgIHZhciBtb2R1bGVOYW1lID0gaXRlbS5tb2R1bGVOYW1lID8gaXRlbS5tb2R1bGVOYW1lLmluZGV4T2YoXCIhXCIpICE9PSAtMSA/IFwiXCIuY29uY2F0KGl0ZW0ubW9kdWxlTmFtZS5yZXBsYWNlKC9eKFxcc3xcXFMpKiEvLCBcIlwiKSwgXCIgKFwiKS5jb25jYXQoaXRlbS5tb2R1bGVOYW1lLCBcIilcIikgOiBcIlwiLmNvbmNhdChpdGVtLm1vZHVsZU5hbWUpIDogXCJcIjtcbiAgICB2YXIgbG9jID0gaXRlbS5sb2M7XG4gICAgaGVhZGVyICs9IFwiXCIuY29uY2F0KG1vZHVsZU5hbWUgfHwgZmlsZSA/IFwiIGluIFwiLmNvbmNhdChtb2R1bGVOYW1lID8gXCJcIi5jb25jYXQobW9kdWxlTmFtZSkuY29uY2F0KGZpbGUgPyBcIiAoXCIuY29uY2F0KGZpbGUsIFwiKVwiKSA6IFwiXCIpIDogZmlsZSkuY29uY2F0KGxvYyA/IFwiIFwiLmNvbmNhdChsb2MpIDogXCJcIikgOiBcIlwiKTtcbiAgICBib2R5ICs9IGl0ZW0ubWVzc2FnZSB8fCBcIlwiO1xuICB9XG4gIGlmIChBcnJheS5pc0FycmF5KGl0ZW0uc3RhY2spKSB7XG4gICAgaXRlbS5zdGFjay5mb3JFYWNoKGZ1bmN0aW9uIChzdGFjaykge1xuICAgICAgaWYgKHR5cGVvZiBzdGFjayA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBib2R5ICs9IFwiXFxyXFxuXCIuY29uY2F0KHN0YWNrKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGhlYWRlcjogaGVhZGVyLFxuICAgIGJvZHk6IGJvZHlcbiAgfTtcbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDcmVhdGVPdmVybGF5T3B0aW9uc1xuICogQHByb3BlcnR5IHtzdHJpbmcgfCBudWxsfSB0cnVzdGVkVHlwZXNQb2xpY3lOYW1lXG4gKiBAcHJvcGVydHkge2Jvb2xlYW4gfCAoZXJyb3I6IEVycm9yKSA9PiB2b2lkfSBbY2F0Y2hSdW50aW1lRXJyb3JdXG4gKi9cblxuLyoqXG4gKlxuICogQHBhcmFtIHtDcmVhdGVPdmVybGF5T3B0aW9uc30gb3B0aW9uc1xuICovXG52YXIgY3JlYXRlT3ZlcmxheSA9IGZ1bmN0aW9uIGNyZWF0ZU92ZXJsYXkob3B0aW9ucykge1xuICAvKiogQHR5cGUge0hUTUxJRnJhbWVFbGVtZW50IHwgbnVsbCB8IHVuZGVmaW5lZH0gKi9cbiAgdmFyIGlmcmFtZUNvbnRhaW5lckVsZW1lbnQ7XG4gIC8qKiBAdHlwZSB7SFRNTERpdkVsZW1lbnQgfCBudWxsIHwgdW5kZWZpbmVkfSAqL1xuICB2YXIgY29udGFpbmVyRWxlbWVudDtcbiAgLyoqIEB0eXBlIHtIVE1MRGl2RWxlbWVudCB8IG51bGwgfCB1bmRlZmluZWR9ICovXG4gIHZhciBoZWFkZXJFbGVtZW50O1xuICAvKiogQHR5cGUge0FycmF5PChlbGVtZW50OiBIVE1MRGl2RWxlbWVudCkgPT4gdm9pZD59ICovXG4gIHZhciBvbkxvYWRRdWV1ZSA9IFtdO1xuICAvKiogQHR5cGUge1RydXN0ZWRUeXBlUG9saWN5IHwgdW5kZWZpbmVkfSAqL1xuICB2YXIgb3ZlcmxheVRydXN0ZWRUeXBlc1BvbGljeTtcblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudFxuICAgKiBAcGFyYW0ge0NTU1N0eWxlRGVjbGFyYXRpb259IHN0eWxlXG4gICAqL1xuICBmdW5jdGlvbiBhcHBseVN0eWxlKGVsZW1lbnQsIHN0eWxlKSB7XG4gICAgT2JqZWN0LmtleXMoc3R5bGUpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgIGVsZW1lbnQuc3R5bGVbcHJvcF0gPSBzdHlsZVtwcm9wXTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bGx9IHRydXN0ZWRUeXBlc1BvbGljeU5hbWVcbiAgICovXG4gIGZ1bmN0aW9uIGNyZWF0ZUNvbnRhaW5lcih0cnVzdGVkVHlwZXNQb2xpY3lOYW1lKSB7XG4gICAgLy8gRW5hYmxlIFRydXN0ZWQgVHlwZXMgaWYgdGhleSBhcmUgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGJyb3dzZXIuXG4gICAgaWYgKHdpbmRvdy50cnVzdGVkVHlwZXMpIHtcbiAgICAgIG92ZXJsYXlUcnVzdGVkVHlwZXNQb2xpY3kgPSB3aW5kb3cudHJ1c3RlZFR5cGVzLmNyZWF0ZVBvbGljeSh0cnVzdGVkVHlwZXNQb2xpY3lOYW1lIHx8IFwid2VicGFjay1kZXYtc2VydmVyI292ZXJsYXlcIiwge1xuICAgICAgICBjcmVhdGVIVE1MOiBmdW5jdGlvbiBjcmVhdGVIVE1MKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgaWZyYW1lQ29udGFpbmVyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XG4gICAgaWZyYW1lQ29udGFpbmVyRWxlbWVudC5pZCA9IFwid2VicGFjay1kZXYtc2VydmVyLWNsaWVudC1vdmVybGF5XCI7XG4gICAgaWZyYW1lQ29udGFpbmVyRWxlbWVudC5zcmMgPSBcImFib3V0OmJsYW5rXCI7XG4gICAgYXBwbHlTdHlsZShpZnJhbWVDb250YWluZXJFbGVtZW50LCBpZnJhbWVTdHlsZSk7XG4gICAgaWZyYW1lQ29udGFpbmVyRWxlbWVudC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgY29udGVudEVsZW1lbnQgPSAvKiogQHR5cGUge0RvY3VtZW50fSAqL1xuICAgICAgLyoqIEB0eXBlIHtIVE1MSUZyYW1lRWxlbWVudH0gKi9cbiAgICAgIGlmcmFtZUNvbnRhaW5lckVsZW1lbnQuY29udGVudERvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBjb250YWluZXJFbGVtZW50ID0gLyoqIEB0eXBlIHtEb2N1bWVudH0gKi9cbiAgICAgIC8qKiBAdHlwZSB7SFRNTElGcmFtZUVsZW1lbnR9ICovXG4gICAgICBpZnJhbWVDb250YWluZXJFbGVtZW50LmNvbnRlbnREb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgY29udGVudEVsZW1lbnQuaWQgPSBcIndlYnBhY2stZGV2LXNlcnZlci1jbGllbnQtb3ZlcmxheS1kaXZcIjtcbiAgICAgIGFwcGx5U3R5bGUoY29udGVudEVsZW1lbnQsIGNvbnRhaW5lclN0eWxlKTtcbiAgICAgIGhlYWRlckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgaGVhZGVyRWxlbWVudC5pbm5lclRleHQgPSBcIkNvbXBpbGVkIHdpdGggcHJvYmxlbXM6XCI7XG4gICAgICBhcHBseVN0eWxlKGhlYWRlckVsZW1lbnQsIGhlYWRlclN0eWxlKTtcbiAgICAgIHZhciBjbG9zZUJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgYXBwbHlTdHlsZShjbG9zZUJ1dHRvbkVsZW1lbnQsIGRpc21pc3NCdXR0b25TdHlsZSk7XG4gICAgICBjbG9zZUJ1dHRvbkVsZW1lbnQuaW5uZXJUZXh0ID0gXCLDl1wiO1xuICAgICAgY2xvc2VCdXR0b25FbGVtZW50LmFyaWFMYWJlbCA9IFwiRGlzbWlzc1wiO1xuICAgICAgY2xvc2VCdXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11c2UtYmVmb3JlLWRlZmluZVxuICAgICAgICBvdmVybGF5U2VydmljZS5zZW5kKHtcbiAgICAgICAgICB0eXBlOiBcIkRJU01JU1NcIlxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgY29udGVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoaGVhZGVyRWxlbWVudCk7XG4gICAgICBjb250ZW50RWxlbWVudC5hcHBlbmRDaGlsZChjbG9zZUJ1dHRvbkVsZW1lbnQpO1xuICAgICAgY29udGVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoY29udGFpbmVyRWxlbWVudCk7XG5cbiAgICAgIC8qKiBAdHlwZSB7RG9jdW1lbnR9ICovXG4gICAgICAvKiogQHR5cGUge0hUTUxJRnJhbWVFbGVtZW50fSAqL1xuICAgICAgaWZyYW1lQ29udGFpbmVyRWxlbWVudC5jb250ZW50RG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250ZW50RWxlbWVudCk7XG4gICAgICBvbkxvYWRRdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uIChvbkxvYWQpIHtcbiAgICAgICAgb25Mb2FkKCAvKiogQHR5cGUge0hUTUxEaXZFbGVtZW50fSAqL2NvbnRlbnRFbGVtZW50KTtcbiAgICAgIH0pO1xuICAgICAgb25Mb2FkUXVldWUgPSBbXTtcblxuICAgICAgLyoqIEB0eXBlIHtIVE1MSUZyYW1lRWxlbWVudH0gKi9cbiAgICAgIGlmcmFtZUNvbnRhaW5lckVsZW1lbnQub25sb2FkID0gbnVsbDtcbiAgICB9O1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lQ29udGFpbmVyRWxlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHsoZWxlbWVudDogSFRNTERpdkVsZW1lbnQpID0+IHZvaWR9IGNhbGxiYWNrXG4gICAqIEBwYXJhbSB7c3RyaW5nIHwgbnVsbH0gdHJ1c3RlZFR5cGVzUG9saWN5TmFtZVxuICAgKi9cbiAgZnVuY3Rpb24gZW5zdXJlT3ZlcmxheUV4aXN0cyhjYWxsYmFjaywgdHJ1c3RlZFR5cGVzUG9saWN5TmFtZSkge1xuICAgIGlmIChjb250YWluZXJFbGVtZW50KSB7XG4gICAgICBjb250YWluZXJFbGVtZW50LmlubmVySFRNTCA9IFwiXCI7XG4gICAgICAvLyBFdmVyeXRoaW5nIGlzIHJlYWR5LCBjYWxsIHRoZSBjYWxsYmFjayByaWdodCBhd2F5LlxuICAgICAgY2FsbGJhY2soY29udGFpbmVyRWxlbWVudCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG9uTG9hZFF1ZXVlLnB1c2goY2FsbGJhY2spO1xuICAgIGlmIChpZnJhbWVDb250YWluZXJFbGVtZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNyZWF0ZUNvbnRhaW5lcih0cnVzdGVkVHlwZXNQb2xpY3lOYW1lKTtcbiAgfVxuXG4gIC8vIFN1Y2Nlc3NmdWwgY29tcGlsYXRpb24uXG4gIGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgaWYgKCFpZnJhbWVDb250YWluZXJFbGVtZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2xlYW4gdXAgYW5kIHJlc2V0IGludGVybmFsIHN0YXRlLlxuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaWZyYW1lQ29udGFpbmVyRWxlbWVudCk7XG4gICAgaWZyYW1lQ29udGFpbmVyRWxlbWVudCA9IG51bGw7XG4gICAgY29udGFpbmVyRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICAvLyBDb21waWxhdGlvbiB3aXRoIGVycm9ycyAoZS5nLiBzeW50YXggZXJyb3Igb3IgbWlzc2luZyBtb2R1bGVzKS5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gICAqIEBwYXJhbSB7QXJyYXk8c3RyaW5nICB8IHsgbW9kdWxlSWRlbnRpZmllcj86IHN0cmluZywgbW9kdWxlTmFtZT86IHN0cmluZywgbG9jPzogc3RyaW5nLCBtZXNzYWdlPzogc3RyaW5nIH0+fSBtZXNzYWdlc1xuICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bGx9IHRydXN0ZWRUeXBlc1BvbGljeU5hbWVcbiAgICogQHBhcmFtIHsnYnVpbGQnIHwgJ3J1bnRpbWUnfSBtZXNzYWdlU291cmNlXG4gICAqL1xuICBmdW5jdGlvbiBzaG93KHR5cGUsIG1lc3NhZ2VzLCB0cnVzdGVkVHlwZXNQb2xpY3lOYW1lLCBtZXNzYWdlU291cmNlKSB7XG4gICAgZW5zdXJlT3ZlcmxheUV4aXN0cyhmdW5jdGlvbiAoKSB7XG4gICAgICBoZWFkZXJFbGVtZW50LmlubmVyVGV4dCA9IG1lc3NhZ2VTb3VyY2UgPT09IFwicnVudGltZVwiID8gXCJVbmNhdWdodCBydW50aW1lIGVycm9yczpcIiA6IFwiQ29tcGlsZWQgd2l0aCBwcm9ibGVtczpcIjtcbiAgICAgIG1lc3NhZ2VzLmZvckVhY2goZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIGVudHJ5RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHZhciBtc2dTdHlsZSA9IHR5cGUgPT09IFwid2FybmluZ1wiID8gbXNnU3R5bGVzLndhcm5pbmcgOiBtc2dTdHlsZXMuZXJyb3I7XG4gICAgICAgIGFwcGx5U3R5bGUoZW50cnlFbGVtZW50LCBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1zZ1N0eWxlKSwge30sIHtcbiAgICAgICAgICBwYWRkaW5nOiBcIjFyZW0gMXJlbSAxLjVyZW0gMXJlbVwiXG4gICAgICAgIH0pKTtcbiAgICAgICAgdmFyIHR5cGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdmFyIF9mb3JtYXRQcm9ibGVtID0gZm9ybWF0UHJvYmxlbSh0eXBlLCBtZXNzYWdlKSxcbiAgICAgICAgICBoZWFkZXIgPSBfZm9ybWF0UHJvYmxlbS5oZWFkZXIsXG4gICAgICAgICAgYm9keSA9IF9mb3JtYXRQcm9ibGVtLmJvZHk7XG4gICAgICAgIHR5cGVFbGVtZW50LmlubmVyVGV4dCA9IGhlYWRlcjtcbiAgICAgICAgYXBwbHlTdHlsZSh0eXBlRWxlbWVudCwgbXNnVHlwZVN0eWxlKTtcbiAgICAgICAgaWYgKG1lc3NhZ2UubW9kdWxlSWRlbnRpZmllcikge1xuICAgICAgICAgIGFwcGx5U3R5bGUodHlwZUVsZW1lbnQsIHtcbiAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyBlbGVtZW50LmRhdGFzZXQgbm90IHN1cHBvcnRlZCBpbiBJRVxuICAgICAgICAgIHR5cGVFbGVtZW50LnNldEF0dHJpYnV0ZShcImRhdGEtY2FuLW9wZW5cIiwgdHJ1ZSk7XG4gICAgICAgICAgdHlwZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZldGNoKFwiL3dlYnBhY2stZGV2LXNlcnZlci9vcGVuLWVkaXRvcj9maWxlTmFtZT1cIi5jb25jYXQobWVzc2FnZS5tb2R1bGVJZGVudGlmaWVyKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNYWtlIGl0IGxvb2sgc2ltaWxhciB0byBvdXIgdGVybWluYWwuXG4gICAgICAgIHZhciB0ZXh0ID0gYW5zaUhUTUwoZW5jb2RlKGJvZHkpKTtcbiAgICAgICAgdmFyIG1lc3NhZ2VUZXh0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGFwcGx5U3R5bGUobWVzc2FnZVRleHROb2RlLCBtc2dUZXh0U3R5bGUpO1xuICAgICAgICBtZXNzYWdlVGV4dE5vZGUuaW5uZXJIVE1MID0gb3ZlcmxheVRydXN0ZWRUeXBlc1BvbGljeSA/IG92ZXJsYXlUcnVzdGVkVHlwZXNQb2xpY3kuY3JlYXRlSFRNTCh0ZXh0KSA6IHRleHQ7XG4gICAgICAgIGVudHJ5RWxlbWVudC5hcHBlbmRDaGlsZCh0eXBlRWxlbWVudCk7XG4gICAgICAgIGVudHJ5RWxlbWVudC5hcHBlbmRDaGlsZChtZXNzYWdlVGV4dE5vZGUpO1xuXG4gICAgICAgIC8qKiBAdHlwZSB7SFRNTERpdkVsZW1lbnR9ICovXG4gICAgICAgIGNvbnRhaW5lckVsZW1lbnQuYXBwZW5kQ2hpbGQoZW50cnlFbGVtZW50KTtcbiAgICAgIH0pO1xuICAgIH0sIHRydXN0ZWRUeXBlc1BvbGljeU5hbWUpO1xuICB9XG4gIHZhciBvdmVybGF5U2VydmljZSA9IGNyZWF0ZU92ZXJsYXlNYWNoaW5lKHtcbiAgICBzaG93T3ZlcmxheTogZnVuY3Rpb24gc2hvd092ZXJsYXkoX3JlZikge1xuICAgICAgdmFyIF9yZWYkbGV2ZWwgPSBfcmVmLmxldmVsLFxuICAgICAgICBsZXZlbCA9IF9yZWYkbGV2ZWwgPT09IHZvaWQgMCA/IFwiZXJyb3JcIiA6IF9yZWYkbGV2ZWwsXG4gICAgICAgIG1lc3NhZ2VzID0gX3JlZi5tZXNzYWdlcyxcbiAgICAgICAgbWVzc2FnZVNvdXJjZSA9IF9yZWYubWVzc2FnZVNvdXJjZTtcbiAgICAgIHJldHVybiBzaG93KGxldmVsLCBtZXNzYWdlcywgb3B0aW9ucy50cnVzdGVkVHlwZXNQb2xpY3lOYW1lLCBtZXNzYWdlU291cmNlKTtcbiAgICB9LFxuICAgIGhpZGVPdmVybGF5OiBoaWRlXG4gIH0pO1xuICBpZiAob3B0aW9ucy5jYXRjaFJ1bnRpbWVFcnJvcikge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RXJyb3IgfCB1bmRlZmluZWR9IGVycm9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZhbGxiYWNrTWVzc2FnZVxuICAgICAqL1xuICAgIHZhciBoYW5kbGVFcnJvciA9IGZ1bmN0aW9uIGhhbmRsZUVycm9yKGVycm9yLCBmYWxsYmFja01lc3NhZ2UpIHtcbiAgICAgIHZhciBlcnJvck9iamVjdCA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihlcnJvciB8fCBmYWxsYmFja01lc3NhZ2UpO1xuICAgICAgdmFyIHNob3VsZERpc3BsYXkgPSB0eXBlb2Ygb3B0aW9ucy5jYXRjaFJ1bnRpbWVFcnJvciA9PT0gXCJmdW5jdGlvblwiID8gb3B0aW9ucy5jYXRjaFJ1bnRpbWVFcnJvcihlcnJvck9iamVjdCkgOiB0cnVlO1xuICAgICAgaWYgKHNob3VsZERpc3BsYXkpIHtcbiAgICAgICAgb3ZlcmxheVNlcnZpY2Uuc2VuZCh7XG4gICAgICAgICAgdHlwZTogXCJSVU5USU1FX0VSUk9SXCIsXG4gICAgICAgICAgbWVzc2FnZXM6IFt7XG4gICAgICAgICAgICBtZXNzYWdlOiBlcnJvck9iamVjdC5tZXNzYWdlLFxuICAgICAgICAgICAgc3RhY2s6IHBhcnNlRXJyb3JUb1N0YWNrcyhlcnJvck9iamVjdClcbiAgICAgICAgICB9XVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGxpc3RlblRvUnVudGltZUVycm9yKGZ1bmN0aW9uIChlcnJvckV2ZW50KSB7XG4gICAgICAvLyBlcnJvciBwcm9wZXJ0eSBtYXkgYmUgZW1wdHkgaW4gb2xkZXIgYnJvd3NlciBsaWtlIElFXG4gICAgICB2YXIgZXJyb3IgPSBlcnJvckV2ZW50LmVycm9yLFxuICAgICAgICBtZXNzYWdlID0gZXJyb3JFdmVudC5tZXNzYWdlO1xuICAgICAgaWYgKCFlcnJvciAmJiAhbWVzc2FnZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSk7XG4gICAgfSk7XG4gICAgbGlzdGVuVG9VbmhhbmRsZWRSZWplY3Rpb24oZnVuY3Rpb24gKHByb21pc2VSZWplY3Rpb25FdmVudCkge1xuICAgICAgdmFyIHJlYXNvbiA9IHByb21pc2VSZWplY3Rpb25FdmVudC5yZWFzb247XG4gICAgICBoYW5kbGVFcnJvcihyZWFzb24sIFwiVW5rbm93biBwcm9taXNlIHJlamVjdGlvbiByZWFzb25cIik7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIG92ZXJsYXlTZXJ2aWNlO1xufTtcbmV4cG9ydCB7IGZvcm1hdFByb2JsZW0sIGNyZWF0ZU92ZXJsYXkgfTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/overlay.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/overlay/fsm.js":
/*!***************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/overlay/fsm.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n/**\n * @typedef {Object} StateDefinitions\n * @property {{[event: string]: { target: string; actions?: Array<string> }}} [on]\n */\n\n/**\n * @typedef {Object} Options\n * @property {{[state: string]: StateDefinitions}} states\n * @property {object} context;\n * @property {string} initial\n */\n\n/**\n * @typedef {Object} Implementation\n * @property {{[actionName: string]: (ctx: object, event: any) => object}} actions\n */\n\n/**\n * A simplified `createMachine` from `@xstate/fsm` with the following differences:\n *\n *  - the returned machine is technically a \"service\". No `interpret(machine).start()` is needed.\n *  - the state definition only support `on` and target must be declared with { target: 'nextState', actions: [] } explicitly.\n *  - event passed to `send` must be an object with `type` property.\n *  - actions implementation will be [assign action](https://xstate.js.org/docs/guides/context.html#assign-action) if you return any value.\n *  Do not return anything if you just want to invoke side effect.\n *\n * The goal of this custom function is to avoid installing the entire `'xstate/fsm'` package, while enabling modeling using\n * state machine. You can copy the first parameter into the editor at https://stately.ai/viz to visualize the state machine.\n *\n * @param {Options} options\n * @param {Implementation} implementation\n */\nfunction createMachine(_ref, _ref2) {\n  var states = _ref.states,\n    context = _ref.context,\n    initial = _ref.initial;\n  var actions = _ref2.actions;\n  var currentState = initial;\n  var currentContext = context;\n  return {\n    send: function send(event) {\n      var currentStateOn = states[currentState].on;\n      var transitionConfig = currentStateOn && currentStateOn[event.type];\n      if (transitionConfig) {\n        currentState = transitionConfig.target;\n        if (transitionConfig.actions) {\n          transitionConfig.actions.forEach(function (actName) {\n            var actionImpl = actions[actName];\n            var nextContextValue = actionImpl && actionImpl(currentContext, event);\n            if (nextContextValue) {\n              currentContext = _objectSpread(_objectSpread({}, currentContext), nextContextValue);\n            }\n          });\n        }\n      }\n    }\n  };\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (createMachine);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9vdmVybGF5L2ZzbS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsMkNBQTJDLGdDQUFnQyxvQ0FBb0Msb0RBQW9ELDZEQUE2RCxpRUFBaUUsc0NBQXNDO0FBQ3ZVLGlDQUFpQyxnQkFBZ0Isc0JBQXNCLE9BQU8sdURBQXVELDZEQUE2RCw0Q0FBNEMsb0tBQW9LLG1GQUFtRixLQUFLO0FBQzFlLDRDQUE0QywyQkFBMkIsa0JBQWtCLGtDQUFrQyxvRUFBb0UsS0FBSyxPQUFPLG9CQUFvQjtBQUMvTiwrQkFBK0IsdUNBQXVDO0FBQ3RFLHFDQUFxQywrREFBK0Qsc0NBQXNDLDBCQUEwQiwrQ0FBK0MseUNBQXlDLHVFQUF1RTtBQUNuVTtBQUNBLGFBQWEsUUFBUTtBQUNyQixlQUFlLG1CQUFtQixnQkFBZ0IsNEJBQTRCO0FBQzlFOztBQUVBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCLGVBQWUsb0NBQW9DO0FBQ25ELGNBQWMsUUFBUTtBQUN0QixjQUFjLFFBQVE7QUFDdEI7O0FBRUE7QUFDQSxhQUFhLFFBQVE7QUFDckIsZUFBZSw0REFBNEQ7QUFDM0U7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0YsbUNBQW1DO0FBQ25IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxTQUFTO0FBQ3BCLFdBQVcsZ0JBQWdCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZEO0FBQzdEO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBZSxhQUFhIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy93ZWJwYWNrLWRldi1zZXJ2ZXIvY2xpZW50L292ZXJsYXkvZnNtLmpzP2YwZmYiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGVudW1lcmFibGVPbmx5ICYmIChzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSkpLCBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH1cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBudWxsICE9IGFyZ3VtZW50c1tpXSA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpICUgMiA/IG93bktleXMoT2JqZWN0KHNvdXJjZSksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpIDogb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSByZXR1cm4gdGFyZ2V0OyB9XG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfVxuZnVuY3Rpb24gX3RvUHJvcGVydHlLZXkoYXJnKSB7IHZhciBrZXkgPSBfdG9QcmltaXRpdmUoYXJnLCBcInN0cmluZ1wiKTsgcmV0dXJuIHR5cGVvZiBrZXkgPT09IFwic3ltYm9sXCIgPyBrZXkgOiBTdHJpbmcoa2V5KTsgfVxuZnVuY3Rpb24gX3RvUHJpbWl0aXZlKGlucHV0LCBoaW50KSB7IGlmICh0eXBlb2YgaW5wdXQgIT09IFwib2JqZWN0XCIgfHwgaW5wdXQgPT09IG51bGwpIHJldHVybiBpbnB1dDsgdmFyIHByaW0gPSBpbnB1dFtTeW1ib2wudG9QcmltaXRpdmVdOyBpZiAocHJpbSAhPT0gdW5kZWZpbmVkKSB7IHZhciByZXMgPSBwcmltLmNhbGwoaW5wdXQsIGhpbnQgfHwgXCJkZWZhdWx0XCIpOyBpZiAodHlwZW9mIHJlcyAhPT0gXCJvYmplY3RcIikgcmV0dXJuIHJlczsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuXCIpOyB9IHJldHVybiAoaGludCA9PT0gXCJzdHJpbmdcIiA/IFN0cmluZyA6IE51bWJlcikoaW5wdXQpOyB9XG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFN0YXRlRGVmaW5pdGlvbnNcbiAqIEBwcm9wZXJ0eSB7e1tldmVudDogc3RyaW5nXTogeyB0YXJnZXQ6IHN0cmluZzsgYWN0aW9ucz86IEFycmF5PHN0cmluZz4gfX19IFtvbl1cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7e1tzdGF0ZTogc3RyaW5nXTogU3RhdGVEZWZpbml0aW9uc319IHN0YXRlc1xuICogQHByb3BlcnR5IHtvYmplY3R9IGNvbnRleHQ7XG4gKiBAcHJvcGVydHkge3N0cmluZ30gaW5pdGlhbFxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gSW1wbGVtZW50YXRpb25cbiAqIEBwcm9wZXJ0eSB7e1thY3Rpb25OYW1lOiBzdHJpbmddOiAoY3R4OiBvYmplY3QsIGV2ZW50OiBhbnkpID0+IG9iamVjdH19IGFjdGlvbnNcbiAqL1xuXG4vKipcbiAqIEEgc2ltcGxpZmllZCBgY3JlYXRlTWFjaGluZWAgZnJvbSBgQHhzdGF0ZS9mc21gIHdpdGggdGhlIGZvbGxvd2luZyBkaWZmZXJlbmNlczpcbiAqXG4gKiAgLSB0aGUgcmV0dXJuZWQgbWFjaGluZSBpcyB0ZWNobmljYWxseSBhIFwic2VydmljZVwiLiBObyBgaW50ZXJwcmV0KG1hY2hpbmUpLnN0YXJ0KClgIGlzIG5lZWRlZC5cbiAqICAtIHRoZSBzdGF0ZSBkZWZpbml0aW9uIG9ubHkgc3VwcG9ydCBgb25gIGFuZCB0YXJnZXQgbXVzdCBiZSBkZWNsYXJlZCB3aXRoIHsgdGFyZ2V0OiAnbmV4dFN0YXRlJywgYWN0aW9uczogW10gfSBleHBsaWNpdGx5LlxuICogIC0gZXZlbnQgcGFzc2VkIHRvIGBzZW5kYCBtdXN0IGJlIGFuIG9iamVjdCB3aXRoIGB0eXBlYCBwcm9wZXJ0eS5cbiAqICAtIGFjdGlvbnMgaW1wbGVtZW50YXRpb24gd2lsbCBiZSBbYXNzaWduIGFjdGlvbl0oaHR0cHM6Ly94c3RhdGUuanMub3JnL2RvY3MvZ3VpZGVzL2NvbnRleHQuaHRtbCNhc3NpZ24tYWN0aW9uKSBpZiB5b3UgcmV0dXJuIGFueSB2YWx1ZS5cbiAqICBEbyBub3QgcmV0dXJuIGFueXRoaW5nIGlmIHlvdSBqdXN0IHdhbnQgdG8gaW52b2tlIHNpZGUgZWZmZWN0LlxuICpcbiAqIFRoZSBnb2FsIG9mIHRoaXMgY3VzdG9tIGZ1bmN0aW9uIGlzIHRvIGF2b2lkIGluc3RhbGxpbmcgdGhlIGVudGlyZSBgJ3hzdGF0ZS9mc20nYCBwYWNrYWdlLCB3aGlsZSBlbmFibGluZyBtb2RlbGluZyB1c2luZ1xuICogc3RhdGUgbWFjaGluZS4gWW91IGNhbiBjb3B5IHRoZSBmaXJzdCBwYXJhbWV0ZXIgaW50byB0aGUgZWRpdG9yIGF0IGh0dHBzOi8vc3RhdGVseS5haS92aXogdG8gdmlzdWFsaXplIHRoZSBzdGF0ZSBtYWNoaW5lLlxuICpcbiAqIEBwYXJhbSB7T3B0aW9uc30gb3B0aW9uc1xuICogQHBhcmFtIHtJbXBsZW1lbnRhdGlvbn0gaW1wbGVtZW50YXRpb25cbiAqL1xuZnVuY3Rpb24gY3JlYXRlTWFjaGluZShfcmVmLCBfcmVmMikge1xuICB2YXIgc3RhdGVzID0gX3JlZi5zdGF0ZXMsXG4gICAgY29udGV4dCA9IF9yZWYuY29udGV4dCxcbiAgICBpbml0aWFsID0gX3JlZi5pbml0aWFsO1xuICB2YXIgYWN0aW9ucyA9IF9yZWYyLmFjdGlvbnM7XG4gIHZhciBjdXJyZW50U3RhdGUgPSBpbml0aWFsO1xuICB2YXIgY3VycmVudENvbnRleHQgPSBjb250ZXh0O1xuICByZXR1cm4ge1xuICAgIHNlbmQ6IGZ1bmN0aW9uIHNlbmQoZXZlbnQpIHtcbiAgICAgIHZhciBjdXJyZW50U3RhdGVPbiA9IHN0YXRlc1tjdXJyZW50U3RhdGVdLm9uO1xuICAgICAgdmFyIHRyYW5zaXRpb25Db25maWcgPSBjdXJyZW50U3RhdGVPbiAmJiBjdXJyZW50U3RhdGVPbltldmVudC50eXBlXTtcbiAgICAgIGlmICh0cmFuc2l0aW9uQ29uZmlnKSB7XG4gICAgICAgIGN1cnJlbnRTdGF0ZSA9IHRyYW5zaXRpb25Db25maWcudGFyZ2V0O1xuICAgICAgICBpZiAodHJhbnNpdGlvbkNvbmZpZy5hY3Rpb25zKSB7XG4gICAgICAgICAgdHJhbnNpdGlvbkNvbmZpZy5hY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGFjdE5hbWUpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpb25JbXBsID0gYWN0aW9uc1thY3ROYW1lXTtcbiAgICAgICAgICAgIHZhciBuZXh0Q29udGV4dFZhbHVlID0gYWN0aW9uSW1wbCAmJiBhY3Rpb25JbXBsKGN1cnJlbnRDb250ZXh0LCBldmVudCk7XG4gICAgICAgICAgICBpZiAobmV4dENvbnRleHRWYWx1ZSkge1xuICAgICAgICAgICAgICBjdXJyZW50Q29udGV4dCA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgY3VycmVudENvbnRleHQpLCBuZXh0Q29udGV4dFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZU1hY2hpbmU7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/overlay/fsm.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/overlay/runtime-error.js":
/*!*************************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/overlay/runtime-error.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   listenToRuntimeError: () => (/* binding */ listenToRuntimeError),\n/* harmony export */   listenToUnhandledRejection: () => (/* binding */ listenToUnhandledRejection),\n/* harmony export */   parseErrorToStacks: () => (/* binding */ parseErrorToStacks)\n/* harmony export */ });\n/**\n *\n * @param {Error} error\n */\nfunction parseErrorToStacks(error) {\n  if (!error || !(error instanceof Error)) {\n    throw new Error(\"parseErrorToStacks expects Error object\");\n  }\n  if (typeof error.stack === \"string\") {\n    return error.stack.split(\"\\n\").filter(function (stack) {\n      return stack !== \"Error: \".concat(error.message);\n    });\n  }\n}\n\n/**\n * @callback ErrorCallback\n * @param {ErrorEvent} error\n * @returns {void}\n */\n\n/**\n * @param {ErrorCallback} callback\n */\nfunction listenToRuntimeError(callback) {\n  window.addEventListener(\"error\", callback);\n  return function cleanup() {\n    window.removeEventListener(\"error\", callback);\n  };\n}\n\n/**\n * @callback UnhandledRejectionCallback\n * @param {PromiseRejectionEvent} rejectionEvent\n * @returns {void}\n */\n\n/**\n * @param {UnhandledRejectionCallback} callback\n */\nfunction listenToUnhandledRejection(callback) {\n  window.addEventListener(\"unhandledrejection\", callback);\n  return function cleanup() {\n    window.removeEventListener(\"unhandledrejection\", callback);\n  };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9vdmVybGF5L3J1bnRpbWUtZXJyb3IuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVcsWUFBWTtBQUN2QixhQUFhO0FBQ2I7O0FBRUE7QUFDQSxXQUFXLGVBQWU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVcsdUJBQXVCO0FBQ2xDLGFBQWE7QUFDYjs7QUFFQTtBQUNBLFdBQVcsNEJBQTRCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy93ZWJwYWNrLWRldi1zZXJ2ZXIvY2xpZW50L292ZXJsYXkvcnVudGltZS1lcnJvci5qcz8xYTNkIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICpcbiAqIEBwYXJhbSB7RXJyb3J9IGVycm9yXG4gKi9cbmZ1bmN0aW9uIHBhcnNlRXJyb3JUb1N0YWNrcyhlcnJvcikge1xuICBpZiAoIWVycm9yIHx8ICEoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJwYXJzZUVycm9yVG9TdGFja3MgZXhwZWN0cyBFcnJvciBvYmplY3RcIik7XG4gIH1cbiAgaWYgKHR5cGVvZiBlcnJvci5zdGFjayA9PT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBlcnJvci5zdGFjay5zcGxpdChcIlxcblwiKS5maWx0ZXIoZnVuY3Rpb24gKHN0YWNrKSB7XG4gICAgICByZXR1cm4gc3RhY2sgIT09IFwiRXJyb3I6IFwiLmNvbmNhdChlcnJvci5tZXNzYWdlKTtcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIEBjYWxsYmFjayBFcnJvckNhbGxiYWNrXG4gKiBAcGFyYW0ge0Vycm9yRXZlbnR9IGVycm9yXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuXG4vKipcbiAqIEBwYXJhbSB7RXJyb3JDYWxsYmFja30gY2FsbGJhY2tcbiAqL1xuZnVuY3Rpb24gbGlzdGVuVG9SdW50aW1lRXJyb3IoY2FsbGJhY2spIHtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBjYWxsYmFjayk7XG4gIHJldHVybiBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgY2FsbGJhY2spO1xuICB9O1xufVxuXG4vKipcbiAqIEBjYWxsYmFjayBVbmhhbmRsZWRSZWplY3Rpb25DYWxsYmFja1xuICogQHBhcmFtIHtQcm9taXNlUmVqZWN0aW9uRXZlbnR9IHJlamVjdGlvbkV2ZW50XG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuXG4vKipcbiAqIEBwYXJhbSB7VW5oYW5kbGVkUmVqZWN0aW9uQ2FsbGJhY2t9IGNhbGxiYWNrXG4gKi9cbmZ1bmN0aW9uIGxpc3RlblRvVW5oYW5kbGVkUmVqZWN0aW9uKGNhbGxiYWNrKSB7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidW5oYW5kbGVkcmVqZWN0aW9uXCIsIGNhbGxiYWNrKTtcbiAgcmV0dXJuIGZ1bmN0aW9uIGNsZWFudXAoKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ1bmhhbmRsZWRyZWplY3Rpb25cIiwgY2FsbGJhY2spO1xuICB9O1xufVxuZXhwb3J0IHsgbGlzdGVuVG9SdW50aW1lRXJyb3IsIGxpc3RlblRvVW5oYW5kbGVkUmVqZWN0aW9uLCBwYXJzZUVycm9yVG9TdGFja3MgfTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/overlay/runtime-error.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/overlay/state-machine.js":
/*!*************************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/overlay/state-machine.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fsm.js */ \"./node_modules/webpack-dev-server/client/overlay/fsm.js\");\n\n\n/**\n * @typedef {Object} ShowOverlayData\n * @property {'warning' | 'error'} level\n * @property {Array<string  | { moduleIdentifier?: string, moduleName?: string, loc?: string, message?: string }>} messages\n * @property {'build' | 'runtime'} messageSource\n */\n\n/**\n * @typedef {Object} CreateOverlayMachineOptions\n * @property {(data: ShowOverlayData) => void} showOverlay\n * @property {() => void} hideOverlay\n */\n\n/**\n * @param {CreateOverlayMachineOptions} options\n */\nvar createOverlayMachine = function createOverlayMachine(options) {\n  var hideOverlay = options.hideOverlay,\n    showOverlay = options.showOverlay;\n  var overlayMachine = (0,_fsm_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n    initial: \"hidden\",\n    context: {\n      level: \"error\",\n      messages: [],\n      messageSource: \"build\"\n    },\n    states: {\n      hidden: {\n        on: {\n          BUILD_ERROR: {\n            target: \"displayBuildError\",\n            actions: [\"setMessages\", \"showOverlay\"]\n          },\n          RUNTIME_ERROR: {\n            target: \"displayRuntimeError\",\n            actions: [\"setMessages\", \"showOverlay\"]\n          }\n        }\n      },\n      displayBuildError: {\n        on: {\n          DISMISS: {\n            target: \"hidden\",\n            actions: [\"dismissMessages\", \"hideOverlay\"]\n          },\n          BUILD_ERROR: {\n            target: \"displayBuildError\",\n            actions: [\"appendMessages\", \"showOverlay\"]\n          }\n        }\n      },\n      displayRuntimeError: {\n        on: {\n          DISMISS: {\n            target: \"hidden\",\n            actions: [\"dismissMessages\", \"hideOverlay\"]\n          },\n          RUNTIME_ERROR: {\n            target: \"displayRuntimeError\",\n            actions: [\"appendMessages\", \"showOverlay\"]\n          },\n          BUILD_ERROR: {\n            target: \"displayBuildError\",\n            actions: [\"setMessages\", \"showOverlay\"]\n          }\n        }\n      }\n    }\n  }, {\n    actions: {\n      dismissMessages: function dismissMessages() {\n        return {\n          messages: [],\n          level: \"error\",\n          messageSource: \"build\"\n        };\n      },\n      appendMessages: function appendMessages(context, event) {\n        return {\n          messages: context.messages.concat(event.messages),\n          level: event.level || context.level,\n          messageSource: event.type === \"RUNTIME_ERROR\" ? \"runtime\" : \"build\"\n        };\n      },\n      setMessages: function setMessages(context, event) {\n        return {\n          messages: event.messages,\n          level: event.level || context.level,\n          messageSource: event.type === \"RUNTIME_ERROR\" ? \"runtime\" : \"build\"\n        };\n      },\n      hideOverlay: hideOverlay,\n      showOverlay: showOverlay\n    }\n  });\n  return overlayMachine;\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (createOverlayMachine);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9vdmVybGF5L3N0YXRlLW1hY2hpbmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBcUM7O0FBRXJDO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCLGNBQWMscUJBQXFCO0FBQ25DLGNBQWMsa0JBQWtCLGdGQUFnRixHQUFHO0FBQ25ILGNBQWMscUJBQXFCO0FBQ25DOztBQUVBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCLGNBQWMsaUNBQWlDO0FBQy9DLGNBQWMsWUFBWTtBQUMxQjs7QUFFQTtBQUNBLFdBQVcsNkJBQTZCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1EQUFhO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxpRUFBZSxvQkFBb0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vbm9kZV9tb2R1bGVzL3dlYnBhY2stZGV2LXNlcnZlci9jbGllbnQvb3ZlcmxheS9zdGF0ZS1tYWNoaW5lLmpzP2NjNTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyZWF0ZU1hY2hpbmUgZnJvbSBcIi4vZnNtLmpzXCI7XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU2hvd092ZXJsYXlEYXRhXG4gKiBAcHJvcGVydHkgeyd3YXJuaW5nJyB8ICdlcnJvcid9IGxldmVsXG4gKiBAcHJvcGVydHkge0FycmF5PHN0cmluZyAgfCB7IG1vZHVsZUlkZW50aWZpZXI/OiBzdHJpbmcsIG1vZHVsZU5hbWU/OiBzdHJpbmcsIGxvYz86IHN0cmluZywgbWVzc2FnZT86IHN0cmluZyB9Pn0gbWVzc2FnZXNcbiAqIEBwcm9wZXJ0eSB7J2J1aWxkJyB8ICdydW50aW1lJ30gbWVzc2FnZVNvdXJjZVxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ3JlYXRlT3ZlcmxheU1hY2hpbmVPcHRpb25zXG4gKiBAcHJvcGVydHkgeyhkYXRhOiBTaG93T3ZlcmxheURhdGEpID0+IHZvaWR9IHNob3dPdmVybGF5XG4gKiBAcHJvcGVydHkgeygpID0+IHZvaWR9IGhpZGVPdmVybGF5XG4gKi9cblxuLyoqXG4gKiBAcGFyYW0ge0NyZWF0ZU92ZXJsYXlNYWNoaW5lT3B0aW9uc30gb3B0aW9uc1xuICovXG52YXIgY3JlYXRlT3ZlcmxheU1hY2hpbmUgPSBmdW5jdGlvbiBjcmVhdGVPdmVybGF5TWFjaGluZShvcHRpb25zKSB7XG4gIHZhciBoaWRlT3ZlcmxheSA9IG9wdGlvbnMuaGlkZU92ZXJsYXksXG4gICAgc2hvd092ZXJsYXkgPSBvcHRpb25zLnNob3dPdmVybGF5O1xuICB2YXIgb3ZlcmxheU1hY2hpbmUgPSBjcmVhdGVNYWNoaW5lKHtcbiAgICBpbml0aWFsOiBcImhpZGRlblwiLFxuICAgIGNvbnRleHQ6IHtcbiAgICAgIGxldmVsOiBcImVycm9yXCIsXG4gICAgICBtZXNzYWdlczogW10sXG4gICAgICBtZXNzYWdlU291cmNlOiBcImJ1aWxkXCJcbiAgICB9LFxuICAgIHN0YXRlczoge1xuICAgICAgaGlkZGVuOiB7XG4gICAgICAgIG9uOiB7XG4gICAgICAgICAgQlVJTERfRVJST1I6IHtcbiAgICAgICAgICAgIHRhcmdldDogXCJkaXNwbGF5QnVpbGRFcnJvclwiLFxuICAgICAgICAgICAgYWN0aW9uczogW1wic2V0TWVzc2FnZXNcIiwgXCJzaG93T3ZlcmxheVwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAgUlVOVElNRV9FUlJPUjoge1xuICAgICAgICAgICAgdGFyZ2V0OiBcImRpc3BsYXlSdW50aW1lRXJyb3JcIixcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcInNldE1lc3NhZ2VzXCIsIFwic2hvd092ZXJsYXlcIl1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkaXNwbGF5QnVpbGRFcnJvcjoge1xuICAgICAgICBvbjoge1xuICAgICAgICAgIERJU01JU1M6IHtcbiAgICAgICAgICAgIHRhcmdldDogXCJoaWRkZW5cIixcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImRpc21pc3NNZXNzYWdlc1wiLCBcImhpZGVPdmVybGF5XCJdXG4gICAgICAgICAgfSxcbiAgICAgICAgICBCVUlMRF9FUlJPUjoge1xuICAgICAgICAgICAgdGFyZ2V0OiBcImRpc3BsYXlCdWlsZEVycm9yXCIsXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJhcHBlbmRNZXNzYWdlc1wiLCBcInNob3dPdmVybGF5XCJdXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGlzcGxheVJ1bnRpbWVFcnJvcjoge1xuICAgICAgICBvbjoge1xuICAgICAgICAgIERJU01JU1M6IHtcbiAgICAgICAgICAgIHRhcmdldDogXCJoaWRkZW5cIixcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImRpc21pc3NNZXNzYWdlc1wiLCBcImhpZGVPdmVybGF5XCJdXG4gICAgICAgICAgfSxcbiAgICAgICAgICBSVU5USU1FX0VSUk9SOiB7XG4gICAgICAgICAgICB0YXJnZXQ6IFwiZGlzcGxheVJ1bnRpbWVFcnJvclwiLFxuICAgICAgICAgICAgYWN0aW9uczogW1wiYXBwZW5kTWVzc2FnZXNcIiwgXCJzaG93T3ZlcmxheVwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAgQlVJTERfRVJST1I6IHtcbiAgICAgICAgICAgIHRhcmdldDogXCJkaXNwbGF5QnVpbGRFcnJvclwiLFxuICAgICAgICAgICAgYWN0aW9uczogW1wic2V0TWVzc2FnZXNcIiwgXCJzaG93T3ZlcmxheVwiXVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGFjdGlvbnM6IHtcbiAgICAgIGRpc21pc3NNZXNzYWdlczogZnVuY3Rpb24gZGlzbWlzc01lc3NhZ2VzKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG1lc3NhZ2VzOiBbXSxcbiAgICAgICAgICBsZXZlbDogXCJlcnJvclwiLFxuICAgICAgICAgIG1lc3NhZ2VTb3VyY2U6IFwiYnVpbGRcIlxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIGFwcGVuZE1lc3NhZ2VzOiBmdW5jdGlvbiBhcHBlbmRNZXNzYWdlcyhjb250ZXh0LCBldmVudCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG1lc3NhZ2VzOiBjb250ZXh0Lm1lc3NhZ2VzLmNvbmNhdChldmVudC5tZXNzYWdlcyksXG4gICAgICAgICAgbGV2ZWw6IGV2ZW50LmxldmVsIHx8IGNvbnRleHQubGV2ZWwsXG4gICAgICAgICAgbWVzc2FnZVNvdXJjZTogZXZlbnQudHlwZSA9PT0gXCJSVU5USU1FX0VSUk9SXCIgPyBcInJ1bnRpbWVcIiA6IFwiYnVpbGRcIlxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHNldE1lc3NhZ2VzOiBmdW5jdGlvbiBzZXRNZXNzYWdlcyhjb250ZXh0LCBldmVudCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG1lc3NhZ2VzOiBldmVudC5tZXNzYWdlcyxcbiAgICAgICAgICBsZXZlbDogZXZlbnQubGV2ZWwgfHwgY29udGV4dC5sZXZlbCxcbiAgICAgICAgICBtZXNzYWdlU291cmNlOiBldmVudC50eXBlID09PSBcIlJVTlRJTUVfRVJST1JcIiA/IFwicnVudGltZVwiIDogXCJidWlsZFwiXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgaGlkZU92ZXJsYXk6IGhpZGVPdmVybGF5LFxuICAgICAgc2hvd092ZXJsYXk6IHNob3dPdmVybGF5XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG92ZXJsYXlNYWNoaW5lO1xufTtcbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZU92ZXJsYXlNYWNoaW5lOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/overlay/state-machine.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/overlay/styles.js":
/*!******************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/overlay/styles.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   containerStyle: () => (/* binding */ containerStyle),\n/* harmony export */   dismissButtonStyle: () => (/* binding */ dismissButtonStyle),\n/* harmony export */   headerStyle: () => (/* binding */ headerStyle),\n/* harmony export */   iframeStyle: () => (/* binding */ iframeStyle),\n/* harmony export */   msgStyles: () => (/* binding */ msgStyles),\n/* harmony export */   msgTextStyle: () => (/* binding */ msgTextStyle),\n/* harmony export */   msgTypeStyle: () => (/* binding */ msgTypeStyle)\n/* harmony export */ });\n// styles are inspired by `react-error-overlay`\n\nvar msgStyles = {\n  error: {\n    backgroundColor: \"rgba(206, 17, 38, 0.1)\",\n    color: \"#fccfcf\"\n  },\n  warning: {\n    backgroundColor: \"rgba(251, 245, 180, 0.1)\",\n    color: \"#fbf5b4\"\n  }\n};\nvar iframeStyle = {\n  position: \"fixed\",\n  top: 0,\n  left: 0,\n  right: 0,\n  bottom: 0,\n  width: \"100vw\",\n  height: \"100vh\",\n  border: \"none\",\n  \"z-index\": 9999999999\n};\nvar containerStyle = {\n  position: \"fixed\",\n  boxSizing: \"border-box\",\n  left: 0,\n  top: 0,\n  right: 0,\n  bottom: 0,\n  width: \"100vw\",\n  height: \"100vh\",\n  fontSize: \"large\",\n  padding: \"2rem 2rem 4rem 2rem\",\n  lineHeight: \"1.2\",\n  whiteSpace: \"pre-wrap\",\n  overflow: \"auto\",\n  backgroundColor: \"rgba(0, 0, 0, 0.9)\",\n  color: \"white\"\n};\nvar headerStyle = {\n  color: \"#e83b46\",\n  fontSize: \"2em\",\n  whiteSpace: \"pre-wrap\",\n  fontFamily: \"sans-serif\",\n  margin: \"0 2rem 2rem 0\",\n  flex: \"0 0 auto\",\n  maxHeight: \"50%\",\n  overflow: \"auto\"\n};\nvar dismissButtonStyle = {\n  color: \"#ffffff\",\n  lineHeight: \"1rem\",\n  fontSize: \"1.5rem\",\n  padding: \"1rem\",\n  cursor: \"pointer\",\n  position: \"absolute\",\n  right: 0,\n  top: 0,\n  backgroundColor: \"transparent\",\n  border: \"none\"\n};\nvar msgTypeStyle = {\n  color: \"#e83b46\",\n  fontSize: \"1.2em\",\n  marginBottom: \"1rem\",\n  fontFamily: \"sans-serif\"\n};\nvar msgTextStyle = {\n  lineHeight: \"1.5\",\n  fontSize: \"1rem\",\n  fontFamily: \"Menlo, Consolas, monospace\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9vdmVybGF5L3N0eWxlcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy93ZWJwYWNrLWRldi1zZXJ2ZXIvY2xpZW50L292ZXJsYXkvc3R5bGVzLmpzPzAwODIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3R5bGVzIGFyZSBpbnNwaXJlZCBieSBgcmVhY3QtZXJyb3Itb3ZlcmxheWBcblxudmFyIG1zZ1N0eWxlcyA9IHtcbiAgZXJyb3I6IHtcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgyMDYsIDE3LCAzOCwgMC4xKVwiLFxuICAgIGNvbG9yOiBcIiNmY2NmY2ZcIlxuICB9LFxuICB3YXJuaW5nOiB7XG4gICAgYmFja2dyb3VuZENvbG9yOiBcInJnYmEoMjUxLCAyNDUsIDE4MCwgMC4xKVwiLFxuICAgIGNvbG9yOiBcIiNmYmY1YjRcIlxuICB9XG59O1xudmFyIGlmcmFtZVN0eWxlID0ge1xuICBwb3NpdGlvbjogXCJmaXhlZFwiLFxuICB0b3A6IDAsXG4gIGxlZnQ6IDAsXG4gIHJpZ2h0OiAwLFxuICBib3R0b206IDAsXG4gIHdpZHRoOiBcIjEwMHZ3XCIsXG4gIGhlaWdodDogXCIxMDB2aFwiLFxuICBib3JkZXI6IFwibm9uZVwiLFxuICBcInotaW5kZXhcIjogOTk5OTk5OTk5OVxufTtcbnZhciBjb250YWluZXJTdHlsZSA9IHtcbiAgcG9zaXRpb246IFwiZml4ZWRcIixcbiAgYm94U2l6aW5nOiBcImJvcmRlci1ib3hcIixcbiAgbGVmdDogMCxcbiAgdG9wOiAwLFxuICByaWdodDogMCxcbiAgYm90dG9tOiAwLFxuICB3aWR0aDogXCIxMDB2d1wiLFxuICBoZWlnaHQ6IFwiMTAwdmhcIixcbiAgZm9udFNpemU6IFwibGFyZ2VcIixcbiAgcGFkZGluZzogXCIycmVtIDJyZW0gNHJlbSAycmVtXCIsXG4gIGxpbmVIZWlnaHQ6IFwiMS4yXCIsXG4gIHdoaXRlU3BhY2U6IFwicHJlLXdyYXBcIixcbiAgb3ZlcmZsb3c6IFwiYXV0b1wiLFxuICBiYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgwLCAwLCAwLCAwLjkpXCIsXG4gIGNvbG9yOiBcIndoaXRlXCJcbn07XG52YXIgaGVhZGVyU3R5bGUgPSB7XG4gIGNvbG9yOiBcIiNlODNiNDZcIixcbiAgZm9udFNpemU6IFwiMmVtXCIsXG4gIHdoaXRlU3BhY2U6IFwicHJlLXdyYXBcIixcbiAgZm9udEZhbWlseTogXCJzYW5zLXNlcmlmXCIsXG4gIG1hcmdpbjogXCIwIDJyZW0gMnJlbSAwXCIsXG4gIGZsZXg6IFwiMCAwIGF1dG9cIixcbiAgbWF4SGVpZ2h0OiBcIjUwJVwiLFxuICBvdmVyZmxvdzogXCJhdXRvXCJcbn07XG52YXIgZGlzbWlzc0J1dHRvblN0eWxlID0ge1xuICBjb2xvcjogXCIjZmZmZmZmXCIsXG4gIGxpbmVIZWlnaHQ6IFwiMXJlbVwiLFxuICBmb250U2l6ZTogXCIxLjVyZW1cIixcbiAgcGFkZGluZzogXCIxcmVtXCIsXG4gIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gIHJpZ2h0OiAwLFxuICB0b3A6IDAsXG4gIGJhY2tncm91bmRDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxuICBib3JkZXI6IFwibm9uZVwiXG59O1xudmFyIG1zZ1R5cGVTdHlsZSA9IHtcbiAgY29sb3I6IFwiI2U4M2I0NlwiLFxuICBmb250U2l6ZTogXCIxLjJlbVwiLFxuICBtYXJnaW5Cb3R0b206IFwiMXJlbVwiLFxuICBmb250RmFtaWx5OiBcInNhbnMtc2VyaWZcIlxufTtcbnZhciBtc2dUZXh0U3R5bGUgPSB7XG4gIGxpbmVIZWlnaHQ6IFwiMS41XCIsXG4gIGZvbnRTaXplOiBcIjFyZW1cIixcbiAgZm9udEZhbWlseTogXCJNZW5sbywgQ29uc29sYXMsIG1vbm9zcGFjZVwiXG59O1xuZXhwb3J0IHsgbXNnU3R5bGVzLCBpZnJhbWVTdHlsZSwgY29udGFpbmVyU3R5bGUsIGhlYWRlclN0eWxlLCBkaXNtaXNzQnV0dG9uU3R5bGUsIG1zZ1R5cGVTdHlsZSwgbXNnVGV4dFN0eWxlIH07Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/overlay/styles.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/socket.js":
/*!**********************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/socket.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   client: () => (/* binding */ client),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _clients_WebSocketClient_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./clients/WebSocketClient.js */ \"./node_modules/webpack-dev-server/client/clients/WebSocketClient.js\");\n/* harmony import */ var _utils_log_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/log.js */ \"./node_modules/webpack-dev-server/client/utils/log.js\");\n/* provided dependency */ var __webpack_dev_server_client__ = __webpack_require__(/*! ./node_modules/webpack-dev-server/client/clients/WebSocketClient.js */ \"./node_modules/webpack-dev-server/client/clients/WebSocketClient.js\");\n/* global __webpack_dev_server_client__ */\n\n\n\n\n// this WebsocketClient is here as a default fallback, in case the client is not injected\n/* eslint-disable camelcase */\nvar Client =\n// eslint-disable-next-line no-nested-ternary\ntypeof __webpack_dev_server_client__ !== \"undefined\" ? typeof __webpack_dev_server_client__.default !== \"undefined\" ? __webpack_dev_server_client__.default : __webpack_dev_server_client__ : _clients_WebSocketClient_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\n/* eslint-enable camelcase */\n\nvar retries = 0;\nvar maxRetries = 10;\n\n// Initialized client is exported so external consumers can utilize the same instance\n// It is mutable to enforce singleton\n// eslint-disable-next-line import/no-mutable-exports\nvar client = null;\n\n/**\n * @param {string} url\n * @param {{ [handler: string]: (data?: any, params?: any) => any }} handlers\n * @param {number} [reconnect]\n */\nvar socket = function initSocket(url, handlers, reconnect) {\n  client = new Client(url);\n  client.onOpen(function () {\n    retries = 0;\n    if (typeof reconnect !== \"undefined\") {\n      maxRetries = reconnect;\n    }\n  });\n  client.onClose(function () {\n    if (retries === 0) {\n      handlers.close();\n    }\n\n    // Try to reconnect.\n    client = null;\n\n    // After 10 retries stop trying, to prevent logspam.\n    if (retries < maxRetries) {\n      // Exponentially increase timeout to reconnect.\n      // Respectfully copied from the package `got`.\n      // eslint-disable-next-line no-restricted-properties\n      var retryInMs = 1000 * Math.pow(2, retries) + Math.random() * 100;\n      retries += 1;\n      _utils_log_js__WEBPACK_IMPORTED_MODULE_1__.log.info(\"Trying to reconnect...\");\n      setTimeout(function () {\n        socket(url, handlers, reconnect);\n      }, retryInMs);\n    }\n  });\n  client.onMessage(\n  /**\n   * @param {any} data\n   */\n  function (data) {\n    var message = JSON.parse(data);\n    if (handlers[message.type]) {\n      handlers[message.type](message.data, message.params);\n    }\n  });\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (socket);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC9zb2NrZXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7QUFFMkQ7QUFDdEI7O0FBRXJDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyw2QkFBNkIsMEJBQTBCLDZCQUE2QiwyQkFBMkIsNkJBQTZCLFdBQVcsNkJBQTZCLEdBQUcsbUVBQWU7QUFDN007O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDTzs7QUFFUDtBQUNBLFdBQVcsUUFBUTtBQUNuQixhQUFhLHdEQUF3RDtBQUNyRSxXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSw4Q0FBRztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGFBQWEsS0FBSztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxpRUFBZSxNQUFNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy93ZWJwYWNrLWRldi1zZXJ2ZXIvY2xpZW50L3NvY2tldC5qcz80N2EyIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBfX3dlYnBhY2tfZGV2X3NlcnZlcl9jbGllbnRfXyAqL1xuXG5pbXBvcnQgV2ViU29ja2V0Q2xpZW50IGZyb20gXCIuL2NsaWVudHMvV2ViU29ja2V0Q2xpZW50LmpzXCI7XG5pbXBvcnQgeyBsb2cgfSBmcm9tIFwiLi91dGlscy9sb2cuanNcIjtcblxuLy8gdGhpcyBXZWJzb2NrZXRDbGllbnQgaXMgaGVyZSBhcyBhIGRlZmF1bHQgZmFsbGJhY2ssIGluIGNhc2UgdGhlIGNsaWVudCBpcyBub3QgaW5qZWN0ZWRcbi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSAqL1xudmFyIENsaWVudCA9XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmVzdGVkLXRlcm5hcnlcbnR5cGVvZiBfX3dlYnBhY2tfZGV2X3NlcnZlcl9jbGllbnRfXyAhPT0gXCJ1bmRlZmluZWRcIiA/IHR5cGVvZiBfX3dlYnBhY2tfZGV2X3NlcnZlcl9jbGllbnRfXy5kZWZhdWx0ICE9PSBcInVuZGVmaW5lZFwiID8gX193ZWJwYWNrX2Rldl9zZXJ2ZXJfY2xpZW50X18uZGVmYXVsdCA6IF9fd2VicGFja19kZXZfc2VydmVyX2NsaWVudF9fIDogV2ViU29ja2V0Q2xpZW50O1xuLyogZXNsaW50LWVuYWJsZSBjYW1lbGNhc2UgKi9cblxudmFyIHJldHJpZXMgPSAwO1xudmFyIG1heFJldHJpZXMgPSAxMDtcblxuLy8gSW5pdGlhbGl6ZWQgY2xpZW50IGlzIGV4cG9ydGVkIHNvIGV4dGVybmFsIGNvbnN1bWVycyBjYW4gdXRpbGl6ZSB0aGUgc2FtZSBpbnN0YW5jZVxuLy8gSXQgaXMgbXV0YWJsZSB0byBlbmZvcmNlIHNpbmdsZXRvblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1tdXRhYmxlLWV4cG9ydHNcbmV4cG9ydCB2YXIgY2xpZW50ID0gbnVsbDtcblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge3sgW2hhbmRsZXI6IHN0cmluZ106IChkYXRhPzogYW55LCBwYXJhbXM/OiBhbnkpID0+IGFueSB9fSBoYW5kbGVyc1xuICogQHBhcmFtIHtudW1iZXJ9IFtyZWNvbm5lY3RdXG4gKi9cbnZhciBzb2NrZXQgPSBmdW5jdGlvbiBpbml0U29ja2V0KHVybCwgaGFuZGxlcnMsIHJlY29ubmVjdCkge1xuICBjbGllbnQgPSBuZXcgQ2xpZW50KHVybCk7XG4gIGNsaWVudC5vbk9wZW4oZnVuY3Rpb24gKCkge1xuICAgIHJldHJpZXMgPSAwO1xuICAgIGlmICh0eXBlb2YgcmVjb25uZWN0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBtYXhSZXRyaWVzID0gcmVjb25uZWN0O1xuICAgIH1cbiAgfSk7XG4gIGNsaWVudC5vbkNsb3NlKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAocmV0cmllcyA9PT0gMCkge1xuICAgICAgaGFuZGxlcnMuY2xvc2UoKTtcbiAgICB9XG5cbiAgICAvLyBUcnkgdG8gcmVjb25uZWN0LlxuICAgIGNsaWVudCA9IG51bGw7XG5cbiAgICAvLyBBZnRlciAxMCByZXRyaWVzIHN0b3AgdHJ5aW5nLCB0byBwcmV2ZW50IGxvZ3NwYW0uXG4gICAgaWYgKHJldHJpZXMgPCBtYXhSZXRyaWVzKSB7XG4gICAgICAvLyBFeHBvbmVudGlhbGx5IGluY3JlYXNlIHRpbWVvdXQgdG8gcmVjb25uZWN0LlxuICAgICAgLy8gUmVzcGVjdGZ1bGx5IGNvcGllZCBmcm9tIHRoZSBwYWNrYWdlIGBnb3RgLlxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtcHJvcGVydGllc1xuICAgICAgdmFyIHJldHJ5SW5NcyA9IDEwMDAgKiBNYXRoLnBvdygyLCByZXRyaWVzKSArIE1hdGgucmFuZG9tKCkgKiAxMDA7XG4gICAgICByZXRyaWVzICs9IDE7XG4gICAgICBsb2cuaW5mbyhcIlRyeWluZyB0byByZWNvbm5lY3QuLi5cIik7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc29ja2V0KHVybCwgaGFuZGxlcnMsIHJlY29ubmVjdCk7XG4gICAgICB9LCByZXRyeUluTXMpO1xuICAgIH1cbiAgfSk7XG4gIGNsaWVudC5vbk1lc3NhZ2UoXG4gIC8qKlxuICAgKiBAcGFyYW0ge2FueX0gZGF0YVxuICAgKi9cbiAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICB2YXIgbWVzc2FnZSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgaWYgKGhhbmRsZXJzW21lc3NhZ2UudHlwZV0pIHtcbiAgICAgIGhhbmRsZXJzW21lc3NhZ2UudHlwZV0obWVzc2FnZS5kYXRhLCBtZXNzYWdlLnBhcmFtcyk7XG4gICAgfVxuICB9KTtcbn07XG5leHBvcnQgZGVmYXVsdCBzb2NrZXQ7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/socket.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/utils/createSocketURL.js":
/*!*************************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/utils/createSocketURL.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/**\n * @param {{ protocol?: string, auth?: string, hostname?: string, port?: string, pathname?: string, search?: string, hash?: string, slashes?: boolean }} objURL\n * @returns {string}\n */\nfunction format(objURL) {\n  var protocol = objURL.protocol || \"\";\n  if (protocol && protocol.substr(-1) !== \":\") {\n    protocol += \":\";\n  }\n  var auth = objURL.auth || \"\";\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, \":\");\n    auth += \"@\";\n  }\n  var host = \"\";\n  if (objURL.hostname) {\n    host = auth + (objURL.hostname.indexOf(\":\") === -1 ? objURL.hostname : \"[\".concat(objURL.hostname, \"]\"));\n    if (objURL.port) {\n      host += \":\".concat(objURL.port);\n    }\n  }\n  var pathname = objURL.pathname || \"\";\n  if (objURL.slashes) {\n    host = \"//\".concat(host || \"\");\n    if (pathname && pathname.charAt(0) !== \"/\") {\n      pathname = \"/\".concat(pathname);\n    }\n  } else if (!host) {\n    host = \"\";\n  }\n  var search = objURL.search || \"\";\n  if (search && search.charAt(0) !== \"?\") {\n    search = \"?\".concat(search);\n  }\n  var hash = objURL.hash || \"\";\n  if (hash && hash.charAt(0) !== \"#\") {\n    hash = \"#\".concat(hash);\n  }\n  pathname = pathname.replace(/[?#]/g,\n  /**\n   * @param {string} match\n   * @returns {string}\n   */\n  function (match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace(\"#\", \"%23\");\n  return \"\".concat(protocol).concat(host).concat(pathname).concat(search).concat(hash);\n}\n\n/**\n * @param {URL & { fromCurrentScript?: boolean }} parsedURL\n * @returns {string}\n */\nfunction createSocketURL(parsedURL) {\n  var hostname = parsedURL.hostname;\n\n  // Node.js module parses it as `::`\n  // `new URL(urlString, [baseURLString])` parses it as '[::]'\n  var isInAddrAny = hostname === \"0.0.0.0\" || hostname === \"::\" || hostname === \"[::]\";\n\n  // why do we need this check?\n  // hostname n/a for file protocol (example, when using electron, ionic)\n  // see: https://github.com/webpack/webpack-dev-server/pull/384\n  if (isInAddrAny && self.location.hostname && self.location.protocol.indexOf(\"http\") === 0) {\n    hostname = self.location.hostname;\n  }\n  var socketURLProtocol = parsedURL.protocol || self.location.protocol;\n\n  // When https is used in the app, secure web sockets are always necessary because the browser doesn't accept non-secure web sockets.\n  if (socketURLProtocol === \"auto:\" || hostname && isInAddrAny && self.location.protocol === \"https:\") {\n    socketURLProtocol = self.location.protocol;\n  }\n  socketURLProtocol = socketURLProtocol.replace(/^(?:http|.+-extension|file)/i, \"ws\");\n  var socketURLAuth = \"\";\n\n  // `new URL(urlString, [baseURLstring])` doesn't have `auth` property\n  // Parse authentication credentials in case we need them\n  if (parsedURL.username) {\n    socketURLAuth = parsedURL.username;\n\n    // Since HTTP basic authentication does not allow empty username,\n    // we only include password if the username is not empty.\n    if (parsedURL.password) {\n      // Result: <username>:<password>\n      socketURLAuth = socketURLAuth.concat(\":\", parsedURL.password);\n    }\n  }\n\n  // In case the host is a raw IPv6 address, it can be enclosed in\n  // the brackets as the brackets are needed in the final URL string.\n  // Need to remove those as url.format blindly adds its own set of brackets\n  // if the host string contains colons. That would lead to non-working\n  // double brackets (e.g. [[::]]) host\n  //\n  // All of these web socket url params are optionally passed in through resourceQuery,\n  // so we need to fall back to the default if they are not provided\n  var socketURLHostname = (hostname || self.location.hostname || \"localhost\").replace(/^\\[(.*)\\]$/, \"$1\");\n  var socketURLPort = parsedURL.port;\n  if (!socketURLPort || socketURLPort === \"0\") {\n    socketURLPort = self.location.port;\n  }\n\n  // If path is provided it'll be passed in via the resourceQuery as a\n  // query param so it has to be parsed out of the querystring in order for the\n  // client to open the socket to the correct location.\n  var socketURLPathname = \"/ws\";\n  if (parsedURL.pathname && !parsedURL.fromCurrentScript) {\n    socketURLPathname = parsedURL.pathname;\n  }\n  return format({\n    protocol: socketURLProtocol,\n    auth: socketURLAuth,\n    hostname: socketURLHostname,\n    port: socketURLPort,\n    pathname: socketURLPathname,\n    slashes: true\n  });\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (createSocketURL);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9jcmVhdGVTb2NrZXRVUkwuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0EsYUFBYSw0SUFBNEk7QUFDekosYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsUUFBUTtBQUNyQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFdBQVcsUUFBUSwrQkFBK0I7QUFDbEQsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxpRUFBZSxlQUFlIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy93ZWJwYWNrLWRldi1zZXJ2ZXIvY2xpZW50L3V0aWxzL2NyZWF0ZVNvY2tldFVSTC5qcz8yYzBlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQHBhcmFtIHt7IHByb3RvY29sPzogc3RyaW5nLCBhdXRoPzogc3RyaW5nLCBob3N0bmFtZT86IHN0cmluZywgcG9ydD86IHN0cmluZywgcGF0aG5hbWU/OiBzdHJpbmcsIHNlYXJjaD86IHN0cmluZywgaGFzaD86IHN0cmluZywgc2xhc2hlcz86IGJvb2xlYW4gfX0gb2JqVVJMXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBmb3JtYXQob2JqVVJMKSB7XG4gIHZhciBwcm90b2NvbCA9IG9ialVSTC5wcm90b2NvbCB8fCBcIlwiO1xuICBpZiAocHJvdG9jb2wgJiYgcHJvdG9jb2wuc3Vic3RyKC0xKSAhPT0gXCI6XCIpIHtcbiAgICBwcm90b2NvbCArPSBcIjpcIjtcbiAgfVxuICB2YXIgYXV0aCA9IG9ialVSTC5hdXRoIHx8IFwiXCI7XG4gIGlmIChhdXRoKSB7XG4gICAgYXV0aCA9IGVuY29kZVVSSUNvbXBvbmVudChhdXRoKTtcbiAgICBhdXRoID0gYXV0aC5yZXBsYWNlKC8lM0EvaSwgXCI6XCIpO1xuICAgIGF1dGggKz0gXCJAXCI7XG4gIH1cbiAgdmFyIGhvc3QgPSBcIlwiO1xuICBpZiAob2JqVVJMLmhvc3RuYW1lKSB7XG4gICAgaG9zdCA9IGF1dGggKyAob2JqVVJMLmhvc3RuYW1lLmluZGV4T2YoXCI6XCIpID09PSAtMSA/IG9ialVSTC5ob3N0bmFtZSA6IFwiW1wiLmNvbmNhdChvYmpVUkwuaG9zdG5hbWUsIFwiXVwiKSk7XG4gICAgaWYgKG9ialVSTC5wb3J0KSB7XG4gICAgICBob3N0ICs9IFwiOlwiLmNvbmNhdChvYmpVUkwucG9ydCk7XG4gICAgfVxuICB9XG4gIHZhciBwYXRobmFtZSA9IG9ialVSTC5wYXRobmFtZSB8fCBcIlwiO1xuICBpZiAob2JqVVJMLnNsYXNoZXMpIHtcbiAgICBob3N0ID0gXCIvL1wiLmNvbmNhdChob3N0IHx8IFwiXCIpO1xuICAgIGlmIChwYXRobmFtZSAmJiBwYXRobmFtZS5jaGFyQXQoMCkgIT09IFwiL1wiKSB7XG4gICAgICBwYXRobmFtZSA9IFwiL1wiLmNvbmNhdChwYXRobmFtZSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKCFob3N0KSB7XG4gICAgaG9zdCA9IFwiXCI7XG4gIH1cbiAgdmFyIHNlYXJjaCA9IG9ialVSTC5zZWFyY2ggfHwgXCJcIjtcbiAgaWYgKHNlYXJjaCAmJiBzZWFyY2guY2hhckF0KDApICE9PSBcIj9cIikge1xuICAgIHNlYXJjaCA9IFwiP1wiLmNvbmNhdChzZWFyY2gpO1xuICB9XG4gIHZhciBoYXNoID0gb2JqVVJMLmhhc2ggfHwgXCJcIjtcbiAgaWYgKGhhc2ggJiYgaGFzaC5jaGFyQXQoMCkgIT09IFwiI1wiKSB7XG4gICAgaGFzaCA9IFwiI1wiLmNvbmNhdChoYXNoKTtcbiAgfVxuICBwYXRobmFtZSA9IHBhdGhuYW1lLnJlcGxhY2UoL1s/I10vZyxcbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtYXRjaFxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKi9cbiAgZnVuY3Rpb24gKG1hdGNoKSB7XG4gICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChtYXRjaCk7XG4gIH0pO1xuICBzZWFyY2ggPSBzZWFyY2gucmVwbGFjZShcIiNcIiwgXCIlMjNcIik7XG4gIHJldHVybiBcIlwiLmNvbmNhdChwcm90b2NvbCkuY29uY2F0KGhvc3QpLmNvbmNhdChwYXRobmFtZSkuY29uY2F0KHNlYXJjaCkuY29uY2F0KGhhc2gpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7VVJMICYgeyBmcm9tQ3VycmVudFNjcmlwdD86IGJvb2xlYW4gfX0gcGFyc2VkVVJMXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBjcmVhdGVTb2NrZXRVUkwocGFyc2VkVVJMKSB7XG4gIHZhciBob3N0bmFtZSA9IHBhcnNlZFVSTC5ob3N0bmFtZTtcblxuICAvLyBOb2RlLmpzIG1vZHVsZSBwYXJzZXMgaXQgYXMgYDo6YFxuICAvLyBgbmV3IFVSTCh1cmxTdHJpbmcsIFtiYXNlVVJMU3RyaW5nXSlgIHBhcnNlcyBpdCBhcyAnWzo6XSdcbiAgdmFyIGlzSW5BZGRyQW55ID0gaG9zdG5hbWUgPT09IFwiMC4wLjAuMFwiIHx8IGhvc3RuYW1lID09PSBcIjo6XCIgfHwgaG9zdG5hbWUgPT09IFwiWzo6XVwiO1xuXG4gIC8vIHdoeSBkbyB3ZSBuZWVkIHRoaXMgY2hlY2s/XG4gIC8vIGhvc3RuYW1lIG4vYSBmb3IgZmlsZSBwcm90b2NvbCAoZXhhbXBsZSwgd2hlbiB1c2luZyBlbGVjdHJvbiwgaW9uaWMpXG4gIC8vIHNlZTogaHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2svd2VicGFjay1kZXYtc2VydmVyL3B1bGwvMzg0XG4gIGlmIChpc0luQWRkckFueSAmJiBzZWxmLmxvY2F0aW9uLmhvc3RuYW1lICYmIHNlbGYubG9jYXRpb24ucHJvdG9jb2wuaW5kZXhPZihcImh0dHBcIikgPT09IDApIHtcbiAgICBob3N0bmFtZSA9IHNlbGYubG9jYXRpb24uaG9zdG5hbWU7XG4gIH1cbiAgdmFyIHNvY2tldFVSTFByb3RvY29sID0gcGFyc2VkVVJMLnByb3RvY29sIHx8IHNlbGYubG9jYXRpb24ucHJvdG9jb2w7XG5cbiAgLy8gV2hlbiBodHRwcyBpcyB1c2VkIGluIHRoZSBhcHAsIHNlY3VyZSB3ZWIgc29ja2V0cyBhcmUgYWx3YXlzIG5lY2Vzc2FyeSBiZWNhdXNlIHRoZSBicm93c2VyIGRvZXNuJ3QgYWNjZXB0IG5vbi1zZWN1cmUgd2ViIHNvY2tldHMuXG4gIGlmIChzb2NrZXRVUkxQcm90b2NvbCA9PT0gXCJhdXRvOlwiIHx8IGhvc3RuYW1lICYmIGlzSW5BZGRyQW55ICYmIHNlbGYubG9jYXRpb24ucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIpIHtcbiAgICBzb2NrZXRVUkxQcm90b2NvbCA9IHNlbGYubG9jYXRpb24ucHJvdG9jb2w7XG4gIH1cbiAgc29ja2V0VVJMUHJvdG9jb2wgPSBzb2NrZXRVUkxQcm90b2NvbC5yZXBsYWNlKC9eKD86aHR0cHwuKy1leHRlbnNpb258ZmlsZSkvaSwgXCJ3c1wiKTtcbiAgdmFyIHNvY2tldFVSTEF1dGggPSBcIlwiO1xuXG4gIC8vIGBuZXcgVVJMKHVybFN0cmluZywgW2Jhc2VVUkxzdHJpbmddKWAgZG9lc24ndCBoYXZlIGBhdXRoYCBwcm9wZXJ0eVxuICAvLyBQYXJzZSBhdXRoZW50aWNhdGlvbiBjcmVkZW50aWFscyBpbiBjYXNlIHdlIG5lZWQgdGhlbVxuICBpZiAocGFyc2VkVVJMLnVzZXJuYW1lKSB7XG4gICAgc29ja2V0VVJMQXV0aCA9IHBhcnNlZFVSTC51c2VybmFtZTtcblxuICAgIC8vIFNpbmNlIEhUVFAgYmFzaWMgYXV0aGVudGljYXRpb24gZG9lcyBub3QgYWxsb3cgZW1wdHkgdXNlcm5hbWUsXG4gICAgLy8gd2Ugb25seSBpbmNsdWRlIHBhc3N3b3JkIGlmIHRoZSB1c2VybmFtZSBpcyBub3QgZW1wdHkuXG4gICAgaWYgKHBhcnNlZFVSTC5wYXNzd29yZCkge1xuICAgICAgLy8gUmVzdWx0OiA8dXNlcm5hbWU+OjxwYXNzd29yZD5cbiAgICAgIHNvY2tldFVSTEF1dGggPSBzb2NrZXRVUkxBdXRoLmNvbmNhdChcIjpcIiwgcGFyc2VkVVJMLnBhc3N3b3JkKTtcbiAgICB9XG4gIH1cblxuICAvLyBJbiBjYXNlIHRoZSBob3N0IGlzIGEgcmF3IElQdjYgYWRkcmVzcywgaXQgY2FuIGJlIGVuY2xvc2VkIGluXG4gIC8vIHRoZSBicmFja2V0cyBhcyB0aGUgYnJhY2tldHMgYXJlIG5lZWRlZCBpbiB0aGUgZmluYWwgVVJMIHN0cmluZy5cbiAgLy8gTmVlZCB0byByZW1vdmUgdGhvc2UgYXMgdXJsLmZvcm1hdCBibGluZGx5IGFkZHMgaXRzIG93biBzZXQgb2YgYnJhY2tldHNcbiAgLy8gaWYgdGhlIGhvc3Qgc3RyaW5nIGNvbnRhaW5zIGNvbG9ucy4gVGhhdCB3b3VsZCBsZWFkIHRvIG5vbi13b3JraW5nXG4gIC8vIGRvdWJsZSBicmFja2V0cyAoZS5nLiBbWzo6XV0pIGhvc3RcbiAgLy9cbiAgLy8gQWxsIG9mIHRoZXNlIHdlYiBzb2NrZXQgdXJsIHBhcmFtcyBhcmUgb3B0aW9uYWxseSBwYXNzZWQgaW4gdGhyb3VnaCByZXNvdXJjZVF1ZXJ5LFxuICAvLyBzbyB3ZSBuZWVkIHRvIGZhbGwgYmFjayB0byB0aGUgZGVmYXVsdCBpZiB0aGV5IGFyZSBub3QgcHJvdmlkZWRcbiAgdmFyIHNvY2tldFVSTEhvc3RuYW1lID0gKGhvc3RuYW1lIHx8IHNlbGYubG9jYXRpb24uaG9zdG5hbWUgfHwgXCJsb2NhbGhvc3RcIikucmVwbGFjZSgvXlxcWyguKilcXF0kLywgXCIkMVwiKTtcbiAgdmFyIHNvY2tldFVSTFBvcnQgPSBwYXJzZWRVUkwucG9ydDtcbiAgaWYgKCFzb2NrZXRVUkxQb3J0IHx8IHNvY2tldFVSTFBvcnQgPT09IFwiMFwiKSB7XG4gICAgc29ja2V0VVJMUG9ydCA9IHNlbGYubG9jYXRpb24ucG9ydDtcbiAgfVxuXG4gIC8vIElmIHBhdGggaXMgcHJvdmlkZWQgaXQnbGwgYmUgcGFzc2VkIGluIHZpYSB0aGUgcmVzb3VyY2VRdWVyeSBhcyBhXG4gIC8vIHF1ZXJ5IHBhcmFtIHNvIGl0IGhhcyB0byBiZSBwYXJzZWQgb3V0IG9mIHRoZSBxdWVyeXN0cmluZyBpbiBvcmRlciBmb3IgdGhlXG4gIC8vIGNsaWVudCB0byBvcGVuIHRoZSBzb2NrZXQgdG8gdGhlIGNvcnJlY3QgbG9jYXRpb24uXG4gIHZhciBzb2NrZXRVUkxQYXRobmFtZSA9IFwiL3dzXCI7XG4gIGlmIChwYXJzZWRVUkwucGF0aG5hbWUgJiYgIXBhcnNlZFVSTC5mcm9tQ3VycmVudFNjcmlwdCkge1xuICAgIHNvY2tldFVSTFBhdGhuYW1lID0gcGFyc2VkVVJMLnBhdGhuYW1lO1xuICB9XG4gIHJldHVybiBmb3JtYXQoe1xuICAgIHByb3RvY29sOiBzb2NrZXRVUkxQcm90b2NvbCxcbiAgICBhdXRoOiBzb2NrZXRVUkxBdXRoLFxuICAgIGhvc3RuYW1lOiBzb2NrZXRVUkxIb3N0bmFtZSxcbiAgICBwb3J0OiBzb2NrZXRVUkxQb3J0LFxuICAgIHBhdGhuYW1lOiBzb2NrZXRVUkxQYXRobmFtZSxcbiAgICBzbGFzaGVzOiB0cnVlXG4gIH0pO1xufVxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlU29ja2V0VVJMOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/utils/createSocketURL.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/utils/getCurrentScriptSource.js":
/*!********************************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/utils/getCurrentScriptSource.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/**\n * @returns {string}\n */\nfunction getCurrentScriptSource() {\n  // `document.currentScript` is the most accurate way to find the current script,\n  // but is not supported in all browsers.\n  if (document.currentScript) {\n    return document.currentScript.getAttribute(\"src\");\n  }\n\n  // Fallback to getting all scripts running in the document.\n  var scriptElements = document.scripts || [];\n  var scriptElementsWithSrc = Array.prototype.filter.call(scriptElements, function (element) {\n    return element.getAttribute(\"src\");\n  });\n  if (scriptElementsWithSrc.length > 0) {\n    var currentScript = scriptElementsWithSrc[scriptElementsWithSrc.length - 1];\n    return currentScript.getAttribute(\"src\");\n  }\n\n  // Fail as there was no script to use.\n  throw new Error(\"[webpack-dev-server] Failed to get current script source.\");\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (getCurrentScriptSource);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9nZXRDdXJyZW50U2NyaXB0U291cmNlLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpRUFBZSxzQkFBc0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vbm9kZV9tb2R1bGVzL3dlYnBhY2stZGV2LXNlcnZlci9jbGllbnQvdXRpbHMvZ2V0Q3VycmVudFNjcmlwdFNvdXJjZS5qcz85ZTBjIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQHJldHVybnMge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZ2V0Q3VycmVudFNjcmlwdFNvdXJjZSgpIHtcbiAgLy8gYGRvY3VtZW50LmN1cnJlbnRTY3JpcHRgIGlzIHRoZSBtb3N0IGFjY3VyYXRlIHdheSB0byBmaW5kIHRoZSBjdXJyZW50IHNjcmlwdCxcbiAgLy8gYnV0IGlzIG5vdCBzdXBwb3J0ZWQgaW4gYWxsIGJyb3dzZXJzLlxuICBpZiAoZG9jdW1lbnQuY3VycmVudFNjcmlwdCkge1xuICAgIHJldHVybiBkb2N1bWVudC5jdXJyZW50U2NyaXB0LmdldEF0dHJpYnV0ZShcInNyY1wiKTtcbiAgfVxuXG4gIC8vIEZhbGxiYWNrIHRvIGdldHRpbmcgYWxsIHNjcmlwdHMgcnVubmluZyBpbiB0aGUgZG9jdW1lbnQuXG4gIHZhciBzY3JpcHRFbGVtZW50cyA9IGRvY3VtZW50LnNjcmlwdHMgfHwgW107XG4gIHZhciBzY3JpcHRFbGVtZW50c1dpdGhTcmMgPSBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwoc2NyaXB0RWxlbWVudHMsIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwic3JjXCIpO1xuICB9KTtcbiAgaWYgKHNjcmlwdEVsZW1lbnRzV2l0aFNyYy5sZW5ndGggPiAwKSB7XG4gICAgdmFyIGN1cnJlbnRTY3JpcHQgPSBzY3JpcHRFbGVtZW50c1dpdGhTcmNbc2NyaXB0RWxlbWVudHNXaXRoU3JjLmxlbmd0aCAtIDFdO1xuICAgIHJldHVybiBjdXJyZW50U2NyaXB0LmdldEF0dHJpYnV0ZShcInNyY1wiKTtcbiAgfVxuXG4gIC8vIEZhaWwgYXMgdGhlcmUgd2FzIG5vIHNjcmlwdCB0byB1c2UuXG4gIHRocm93IG5ldyBFcnJvcihcIlt3ZWJwYWNrLWRldi1zZXJ2ZXJdIEZhaWxlZCB0byBnZXQgY3VycmVudCBzY3JpcHQgc291cmNlLlwiKTtcbn1cbmV4cG9ydCBkZWZhdWx0IGdldEN1cnJlbnRTY3JpcHRTb3VyY2U7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/utils/getCurrentScriptSource.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/utils/log.js":
/*!*************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/utils/log.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   log: () => (/* binding */ log),\n/* harmony export */   logEnabledFeatures: () => (/* binding */ logEnabledFeatures),\n/* harmony export */   setLogLevel: () => (/* binding */ setLogLevel)\n/* harmony export */ });\n/* harmony import */ var _modules_logger_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../modules/logger/index.js */ \"./node_modules/webpack-dev-server/client/modules/logger/index.js\");\n/* harmony import */ var _modules_logger_index_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_modules_logger_index_js__WEBPACK_IMPORTED_MODULE_0__);\n\nvar name = \"webpack-dev-server\";\n// default level is set on the client side, so it does not need\n// to be set by the CLI or API\nvar defaultLevel = \"info\";\n\n// options new options, merge with old options\n/**\n * @param {false | true | \"none\" | \"error\" | \"warn\" | \"info\" | \"log\" | \"verbose\"} level\n * @returns {void}\n */\nfunction setLogLevel(level) {\n  _modules_logger_index_js__WEBPACK_IMPORTED_MODULE_0___default().configureDefaultLogger({\n    level: level\n  });\n}\nsetLogLevel(defaultLevel);\nvar log = _modules_logger_index_js__WEBPACK_IMPORTED_MODULE_0___default().getLogger(name);\nvar logEnabledFeatures = function logEnabledFeatures(features) {\n  var enabledFeatures = Object.keys(features);\n  if (!features || enabledFeatures.length === 0) {\n    return;\n  }\n  var logString = \"Server started:\";\n\n  // Server started: Hot Module Replacement enabled, Live Reloading enabled, Overlay disabled.\n  for (var i = 0; i < enabledFeatures.length; i++) {\n    var key = enabledFeatures[i];\n    logString += \" \".concat(key, \" \").concat(features[key] ? \"enabled\" : \"disabled\", \",\");\n  }\n  // replace last comma with a period\n  logString = logString.slice(0, -1).concat(\".\");\n  log.info(logString);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9sb2cuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBZ0Q7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVcsdUVBQXVFO0FBQ2xGLGFBQWE7QUFDYjtBQUNBO0FBQ0EsRUFBRSxzRkFBNkI7QUFDL0I7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFVBQVUseUVBQWdCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGtCQUFrQiw0QkFBNEI7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vbm9kZV9tb2R1bGVzL3dlYnBhY2stZGV2LXNlcnZlci9jbGllbnQvdXRpbHMvbG9nLmpzPzAzODUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGxvZ2dlciBmcm9tIFwiLi4vbW9kdWxlcy9sb2dnZXIvaW5kZXguanNcIjtcbnZhciBuYW1lID0gXCJ3ZWJwYWNrLWRldi1zZXJ2ZXJcIjtcbi8vIGRlZmF1bHQgbGV2ZWwgaXMgc2V0IG9uIHRoZSBjbGllbnQgc2lkZSwgc28gaXQgZG9lcyBub3QgbmVlZFxuLy8gdG8gYmUgc2V0IGJ5IHRoZSBDTEkgb3IgQVBJXG52YXIgZGVmYXVsdExldmVsID0gXCJpbmZvXCI7XG5cbi8vIG9wdGlvbnMgbmV3IG9wdGlvbnMsIG1lcmdlIHdpdGggb2xkIG9wdGlvbnNcbi8qKlxuICogQHBhcmFtIHtmYWxzZSB8IHRydWUgfCBcIm5vbmVcIiB8IFwiZXJyb3JcIiB8IFwid2FyblwiIHwgXCJpbmZvXCIgfCBcImxvZ1wiIHwgXCJ2ZXJib3NlXCJ9IGxldmVsXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuZnVuY3Rpb24gc2V0TG9nTGV2ZWwobGV2ZWwpIHtcbiAgbG9nZ2VyLmNvbmZpZ3VyZURlZmF1bHRMb2dnZXIoe1xuICAgIGxldmVsOiBsZXZlbFxuICB9KTtcbn1cbnNldExvZ0xldmVsKGRlZmF1bHRMZXZlbCk7XG52YXIgbG9nID0gbG9nZ2VyLmdldExvZ2dlcihuYW1lKTtcbnZhciBsb2dFbmFibGVkRmVhdHVyZXMgPSBmdW5jdGlvbiBsb2dFbmFibGVkRmVhdHVyZXMoZmVhdHVyZXMpIHtcbiAgdmFyIGVuYWJsZWRGZWF0dXJlcyA9IE9iamVjdC5rZXlzKGZlYXR1cmVzKTtcbiAgaWYgKCFmZWF0dXJlcyB8fCBlbmFibGVkRmVhdHVyZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBsb2dTdHJpbmcgPSBcIlNlcnZlciBzdGFydGVkOlwiO1xuXG4gIC8vIFNlcnZlciBzdGFydGVkOiBIb3QgTW9kdWxlIFJlcGxhY2VtZW50IGVuYWJsZWQsIExpdmUgUmVsb2FkaW5nIGVuYWJsZWQsIE92ZXJsYXkgZGlzYWJsZWQuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZW5hYmxlZEZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGtleSA9IGVuYWJsZWRGZWF0dXJlc1tpXTtcbiAgICBsb2dTdHJpbmcgKz0gXCIgXCIuY29uY2F0KGtleSwgXCIgXCIpLmNvbmNhdChmZWF0dXJlc1trZXldID8gXCJlbmFibGVkXCIgOiBcImRpc2FibGVkXCIsIFwiLFwiKTtcbiAgfVxuICAvLyByZXBsYWNlIGxhc3QgY29tbWEgd2l0aCBhIHBlcmlvZFxuICBsb2dTdHJpbmcgPSBsb2dTdHJpbmcuc2xpY2UoMCwgLTEpLmNvbmNhdChcIi5cIik7XG4gIGxvZy5pbmZvKGxvZ1N0cmluZyk7XG59O1xuZXhwb3J0IHsgbG9nLCBsb2dFbmFibGVkRmVhdHVyZXMsIHNldExvZ0xldmVsIH07Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/utils/log.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/utils/parseURL.js":
/*!******************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/utils/parseURL.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _getCurrentScriptSource_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getCurrentScriptSource.js */ \"./node_modules/webpack-dev-server/client/utils/getCurrentScriptSource.js\");\n\n\n/**\n * @param {string} resourceQuery\n * @returns {{ [key: string]: string | boolean }}\n */\nfunction parseURL(resourceQuery) {\n  /** @type {{ [key: string]: string }} */\n  var options = {};\n  if (typeof resourceQuery === \"string\" && resourceQuery !== \"\") {\n    var searchParams = resourceQuery.slice(1).split(\"&\");\n    for (var i = 0; i < searchParams.length; i++) {\n      var pair = searchParams[i].split(\"=\");\n      options[pair[0]] = decodeURIComponent(pair[1]);\n    }\n  } else {\n    // Else, get the url from the <script> this file was called with.\n    var scriptSource = (0,_getCurrentScriptSource_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])();\n    var scriptSourceURL;\n    try {\n      // The placeholder `baseURL` with `window.location.href`,\n      // is to allow parsing of path-relative or protocol-relative URLs,\n      // and will have no effect if `scriptSource` is a fully valid URL.\n      scriptSourceURL = new URL(scriptSource, self.location.href);\n    } catch (error) {\n      // URL parsing failed, do nothing.\n      // We will still proceed to see if we can recover using `resourceQuery`\n    }\n    if (scriptSourceURL) {\n      options = scriptSourceURL;\n      options.fromCurrentScript = true;\n    }\n  }\n  return options;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (parseURL);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9wYXJzZVVSTC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFpRTs7QUFFakU7QUFDQSxXQUFXLFFBQVE7QUFDbkIsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlLHlCQUF5QjtBQUN4QztBQUNBO0FBQ0E7QUFDQSxvQkFBb0IseUJBQXlCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLHVCQUF1QixzRUFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWUsUUFBUSIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9wYXJzZVVSTC5qcz83ZGEyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBnZXRDdXJyZW50U2NyaXB0U291cmNlIGZyb20gXCIuL2dldEN1cnJlbnRTY3JpcHRTb3VyY2UuanNcIjtcblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVzb3VyY2VRdWVyeVxuICogQHJldHVybnMge3sgW2tleTogc3RyaW5nXTogc3RyaW5nIHwgYm9vbGVhbiB9fVxuICovXG5mdW5jdGlvbiBwYXJzZVVSTChyZXNvdXJjZVF1ZXJ5KSB7XG4gIC8qKiBAdHlwZSB7eyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfX0gKi9cbiAgdmFyIG9wdGlvbnMgPSB7fTtcbiAgaWYgKHR5cGVvZiByZXNvdXJjZVF1ZXJ5ID09PSBcInN0cmluZ1wiICYmIHJlc291cmNlUXVlcnkgIT09IFwiXCIpIHtcbiAgICB2YXIgc2VhcmNoUGFyYW1zID0gcmVzb3VyY2VRdWVyeS5zbGljZSgxKS5zcGxpdChcIiZcIik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWFyY2hQYXJhbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBwYWlyID0gc2VhcmNoUGFyYW1zW2ldLnNwbGl0KFwiPVwiKTtcbiAgICAgIG9wdGlvbnNbcGFpclswXV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIEVsc2UsIGdldCB0aGUgdXJsIGZyb20gdGhlIDxzY3JpcHQ+IHRoaXMgZmlsZSB3YXMgY2FsbGVkIHdpdGguXG4gICAgdmFyIHNjcmlwdFNvdXJjZSA9IGdldEN1cnJlbnRTY3JpcHRTb3VyY2UoKTtcbiAgICB2YXIgc2NyaXB0U291cmNlVVJMO1xuICAgIHRyeSB7XG4gICAgICAvLyBUaGUgcGxhY2Vob2xkZXIgYGJhc2VVUkxgIHdpdGggYHdpbmRvdy5sb2NhdGlvbi5ocmVmYCxcbiAgICAgIC8vIGlzIHRvIGFsbG93IHBhcnNpbmcgb2YgcGF0aC1yZWxhdGl2ZSBvciBwcm90b2NvbC1yZWxhdGl2ZSBVUkxzLFxuICAgICAgLy8gYW5kIHdpbGwgaGF2ZSBubyBlZmZlY3QgaWYgYHNjcmlwdFNvdXJjZWAgaXMgYSBmdWxseSB2YWxpZCBVUkwuXG4gICAgICBzY3JpcHRTb3VyY2VVUkwgPSBuZXcgVVJMKHNjcmlwdFNvdXJjZSwgc2VsZi5sb2NhdGlvbi5ocmVmKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gVVJMIHBhcnNpbmcgZmFpbGVkLCBkbyBub3RoaW5nLlxuICAgICAgLy8gV2Ugd2lsbCBzdGlsbCBwcm9jZWVkIHRvIHNlZSBpZiB3ZSBjYW4gcmVjb3ZlciB1c2luZyBgcmVzb3VyY2VRdWVyeWBcbiAgICB9XG4gICAgaWYgKHNjcmlwdFNvdXJjZVVSTCkge1xuICAgICAgb3B0aW9ucyA9IHNjcmlwdFNvdXJjZVVSTDtcbiAgICAgIG9wdGlvbnMuZnJvbUN1cnJlbnRTY3JpcHQgPSB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb3B0aW9ucztcbn1cbmV4cG9ydCBkZWZhdWx0IHBhcnNlVVJMOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/utils/parseURL.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/utils/reloadApp.js":
/*!*******************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/utils/reloadApp.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var webpack_hot_emitter_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! webpack/hot/emitter.js */ \"./node_modules/webpack/hot/emitter.js\");\n/* harmony import */ var webpack_hot_emitter_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(webpack_hot_emitter_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _log_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./log.js */ \"./node_modules/webpack-dev-server/client/utils/log.js\");\n\n\n\n/** @typedef {import(\"../index\").Options} Options\n/** @typedef {import(\"../index\").Status} Status\n\n/**\n * @param {Options} options\n * @param {Status} status\n */\nfunction reloadApp(_ref, status) {\n  var hot = _ref.hot,\n    liveReload = _ref.liveReload;\n  if (status.isUnloading) {\n    return;\n  }\n  var currentHash = status.currentHash,\n    previousHash = status.previousHash;\n  var isInitial = currentHash.indexOf( /** @type {string} */previousHash) >= 0;\n  if (isInitial) {\n    return;\n  }\n\n  /**\n   * @param {Window} rootWindow\n   * @param {number} intervalId\n   */\n  function applyReload(rootWindow, intervalId) {\n    clearInterval(intervalId);\n    _log_js__WEBPACK_IMPORTED_MODULE_1__.log.info(\"App updated. Reloading...\");\n    rootWindow.location.reload();\n  }\n  var search = self.location.search.toLowerCase();\n  var allowToHot = search.indexOf(\"webpack-dev-server-hot=false\") === -1;\n  var allowToLiveReload = search.indexOf(\"webpack-dev-server-live-reload=false\") === -1;\n  if (hot && allowToHot) {\n    _log_js__WEBPACK_IMPORTED_MODULE_1__.log.info(\"App hot update...\");\n    webpack_hot_emitter_js__WEBPACK_IMPORTED_MODULE_0___default().emit(\"webpackHotUpdate\", status.currentHash);\n    if (typeof self !== \"undefined\" && self.window) {\n      // broadcast update to window\n      self.postMessage(\"webpackHotUpdate\".concat(status.currentHash), \"*\");\n    }\n  }\n  // allow refreshing the page only if liveReload isn't disabled\n  else if (liveReload && allowToLiveReload) {\n    var rootWindow = self;\n\n    // use parent window for reload (in case we're in an iframe with no valid src)\n    var intervalId = self.setInterval(function () {\n      if (rootWindow.location.protocol !== \"about:\") {\n        // reload immediately if protocol is valid\n        applyReload(rootWindow, intervalId);\n      } else {\n        rootWindow = rootWindow.parent;\n        if (rootWindow.parent === rootWindow) {\n          // if parent equals current window we've reached the root which would continue forever, so trigger a reload anyways\n          applyReload(rootWindow, intervalId);\n        }\n      }\n    });\n  }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (reloadApp);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9yZWxvYWRBcHAuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFnRDtBQUNqQjs7QUFFL0IsY0FBYyw0QkFBNEI7QUFDMUMsY0FBYywyQkFBMkI7O0FBRXpDO0FBQ0EsV0FBVyxTQUFTO0FBQ3BCLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsUUFBUTtBQUMxRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLFFBQVE7QUFDckIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLElBQUksd0NBQUc7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLHdDQUFHO0FBQ1AsSUFBSSxrRUFBZTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxpRUFBZSxTQUFTIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy93ZWJwYWNrLWRldi1zZXJ2ZXIvY2xpZW50L3V0aWxzL3JlbG9hZEFwcC5qcz8xNTY5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBob3RFbWl0dGVyIGZyb20gXCJ3ZWJwYWNrL2hvdC9lbWl0dGVyLmpzXCI7XG5pbXBvcnQgeyBsb2cgfSBmcm9tIFwiLi9sb2cuanNcIjtcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoXCIuLi9pbmRleFwiKS5PcHRpb25zfSBPcHRpb25zXG4vKiogQHR5cGVkZWYge2ltcG9ydChcIi4uL2luZGV4XCIpLlN0YXR1c30gU3RhdHVzXG5cbi8qKlxuICogQHBhcmFtIHtPcHRpb25zfSBvcHRpb25zXG4gKiBAcGFyYW0ge1N0YXR1c30gc3RhdHVzXG4gKi9cbmZ1bmN0aW9uIHJlbG9hZEFwcChfcmVmLCBzdGF0dXMpIHtcbiAgdmFyIGhvdCA9IF9yZWYuaG90LFxuICAgIGxpdmVSZWxvYWQgPSBfcmVmLmxpdmVSZWxvYWQ7XG4gIGlmIChzdGF0dXMuaXNVbmxvYWRpbmcpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGN1cnJlbnRIYXNoID0gc3RhdHVzLmN1cnJlbnRIYXNoLFxuICAgIHByZXZpb3VzSGFzaCA9IHN0YXR1cy5wcmV2aW91c0hhc2g7XG4gIHZhciBpc0luaXRpYWwgPSBjdXJyZW50SGFzaC5pbmRleE9mKCAvKiogQHR5cGUge3N0cmluZ30gKi9wcmV2aW91c0hhc2gpID49IDA7XG4gIGlmIChpc0luaXRpYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtXaW5kb3d9IHJvb3RXaW5kb3dcbiAgICogQHBhcmFtIHtudW1iZXJ9IGludGVydmFsSWRcbiAgICovXG4gIGZ1bmN0aW9uIGFwcGx5UmVsb2FkKHJvb3RXaW5kb3csIGludGVydmFsSWQpIHtcbiAgICBjbGVhckludGVydmFsKGludGVydmFsSWQpO1xuICAgIGxvZy5pbmZvKFwiQXBwIHVwZGF0ZWQuIFJlbG9hZGluZy4uLlwiKTtcbiAgICByb290V2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICB9XG4gIHZhciBzZWFyY2ggPSBzZWxmLmxvY2F0aW9uLnNlYXJjaC50b0xvd2VyQ2FzZSgpO1xuICB2YXIgYWxsb3dUb0hvdCA9IHNlYXJjaC5pbmRleE9mKFwid2VicGFjay1kZXYtc2VydmVyLWhvdD1mYWxzZVwiKSA9PT0gLTE7XG4gIHZhciBhbGxvd1RvTGl2ZVJlbG9hZCA9IHNlYXJjaC5pbmRleE9mKFwid2VicGFjay1kZXYtc2VydmVyLWxpdmUtcmVsb2FkPWZhbHNlXCIpID09PSAtMTtcbiAgaWYgKGhvdCAmJiBhbGxvd1RvSG90KSB7XG4gICAgbG9nLmluZm8oXCJBcHAgaG90IHVwZGF0ZS4uLlwiKTtcbiAgICBob3RFbWl0dGVyLmVtaXQoXCJ3ZWJwYWNrSG90VXBkYXRlXCIsIHN0YXR1cy5jdXJyZW50SGFzaCk7XG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYud2luZG93KSB7XG4gICAgICAvLyBicm9hZGNhc3QgdXBkYXRlIHRvIHdpbmRvd1xuICAgICAgc2VsZi5wb3N0TWVzc2FnZShcIndlYnBhY2tIb3RVcGRhdGVcIi5jb25jYXQoc3RhdHVzLmN1cnJlbnRIYXNoKSwgXCIqXCIpO1xuICAgIH1cbiAgfVxuICAvLyBhbGxvdyByZWZyZXNoaW5nIHRoZSBwYWdlIG9ubHkgaWYgbGl2ZVJlbG9hZCBpc24ndCBkaXNhYmxlZFxuICBlbHNlIGlmIChsaXZlUmVsb2FkICYmIGFsbG93VG9MaXZlUmVsb2FkKSB7XG4gICAgdmFyIHJvb3RXaW5kb3cgPSBzZWxmO1xuXG4gICAgLy8gdXNlIHBhcmVudCB3aW5kb3cgZm9yIHJlbG9hZCAoaW4gY2FzZSB3ZSdyZSBpbiBhbiBpZnJhbWUgd2l0aCBubyB2YWxpZCBzcmMpXG4gICAgdmFyIGludGVydmFsSWQgPSBzZWxmLnNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChyb290V2luZG93LmxvY2F0aW9uLnByb3RvY29sICE9PSBcImFib3V0OlwiKSB7XG4gICAgICAgIC8vIHJlbG9hZCBpbW1lZGlhdGVseSBpZiBwcm90b2NvbCBpcyB2YWxpZFxuICAgICAgICBhcHBseVJlbG9hZChyb290V2luZG93LCBpbnRlcnZhbElkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJvb3RXaW5kb3cgPSByb290V2luZG93LnBhcmVudDtcbiAgICAgICAgaWYgKHJvb3RXaW5kb3cucGFyZW50ID09PSByb290V2luZG93KSB7XG4gICAgICAgICAgLy8gaWYgcGFyZW50IGVxdWFscyBjdXJyZW50IHdpbmRvdyB3ZSd2ZSByZWFjaGVkIHRoZSByb290IHdoaWNoIHdvdWxkIGNvbnRpbnVlIGZvcmV2ZXIsIHNvIHRyaWdnZXIgYSByZWxvYWQgYW55d2F5c1xuICAgICAgICAgIGFwcGx5UmVsb2FkKHJvb3RXaW5kb3csIGludGVydmFsSWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IHJlbG9hZEFwcDsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/utils/reloadApp.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/utils/sendMessage.js":
/*!*********************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/utils/sendMessage.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* global __resourceQuery WorkerGlobalScope */\n\n// Send messages to the outside, so plugins can consume it.\n/**\n * @param {string} type\n * @param {any} [data]\n */\nfunction sendMsg(type, data) {\n  if (typeof self !== \"undefined\" && (typeof WorkerGlobalScope === \"undefined\" || !(self instanceof WorkerGlobalScope))) {\n    self.postMessage({\n      type: \"webpack\".concat(type),\n      data: data\n    }, \"*\");\n  }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (sendMsg);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9zZW5kTWVzc2FnZS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7O0FBRUE7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLEtBQUs7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxpRUFBZSxPQUFPIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVqYS1xdWV1ZS8uL25vZGVfbW9kdWxlcy93ZWJwYWNrLWRldi1zZXJ2ZXIvY2xpZW50L3V0aWxzL3NlbmRNZXNzYWdlLmpzP2E1ZTciXSwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIF9fcmVzb3VyY2VRdWVyeSBXb3JrZXJHbG9iYWxTY29wZSAqL1xuXG4vLyBTZW5kIG1lc3NhZ2VzIHRvIHRoZSBvdXRzaWRlLCBzbyBwbHVnaW5zIGNhbiBjb25zdW1lIGl0LlxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICogQHBhcmFtIHthbnl9IFtkYXRhXVxuICovXG5mdW5jdGlvbiBzZW5kTXNnKHR5cGUsIGRhdGEpIHtcbiAgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmICh0eXBlb2YgV29ya2VyR2xvYmFsU2NvcGUgPT09IFwidW5kZWZpbmVkXCIgfHwgIShzZWxmIGluc3RhbmNlb2YgV29ya2VyR2xvYmFsU2NvcGUpKSkge1xuICAgIHNlbGYucG9zdE1lc3NhZ2Uoe1xuICAgICAgdHlwZTogXCJ3ZWJwYWNrXCIuY29uY2F0KHR5cGUpLFxuICAgICAgZGF0YTogZGF0YVxuICAgIH0sIFwiKlwiKTtcbiAgfVxufVxuZXhwb3J0IGRlZmF1bHQgc2VuZE1zZzsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/utils/sendMessage.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack-dev-server/client/utils/stripAnsi.js":
/*!*******************************************************************!*\
  !*** ./node_modules/webpack-dev-server/client/utils/stripAnsi.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nvar ansiRegex = new RegExp([\"[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)\", \"(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-nq-uy=><~]))\"].join(\"|\"), \"g\");\n\n/**\n *\n * Strip [ANSI escape codes](https://en.wikipedia.org/wiki/ANSI_escape_code) from a string.\n * Adapted from code originally released by Sindre Sorhus\n * Licensed the MIT License\n *\n * @param {string} string\n * @return {string}\n */\nfunction stripAnsi(string) {\n  if (typeof string !== \"string\") {\n    throw new TypeError(\"Expected a `string`, got `\".concat(typeof string, \"`\"));\n  }\n  return string.replace(ansiRegex, \"\");\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (stripAnsi);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9zdHJpcEFuc2kuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLHNEQUFzRCxnQkFBZ0IsNkNBQTZDLG9EQUFvRCxJQUFJLElBQUksSUFBSSxJQUFJOztBQUV2TDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWUsU0FBUyIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvd2VicGFjay1kZXYtc2VydmVyL2NsaWVudC91dGlscy9zdHJpcEFuc2kuanM/NzBhYSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYW5zaVJlZ2V4ID0gbmV3IFJlZ0V4cChbXCJbXFxcXHUwMDFCXFxcXHUwMDlCXVtbXFxcXF0oKSM7P10qKD86KD86KD86KD86O1stYS16QS1aXFxcXGRcXFxcLyMmLjo9PyVAfl9dKykqfFthLXpBLVpcXFxcZF0rKD86O1stYS16QS1aXFxcXGRcXFxcLyMmLjo9PyVAfl9dKikqKT9cXFxcdTAwMDcpXCIsIFwiKD86KD86XFxcXGR7MSw0fSg/OjtcXFxcZHswLDR9KSopP1tcXFxcZEEtUFItVFpjZi1ucS11eT0+PH5dKSlcIl0uam9pbihcInxcIiksIFwiZ1wiKTtcblxuLyoqXG4gKlxuICogU3RyaXAgW0FOU0kgZXNjYXBlIGNvZGVzXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9BTlNJX2VzY2FwZV9jb2RlKSBmcm9tIGEgc3RyaW5nLlxuICogQWRhcHRlZCBmcm9tIGNvZGUgb3JpZ2luYWxseSByZWxlYXNlZCBieSBTaW5kcmUgU29yaHVzXG4gKiBMaWNlbnNlZCB0aGUgTUlUIExpY2Vuc2VcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHN0cmlwQW5zaShzdHJpbmcpIHtcbiAgaWYgKHR5cGVvZiBzdHJpbmcgIT09IFwic3RyaW5nXCIpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgYSBgc3RyaW5nYCwgZ290IGBcIi5jb25jYXQodHlwZW9mIHN0cmluZywgXCJgXCIpKTtcbiAgfVxuICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoYW5zaVJlZ2V4LCBcIlwiKTtcbn1cbmV4cG9ydCBkZWZhdWx0IHN0cmlwQW5zaTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack-dev-server/client/utils/stripAnsi.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack/hot/dev-server.js":
/*!************************************************!*\
  !*** ./node_modules/webpack/hot/dev-server.js ***!
  \************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("{/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n/* globals __webpack_hash__ */\nif (true) {\n\t/** @type {undefined|string} */\n\tvar lastHash;\n\tvar upToDate = function upToDate() {\n\t\treturn /** @type {string} */ (lastHash).indexOf(__webpack_require__.h()) >= 0;\n\t};\n\tvar log = __webpack_require__(/*! ./log */ \"./node_modules/webpack/hot/log.js\");\n\tvar check = function check() {\n\t\tmodule.hot\n\t\t\t.check(true)\n\t\t\t.then(function (updatedModules) {\n\t\t\t\tif (!updatedModules) {\n\t\t\t\t\tlog(\n\t\t\t\t\t\t\"warning\",\n\t\t\t\t\t\t\"[HMR] Cannot find update. \" +\n\t\t\t\t\t\t\t(typeof window !== \"undefined\"\n\t\t\t\t\t\t\t\t? \"Need to do a full reload!\"\n\t\t\t\t\t\t\t\t: \"Please reload manually!\")\n\t\t\t\t\t);\n\t\t\t\t\tlog(\n\t\t\t\t\t\t\"warning\",\n\t\t\t\t\t\t\"[HMR] (Probably because of restarting the webpack-dev-server)\"\n\t\t\t\t\t);\n\t\t\t\t\tif (typeof window !== \"undefined\") {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!upToDate()) {\n\t\t\t\t\tcheck();\n\t\t\t\t}\n\n\t\t\t\t__webpack_require__(/*! ./log-apply-result */ \"./node_modules/webpack/hot/log-apply-result.js\")(updatedModules, updatedModules);\n\n\t\t\t\tif (upToDate()) {\n\t\t\t\t\tlog(\"info\", \"[HMR] App is up to date.\");\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(function (err) {\n\t\t\t\tvar status = module.hot.status();\n\t\t\t\tif ([\"abort\", \"fail\"].indexOf(status) >= 0) {\n\t\t\t\t\tlog(\n\t\t\t\t\t\t\"warning\",\n\t\t\t\t\t\t\"[HMR] Cannot apply update. \" +\n\t\t\t\t\t\t\t(typeof window !== \"undefined\"\n\t\t\t\t\t\t\t\t? \"Need to do a full reload!\"\n\t\t\t\t\t\t\t\t: \"Please reload manually!\")\n\t\t\t\t\t);\n\t\t\t\t\tlog(\"warning\", \"[HMR] \" + log.formatError(err));\n\t\t\t\t\tif (typeof window !== \"undefined\") {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlog(\"warning\", \"[HMR] Update failed: \" + log.formatError(err));\n\t\t\t\t}\n\t\t\t});\n\t};\n\tvar hotEmitter = __webpack_require__(/*! ./emitter */ \"./node_modules/webpack/hot/emitter.js\");\n\thotEmitter.on(\"webpackHotUpdate\", function (currentHash) {\n\t\tlastHash = currentHash;\n\t\tif (!upToDate() && module.hot.status() === \"idle\") {\n\t\t\tlog(\"info\", \"[HMR] Checking for updates on the server...\");\n\t\t\tcheck();\n\t\t}\n\t});\n\tlog(\"info\", \"[HMR] Waiting for update signal from WDS...\");\n} else // removed by dead control flow\n{}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9ob3QvZGV2LXNlcnZlci5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxJQUFVO0FBQ2QsWUFBWSxrQkFBa0I7QUFDOUI7QUFDQTtBQUNBLG9CQUFvQixRQUFRLHNCQUFzQix1QkFBZ0I7QUFDbEU7QUFDQSxXQUFXLG1CQUFPLENBQUMsZ0RBQU87QUFDMUI7QUFDQSxFQUFFLFVBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsSUFBSSxtQkFBTyxDQUFDLDBFQUFvQjs7QUFFaEM7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsaUJBQWlCLFVBQVU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxrQkFBa0IsbUJBQU8sQ0FBQyx3REFBVztBQUNyQztBQUNBO0FBQ0EscUJBQXFCLFVBQVU7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0EsRUFBRSxLQUFLO0FBQUEsRUFFTiIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvd2VicGFjay9ob3QvZGV2LXNlcnZlci5qcz9lN2EzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG4vKiBnbG9iYWxzIF9fd2VicGFja19oYXNoX18gKi9cbmlmIChtb2R1bGUuaG90KSB7XG5cdC8qKiBAdHlwZSB7dW5kZWZpbmVkfHN0cmluZ30gKi9cblx0dmFyIGxhc3RIYXNoO1xuXHR2YXIgdXBUb0RhdGUgPSBmdW5jdGlvbiB1cFRvRGF0ZSgpIHtcblx0XHRyZXR1cm4gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChsYXN0SGFzaCkuaW5kZXhPZihfX3dlYnBhY2tfaGFzaF9fKSA+PSAwO1xuXHR9O1xuXHR2YXIgbG9nID0gcmVxdWlyZShcIi4vbG9nXCIpO1xuXHR2YXIgY2hlY2sgPSBmdW5jdGlvbiBjaGVjaygpIHtcblx0XHRtb2R1bGUuaG90XG5cdFx0XHQuY2hlY2sodHJ1ZSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uICh1cGRhdGVkTW9kdWxlcykge1xuXHRcdFx0XHRpZiAoIXVwZGF0ZWRNb2R1bGVzKSB7XG5cdFx0XHRcdFx0bG9nKFxuXHRcdFx0XHRcdFx0XCJ3YXJuaW5nXCIsXG5cdFx0XHRcdFx0XHRcIltITVJdIENhbm5vdCBmaW5kIHVwZGF0ZS4gXCIgK1xuXHRcdFx0XHRcdFx0XHQodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIlxuXHRcdFx0XHRcdFx0XHRcdD8gXCJOZWVkIHRvIGRvIGEgZnVsbCByZWxvYWQhXCJcblx0XHRcdFx0XHRcdFx0XHQ6IFwiUGxlYXNlIHJlbG9hZCBtYW51YWxseSFcIilcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdGxvZyhcblx0XHRcdFx0XHRcdFwid2FybmluZ1wiLFxuXHRcdFx0XHRcdFx0XCJbSE1SXSAoUHJvYmFibHkgYmVjYXVzZSBvZiByZXN0YXJ0aW5nIHRoZSB3ZWJwYWNrLWRldi1zZXJ2ZXIpXCJcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdFx0XHR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICghdXBUb0RhdGUoKSkge1xuXHRcdFx0XHRcdGNoZWNrKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXF1aXJlKFwiLi9sb2ctYXBwbHktcmVzdWx0XCIpKHVwZGF0ZWRNb2R1bGVzLCB1cGRhdGVkTW9kdWxlcyk7XG5cblx0XHRcdFx0aWYgKHVwVG9EYXRlKCkpIHtcblx0XHRcdFx0XHRsb2coXCJpbmZvXCIsIFwiW0hNUl0gQXBwIGlzIHVwIHRvIGRhdGUuXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdFx0LmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0dmFyIHN0YXR1cyA9IG1vZHVsZS5ob3Quc3RhdHVzKCk7XG5cdFx0XHRcdGlmIChbXCJhYm9ydFwiLCBcImZhaWxcIl0uaW5kZXhPZihzdGF0dXMpID49IDApIHtcblx0XHRcdFx0XHRsb2coXG5cdFx0XHRcdFx0XHRcIndhcm5pbmdcIixcblx0XHRcdFx0XHRcdFwiW0hNUl0gQ2Fubm90IGFwcGx5IHVwZGF0ZS4gXCIgK1xuXHRcdFx0XHRcdFx0XHQodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIlxuXHRcdFx0XHRcdFx0XHRcdD8gXCJOZWVkIHRvIGRvIGEgZnVsbCByZWxvYWQhXCJcblx0XHRcdFx0XHRcdFx0XHQ6IFwiUGxlYXNlIHJlbG9hZCBtYW51YWxseSFcIilcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdGxvZyhcIndhcm5pbmdcIiwgXCJbSE1SXSBcIiArIGxvZy5mb3JtYXRFcnJvcihlcnIpKTtcblx0XHRcdFx0XHRpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRsb2coXCJ3YXJuaW5nXCIsIFwiW0hNUl0gVXBkYXRlIGZhaWxlZDogXCIgKyBsb2cuZm9ybWF0RXJyb3IoZXJyKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHR9O1xuXHR2YXIgaG90RW1pdHRlciA9IHJlcXVpcmUoXCIuL2VtaXR0ZXJcIik7XG5cdGhvdEVtaXR0ZXIub24oXCJ3ZWJwYWNrSG90VXBkYXRlXCIsIGZ1bmN0aW9uIChjdXJyZW50SGFzaCkge1xuXHRcdGxhc3RIYXNoID0gY3VycmVudEhhc2g7XG5cdFx0aWYgKCF1cFRvRGF0ZSgpICYmIG1vZHVsZS5ob3Quc3RhdHVzKCkgPT09IFwiaWRsZVwiKSB7XG5cdFx0XHRsb2coXCJpbmZvXCIsIFwiW0hNUl0gQ2hlY2tpbmcgZm9yIHVwZGF0ZXMgb24gdGhlIHNlcnZlci4uLlwiKTtcblx0XHRcdGNoZWNrKCk7XG5cdFx0fVxuXHR9KTtcblx0bG9nKFwiaW5mb1wiLCBcIltITVJdIFdhaXRpbmcgZm9yIHVwZGF0ZSBzaWduYWwgZnJvbSBXRFMuLi5cIik7XG59IGVsc2Uge1xuXHR0aHJvdyBuZXcgRXJyb3IoXCJbSE1SXSBIb3QgTW9kdWxlIFJlcGxhY2VtZW50IGlzIGRpc2FibGVkLlwiKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/webpack/hot/dev-server.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack/hot/emitter.js":
/*!*********************************************!*\
  !*** ./node_modules/webpack/hot/emitter.js ***!
  \*********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("{var EventEmitter = __webpack_require__(/*! events */ \"./node_modules/events/events.js\");\nmodule.exports = new EventEmitter();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9ob3QvZW1pdHRlci5qcyIsIm1hcHBpbmdzIjoiQUFBQSxtQkFBbUIsbUJBQU8sQ0FBQywrQ0FBUTtBQUNuQyIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvd2VicGFjay9ob3QvZW1pdHRlci5qcz85M2UyIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBFdmVudEVtaXR0ZXIgPSByZXF1aXJlKFwiZXZlbnRzXCIpO1xubW9kdWxlLmV4cG9ydHMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack/hot/emitter.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack/hot/log-apply-result.js":
/*!******************************************************!*\
  !*** ./node_modules/webpack/hot/log-apply-result.js ***!
  \******************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("{/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n/**\n * @param {(string | number)[]} updatedModules updated modules\n * @param {(string | number)[] | null} renewedModules renewed modules\n */\nmodule.exports = function (updatedModules, renewedModules) {\n\tvar unacceptedModules = updatedModules.filter(function (moduleId) {\n\t\treturn renewedModules && renewedModules.indexOf(moduleId) < 0;\n\t});\n\tvar log = __webpack_require__(/*! ./log */ \"./node_modules/webpack/hot/log.js\");\n\n\tif (unacceptedModules.length > 0) {\n\t\tlog(\n\t\t\t\"warning\",\n\t\t\t\"[HMR] The following modules couldn't be hot updated: (They would need a full reload!)\"\n\t\t);\n\t\tunacceptedModules.forEach(function (moduleId) {\n\t\t\tlog(\"warning\", \"[HMR]  - \" + moduleId);\n\t\t});\n\t}\n\n\tif (!renewedModules || renewedModules.length === 0) {\n\t\tlog(\"info\", \"[HMR] Nothing hot updated.\");\n\t} else {\n\t\tlog(\"info\", \"[HMR] Updated modules:\");\n\t\trenewedModules.forEach(function (moduleId) {\n\t\t\tif (typeof moduleId === \"string\" && moduleId.indexOf(\"!\") !== -1) {\n\t\t\t\tvar parts = moduleId.split(\"!\");\n\t\t\t\tlog.groupCollapsed(\"info\", \"[HMR]  - \" + parts.pop());\n\t\t\t\tlog(\"info\", \"[HMR]  - \" + moduleId);\n\t\t\t\tlog.groupEnd(\"info\");\n\t\t\t} else {\n\t\t\t\tlog(\"info\", \"[HMR]  - \" + moduleId);\n\t\t\t}\n\t\t});\n\t\tvar numberIds = renewedModules.every(function (moduleId) {\n\t\t\treturn typeof moduleId === \"number\";\n\t\t});\n\t\tif (numberIds)\n\t\t\tlog(\n\t\t\t\t\"info\",\n\t\t\t\t'[HMR] Consider using the optimization.moduleIds: \"named\" for module names.'\n\t\t\t);\n\t}\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9ob3QvbG9nLWFwcGx5LXJlc3VsdC5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFdBQVcscUJBQXFCO0FBQ2hDLFdBQVcsNEJBQTRCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGLFdBQVcsbUJBQU8sQ0FBQyxnREFBTzs7QUFFMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vbm9kZV9tb2R1bGVzL3dlYnBhY2svaG90L2xvZy1hcHBseS1yZXN1bHQuanM/NjlmNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuXHRBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXG4qL1xuXG4vKipcbiAqIEBwYXJhbSB7KHN0cmluZyB8IG51bWJlcilbXX0gdXBkYXRlZE1vZHVsZXMgdXBkYXRlZCBtb2R1bGVzXG4gKiBAcGFyYW0geyhzdHJpbmcgfCBudW1iZXIpW10gfCBudWxsfSByZW5ld2VkTW9kdWxlcyByZW5ld2VkIG1vZHVsZXNcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodXBkYXRlZE1vZHVsZXMsIHJlbmV3ZWRNb2R1bGVzKSB7XG5cdHZhciB1bmFjY2VwdGVkTW9kdWxlcyA9IHVwZGF0ZWRNb2R1bGVzLmZpbHRlcihmdW5jdGlvbiAobW9kdWxlSWQpIHtcblx0XHRyZXR1cm4gcmVuZXdlZE1vZHVsZXMgJiYgcmVuZXdlZE1vZHVsZXMuaW5kZXhPZihtb2R1bGVJZCkgPCAwO1xuXHR9KTtcblx0dmFyIGxvZyA9IHJlcXVpcmUoXCIuL2xvZ1wiKTtcblxuXHRpZiAodW5hY2NlcHRlZE1vZHVsZXMubGVuZ3RoID4gMCkge1xuXHRcdGxvZyhcblx0XHRcdFwid2FybmluZ1wiLFxuXHRcdFx0XCJbSE1SXSBUaGUgZm9sbG93aW5nIG1vZHVsZXMgY291bGRuJ3QgYmUgaG90IHVwZGF0ZWQ6IChUaGV5IHdvdWxkIG5lZWQgYSBmdWxsIHJlbG9hZCEpXCJcblx0XHQpO1xuXHRcdHVuYWNjZXB0ZWRNb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZUlkKSB7XG5cdFx0XHRsb2coXCJ3YXJuaW5nXCIsIFwiW0hNUl0gIC0gXCIgKyBtb2R1bGVJZCk7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoIXJlbmV3ZWRNb2R1bGVzIHx8IHJlbmV3ZWRNb2R1bGVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdGxvZyhcImluZm9cIiwgXCJbSE1SXSBOb3RoaW5nIGhvdCB1cGRhdGVkLlwiKTtcblx0fSBlbHNlIHtcblx0XHRsb2coXCJpbmZvXCIsIFwiW0hNUl0gVXBkYXRlZCBtb2R1bGVzOlwiKTtcblx0XHRyZW5ld2VkTW9kdWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChtb2R1bGVJZCkge1xuXHRcdFx0aWYgKHR5cGVvZiBtb2R1bGVJZCA9PT0gXCJzdHJpbmdcIiAmJiBtb2R1bGVJZC5pbmRleE9mKFwiIVwiKSAhPT0gLTEpIHtcblx0XHRcdFx0dmFyIHBhcnRzID0gbW9kdWxlSWQuc3BsaXQoXCIhXCIpO1xuXHRcdFx0XHRsb2cuZ3JvdXBDb2xsYXBzZWQoXCJpbmZvXCIsIFwiW0hNUl0gIC0gXCIgKyBwYXJ0cy5wb3AoKSk7XG5cdFx0XHRcdGxvZyhcImluZm9cIiwgXCJbSE1SXSAgLSBcIiArIG1vZHVsZUlkKTtcblx0XHRcdFx0bG9nLmdyb3VwRW5kKFwiaW5mb1wiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGxvZyhcImluZm9cIiwgXCJbSE1SXSAgLSBcIiArIG1vZHVsZUlkKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHR2YXIgbnVtYmVySWRzID0gcmVuZXdlZE1vZHVsZXMuZXZlcnkoZnVuY3Rpb24gKG1vZHVsZUlkKSB7XG5cdFx0XHRyZXR1cm4gdHlwZW9mIG1vZHVsZUlkID09PSBcIm51bWJlclwiO1xuXHRcdH0pO1xuXHRcdGlmIChudW1iZXJJZHMpXG5cdFx0XHRsb2coXG5cdFx0XHRcdFwiaW5mb1wiLFxuXHRcdFx0XHQnW0hNUl0gQ29uc2lkZXIgdXNpbmcgdGhlIG9wdGltaXphdGlvbi5tb2R1bGVJZHM6IFwibmFtZWRcIiBmb3IgbW9kdWxlIG5hbWVzLidcblx0XHRcdCk7XG5cdH1cbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack/hot/log-apply-result.js\n\n}");

/***/ }),

/***/ "./node_modules/webpack/hot/log.js":
/*!*****************************************!*\
  !*** ./node_modules/webpack/hot/log.js ***!
  \*****************************************/
/***/ ((module) => {

eval("{/** @typedef {\"info\" | \"warning\" | \"error\"} LogLevel */\n\n/** @type {LogLevel} */\nvar logLevel = \"info\";\n\nfunction dummy() {}\n\n/**\n * @param {LogLevel} level log level\n * @returns {boolean} true, if should log\n */\nfunction shouldLog(level) {\n\tvar shouldLog =\n\t\t(logLevel === \"info\" && level === \"info\") ||\n\t\t([\"info\", \"warning\"].indexOf(logLevel) >= 0 && level === \"warning\") ||\n\t\t([\"info\", \"warning\", \"error\"].indexOf(logLevel) >= 0 && level === \"error\");\n\treturn shouldLog;\n}\n\n/**\n * @param {(msg?: string) => void} logFn log function\n * @returns {(level: LogLevel, msg?: string) => void} function that logs when log level is sufficient\n */\nfunction logGroup(logFn) {\n\treturn function (level, msg) {\n\t\tif (shouldLog(level)) {\n\t\t\tlogFn(msg);\n\t\t}\n\t};\n}\n\n/**\n * @param {LogLevel} level log level\n * @param {string|Error} msg message\n */\nmodule.exports = function (level, msg) {\n\tif (shouldLog(level)) {\n\t\tif (level === \"info\") {\n\t\t\tconsole.log(msg);\n\t\t} else if (level === \"warning\") {\n\t\t\tconsole.warn(msg);\n\t\t} else if (level === \"error\") {\n\t\t\tconsole.error(msg);\n\t\t}\n\t}\n};\n\n/**\n * @param {Error} err error\n * @returns {string} formatted error\n */\nmodule.exports.formatError = function (err) {\n\tvar message = err.message;\n\tvar stack = err.stack;\n\tif (!stack) {\n\t\treturn message;\n\t} else if (stack.indexOf(message) < 0) {\n\t\treturn message + \"\\n\" + stack;\n\t}\n\treturn stack;\n};\n\nvar group = console.group || dummy;\nvar groupCollapsed = console.groupCollapsed || dummy;\nvar groupEnd = console.groupEnd || dummy;\n\nmodule.exports.group = logGroup(group);\n\nmodule.exports.groupCollapsed = logGroup(groupCollapsed);\n\nmodule.exports.groupEnd = logGroup(groupEnd);\n\n/**\n * @param {LogLevel} level log level\n */\nmodule.exports.setLogLevel = function (level) {\n\tlogLevel = level;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9ob3QvbG9nLmpzIiwibWFwcGluZ3MiOiJBQUFBLGNBQWMsOEJBQThCOztBQUU1QyxXQUFXLFVBQVU7QUFDckI7O0FBRUE7O0FBRUE7QUFDQSxXQUFXLFVBQVU7QUFDckIsYUFBYSxTQUFTO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLHdCQUF3QjtBQUNuQyxhQUFhLHlDQUF5QztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVyxVQUFVO0FBQ3JCLFdBQVcsY0FBYztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsUUFBUTtBQUNyQjtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsb0JBQW9COztBQUVwQiw2QkFBNkI7O0FBRTdCLHVCQUF1Qjs7QUFFdkI7QUFDQSxXQUFXLFVBQVU7QUFDckI7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9ub2RlX21vZHVsZXMvd2VicGFjay9ob3QvbG9nLmpzPzc1OTYiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIEB0eXBlZGVmIHtcImluZm9cIiB8IFwid2FybmluZ1wiIHwgXCJlcnJvclwifSBMb2dMZXZlbCAqL1xuXG4vKiogQHR5cGUge0xvZ0xldmVsfSAqL1xudmFyIGxvZ0xldmVsID0gXCJpbmZvXCI7XG5cbmZ1bmN0aW9uIGR1bW15KCkge31cblxuLyoqXG4gKiBAcGFyYW0ge0xvZ0xldmVsfSBsZXZlbCBsb2cgbGV2ZWxcbiAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlLCBpZiBzaG91bGQgbG9nXG4gKi9cbmZ1bmN0aW9uIHNob3VsZExvZyhsZXZlbCkge1xuXHR2YXIgc2hvdWxkTG9nID1cblx0XHQobG9nTGV2ZWwgPT09IFwiaW5mb1wiICYmIGxldmVsID09PSBcImluZm9cIikgfHxcblx0XHQoW1wiaW5mb1wiLCBcIndhcm5pbmdcIl0uaW5kZXhPZihsb2dMZXZlbCkgPj0gMCAmJiBsZXZlbCA9PT0gXCJ3YXJuaW5nXCIpIHx8XG5cdFx0KFtcImluZm9cIiwgXCJ3YXJuaW5nXCIsIFwiZXJyb3JcIl0uaW5kZXhPZihsb2dMZXZlbCkgPj0gMCAmJiBsZXZlbCA9PT0gXCJlcnJvclwiKTtcblx0cmV0dXJuIHNob3VsZExvZztcbn1cblxuLyoqXG4gKiBAcGFyYW0geyhtc2c/OiBzdHJpbmcpID0+IHZvaWR9IGxvZ0ZuIGxvZyBmdW5jdGlvblxuICogQHJldHVybnMgeyhsZXZlbDogTG9nTGV2ZWwsIG1zZz86IHN0cmluZykgPT4gdm9pZH0gZnVuY3Rpb24gdGhhdCBsb2dzIHdoZW4gbG9nIGxldmVsIGlzIHN1ZmZpY2llbnRcbiAqL1xuZnVuY3Rpb24gbG9nR3JvdXAobG9nRm4pIHtcblx0cmV0dXJuIGZ1bmN0aW9uIChsZXZlbCwgbXNnKSB7XG5cdFx0aWYgKHNob3VsZExvZyhsZXZlbCkpIHtcblx0XHRcdGxvZ0ZuKG1zZyk7XG5cdFx0fVxuXHR9O1xufVxuXG4vKipcbiAqIEBwYXJhbSB7TG9nTGV2ZWx9IGxldmVsIGxvZyBsZXZlbFxuICogQHBhcmFtIHtzdHJpbmd8RXJyb3J9IG1zZyBtZXNzYWdlXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGxldmVsLCBtc2cpIHtcblx0aWYgKHNob3VsZExvZyhsZXZlbCkpIHtcblx0XHRpZiAobGV2ZWwgPT09IFwiaW5mb1wiKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhtc2cpO1xuXHRcdH0gZWxzZSBpZiAobGV2ZWwgPT09IFwid2FybmluZ1wiKSB7XG5cdFx0XHRjb25zb2xlLndhcm4obXNnKTtcblx0XHR9IGVsc2UgaWYgKGxldmVsID09PSBcImVycm9yXCIpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IobXNnKTtcblx0XHR9XG5cdH1cbn07XG5cbi8qKlxuICogQHBhcmFtIHtFcnJvcn0gZXJyIGVycm9yXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBmb3JtYXR0ZWQgZXJyb3JcbiAqL1xubW9kdWxlLmV4cG9ydHMuZm9ybWF0RXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG5cdHZhciBtZXNzYWdlID0gZXJyLm1lc3NhZ2U7XG5cdHZhciBzdGFjayA9IGVyci5zdGFjaztcblx0aWYgKCFzdGFjaykge1xuXHRcdHJldHVybiBtZXNzYWdlO1xuXHR9IGVsc2UgaWYgKHN0YWNrLmluZGV4T2YobWVzc2FnZSkgPCAwKSB7XG5cdFx0cmV0dXJuIG1lc3NhZ2UgKyBcIlxcblwiICsgc3RhY2s7XG5cdH1cblx0cmV0dXJuIHN0YWNrO1xufTtcblxudmFyIGdyb3VwID0gY29uc29sZS5ncm91cCB8fCBkdW1teTtcbnZhciBncm91cENvbGxhcHNlZCA9IGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQgfHwgZHVtbXk7XG52YXIgZ3JvdXBFbmQgPSBjb25zb2xlLmdyb3VwRW5kIHx8IGR1bW15O1xuXG5tb2R1bGUuZXhwb3J0cy5ncm91cCA9IGxvZ0dyb3VwKGdyb3VwKTtcblxubW9kdWxlLmV4cG9ydHMuZ3JvdXBDb2xsYXBzZWQgPSBsb2dHcm91cChncm91cENvbGxhcHNlZCk7XG5cbm1vZHVsZS5leHBvcnRzLmdyb3VwRW5kID0gbG9nR3JvdXAoZ3JvdXBFbmQpO1xuXG4vKipcbiAqIEBwYXJhbSB7TG9nTGV2ZWx9IGxldmVsIGxvZyBsZXZlbFxuICovXG5tb2R1bGUuZXhwb3J0cy5zZXRMb2dMZXZlbCA9IGZ1bmN0aW9uIChsZXZlbCkge1xuXHRsb2dMZXZlbCA9IGxldmVsO1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/webpack/hot/log.js\n\n}");

/***/ }),

/***/ "./src/db.js":
/*!*******************!*\
  !*** ./src/db.js ***!
  \*******************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VERSION: () => (/* binding */ VERSION),\n/* harmony export */   closeDB: () => (/* binding */ closeDB),\n/* harmony export */   deleteDB: () => (/* binding */ deleteDB),\n/* harmony export */   deletePlaylist: () => (/* binding */ deletePlaylist),\n/* harmony export */   getLastNLogs: () => (/* binding */ getLastNLogs),\n/* harmony export */   getPlaylist: () => (/* binding */ getPlaylist),\n/* harmony export */   getPlaylistBySourceAndForeignKey: () => (/* binding */ getPlaylistBySourceAndForeignKey),\n/* harmony export */   hasAnyVideos: () => (/* binding */ hasAnyVideos),\n/* harmony export */   loadPlaylists: () => (/* binding */ loadPlaylists),\n/* harmony export */   loadVideos: () => (/* binding */ loadVideos),\n/* harmony export */   saveLog: () => (/* binding */ saveLog),\n/* harmony export */   savePlaylists: () => (/* binding */ savePlaylists),\n/* harmony export */   saveVideos: () => (/* binding */ saveVideos),\n/* harmony export */   uuidv4: () => (/* binding */ uuidv4)\n/* harmony export */ });\n// utils/db.js\r\n\r\nlet dbPromise; // promise while opening\r\nlet dbInstance; // actual IDBDatabase\r\n\r\nlet VERSION = 4;\r\n\r\nfunction uuidv4() {\r\n  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) =>\r\n    (\r\n      c ^\r\n      (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))\r\n    ).toString(16)\r\n  );\r\n}\r\n\r\nasync function openDB() {\r\n  if (!dbPromise) {\r\n    dbPromise = new Promise((resolve, reject) => {\r\n      const request = indexedDB.open(\"YouTubeDJ\", VERSION);\r\n\r\n      request.onupgradeneeded = (event) => {\r\n        const db = event.target.result;\r\n        if (!db.objectStoreNames.contains(\"videos\")) {\r\n          const videoStore = db.createObjectStore(\"videos\", {\r\n            keyPath: \"uuid\",\r\n          });\r\n          videoStore.createIndex(\r\n            \"source_foreignKey\",\r\n            [\"source\", \"foreignKey\"],\r\n            { unique: true }\r\n          );\r\n        }\r\n        if (!db.objectStoreNames.contains(\"log\")) {\r\n          const logStore = db.createObjectStore(\"log\", { autoIncrement: true });\r\n          logStore.createIndex(\"videoUuid\", \"videoUuid\", { unique: false });\r\n        }\r\n        if (!db.objectStoreNames.contains(\"playlists\")) {\r\n          db.createObjectStore(\"playlists\", { keyPath: \"uuid\" });\r\n        }\r\n      };\r\n\r\n      request.onsuccess = () => {\r\n        dbInstance = request.result;\r\n        resolve(dbInstance);\r\n      };\r\n      request.onerror = () => reject(request.error);\r\n    });\r\n  }\r\n  return dbInstance || (await dbPromise);\r\n}\r\n\r\nasync function closeDB() {\r\n  if (dbInstance) {\r\n    dbInstance.close();\r\n    dbInstance = null;\r\n    dbPromise = null;\r\n  }\r\n}\r\n\r\nasync function saveLog(entries) {\r\n  const db = await openDB();\r\n  const entriesArray = Array.isArray(entries) ? entries : [entries];\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"log\", \"readwrite\");\r\n    const store = tx.objectStore(\"log\");\r\n    entriesArray.forEach((e) => store.add(e));\r\n    tx.oncomplete = () => resolve();\r\n    tx.onerror = () => reject(tx.error);\r\n  });\r\n}\r\n\r\nasync function getLastNLogs(n) {\r\n  return new Promise(async (resolve, reject) => {\r\n    const db = await openDB(); // your function that opens the DB\r\n    const tx = db.transaction(\"log\", \"readonly\");\r\n    const store = tx.objectStore(\"log\");\r\n\r\n    const result = [];\r\n    // Open a cursor in reverse order (largest key first)\r\n    const request = store.openCursor(null, \"prev\");\r\n\r\n    request.onsuccess = (event) => {\r\n      const cursor = event.target.result;\r\n      if (cursor && result.length < n) {\r\n        result.push(cursor.value);\r\n        cursor.continue();\r\n      } else {\r\n        resolve(result);\r\n      }\r\n    };\r\n\r\n    request.onerror = () => reject(request.error);\r\n  });\r\n}\r\n\r\nasync function saveVideos(videos) {\r\n  // console.log(`Saving ${videos.length} videos`);\r\n  const videoArray = Array.isArray(videos) ? videos : [videos];\r\n  // console.log(saving #:${videos.length R:${videos[0].rating T:${videos[0].title}}}``)\r\n  // console.trace();\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"videos\", \"readwrite\");\r\n    const store = tx.objectStore(\"videos\");\r\n    videoArray.forEach((v) => {\r\n      if (v.type && v.type !== \"video\") {\r\n        console.log(\"saveVideos: Error wrong type\", v);\r\n        alert(\r\n          \"DB integrity check fail. saveVideos: Error wrong type Check dev console.\"\r\n        );\r\n      } else {\r\n        const actual = v.ref ? v.ref : v;\r\n        store.put(actual);\r\n      }\r\n    });\r\n    tx.oncomplete = () => resolve();\r\n    tx.onerror = () => reject(tx.error);\r\n  });\r\n}\r\n\r\nasync function loadVideos() {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"videos\", \"readonly\");\r\n    const store = tx.objectStore(\"videos\");\r\n    const req = store.getAll();\r\n    req.onsuccess = () => {\r\n      let results = req.result;\r\n      resolve(results);\r\n    };\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\n\r\nasync function hasAnyVideos() {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"videos\", \"readonly\");\r\n    const store = tx.objectStore(\"videos\");\r\n    const req = store.count();\r\n    req.onsuccess = () => resolve(req.result > 0);\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\n\r\nasync function savePlaylists(playlists) {\r\n  const playlistArray = Array.isArray(playlists) ? playlists : [playlists];\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"playlists\", \"readwrite\");\r\n    const store = tx.objectStore(\"playlists\");\r\n    playlistArray.forEach((p) => {\r\n      if (p.type && p.type !== \"playlist\") {\r\n        console.log(\"saveVideos: Error wrong type\", v);\r\n        alert(\r\n          \"DB integrity check fail. saveVideos: Error wrong type. Check dev console.\"\r\n        );\r\n      } else {\r\n        const actual = p.ref ? p.ref : p;\r\n        store.put(actual);\r\n      }\r\n    });\r\n    tx.oncomplete = () => resolve();\r\n    tx.onerror = () => reject(tx.error);\r\n  });\r\n}\r\n\r\nasync function loadPlaylists() {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"playlists\", \"readonly\");\r\n    const store = tx.objectStore(\"playlists\");\r\n    const req = store.getAll();\r\n    req.onsuccess = () => resolve(req.result);\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\n\r\nasync function getPlaylist(uuid) {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"playlists\", \"readonly\");\r\n    const store = tx.objectStore(\"playlists\");\r\n    const req = store.get(uuid);\r\n    req.onsuccess = () => resolve(req.result);\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\nasync function getPlaylistBySourceAndForeignKey(source, foreignKey) {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"playlists\", \"readonly\");\r\n    const store = tx.objectStore(\"playlists\");\r\n    const req = store.getAll();\r\n\r\n    req.onsuccess = () => {\r\n      const result = req.result.find(\r\n        (p) => p.source === source && p.foreignKey === foreignKey\r\n      );\r\n      resolve(result || null);\r\n    };\r\n\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\nasync function deletePlaylist(uuid) {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(\"playlists\", \"readwrite\");\r\n    const store = tx.objectStore(\"playlists\");\r\n    const req = store.delete(uuid);\r\n    req.onsuccess = () => resolve();\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\n\r\nasync function deleteDB() {\r\n  await closeDB();\r\n  return new Promise((resolve, reject) => {\r\n    const request = indexedDB.deleteDatabase(\"YouTubeDJ\"); // replace with your DB name\r\n    request.onsuccess = () => {\r\n      console.log(\"Database deleted successfully\");\r\n      resolve();\r\n    };\r\n    request.onerror = (event) => {\r\n      console.error(\"Error deleting database:\", event.target.error);\r\n      reject(event.target.error);\r\n    };\r\n    request.onblocked = () => {\r\n      console.warn(\"Delete blocked: close all connections to the DB first\");\r\n    };\r\n  });\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLGdCQUFnQjtBQUNoQjtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EseURBQXlELHFCQUFxQjtBQUM5RSwyREFBMkQsZUFBZTtBQUMxRTtBQUNBO0FBQ0EsOENBQThDLGlCQUFpQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ087QUFDUDtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ087QUFDUCwyQkFBMkIsZUFBZTtBQUMxQztBQUNBLDRCQUE0QixrQkFBa0IscUJBQXFCLGtCQUFrQjtBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCIsInNvdXJjZXMiOlsid2VicGFjazovL2RlamEtcXVldWUvLi9zcmMvZGIuanM/Njc5MiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB1dGlscy9kYi5qc1xyXG5cclxubGV0IGRiUHJvbWlzZTsgLy8gcHJvbWlzZSB3aGlsZSBvcGVuaW5nXHJcbmxldCBkYkluc3RhbmNlOyAvLyBhY3R1YWwgSURCRGF0YWJhc2VcclxuXHJcbmV4cG9ydCBsZXQgVkVSU0lPTiA9IDQ7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXVpZHY0KCkge1xyXG4gIHJldHVybiAoWzFlN10gKyAtMWUzICsgLTRlMyArIC04ZTMgKyAtMWUxMSkucmVwbGFjZSgvWzAxOF0vZywgKGMpID0+XHJcbiAgICAoXHJcbiAgICAgIGMgXlxyXG4gICAgICAoY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxKSlbMF0gJiAoMTUgPj4gKGMgLyA0KSkpXHJcbiAgICApLnRvU3RyaW5nKDE2KVxyXG4gICk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIG9wZW5EQigpIHtcclxuICBpZiAoIWRiUHJvbWlzZSkge1xyXG4gICAgZGJQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oXCJZb3VUdWJlREpcIiwgVkVSU0lPTik7XHJcblxyXG4gICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IChldmVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICBpZiAoIWRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMoXCJ2aWRlb3NcIikpIHtcclxuICAgICAgICAgIGNvbnN0IHZpZGVvU3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZShcInZpZGVvc1wiLCB7XHJcbiAgICAgICAgICAgIGtleVBhdGg6IFwidXVpZFwiLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICB2aWRlb1N0b3JlLmNyZWF0ZUluZGV4KFxyXG4gICAgICAgICAgICBcInNvdXJjZV9mb3JlaWduS2V5XCIsXHJcbiAgICAgICAgICAgIFtcInNvdXJjZVwiLCBcImZvcmVpZ25LZXlcIl0sXHJcbiAgICAgICAgICAgIHsgdW5pcXVlOiB0cnVlIH1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhcImxvZ1wiKSkge1xyXG4gICAgICAgICAgY29uc3QgbG9nU3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZShcImxvZ1wiLCB7IGF1dG9JbmNyZW1lbnQ6IHRydWUgfSk7XHJcbiAgICAgICAgICBsb2dTdG9yZS5jcmVhdGVJbmRleChcInZpZGVvVXVpZFwiLCBcInZpZGVvVXVpZFwiLCB7IHVuaXF1ZTogZmFsc2UgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhcInBsYXlsaXN0c1wiKSkge1xyXG4gICAgICAgICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoXCJwbGF5bGlzdHNcIiwgeyBrZXlQYXRoOiBcInV1aWRcIiB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHtcclxuICAgICAgICBkYkluc3RhbmNlID0gcmVxdWVzdC5yZXN1bHQ7XHJcbiAgICAgICAgcmVzb2x2ZShkYkluc3RhbmNlKTtcclxuICAgICAgfTtcclxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gKCkgPT4gcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHJldHVybiBkYkluc3RhbmNlIHx8IChhd2FpdCBkYlByb21pc2UpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xvc2VEQigpIHtcclxuICBpZiAoZGJJbnN0YW5jZSkge1xyXG4gICAgZGJJbnN0YW5jZS5jbG9zZSgpO1xyXG4gICAgZGJJbnN0YW5jZSA9IG51bGw7XHJcbiAgICBkYlByb21pc2UgPSBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVMb2coZW50cmllcykge1xyXG4gIGNvbnN0IGRiID0gYXdhaXQgb3BlbkRCKCk7XHJcbiAgY29uc3QgZW50cmllc0FycmF5ID0gQXJyYXkuaXNBcnJheShlbnRyaWVzKSA/IGVudHJpZXMgOiBbZW50cmllc107XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oXCJsb2dcIiwgXCJyZWFkd3JpdGVcIik7XHJcbiAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFwibG9nXCIpO1xyXG4gICAgZW50cmllc0FycmF5LmZvckVhY2goKGUpID0+IHN0b3JlLmFkZChlKSk7XHJcbiAgICB0eC5vbmNvbXBsZXRlID0gKCkgPT4gcmVzb2x2ZSgpO1xyXG4gICAgdHgub25lcnJvciA9ICgpID0+IHJlamVjdCh0eC5lcnJvcik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRMYXN0TkxvZ3Mobikge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICBjb25zdCBkYiA9IGF3YWl0IG9wZW5EQigpOyAvLyB5b3VyIGZ1bmN0aW9uIHRoYXQgb3BlbnMgdGhlIERCXHJcbiAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKFwibG9nXCIsIFwicmVhZG9ubHlcIik7XHJcbiAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFwibG9nXCIpO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgLy8gT3BlbiBhIGN1cnNvciBpbiByZXZlcnNlIG9yZGVyIChsYXJnZXN0IGtleSBmaXJzdClcclxuICAgIGNvbnN0IHJlcXVlc3QgPSBzdG9yZS5vcGVuQ3Vyc29yKG51bGwsIFwicHJldlwiKTtcclxuXHJcbiAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IChldmVudCkgPT4ge1xyXG4gICAgICBjb25zdCBjdXJzb3IgPSBldmVudC50YXJnZXQucmVzdWx0O1xyXG4gICAgICBpZiAoY3Vyc29yICYmIHJlc3VsdC5sZW5ndGggPCBuKSB7XHJcbiAgICAgICAgcmVzdWx0LnB1c2goY3Vyc29yLnZhbHVlKTtcclxuICAgICAgICBjdXJzb3IuY29udGludWUoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmVxdWVzdC5vbmVycm9yID0gKCkgPT4gcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZVZpZGVvcyh2aWRlb3MpIHtcclxuICAvLyBjb25zb2xlLmxvZyhgU2F2aW5nICR7dmlkZW9zLmxlbmd0aH0gdmlkZW9zYCk7XHJcbiAgY29uc3QgdmlkZW9BcnJheSA9IEFycmF5LmlzQXJyYXkodmlkZW9zKSA/IHZpZGVvcyA6IFt2aWRlb3NdO1xyXG4gIC8vIGNvbnNvbGUubG9nKHNhdmluZyAjOiR7dmlkZW9zLmxlbmd0aCBSOiR7dmlkZW9zWzBdLnJhdGluZyBUOiR7dmlkZW9zWzBdLnRpdGxlfX19YGApXHJcbiAgLy8gY29uc29sZS50cmFjZSgpO1xyXG4gIGNvbnN0IGRiID0gYXdhaXQgb3BlbkRCKCk7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oXCJ2aWRlb3NcIiwgXCJyZWFkd3JpdGVcIik7XHJcbiAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFwidmlkZW9zXCIpO1xyXG4gICAgdmlkZW9BcnJheS5mb3JFYWNoKCh2KSA9PiB7XHJcbiAgICAgIGlmICh2LnR5cGUgJiYgdi50eXBlICE9PSBcInZpZGVvXCIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInNhdmVWaWRlb3M6IEVycm9yIHdyb25nIHR5cGVcIiwgdik7XHJcbiAgICAgICAgYWxlcnQoXHJcbiAgICAgICAgICBcIkRCIGludGVncml0eSBjaGVjayBmYWlsLiBzYXZlVmlkZW9zOiBFcnJvciB3cm9uZyB0eXBlIENoZWNrIGRldiBjb25zb2xlLlwiXHJcbiAgICAgICAgKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCBhY3R1YWwgPSB2LnJlZiA/IHYucmVmIDogdjtcclxuICAgICAgICBzdG9yZS5wdXQoYWN0dWFsKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0eC5vbmNvbXBsZXRlID0gKCkgPT4gcmVzb2x2ZSgpO1xyXG4gICAgdHgub25lcnJvciA9ICgpID0+IHJlamVjdCh0eC5lcnJvcik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkVmlkZW9zKCkge1xyXG4gIGNvbnN0IGRiID0gYXdhaXQgb3BlbkRCKCk7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oXCJ2aWRlb3NcIiwgXCJyZWFkb25seVwiKTtcclxuICAgIGNvbnN0IHN0b3JlID0gdHgub2JqZWN0U3RvcmUoXCJ2aWRlb3NcIik7XHJcbiAgICBjb25zdCByZXEgPSBzdG9yZS5nZXRBbGwoKTtcclxuICAgIHJlcS5vbnN1Y2Nlc3MgPSAoKSA9PiB7XHJcbiAgICAgIGxldCByZXN1bHRzID0gcmVxLnJlc3VsdDtcclxuICAgICAgcmVzb2x2ZShyZXN1bHRzKTtcclxuICAgIH07XHJcbiAgICByZXEub25lcnJvciA9ICgpID0+IHJlamVjdChyZXEuZXJyb3IpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzQW55VmlkZW9zKCkge1xyXG4gIGNvbnN0IGRiID0gYXdhaXQgb3BlbkRCKCk7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oXCJ2aWRlb3NcIiwgXCJyZWFkb25seVwiKTtcclxuICAgIGNvbnN0IHN0b3JlID0gdHgub2JqZWN0U3RvcmUoXCJ2aWRlb3NcIik7XHJcbiAgICBjb25zdCByZXEgPSBzdG9yZS5jb3VudCgpO1xyXG4gICAgcmVxLm9uc3VjY2VzcyA9ICgpID0+IHJlc29sdmUocmVxLnJlc3VsdCA+IDApO1xyXG4gICAgcmVxLm9uZXJyb3IgPSAoKSA9PiByZWplY3QocmVxLmVycm9yKTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVQbGF5bGlzdHMocGxheWxpc3RzKSB7XHJcbiAgY29uc3QgcGxheWxpc3RBcnJheSA9IEFycmF5LmlzQXJyYXkocGxheWxpc3RzKSA/IHBsYXlsaXN0cyA6IFtwbGF5bGlzdHNdO1xyXG4gIGNvbnN0IGRiID0gYXdhaXQgb3BlbkRCKCk7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oXCJwbGF5bGlzdHNcIiwgXCJyZWFkd3JpdGVcIik7XHJcbiAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFwicGxheWxpc3RzXCIpO1xyXG4gICAgcGxheWxpc3RBcnJheS5mb3JFYWNoKChwKSA9PiB7XHJcbiAgICAgIGlmIChwLnR5cGUgJiYgcC50eXBlICE9PSBcInBsYXlsaXN0XCIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInNhdmVWaWRlb3M6IEVycm9yIHdyb25nIHR5cGVcIiwgdik7XHJcbiAgICAgICAgYWxlcnQoXHJcbiAgICAgICAgICBcIkRCIGludGVncml0eSBjaGVjayBmYWlsLiBzYXZlVmlkZW9zOiBFcnJvciB3cm9uZyB0eXBlLiBDaGVjayBkZXYgY29uc29sZS5cIlxyXG4gICAgICAgICk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgYWN0dWFsID0gcC5yZWYgPyBwLnJlZiA6IHA7XHJcbiAgICAgICAgc3RvcmUucHV0KGFjdHVhbCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdHgub25jb21wbGV0ZSA9ICgpID0+IHJlc29sdmUoKTtcclxuICAgIHR4Lm9uZXJyb3IgPSAoKSA9PiByZWplY3QodHguZXJyb3IpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZFBsYXlsaXN0cygpIHtcclxuICBjb25zdCBkYiA9IGF3YWl0IG9wZW5EQigpO1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKFwicGxheWxpc3RzXCIsIFwicmVhZG9ubHlcIik7XHJcbiAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFwicGxheWxpc3RzXCIpO1xyXG4gICAgY29uc3QgcmVxID0gc3RvcmUuZ2V0QWxsKCk7XHJcbiAgICByZXEub25zdWNjZXNzID0gKCkgPT4gcmVzb2x2ZShyZXEucmVzdWx0KTtcclxuICAgIHJlcS5vbmVycm9yID0gKCkgPT4gcmVqZWN0KHJlcS5lcnJvcik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQbGF5bGlzdCh1dWlkKSB7XHJcbiAgY29uc3QgZGIgPSBhd2FpdCBvcGVuREIoKTtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY29uc3QgdHggPSBkYi50cmFuc2FjdGlvbihcInBsYXlsaXN0c1wiLCBcInJlYWRvbmx5XCIpO1xyXG4gICAgY29uc3Qgc3RvcmUgPSB0eC5vYmplY3RTdG9yZShcInBsYXlsaXN0c1wiKTtcclxuICAgIGNvbnN0IHJlcSA9IHN0b3JlLmdldCh1dWlkKTtcclxuICAgIHJlcS5vbnN1Y2Nlc3MgPSAoKSA9PiByZXNvbHZlKHJlcS5yZXN1bHQpO1xyXG4gICAgcmVxLm9uZXJyb3IgPSAoKSA9PiByZWplY3QocmVxLmVycm9yKTtcclxuICB9KTtcclxufVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGxheWxpc3RCeVNvdXJjZUFuZEZvcmVpZ25LZXkoc291cmNlLCBmb3JlaWduS2V5KSB7XHJcbiAgY29uc3QgZGIgPSBhd2FpdCBvcGVuREIoKTtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY29uc3QgdHggPSBkYi50cmFuc2FjdGlvbihcInBsYXlsaXN0c1wiLCBcInJlYWRvbmx5XCIpO1xyXG4gICAgY29uc3Qgc3RvcmUgPSB0eC5vYmplY3RTdG9yZShcInBsYXlsaXN0c1wiKTtcclxuICAgIGNvbnN0IHJlcSA9IHN0b3JlLmdldEFsbCgpO1xyXG5cclxuICAgIHJlcS5vbnN1Y2Nlc3MgPSAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHJlcS5yZXN1bHQuZmluZChcclxuICAgICAgICAocCkgPT4gcC5zb3VyY2UgPT09IHNvdXJjZSAmJiBwLmZvcmVpZ25LZXkgPT09IGZvcmVpZ25LZXlcclxuICAgICAgKTtcclxuICAgICAgcmVzb2x2ZShyZXN1bHQgfHwgbnVsbCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHJlcS5vbmVycm9yID0gKCkgPT4gcmVqZWN0KHJlcS5lcnJvcik7XHJcbiAgfSk7XHJcbn1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVBsYXlsaXN0KHV1aWQpIHtcclxuICBjb25zdCBkYiA9IGF3YWl0IG9wZW5EQigpO1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKFwicGxheWxpc3RzXCIsIFwicmVhZHdyaXRlXCIpO1xyXG4gICAgY29uc3Qgc3RvcmUgPSB0eC5vYmplY3RTdG9yZShcInBsYXlsaXN0c1wiKTtcclxuICAgIGNvbnN0IHJlcSA9IHN0b3JlLmRlbGV0ZSh1dWlkKTtcclxuICAgIHJlcS5vbnN1Y2Nlc3MgPSAoKSA9PiByZXNvbHZlKCk7XHJcbiAgICByZXEub25lcnJvciA9ICgpID0+IHJlamVjdChyZXEuZXJyb3IpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlREIoKSB7XHJcbiAgYXdhaXQgY2xvc2VEQigpO1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKFwiWW91VHViZURKXCIpOyAvLyByZXBsYWNlIHdpdGggeW91ciBEQiBuYW1lXHJcbiAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJEYXRhYmFzZSBkZWxldGVkIHN1Y2Nlc3NmdWxseVwiKTtcclxuICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIHJlcXVlc3Qub25lcnJvciA9IChldmVudCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgZGF0YWJhc2U6XCIsIGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgfTtcclxuICAgIHJlcXVlc3Qub25ibG9ja2VkID0gKCkgPT4ge1xyXG4gICAgICBjb25zb2xlLndhcm4oXCJEZWxldGUgYmxvY2tlZDogY2xvc2UgYWxsIGNvbm5lY3Rpb25zIHRvIHRoZSBEQiBmaXJzdFwiKTtcclxuICAgIH07XHJcbiAgfSk7XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/db.js\n\n}");

/***/ }),

/***/ "./src/options.js":
/*!************************!*\
  !*** ./src/options.js ***!
  \************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _db_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db.js */ \"./src/db.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils.js */ \"./src/utils.js\");\n/* harmony import */ var tabulator_tables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! tabulator-tables */ \"./node_modules/tabulator-tables/dist/js/tabulator_esm.js\");\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'tabulator-tables/dist/css/tabulator.min.css'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\n\r\n\r\n\r\n\r\n\r\nlet DBDATA = { queue: [], filtered: [] };\r\nlet LISTLEN = 30;\r\nlet MAXLOGDUMP = 99999;\r\nlet DEFAULT_RATING = 7.5;\r\nlet MAX_ERRS = 5; // After this many errors treat it as bad\r\n\r\nlet COMPACT_TABLE_HEIGHT = 40;\r\nlet NORMAL_TABLE_HEIGHT = 68;\r\nlet COMPACT_THUMB_WIDTH = 60;\r\nlet NORMAL_THUMB_WIDTH = 90;\r\nlet TITLE_WIDTH = 120;\r\nconst DEFAULT_THUMB = \"./favicon.ico\";\r\n\r\nlet env = {};\r\nasync function loadEnv2() {\r\n  env.youtube_api_key = window.electronAPI.get(\"youtube_api_key\");\r\n  if (env.youtube_api_key) {\r\n    return;\r\n  }\r\n\r\n  sendMessage({ type: \"hideYoutube\" });\r\n  document.addEventListener(\"click\", async (e) => {\r\n    const link = e.target.closest(\"a.external-link\");\r\n    if (!link) return;\r\n\r\n    e.preventDefault();\r\n    await window.electronAPI.openExternal(link.href);\r\n  });\r\n\r\n  const dialog = document.getElementById(\"add-api-key-dialog\");\r\n  const form = dialog.querySelector(\"form\");\r\n  const input = form.querySelector(\"input\");\r\n\r\n  dialog.showModal();\r\n  // Make it harder to skip this, but not impossible?\r\n  let dismissable = false;\r\n  if (dismissable) {\r\n    dialog.addEventListener(\"click\", (e) => {\r\n      if (e.target === dialog) {\r\n        dialog.close();\r\n        sendMessage({ type: \"showYoutube\" });\r\n      }\r\n    });\r\n  }\r\n  form.addEventListener(\"submit\", async (e) => {\r\n    env.youtube_api_key = input.value.trim();\r\n    if (env.youtube_api_key) {\r\n      window.electronAPI.set(\"youtube_api_key\", env.youtube_api_key);\r\n    }\r\n    sendMessage({ type: \"showYoutube\" });\r\n  });\r\n}\r\nloadEnv2();\r\n\r\nconst fastForwardBtn = document.getElementById(\"fastForward\");\r\nconst skipBtn = document.getElementById(\"skip\");\r\nconst delayBtn = document.getElementById(\"delay\");\r\nconst pauseBtn = document.getElementById(\"pause\");\r\nconst playBtn = document.getElementById(\"play\");\r\nconst queueEl = document.getElementById(\"queue\");\r\nconst logEl = document.getElementById(\"log\");\r\n\r\nlet queueMode = window.electronAPI.get(\"queueMode\", \"Video\");\r\nlet profile = window.electronAPI.get(\"profile\");\r\n\r\nfunction handleDivider(divEl, vert) {\r\n  let isDragging = false;\r\n  const container = divEl.parentElement;\r\n  const divSizeKey = `${divEl.id}-size`;\r\n  const savedSize = window.electronAPI.get(divSizeKey);\r\n\r\n  if (savedSize) {\r\n    container.style.setProperty(`--${divSizeKey}`, `${savedSize}px`);\r\n  }\r\n\r\n  divEl.addEventListener(\"mousedown\", (e) => {\r\n    isDragging = true;\r\n    document.body.style.cursor = vert ? \"row-resize\" : \"col-resize\";\r\n    e.preventDefault();\r\n  });\r\n\r\n  window.addEventListener(\"mousemove\", (e) => {\r\n    if (!isDragging) return;\r\n    const rect = container.getBoundingClientRect();\r\n    let newSize = vert ? e.clientY - rect.top : e.clientX - rect.left;\r\n\r\n    // Limit resizing range\r\n    const minSize = 250;\r\n    const maxSize = 1000;\r\n    newSize = Math.min(Math.max(newSize, minSize), maxSize);\r\n    container.style.setProperty(`--${divSizeKey}`, `${newSize}px`);\r\n  });\r\n\r\n  window.addEventListener(\"mouseup\", () => {\r\n    if (isDragging) {\r\n      isDragging = false;\r\n      document.body.style.cursor = \"default\";\r\n\r\n      const currentSize = parseFloat(\r\n        container.style.getPropertyValue(`--${divSizeKey}`)\r\n      );\r\n      window.electronAPI.set(divSizeKey, currentSize);\r\n    }\r\n  });\r\n}\r\ndocument.querySelectorAll(\".my-divider\").forEach((divEl) => {\r\n  const isVertical = divEl.classList.contains(\"vertical\");\r\n  handleDivider(divEl, isVertical);\r\n});\r\n\r\nfunction youtubeDiv() {\r\n  return (\r\n    document.querySelector(\".active#youtube-full\") ||\r\n    document.getElementById(\"youtube\")\r\n  );\r\n}\r\n\r\n// Track the currently active div\r\nlet activeYoutubeDiv;\r\n\r\n// Observe changes in class attributes\r\nconst observer = new MutationObserver((mutationsList) => {\r\n  for (const mutation of mutationsList) {\r\n    if (mutation.type !== \"attributes\" || mutation.attributeName !== \"class\") {\r\n      continue;\r\n    }\r\n    const target = mutation.target;\r\n    if (target.classList.contains(\"active\") && target !== activeYoutubeDiv) {\r\n      activeYoutubeDiv = youtubeDiv();\r\n      // Start observing the new active div\r\n      startResizeObserver(activeYoutubeDiv);\r\n    }\r\n  }\r\n});\r\n\r\nlet resizeObserver = null;\r\n\r\nfunction startResizeObserver(div) {\r\n  // Disconnect previous observer\r\n  if (resizeObserver) resizeObserver.disconnect();\r\n\r\n  // Create a new ResizeObserver\r\n  resizeObserver = new ResizeObserver((entries) => {\r\n    for (let entry of entries) {\r\n      const rect = entry.target.getBoundingClientRect();\r\n      const bounds = {\r\n        x: rect.left,\r\n        y: rect.top,\r\n        width: rect.width,\r\n        height: rect.height,\r\n      };\r\n\r\n      // Send new size to main process\r\n      electronAPI.sendBroadcast({\r\n        type: \"div-resize\",\r\n        bounds,\r\n      });\r\n    }\r\n  });\r\n\r\n  resizeObserver.observe(div);\r\n}\r\n\r\n// Observe all tab-content divs\r\n// TODO: Should really be the youtube divs only\r\ndocument.querySelectorAll(\".tab-content\").forEach((div) => {\r\n  observer.observe(div, { attributes: true });\r\n});\r\n\r\nconst themeLink = document.getElementById(\"tabulator-theme\");\r\n\r\nfunction updateTheme() {\r\n  const isDark = window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\r\n  themeLink.href = isDark\r\n    ? \"assets/tabulator_site_dark.min.css\"\r\n    : \"assets/tabulator_site.min.css\";\r\n}\r\n\r\n// Run on load\r\nupdateTheme();\r\n\r\n// Listen for user preference changes\r\nwindow\r\n  .matchMedia(\"(prefers-color-scheme: dark)\")\r\n  .addEventListener(\"change\", updateTheme);\r\n\r\nfunction date2String(d) {\r\n  let yy = `${String(d.getFullYear()).padStart(4, \"0\")}`;\r\n  let MM = `${String(d.getMonth() + 1).padStart(2, \"0\")}`;\r\n  let dd = `${String(d.getDate()).padStart(2, \"0\")}`;\r\n  let hh = `${String(d.getHours()).padStart(2, \"0\")}`;\r\n  let mm = `${String(d.getMinutes()).padStart(2, \"0\")}`;\r\n  return `${yy}-${MM}-${dd} ${hh}:${mm}`;\r\n}\r\n\r\nfunction showToast(msg) {\r\n  let duration = 5000;\r\n  const container = document.getElementById(\"toast-container\");\r\n  const toast = document.createElement(\"div\");\r\n  toast.className = \"toast\";\r\n  toast.textContent = msg;\r\n  container.appendChild(toast);\r\n\r\n  setTimeout(() => toast.remove(), duration);\r\n}\r\n\r\nlet baseTabulatorOptions = {\r\n  persistence: { columns: [\"width\", \"visible\", \"frozen\"] },\r\n  persistenceWriterFunc: (id, type, data) => {\r\n    window.electronAPI.set(`${id}`, data);\r\n  },\r\n  persistenceReaderFunc: (id, type) => {\r\n    let data = window.electronAPI.get(`${id}`);\r\n    return data;\r\n  },\r\n  movableColumns: true,\r\n  columnDefaults: {\r\n    headerHozAlign: \"center\",\r\n    hozAlign: \"center\",\r\n    vertAlign: \"middle\",\r\n  },\r\n  index: \"uuid\",\r\n  // reactiveData: true,\r\n};\r\n\r\nlet tabulatorCurrent = null;\r\nlet tabulatorQueue = null;\r\nlet tabulatorLog = null;\r\nasync function renderQueue() {\r\n  if (DBDATA.queue.length == 0) {\r\n    console.log(\"Empty DBDATA.queue, nothing to render\");\r\n    return;\r\n  }\r\n  // const firstVideo = DBDATA.queue[0];\r\n  // const restVideos = DBDATA.queue.slice(1, LISTLEN + 1);\r\n  const restVideos = DBDATA.queue.slice(0, LISTLEN);\r\n  // tabulatorCurrent = await table2(\r\n  //   tabulatorCurrent,\r\n  //   currentEl,\r\n  //   [firstVideo],\r\n  //   \"current\"\r\n  // );\r\n\r\n  function finalizePlaylist(playlist, playlistChildren) {\r\n    if (playlist) {\r\n      _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsPL(playlist, DBDATA.queue);\r\n      playlist._allChildren = playlistChildren;\r\n    }\r\n    return { playlist: null, playlistChildren: [] };\r\n  }\r\n\r\n  tabulatorQueue = await table2(tabulatorQueue, queueEl, restVideos, \"queue\");\r\n  let log = await _db_js__WEBPACK_IMPORTED_MODULE_0__.getLastNLogs(LISTLEN);\r\n  let logVideoList = [];\r\n  let playlist = null;\r\n  let playlistChildren = [];\r\n  for (let entry of log) {\r\n    let video = DBDATA.queue.find((v) => v.uuid === entry.uuid);\r\n    if (entry.type == \"playlist\") {\r\n      if (entry.playlistUuid !== playlist?.uuid) {\r\n        ({ playlist, playlistChildren } = finalizePlaylist(\r\n          playlist,\r\n          playlistChildren\r\n        ));\r\n        // Make new playlist copy\r\n        let origPlaylist = DBDATA.playlists.find(\r\n          (pl) => pl.uuid === entry.playlistUuid\r\n        );\r\n        // console.log(\"entry\", entry);\r\n        // console.log(\"origPlaylist\", origPlaylist);\r\n        playlist = _utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapItem(origPlaylist, {\r\n          _currentTrack: -1,\r\n          videoUuids: [],\r\n        });\r\n        logVideoList.push(playlist);\r\n      }\r\n      playlist.videoUuids.push(entry.uuid);\r\n      playlistChildren.push(\r\n        _utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapItem(video, { entry, _track: entry._track })\r\n      );\r\n    } else {\r\n      logVideoList.push(_utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapItem(video, { entry, track: entry.track }));\r\n    }\r\n  }\r\n  ({ playlist, playlistChildren } = finalizePlaylist(\r\n    playlist,\r\n    playlistChildren\r\n  ));\r\n  tabulatorLog = await table2(tabulatorLog, logEl, logVideoList, \"log\");\r\n}\r\n\r\nfunction thumbnailFormatter(cell) {\r\n  const data = cell.getData();\r\n  const item = cell.getRow().getData();\r\n  const img = document.createElement(\"img\");\r\n  const candidateUrl = item.thumbnailUrl;\r\n  if (!candidateUrl) {\r\n    return \"\";\r\n  }\r\n\r\n  // img.src = DEFAULT_THUMB;\r\n  img.src = candidateUrl;\r\n  img.onerror = (e) => {\r\n    console.log(\"img error\");\r\n    console.log(cell.getData());\r\n  };\r\n  return img;\r\n}\r\n\r\nasync function tabulatorCellEdited(cell) {\r\n  const item = cell.getData();\r\n  if (item.type == \"video\") {\r\n    await saveVideos(item);\r\n  } else if (item.type == \"playlist\") {\r\n    await savePlaylists(item);\r\n  } else {\r\n    console.log(\"error\");\r\n  }\r\n}\r\n\r\nfunction getTableColumns(tableType) {\r\n  let tableColumns = {\r\n    dataTree: {\r\n      title: \"\",\r\n      field: \"type\",\r\n      formatter: () => {\r\n        return \"\";\r\n      },\r\n      cellClick: (e, cell) => {\r\n        let row = cell.getRow();\r\n        if (row.getData().type == \"video\") {\r\n          row = row.getTreeParent();\r\n        }\r\n        row && row.treeToggle();\r\n      },\r\n    },\r\n    thumb: {\r\n      title: \"Thumb\",\r\n      field: \"id_fake\", // persistence requires unique fields\r\n      // TODO: Need to work on this more, PL vs V etc\r\n      formatter: thumbnailFormatter,\r\n      width: COMPACT_THUMB_WIDTH,\r\n      cellClick: async (e, cell) => {\r\n        const row = cell.getRow();\r\n        const data = row.getData();\r\n        const row0 = cell.getTable().getRows()[0];\r\n        const row1 = cell.getTable().getRows()[1];\r\n        const dataTree = cell.getTable().options?.dataTree;\r\n        const parent = dataTree && row.getTreeParent();\r\n        if (parent && tableType == \"queue\" && parent == row0) {\r\n          console.log(\"current playlist video uuid:\", data.uuid);\r\n          // WIP\r\n          // First deal with -1 case nonsense\r\n          if (DBDATA.queue[0]._currentTrack == -1) {\r\n            DBDATA.queue[0]._currentTrack = 0;\r\n          }\r\n          // Skip until we find the clicked video\r\n          while (\r\n            DBDATA.queue[0]._children.length > 0 &&\r\n            DBDATA.queue[0]._children[0].uuid != data.uuid\r\n          ) {\r\n            // console.log(\"skip:\", DBDATA.queue[0]._children[0].uuid);\r\n            await logEvent(DBDATA.queue[0], \"skip\");\r\n            DBDATA.queue[0]._currentTrack += 1;\r\n          }\r\n          playNextVideo(0);\r\n        } else if (parent && tableType == \"queue\" && parent != row0) {\r\n          moveVideoToFront(parent.getData().uuid);\r\n          await renderQueue();\r\n        } else if (tableType == \"queue\" && row == row0) {\r\n          playNextVideo(0);\r\n        } else if (tableType == \"queue\" && row == row1) {\r\n          logAndPlayNext(\"skip\", { skipWholeList: true });\r\n        } else {\r\n          moveVideoToFront(cell.getRow().getData().uuid);\r\n          await renderQueue();\r\n          showToast(\"Added to front of queue\");\r\n        }\r\n      },\r\n      hozAlign: \"center\",\r\n    },\r\n    title: {\r\n      title: \"Title\",\r\n      field: \"title\",\r\n      formatter: \"plaintext\",\r\n      tooltip: true,\r\n      hozAlign: \"left\",\r\n      width: TITLE_WIDTH,\r\n    },\r\n    tags: {\r\n      title: \"Tags\",\r\n      field: \"tags\",\r\n      formatter: \"textarea\",\r\n      editor: \"input\",\r\n      width: 150,\r\n      cellEdited: tabulatorCellEdited,\r\n    },\r\n    track: {\r\n      title: \"Trk\",\r\n      field: \"_track\",\r\n      sorter: \"number\",\r\n      formatter: (cell) => {\r\n        let item = cell.getData();\r\n        if (item.type == \"playlist\") {\r\n          if (item._currentTrack == -1) {\r\n            return item._track;\r\n          } else {\r\n            return `${item._currentTrack + 1}/${item._track}`;\r\n          }\r\n        } else {\r\n          const dataTree = cell.getTable().options?.dataTree;\r\n          const parent = dataTree && cell.getRow().getTreeParent();\r\n          if (parent) {\r\n            return item._track + 1;\r\n          } else {\r\n            return \"\";\r\n          }\r\n        }\r\n      },\r\n    },\r\n    dur: {\r\n      title: \"Dur\",\r\n      field: \"duration\",\r\n      formatter: (cell) => {\r\n        return _utils_js__WEBPACK_IMPORTED_MODULE_1__.formatDuration(cell.getValue(), false);\r\n      },\r\n    },\r\n    lastPlayed: {\r\n      title: \"Last Played\",\r\n      field: \"lastPlayDate\",\r\n      formatter: (cell) => {\r\n        return formatLastPlayDate(cell.getRow().getData());\r\n      },\r\n    },\r\n    due: {\r\n      title: \"Due\",\r\n      field: \"due\",\r\n      formatter: (cell) => {\r\n        return formatDue(cell.getValue());\r\n      },\r\n      editable: false,\r\n    },\r\n    playCnt: {\r\n      title: \"Cnt\",\r\n      field: \"playCnt\",\r\n      formatter: \"plaintext\",\r\n    },\r\n    rating: {\r\n      title: \"Rating\",\r\n      field: \"rating\",\r\n      formatter: (cell) => {\r\n        let item = cell.getRow().getData();\r\n        let div = document.createElement(\"div\");\r\n        div.className = \"number-stepper\";\r\n        const downBtn = document.createElement(\"button\");\r\n        downBtn.className = \"step-btn step-down\";\r\n        downBtn.type = \"button\";\r\n        downBtn.innerHTML = \"&minus;\";\r\n        const upBtn = document.createElement(\"button\");\r\n        upBtn.className = \"step-btn step-up\";\r\n        upBtn.type = \"button\";\r\n        upBtn.innerHTML = \"&plus;\";\r\n\r\n        let input = document.createElement(\"input\");\r\n        input.type = \"number\";\r\n        input.min = \"1\";\r\n        input.max = \"10\";\r\n        input.step = \"0.5\";\r\n        input.value = (item.rating ?? DEFAULT_RATING).toFixed(1);\r\n        div.appendChild(downBtn);\r\n        div.appendChild(input);\r\n        div.appendChild(upBtn);\r\n        return div;\r\n      },\r\n      cellClick: async (e, cell) => {\r\n        let item = cell.getRow().getData();\r\n        let origRating = item.rating;\r\n        if (e.target.classList.contains(\"step-down\")) {\r\n          // Round to nearest 0.5, then change 0.5\r\n          item.rating = Math.max(1, Math.round(item.rating * 2) / 2 - 0.5);\r\n        } else if (e.target.classList.contains(\"step-up\")) {\r\n          // Round to nearest 0.5, then change by 0.5\r\n          item.rating = Math.min(10, Math.round(item.rating * 2) / 2 + 0.5);\r\n        }\r\n        if (origRating != item.rating) {\r\n          if (item.type == \"playlist\") {\r\n            await savePlaylists([item]);\r\n          } else if (item.type == \"video\") {\r\n            await saveVideos([item]);\r\n          } else {\r\n            alert(`unknown type ${item.type}`);\r\n            console.log(item);\r\n          }\r\n          cell.getRow().reformat();\r\n        }\r\n      },\r\n    },\r\n    interval: {\r\n      title: \"Int\",\r\n      field: \"interval\",\r\n      formatter: (cell) => {\r\n        return cell.getValue() + \"d\";\r\n      },\r\n    },\r\n    score: {\r\n      title: \"Score\",\r\n      field: \"score\",\r\n      hozAlign: \"center\",\r\n      formatter: (cell) => {\r\n        return cell.getValue().toFixed(1);\r\n      },\r\n    },\r\n    delay: {\r\n      title: \"Delay\",\r\n      field: \"delay\",\r\n      hozAlign: \"center\",\r\n      formatter: (cell) => {\r\n        return cell.getValue() ? \"\" : \"\";\r\n      },\r\n    },\r\n    errCnt: {\r\n      title: \"Err\",\r\n      field: \"errCnt\",\r\n      hozAlign: \"center\",\r\n      editor: \"number\",\r\n      cellEdited: tabulatorCellEdited,\r\n    },\r\n    dup: {\r\n      title: \"Dup\",\r\n      field: \"dup\",\r\n      hozAlign: \"left\",\r\n      editor: \"input\",\r\n      cellEdited: tabulatorCellEdited,\r\n    },\r\n    source: {\r\n      title: \"Source\",\r\n      field: \"source\",\r\n    },\r\n    foreignKey: {\r\n      title: \"Native Key\",\r\n      field: \"foreignKey\",\r\n      hozAlign: \"left\",\r\n      width: TITLE_WIDTH,\r\n    },\r\n    channel: {\r\n      title: \"Channel\",\r\n      field: \"videoOwnerChannelTitle\",\r\n      hozAlign: \"left\",\r\n      // headerFilter: \"input\",\r\n      width: 150,\r\n    },\r\n    PL_channel: {\r\n      title: \"Channel\",\r\n      field: \"channelTitle\",\r\n      // headerFilter: \"input\",\r\n      width: 150,\r\n    },\r\n    dateAdded: {\r\n      title: \"Date Added\",\r\n      field: \"dateAdded\",\r\n      formatter: (cell) => {\r\n        const timestamp = cell.getValue();\r\n        if (!timestamp) return \"\";\r\n        return date2String(new Date(timestamp));\r\n      },\r\n      hozAlign: \"center\",\r\n    },\r\n    logType: {\r\n      title: \"Type\",\r\n      field: \"entry.event\",\r\n    },\r\n  };\r\n  return tableColumns;\r\n}\r\n\r\nasync function table2(tabulator, htmlEl, videoList, tableType) {\r\n  if (tabulator) {\r\n    const expandedIds = [];\r\n    tabulator.getRows().forEach((row) => {\r\n      if (row.getData().type == \"playlist\" && row.isTreeExpanded()) {\r\n        expandedIds.push(row.getData().uuid);\r\n      }\r\n    });\r\n    tabulator.replaceData(videoList).then(() => {\r\n      tabulator.getRows().forEach((row) => {\r\n        if (expandedIds.includes(row.getData().uuid)) {\r\n          row.treeExpand();\r\n        }\r\n      });\r\n    });\r\n    return tabulator;\r\n  }\r\n  let tableColumns = getTableColumns(tableType);\r\n\r\n  let columns = [\r\n    tableType == \"log\" ? tableColumns.logType : tableColumns.dataTree,\r\n    tableColumns.thumb,\r\n    tableColumns.title,\r\n    tableColumns.track,\r\n    tableColumns.rating,\r\n    tableColumns.interval,\r\n    tableColumns.tags,\r\n  ];\r\n  columns.map((c) => (c.headerSort = false));\r\n\r\n  tabulator = new tabulator_tables__WEBPACK_IMPORTED_MODULE_2__.TabulatorFull(htmlEl, {\r\n    ...baseTabulatorOptions,\r\n    data: videoList,\r\n    custom: { tableType }, // custom property  TODO: Not needed anymore?\r\n    columns: columns,\r\n    dataTree: true,\r\n    layout: \"fitData\",\r\n    rowHeight: COMPACT_TABLE_HEIGHT,\r\n  });\r\n  tabulator.on(\"headerContext\", (event) => {\r\n    headerMenu(event, tabulator);\r\n  });\r\n\r\n  return tabulator;\r\n}\r\nfunction formatLastPlayDate(video) {\r\n  if (!video.lastPlayDate) {\r\n    return \"\";\r\n  }\r\n  let daysSince =\r\n    (Date.now() - new Date(video.lastPlayDate)) / (24 * 3600 * 1000);\r\n  return `${daysSince.toFixed(1)} days ago`;\r\n}\r\nfunction formatDue(due) {\r\n  if (due === null) {\r\n    return \"\";\r\n  }\r\n  let color = due < -5 ? \"#d11\" : due < 0 ? \"#e77\" : \"#6b6\";\r\n  let text = due < 0 ? \"days ago\" : \"days from now\";\r\n  return `<span style=\"color:${color}\">${Math.abs(due).toFixed(1)} ${text}</span>`;\r\n}\r\n\r\nasync function addYoutubeInfo(video) {\r\n  console.log(\"Fetching YouTube info for\", video.foreignKey);\r\n  const url = `https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails,statistics&id=${video.foreignKey}&key=${env.youtube_api_key}`;\r\n  const response = await fetch(url);\r\n  let data = await response.json();\r\n  // console.log(data);\r\n  if (data.items?.length > 0) {\r\n    data = trimYoutubeFields(data);\r\n    video.yt = data.items[0];\r\n    _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsVideo(video);\r\n    await saveVideos([video]);\r\n  } else {\r\n    console.log(\"Error fetching yt for: \", video.foreignKey);\r\n  }\r\n}\r\n\r\nasync function addPlaylistVideos(playlistForeignKey) {\r\n  // First, fetch playlist metadata\r\n  let playlistUrl = `https://www.googleapis.com/youtube/v3/playlists?part=snippet,contentDetails&id=${playlistForeignKey}&key=${env.youtube_api_key}`;\r\n  let playlistRes = await fetch(playlistUrl);\r\n  let playlistData = await playlistRes.json();\r\n  // console.log(\"playlists raw:\", playlistData);\r\n\r\n  if (!playlistData.items || playlistData.items.length === 0) {\r\n    console.error(\"Playlist not found:\", playlistForeignKey);\r\n    return;\r\n  }\r\n\r\n  let playlistInfo = playlistData.items[0];\r\n  let playlist = await _db_js__WEBPACK_IMPORTED_MODULE_0__.getPlaylistBySourceAndForeignKey(\r\n    \"youtube\",\r\n    playlistForeignKey\r\n  );\r\n  if (playlist) {\r\n    console.log(\"Updating existing playlist\", playlist);\r\n    // If it already exists, clear videoUuids, and only update a few yt info fields.\r\n    // All other fields such as rating are kept as is\r\n    playlist.videoUuids = [];\r\n    playlist.yt = playlistInfo;\r\n    playlist.title = playlistInfo.snippet.title;\r\n    playlist.channelTitle = playlistInfo.snippet.channelTitle;\r\n    playlist.thumbnailUrl = playlistInfo.snippet.thumbnails?.default?.url;\r\n  } else {\r\n    console.log(\"New playlist\");\r\n    playlist = {\r\n      uuid: _db_js__WEBPACK_IMPORTED_MODULE_0__.uuidv4(),\r\n      source: \"youtube\",\r\n      foreignKey: playlistForeignKey,\r\n      title: playlistInfo.snippet.title,\r\n      channelTitle: playlistInfo.snippet.channelTitle,\r\n      thumbnailUrl: playlistInfo.snippet.thumbnails?.default?.url,\r\n      dateAdded: Date.now(),\r\n      rating: DEFAULT_RATING,\r\n      yt: playlistInfo,\r\n      videoUuids: [],\r\n    };\r\n  }\r\n\r\n  // Now fetch all videos from the playlist\r\n  let nextPageToken = \"\";\r\n  let newVideos = [];\r\n  let failsafeCnt = 0;\r\n  let seenTokens = new Set();\r\n  do {\r\n    let url =\r\n      `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet,contentDetails` +\r\n      `&maxResults=50&pageToken=${nextPageToken}&playlistId=${playlistForeignKey}&key=${env.youtube_api_key}`;\r\n    let res = await fetch(url);\r\n    let data = await res.json();\r\n    // console.log(\"playlistItems raw: \", data);\r\n    data = trimYoutubeFields(data);\r\n\r\n    for (const yt of data.items) {\r\n      let foreignKey = yt.snippet.resourceId.videoId;\r\n      let matchingVideo = DBDATA.queue.find((v) => v.foreignKey === foreignKey);\r\n      let videoUuid = matchingVideo ? matchingVideo.uuid : _db_js__WEBPACK_IMPORTED_MODULE_0__.uuidv4();\r\n      if (playlist.videoUuids.includes(videoUuid)) {\r\n        continue; // skip dups\r\n      }\r\n      playlist.videoUuids.push(videoUuid);\r\n      if (!matchingVideo) {\r\n        let video = {\r\n          uuid: videoUuid,\r\n          source: \"youtube\",\r\n          foreignKey: foreignKey,\r\n          rating: DEFAULT_RATING,\r\n          dateAdded: Date.now(),\r\n          yt: yt,\r\n        };\r\n        video = trimYoutubeFields(video);\r\n        _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsVideo(video);\r\n        newVideos.push(video);\r\n        DBDATA.queue.push(video);\r\n      }\r\n    }\r\n    nextPageToken = data.nextPageToken;\r\n    if (seenTokens.has(data.prevPageToken)) {\r\n      console.log(\"Token repeated -- youtube mix? Stopping.\");\r\n      break;\r\n    }\r\n    seenTokens.add(data.prevPageToken);\r\n    failsafeCnt += 1;\r\n    if (failsafeCnt >= 20) {\r\n      alert(\"Error: Looped 20 times. Aborting.\");\r\n      return;\r\n    }\r\n  } while (nextPageToken);\r\n\r\n  await saveVideos(newVideos);\r\n  DBDATA.queue.push(...newVideos);\r\n  console.log(\"addPlaylistVideos: newVideos \", newVideos);\r\n  console.log(playlist);\r\n  _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsPL(playlist, DBDATA.queue);\r\n  console.log(playlist);\r\n  console.log(\r\n    `Add playlist of ${playlist.videoUuids.length} videos (${newVideos.length} new)`\r\n  );\r\n  showToast(\r\n    `Add playlist of ${playlist.videoUuids.length} videos (${newVideos.length} new)`\r\n  );\r\n\r\n  // Replace or add in DBDATA.playlists\r\n  let idx = DBDATA.playlists.findIndex(\r\n    (p) => p.foreignKey === playlist.foreignKey\r\n  );\r\n  if (idx !== -1) {\r\n    playlist.uuid = DBDATA.playlists[idx].uuid; // Reuse same uuid\r\n    DBDATA.playlists[idx] = playlist;\r\n  } else {\r\n    DBDATA.playlists.push(playlist);\r\n  }\r\n  await savePlaylists(playlist);\r\n\r\n  // Replace or add in DBDATA.queue\r\n  let copy = _utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapItem(playlist);\r\n  copy = _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsPL(copy, DBDATA.queue);\r\n  idx = DBDATA.queue.findIndex((p) => p.uuid === playlist.uuid);\r\n  if (idx !== -1) {\r\n    DBDATA.queue[idx] = playlist;\r\n  } else {\r\n    DBDATA.queue.push(playlist);\r\n  }\r\n  // Use this instead of unshift because it's not so simple\r\n  await moveVideoToFront(copy.uuid);\r\n\r\n  await rerenderAll();\r\n}\r\n\r\nasync function addVideoOrPlaylist(response) {\r\n  if (response.type == \"video\") {\r\n    let video = DBDATA.queue.find((v) => v.foreignKey === response.foreignKey);\r\n    if (video) {\r\n      showToast(\"Video already in DB\");\r\n      await moveVideoToFront(video.uuid);\r\n    } else {\r\n      let video = {\r\n        uuid: _db_js__WEBPACK_IMPORTED_MODULE_0__.uuidv4(),\r\n        source: \"youtube\",\r\n        foreignKey: response.foreignKey,\r\n        rating: DEFAULT_RATING,\r\n        dateAdded: Date.now(),\r\n      };\r\n      await addYoutubeInfo(video);\r\n      if (!video.yt) {\r\n        showToast(\"Failed to fetch video info, please check the ID\");\r\n        return;\r\n      }\r\n      showToast(\"Video added\");\r\n      DBDATA.queue.splice(1, 0, video);\r\n    }\r\n  } else if (response.type == \"playlist\") {\r\n    await addPlaylistVideos(response.foreignKey);\r\n  } else {\r\n    showToast(\"Error: could not parse input\");\r\n    return;\r\n  }\r\n  await rerenderAll();\r\n}\r\n\r\nasync function rotateVideo() {\r\n  let currItem = DBDATA.queue[0];\r\n  let video = currItem.type == \"playlist\" ? currItem._children[0] : currItem;\r\n  video.rotateAngle = ((video.rotateAngle || 0) + 90) % 360;\r\n  console.log(\"rotateVideo new angle:\", video.rotateAngle);\r\n  saveVideos(video);\r\n}\r\n\r\nasync function importLocalFiles(msg) {\r\n  let videos = [];\r\n  for (let file of msg.files) {\r\n    if (DBDATA.queue.find((v) => v.foreignKey == file)) {\r\n      console.log(\"dup\", file);\r\n      continue;\r\n    }\r\n    let video = {\r\n      uuid: _db_js__WEBPACK_IMPORTED_MODULE_0__.uuidv4(),\r\n      source: \"local\",\r\n      foreignKey: file,\r\n      rating: 5.6, // TODO unhack 5.5 = 365 days\r\n      // rating: DEFAULT_RATING,\r\n      dateAdded: Date.now(),\r\n      lastPlayDate: Date.now(),\r\n      delay: true,\r\n      title: file,\r\n    };\r\n    trimLocalFields(video);\r\n    _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsVideo(video);\r\n    videos.push(video);\r\n  }\r\n  await saveVideos(videos);\r\n  DBDATA.queue.splice(1, 0, ...videos);\r\n}\r\n\r\nconst addDialog = document.getElementById(\"addDialog\");\r\nconst addForm = document.getElementById(\"addForm\");\r\nconst addInput = document.getElementById(\"videoInput\");\r\nconst addBtn = document.getElementById(\"add\");\r\n\r\naddBtn.addEventListener(\"click\", () => {\r\n  addInput.value = \"\";\r\n  addDialog.showModal();\r\n});\r\naddDialog.addEventListener(\"click\", (e) => {\r\n  if (e.target === addDialog) {\r\n    addDialog.close();\r\n  }\r\n});\r\naddForm.addEventListener(\"submit\", async (e) => {\r\n  const url = addInput.value.trim();\r\n  const response = getVideoIdFromInput(url);\r\n  if (response.foreignKey) {\r\n    addVideoOrPlaylist(response);\r\n  } else {\r\n    console.log(\"Error: Could not find ID:\", url);\r\n  }\r\n});\r\nskipBtn.addEventListener(\"click\", async (e) => {\r\n  let params = e.shiftKey ? { skipWholeList: true } : {};\r\n  logAndPlayNext(\"skip\", params);\r\n});\r\ndelayBtn.addEventListener(\"click\", async (e) => {\r\n  let params = e.shiftKey ? { delayWholeList: true } : {};\r\n  logAndPlayNext(\"delay\", params);\r\n});\r\npauseBtn.addEventListener(\"click\", async () => {\r\n  sendMessage({ type: \"pauseVideo\" });\r\n});\r\nplayBtn.addEventListener(\"click\", async () => {\r\n  sendMessage({ type: \"resumeVideo\" });\r\n});\r\nfastForwardBtn.addEventListener(\"click\", async () => {\r\n  sendMessage({ type: \"fastForward\" });\r\n});\r\n\r\nlet videoTimeout;\r\n\r\nfunction sendMessage(msg) {\r\n  console.log(\"sendMessage: \", JSON.stringify(msg));\r\n  window.electronAPI.sendBroadcast(msg);\r\n}\r\n\r\nasync function pickNextVideoToPlay(offset, params = {}) {\r\n  // console.log(\"pnv params:\", params);\r\n  let skip = params.skipWholeList || params.delayWholeList;\r\n  if (offset != 0 && offset != 1) {\r\n    console.log(\"ERROR\");\r\n  }\r\n  // offset = 0 is for playing/cueing the current video.\r\n  // That shouldn't happen together with skip.\r\n  if (offset == 0 && skip) {\r\n    console.log(\"ERROR\");\r\n  }\r\n\r\n  let currItem = DBDATA.queue[0];\r\n  let video = currItem.type == \"playlist\" ? currItem._children[0] : currItem;\r\n  // The current playlist should at least be \"active\"\r\n  // Even if we end up skipping/whatever later\r\n  if (currItem.type == \"playlist\" && currItem._currentTrack == -1) {\r\n    currItem._currentTrack = 0;\r\n    // console.log(\"activate PL\");\r\n  }\r\n\r\n  // If we want to play/cue the current video, just return the first video\r\n  if (offset == 0) {\r\n    // console.log(\"pnv easy\", video);\r\n    return video;\r\n  }\r\n\r\n  // If the first item is a playlist, and there are songs left, and we don't skip...\r\n  if (currItem.type == \"playlist\" && currItem._children.length > 1 && !skip) {\r\n    // console.log(\"increment playlist pointer\");\r\n    let video = currItem._children[1];\r\n    if (!params.cueVideo) {\r\n      currItem._currentTrack += 1;\r\n      // console.log(\"next track:\", currItem._currentTrack);\r\n    }\r\n    return video;\r\n  }\r\n\r\n  // By now we know we are done with the first item.\r\n  // If it's a playlist, log completion/skip/delay, reset _currentTrack\r\n  if (currItem.type == \"playlist\" && !params.cueVideo) {\r\n    // console.log(\"playlist update\");\r\n    currItem.lastPlayDate = Date.now();\r\n    currItem.score = _utils_js__WEBPACK_IMPORTED_MODULE_1__.scoreItem(currItem);\r\n    currItem.delay = !!params.delayWholeList;\r\n    if (!skip) {\r\n      currItem.playCnt = (currItem.playCnt ?? 0) + 1;\r\n    }\r\n    currItem._currentTrack = -1;\r\n    await savePlaylists(currItem);\r\n  }\r\n\r\n  // Pick the next item in the queue\r\n  currItem = DBDATA.queue[1];\r\n  video = currItem.type == \"playlist\" ? currItem._children[0] : currItem;\r\n  // And set it active if it's a playlist\r\n  if (currItem.type == \"playlist\" && currItem._currentTrack == -1) {\r\n    currItem._currentTrack = 0;\r\n  }\r\n\r\n  if (!params.cueVideo) {\r\n    // Move current item to back of queue\r\n    // console.log(\"Rotate queue\");\r\n    let rotatedItem = DBDATA.queue.shift();\r\n    DBDATA.queue.push(rotatedItem);\r\n    if (rotatedItem.type == \"playlist\") {\r\n      rotatedItem._currentTrack = 0;\r\n    }\r\n  }\r\n  return video;\r\n}\r\n\r\nasync function cueNextVideo(offset = 1, params = {}) {\r\n  params.cueVideo = true;\r\n  let nextVideoToPlay = await pickNextVideoToPlay(offset, params);\r\n\r\n  let msg = {\r\n    type: \"backgroundCueVideo\",\r\n    source: nextVideoToPlay.source,\r\n    foreignKey: nextVideoToPlay.foreignKey,\r\n  };\r\n  sendMessage(msg);\r\n}\r\nasync function logAndPlayNext(type, params) {\r\n  await logEvent(DBDATA.queue[0], type);\r\n  playNextVideo(1, params);\r\n}\r\nasync function playNextVideo(offset = 1, params = {}) {\r\n  if (DBDATA.queue.length == 0) {\r\n    console.log(\"Queue empty\", offset);\r\n    return;\r\n  }\r\n  offset = offset % DBDATA.queue.length; // deal with very small queues\r\n\r\n  // console.log(\"ct:\", DBDATA.queue[0]._currentTrack);\r\n  let nextVideoToPlay = await pickNextVideoToPlay(offset, params);\r\n  // console.log(\"ct:\", DBDATA.queue[0]._currentTrack);\r\n\r\n  if (videoTimeout) clearTimeout(videoTimeout);\r\n  if (!params.cueVideo) {\r\n    videoTimeout = setTimeout(async () => {\r\n      console.log(\"Error:\", nextVideoToPlay.uuid, nextVideoToPlay.title);\r\n      sendMessage({\r\n        type: \"error\",\r\n        info: `timeout ${nextVideoToPlay.uuid} ${nextVideoToPlay.title}`,\r\n      });\r\n      showToast(\"Video timeout\");\r\n      nextVideoToPlay.errCnt = (nextVideoToPlay.errCnt || 0) + 1;\r\n      await saveVideos([nextVideoToPlay]);\r\n      await logEvent(nextVideoToPlay, \"error\");\r\n      playNextVideo();\r\n    }, 15000); // 15s -- see if this works\r\n  }\r\n  let needThumb =\r\n    nextVideoToPlay.source == \"local\" && !nextVideoToPlay.thumbnailUrl;\r\n  let msg = {\r\n    type: params?.cueVideo ? \"cueVideo\" : \"playVideo\",\r\n    source: nextVideoToPlay.source,\r\n    uuid: nextVideoToPlay.uuid,\r\n    needThumb: needThumb,\r\n    foreignKey: nextVideoToPlay.foreignKey,\r\n    ...(nextVideoToPlay.rotateAngle && {\r\n      rotateAngle: nextVideoToPlay.rotateAngle,\r\n    }),\r\n  };\r\n  console.log(msg);\r\n  sendMessage(msg);\r\n  await renderQueue();\r\n}\r\nfunction getVideoIdFromInput(input) {\r\n  if (input.startsWith(\"http\") || input.startsWith(\"file\")) {\r\n    const url = new URL(input);\r\n    if (url.hostname === \"youtu.be\") {\r\n      const videoId = url.pathname.slice(1); // remove leading \"/\"\r\n      return { type: \"video\", foreignKey: videoId };\r\n    }\r\n    const params = new URL(input).searchParams;\r\n    const listId = params.get(\"list\");\r\n    const videoId = params.get(\"v\");\r\n    // shorts: /shorts/<id>\r\n    if (url.pathname.startsWith(\"/shorts/\")) {\r\n      const id = url.pathname.split(\"/shorts/\")[1].split(/[?&]/)[0];\r\n      return { type: \"video\", foreignKey: id };\r\n    }\r\n    // prioritize single video.\r\n    if (videoId) {\r\n      return { type: \"video\", foreignKey: videoId };\r\n    } else {\r\n      return { type: \"playlist\", foreignKey: listId };\r\n    }\r\n  } else {\r\n    // assume raw video foreignKey\r\n    return { type: \"video\", foreignKey: input };\r\n  }\r\n}\r\n\r\nasync function logEvent(item, event) {\r\n  let now = Date.now();\r\n  let video = item.type == \"playlist\" ? item._children[0] : item;\r\n  video.lastPlayDate = now; // includes errors and skips\r\n  video.score = _utils_js__WEBPACK_IMPORTED_MODULE_1__.scoreItem(video);\r\n  video.delay = event === \"delay\";\r\n  if (event == \"play\") {\r\n    video.playCnt = (video.playCnt ?? 0) + 1;\r\n  }\r\n  if (video.playCnt == 1) {\r\n    video.firstPlayDate = now;\r\n  }\r\n  await saveVideos([video]);\r\n  const logEntry = {\r\n    type: item.type,\r\n    uuid: video.uuid,\r\n    source: video.source,\r\n    foreignKey: video.foreignKey,\r\n    timestamp: now,\r\n    event: event,\r\n    ...(item.type == \"playlist\" && {\r\n      playlistUuid: item.uuid,\r\n      _track: video._track,\r\n    }),\r\n  };\r\n  await _db_js__WEBPACK_IMPORTED_MODULE_0__.saveLog([logEntry]);\r\n}\r\n\r\nlet lastEndedVideoUuid = null;\r\n\r\nwindow.electronAPI.onBroadcast(async (msg) => {\r\n  let currItem = DBDATA.queue[0];\r\n  let currVideo =\r\n    currItem?.type == \"playlist\" ? currItem._children[0] : currItem;\r\n  let videoForeignKey = null;\r\n  let videoUuid = null;\r\n  // TODO: We don't always have msg.url?\r\n  // e.g. main.js could be sending the message.\r\n  // But it could add msg.url I suppose\r\n  if (msg?.url?.startsWith(\"file\")) {\r\n    // Local player can't really go off on it's own, so just assume we are playing the correct video.\r\n    videoForeignKey = currVideo.foreignKey;\r\n    videoUuid = currVideo.uuid;\r\n  } else if (msg.url) {\r\n    videoForeignKey = getVideoIdFromInput(msg.url).foreignKey;\r\n    videoUuid = DBDATA.queue.find((v) => v.foreignKey == videoForeignKey).uuid;\r\n    // console.log(\"from url:\", videoForeignKey, videoUuid);\r\n  }\r\n  console.log(\"options.js received message:\", msg);\r\n  if (msg?.type === \"videoPlaying\") {\r\n    clearTimeout(videoTimeout);\r\n    if (\r\n      videoUuid &&\r\n      currVideo &&\r\n      videoUuid === currVideo.uuid &&\r\n      !currVideo.yt?.contentDetails?.duration &&\r\n      !currVideo.scrapedDuration &&\r\n      msg.duration\r\n    ) {\r\n      currVideo.scrapedDuration = msg.duration;\r\n      await saveVideos([currVideo]);\r\n    }\r\n  } else if (msg?.type === \"videoEnded\") {\r\n    console.log(`end uuid:${videoUuid} lastEnded:${lastEndedVideoUuid}`);\r\n    if (lastEndedVideoUuid === videoUuid) {\r\n      return;\r\n    }\r\n    console.log(\"update lastEnded\");\r\n    lastEndedVideoUuid = videoUuid;\r\n    if (videoUuid && currVideo && videoUuid === currVideo.uuid) {\r\n      console.log(\"log\");\r\n      await logEvent(currItem, \"play\");\r\n    }\r\n    console.log(\"playNextVideo\");\r\n    playNextVideo();\r\n  } else if (msg.type === \"queue:addVideo\") {\r\n    addVideoOrPlaylist({ type: \"video\", foreignKey: msg.foreignKey });\r\n  } else if (msg.type === \"queue:addPlaylist\") {\r\n    await addVideoOrPlaylist({ type: \"playlist\", foreignKey: msg.foreignKey });\r\n  } else if (msg.type === \"deleteDatabaseRequest\") {\r\n    deleteDB();\r\n  } else if (msg.type === \"importDatabase\") {\r\n    importDB(msg.filePath);\r\n  } else if (msg.type === \"exportDatabase\") {\r\n    exportDB();\r\n  } else if (msg.type === \"videoCueNext\") {\r\n    cueNextVideo();\r\n  } else if (msg.type === \"importLocalDirectory\") {\r\n    importLocalFiles(msg);\r\n  } else if (msg.type === \"rotateVideo\") {\r\n    rotateVideo(msg);\r\n  } else if (msg.type === \"queueModeChanged\") {\r\n    queueMode = msg.mode;\r\n  } else if (msg.type === \"thumbnail-saved\") {\r\n    let video = DBDATA.queue.find((v) => v.uuid === msg.uuid);\r\n    if (!video || video.source !== \"local\") {\r\n      console.log(\"Error\", video);\r\n    } else {\r\n      video.localThumbnailPath = msg.filePath;\r\n      await _db_js__WEBPACK_IMPORTED_MODULE_0__.saveVideos(video);\r\n    }\r\n  } else if (msg.type === \"videoRotated\") {\r\n    rotateVideo();\r\n  } else if (msg.type === \"menuRadio\" && msg.subtype === \"Layout\") {\r\n    activateTab(msg.value);\r\n  }\r\n});\r\n\r\nasync function exportDB() {\r\n  const playlists = await _db_js__WEBPACK_IMPORTED_MODULE_0__.loadPlaylists();\r\n  const videos = await _db_js__WEBPACK_IMPORTED_MODULE_0__.loadVideos();\r\n  const log = await _db_js__WEBPACK_IMPORTED_MODULE_0__.getLastNLogs(MAXLOGDUMP);\r\n  const exportData = {\r\n    version: _db_js__WEBPACK_IMPORTED_MODULE_0__.VERSION,\r\n    playlists,\r\n    videos,\r\n    log,\r\n  };\r\n\r\n  const blob = new Blob([JSON.stringify(exportData, null, 2)], {\r\n    type: \"application/json\",\r\n  });\r\n  const url = URL.createObjectURL(blob);\r\n\r\n  const a = document.createElement(\"a\");\r\n  a.href = url;\r\n  const timestamp = new Date().toISOString().replace(/[:.]/g, \"-\");\r\n  a.download = `deja-queue-export-${profile}-${timestamp}.json`;\r\n  document.body.appendChild(a);\r\n  a.click();\r\n  document.body.removeChild(a);\r\n\r\n  URL.revokeObjectURL(url);\r\n}\r\n\r\nasync function importDB(file) {\r\n  console.log(\"Importing DB from file:\", file);\r\n  const text = await window.electronAPI.readFile(file);\r\n  const data = JSON.parse(text);\r\n  await _db_js__WEBPACK_IMPORTED_MODULE_0__.deleteDB();\r\n  if (data?.version !== 4) {\r\n    const videoMap = new Map();\r\n    for (let v of data.videos) {\r\n      // rename id to foreignKey\r\n      v.foreignKey = v.id;\r\n      delete v.id;\r\n      v.uuid = _db_js__WEBPACK_IMPORTED_MODULE_0__.uuidv4();\r\n      v.source = \"youtube\";\r\n\r\n      videoMap.set(v.foreignKey, v.uuid);\r\n    }\r\n    for (let p of data.playlists) {\r\n      // rename id to foreignKey\r\n      p.foreignKey = p.id;\r\n      delete p.id;\r\n      p.uuid = _db_js__WEBPACK_IMPORTED_MODULE_0__.uuidv4();\r\n      p.source = \"youtube\";\r\n\r\n      // remap videoIds to video UUIDs\r\n      p.videoUuids = p.videoIds.map((fk) => videoMap.get(fk)).filter(Boolean);\r\n      delete p.videoIds;\r\n    }\r\n    data.log = [];\r\n  }\r\n  await saveVideos(data.videos); // only replaces each id with new content\r\n  await savePlaylists(data.playlists); // only replaces each id with new content\r\n  await _db_js__WEBPACK_IMPORTED_MODULE_0__.saveLog(data.log);\r\n  console.log(\"Videos imported successfully\");\r\n}\r\n\r\nasync function deleteDB() {\r\n  const confirmed = window.confirm(\r\n    \"Are you sure you want to delete the database? This cannot be undone.\"\r\n  );\r\n  if (!confirmed) return; // user cancelled\r\n  await _db_js__WEBPACK_IMPORTED_MODULE_0__.deleteDB();\r\n  alert(\"Database deleted. Please reload the page.\");\r\n}\r\n\r\nfunction getNestedValue(obj, path) {\r\n  return path.split(\".\").reduce((o, key) => (o ? o[key] : undefined), obj);\r\n}\r\n\r\nlet tabulatorDB = null;\r\nfunction setGlobalSearch(myTabulatorTable, value) {\r\n  const t0 = performance.now();\r\n  let terms = value.toLowerCase().split(\" \");\r\n  let fields = myTabulatorTable\r\n    .getColumns()\r\n    .map((col) => col.getDefinition().field)\r\n    .filter((field) => field != null);\r\n  myTabulatorTable.setFilter((data) => {\r\n    return terms.every((term) =>\r\n      fields.some((field) => {\r\n        const val = getNestedValue(data, field);\r\n        return val && val.toString().toLowerCase().includes(term);\r\n      })\r\n    );\r\n  });\r\n  const t1 = performance.now();\r\n  console.log(`GlobalSearch took ${(t1 - t0).toFixed(0)} ms`);\r\n}\r\n\r\nconst dbFilterEl = document.getElementById(\"dbFilter\");\r\ndbFilterEl.addEventListener(\r\n  \"input\",\r\n  debounce((e) => {\r\n    setGlobalSearch(tabulatorDB, e.target.value);\r\n  }, 300) // 300ms debounce\r\n);\r\n\r\nasync function renderDB(queue) {\r\n  queue = queue.filter((item) => item.type != \"playlist\");\r\n  let tableColumns = getTableColumns(true);\r\n  let columns = [\r\n    tableColumns.thumb,\r\n    tableColumns.title,\r\n    tableColumns.track,\r\n    tableColumns.tags,\r\n    tableColumns.dur,\r\n    tableColumns.lastPlayed,\r\n    tableColumns.due,\r\n    tableColumns.playCnt,\r\n    tableColumns.rating,\r\n    tableColumns.interval,\r\n    tableColumns.score,\r\n    tableColumns.delay,\r\n    tableColumns.errCnt,\r\n    tableColumns.dup,\r\n    tableColumns.channel,\r\n    tableColumns.foreignKey,\r\n    tableColumns.source,\r\n  ];\r\n\r\n  columns.map((c) => {\r\n    c.headerWordWrap = false;\r\n  });\r\n\r\n  if (tabulatorDB) {\r\n    tabulatorDB.replaceData(queue);\r\n    return;\r\n  }\r\n\r\n  tabulatorDB = new tabulator_tables__WEBPACK_IMPORTED_MODULE_2__.TabulatorFull(\"#database-grid\", {\r\n    ...baseTabulatorOptions,\r\n    data: queue,\r\n    columns: columns,\r\n    custom: { current: false }, // custom property\r\n    height: \"100%\",\r\n    width: \"100%\",\r\n    rowHeight: COMPACT_TABLE_HEIGHT,\r\n    movableColumns: true,\r\n  });\r\n  tabulatorDB.on(\"headerContext\", (event) => {\r\n    headerMenu(event, tabulatorDB);\r\n  });\r\n}\r\n\r\nfunction calcStringSimilarity(queue) {\r\n  let list = [];\r\n  for (let a of queue) {\r\n    for (let b of queue) {\r\n      if (a === b) continue;\r\n      const similarityScore = stringSimilarity.compareTwoStrings(\r\n        a.yt?.snippet?.title,\r\n        b.yt?.snippet?.title\r\n      );\r\n      list.push({ similarityScore, a, b });\r\n    }\r\n  }\r\n  list.sort((a, b) => b.similarityScore - a.similarityScore);\r\n  let n = 0;\r\n  for (let ss of list) {\r\n    console.log(\r\n      ss.similarityScore,\r\n      ss.a.yt?.snippet?.title,\r\n      ss.b.yt?.snippet?.title\r\n    );\r\n    n++;\r\n    if (n > 100) break;\r\n  }\r\n}\r\n\r\nfunction debounce(fn, delay = 300) {\r\n  let timeoutId;\r\n  return (...args) => {\r\n    clearTimeout(timeoutId);\r\n    timeoutId = setTimeout(() => {\r\n      fn(...args);\r\n    }, delay);\r\n  };\r\n}\r\n\r\nlet playlistsTabulator = null;\r\nconst plFilterEl = document.getElementById(\"plFilter\");\r\nplFilterEl.addEventListener(\r\n  \"input\",\r\n  debounce((e) => {\r\n    setGlobalSearch(playlistsTabulator, e.target.value);\r\n  }, 300) // 300ms debounce\r\n);\r\n\r\nfunction headerMenu(event, tables) {\r\n  event.preventDefault();\r\n\r\n  const menuItems = [];\r\n  const columns = tables.getColumns();\r\n\r\n  columns.forEach((column) => {\r\n    const labelSpan = document.createElement(\"span\");\r\n    labelSpan.classList.add(\"tabulator\");\r\n    const updateLabel = () => {\r\n      labelSpan.textContent =\r\n        (column.isVisible() ? \" \" : \" \") + column.getDefinition().title;\r\n    };\r\n    updateLabel();\r\n\r\n    menuItems.push({\r\n      label: labelSpan,\r\n      action: function (event) {\r\n        event.stopPropagation();\r\n        column.toggle();\r\n        updateLabel();\r\n      },\r\n    });\r\n  });\r\n  const renderMenu = () => {\r\n    // Remove existing menu\r\n    const existingMenu = document.querySelector(\"#tab-menu\");\r\n    if (existingMenu) existingMenu.remove();\r\n\r\n    const menuDiv = document.createElement(\"div\");\r\n    menuDiv.id = \"tab-menu\";\r\n    menuDiv.style.position = \"absolute\";\r\n    menuDiv.style.top = event.pageY + \"px\";\r\n    menuDiv.style.left = event.pageX + \"px\";\r\n\r\n    menuItems.forEach((item) => {\r\n      const itemDiv = document.createElement(\"div\");\r\n      itemDiv.appendChild(item.label);\r\n      itemDiv.addEventListener(\"click\", (ev) => {\r\n        item.action(ev);\r\n      });\r\n      menuDiv.appendChild(itemDiv);\r\n    });\r\n\r\n    document.body.appendChild(menuDiv);\r\n\r\n    const removeMenu = () => {\r\n      menuDiv.remove();\r\n      document.removeEventListener(\"click\", removeMenu);\r\n    };\r\n    setTimeout(() => document.addEventListener(\"click\", removeMenu), 0);\r\n  };\r\n  renderMenu();\r\n}\r\n\r\nasync function renderPlaylists() {\r\n  let table2StyleColumns = getTableColumns(true);\r\n  let columns = [\r\n    table2StyleColumns.dataTree,\r\n    {\r\n      title: \"Thumb\",\r\n      field: \"thumbnailUrl\",\r\n      formatter: \"image\",\r\n      formatterParams: {\r\n        objectFit: \"contain\",\r\n      },\r\n      cellClick: async function (e, cell) {\r\n        const item = cell.getRow().getData();\r\n        moveVideoToFront(item.uuid);\r\n        await renderQueue();\r\n        showToast(\"Added to front of queue\");\r\n      },\r\n      hozAlign: \"center\",\r\n      vertAlign: \"center\",\r\n      width: COMPACT_THUMB_WIDTH,\r\n    },\r\n    table2StyleColumns.title,\r\n    table2StyleColumns.track,\r\n    table2StyleColumns.tags,\r\n    table2StyleColumns.dur,\r\n    table2StyleColumns.lastPlayed,\r\n    table2StyleColumns.due,\r\n    table2StyleColumns.playCnt,\r\n    table2StyleColumns.PL_channel,\r\n    table2StyleColumns.dateAdded,\r\n    table2StyleColumns.rating,\r\n    table2StyleColumns.interval,\r\n    table2StyleColumns.score,\r\n    table2StyleColumns.errCnt,\r\n    // TODO: Add back ability to show the actual ID.\r\n    // { title: \"ID\", field: \"id_fake\", hozAlign: \"left\", width: 20 },\r\n    {\r\n      title: \"Act\",\r\n      field: \"act\", // fake field\r\n      formatter: (cell) => {\r\n        let data = cell.getRow().getData();\r\n        return data.type == \"playlist\" ? \"\" : \"\";\r\n      },\r\n      cellClick: async (e, cell) => {\r\n        let data = cell.getRow().getData();\r\n        if (data.type == \"playlist\") {\r\n          if (confirm(`Delete this playlist? ${data.title}`)) {\r\n            await _db_js__WEBPACK_IMPORTED_MODULE_0__.deletePlaylist(data.uuid);\r\n            cell.getRow().delete();\r\n          }\r\n        } else {\r\n          const playlist = cell.getRow().getTreeParent().getData();\r\n          const count = playlist.videoUuids.filter(\r\n            (uuid) => uuid === data.uuid\r\n          ).length;\r\n          if (count > 1) {\r\n            if (confirm(`Remove dups of this video? ${data.title}`)) {\r\n              let seen = false;\r\n              playlist.videoUuids = playlist.videoUuids.filter((uuid) => {\r\n                if (uuid !== data.uuid) return true; // keep other IDs\r\n                if (!seen) {\r\n                  seen = true; // keep the first occurrence\r\n                  return true;\r\n                }\r\n                return false; // remove subsequent duplicates\r\n              });\r\n              seen = false;\r\n              for (const siblingRow of cell\r\n                .getRow()\r\n                .getTreeParent()\r\n                .getTreeChildren()) {\r\n                let rowData = siblingRow.getData();\r\n                if (rowData.uuid !== data.uuid) continue;\r\n                if (!seen) {\r\n                  seen = true;\r\n                  continue;\r\n                }\r\n                siblingRow.delete();\r\n              }\r\n              await savePlaylists(playlist);\r\n            }\r\n          } else {\r\n            if (confirm(`Remove this video from playlist? ${data.title}`)) {\r\n              playlist.videoUuids = playlist.videoUuids.filter(\r\n                (vuuid) => vuuid !== data.uuid\r\n              );\r\n              cell.getRow().delete();\r\n              await savePlaylists(playlist);\r\n            }\r\n          }\r\n        }\r\n      },\r\n      hozAlign: \"center\",\r\n    },\r\n  ];\r\n\r\n  if (playlistsTabulator) {\r\n    const expandedIds = [];\r\n    playlistsTabulator.getData().forEach((data) => {\r\n      const row = playlistsTabulator.getRow(data.uuid);\r\n      if (row && row.isTreeExpanded()) {\r\n        expandedIds.push(data.uuid);\r\n      }\r\n    });\r\n    playlistsTabulator.replaceData(DBDATA.playlists).then(() => {\r\n      expandedIds.forEach((uuid) => {\r\n        const row = playlistsTabulator.getRow(uuid);\r\n        if (row) row.treeExpand();\r\n      });\r\n    });\r\n    return playlistsTabulator;\r\n  }\r\n\r\n  playlistsTabulator = new tabulator_tables__WEBPACK_IMPORTED_MODULE_2__.TabulatorFull(\"#playlists-grid\", {\r\n    ...baseTabulatorOptions,\r\n    data: DBDATA.playlists,\r\n    columns: columns,\r\n    rowHeight: COMPACT_TABLE_HEIGHT,\r\n    dataTree: true,\r\n    dataTreeFilter: false,\r\n    height: \"100%\",\r\n    width: \"100%\",\r\n  });\r\n  playlistsTabulator.on(\"headerContext\", (event) => {\r\n    headerMenu(event, playlistsTabulator);\r\n  });\r\n}\r\nasync function moveVideoToFront(uuid) {\r\n  const idx = DBDATA.queue.findIndex((v) => v.uuid === uuid);\r\n  if (idx === -1) {\r\n    console.log(\"Error could not find \", uuid);\r\n    return;\r\n  }\r\n  // If already idx0, do nothing\r\n  if (idx == 0) {\r\n    return;\r\n  }\r\n  // If idx1, skip idx0 and play this\r\n  if (idx == 1) {\r\n    logAndPlayNext(\"skip\", { skipWholeList: true });\r\n  }\r\n  // Otherwise, make new idx1\r\n  const [video] = DBDATA.queue.splice(idx, 1); // cut the 1 video from idx\r\n  DBDATA.queue.splice(1, 0, video); // insert just behind current\r\n}\r\nfunction activateTab(targetId) {\r\n  if (targetId == \"Video\") {\r\n    targetId = \"youtube-full\";\r\n  }\r\n  const contents = document.querySelectorAll(\".tab-content\");\r\n  contents.forEach((c) => c.classList.remove(\"active\"));\r\n  const target = document.querySelector(`#${targetId}`);\r\n  if (target) target.classList.add(\"active\");\r\n\r\n  if (targetId !== \"youtube-full\") {\r\n    document.querySelector(\"#youtube\").classList.add(\"active\");\r\n  }\r\n  sendMessage({ type: \"tab-button\", targetId });\r\n}\r\n\r\nactivateTab(window.electronAPI.get(\"Layout\", \"Video\"));\r\n\r\nfunction trimYoutubeFields(obj) {\r\n  if (Array.isArray(obj)) {\r\n    return obj.map(trimYoutubeFields);\r\n  } else if (obj && typeof obj === \"object\") {\r\n    const newObj = {};\r\n    for (const [key, value] of Object.entries(obj)) {\r\n      if (key === \"description\" || key === \"regionRestriction\") {\r\n        continue; // skip all \"description\" fields\r\n      }\r\n      // Thumbnails: keep only \"default\"\r\n      if (key === \"thumbnails\" && value && typeof value === \"object\") {\r\n        if (value.default) {\r\n          newObj[key] = { default: trimYoutubeFields(value.default) };\r\n        }\r\n        continue; // skip other keys\r\n      }\r\n      newObj[key] = trimYoutubeFields(value);\r\n    }\r\n    return newObj;\r\n  }\r\n  return obj;\r\n}\r\n\r\nfunction trimLocalFields(obj) {\r\n  if (Array.isArray(obj)) {\r\n    obj.forEach(trimLocalFields);\r\n  } else {\r\n    if (obj.source == \"local\") {\r\n      obj.title = obj.title.split(/[/\\\\]/).pop();\r\n    }\r\n  }\r\n}\r\n\r\nfunction dbCheck() {\r\n  let error = false;\r\n  DBDATA.queue.forEach((v) => {\r\n    if (v.thumbnailUrl) {\r\n      console.log(\"ERROR\", v);\r\n      error = true;\r\n    }\r\n  });\r\n  if (error) {\r\n    alert(\"DB integrity check fail. Check dev console.\");\r\n  }\r\n}\r\n\r\nasync function updateTabulator(tabulator, items) {\r\n  if (!tabulator) {\r\n    return;\r\n  }\r\n  function walk(rows) {\r\n    for (const row of rows) {\r\n      let data = row.getData();\r\n      let item = items.find((item) => item.uuid == data.uuid);\r\n      if (item) {\r\n        row.reformat();\r\n      }\r\n      const children = row.getTreeChildren?.();\r\n      if (children?.length) {\r\n        walk(children);\r\n      }\r\n    }\r\n  }\r\n  walk(tabulator.getRows());\r\n}\r\n\r\nasync function rerenderAll(items = []) {\r\n  if (items.length > 0) {\r\n    await updateTabulator(playlistsTabulator, items);\r\n    await updateTabulator(tabulatorQueue, items);\r\n    await updateTabulator(tabulatorDB, items);\r\n    return;\r\n  }\r\n  if (playlistsTabulator) {\r\n    await renderPlaylists();\r\n  }\r\n  if (tabulatorQueue) {\r\n    await renderQueue();\r\n  }\r\n  if (tabulatorDB) {\r\n    await renderDB(DBDATA.queue);\r\n  }\r\n}\r\n\r\nasync function saveVideos(videos) {\r\n  videos = Array.isArray(videos) ? videos : [videos];\r\n  await _db_js__WEBPACK_IMPORTED_MODULE_0__.saveVideos(videos);\r\n  await rerenderAll(videos);\r\n}\r\n\r\nasync function savePlaylists(playlists) {\r\n  playlists = Array.isArray(playlists) ? playlists : [playlists];\r\n  await _db_js__WEBPACK_IMPORTED_MODULE_0__.savePlaylists(playlists);\r\n  await rerenderAll(playlists);\r\n}\r\n\r\n// Initial load\r\n(async () => {\r\n  DBDATA.queue = await _db_js__WEBPACK_IMPORTED_MODULE_0__.loadVideos();\r\n  DBDATA.playlists = await _db_js__WEBPACK_IMPORTED_MODULE_0__.loadPlaylists();\r\n  dbCheck();\r\n  // DBDATA.queue = trimYoutubeFields(DBDATA.queue);\r\n  // trimLocalFields(DBDATA.queue); // This one mutates, and the other one doesn't? ugh\r\n  // DBDATA.playlists = trimYoutubeFields(DBDATA.playlists);\r\n  DBDATA.queue = _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsVideo(DBDATA.queue);\r\n  DBDATA.queue.sort((a, b) => b.score - a.score);\r\n  DBDATA.playlists = _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsPL(DBDATA.playlists, DBDATA.queue);\r\n  DBDATA.playlists.sort((a, b) => b.score - a.score);\r\n  const playlistCopies = DBDATA.playlists.map((item) => {\r\n    const copy = _utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapItem(item);\r\n    // copy.playlistRef = item;\r\n    return _utils_js__WEBPACK_IMPORTED_MODULE_1__.addComputedFieldsPL(copy, DBDATA.queue);\r\n  });\r\n  if (queueMode == \"playlist\") {\r\n    DBDATA.queue.unshift(...playlistCopies);\r\n  } else {\r\n    DBDATA.queue.push(...playlistCopies);\r\n  }\r\n  await renderDB(DBDATA.queue);\r\n  await renderPlaylists();\r\n  await renderQueue();\r\n  const navType = performance.getEntriesByType(\"navigation\")[0]?.type;\r\n  if (navType !== \"reload\") {\r\n    playNextVideo(0, { cueVideo: true });\r\n  }\r\n})();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvb3B0aW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUE4QjtBQUNNO0FBQzBCO0FBQ1Q7QUFDckQ7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxQkFBcUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixxQkFBcUI7QUFDM0M7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHFCQUFxQjtBQUN2QyxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixTQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxXQUFXLE1BQU0sVUFBVTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsV0FBVyxNQUFNLFFBQVE7QUFDOUQsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLFdBQVc7QUFDekQ7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixrQkFBa0I7QUFDNUMsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx5Q0FBeUM7QUFDdkQsY0FBYywwQ0FBMEM7QUFDeEQsY0FBYyxxQ0FBcUM7QUFDbkQsY0FBYyxzQ0FBc0M7QUFDcEQsY0FBYyx3Q0FBd0M7QUFDdEQsWUFBWSxHQUFHLEdBQUcsR0FBRyxHQUFHLElBQUksRUFBRSxHQUFHLEdBQUcsR0FBRztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHlDQUF5QztBQUMxRDtBQUNBLDhCQUE4QixHQUFHO0FBQ2pDLEdBQUc7QUFDSDtBQUNBLHlDQUF5QyxHQUFHO0FBQzVDO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSwwREFBeUI7QUFDL0I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsZ0RBQWU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDZCQUE2QjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsK0NBQWM7QUFDakM7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0NBQWMsVUFBVSw2QkFBNkI7QUFDN0Q7QUFDQSxNQUFNO0FBQ04sd0JBQXdCLCtDQUFjLFVBQVUsMkJBQTJCO0FBQzNFO0FBQ0E7QUFDQSxLQUFLLDZCQUE2QjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxVQUFVO0FBQ1YsbUNBQW1DLHFCQUFxQjtBQUN4RCxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaLHNCQUFzQix1QkFBdUIsR0FBRyxZQUFZO0FBQzVEO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLHFEQUFvQjtBQUNuQyxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBLFlBQVk7QUFDWixrQ0FBa0MsVUFBVTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDJEQUFTO0FBQzNCO0FBQ0E7QUFDQSxjQUFjLFdBQVc7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHNCQUFzQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixNQUFNLElBQUksMEJBQTBCLEVBQUUsS0FBSztBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdHQUF3RyxpQkFBaUIsT0FBTyxvQkFBb0I7QUFDcEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSw2REFBNEI7QUFDaEM7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0dBQXNHLG1CQUFtQixPQUFPLG9CQUFvQjtBQUNwSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixvRUFBbUM7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxZQUFZLDBDQUFTO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsY0FBYyxjQUFjLG1CQUFtQixPQUFPLG9CQUFvQjtBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELDBDQUFTO0FBQ3BFO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNkRBQTRCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSwwREFBeUI7QUFDM0I7QUFDQTtBQUNBLHVCQUF1Qiw0QkFBNEIsVUFBVSxrQkFBa0I7QUFDL0U7QUFDQTtBQUNBLHVCQUF1Qiw0QkFBNEIsVUFBVSxrQkFBa0I7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsK0NBQWM7QUFDM0IsU0FBUywwREFBeUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxjQUFjLDBDQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwwQ0FBUztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksNkRBQTRCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsOEJBQThCLHNCQUFzQjtBQUNwRDtBQUNBLENBQUM7QUFDRDtBQUNBLDhCQUE4Qix1QkFBdUI7QUFDckQ7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxnQkFBZ0Isb0JBQW9CO0FBQ3BDLENBQUM7QUFDRDtBQUNBLGdCQUFnQixxQkFBcUI7QUFDckMsQ0FBQztBQUNEO0FBQ0EsZ0JBQWdCLHFCQUFxQjtBQUNyQyxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsZ0RBQWU7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHNCQUFzQixFQUFFLHNCQUFzQjtBQUN2RSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssVUFBVTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsTUFBTTtBQUNOLGVBQWU7QUFDZjtBQUNBLElBQUk7QUFDSjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIsZ0JBQWdCLGdEQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLFFBQVEsMkNBQVU7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osNEJBQTRCLFdBQVcsWUFBWSxtQkFBbUI7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSix5QkFBeUIsMkNBQTJDO0FBQ3BFLElBQUk7QUFDSiwrQkFBK0IsOENBQThDO0FBQzdFLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxZQUFZLDhDQUFhO0FBQ3pCO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLDBCQUEwQixpREFBZ0I7QUFDMUMsdUJBQXVCLDhDQUFhO0FBQ3BDLG9CQUFvQixnREFBZTtBQUNuQztBQUNBLGFBQWEsMkNBQVU7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxRQUFRLEdBQUcsVUFBVTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw0Q0FBVztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDBDQUFTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDBDQUFTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsdUNBQXVDO0FBQ3ZDLFFBQVEsMkNBQVU7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUIsUUFBUSw0Q0FBVztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0EsbUNBQW1DLHNCQUFzQjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJEQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLGNBQWMsZ0JBQWdCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix1QkFBdUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsNERBQTREO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsV0FBVztBQUMxRCxrQkFBa0Isa0RBQWlCO0FBQ25DO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxXQUFXO0FBQ2pFO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQ7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaLDREQUE0RCxXQUFXO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMkRBQVM7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHFCQUFxQjtBQUNsRDtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxTQUFTO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsOEJBQThCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOENBQWE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaURBQWdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsOENBQWE7QUFDcEMsMkJBQTJCLGlEQUFnQjtBQUMzQztBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0EsaUJBQWlCLDZEQUE0QjtBQUM3QztBQUNBLHFCQUFxQiwwREFBeUI7QUFDOUM7QUFDQTtBQUNBLGlCQUFpQiwrQ0FBYztBQUMvQjtBQUNBLFdBQVcsMERBQXlCO0FBQ3BDLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGdCQUFnQjtBQUN2QztBQUNBLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vc3JjL29wdGlvbnMuanM/MmQ5OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBkYiBmcm9tIFwiLi9kYi5qc1wiO1xyXG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tIFwiLi91dGlscy5qc1wiO1xyXG5pbXBvcnQgeyBUYWJ1bGF0b3JGdWxsIGFzIFRhYnVsYXRvciB9IGZyb20gXCJ0YWJ1bGF0b3ItdGFibGVzXCI7XHJcbmltcG9ydCBcInRhYnVsYXRvci10YWJsZXMvZGlzdC9jc3MvdGFidWxhdG9yLm1pbi5jc3NcIjtcclxuXHJcbmxldCBEQkRBVEEgPSB7IHF1ZXVlOiBbXSwgZmlsdGVyZWQ6IFtdIH07XHJcbmxldCBMSVNUTEVOID0gMzA7XHJcbmxldCBNQVhMT0dEVU1QID0gOTk5OTk7XHJcbmxldCBERUZBVUxUX1JBVElORyA9IDcuNTtcclxubGV0IE1BWF9FUlJTID0gNTsgLy8gQWZ0ZXIgdGhpcyBtYW55IGVycm9ycyB0cmVhdCBpdCBhcyBiYWRcclxuXHJcbmxldCBDT01QQUNUX1RBQkxFX0hFSUdIVCA9IDQwO1xyXG5sZXQgTk9STUFMX1RBQkxFX0hFSUdIVCA9IDY4O1xyXG5sZXQgQ09NUEFDVF9USFVNQl9XSURUSCA9IDYwO1xyXG5sZXQgTk9STUFMX1RIVU1CX1dJRFRIID0gOTA7XHJcbmxldCBUSVRMRV9XSURUSCA9IDEyMDtcclxuY29uc3QgREVGQVVMVF9USFVNQiA9IFwiLi9mYXZpY29uLmljb1wiO1xyXG5cclxubGV0IGVudiA9IHt9O1xyXG5hc3luYyBmdW5jdGlvbiBsb2FkRW52MigpIHtcclxuICBlbnYueW91dHViZV9hcGlfa2V5ID0gd2luZG93LmVsZWN0cm9uQVBJLmdldChcInlvdXR1YmVfYXBpX2tleVwiKTtcclxuICBpZiAoZW52LnlvdXR1YmVfYXBpX2tleSkge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgc2VuZE1lc3NhZ2UoeyB0eXBlOiBcImhpZGVZb3V0dWJlXCIgfSk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChlKSA9PiB7XHJcbiAgICBjb25zdCBsaW5rID0gZS50YXJnZXQuY2xvc2VzdChcImEuZXh0ZXJuYWwtbGlua1wiKTtcclxuICAgIGlmICghbGluaykgcmV0dXJuO1xyXG5cclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGF3YWl0IHdpbmRvdy5lbGVjdHJvbkFQSS5vcGVuRXh0ZXJuYWwobGluay5ocmVmKTtcclxuICB9KTtcclxuXHJcbiAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtYXBpLWtleS1kaWFsb2dcIik7XHJcbiAgY29uc3QgZm9ybSA9IGRpYWxvZy5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcclxuICBjb25zdCBpbnB1dCA9IGZvcm0ucXVlcnlTZWxlY3RvcihcImlucHV0XCIpO1xyXG5cclxuICBkaWFsb2cuc2hvd01vZGFsKCk7XHJcbiAgLy8gTWFrZSBpdCBoYXJkZXIgdG8gc2tpcCB0aGlzLCBidXQgbm90IGltcG9zc2libGU/XHJcbiAgbGV0IGRpc21pc3NhYmxlID0gZmFsc2U7XHJcbiAgaWYgKGRpc21pc3NhYmxlKSB7XHJcbiAgICBkaWFsb2cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLnRhcmdldCA9PT0gZGlhbG9nKSB7XHJcbiAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgICAgc2VuZE1lc3NhZ2UoeyB0eXBlOiBcInNob3dZb3V0dWJlXCIgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgYXN5bmMgKGUpID0+IHtcclxuICAgIGVudi55b3V0dWJlX2FwaV9rZXkgPSBpbnB1dC52YWx1ZS50cmltKCk7XHJcbiAgICBpZiAoZW52LnlvdXR1YmVfYXBpX2tleSkge1xyXG4gICAgICB3aW5kb3cuZWxlY3Ryb25BUEkuc2V0KFwieW91dHViZV9hcGlfa2V5XCIsIGVudi55b3V0dWJlX2FwaV9rZXkpO1xyXG4gICAgfVxyXG4gICAgc2VuZE1lc3NhZ2UoeyB0eXBlOiBcInNob3dZb3V0dWJlXCIgfSk7XHJcbiAgfSk7XHJcbn1cclxubG9hZEVudjIoKTtcclxuXHJcbmNvbnN0IGZhc3RGb3J3YXJkQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmYXN0Rm9yd2FyZFwiKTtcclxuY29uc3Qgc2tpcEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2tpcFwiKTtcclxuY29uc3QgZGVsYXlCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlbGF5XCIpO1xyXG5jb25zdCBwYXVzZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGF1c2VcIik7XHJcbmNvbnN0IHBsYXlCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXlcIik7XHJcbmNvbnN0IHF1ZXVlRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInF1ZXVlXCIpO1xyXG5jb25zdCBsb2dFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9nXCIpO1xyXG5cclxubGV0IHF1ZXVlTW9kZSA9IHdpbmRvdy5lbGVjdHJvbkFQSS5nZXQoXCJxdWV1ZU1vZGVcIiwgXCJWaWRlb1wiKTtcclxubGV0IHByb2ZpbGUgPSB3aW5kb3cuZWxlY3Ryb25BUEkuZ2V0KFwicHJvZmlsZVwiKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURpdmlkZXIoZGl2RWwsIHZlcnQpIHtcclxuICBsZXQgaXNEcmFnZ2luZyA9IGZhbHNlO1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRpdkVsLnBhcmVudEVsZW1lbnQ7XHJcbiAgY29uc3QgZGl2U2l6ZUtleSA9IGAke2RpdkVsLmlkfS1zaXplYDtcclxuICBjb25zdCBzYXZlZFNpemUgPSB3aW5kb3cuZWxlY3Ryb25BUEkuZ2V0KGRpdlNpemVLZXkpO1xyXG5cclxuICBpZiAoc2F2ZWRTaXplKSB7XHJcbiAgICBjb250YWluZXIuc3R5bGUuc2V0UHJvcGVydHkoYC0tJHtkaXZTaXplS2V5fWAsIGAke3NhdmVkU2l6ZX1weGApO1xyXG4gIH1cclxuXHJcbiAgZGl2RWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xyXG4gICAgaXNEcmFnZ2luZyA9IHRydWU7XHJcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9IHZlcnQgPyBcInJvdy1yZXNpemVcIiA6IFwiY29sLXJlc2l6ZVwiO1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIH0pO1xyXG5cclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCAoZSkgPT4ge1xyXG4gICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47XHJcbiAgICBjb25zdCByZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgbGV0IG5ld1NpemUgPSB2ZXJ0ID8gZS5jbGllbnRZIC0gcmVjdC50b3AgOiBlLmNsaWVudFggLSByZWN0LmxlZnQ7XHJcblxyXG4gICAgLy8gTGltaXQgcmVzaXppbmcgcmFuZ2VcclxuICAgIGNvbnN0IG1pblNpemUgPSAyNTA7XHJcbiAgICBjb25zdCBtYXhTaXplID0gMTAwMDtcclxuICAgIG5ld1NpemUgPSBNYXRoLm1pbihNYXRoLm1heChuZXdTaXplLCBtaW5TaXplKSwgbWF4U2l6ZSk7XHJcbiAgICBjb250YWluZXIuc3R5bGUuc2V0UHJvcGVydHkoYC0tJHtkaXZTaXplS2V5fWAsIGAke25ld1NpemV9cHhgKTtcclxuICB9KTtcclxuXHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsICgpID0+IHtcclxuICAgIGlmIChpc0RyYWdnaW5nKSB7XHJcbiAgICAgIGlzRHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSBcImRlZmF1bHRcIjtcclxuXHJcbiAgICAgIGNvbnN0IGN1cnJlbnRTaXplID0gcGFyc2VGbG9hdChcclxuICAgICAgICBjb250YWluZXIuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShgLS0ke2RpdlNpemVLZXl9YClcclxuICAgICAgKTtcclxuICAgICAgd2luZG93LmVsZWN0cm9uQVBJLnNldChkaXZTaXplS2V5LCBjdXJyZW50U2l6ZSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5teS1kaXZpZGVyXCIpLmZvckVhY2goKGRpdkVsKSA9PiB7XHJcbiAgY29uc3QgaXNWZXJ0aWNhbCA9IGRpdkVsLmNsYXNzTGlzdC5jb250YWlucyhcInZlcnRpY2FsXCIpO1xyXG4gIGhhbmRsZURpdmlkZXIoZGl2RWwsIGlzVmVydGljYWwpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHlvdXR1YmVEaXYoKSB7XHJcbiAgcmV0dXJuIChcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWN0aXZlI3lvdXR1YmUtZnVsbFwiKSB8fFxyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ5b3V0dWJlXCIpXHJcbiAgKTtcclxufVxyXG5cclxuLy8gVHJhY2sgdGhlIGN1cnJlbnRseSBhY3RpdmUgZGl2XHJcbmxldCBhY3RpdmVZb3V0dWJlRGl2O1xyXG5cclxuLy8gT2JzZXJ2ZSBjaGFuZ2VzIGluIGNsYXNzIGF0dHJpYnV0ZXNcclxuY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zTGlzdCkgPT4ge1xyXG4gIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zTGlzdCkge1xyXG4gICAgaWYgKG11dGF0aW9uLnR5cGUgIT09IFwiYXR0cmlidXRlc1wiIHx8IG11dGF0aW9uLmF0dHJpYnV0ZU5hbWUgIT09IFwiY2xhc3NcIikge1xyXG4gICAgICBjb250aW51ZTtcclxuICAgIH1cclxuICAgIGNvbnN0IHRhcmdldCA9IG11dGF0aW9uLnRhcmdldDtcclxuICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlXCIpICYmIHRhcmdldCAhPT0gYWN0aXZlWW91dHViZURpdikge1xyXG4gICAgICBhY3RpdmVZb3V0dWJlRGl2ID0geW91dHViZURpdigpO1xyXG4gICAgICAvLyBTdGFydCBvYnNlcnZpbmcgdGhlIG5ldyBhY3RpdmUgZGl2XHJcbiAgICAgIHN0YXJ0UmVzaXplT2JzZXJ2ZXIoYWN0aXZlWW91dHViZURpdik7XHJcbiAgICB9XHJcbiAgfVxyXG59KTtcclxuXHJcbmxldCByZXNpemVPYnNlcnZlciA9IG51bGw7XHJcblxyXG5mdW5jdGlvbiBzdGFydFJlc2l6ZU9ic2VydmVyKGRpdikge1xyXG4gIC8vIERpc2Nvbm5lY3QgcHJldmlvdXMgb2JzZXJ2ZXJcclxuICBpZiAocmVzaXplT2JzZXJ2ZXIpIHJlc2l6ZU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHJcbiAgLy8gQ3JlYXRlIGEgbmV3IFJlc2l6ZU9ic2VydmVyXHJcbiAgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGVudHJpZXMpID0+IHtcclxuICAgIGZvciAobGV0IGVudHJ5IG9mIGVudHJpZXMpIHtcclxuICAgICAgY29uc3QgcmVjdCA9IGVudHJ5LnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgY29uc3QgYm91bmRzID0ge1xyXG4gICAgICAgIHg6IHJlY3QubGVmdCxcclxuICAgICAgICB5OiByZWN0LnRvcCxcclxuICAgICAgICB3aWR0aDogcmVjdC53aWR0aCxcclxuICAgICAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0LFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gU2VuZCBuZXcgc2l6ZSB0byBtYWluIHByb2Nlc3NcclxuICAgICAgZWxlY3Ryb25BUEkuc2VuZEJyb2FkY2FzdCh7XHJcbiAgICAgICAgdHlwZTogXCJkaXYtcmVzaXplXCIsXHJcbiAgICAgICAgYm91bmRzLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgcmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShkaXYpO1xyXG59XHJcblxyXG4vLyBPYnNlcnZlIGFsbCB0YWItY29udGVudCBkaXZzXHJcbi8vIFRPRE86IFNob3VsZCByZWFsbHkgYmUgdGhlIHlvdXR1YmUgZGl2cyBvbmx5XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGFiLWNvbnRlbnRcIikuZm9yRWFjaCgoZGl2KSA9PiB7XHJcbiAgb2JzZXJ2ZXIub2JzZXJ2ZShkaXYsIHsgYXR0cmlidXRlczogdHJ1ZSB9KTtcclxufSk7XHJcblxyXG5jb25zdCB0aGVtZUxpbmsgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRhYnVsYXRvci10aGVtZVwiKTtcclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVRoZW1lKCkge1xyXG4gIGNvbnN0IGlzRGFyayA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKVwiKS5tYXRjaGVzO1xyXG4gIHRoZW1lTGluay5ocmVmID0gaXNEYXJrXHJcbiAgICA/IFwiYXNzZXRzL3RhYnVsYXRvcl9zaXRlX2RhcmsubWluLmNzc1wiXHJcbiAgICA6IFwiYXNzZXRzL3RhYnVsYXRvcl9zaXRlLm1pbi5jc3NcIjtcclxufVxyXG5cclxuLy8gUnVuIG9uIGxvYWRcclxudXBkYXRlVGhlbWUoKTtcclxuXHJcbi8vIExpc3RlbiBmb3IgdXNlciBwcmVmZXJlbmNlIGNoYW5nZXNcclxud2luZG93XHJcbiAgLm1hdGNoTWVkaWEoXCIocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspXCIpXHJcbiAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgdXBkYXRlVGhlbWUpO1xyXG5cclxuZnVuY3Rpb24gZGF0ZTJTdHJpbmcoZCkge1xyXG4gIGxldCB5eSA9IGAke1N0cmluZyhkLmdldEZ1bGxZZWFyKCkpLnBhZFN0YXJ0KDQsIFwiMFwiKX1gO1xyXG4gIGxldCBNTSA9IGAke1N0cmluZyhkLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCBcIjBcIil9YDtcclxuICBsZXQgZGQgPSBgJHtTdHJpbmcoZC5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsIFwiMFwiKX1gO1xyXG4gIGxldCBoaCA9IGAke1N0cmluZyhkLmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsIFwiMFwiKX1gO1xyXG4gIGxldCBtbSA9IGAke1N0cmluZyhkLmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwgXCIwXCIpfWA7XHJcbiAgcmV0dXJuIGAke3l5fS0ke01NfS0ke2RkfSAke2hofToke21tfWA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dUb2FzdChtc2cpIHtcclxuICBsZXQgZHVyYXRpb24gPSA1MDAwO1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9hc3QtY29udGFpbmVyXCIpO1xyXG4gIGNvbnN0IHRvYXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICB0b2FzdC5jbGFzc05hbWUgPSBcInRvYXN0XCI7XHJcbiAgdG9hc3QudGV4dENvbnRlbnQgPSBtc2c7XHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRvYXN0KTtcclxuXHJcbiAgc2V0VGltZW91dCgoKSA9PiB0b2FzdC5yZW1vdmUoKSwgZHVyYXRpb24pO1xyXG59XHJcblxyXG5sZXQgYmFzZVRhYnVsYXRvck9wdGlvbnMgPSB7XHJcbiAgcGVyc2lzdGVuY2U6IHsgY29sdW1uczogW1wid2lkdGhcIiwgXCJ2aXNpYmxlXCIsIFwiZnJvemVuXCJdIH0sXHJcbiAgcGVyc2lzdGVuY2VXcml0ZXJGdW5jOiAoaWQsIHR5cGUsIGRhdGEpID0+IHtcclxuICAgIHdpbmRvdy5lbGVjdHJvbkFQSS5zZXQoYCR7aWR9YCwgZGF0YSk7XHJcbiAgfSxcclxuICBwZXJzaXN0ZW5jZVJlYWRlckZ1bmM6IChpZCwgdHlwZSkgPT4ge1xyXG4gICAgbGV0IGRhdGEgPSB3aW5kb3cuZWxlY3Ryb25BUEkuZ2V0KGAke2lkfWApO1xyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfSxcclxuICBtb3ZhYmxlQ29sdW1uczogdHJ1ZSxcclxuICBjb2x1bW5EZWZhdWx0czoge1xyXG4gICAgaGVhZGVySG96QWxpZ246IFwiY2VudGVyXCIsXHJcbiAgICBob3pBbGlnbjogXCJjZW50ZXJcIixcclxuICAgIHZlcnRBbGlnbjogXCJtaWRkbGVcIixcclxuICB9LFxyXG4gIGluZGV4OiBcInV1aWRcIixcclxuICAvLyByZWFjdGl2ZURhdGE6IHRydWUsXHJcbn07XHJcblxyXG5sZXQgdGFidWxhdG9yQ3VycmVudCA9IG51bGw7XHJcbmxldCB0YWJ1bGF0b3JRdWV1ZSA9IG51bGw7XHJcbmxldCB0YWJ1bGF0b3JMb2cgPSBudWxsO1xyXG5hc3luYyBmdW5jdGlvbiByZW5kZXJRdWV1ZSgpIHtcclxuICBpZiAoREJEQVRBLnF1ZXVlLmxlbmd0aCA9PSAwKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkVtcHR5IERCREFUQS5xdWV1ZSwgbm90aGluZyB0byByZW5kZXJcIik7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIC8vIGNvbnN0IGZpcnN0VmlkZW8gPSBEQkRBVEEucXVldWVbMF07XHJcbiAgLy8gY29uc3QgcmVzdFZpZGVvcyA9IERCREFUQS5xdWV1ZS5zbGljZSgxLCBMSVNUTEVOICsgMSk7XHJcbiAgY29uc3QgcmVzdFZpZGVvcyA9IERCREFUQS5xdWV1ZS5zbGljZSgwLCBMSVNUTEVOKTtcclxuICAvLyB0YWJ1bGF0b3JDdXJyZW50ID0gYXdhaXQgdGFibGUyKFxyXG4gIC8vICAgdGFidWxhdG9yQ3VycmVudCxcclxuICAvLyAgIGN1cnJlbnRFbCxcclxuICAvLyAgIFtmaXJzdFZpZGVvXSxcclxuICAvLyAgIFwiY3VycmVudFwiXHJcbiAgLy8gKTtcclxuXHJcbiAgZnVuY3Rpb24gZmluYWxpemVQbGF5bGlzdChwbGF5bGlzdCwgcGxheWxpc3RDaGlsZHJlbikge1xyXG4gICAgaWYgKHBsYXlsaXN0KSB7XHJcbiAgICAgIHV0aWxzLmFkZENvbXB1dGVkRmllbGRzUEwocGxheWxpc3QsIERCREFUQS5xdWV1ZSk7XHJcbiAgICAgIHBsYXlsaXN0Ll9hbGxDaGlsZHJlbiA9IHBsYXlsaXN0Q2hpbGRyZW47XHJcbiAgICB9XHJcbiAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgcGxheWxpc3RDaGlsZHJlbjogW10gfTtcclxuICB9XHJcblxyXG4gIHRhYnVsYXRvclF1ZXVlID0gYXdhaXQgdGFibGUyKHRhYnVsYXRvclF1ZXVlLCBxdWV1ZUVsLCByZXN0VmlkZW9zLCBcInF1ZXVlXCIpO1xyXG4gIGxldCBsb2cgPSBhd2FpdCBkYi5nZXRMYXN0TkxvZ3MoTElTVExFTik7XHJcbiAgbGV0IGxvZ1ZpZGVvTGlzdCA9IFtdO1xyXG4gIGxldCBwbGF5bGlzdCA9IG51bGw7XHJcbiAgbGV0IHBsYXlsaXN0Q2hpbGRyZW4gPSBbXTtcclxuICBmb3IgKGxldCBlbnRyeSBvZiBsb2cpIHtcclxuICAgIGxldCB2aWRlbyA9IERCREFUQS5xdWV1ZS5maW5kKCh2KSA9PiB2LnV1aWQgPT09IGVudHJ5LnV1aWQpO1xyXG4gICAgaWYgKGVudHJ5LnR5cGUgPT0gXCJwbGF5bGlzdFwiKSB7XHJcbiAgICAgIGlmIChlbnRyeS5wbGF5bGlzdFV1aWQgIT09IHBsYXlsaXN0Py51dWlkKSB7XHJcbiAgICAgICAgKHsgcGxheWxpc3QsIHBsYXlsaXN0Q2hpbGRyZW4gfSA9IGZpbmFsaXplUGxheWxpc3QoXHJcbiAgICAgICAgICBwbGF5bGlzdCxcclxuICAgICAgICAgIHBsYXlsaXN0Q2hpbGRyZW5cclxuICAgICAgICApKTtcclxuICAgICAgICAvLyBNYWtlIG5ldyBwbGF5bGlzdCBjb3B5XHJcbiAgICAgICAgbGV0IG9yaWdQbGF5bGlzdCA9IERCREFUQS5wbGF5bGlzdHMuZmluZChcclxuICAgICAgICAgIChwbCkgPT4gcGwudXVpZCA9PT0gZW50cnkucGxheWxpc3RVdWlkXHJcbiAgICAgICAgKTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcImVudHJ5XCIsIGVudHJ5KTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIm9yaWdQbGF5bGlzdFwiLCBvcmlnUGxheWxpc3QpO1xyXG4gICAgICAgIHBsYXlsaXN0ID0gdXRpbHMud3JhcEl0ZW0ob3JpZ1BsYXlsaXN0LCB7XHJcbiAgICAgICAgICBfY3VycmVudFRyYWNrOiAtMSxcclxuICAgICAgICAgIHZpZGVvVXVpZHM6IFtdLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxvZ1ZpZGVvTGlzdC5wdXNoKHBsYXlsaXN0KTtcclxuICAgICAgfVxyXG4gICAgICBwbGF5bGlzdC52aWRlb1V1aWRzLnB1c2goZW50cnkudXVpZCk7XHJcbiAgICAgIHBsYXlsaXN0Q2hpbGRyZW4ucHVzaChcclxuICAgICAgICB1dGlscy53cmFwSXRlbSh2aWRlbywgeyBlbnRyeSwgX3RyYWNrOiBlbnRyeS5fdHJhY2sgfSlcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxvZ1ZpZGVvTGlzdC5wdXNoKHV0aWxzLndyYXBJdGVtKHZpZGVvLCB7IGVudHJ5LCB0cmFjazogZW50cnkudHJhY2sgfSkpO1xyXG4gICAgfVxyXG4gIH1cclxuICAoeyBwbGF5bGlzdCwgcGxheWxpc3RDaGlsZHJlbiB9ID0gZmluYWxpemVQbGF5bGlzdChcclxuICAgIHBsYXlsaXN0LFxyXG4gICAgcGxheWxpc3RDaGlsZHJlblxyXG4gICkpO1xyXG4gIHRhYnVsYXRvckxvZyA9IGF3YWl0IHRhYmxlMih0YWJ1bGF0b3JMb2csIGxvZ0VsLCBsb2dWaWRlb0xpc3QsIFwibG9nXCIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0aHVtYm5haWxGb3JtYXR0ZXIoY2VsbCkge1xyXG4gIGNvbnN0IGRhdGEgPSBjZWxsLmdldERhdGEoKTtcclxuICBjb25zdCBpdGVtID0gY2VsbC5nZXRSb3coKS5nZXREYXRhKCk7XHJcbiAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcclxuICBjb25zdCBjYW5kaWRhdGVVcmwgPSBpdGVtLnRodW1ibmFpbFVybDtcclxuICBpZiAoIWNhbmRpZGF0ZVVybCkge1xyXG4gICAgcmV0dXJuIFwiXCI7XHJcbiAgfVxyXG5cclxuICAvLyBpbWcuc3JjID0gREVGQVVMVF9USFVNQjtcclxuICBpbWcuc3JjID0gY2FuZGlkYXRlVXJsO1xyXG4gIGltZy5vbmVycm9yID0gKGUpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwiaW1nIGVycm9yXCIpO1xyXG4gICAgY29uc29sZS5sb2coY2VsbC5nZXREYXRhKCkpO1xyXG4gIH07XHJcbiAgcmV0dXJuIGltZztcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gdGFidWxhdG9yQ2VsbEVkaXRlZChjZWxsKSB7XHJcbiAgY29uc3QgaXRlbSA9IGNlbGwuZ2V0RGF0YSgpO1xyXG4gIGlmIChpdGVtLnR5cGUgPT0gXCJ2aWRlb1wiKSB7XHJcbiAgICBhd2FpdCBzYXZlVmlkZW9zKGl0ZW0pO1xyXG4gIH0gZWxzZSBpZiAoaXRlbS50eXBlID09IFwicGxheWxpc3RcIikge1xyXG4gICAgYXdhaXQgc2F2ZVBsYXlsaXN0cyhpdGVtKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY29uc29sZS5sb2coXCJlcnJvclwiKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRhYmxlQ29sdW1ucyh0YWJsZVR5cGUpIHtcclxuICBsZXQgdGFibGVDb2x1bW5zID0ge1xyXG4gICAgZGF0YVRyZWU6IHtcclxuICAgICAgdGl0bGU6IFwiXCIsXHJcbiAgICAgIGZpZWxkOiBcInR5cGVcIixcclxuICAgICAgZm9ybWF0dGVyOiAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICAgIH0sXHJcbiAgICAgIGNlbGxDbGljazogKGUsIGNlbGwpID0+IHtcclxuICAgICAgICBsZXQgcm93ID0gY2VsbC5nZXRSb3coKTtcclxuICAgICAgICBpZiAocm93LmdldERhdGEoKS50eXBlID09IFwidmlkZW9cIikge1xyXG4gICAgICAgICAgcm93ID0gcm93LmdldFRyZWVQYXJlbnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcm93ICYmIHJvdy50cmVlVG9nZ2xlKCk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgdGh1bWI6IHtcclxuICAgICAgdGl0bGU6IFwiVGh1bWJcIixcclxuICAgICAgZmllbGQ6IFwiaWRfZmFrZVwiLCAvLyBwZXJzaXN0ZW5jZSByZXF1aXJlcyB1bmlxdWUgZmllbGRzXHJcbiAgICAgIC8vIFRPRE86IE5lZWQgdG8gd29yayBvbiB0aGlzIG1vcmUsIFBMIHZzIFYgZXRjXHJcbiAgICAgIGZvcm1hdHRlcjogdGh1bWJuYWlsRm9ybWF0dGVyLFxyXG4gICAgICB3aWR0aDogQ09NUEFDVF9USFVNQl9XSURUSCxcclxuICAgICAgY2VsbENsaWNrOiBhc3luYyAoZSwgY2VsbCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJvdyA9IGNlbGwuZ2V0Um93KCk7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHJvdy5nZXREYXRhKCk7XHJcbiAgICAgICAgY29uc3Qgcm93MCA9IGNlbGwuZ2V0VGFibGUoKS5nZXRSb3dzKClbMF07XHJcbiAgICAgICAgY29uc3Qgcm93MSA9IGNlbGwuZ2V0VGFibGUoKS5nZXRSb3dzKClbMV07XHJcbiAgICAgICAgY29uc3QgZGF0YVRyZWUgPSBjZWxsLmdldFRhYmxlKCkub3B0aW9ucz8uZGF0YVRyZWU7XHJcbiAgICAgICAgY29uc3QgcGFyZW50ID0gZGF0YVRyZWUgJiYgcm93LmdldFRyZWVQYXJlbnQoKTtcclxuICAgICAgICBpZiAocGFyZW50ICYmIHRhYmxlVHlwZSA9PSBcInF1ZXVlXCIgJiYgcGFyZW50ID09IHJvdzApIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3VycmVudCBwbGF5bGlzdCB2aWRlbyB1dWlkOlwiLCBkYXRhLnV1aWQpO1xyXG4gICAgICAgICAgLy8gV0lQXHJcbiAgICAgICAgICAvLyBGaXJzdCBkZWFsIHdpdGggLTEgY2FzZSBub25zZW5zZVxyXG4gICAgICAgICAgaWYgKERCREFUQS5xdWV1ZVswXS5fY3VycmVudFRyYWNrID09IC0xKSB7XHJcbiAgICAgICAgICAgIERCREFUQS5xdWV1ZVswXS5fY3VycmVudFRyYWNrID0gMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIFNraXAgdW50aWwgd2UgZmluZCB0aGUgY2xpY2tlZCB2aWRlb1xyXG4gICAgICAgICAgd2hpbGUgKFxyXG4gICAgICAgICAgICBEQkRBVEEucXVldWVbMF0uX2NoaWxkcmVuLmxlbmd0aCA+IDAgJiZcclxuICAgICAgICAgICAgREJEQVRBLnF1ZXVlWzBdLl9jaGlsZHJlblswXS51dWlkICE9IGRhdGEudXVpZFxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwic2tpcDpcIiwgREJEQVRBLnF1ZXVlWzBdLl9jaGlsZHJlblswXS51dWlkKTtcclxuICAgICAgICAgICAgYXdhaXQgbG9nRXZlbnQoREJEQVRBLnF1ZXVlWzBdLCBcInNraXBcIik7XHJcbiAgICAgICAgICAgIERCREFUQS5xdWV1ZVswXS5fY3VycmVudFRyYWNrICs9IDE7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBwbGF5TmV4dFZpZGVvKDApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGFyZW50ICYmIHRhYmxlVHlwZSA9PSBcInF1ZXVlXCIgJiYgcGFyZW50ICE9IHJvdzApIHtcclxuICAgICAgICAgIG1vdmVWaWRlb1RvRnJvbnQocGFyZW50LmdldERhdGEoKS51dWlkKTtcclxuICAgICAgICAgIGF3YWl0IHJlbmRlclF1ZXVlKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0YWJsZVR5cGUgPT0gXCJxdWV1ZVwiICYmIHJvdyA9PSByb3cwKSB7XHJcbiAgICAgICAgICBwbGF5TmV4dFZpZGVvKDApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGFibGVUeXBlID09IFwicXVldWVcIiAmJiByb3cgPT0gcm93MSkge1xyXG4gICAgICAgICAgbG9nQW5kUGxheU5leHQoXCJza2lwXCIsIHsgc2tpcFdob2xlTGlzdDogdHJ1ZSB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbW92ZVZpZGVvVG9Gcm9udChjZWxsLmdldFJvdygpLmdldERhdGEoKS51dWlkKTtcclxuICAgICAgICAgIGF3YWl0IHJlbmRlclF1ZXVlKCk7XHJcbiAgICAgICAgICBzaG93VG9hc3QoXCJBZGRlZCB0byBmcm9udCBvZiBxdWV1ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGhvekFsaWduOiBcImNlbnRlclwiLFxyXG4gICAgfSxcclxuICAgIHRpdGxlOiB7XHJcbiAgICAgIHRpdGxlOiBcIlRpdGxlXCIsXHJcbiAgICAgIGZpZWxkOiBcInRpdGxlXCIsXHJcbiAgICAgIGZvcm1hdHRlcjogXCJwbGFpbnRleHRcIixcclxuICAgICAgdG9vbHRpcDogdHJ1ZSxcclxuICAgICAgaG96QWxpZ246IFwibGVmdFwiLFxyXG4gICAgICB3aWR0aDogVElUTEVfV0lEVEgsXHJcbiAgICB9LFxyXG4gICAgdGFnczoge1xyXG4gICAgICB0aXRsZTogXCJUYWdzXCIsXHJcbiAgICAgIGZpZWxkOiBcInRhZ3NcIixcclxuICAgICAgZm9ybWF0dGVyOiBcInRleHRhcmVhXCIsXHJcbiAgICAgIGVkaXRvcjogXCJpbnB1dFwiLFxyXG4gICAgICB3aWR0aDogMTUwLFxyXG4gICAgICBjZWxsRWRpdGVkOiB0YWJ1bGF0b3JDZWxsRWRpdGVkLFxyXG4gICAgfSxcclxuICAgIHRyYWNrOiB7XHJcbiAgICAgIHRpdGxlOiBcIlRya1wiLFxyXG4gICAgICBmaWVsZDogXCJfdHJhY2tcIixcclxuICAgICAgc29ydGVyOiBcIm51bWJlclwiLFxyXG4gICAgICBmb3JtYXR0ZXI6IChjZWxsKSA9PiB7XHJcbiAgICAgICAgbGV0IGl0ZW0gPSBjZWxsLmdldERhdGEoKTtcclxuICAgICAgICBpZiAoaXRlbS50eXBlID09IFwicGxheWxpc3RcIikge1xyXG4gICAgICAgICAgaWYgKGl0ZW0uX2N1cnJlbnRUcmFjayA9PSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5fdHJhY2s7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7aXRlbS5fY3VycmVudFRyYWNrICsgMX0vJHtpdGVtLl90cmFja31gO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zdCBkYXRhVHJlZSA9IGNlbGwuZ2V0VGFibGUoKS5vcHRpb25zPy5kYXRhVHJlZTtcclxuICAgICAgICAgIGNvbnN0IHBhcmVudCA9IGRhdGFUcmVlICYmIGNlbGwuZ2V0Um93KCkuZ2V0VHJlZVBhcmVudCgpO1xyXG4gICAgICAgICAgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5fdHJhY2sgKyAxO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIGR1cjoge1xyXG4gICAgICB0aXRsZTogXCJEdXJcIixcclxuICAgICAgZmllbGQ6IFwiZHVyYXRpb25cIixcclxuICAgICAgZm9ybWF0dGVyOiAoY2VsbCkgPT4ge1xyXG4gICAgICAgIHJldHVybiB1dGlscy5mb3JtYXREdXJhdGlvbihjZWxsLmdldFZhbHVlKCksIGZhbHNlKTtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBsYXN0UGxheWVkOiB7XHJcbiAgICAgIHRpdGxlOiBcIkxhc3QgUGxheWVkXCIsXHJcbiAgICAgIGZpZWxkOiBcImxhc3RQbGF5RGF0ZVwiLFxyXG4gICAgICBmb3JtYXR0ZXI6IChjZWxsKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGZvcm1hdExhc3RQbGF5RGF0ZShjZWxsLmdldFJvdygpLmdldERhdGEoKSk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgZHVlOiB7XHJcbiAgICAgIHRpdGxlOiBcIkR1ZVwiLFxyXG4gICAgICBmaWVsZDogXCJkdWVcIixcclxuICAgICAgZm9ybWF0dGVyOiAoY2VsbCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBmb3JtYXREdWUoY2VsbC5nZXRWYWx1ZSgpKTtcclxuICAgICAgfSxcclxuICAgICAgZWRpdGFibGU6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIHBsYXlDbnQ6IHtcclxuICAgICAgdGl0bGU6IFwiQ250XCIsXHJcbiAgICAgIGZpZWxkOiBcInBsYXlDbnRcIixcclxuICAgICAgZm9ybWF0dGVyOiBcInBsYWludGV4dFwiLFxyXG4gICAgfSxcclxuICAgIHJhdGluZzoge1xyXG4gICAgICB0aXRsZTogXCJSYXRpbmdcIixcclxuICAgICAgZmllbGQ6IFwicmF0aW5nXCIsXHJcbiAgICAgIGZvcm1hdHRlcjogKGNlbGwpID0+IHtcclxuICAgICAgICBsZXQgaXRlbSA9IGNlbGwuZ2V0Um93KCkuZ2V0RGF0YSgpO1xyXG4gICAgICAgIGxldCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGRpdi5jbGFzc05hbWUgPSBcIm51bWJlci1zdGVwcGVyXCI7XHJcbiAgICAgICAgY29uc3QgZG93bkJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICAgICAgZG93bkJ0bi5jbGFzc05hbWUgPSBcInN0ZXAtYnRuIHN0ZXAtZG93blwiO1xyXG4gICAgICAgIGRvd25CdG4udHlwZSA9IFwiYnV0dG9uXCI7XHJcbiAgICAgICAgZG93bkJ0bi5pbm5lckhUTUwgPSBcIiZtaW51cztcIjtcclxuICAgICAgICBjb25zdCB1cEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICAgICAgdXBCdG4uY2xhc3NOYW1lID0gXCJzdGVwLWJ0biBzdGVwLXVwXCI7XHJcbiAgICAgICAgdXBCdG4udHlwZSA9IFwiYnV0dG9uXCI7XHJcbiAgICAgICAgdXBCdG4uaW5uZXJIVE1MID0gXCImcGx1cztcIjtcclxuXHJcbiAgICAgICAgbGV0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgIGlucHV0LnR5cGUgPSBcIm51bWJlclwiO1xyXG4gICAgICAgIGlucHV0Lm1pbiA9IFwiMVwiO1xyXG4gICAgICAgIGlucHV0Lm1heCA9IFwiMTBcIjtcclxuICAgICAgICBpbnB1dC5zdGVwID0gXCIwLjVcIjtcclxuICAgICAgICBpbnB1dC52YWx1ZSA9IChpdGVtLnJhdGluZyA/PyBERUZBVUxUX1JBVElORykudG9GaXhlZCgxKTtcclxuICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoZG93bkJ0bik7XHJcbiAgICAgICAgZGl2LmFwcGVuZENoaWxkKGlucHV0KTtcclxuICAgICAgICBkaXYuYXBwZW5kQ2hpbGQodXBCdG4pO1xyXG4gICAgICAgIHJldHVybiBkaXY7XHJcbiAgICAgIH0sXHJcbiAgICAgIGNlbGxDbGljazogYXN5bmMgKGUsIGNlbGwpID0+IHtcclxuICAgICAgICBsZXQgaXRlbSA9IGNlbGwuZ2V0Um93KCkuZ2V0RGF0YSgpO1xyXG4gICAgICAgIGxldCBvcmlnUmF0aW5nID0gaXRlbS5yYXRpbmc7XHJcbiAgICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInN0ZXAtZG93blwiKSkge1xyXG4gICAgICAgICAgLy8gUm91bmQgdG8gbmVhcmVzdCAwLjUsIHRoZW4gY2hhbmdlIDAuNVxyXG4gICAgICAgICAgaXRlbS5yYXRpbmcgPSBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKGl0ZW0ucmF0aW5nICogMikgLyAyIC0gMC41KTtcclxuICAgICAgICB9IGVsc2UgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInN0ZXAtdXBcIikpIHtcclxuICAgICAgICAgIC8vIFJvdW5kIHRvIG5lYXJlc3QgMC41LCB0aGVuIGNoYW5nZSBieSAwLjVcclxuICAgICAgICAgIGl0ZW0ucmF0aW5nID0gTWF0aC5taW4oMTAsIE1hdGgucm91bmQoaXRlbS5yYXRpbmcgKiAyKSAvIDIgKyAwLjUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3JpZ1JhdGluZyAhPSBpdGVtLnJhdGluZykge1xyXG4gICAgICAgICAgaWYgKGl0ZW0udHlwZSA9PSBcInBsYXlsaXN0XCIpIHtcclxuICAgICAgICAgICAgYXdhaXQgc2F2ZVBsYXlsaXN0cyhbaXRlbV0pO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT0gXCJ2aWRlb1wiKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHNhdmVWaWRlb3MoW2l0ZW1dKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFsZXJ0KGB1bmtub3duIHR5cGUgJHtpdGVtLnR5cGV9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0ZW0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY2VsbC5nZXRSb3coKS5yZWZvcm1hdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBpbnRlcnZhbDoge1xyXG4gICAgICB0aXRsZTogXCJJbnRcIixcclxuICAgICAgZmllbGQ6IFwiaW50ZXJ2YWxcIixcclxuICAgICAgZm9ybWF0dGVyOiAoY2VsbCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBjZWxsLmdldFZhbHVlKCkgKyBcImRcIjtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBzY29yZToge1xyXG4gICAgICB0aXRsZTogXCJTY29yZVwiLFxyXG4gICAgICBmaWVsZDogXCJzY29yZVwiLFxyXG4gICAgICBob3pBbGlnbjogXCJjZW50ZXJcIixcclxuICAgICAgZm9ybWF0dGVyOiAoY2VsbCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBjZWxsLmdldFZhbHVlKCkudG9GaXhlZCgxKTtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBkZWxheToge1xyXG4gICAgICB0aXRsZTogXCJEZWxheVwiLFxyXG4gICAgICBmaWVsZDogXCJkZWxheVwiLFxyXG4gICAgICBob3pBbGlnbjogXCJjZW50ZXJcIixcclxuICAgICAgZm9ybWF0dGVyOiAoY2VsbCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBjZWxsLmdldFZhbHVlKCkgPyBcIuKclFwiIDogXCJcIjtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBlcnJDbnQ6IHtcclxuICAgICAgdGl0bGU6IFwiRXJyXCIsXHJcbiAgICAgIGZpZWxkOiBcImVyckNudFwiLFxyXG4gICAgICBob3pBbGlnbjogXCJjZW50ZXJcIixcclxuICAgICAgZWRpdG9yOiBcIm51bWJlclwiLFxyXG4gICAgICBjZWxsRWRpdGVkOiB0YWJ1bGF0b3JDZWxsRWRpdGVkLFxyXG4gICAgfSxcclxuICAgIGR1cDoge1xyXG4gICAgICB0aXRsZTogXCJEdXBcIixcclxuICAgICAgZmllbGQ6IFwiZHVwXCIsXHJcbiAgICAgIGhvekFsaWduOiBcImxlZnRcIixcclxuICAgICAgZWRpdG9yOiBcImlucHV0XCIsXHJcbiAgICAgIGNlbGxFZGl0ZWQ6IHRhYnVsYXRvckNlbGxFZGl0ZWQsXHJcbiAgICB9LFxyXG4gICAgc291cmNlOiB7XHJcbiAgICAgIHRpdGxlOiBcIlNvdXJjZVwiLFxyXG4gICAgICBmaWVsZDogXCJzb3VyY2VcIixcclxuICAgIH0sXHJcbiAgICBmb3JlaWduS2V5OiB7XHJcbiAgICAgIHRpdGxlOiBcIk5hdGl2ZSBLZXlcIixcclxuICAgICAgZmllbGQ6IFwiZm9yZWlnbktleVwiLFxyXG4gICAgICBob3pBbGlnbjogXCJsZWZ0XCIsXHJcbiAgICAgIHdpZHRoOiBUSVRMRV9XSURUSCxcclxuICAgIH0sXHJcbiAgICBjaGFubmVsOiB7XHJcbiAgICAgIHRpdGxlOiBcIkNoYW5uZWxcIixcclxuICAgICAgZmllbGQ6IFwidmlkZW9Pd25lckNoYW5uZWxUaXRsZVwiLFxyXG4gICAgICBob3pBbGlnbjogXCJsZWZ0XCIsXHJcbiAgICAgIC8vIGhlYWRlckZpbHRlcjogXCJpbnB1dFwiLFxyXG4gICAgICB3aWR0aDogMTUwLFxyXG4gICAgfSxcclxuICAgIFBMX2NoYW5uZWw6IHtcclxuICAgICAgdGl0bGU6IFwiQ2hhbm5lbFwiLFxyXG4gICAgICBmaWVsZDogXCJjaGFubmVsVGl0bGVcIixcclxuICAgICAgLy8gaGVhZGVyRmlsdGVyOiBcImlucHV0XCIsXHJcbiAgICAgIHdpZHRoOiAxNTAsXHJcbiAgICB9LFxyXG4gICAgZGF0ZUFkZGVkOiB7XHJcbiAgICAgIHRpdGxlOiBcIkRhdGUgQWRkZWRcIixcclxuICAgICAgZmllbGQ6IFwiZGF0ZUFkZGVkXCIsXHJcbiAgICAgIGZvcm1hdHRlcjogKGNlbGwpID0+IHtcclxuICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBjZWxsLmdldFZhbHVlKCk7XHJcbiAgICAgICAgaWYgKCF0aW1lc3RhbXApIHJldHVybiBcIuKAlFwiO1xyXG4gICAgICAgIHJldHVybiBkYXRlMlN0cmluZyhuZXcgRGF0ZSh0aW1lc3RhbXApKTtcclxuICAgICAgfSxcclxuICAgICAgaG96QWxpZ246IFwiY2VudGVyXCIsXHJcbiAgICB9LFxyXG4gICAgbG9nVHlwZToge1xyXG4gICAgICB0aXRsZTogXCJUeXBlXCIsXHJcbiAgICAgIGZpZWxkOiBcImVudHJ5LmV2ZW50XCIsXHJcbiAgICB9LFxyXG4gIH07XHJcbiAgcmV0dXJuIHRhYmxlQ29sdW1ucztcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gdGFibGUyKHRhYnVsYXRvciwgaHRtbEVsLCB2aWRlb0xpc3QsIHRhYmxlVHlwZSkge1xyXG4gIGlmICh0YWJ1bGF0b3IpIHtcclxuICAgIGNvbnN0IGV4cGFuZGVkSWRzID0gW107XHJcbiAgICB0YWJ1bGF0b3IuZ2V0Um93cygpLmZvckVhY2goKHJvdykgPT4ge1xyXG4gICAgICBpZiAocm93LmdldERhdGEoKS50eXBlID09IFwicGxheWxpc3RcIiAmJiByb3cuaXNUcmVlRXhwYW5kZWQoKSkge1xyXG4gICAgICAgIGV4cGFuZGVkSWRzLnB1c2gocm93LmdldERhdGEoKS51dWlkKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0YWJ1bGF0b3IucmVwbGFjZURhdGEodmlkZW9MaXN0KS50aGVuKCgpID0+IHtcclxuICAgICAgdGFidWxhdG9yLmdldFJvd3MoKS5mb3JFYWNoKChyb3cpID0+IHtcclxuICAgICAgICBpZiAoZXhwYW5kZWRJZHMuaW5jbHVkZXMocm93LmdldERhdGEoKS51dWlkKSkge1xyXG4gICAgICAgICAgcm93LnRyZWVFeHBhbmQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGFidWxhdG9yO1xyXG4gIH1cclxuICBsZXQgdGFibGVDb2x1bW5zID0gZ2V0VGFibGVDb2x1bW5zKHRhYmxlVHlwZSk7XHJcblxyXG4gIGxldCBjb2x1bW5zID0gW1xyXG4gICAgdGFibGVUeXBlID09IFwibG9nXCIgPyB0YWJsZUNvbHVtbnMubG9nVHlwZSA6IHRhYmxlQ29sdW1ucy5kYXRhVHJlZSxcclxuICAgIHRhYmxlQ29sdW1ucy50aHVtYixcclxuICAgIHRhYmxlQ29sdW1ucy50aXRsZSxcclxuICAgIHRhYmxlQ29sdW1ucy50cmFjayxcclxuICAgIHRhYmxlQ29sdW1ucy5yYXRpbmcsXHJcbiAgICB0YWJsZUNvbHVtbnMuaW50ZXJ2YWwsXHJcbiAgICB0YWJsZUNvbHVtbnMudGFncyxcclxuICBdO1xyXG4gIGNvbHVtbnMubWFwKChjKSA9PiAoYy5oZWFkZXJTb3J0ID0gZmFsc2UpKTtcclxuXHJcbiAgdGFidWxhdG9yID0gbmV3IFRhYnVsYXRvcihodG1sRWwsIHtcclxuICAgIC4uLmJhc2VUYWJ1bGF0b3JPcHRpb25zLFxyXG4gICAgZGF0YTogdmlkZW9MaXN0LFxyXG4gICAgY3VzdG9tOiB7IHRhYmxlVHlwZSB9LCAvLyBjdXN0b20gcHJvcGVydHkgIFRPRE86IE5vdCBuZWVkZWQgYW55bW9yZT9cclxuICAgIGNvbHVtbnM6IGNvbHVtbnMsXHJcbiAgICBkYXRhVHJlZTogdHJ1ZSxcclxuICAgIGxheW91dDogXCJmaXREYXRhXCIsXHJcbiAgICByb3dIZWlnaHQ6IENPTVBBQ1RfVEFCTEVfSEVJR0hULFxyXG4gIH0pO1xyXG4gIHRhYnVsYXRvci5vbihcImhlYWRlckNvbnRleHRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICBoZWFkZXJNZW51KGV2ZW50LCB0YWJ1bGF0b3IpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gdGFidWxhdG9yO1xyXG59XHJcbmZ1bmN0aW9uIGZvcm1hdExhc3RQbGF5RGF0ZSh2aWRlbykge1xyXG4gIGlmICghdmlkZW8ubGFzdFBsYXlEYXRlKSB7XHJcbiAgICByZXR1cm4gXCLigJRcIjtcclxuICB9XHJcbiAgbGV0IGRheXNTaW5jZSA9XHJcbiAgICAoRGF0ZS5ub3coKSAtIG5ldyBEYXRlKHZpZGVvLmxhc3RQbGF5RGF0ZSkpIC8gKDI0ICogMzYwMCAqIDEwMDApO1xyXG4gIHJldHVybiBgJHtkYXlzU2luY2UudG9GaXhlZCgxKX0gZGF5cyBhZ29gO1xyXG59XHJcbmZ1bmN0aW9uIGZvcm1hdER1ZShkdWUpIHtcclxuICBpZiAoZHVlID09PSBudWxsKSB7XHJcbiAgICByZXR1cm4gXCLigJRcIjtcclxuICB9XHJcbiAgbGV0IGNvbG9yID0gZHVlIDwgLTUgPyBcIiNkMTFcIiA6IGR1ZSA8IDAgPyBcIiNlNzdcIiA6IFwiIzZiNlwiO1xyXG4gIGxldCB0ZXh0ID0gZHVlIDwgMCA/IFwiZGF5cyBhZ29cIiA6IFwiZGF5cyBmcm9tIG5vd1wiO1xyXG4gIHJldHVybiBgPHNwYW4gc3R5bGU9XCJjb2xvcjoke2NvbG9yfVwiPiR7TWF0aC5hYnMoZHVlKS50b0ZpeGVkKDEpfSAke3RleHR9PC9zcGFuPmA7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGFkZFlvdXR1YmVJbmZvKHZpZGVvKSB7XHJcbiAgY29uc29sZS5sb2coXCJGZXRjaGluZyBZb3VUdWJlIGluZm8gZm9yXCIsIHZpZGVvLmZvcmVpZ25LZXkpO1xyXG4gIGNvbnN0IHVybCA9IGBodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS95b3V0dWJlL3YzL3ZpZGVvcz9wYXJ0PXNuaXBwZXQsY29udGVudERldGFpbHMsc3RhdGlzdGljcyZpZD0ke3ZpZGVvLmZvcmVpZ25LZXl9JmtleT0ke2Vudi55b3V0dWJlX2FwaV9rZXl9YDtcclxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XHJcbiAgbGV0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgLy8gY29uc29sZS5sb2coZGF0YSk7XHJcbiAgaWYgKGRhdGEuaXRlbXM/Lmxlbmd0aCA+IDApIHtcclxuICAgIGRhdGEgPSB0cmltWW91dHViZUZpZWxkcyhkYXRhKTtcclxuICAgIHZpZGVvLnl0ID0gZGF0YS5pdGVtc1swXTtcclxuICAgIHV0aWxzLmFkZENvbXB1dGVkRmllbGRzVmlkZW8odmlkZW8pO1xyXG4gICAgYXdhaXQgc2F2ZVZpZGVvcyhbdmlkZW9dKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY29uc29sZS5sb2coXCJFcnJvciBmZXRjaGluZyB5dCBmb3I6IFwiLCB2aWRlby5mb3JlaWduS2V5KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGFkZFBsYXlsaXN0VmlkZW9zKHBsYXlsaXN0Rm9yZWlnbktleSkge1xyXG4gIC8vIEZpcnN0LCBmZXRjaCBwbGF5bGlzdCBtZXRhZGF0YVxyXG4gIGxldCBwbGF5bGlzdFVybCA9IGBodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS95b3V0dWJlL3YzL3BsYXlsaXN0cz9wYXJ0PXNuaXBwZXQsY29udGVudERldGFpbHMmaWQ9JHtwbGF5bGlzdEZvcmVpZ25LZXl9JmtleT0ke2Vudi55b3V0dWJlX2FwaV9rZXl9YDtcclxuICBsZXQgcGxheWxpc3RSZXMgPSBhd2FpdCBmZXRjaChwbGF5bGlzdFVybCk7XHJcbiAgbGV0IHBsYXlsaXN0RGF0YSA9IGF3YWl0IHBsYXlsaXN0UmVzLmpzb24oKTtcclxuICAvLyBjb25zb2xlLmxvZyhcInBsYXlsaXN0cyByYXc6XCIsIHBsYXlsaXN0RGF0YSk7XHJcblxyXG4gIGlmICghcGxheWxpc3REYXRhLml0ZW1zIHx8IHBsYXlsaXN0RGF0YS5pdGVtcy5sZW5ndGggPT09IDApIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJQbGF5bGlzdCBub3QgZm91bmQ6XCIsIHBsYXlsaXN0Rm9yZWlnbktleSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBsZXQgcGxheWxpc3RJbmZvID0gcGxheWxpc3REYXRhLml0ZW1zWzBdO1xyXG4gIGxldCBwbGF5bGlzdCA9IGF3YWl0IGRiLmdldFBsYXlsaXN0QnlTb3VyY2VBbmRGb3JlaWduS2V5KFxyXG4gICAgXCJ5b3V0dWJlXCIsXHJcbiAgICBwbGF5bGlzdEZvcmVpZ25LZXlcclxuICApO1xyXG4gIGlmIChwbGF5bGlzdCkge1xyXG4gICAgY29uc29sZS5sb2coXCJVcGRhdGluZyBleGlzdGluZyBwbGF5bGlzdFwiLCBwbGF5bGlzdCk7XHJcbiAgICAvLyBJZiBpdCBhbHJlYWR5IGV4aXN0cywgY2xlYXIgdmlkZW9VdWlkcywgYW5kIG9ubHkgdXBkYXRlIGEgZmV3IHl0IGluZm8gZmllbGRzLlxyXG4gICAgLy8gQWxsIG90aGVyIGZpZWxkcyBzdWNoIGFzIHJhdGluZyBhcmUga2VwdCBhcyBpc1xyXG4gICAgcGxheWxpc3QudmlkZW9VdWlkcyA9IFtdO1xyXG4gICAgcGxheWxpc3QueXQgPSBwbGF5bGlzdEluZm87XHJcbiAgICBwbGF5bGlzdC50aXRsZSA9IHBsYXlsaXN0SW5mby5zbmlwcGV0LnRpdGxlO1xyXG4gICAgcGxheWxpc3QuY2hhbm5lbFRpdGxlID0gcGxheWxpc3RJbmZvLnNuaXBwZXQuY2hhbm5lbFRpdGxlO1xyXG4gICAgcGxheWxpc3QudGh1bWJuYWlsVXJsID0gcGxheWxpc3RJbmZvLnNuaXBwZXQudGh1bWJuYWlscz8uZGVmYXVsdD8udXJsO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIk5ldyBwbGF5bGlzdFwiKTtcclxuICAgIHBsYXlsaXN0ID0ge1xyXG4gICAgICB1dWlkOiBkYi51dWlkdjQoKSxcclxuICAgICAgc291cmNlOiBcInlvdXR1YmVcIixcclxuICAgICAgZm9yZWlnbktleTogcGxheWxpc3RGb3JlaWduS2V5LFxyXG4gICAgICB0aXRsZTogcGxheWxpc3RJbmZvLnNuaXBwZXQudGl0bGUsXHJcbiAgICAgIGNoYW5uZWxUaXRsZTogcGxheWxpc3RJbmZvLnNuaXBwZXQuY2hhbm5lbFRpdGxlLFxyXG4gICAgICB0aHVtYm5haWxVcmw6IHBsYXlsaXN0SW5mby5zbmlwcGV0LnRodW1ibmFpbHM/LmRlZmF1bHQ/LnVybCxcclxuICAgICAgZGF0ZUFkZGVkOiBEYXRlLm5vdygpLFxyXG4gICAgICByYXRpbmc6IERFRkFVTFRfUkFUSU5HLFxyXG4gICAgICB5dDogcGxheWxpc3RJbmZvLFxyXG4gICAgICB2aWRlb1V1aWRzOiBbXSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvLyBOb3cgZmV0Y2ggYWxsIHZpZGVvcyBmcm9tIHRoZSBwbGF5bGlzdFxyXG4gIGxldCBuZXh0UGFnZVRva2VuID0gXCJcIjtcclxuICBsZXQgbmV3VmlkZW9zID0gW107XHJcbiAgbGV0IGZhaWxzYWZlQ250ID0gMDtcclxuICBsZXQgc2VlblRva2VucyA9IG5ldyBTZXQoKTtcclxuICBkbyB7XHJcbiAgICBsZXQgdXJsID1cclxuICAgICAgYGh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3lvdXR1YmUvdjMvcGxheWxpc3RJdGVtcz9wYXJ0PXNuaXBwZXQsY29udGVudERldGFpbHNgICtcclxuICAgICAgYCZtYXhSZXN1bHRzPTUwJnBhZ2VUb2tlbj0ke25leHRQYWdlVG9rZW59JnBsYXlsaXN0SWQ9JHtwbGF5bGlzdEZvcmVpZ25LZXl9JmtleT0ke2Vudi55b3V0dWJlX2FwaV9rZXl9YDtcclxuICAgIGxldCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpO1xyXG4gICAgbGV0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpO1xyXG4gICAgLy8gY29uc29sZS5sb2coXCJwbGF5bGlzdEl0ZW1zIHJhdzogXCIsIGRhdGEpO1xyXG4gICAgZGF0YSA9IHRyaW1Zb3V0dWJlRmllbGRzKGRhdGEpO1xyXG5cclxuICAgIGZvciAoY29uc3QgeXQgb2YgZGF0YS5pdGVtcykge1xyXG4gICAgICBsZXQgZm9yZWlnbktleSA9IHl0LnNuaXBwZXQucmVzb3VyY2VJZC52aWRlb0lkO1xyXG4gICAgICBsZXQgbWF0Y2hpbmdWaWRlbyA9IERCREFUQS5xdWV1ZS5maW5kKCh2KSA9PiB2LmZvcmVpZ25LZXkgPT09IGZvcmVpZ25LZXkpO1xyXG4gICAgICBsZXQgdmlkZW9VdWlkID0gbWF0Y2hpbmdWaWRlbyA/IG1hdGNoaW5nVmlkZW8udXVpZCA6IGRiLnV1aWR2NCgpO1xyXG4gICAgICBpZiAocGxheWxpc3QudmlkZW9VdWlkcy5pbmNsdWRlcyh2aWRlb1V1aWQpKSB7XHJcbiAgICAgICAgY29udGludWU7IC8vIHNraXAgZHVwc1xyXG4gICAgICB9XHJcbiAgICAgIHBsYXlsaXN0LnZpZGVvVXVpZHMucHVzaCh2aWRlb1V1aWQpO1xyXG4gICAgICBpZiAoIW1hdGNoaW5nVmlkZW8pIHtcclxuICAgICAgICBsZXQgdmlkZW8gPSB7XHJcbiAgICAgICAgICB1dWlkOiB2aWRlb1V1aWQsXHJcbiAgICAgICAgICBzb3VyY2U6IFwieW91dHViZVwiLFxyXG4gICAgICAgICAgZm9yZWlnbktleTogZm9yZWlnbktleSxcclxuICAgICAgICAgIHJhdGluZzogREVGQVVMVF9SQVRJTkcsXHJcbiAgICAgICAgICBkYXRlQWRkZWQ6IERhdGUubm93KCksXHJcbiAgICAgICAgICB5dDogeXQsXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2aWRlbyA9IHRyaW1Zb3V0dWJlRmllbGRzKHZpZGVvKTtcclxuICAgICAgICB1dGlscy5hZGRDb21wdXRlZEZpZWxkc1ZpZGVvKHZpZGVvKTtcclxuICAgICAgICBuZXdWaWRlb3MucHVzaCh2aWRlbyk7XHJcbiAgICAgICAgREJEQVRBLnF1ZXVlLnB1c2godmlkZW8pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBuZXh0UGFnZVRva2VuID0gZGF0YS5uZXh0UGFnZVRva2VuO1xyXG4gICAgaWYgKHNlZW5Ub2tlbnMuaGFzKGRhdGEucHJldlBhZ2VUb2tlbikpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJUb2tlbiByZXBlYXRlZCAtLSB5b3V0dWJlIG1peD8gU3RvcHBpbmcuXCIpO1xyXG4gICAgICBicmVhaztcclxuICAgIH1cclxuICAgIHNlZW5Ub2tlbnMuYWRkKGRhdGEucHJldlBhZ2VUb2tlbik7XHJcbiAgICBmYWlsc2FmZUNudCArPSAxO1xyXG4gICAgaWYgKGZhaWxzYWZlQ250ID49IDIwKSB7XHJcbiAgICAgIGFsZXJ0KFwiRXJyb3I6IExvb3BlZCAyMCB0aW1lcy4gQWJvcnRpbmcuXCIpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgfSB3aGlsZSAobmV4dFBhZ2VUb2tlbik7XHJcblxyXG4gIGF3YWl0IHNhdmVWaWRlb3MobmV3VmlkZW9zKTtcclxuICBEQkRBVEEucXVldWUucHVzaCguLi5uZXdWaWRlb3MpO1xyXG4gIGNvbnNvbGUubG9nKFwiYWRkUGxheWxpc3RWaWRlb3M6IG5ld1ZpZGVvcyBcIiwgbmV3VmlkZW9zKTtcclxuICBjb25zb2xlLmxvZyhwbGF5bGlzdCk7XHJcbiAgdXRpbHMuYWRkQ29tcHV0ZWRGaWVsZHNQTChwbGF5bGlzdCwgREJEQVRBLnF1ZXVlKTtcclxuICBjb25zb2xlLmxvZyhwbGF5bGlzdCk7XHJcbiAgY29uc29sZS5sb2coXHJcbiAgICBgQWRkIHBsYXlsaXN0IG9mICR7cGxheWxpc3QudmlkZW9VdWlkcy5sZW5ndGh9IHZpZGVvcyAoJHtuZXdWaWRlb3MubGVuZ3RofSBuZXcpYFxyXG4gICk7XHJcbiAgc2hvd1RvYXN0KFxyXG4gICAgYEFkZCBwbGF5bGlzdCBvZiAke3BsYXlsaXN0LnZpZGVvVXVpZHMubGVuZ3RofSB2aWRlb3MgKCR7bmV3VmlkZW9zLmxlbmd0aH0gbmV3KWBcclxuICApO1xyXG5cclxuICAvLyBSZXBsYWNlIG9yIGFkZCBpbiBEQkRBVEEucGxheWxpc3RzXHJcbiAgbGV0IGlkeCA9IERCREFUQS5wbGF5bGlzdHMuZmluZEluZGV4KFxyXG4gICAgKHApID0+IHAuZm9yZWlnbktleSA9PT0gcGxheWxpc3QuZm9yZWlnbktleVxyXG4gICk7XHJcbiAgaWYgKGlkeCAhPT0gLTEpIHtcclxuICAgIHBsYXlsaXN0LnV1aWQgPSBEQkRBVEEucGxheWxpc3RzW2lkeF0udXVpZDsgLy8gUmV1c2Ugc2FtZSB1dWlkXHJcbiAgICBEQkRBVEEucGxheWxpc3RzW2lkeF0gPSBwbGF5bGlzdDtcclxuICB9IGVsc2Uge1xyXG4gICAgREJEQVRBLnBsYXlsaXN0cy5wdXNoKHBsYXlsaXN0KTtcclxuICB9XHJcbiAgYXdhaXQgc2F2ZVBsYXlsaXN0cyhwbGF5bGlzdCk7XHJcblxyXG4gIC8vIFJlcGxhY2Ugb3IgYWRkIGluIERCREFUQS5xdWV1ZVxyXG4gIGxldCBjb3B5ID0gdXRpbHMud3JhcEl0ZW0ocGxheWxpc3QpO1xyXG4gIGNvcHkgPSB1dGlscy5hZGRDb21wdXRlZEZpZWxkc1BMKGNvcHksIERCREFUQS5xdWV1ZSk7XHJcbiAgaWR4ID0gREJEQVRBLnF1ZXVlLmZpbmRJbmRleCgocCkgPT4gcC51dWlkID09PSBwbGF5bGlzdC51dWlkKTtcclxuICBpZiAoaWR4ICE9PSAtMSkge1xyXG4gICAgREJEQVRBLnF1ZXVlW2lkeF0gPSBwbGF5bGlzdDtcclxuICB9IGVsc2Uge1xyXG4gICAgREJEQVRBLnF1ZXVlLnB1c2gocGxheWxpc3QpO1xyXG4gIH1cclxuICAvLyBVc2UgdGhpcyBpbnN0ZWFkIG9mIHVuc2hpZnQgYmVjYXVzZSBpdCdzIG5vdCBzbyBzaW1wbGVcclxuICBhd2FpdCBtb3ZlVmlkZW9Ub0Zyb250KGNvcHkudXVpZCk7XHJcblxyXG4gIGF3YWl0IHJlcmVuZGVyQWxsKCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGFkZFZpZGVvT3JQbGF5bGlzdChyZXNwb25zZSkge1xyXG4gIGlmIChyZXNwb25zZS50eXBlID09IFwidmlkZW9cIikge1xyXG4gICAgbGV0IHZpZGVvID0gREJEQVRBLnF1ZXVlLmZpbmQoKHYpID0+IHYuZm9yZWlnbktleSA9PT0gcmVzcG9uc2UuZm9yZWlnbktleSk7XHJcbiAgICBpZiAodmlkZW8pIHtcclxuICAgICAgc2hvd1RvYXN0KFwiVmlkZW8gYWxyZWFkeSBpbiBEQlwiKTtcclxuICAgICAgYXdhaXQgbW92ZVZpZGVvVG9Gcm9udCh2aWRlby51dWlkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCB2aWRlbyA9IHtcclxuICAgICAgICB1dWlkOiBkYi51dWlkdjQoKSxcclxuICAgICAgICBzb3VyY2U6IFwieW91dHViZVwiLFxyXG4gICAgICAgIGZvcmVpZ25LZXk6IHJlc3BvbnNlLmZvcmVpZ25LZXksXHJcbiAgICAgICAgcmF0aW5nOiBERUZBVUxUX1JBVElORyxcclxuICAgICAgICBkYXRlQWRkZWQ6IERhdGUubm93KCksXHJcbiAgICAgIH07XHJcbiAgICAgIGF3YWl0IGFkZFlvdXR1YmVJbmZvKHZpZGVvKTtcclxuICAgICAgaWYgKCF2aWRlby55dCkge1xyXG4gICAgICAgIHNob3dUb2FzdChcIkZhaWxlZCB0byBmZXRjaCB2aWRlbyBpbmZvLCBwbGVhc2UgY2hlY2sgdGhlIElEXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBzaG93VG9hc3QoXCJWaWRlbyBhZGRlZFwiKTtcclxuICAgICAgREJEQVRBLnF1ZXVlLnNwbGljZSgxLCAwLCB2aWRlbyk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIGlmIChyZXNwb25zZS50eXBlID09IFwicGxheWxpc3RcIikge1xyXG4gICAgYXdhaXQgYWRkUGxheWxpc3RWaWRlb3MocmVzcG9uc2UuZm9yZWlnbktleSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNob3dUb2FzdChcIkVycm9yOiBjb3VsZCBub3QgcGFyc2UgaW5wdXRcIik7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGF3YWl0IHJlcmVuZGVyQWxsKCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHJvdGF0ZVZpZGVvKCkge1xyXG4gIGxldCBjdXJySXRlbSA9IERCREFUQS5xdWV1ZVswXTtcclxuICBsZXQgdmlkZW8gPSBjdXJySXRlbS50eXBlID09IFwicGxheWxpc3RcIiA/IGN1cnJJdGVtLl9jaGlsZHJlblswXSA6IGN1cnJJdGVtO1xyXG4gIHZpZGVvLnJvdGF0ZUFuZ2xlID0gKCh2aWRlby5yb3RhdGVBbmdsZSB8fCAwKSArIDkwKSAlIDM2MDtcclxuICBjb25zb2xlLmxvZyhcInJvdGF0ZVZpZGVvIG5ldyBhbmdsZTpcIiwgdmlkZW8ucm90YXRlQW5nbGUpO1xyXG4gIHNhdmVWaWRlb3ModmlkZW8pO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBpbXBvcnRMb2NhbEZpbGVzKG1zZykge1xyXG4gIGxldCB2aWRlb3MgPSBbXTtcclxuICBmb3IgKGxldCBmaWxlIG9mIG1zZy5maWxlcykge1xyXG4gICAgaWYgKERCREFUQS5xdWV1ZS5maW5kKCh2KSA9PiB2LmZvcmVpZ25LZXkgPT0gZmlsZSkpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJkdXBcIiwgZmlsZSk7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gICAgbGV0IHZpZGVvID0ge1xyXG4gICAgICB1dWlkOiBkYi51dWlkdjQoKSxcclxuICAgICAgc291cmNlOiBcImxvY2FsXCIsXHJcbiAgICAgIGZvcmVpZ25LZXk6IGZpbGUsXHJcbiAgICAgIHJhdGluZzogNS42LCAvLyBUT0RPIHVuaGFjayA1LjUgPSAzNjUgZGF5c1xyXG4gICAgICAvLyByYXRpbmc6IERFRkFVTFRfUkFUSU5HLFxyXG4gICAgICBkYXRlQWRkZWQ6IERhdGUubm93KCksXHJcbiAgICAgIGxhc3RQbGF5RGF0ZTogRGF0ZS5ub3coKSxcclxuICAgICAgZGVsYXk6IHRydWUsXHJcbiAgICAgIHRpdGxlOiBmaWxlLFxyXG4gICAgfTtcclxuICAgIHRyaW1Mb2NhbEZpZWxkcyh2aWRlbyk7XHJcbiAgICB1dGlscy5hZGRDb21wdXRlZEZpZWxkc1ZpZGVvKHZpZGVvKTtcclxuICAgIHZpZGVvcy5wdXNoKHZpZGVvKTtcclxuICB9XHJcbiAgYXdhaXQgc2F2ZVZpZGVvcyh2aWRlb3MpO1xyXG4gIERCREFUQS5xdWV1ZS5zcGxpY2UoMSwgMCwgLi4udmlkZW9zKTtcclxufVxyXG5cclxuY29uc3QgYWRkRGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGREaWFsb2dcIik7XHJcbmNvbnN0IGFkZEZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZEZvcm1cIik7XHJcbmNvbnN0IGFkZElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0lucHV0XCIpO1xyXG5jb25zdCBhZGRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZFwiKTtcclxuXHJcbmFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZElucHV0LnZhbHVlID0gXCJcIjtcclxuICBhZGREaWFsb2cuc2hvd01vZGFsKCk7XHJcbn0pO1xyXG5hZGREaWFsb2cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgaWYgKGUudGFyZ2V0ID09PSBhZGREaWFsb2cpIHtcclxuICAgIGFkZERpYWxvZy5jbG9zZSgpO1xyXG4gIH1cclxufSk7XHJcbmFkZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBhc3luYyAoZSkgPT4ge1xyXG4gIGNvbnN0IHVybCA9IGFkZElucHV0LnZhbHVlLnRyaW0oKTtcclxuICBjb25zdCByZXNwb25zZSA9IGdldFZpZGVvSWRGcm9tSW5wdXQodXJsKTtcclxuICBpZiAocmVzcG9uc2UuZm9yZWlnbktleSkge1xyXG4gICAgYWRkVmlkZW9PclBsYXlsaXN0KHJlc3BvbnNlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY29uc29sZS5sb2coXCJFcnJvcjogQ291bGQgbm90IGZpbmQgSUQ6XCIsIHVybCk7XHJcbiAgfVxyXG59KTtcclxuc2tpcEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKGUpID0+IHtcclxuICBsZXQgcGFyYW1zID0gZS5zaGlmdEtleSA/IHsgc2tpcFdob2xlTGlzdDogdHJ1ZSB9IDoge307XHJcbiAgbG9nQW5kUGxheU5leHQoXCJza2lwXCIsIHBhcmFtcyk7XHJcbn0pO1xyXG5kZWxheUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKGUpID0+IHtcclxuICBsZXQgcGFyYW1zID0gZS5zaGlmdEtleSA/IHsgZGVsYXlXaG9sZUxpc3Q6IHRydWUgfSA6IHt9O1xyXG4gIGxvZ0FuZFBsYXlOZXh0KFwiZGVsYXlcIiwgcGFyYW1zKTtcclxufSk7XHJcbnBhdXNlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XHJcbiAgc2VuZE1lc3NhZ2UoeyB0eXBlOiBcInBhdXNlVmlkZW9cIiB9KTtcclxufSk7XHJcbnBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jICgpID0+IHtcclxuICBzZW5kTWVzc2FnZSh7IHR5cGU6IFwicmVzdW1lVmlkZW9cIiB9KTtcclxufSk7XHJcbmZhc3RGb3J3YXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XHJcbiAgc2VuZE1lc3NhZ2UoeyB0eXBlOiBcImZhc3RGb3J3YXJkXCIgfSk7XHJcbn0pO1xyXG5cclxubGV0IHZpZGVvVGltZW91dDtcclxuXHJcbmZ1bmN0aW9uIHNlbmRNZXNzYWdlKG1zZykge1xyXG4gIGNvbnNvbGUubG9nKFwic2VuZE1lc3NhZ2U6IFwiLCBKU09OLnN0cmluZ2lmeShtc2cpKTtcclxuICB3aW5kb3cuZWxlY3Ryb25BUEkuc2VuZEJyb2FkY2FzdChtc2cpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBwaWNrTmV4dFZpZGVvVG9QbGF5KG9mZnNldCwgcGFyYW1zID0ge30pIHtcclxuICAvLyBjb25zb2xlLmxvZyhcInBudiBwYXJhbXM6XCIsIHBhcmFtcyk7XHJcbiAgbGV0IHNraXAgPSBwYXJhbXMuc2tpcFdob2xlTGlzdCB8fCBwYXJhbXMuZGVsYXlXaG9sZUxpc3Q7XHJcbiAgaWYgKG9mZnNldCAhPSAwICYmIG9mZnNldCAhPSAxKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkVSUk9SXCIpO1xyXG4gIH1cclxuICAvLyBvZmZzZXQgPSAwIGlzIGZvciBwbGF5aW5nL2N1ZWluZyB0aGUgY3VycmVudCB2aWRlby5cclxuICAvLyBUaGF0IHNob3VsZG4ndCBoYXBwZW4gdG9nZXRoZXIgd2l0aCBza2lwLlxyXG4gIGlmIChvZmZzZXQgPT0gMCAmJiBza2lwKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkVSUk9SXCIpO1xyXG4gIH1cclxuXHJcbiAgbGV0IGN1cnJJdGVtID0gREJEQVRBLnF1ZXVlWzBdO1xyXG4gIGxldCB2aWRlbyA9IGN1cnJJdGVtLnR5cGUgPT0gXCJwbGF5bGlzdFwiID8gY3Vyckl0ZW0uX2NoaWxkcmVuWzBdIDogY3Vyckl0ZW07XHJcbiAgLy8gVGhlIGN1cnJlbnQgcGxheWxpc3Qgc2hvdWxkIGF0IGxlYXN0IGJlIFwiYWN0aXZlXCJcclxuICAvLyBFdmVuIGlmIHdlIGVuZCB1cCBza2lwcGluZy93aGF0ZXZlciBsYXRlclxyXG4gIGlmIChjdXJySXRlbS50eXBlID09IFwicGxheWxpc3RcIiAmJiBjdXJySXRlbS5fY3VycmVudFRyYWNrID09IC0xKSB7XHJcbiAgICBjdXJySXRlbS5fY3VycmVudFRyYWNrID0gMDtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiYWN0aXZhdGUgUExcIik7XHJcbiAgfVxyXG5cclxuICAvLyBJZiB3ZSB3YW50IHRvIHBsYXkvY3VlIHRoZSBjdXJyZW50IHZpZGVvLCBqdXN0IHJldHVybiB0aGUgZmlyc3QgdmlkZW9cclxuICBpZiAob2Zmc2V0ID09IDApIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwicG52IGVhc3lcIiwgdmlkZW8pO1xyXG4gICAgcmV0dXJuIHZpZGVvO1xyXG4gIH1cclxuXHJcbiAgLy8gSWYgdGhlIGZpcnN0IGl0ZW0gaXMgYSBwbGF5bGlzdCwgYW5kIHRoZXJlIGFyZSBzb25ncyBsZWZ0LCBhbmQgd2UgZG9uJ3Qgc2tpcC4uLlxyXG4gIGlmIChjdXJySXRlbS50eXBlID09IFwicGxheWxpc3RcIiAmJiBjdXJySXRlbS5fY2hpbGRyZW4ubGVuZ3RoID4gMSAmJiAhc2tpcCkge1xyXG4gICAgLy8gY29uc29sZS5sb2coXCJpbmNyZW1lbnQgcGxheWxpc3QgcG9pbnRlclwiKTtcclxuICAgIGxldCB2aWRlbyA9IGN1cnJJdGVtLl9jaGlsZHJlblsxXTtcclxuICAgIGlmICghcGFyYW1zLmN1ZVZpZGVvKSB7XHJcbiAgICAgIGN1cnJJdGVtLl9jdXJyZW50VHJhY2sgKz0gMTtcclxuICAgICAgLy8gY29uc29sZS5sb2coXCJuZXh0IHRyYWNrOlwiLCBjdXJySXRlbS5fY3VycmVudFRyYWNrKTtcclxuICAgIH1cclxuICAgIHJldHVybiB2aWRlbztcclxuICB9XHJcblxyXG4gIC8vIEJ5IG5vdyB3ZSBrbm93IHdlIGFyZSBkb25lIHdpdGggdGhlIGZpcnN0IGl0ZW0uXHJcbiAgLy8gSWYgaXQncyBhIHBsYXlsaXN0LCBsb2cgY29tcGxldGlvbi9za2lwL2RlbGF5LCByZXNldCBfY3VycmVudFRyYWNrXHJcbiAgaWYgKGN1cnJJdGVtLnR5cGUgPT0gXCJwbGF5bGlzdFwiICYmICFwYXJhbXMuY3VlVmlkZW8pIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwicGxheWxpc3QgdXBkYXRlXCIpO1xyXG4gICAgY3Vyckl0ZW0ubGFzdFBsYXlEYXRlID0gRGF0ZS5ub3coKTtcclxuICAgIGN1cnJJdGVtLnNjb3JlID0gdXRpbHMuc2NvcmVJdGVtKGN1cnJJdGVtKTtcclxuICAgIGN1cnJJdGVtLmRlbGF5ID0gISFwYXJhbXMuZGVsYXlXaG9sZUxpc3Q7XHJcbiAgICBpZiAoIXNraXApIHtcclxuICAgICAgY3Vyckl0ZW0ucGxheUNudCA9IChjdXJySXRlbS5wbGF5Q250ID8/IDApICsgMTtcclxuICAgIH1cclxuICAgIGN1cnJJdGVtLl9jdXJyZW50VHJhY2sgPSAtMTtcclxuICAgIGF3YWl0IHNhdmVQbGF5bGlzdHMoY3Vyckl0ZW0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUGljayB0aGUgbmV4dCBpdGVtIGluIHRoZSBxdWV1ZVxyXG4gIGN1cnJJdGVtID0gREJEQVRBLnF1ZXVlWzFdO1xyXG4gIHZpZGVvID0gY3Vyckl0ZW0udHlwZSA9PSBcInBsYXlsaXN0XCIgPyBjdXJySXRlbS5fY2hpbGRyZW5bMF0gOiBjdXJySXRlbTtcclxuICAvLyBBbmQgc2V0IGl0IGFjdGl2ZSBpZiBpdCdzIGEgcGxheWxpc3RcclxuICBpZiAoY3Vyckl0ZW0udHlwZSA9PSBcInBsYXlsaXN0XCIgJiYgY3Vyckl0ZW0uX2N1cnJlbnRUcmFjayA9PSAtMSkge1xyXG4gICAgY3Vyckl0ZW0uX2N1cnJlbnRUcmFjayA9IDA7XHJcbiAgfVxyXG5cclxuICBpZiAoIXBhcmFtcy5jdWVWaWRlbykge1xyXG4gICAgLy8gTW92ZSBjdXJyZW50IGl0ZW0gdG8gYmFjayBvZiBxdWV1ZVxyXG4gICAgLy8gY29uc29sZS5sb2coXCJSb3RhdGUgcXVldWVcIik7XHJcbiAgICBsZXQgcm90YXRlZEl0ZW0gPSBEQkRBVEEucXVldWUuc2hpZnQoKTtcclxuICAgIERCREFUQS5xdWV1ZS5wdXNoKHJvdGF0ZWRJdGVtKTtcclxuICAgIGlmIChyb3RhdGVkSXRlbS50eXBlID09IFwicGxheWxpc3RcIikge1xyXG4gICAgICByb3RhdGVkSXRlbS5fY3VycmVudFRyYWNrID0gMDtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHZpZGVvO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBjdWVOZXh0VmlkZW8ob2Zmc2V0ID0gMSwgcGFyYW1zID0ge30pIHtcclxuICBwYXJhbXMuY3VlVmlkZW8gPSB0cnVlO1xyXG4gIGxldCBuZXh0VmlkZW9Ub1BsYXkgPSBhd2FpdCBwaWNrTmV4dFZpZGVvVG9QbGF5KG9mZnNldCwgcGFyYW1zKTtcclxuXHJcbiAgbGV0IG1zZyA9IHtcclxuICAgIHR5cGU6IFwiYmFja2dyb3VuZEN1ZVZpZGVvXCIsXHJcbiAgICBzb3VyY2U6IG5leHRWaWRlb1RvUGxheS5zb3VyY2UsXHJcbiAgICBmb3JlaWduS2V5OiBuZXh0VmlkZW9Ub1BsYXkuZm9yZWlnbktleSxcclxuICB9O1xyXG4gIHNlbmRNZXNzYWdlKG1zZyk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gbG9nQW5kUGxheU5leHQodHlwZSwgcGFyYW1zKSB7XHJcbiAgYXdhaXQgbG9nRXZlbnQoREJEQVRBLnF1ZXVlWzBdLCB0eXBlKTtcclxuICBwbGF5TmV4dFZpZGVvKDEsIHBhcmFtcyk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gcGxheU5leHRWaWRlbyhvZmZzZXQgPSAxLCBwYXJhbXMgPSB7fSkge1xyXG4gIGlmIChEQkRBVEEucXVldWUubGVuZ3RoID09IDApIHtcclxuICAgIGNvbnNvbGUubG9nKFwiUXVldWUgZW1wdHlcIiwgb2Zmc2V0KTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgb2Zmc2V0ID0gb2Zmc2V0ICUgREJEQVRBLnF1ZXVlLmxlbmd0aDsgLy8gZGVhbCB3aXRoIHZlcnkgc21hbGwgcXVldWVzXHJcblxyXG4gIC8vIGNvbnNvbGUubG9nKFwiY3Q6XCIsIERCREFUQS5xdWV1ZVswXS5fY3VycmVudFRyYWNrKTtcclxuICBsZXQgbmV4dFZpZGVvVG9QbGF5ID0gYXdhaXQgcGlja05leHRWaWRlb1RvUGxheShvZmZzZXQsIHBhcmFtcyk7XHJcbiAgLy8gY29uc29sZS5sb2coXCJjdDpcIiwgREJEQVRBLnF1ZXVlWzBdLl9jdXJyZW50VHJhY2spO1xyXG5cclxuICBpZiAodmlkZW9UaW1lb3V0KSBjbGVhclRpbWVvdXQodmlkZW9UaW1lb3V0KTtcclxuICBpZiAoIXBhcmFtcy5jdWVWaWRlbykge1xyXG4gICAgdmlkZW9UaW1lb3V0ID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6XCIsIG5leHRWaWRlb1RvUGxheS51dWlkLCBuZXh0VmlkZW9Ub1BsYXkudGl0bGUpO1xyXG4gICAgICBzZW5kTWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJlcnJvclwiLFxyXG4gICAgICAgIGluZm86IGB0aW1lb3V0ICR7bmV4dFZpZGVvVG9QbGF5LnV1aWR9ICR7bmV4dFZpZGVvVG9QbGF5LnRpdGxlfWAsXHJcbiAgICAgIH0pO1xyXG4gICAgICBzaG93VG9hc3QoXCJWaWRlbyB0aW1lb3V0XCIpO1xyXG4gICAgICBuZXh0VmlkZW9Ub1BsYXkuZXJyQ250ID0gKG5leHRWaWRlb1RvUGxheS5lcnJDbnQgfHwgMCkgKyAxO1xyXG4gICAgICBhd2FpdCBzYXZlVmlkZW9zKFtuZXh0VmlkZW9Ub1BsYXldKTtcclxuICAgICAgYXdhaXQgbG9nRXZlbnQobmV4dFZpZGVvVG9QbGF5LCBcImVycm9yXCIpO1xyXG4gICAgICBwbGF5TmV4dFZpZGVvKCk7XHJcbiAgICB9LCAxNTAwMCk7IC8vIDE1cyAtLSBzZWUgaWYgdGhpcyB3b3Jrc1xyXG4gIH1cclxuICBsZXQgbmVlZFRodW1iID1cclxuICAgIG5leHRWaWRlb1RvUGxheS5zb3VyY2UgPT0gXCJsb2NhbFwiICYmICFuZXh0VmlkZW9Ub1BsYXkudGh1bWJuYWlsVXJsO1xyXG4gIGxldCBtc2cgPSB7XHJcbiAgICB0eXBlOiBwYXJhbXM/LmN1ZVZpZGVvID8gXCJjdWVWaWRlb1wiIDogXCJwbGF5VmlkZW9cIixcclxuICAgIHNvdXJjZTogbmV4dFZpZGVvVG9QbGF5LnNvdXJjZSxcclxuICAgIHV1aWQ6IG5leHRWaWRlb1RvUGxheS51dWlkLFxyXG4gICAgbmVlZFRodW1iOiBuZWVkVGh1bWIsXHJcbiAgICBmb3JlaWduS2V5OiBuZXh0VmlkZW9Ub1BsYXkuZm9yZWlnbktleSxcclxuICAgIC4uLihuZXh0VmlkZW9Ub1BsYXkucm90YXRlQW5nbGUgJiYge1xyXG4gICAgICByb3RhdGVBbmdsZTogbmV4dFZpZGVvVG9QbGF5LnJvdGF0ZUFuZ2xlLFxyXG4gICAgfSksXHJcbiAgfTtcclxuICBjb25zb2xlLmxvZyhtc2cpO1xyXG4gIHNlbmRNZXNzYWdlKG1zZyk7XHJcbiAgYXdhaXQgcmVuZGVyUXVldWUoKTtcclxufVxyXG5mdW5jdGlvbiBnZXRWaWRlb0lkRnJvbUlucHV0KGlucHV0KSB7XHJcbiAgaWYgKGlucHV0LnN0YXJ0c1dpdGgoXCJodHRwXCIpIHx8IGlucHV0LnN0YXJ0c1dpdGgoXCJmaWxlXCIpKSB7XHJcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGlucHV0KTtcclxuICAgIGlmICh1cmwuaG9zdG5hbWUgPT09IFwieW91dHUuYmVcIikge1xyXG4gICAgICBjb25zdCB2aWRlb0lkID0gdXJsLnBhdGhuYW1lLnNsaWNlKDEpOyAvLyByZW1vdmUgbGVhZGluZyBcIi9cIlxyXG4gICAgICByZXR1cm4geyB0eXBlOiBcInZpZGVvXCIsIGZvcmVpZ25LZXk6IHZpZGVvSWQgfTtcclxuICAgIH1cclxuICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkwoaW5wdXQpLnNlYXJjaFBhcmFtcztcclxuICAgIGNvbnN0IGxpc3RJZCA9IHBhcmFtcy5nZXQoXCJsaXN0XCIpO1xyXG4gICAgY29uc3QgdmlkZW9JZCA9IHBhcmFtcy5nZXQoXCJ2XCIpO1xyXG4gICAgLy8gc2hvcnRzOiAvc2hvcnRzLzxpZD5cclxuICAgIGlmICh1cmwucGF0aG5hbWUuc3RhcnRzV2l0aChcIi9zaG9ydHMvXCIpKSB7XHJcbiAgICAgIGNvbnN0IGlkID0gdXJsLnBhdGhuYW1lLnNwbGl0KFwiL3Nob3J0cy9cIilbMV0uc3BsaXQoL1s/Jl0vKVswXTtcclxuICAgICAgcmV0dXJuIHsgdHlwZTogXCJ2aWRlb1wiLCBmb3JlaWduS2V5OiBpZCB9O1xyXG4gICAgfVxyXG4gICAgLy8gcHJpb3JpdGl6ZSBzaW5nbGUgdmlkZW8uXHJcbiAgICBpZiAodmlkZW9JZCkge1xyXG4gICAgICByZXR1cm4geyB0eXBlOiBcInZpZGVvXCIsIGZvcmVpZ25LZXk6IHZpZGVvSWQgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiB7IHR5cGU6IFwicGxheWxpc3RcIiwgZm9yZWlnbktleTogbGlzdElkIH07XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIC8vIGFzc3VtZSByYXcgdmlkZW8gZm9yZWlnbktleVxyXG4gICAgcmV0dXJuIHsgdHlwZTogXCJ2aWRlb1wiLCBmb3JlaWduS2V5OiBpbnB1dCB9O1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gbG9nRXZlbnQoaXRlbSwgZXZlbnQpIHtcclxuICBsZXQgbm93ID0gRGF0ZS5ub3coKTtcclxuICBsZXQgdmlkZW8gPSBpdGVtLnR5cGUgPT0gXCJwbGF5bGlzdFwiID8gaXRlbS5fY2hpbGRyZW5bMF0gOiBpdGVtO1xyXG4gIHZpZGVvLmxhc3RQbGF5RGF0ZSA9IG5vdzsgLy8gaW5jbHVkZXMgZXJyb3JzIGFuZCBza2lwc1xyXG4gIHZpZGVvLnNjb3JlID0gdXRpbHMuc2NvcmVJdGVtKHZpZGVvKTtcclxuICB2aWRlby5kZWxheSA9IGV2ZW50ID09PSBcImRlbGF5XCI7XHJcbiAgaWYgKGV2ZW50ID09IFwicGxheVwiKSB7XHJcbiAgICB2aWRlby5wbGF5Q250ID0gKHZpZGVvLnBsYXlDbnQgPz8gMCkgKyAxO1xyXG4gIH1cclxuICBpZiAodmlkZW8ucGxheUNudCA9PSAxKSB7XHJcbiAgICB2aWRlby5maXJzdFBsYXlEYXRlID0gbm93O1xyXG4gIH1cclxuICBhd2FpdCBzYXZlVmlkZW9zKFt2aWRlb10pO1xyXG4gIGNvbnN0IGxvZ0VudHJ5ID0ge1xyXG4gICAgdHlwZTogaXRlbS50eXBlLFxyXG4gICAgdXVpZDogdmlkZW8udXVpZCxcclxuICAgIHNvdXJjZTogdmlkZW8uc291cmNlLFxyXG4gICAgZm9yZWlnbktleTogdmlkZW8uZm9yZWlnbktleSxcclxuICAgIHRpbWVzdGFtcDogbm93LFxyXG4gICAgZXZlbnQ6IGV2ZW50LFxyXG4gICAgLi4uKGl0ZW0udHlwZSA9PSBcInBsYXlsaXN0XCIgJiYge1xyXG4gICAgICBwbGF5bGlzdFV1aWQ6IGl0ZW0udXVpZCxcclxuICAgICAgX3RyYWNrOiB2aWRlby5fdHJhY2ssXHJcbiAgICB9KSxcclxuICB9O1xyXG4gIGF3YWl0IGRiLnNhdmVMb2coW2xvZ0VudHJ5XSk7XHJcbn1cclxuXHJcbmxldCBsYXN0RW5kZWRWaWRlb1V1aWQgPSBudWxsO1xyXG5cclxud2luZG93LmVsZWN0cm9uQVBJLm9uQnJvYWRjYXN0KGFzeW5jIChtc2cpID0+IHtcclxuICBsZXQgY3Vyckl0ZW0gPSBEQkRBVEEucXVldWVbMF07XHJcbiAgbGV0IGN1cnJWaWRlbyA9XHJcbiAgICBjdXJySXRlbT8udHlwZSA9PSBcInBsYXlsaXN0XCIgPyBjdXJySXRlbS5fY2hpbGRyZW5bMF0gOiBjdXJySXRlbTtcclxuICBsZXQgdmlkZW9Gb3JlaWduS2V5ID0gbnVsbDtcclxuICBsZXQgdmlkZW9VdWlkID0gbnVsbDtcclxuICAvLyBUT0RPOiBXZSBkb24ndCBhbHdheXMgaGF2ZSBtc2cudXJsP1xyXG4gIC8vIGUuZy4gbWFpbi5qcyBjb3VsZCBiZSBzZW5kaW5nIHRoZSBtZXNzYWdlLlxyXG4gIC8vIEJ1dCBpdCBjb3VsZCBhZGQgbXNnLnVybCBJIHN1cHBvc2VcclxuICBpZiAobXNnPy51cmw/LnN0YXJ0c1dpdGgoXCJmaWxlXCIpKSB7XHJcbiAgICAvLyBMb2NhbCBwbGF5ZXIgY2FuJ3QgcmVhbGx5IGdvIG9mZiBvbiBpdCdzIG93biwgc28ganVzdCBhc3N1bWUgd2UgYXJlIHBsYXlpbmcgdGhlIGNvcnJlY3QgdmlkZW8uXHJcbiAgICB2aWRlb0ZvcmVpZ25LZXkgPSBjdXJyVmlkZW8uZm9yZWlnbktleTtcclxuICAgIHZpZGVvVXVpZCA9IGN1cnJWaWRlby51dWlkO1xyXG4gIH0gZWxzZSBpZiAobXNnLnVybCkge1xyXG4gICAgdmlkZW9Gb3JlaWduS2V5ID0gZ2V0VmlkZW9JZEZyb21JbnB1dChtc2cudXJsKS5mb3JlaWduS2V5O1xyXG4gICAgdmlkZW9VdWlkID0gREJEQVRBLnF1ZXVlLmZpbmQoKHYpID0+IHYuZm9yZWlnbktleSA9PSB2aWRlb0ZvcmVpZ25LZXkpLnV1aWQ7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhcImZyb20gdXJsOlwiLCB2aWRlb0ZvcmVpZ25LZXksIHZpZGVvVXVpZCk7XHJcbiAgfVxyXG4gIGNvbnNvbGUubG9nKFwib3B0aW9ucy5qcyByZWNlaXZlZCBtZXNzYWdlOlwiLCBtc2cpO1xyXG4gIGlmIChtc2c/LnR5cGUgPT09IFwidmlkZW9QbGF5aW5nXCIpIHtcclxuICAgIGNsZWFyVGltZW91dCh2aWRlb1RpbWVvdXQpO1xyXG4gICAgaWYgKFxyXG4gICAgICB2aWRlb1V1aWQgJiZcclxuICAgICAgY3VyclZpZGVvICYmXHJcbiAgICAgIHZpZGVvVXVpZCA9PT0gY3VyclZpZGVvLnV1aWQgJiZcclxuICAgICAgIWN1cnJWaWRlby55dD8uY29udGVudERldGFpbHM/LmR1cmF0aW9uICYmXHJcbiAgICAgICFjdXJyVmlkZW8uc2NyYXBlZER1cmF0aW9uICYmXHJcbiAgICAgIG1zZy5kdXJhdGlvblxyXG4gICAgKSB7XHJcbiAgICAgIGN1cnJWaWRlby5zY3JhcGVkRHVyYXRpb24gPSBtc2cuZHVyYXRpb247XHJcbiAgICAgIGF3YWl0IHNhdmVWaWRlb3MoW2N1cnJWaWRlb10pO1xyXG4gICAgfVxyXG4gIH0gZWxzZSBpZiAobXNnPy50eXBlID09PSBcInZpZGVvRW5kZWRcIikge1xyXG4gICAgY29uc29sZS5sb2coYGVuZCB1dWlkOiR7dmlkZW9VdWlkfSBsYXN0RW5kZWQ6JHtsYXN0RW5kZWRWaWRlb1V1aWR9YCk7XHJcbiAgICBpZiAobGFzdEVuZGVkVmlkZW9VdWlkID09PSB2aWRlb1V1aWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coXCJ1cGRhdGUgbGFzdEVuZGVkXCIpO1xyXG4gICAgbGFzdEVuZGVkVmlkZW9VdWlkID0gdmlkZW9VdWlkO1xyXG4gICAgaWYgKHZpZGVvVXVpZCAmJiBjdXJyVmlkZW8gJiYgdmlkZW9VdWlkID09PSBjdXJyVmlkZW8udXVpZCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcImxvZ1wiKTtcclxuICAgICAgYXdhaXQgbG9nRXZlbnQoY3Vyckl0ZW0sIFwicGxheVwiKTtcclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKFwicGxheU5leHRWaWRlb1wiKTtcclxuICAgIHBsYXlOZXh0VmlkZW8oKTtcclxuICB9IGVsc2UgaWYgKG1zZy50eXBlID09PSBcInF1ZXVlOmFkZFZpZGVvXCIpIHtcclxuICAgIGFkZFZpZGVvT3JQbGF5bGlzdCh7IHR5cGU6IFwidmlkZW9cIiwgZm9yZWlnbktleTogbXNnLmZvcmVpZ25LZXkgfSk7XHJcbiAgfSBlbHNlIGlmIChtc2cudHlwZSA9PT0gXCJxdWV1ZTphZGRQbGF5bGlzdFwiKSB7XHJcbiAgICBhd2FpdCBhZGRWaWRlb09yUGxheWxpc3QoeyB0eXBlOiBcInBsYXlsaXN0XCIsIGZvcmVpZ25LZXk6IG1zZy5mb3JlaWduS2V5IH0pO1xyXG4gIH0gZWxzZSBpZiAobXNnLnR5cGUgPT09IFwiZGVsZXRlRGF0YWJhc2VSZXF1ZXN0XCIpIHtcclxuICAgIGRlbGV0ZURCKCk7XHJcbiAgfSBlbHNlIGlmIChtc2cudHlwZSA9PT0gXCJpbXBvcnREYXRhYmFzZVwiKSB7XHJcbiAgICBpbXBvcnREQihtc2cuZmlsZVBhdGgpO1xyXG4gIH0gZWxzZSBpZiAobXNnLnR5cGUgPT09IFwiZXhwb3J0RGF0YWJhc2VcIikge1xyXG4gICAgZXhwb3J0REIoKTtcclxuICB9IGVsc2UgaWYgKG1zZy50eXBlID09PSBcInZpZGVvQ3VlTmV4dFwiKSB7XHJcbiAgICBjdWVOZXh0VmlkZW8oKTtcclxuICB9IGVsc2UgaWYgKG1zZy50eXBlID09PSBcImltcG9ydExvY2FsRGlyZWN0b3J5XCIpIHtcclxuICAgIGltcG9ydExvY2FsRmlsZXMobXNnKTtcclxuICB9IGVsc2UgaWYgKG1zZy50eXBlID09PSBcInJvdGF0ZVZpZGVvXCIpIHtcclxuICAgIHJvdGF0ZVZpZGVvKG1zZyk7XHJcbiAgfSBlbHNlIGlmIChtc2cudHlwZSA9PT0gXCJxdWV1ZU1vZGVDaGFuZ2VkXCIpIHtcclxuICAgIHF1ZXVlTW9kZSA9IG1zZy5tb2RlO1xyXG4gIH0gZWxzZSBpZiAobXNnLnR5cGUgPT09IFwidGh1bWJuYWlsLXNhdmVkXCIpIHtcclxuICAgIGxldCB2aWRlbyA9IERCREFUQS5xdWV1ZS5maW5kKCh2KSA9PiB2LnV1aWQgPT09IG1zZy51dWlkKTtcclxuICAgIGlmICghdmlkZW8gfHwgdmlkZW8uc291cmNlICE9PSBcImxvY2FsXCIpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJFcnJvclwiLCB2aWRlbyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB2aWRlby5sb2NhbFRodW1ibmFpbFBhdGggPSBtc2cuZmlsZVBhdGg7XHJcbiAgICAgIGF3YWl0IGRiLnNhdmVWaWRlb3ModmlkZW8pO1xyXG4gICAgfVxyXG4gIH0gZWxzZSBpZiAobXNnLnR5cGUgPT09IFwidmlkZW9Sb3RhdGVkXCIpIHtcclxuICAgIHJvdGF0ZVZpZGVvKCk7XHJcbiAgfSBlbHNlIGlmIChtc2cudHlwZSA9PT0gXCJtZW51UmFkaW9cIiAmJiBtc2cuc3VidHlwZSA9PT0gXCJMYXlvdXRcIikge1xyXG4gICAgYWN0aXZhdGVUYWIobXNnLnZhbHVlKTtcclxuICB9XHJcbn0pO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gZXhwb3J0REIoKSB7XHJcbiAgY29uc3QgcGxheWxpc3RzID0gYXdhaXQgZGIubG9hZFBsYXlsaXN0cygpO1xyXG4gIGNvbnN0IHZpZGVvcyA9IGF3YWl0IGRiLmxvYWRWaWRlb3MoKTtcclxuICBjb25zdCBsb2cgPSBhd2FpdCBkYi5nZXRMYXN0TkxvZ3MoTUFYTE9HRFVNUCk7XHJcbiAgY29uc3QgZXhwb3J0RGF0YSA9IHtcclxuICAgIHZlcnNpb246IGRiLlZFUlNJT04sXHJcbiAgICBwbGF5bGlzdHMsXHJcbiAgICB2aWRlb3MsXHJcbiAgICBsb2csXHJcbiAgfTtcclxuXHJcbiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtKU09OLnN0cmluZ2lmeShleHBvcnREYXRhLCBudWxsLCAyKV0sIHtcclxuICAgIHR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0pO1xyXG4gIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcblxyXG4gIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcclxuICBhLmhyZWYgPSB1cmw7XHJcbiAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnJlcGxhY2UoL1s6Ll0vZywgXCItXCIpO1xyXG4gIGEuZG93bmxvYWQgPSBgZGVqYS1xdWV1ZS1leHBvcnQtJHtwcm9maWxlfS0ke3RpbWVzdGFtcH0uanNvbmA7XHJcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtcclxuICBhLmNsaWNrKCk7XHJcbiAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTtcclxuXHJcbiAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBpbXBvcnREQihmaWxlKSB7XHJcbiAgY29uc29sZS5sb2coXCJJbXBvcnRpbmcgREIgZnJvbSBmaWxlOlwiLCBmaWxlKTtcclxuICBjb25zdCB0ZXh0ID0gYXdhaXQgd2luZG93LmVsZWN0cm9uQVBJLnJlYWRGaWxlKGZpbGUpO1xyXG4gIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHRleHQpO1xyXG4gIGF3YWl0IGRiLmRlbGV0ZURCKCk7XHJcbiAgaWYgKGRhdGE/LnZlcnNpb24gIT09IDQpIHtcclxuICAgIGNvbnN0IHZpZGVvTWFwID0gbmV3IE1hcCgpO1xyXG4gICAgZm9yIChsZXQgdiBvZiBkYXRhLnZpZGVvcykge1xyXG4gICAgICAvLyByZW5hbWUgaWQgdG8gZm9yZWlnbktleVxyXG4gICAgICB2LmZvcmVpZ25LZXkgPSB2LmlkO1xyXG4gICAgICBkZWxldGUgdi5pZDtcclxuICAgICAgdi51dWlkID0gZGIudXVpZHY0KCk7XHJcbiAgICAgIHYuc291cmNlID0gXCJ5b3V0dWJlXCI7XHJcblxyXG4gICAgICB2aWRlb01hcC5zZXQodi5mb3JlaWduS2V5LCB2LnV1aWQpO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgcCBvZiBkYXRhLnBsYXlsaXN0cykge1xyXG4gICAgICAvLyByZW5hbWUgaWQgdG8gZm9yZWlnbktleVxyXG4gICAgICBwLmZvcmVpZ25LZXkgPSBwLmlkO1xyXG4gICAgICBkZWxldGUgcC5pZDtcclxuICAgICAgcC51dWlkID0gZGIudXVpZHY0KCk7XHJcbiAgICAgIHAuc291cmNlID0gXCJ5b3V0dWJlXCI7XHJcblxyXG4gICAgICAvLyByZW1hcCB2aWRlb0lkcyB0byB2aWRlbyBVVUlEc1xyXG4gICAgICBwLnZpZGVvVXVpZHMgPSBwLnZpZGVvSWRzLm1hcCgoZmspID0+IHZpZGVvTWFwLmdldChmaykpLmZpbHRlcihCb29sZWFuKTtcclxuICAgICAgZGVsZXRlIHAudmlkZW9JZHM7XHJcbiAgICB9XHJcbiAgICBkYXRhLmxvZyA9IFtdO1xyXG4gIH1cclxuICBhd2FpdCBzYXZlVmlkZW9zKGRhdGEudmlkZW9zKTsgLy8gb25seSByZXBsYWNlcyBlYWNoIGlkIHdpdGggbmV3IGNvbnRlbnRcclxuICBhd2FpdCBzYXZlUGxheWxpc3RzKGRhdGEucGxheWxpc3RzKTsgLy8gb25seSByZXBsYWNlcyBlYWNoIGlkIHdpdGggbmV3IGNvbnRlbnRcclxuICBhd2FpdCBkYi5zYXZlTG9nKGRhdGEubG9nKTtcclxuICBjb25zb2xlLmxvZyhcIlZpZGVvcyBpbXBvcnRlZCBzdWNjZXNzZnVsbHlcIik7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZURCKCkge1xyXG4gIGNvbnN0IGNvbmZpcm1lZCA9IHdpbmRvdy5jb25maXJtKFxyXG4gICAgXCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoZSBkYXRhYmFzZT8gVGhpcyBjYW5ub3QgYmUgdW5kb25lLlwiXHJcbiAgKTtcclxuICBpZiAoIWNvbmZpcm1lZCkgcmV0dXJuOyAvLyB1c2VyIGNhbmNlbGxlZFxyXG4gIGF3YWl0IGRiLmRlbGV0ZURCKCk7XHJcbiAgYWxlcnQoXCJEYXRhYmFzZSBkZWxldGVkLiBQbGVhc2UgcmVsb2FkIHRoZSBwYWdlLlwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0TmVzdGVkVmFsdWUob2JqLCBwYXRoKSB7XHJcbiAgcmV0dXJuIHBhdGguc3BsaXQoXCIuXCIpLnJlZHVjZSgobywga2V5KSA9PiAobyA/IG9ba2V5XSA6IHVuZGVmaW5lZCksIG9iaik7XHJcbn1cclxuXHJcbmxldCB0YWJ1bGF0b3JEQiA9IG51bGw7XHJcbmZ1bmN0aW9uIHNldEdsb2JhbFNlYXJjaChteVRhYnVsYXRvclRhYmxlLCB2YWx1ZSkge1xyXG4gIGNvbnN0IHQwID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgbGV0IHRlcm1zID0gdmFsdWUudG9Mb3dlckNhc2UoKS5zcGxpdChcIiBcIik7XHJcbiAgbGV0IGZpZWxkcyA9IG15VGFidWxhdG9yVGFibGVcclxuICAgIC5nZXRDb2x1bW5zKClcclxuICAgIC5tYXAoKGNvbCkgPT4gY29sLmdldERlZmluaXRpb24oKS5maWVsZClcclxuICAgIC5maWx0ZXIoKGZpZWxkKSA9PiBmaWVsZCAhPSBudWxsKTtcclxuICBteVRhYnVsYXRvclRhYmxlLnNldEZpbHRlcigoZGF0YSkgPT4ge1xyXG4gICAgcmV0dXJuIHRlcm1zLmV2ZXJ5KCh0ZXJtKSA9PlxyXG4gICAgICBmaWVsZHMuc29tZSgoZmllbGQpID0+IHtcclxuICAgICAgICBjb25zdCB2YWwgPSBnZXROZXN0ZWRWYWx1ZShkYXRhLCBmaWVsZCk7XHJcbiAgICAgICAgcmV0dXJuIHZhbCAmJiB2YWwudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHRlcm0pO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9KTtcclxuICBjb25zdCB0MSA9IHBlcmZvcm1hbmNlLm5vdygpO1xyXG4gIGNvbnNvbGUubG9nKGBHbG9iYWxTZWFyY2ggdG9vayAkeyh0MSAtIHQwKS50b0ZpeGVkKDApfSBtc2ApO1xyXG59XHJcblxyXG5jb25zdCBkYkZpbHRlckVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkYkZpbHRlclwiKTtcclxuZGJGaWx0ZXJFbC5hZGRFdmVudExpc3RlbmVyKFxyXG4gIFwiaW5wdXRcIixcclxuICBkZWJvdW5jZSgoZSkgPT4ge1xyXG4gICAgc2V0R2xvYmFsU2VhcmNoKHRhYnVsYXRvckRCLCBlLnRhcmdldC52YWx1ZSk7XHJcbiAgfSwgMzAwKSAvLyAzMDBtcyBkZWJvdW5jZVxyXG4pO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gcmVuZGVyREIocXVldWUpIHtcclxuICBxdWV1ZSA9IHF1ZXVlLmZpbHRlcigoaXRlbSkgPT4gaXRlbS50eXBlICE9IFwicGxheWxpc3RcIik7XHJcbiAgbGV0IHRhYmxlQ29sdW1ucyA9IGdldFRhYmxlQ29sdW1ucyh0cnVlKTtcclxuICBsZXQgY29sdW1ucyA9IFtcclxuICAgIHRhYmxlQ29sdW1ucy50aHVtYixcclxuICAgIHRhYmxlQ29sdW1ucy50aXRsZSxcclxuICAgIHRhYmxlQ29sdW1ucy50cmFjayxcclxuICAgIHRhYmxlQ29sdW1ucy50YWdzLFxyXG4gICAgdGFibGVDb2x1bW5zLmR1cixcclxuICAgIHRhYmxlQ29sdW1ucy5sYXN0UGxheWVkLFxyXG4gICAgdGFibGVDb2x1bW5zLmR1ZSxcclxuICAgIHRhYmxlQ29sdW1ucy5wbGF5Q250LFxyXG4gICAgdGFibGVDb2x1bW5zLnJhdGluZyxcclxuICAgIHRhYmxlQ29sdW1ucy5pbnRlcnZhbCxcclxuICAgIHRhYmxlQ29sdW1ucy5zY29yZSxcclxuICAgIHRhYmxlQ29sdW1ucy5kZWxheSxcclxuICAgIHRhYmxlQ29sdW1ucy5lcnJDbnQsXHJcbiAgICB0YWJsZUNvbHVtbnMuZHVwLFxyXG4gICAgdGFibGVDb2x1bW5zLmNoYW5uZWwsXHJcbiAgICB0YWJsZUNvbHVtbnMuZm9yZWlnbktleSxcclxuICAgIHRhYmxlQ29sdW1ucy5zb3VyY2UsXHJcbiAgXTtcclxuXHJcbiAgY29sdW1ucy5tYXAoKGMpID0+IHtcclxuICAgIGMuaGVhZGVyV29yZFdyYXAgPSBmYWxzZTtcclxuICB9KTtcclxuXHJcbiAgaWYgKHRhYnVsYXRvckRCKSB7XHJcbiAgICB0YWJ1bGF0b3JEQi5yZXBsYWNlRGF0YShxdWV1ZSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICB0YWJ1bGF0b3JEQiA9IG5ldyBUYWJ1bGF0b3IoXCIjZGF0YWJhc2UtZ3JpZFwiLCB7XHJcbiAgICAuLi5iYXNlVGFidWxhdG9yT3B0aW9ucyxcclxuICAgIGRhdGE6IHF1ZXVlLFxyXG4gICAgY29sdW1uczogY29sdW1ucyxcclxuICAgIGN1c3RvbTogeyBjdXJyZW50OiBmYWxzZSB9LCAvLyBjdXN0b20gcHJvcGVydHlcclxuICAgIGhlaWdodDogXCIxMDAlXCIsXHJcbiAgICB3aWR0aDogXCIxMDAlXCIsXHJcbiAgICByb3dIZWlnaHQ6IENPTVBBQ1RfVEFCTEVfSEVJR0hULFxyXG4gICAgbW92YWJsZUNvbHVtbnM6IHRydWUsXHJcbiAgfSk7XHJcbiAgdGFidWxhdG9yREIub24oXCJoZWFkZXJDb250ZXh0XCIsIChldmVudCkgPT4ge1xyXG4gICAgaGVhZGVyTWVudShldmVudCwgdGFidWxhdG9yREIpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjYWxjU3RyaW5nU2ltaWxhcml0eShxdWV1ZSkge1xyXG4gIGxldCBsaXN0ID0gW107XHJcbiAgZm9yIChsZXQgYSBvZiBxdWV1ZSkge1xyXG4gICAgZm9yIChsZXQgYiBvZiBxdWV1ZSkge1xyXG4gICAgICBpZiAoYSA9PT0gYikgY29udGludWU7XHJcbiAgICAgIGNvbnN0IHNpbWlsYXJpdHlTY29yZSA9IHN0cmluZ1NpbWlsYXJpdHkuY29tcGFyZVR3b1N0cmluZ3MoXHJcbiAgICAgICAgYS55dD8uc25pcHBldD8udGl0bGUsXHJcbiAgICAgICAgYi55dD8uc25pcHBldD8udGl0bGVcclxuICAgICAgKTtcclxuICAgICAgbGlzdC5wdXNoKHsgc2ltaWxhcml0eVNjb3JlLCBhLCBiIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuICBsaXN0LnNvcnQoKGEsIGIpID0+IGIuc2ltaWxhcml0eVNjb3JlIC0gYS5zaW1pbGFyaXR5U2NvcmUpO1xyXG4gIGxldCBuID0gMDtcclxuICBmb3IgKGxldCBzcyBvZiBsaXN0KSB7XHJcbiAgICBjb25zb2xlLmxvZyhcclxuICAgICAgc3Muc2ltaWxhcml0eVNjb3JlLFxyXG4gICAgICBzcy5hLnl0Py5zbmlwcGV0Py50aXRsZSxcclxuICAgICAgc3MuYi55dD8uc25pcHBldD8udGl0bGVcclxuICAgICk7XHJcbiAgICBuKys7XHJcbiAgICBpZiAobiA+IDEwMCkgYnJlYWs7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkZWJvdW5jZShmbiwgZGVsYXkgPSAzMDApIHtcclxuICBsZXQgdGltZW91dElkO1xyXG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xyXG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcbiAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgZm4oLi4uYXJncyk7XHJcbiAgICB9LCBkZWxheSk7XHJcbiAgfTtcclxufVxyXG5cclxubGV0IHBsYXlsaXN0c1RhYnVsYXRvciA9IG51bGw7XHJcbmNvbnN0IHBsRmlsdGVyRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsRmlsdGVyXCIpO1xyXG5wbEZpbHRlckVsLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgXCJpbnB1dFwiLFxyXG4gIGRlYm91bmNlKChlKSA9PiB7XHJcbiAgICBzZXRHbG9iYWxTZWFyY2gocGxheWxpc3RzVGFidWxhdG9yLCBlLnRhcmdldC52YWx1ZSk7XHJcbiAgfSwgMzAwKSAvLyAzMDBtcyBkZWJvdW5jZVxyXG4pO1xyXG5cclxuZnVuY3Rpb24gaGVhZGVyTWVudShldmVudCwgdGFibGVzKSB7XHJcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgbWVudUl0ZW1zID0gW107XHJcbiAgY29uc3QgY29sdW1ucyA9IHRhYmxlcy5nZXRDb2x1bW5zKCk7XHJcblxyXG4gIGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XHJcbiAgICBjb25zdCBsYWJlbFNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcclxuICAgIGxhYmVsU3Bhbi5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yXCIpO1xyXG4gICAgY29uc3QgdXBkYXRlTGFiZWwgPSAoKSA9PiB7XHJcbiAgICAgIGxhYmVsU3Bhbi50ZXh0Q29udGVudCA9XHJcbiAgICAgICAgKGNvbHVtbi5pc1Zpc2libGUoKSA/IFwi4piRIFwiIDogXCLimJAgXCIpICsgY29sdW1uLmdldERlZmluaXRpb24oKS50aXRsZTtcclxuICAgIH07XHJcbiAgICB1cGRhdGVMYWJlbCgpO1xyXG5cclxuICAgIG1lbnVJdGVtcy5wdXNoKHtcclxuICAgICAgbGFiZWw6IGxhYmVsU3BhbixcclxuICAgICAgYWN0aW9uOiBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBjb2x1bW4udG9nZ2xlKCk7XHJcbiAgICAgICAgdXBkYXRlTGFiZWwoKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH0pO1xyXG4gIGNvbnN0IHJlbmRlck1lbnUgPSAoKSA9PiB7XHJcbiAgICAvLyBSZW1vdmUgZXhpc3RpbmcgbWVudVxyXG4gICAgY29uc3QgZXhpc3RpbmdNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0YWItbWVudVwiKTtcclxuICAgIGlmIChleGlzdGluZ01lbnUpIGV4aXN0aW5nTWVudS5yZW1vdmUoKTtcclxuXHJcbiAgICBjb25zdCBtZW51RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIG1lbnVEaXYuaWQgPSBcInRhYi1tZW51XCI7XHJcbiAgICBtZW51RGl2LnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xyXG4gICAgbWVudURpdi5zdHlsZS50b3AgPSBldmVudC5wYWdlWSArIFwicHhcIjtcclxuICAgIG1lbnVEaXYuc3R5bGUubGVmdCA9IGV2ZW50LnBhZ2VYICsgXCJweFwiO1xyXG5cclxuICAgIG1lbnVJdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGl0ZW1EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBpdGVtRGl2LmFwcGVuZENoaWxkKGl0ZW0ubGFiZWwpO1xyXG4gICAgICBpdGVtRGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXYpID0+IHtcclxuICAgICAgICBpdGVtLmFjdGlvbihldik7XHJcbiAgICAgIH0pO1xyXG4gICAgICBtZW51RGl2LmFwcGVuZENoaWxkKGl0ZW1EaXYpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtZW51RGl2KTtcclxuXHJcbiAgICBjb25zdCByZW1vdmVNZW51ID0gKCkgPT4ge1xyXG4gICAgICBtZW51RGl2LnJlbW92ZSgpO1xyXG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcmVtb3ZlTWVudSk7XHJcbiAgICB9O1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcmVtb3ZlTWVudSksIDApO1xyXG4gIH07XHJcbiAgcmVuZGVyTWVudSgpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiByZW5kZXJQbGF5bGlzdHMoKSB7XHJcbiAgbGV0IHRhYmxlMlN0eWxlQ29sdW1ucyA9IGdldFRhYmxlQ29sdW1ucyh0cnVlKTtcclxuICBsZXQgY29sdW1ucyA9IFtcclxuICAgIHRhYmxlMlN0eWxlQ29sdW1ucy5kYXRhVHJlZSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiVGh1bWJcIixcclxuICAgICAgZmllbGQ6IFwidGh1bWJuYWlsVXJsXCIsXHJcbiAgICAgIGZvcm1hdHRlcjogXCJpbWFnZVwiLFxyXG4gICAgICBmb3JtYXR0ZXJQYXJhbXM6IHtcclxuICAgICAgICBvYmplY3RGaXQ6IFwiY29udGFpblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBjZWxsQ2xpY2s6IGFzeW5jIGZ1bmN0aW9uIChlLCBjZWxsKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IGNlbGwuZ2V0Um93KCkuZ2V0RGF0YSgpO1xyXG4gICAgICAgIG1vdmVWaWRlb1RvRnJvbnQoaXRlbS51dWlkKTtcclxuICAgICAgICBhd2FpdCByZW5kZXJRdWV1ZSgpO1xyXG4gICAgICAgIHNob3dUb2FzdChcIkFkZGVkIHRvIGZyb250IG9mIHF1ZXVlXCIpO1xyXG4gICAgICB9LFxyXG4gICAgICBob3pBbGlnbjogXCJjZW50ZXJcIixcclxuICAgICAgdmVydEFsaWduOiBcImNlbnRlclwiLFxyXG4gICAgICB3aWR0aDogQ09NUEFDVF9USFVNQl9XSURUSCxcclxuICAgIH0sXHJcbiAgICB0YWJsZTJTdHlsZUNvbHVtbnMudGl0bGUsXHJcbiAgICB0YWJsZTJTdHlsZUNvbHVtbnMudHJhY2ssXHJcbiAgICB0YWJsZTJTdHlsZUNvbHVtbnMudGFncyxcclxuICAgIHRhYmxlMlN0eWxlQ29sdW1ucy5kdXIsXHJcbiAgICB0YWJsZTJTdHlsZUNvbHVtbnMubGFzdFBsYXllZCxcclxuICAgIHRhYmxlMlN0eWxlQ29sdW1ucy5kdWUsXHJcbiAgICB0YWJsZTJTdHlsZUNvbHVtbnMucGxheUNudCxcclxuICAgIHRhYmxlMlN0eWxlQ29sdW1ucy5QTF9jaGFubmVsLFxyXG4gICAgdGFibGUyU3R5bGVDb2x1bW5zLmRhdGVBZGRlZCxcclxuICAgIHRhYmxlMlN0eWxlQ29sdW1ucy5yYXRpbmcsXHJcbiAgICB0YWJsZTJTdHlsZUNvbHVtbnMuaW50ZXJ2YWwsXHJcbiAgICB0YWJsZTJTdHlsZUNvbHVtbnMuc2NvcmUsXHJcbiAgICB0YWJsZTJTdHlsZUNvbHVtbnMuZXJyQ250LFxyXG4gICAgLy8gVE9ETzogQWRkIGJhY2sgYWJpbGl0eSB0byBzaG93IHRoZSBhY3R1YWwgSUQuXHJcbiAgICAvLyB7IHRpdGxlOiBcIklEXCIsIGZpZWxkOiBcImlkX2Zha2VcIiwgaG96QWxpZ246IFwibGVmdFwiLCB3aWR0aDogMjAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiQWN0XCIsXHJcbiAgICAgIGZpZWxkOiBcImFjdFwiLCAvLyBmYWtlIGZpZWxkXHJcbiAgICAgIGZvcm1hdHRlcjogKGNlbGwpID0+IHtcclxuICAgICAgICBsZXQgZGF0YSA9IGNlbGwuZ2V0Um93KCkuZ2V0RGF0YSgpO1xyXG4gICAgICAgIHJldHVybiBkYXRhLnR5cGUgPT0gXCJwbGF5bGlzdFwiID8gXCLwn5eR77iPXCIgOiBcIuKdjFwiO1xyXG4gICAgICB9LFxyXG4gICAgICBjZWxsQ2xpY2s6IGFzeW5jIChlLCBjZWxsKSA9PiB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBjZWxsLmdldFJvdygpLmdldERhdGEoKTtcclxuICAgICAgICBpZiAoZGF0YS50eXBlID09IFwicGxheWxpc3RcIikge1xyXG4gICAgICAgICAgaWYgKGNvbmZpcm0oYERlbGV0ZSB0aGlzIHBsYXlsaXN0PyAke2RhdGEudGl0bGV9YCkpIHtcclxuICAgICAgICAgICAgYXdhaXQgZGIuZGVsZXRlUGxheWxpc3QoZGF0YS51dWlkKTtcclxuICAgICAgICAgICAgY2VsbC5nZXRSb3coKS5kZWxldGUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc3QgcGxheWxpc3QgPSBjZWxsLmdldFJvdygpLmdldFRyZWVQYXJlbnQoKS5nZXREYXRhKCk7XHJcbiAgICAgICAgICBjb25zdCBjb3VudCA9IHBsYXlsaXN0LnZpZGVvVXVpZHMuZmlsdGVyKFxyXG4gICAgICAgICAgICAodXVpZCkgPT4gdXVpZCA9PT0gZGF0YS51dWlkXHJcbiAgICAgICAgICApLmxlbmd0aDtcclxuICAgICAgICAgIGlmIChjb3VudCA+IDEpIHtcclxuICAgICAgICAgICAgaWYgKGNvbmZpcm0oYFJlbW92ZSBkdXBzIG9mIHRoaXMgdmlkZW8/ICR7ZGF0YS50aXRsZX1gKSkge1xyXG4gICAgICAgICAgICAgIGxldCBzZWVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgcGxheWxpc3QudmlkZW9VdWlkcyA9IHBsYXlsaXN0LnZpZGVvVXVpZHMuZmlsdGVyKCh1dWlkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodXVpZCAhPT0gZGF0YS51dWlkKSByZXR1cm4gdHJ1ZTsgLy8ga2VlcCBvdGhlciBJRHNcclxuICAgICAgICAgICAgICAgIGlmICghc2Vlbikge1xyXG4gICAgICAgICAgICAgICAgICBzZWVuID0gdHJ1ZTsgLy8ga2VlcCB0aGUgZmlyc3Qgb2NjdXJyZW5jZVxyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gcmVtb3ZlIHN1YnNlcXVlbnQgZHVwbGljYXRlc1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHNlZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICBmb3IgKGNvbnN0IHNpYmxpbmdSb3cgb2YgY2VsbFxyXG4gICAgICAgICAgICAgICAgLmdldFJvdygpXHJcbiAgICAgICAgICAgICAgICAuZ2V0VHJlZVBhcmVudCgpXHJcbiAgICAgICAgICAgICAgICAuZ2V0VHJlZUNoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgIGxldCByb3dEYXRhID0gc2libGluZ1Jvdy5nZXREYXRhKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocm93RGF0YS51dWlkICE9PSBkYXRhLnV1aWQpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzZWVuKSB7XHJcbiAgICAgICAgICAgICAgICAgIHNlZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNpYmxpbmdSb3cuZGVsZXRlKCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGF3YWl0IHNhdmVQbGF5bGlzdHMocGxheWxpc3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoY29uZmlybShgUmVtb3ZlIHRoaXMgdmlkZW8gZnJvbSBwbGF5bGlzdD8gJHtkYXRhLnRpdGxlfWApKSB7XHJcbiAgICAgICAgICAgICAgcGxheWxpc3QudmlkZW9VdWlkcyA9IHBsYXlsaXN0LnZpZGVvVXVpZHMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgKHZ1dWlkKSA9PiB2dXVpZCAhPT0gZGF0YS51dWlkXHJcbiAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICBjZWxsLmdldFJvdygpLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHNhdmVQbGF5bGlzdHMocGxheWxpc3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBob3pBbGlnbjogXCJjZW50ZXJcIixcclxuICAgIH0sXHJcbiAgXTtcclxuXHJcbiAgaWYgKHBsYXlsaXN0c1RhYnVsYXRvcikge1xyXG4gICAgY29uc3QgZXhwYW5kZWRJZHMgPSBbXTtcclxuICAgIHBsYXlsaXN0c1RhYnVsYXRvci5nZXREYXRhKCkuZm9yRWFjaCgoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCByb3cgPSBwbGF5bGlzdHNUYWJ1bGF0b3IuZ2V0Um93KGRhdGEudXVpZCk7XHJcbiAgICAgIGlmIChyb3cgJiYgcm93LmlzVHJlZUV4cGFuZGVkKCkpIHtcclxuICAgICAgICBleHBhbmRlZElkcy5wdXNoKGRhdGEudXVpZCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcGxheWxpc3RzVGFidWxhdG9yLnJlcGxhY2VEYXRhKERCREFUQS5wbGF5bGlzdHMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICBleHBhbmRlZElkcy5mb3JFYWNoKCh1dWlkKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgcm93ID0gcGxheWxpc3RzVGFidWxhdG9yLmdldFJvdyh1dWlkKTtcclxuICAgICAgICBpZiAocm93KSByb3cudHJlZUV4cGFuZCgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHBsYXlsaXN0c1RhYnVsYXRvcjtcclxuICB9XHJcblxyXG4gIHBsYXlsaXN0c1RhYnVsYXRvciA9IG5ldyBUYWJ1bGF0b3IoXCIjcGxheWxpc3RzLWdyaWRcIiwge1xyXG4gICAgLi4uYmFzZVRhYnVsYXRvck9wdGlvbnMsXHJcbiAgICBkYXRhOiBEQkRBVEEucGxheWxpc3RzLFxyXG4gICAgY29sdW1uczogY29sdW1ucyxcclxuICAgIHJvd0hlaWdodDogQ09NUEFDVF9UQUJMRV9IRUlHSFQsXHJcbiAgICBkYXRhVHJlZTogdHJ1ZSxcclxuICAgIGRhdGFUcmVlRmlsdGVyOiBmYWxzZSxcclxuICAgIGhlaWdodDogXCIxMDAlXCIsXHJcbiAgICB3aWR0aDogXCIxMDAlXCIsXHJcbiAgfSk7XHJcbiAgcGxheWxpc3RzVGFidWxhdG9yLm9uKFwiaGVhZGVyQ29udGV4dFwiLCAoZXZlbnQpID0+IHtcclxuICAgIGhlYWRlck1lbnUoZXZlbnQsIHBsYXlsaXN0c1RhYnVsYXRvcik7XHJcbiAgfSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gbW92ZVZpZGVvVG9Gcm9udCh1dWlkKSB7XHJcbiAgY29uc3QgaWR4ID0gREJEQVRBLnF1ZXVlLmZpbmRJbmRleCgodikgPT4gdi51dWlkID09PSB1dWlkKTtcclxuICBpZiAoaWR4ID09PSAtMSkge1xyXG4gICAgY29uc29sZS5sb2coXCJFcnJvciBjb3VsZCBub3QgZmluZCBcIiwgdXVpZCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIC8vIElmIGFscmVhZHkgaWR4MCwgZG8gbm90aGluZ1xyXG4gIGlmIChpZHggPT0gMCkge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICAvLyBJZiBpZHgxLCBza2lwIGlkeDAgYW5kIHBsYXkgdGhpc1xyXG4gIGlmIChpZHggPT0gMSkge1xyXG4gICAgbG9nQW5kUGxheU5leHQoXCJza2lwXCIsIHsgc2tpcFdob2xlTGlzdDogdHJ1ZSB9KTtcclxuICB9XHJcbiAgLy8gT3RoZXJ3aXNlLCBtYWtlIG5ldyBpZHgxXHJcbiAgY29uc3QgW3ZpZGVvXSA9IERCREFUQS5xdWV1ZS5zcGxpY2UoaWR4LCAxKTsgLy8gY3V0IHRoZSAxIHZpZGVvIGZyb20gaWR4XHJcbiAgREJEQVRBLnF1ZXVlLnNwbGljZSgxLCAwLCB2aWRlbyk7IC8vIGluc2VydCBqdXN0IGJlaGluZCBjdXJyZW50XHJcbn1cclxuZnVuY3Rpb24gYWN0aXZhdGVUYWIodGFyZ2V0SWQpIHtcclxuICBpZiAodGFyZ2V0SWQgPT0gXCJWaWRlb1wiKSB7XHJcbiAgICB0YXJnZXRJZCA9IFwieW91dHViZS1mdWxsXCI7XHJcbiAgfVxyXG4gIGNvbnN0IGNvbnRlbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50YWItY29udGVudFwiKTtcclxuICBjb250ZW50cy5mb3JFYWNoKChjKSA9PiBjLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIikpO1xyXG4gIGNvbnN0IHRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3RhcmdldElkfWApO1xyXG4gIGlmICh0YXJnZXQpIHRhcmdldC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xyXG5cclxuICBpZiAodGFyZ2V0SWQgIT09IFwieW91dHViZS1mdWxsXCIpIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeW91dHViZVwiKS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xyXG4gIH1cclxuICBzZW5kTWVzc2FnZSh7IHR5cGU6IFwidGFiLWJ1dHRvblwiLCB0YXJnZXRJZCB9KTtcclxufVxyXG5cclxuYWN0aXZhdGVUYWIod2luZG93LmVsZWN0cm9uQVBJLmdldChcIkxheW91dFwiLCBcIlZpZGVvXCIpKTtcclxuXHJcbmZ1bmN0aW9uIHRyaW1Zb3V0dWJlRmllbGRzKG9iaikge1xyXG4gIGlmIChBcnJheS5pc0FycmF5KG9iaikpIHtcclxuICAgIHJldHVybiBvYmoubWFwKHRyaW1Zb3V0dWJlRmllbGRzKTtcclxuICB9IGVsc2UgaWYgKG9iaiAmJiB0eXBlb2Ygb2JqID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICBjb25zdCBuZXdPYmogPSB7fTtcclxuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKG9iaikpIHtcclxuICAgICAgaWYgKGtleSA9PT0gXCJkZXNjcmlwdGlvblwiIHx8IGtleSA9PT0gXCJyZWdpb25SZXN0cmljdGlvblwiKSB7XHJcbiAgICAgICAgY29udGludWU7IC8vIHNraXAgYWxsIFwiZGVzY3JpcHRpb25cIiBmaWVsZHNcclxuICAgICAgfVxyXG4gICAgICAvLyBUaHVtYm5haWxzOiBrZWVwIG9ubHkgXCJkZWZhdWx0XCJcclxuICAgICAgaWYgKGtleSA9PT0gXCJ0aHVtYm5haWxzXCIgJiYgdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlLmRlZmF1bHQpIHtcclxuICAgICAgICAgIG5ld09ialtrZXldID0geyBkZWZhdWx0OiB0cmltWW91dHViZUZpZWxkcyh2YWx1ZS5kZWZhdWx0KSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb250aW51ZTsgLy8gc2tpcCBvdGhlciBrZXlzXHJcbiAgICAgIH1cclxuICAgICAgbmV3T2JqW2tleV0gPSB0cmltWW91dHViZUZpZWxkcyh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3T2JqO1xyXG4gIH1cclxuICByZXR1cm4gb2JqO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0cmltTG9jYWxGaWVsZHMob2JqKSB7XHJcbiAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xyXG4gICAgb2JqLmZvckVhY2godHJpbUxvY2FsRmllbGRzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaWYgKG9iai5zb3VyY2UgPT0gXCJsb2NhbFwiKSB7XHJcbiAgICAgIG9iai50aXRsZSA9IG9iai50aXRsZS5zcGxpdCgvWy9cXFxcXS8pLnBvcCgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZGJDaGVjaygpIHtcclxuICBsZXQgZXJyb3IgPSBmYWxzZTtcclxuICBEQkRBVEEucXVldWUuZm9yRWFjaCgodikgPT4ge1xyXG4gICAgaWYgKHYudGh1bWJuYWlsVXJsKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiRVJST1JcIiwgdik7XHJcbiAgICAgIGVycm9yID0gdHJ1ZTtcclxuICAgIH1cclxuICB9KTtcclxuICBpZiAoZXJyb3IpIHtcclxuICAgIGFsZXJ0KFwiREIgaW50ZWdyaXR5IGNoZWNrIGZhaWwuIENoZWNrIGRldiBjb25zb2xlLlwiKTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVRhYnVsYXRvcih0YWJ1bGF0b3IsIGl0ZW1zKSB7XHJcbiAgaWYgKCF0YWJ1bGF0b3IpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgZnVuY3Rpb24gd2Fsayhyb3dzKSB7XHJcbiAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XHJcbiAgICAgIGxldCBkYXRhID0gcm93LmdldERhdGEoKTtcclxuICAgICAgbGV0IGl0ZW0gPSBpdGVtcy5maW5kKChpdGVtKSA9PiBpdGVtLnV1aWQgPT0gZGF0YS51dWlkKTtcclxuICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICByb3cucmVmb3JtYXQoKTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBjaGlsZHJlbiA9IHJvdy5nZXRUcmVlQ2hpbGRyZW4/LigpO1xyXG4gICAgICBpZiAoY2hpbGRyZW4/Lmxlbmd0aCkge1xyXG4gICAgICAgIHdhbGsoY2hpbGRyZW4pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIHdhbGsodGFidWxhdG9yLmdldFJvd3MoKSk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHJlcmVuZGVyQWxsKGl0ZW1zID0gW10pIHtcclxuICBpZiAoaXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgYXdhaXQgdXBkYXRlVGFidWxhdG9yKHBsYXlsaXN0c1RhYnVsYXRvciwgaXRlbXMpO1xyXG4gICAgYXdhaXQgdXBkYXRlVGFidWxhdG9yKHRhYnVsYXRvclF1ZXVlLCBpdGVtcyk7XHJcbiAgICBhd2FpdCB1cGRhdGVUYWJ1bGF0b3IodGFidWxhdG9yREIsIGl0ZW1zKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgaWYgKHBsYXlsaXN0c1RhYnVsYXRvcikge1xyXG4gICAgYXdhaXQgcmVuZGVyUGxheWxpc3RzKCk7XHJcbiAgfVxyXG4gIGlmICh0YWJ1bGF0b3JRdWV1ZSkge1xyXG4gICAgYXdhaXQgcmVuZGVyUXVldWUoKTtcclxuICB9XHJcbiAgaWYgKHRhYnVsYXRvckRCKSB7XHJcbiAgICBhd2FpdCByZW5kZXJEQihEQkRBVEEucXVldWUpO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2F2ZVZpZGVvcyh2aWRlb3MpIHtcclxuICB2aWRlb3MgPSBBcnJheS5pc0FycmF5KHZpZGVvcykgPyB2aWRlb3MgOiBbdmlkZW9zXTtcclxuICBhd2FpdCBkYi5zYXZlVmlkZW9zKHZpZGVvcyk7XHJcbiAgYXdhaXQgcmVyZW5kZXJBbGwodmlkZW9zKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2F2ZVBsYXlsaXN0cyhwbGF5bGlzdHMpIHtcclxuICBwbGF5bGlzdHMgPSBBcnJheS5pc0FycmF5KHBsYXlsaXN0cykgPyBwbGF5bGlzdHMgOiBbcGxheWxpc3RzXTtcclxuICBhd2FpdCBkYi5zYXZlUGxheWxpc3RzKHBsYXlsaXN0cyk7XHJcbiAgYXdhaXQgcmVyZW5kZXJBbGwocGxheWxpc3RzKTtcclxufVxyXG5cclxuLy8gSW5pdGlhbCBsb2FkXHJcbihhc3luYyAoKSA9PiB7XHJcbiAgREJEQVRBLnF1ZXVlID0gYXdhaXQgZGIubG9hZFZpZGVvcygpO1xyXG4gIERCREFUQS5wbGF5bGlzdHMgPSBhd2FpdCBkYi5sb2FkUGxheWxpc3RzKCk7XHJcbiAgZGJDaGVjaygpO1xyXG4gIC8vIERCREFUQS5xdWV1ZSA9IHRyaW1Zb3V0dWJlRmllbGRzKERCREFUQS5xdWV1ZSk7XHJcbiAgLy8gdHJpbUxvY2FsRmllbGRzKERCREFUQS5xdWV1ZSk7IC8vIFRoaXMgb25lIG11dGF0ZXMsIGFuZCB0aGUgb3RoZXIgb25lIGRvZXNuJ3Q/IHVnaFxyXG4gIC8vIERCREFUQS5wbGF5bGlzdHMgPSB0cmltWW91dHViZUZpZWxkcyhEQkRBVEEucGxheWxpc3RzKTtcclxuICBEQkRBVEEucXVldWUgPSB1dGlscy5hZGRDb21wdXRlZEZpZWxkc1ZpZGVvKERCREFUQS5xdWV1ZSk7XHJcbiAgREJEQVRBLnF1ZXVlLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKTtcclxuICBEQkRBVEEucGxheWxpc3RzID0gdXRpbHMuYWRkQ29tcHV0ZWRGaWVsZHNQTChEQkRBVEEucGxheWxpc3RzLCBEQkRBVEEucXVldWUpO1xyXG4gIERCREFUQS5wbGF5bGlzdHMuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpO1xyXG4gIGNvbnN0IHBsYXlsaXN0Q29waWVzID0gREJEQVRBLnBsYXlsaXN0cy5tYXAoKGl0ZW0pID0+IHtcclxuICAgIGNvbnN0IGNvcHkgPSB1dGlscy53cmFwSXRlbShpdGVtKTtcclxuICAgIC8vIGNvcHkucGxheWxpc3RSZWYgPSBpdGVtO1xyXG4gICAgcmV0dXJuIHV0aWxzLmFkZENvbXB1dGVkRmllbGRzUEwoY29weSwgREJEQVRBLnF1ZXVlKTtcclxuICB9KTtcclxuICBpZiAocXVldWVNb2RlID09IFwicGxheWxpc3RcIikge1xyXG4gICAgREJEQVRBLnF1ZXVlLnVuc2hpZnQoLi4ucGxheWxpc3RDb3BpZXMpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBEQkRBVEEucXVldWUucHVzaCguLi5wbGF5bGlzdENvcGllcyk7XHJcbiAgfVxyXG4gIGF3YWl0IHJlbmRlckRCKERCREFUQS5xdWV1ZSk7XHJcbiAgYXdhaXQgcmVuZGVyUGxheWxpc3RzKCk7XHJcbiAgYXdhaXQgcmVuZGVyUXVldWUoKTtcclxuICBjb25zdCBuYXZUeXBlID0gcGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcIm5hdmlnYXRpb25cIilbMF0/LnR5cGU7XHJcbiAgaWYgKG5hdlR5cGUgIT09IFwicmVsb2FkXCIpIHtcclxuICAgIHBsYXlOZXh0VmlkZW8oMCwgeyBjdWVWaWRlbzogdHJ1ZSB9KTtcclxuICB9XHJcbn0pKCk7XHJcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/options.js\n\n}");

/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addComputedFieldsPL: () => (/* binding */ addComputedFieldsPL),\n/* harmony export */   addComputedFieldsVideo: () => (/* binding */ addComputedFieldsVideo),\n/* harmony export */   calcDaysSince: () => (/* binding */ calcDaysSince),\n/* harmony export */   calcDue: () => (/* binding */ calcDue),\n/* harmony export */   cooldownFactor: () => (/* binding */ cooldownFactor),\n/* harmony export */   fnv1a32: () => (/* binding */ fnv1a32),\n/* harmony export */   formatDuration: () => (/* binding */ formatDuration),\n/* harmony export */   hashRandom: () => (/* binding */ hashRandom),\n/* harmony export */   isoDuration2seconds: () => (/* binding */ isoDuration2seconds),\n/* harmony export */   rating2color: () => (/* binding */ rating2color),\n/* harmony export */   rating2days: () => (/* binding */ rating2days),\n/* harmony export */   ratingScore: () => (/* binding */ ratingScore),\n/* harmony export */   scoreHelper: () => (/* binding */ scoreHelper),\n/* harmony export */   scoreItem: () => (/* binding */ scoreItem),\n/* harmony export */   shuffleArray: () => (/* binding */ shuffleArray),\n/* harmony export */   wrapItem: () => (/* binding */ wrapItem)\n/* harmony export */ });\nlet DEFAULT_RATING = 7.5;\r\nlet MAX_ERRS = 5; // After this many errors treat it as bad\r\n\r\nlet DIVERSITY_FACTOR = 10;\r\nlet SHORT_DELAY_LINEAR_RATE = 0; // Skip the linear part\r\nlet LONG_DELAY_START = 0; //\r\nlet LONG_DELAY_BONUS = 5; // Add 5\r\nlet LONG_DELAY_TIME = 1; // every 1X intervals\r\nlet INIT_FACTOR = 30;\r\nlet COOLDOWN_JITTER_START = 3; // Subtract N days from the interval\r\nlet COOLDOWN_JITTER_RATE = 0.0; // (0X = disable for now) Add up to X% jitter to that part of the interval\r\nlet COOLDOWN_FLOOR = 0.0; // Go all the way to 0 for just played songs\r\nlet COOLDOWN_POWER_FACTOR = 2; // 1 = linear, higher power = sharper curve\r\nlet RATING_FACTOR = 0.0; // 0 = all ratings same. 1 = 10 points per rating point\r\nlet DUP_SCORE = -8;\r\nlet ERR_SCORE = -9;\r\nlet DEFAULT_VID_LENGTH = 3 * 60;\r\n\r\nfunction rating2color(rating) {\r\n  const colors = [\r\n    \"hsla(342, 100%, 20%, 1.00)\",\r\n    \"hsla(353, 76%, 40%, 1.00)\",\r\n    \"hsla(8, 63%, 57%, 1.00)\",\r\n    \"hsla(18, 84%, 68%, 1.00)\",\r\n    // \"hsla(32, 60%, 68%, 1.00)\",\r\n    // \"hsla(0, 0%, 65%, 1.00)\",\r\n    \"hsla(180, 50%, 70%, 1.00)\",\r\n    \"hsla(185, 63%, 60%, 1.00)\",\r\n    \"hsla(190, 66%, 47%, 1.00)\",\r\n    \"hsla(195, 70%, 36%, 1.00)\",\r\n    \"hsla(205, 73%, 30%, 1.00)\",\r\n  ];\r\n\r\n  let colormap = {};\r\n  for (let i = 0, r = 9.0; i < colors.length; i++) {\r\n    colormap[r] = colors[i];\r\n    r -= 0.5;\r\n  }\r\n\r\n  // Get all rating keys as numbers\r\n  const keys = Object.keys(colormap).map(Number);\r\n\r\n  // Find the key with minimal distance to rating\r\n  let closest = keys[0];\r\n  let minDiff = Math.abs(rating - closest);\r\n\r\n  for (let k of keys) {\r\n    const diff = Math.abs(rating - k);\r\n    if (diff < minDiff) {\r\n      minDiff = diff;\r\n      closest = k;\r\n    }\r\n  }\r\n  return colormap[closest];\r\n}\r\n\r\nfunction rating2days(rating) {\r\n  if (rating >= 10) return 1.0 / 24;\r\n  if (rating >= 9.5) return 4.0 / 24;\r\n  if (rating >= 9.0) return 0.5;\r\n  if (rating >= 8.5) return 1;\r\n  if (rating >= 8.0) return 2;\r\n  if (rating >= 7.5) return 3;\r\n  if (rating >= 7.0) return 7;\r\n  if (rating >= 6.5) return 30;\r\n  if (rating >= 6.0) return 90;\r\n  if (rating >= 5.5) return 365;\r\n  return 365 * 3;\r\n}\r\n\r\nfunction ratingScore(rating) {\r\n  return 10 * ((1 - RATING_FACTOR) * DEFAULT_RATING + RATING_FACTOR * rating);\r\n}\r\n\r\nfunction cooldownFactor(daysSince, rating, noise = true, salt = \"salt\") {\r\n  if (daysSince == null) {\r\n    return INIT_FACTOR;\r\n  }\r\n  let T = rating2days(rating);\r\n  let jitter = 0;\r\n  if (noise) {\r\n    // T1 is the interval (T) reduced by COOLDOWN_JITTER_START days\r\n    let T1 = T - COOLDOWN_JITTER_START;\r\n    if (T1 > 0) {\r\n      // If after subtracting there is more left, apply random jitter to that part of it\r\n      jitter = T1 * hashRandom(`${salt}cooldownJitter`) * COOLDOWN_JITTER_RATE;\r\n    }\r\n  }\r\n  // And subtract jitter days, but don't allow jitter to reduce daysSince below 0\r\n  // Subtracting days from daysSince makes the video not become due as quickly.\r\n  daysSince = Math.max(0, daysSince - jitter);\r\n  let ratio = daysSince / T;\r\n  let longDelayStartDay = T + LONG_DELAY_START;\r\n  let daysOverdue = daysSince - T;\r\n  if (ratio < 1) {\r\n    const eased = Math.pow(ratio, COOLDOWN_POWER_FACTOR);\r\n    return -(1 - COOLDOWN_FLOOR) * ratingScore(rating) * (1 - eased);\r\n  } else if (daysSince < longDelayStartDay) {\r\n    return SHORT_DELAY_LINEAR_RATE * (daysOverdue / (longDelayStartDay - T));\r\n  } else {\r\n    // 7 days overdue:  +1LONG_DELAY_BONUS\r\n    // 14 days overdue: +2LONG_DELAY_BONUS\r\n    // 28 days overdue: +3LONG_DELAY_BONUS\r\n    // 56 days overdue: +4LONG_DELAY_BONUS\r\n    // 365 days overdue: +14 = 5.6x LONG_DELAY_BONUS\r\n    let log2 =\r\n      Math.log1p((daysSince - longDelayStartDay) / (T * LONG_DELAY_TIME)) /\r\n      Math.log(2);\r\n    return SHORT_DELAY_LINEAR_RATE + log2 * LONG_DELAY_BONUS;\r\n  }\r\n}\r\n\r\n// split out so we can test easier\r\nfunction scoreHelper(daysSince, rating, noise = true, salt = \"salt\") {\r\n  let score = 0;\r\n  // Mix rating and DEFAULT_RATING, and multiply by 10\r\n  score += ratingScore(rating);\r\n  score += cooldownFactor(daysSince, rating, noise);\r\n  score += !noise ? 0 : hashRandom(`${salt}noise`) * DIVERSITY_FACTOR;\r\n  return score;\r\n}\r\n\r\nfunction calcDaysSince(video) {\r\n  if (!video.lastPlayDate) {\r\n    return null;\r\n  }\r\n  let now = Date.now();\r\n  let salt = `${video.uuid}${video.lastPlayDate}`;\r\n  let daysSince = (now - video.lastPlayDate) / (24 * 3600 * 1000);\r\n  if (video.delay) {\r\n    // if e.g. a big playlist is added, user clicks \"delay\" and they will be randomized into the backlog uniformly\r\n    daysSince += rating2days(video.rating) * hashRandom(`${salt}delay`);\r\n  }\r\n  return daysSince;\r\n}\r\n\r\nfunction scoreItem(video, noise = true) {\r\n  if (video.errCnt && video.errCnt >= MAX_ERRS) return ERR_SCORE; // too many errors, don't play\r\n  if (video.dup) return DUP_SCORE; // Ignore dups\r\n  let salt = `${video.uuid}${video.lastPlayDate}`;\r\n  if (!video.rating) video.rating = DEFAULT_RATING;\r\n  let daysSince = calcDaysSince(video);\r\n  let score = scoreHelper(daysSince, video.rating, noise, salt);\r\n  return score;\r\n}\r\n\r\nfunction shuffleArray(array) {\r\n  for (let i = array.length - 1; i > 0; i--) {\r\n    const j = Math.floor(Math.random() * (i + 1));\r\n    [array[i], array[j]] = [array[j], array[i]];\r\n  }\r\n  return array;\r\n}\r\n\r\nfunction fnv1a32(str) {\r\n  let hash = 0x811c9dc5; // FNV_offset_basis for 32-bit FNV-1a\r\n  const FNV_prime = 0x01000193; // FNV_prime for 32-bit FNV-1a\r\n\r\n  for (let i = 0; i < str.length; i++) {\r\n    hash ^= str.charCodeAt(i); // XOR with the current byte\r\n    hash = (hash * FNV_prime) >>> 0; // Multiply by FNV_prime and ensure 32-bit unsigned integer\r\n  }\r\n\r\n  return hash;\r\n}\r\n\r\n//\r\n// hashRandom:\r\n//\r\n// This is important to avoid rerolling the random numbers\r\n// Example:\r\n//\r\n// if (video.delay)\r\n//   daysSince += rating2days(video.rating) * hashRandom(`${salt}delay`);\r\n//\r\n// Suppose rating2days() = 300, and 150 days have passed.\r\n// If we reroll this part, every video like this will have a 50% chance to act like their cooldown is over.\r\n// Instead with hashRandom we don't reroll this every time.\r\n//\r\nfunction hashRandom(str) {\r\n  return fnv1a32(str) / 0xffffffff;\r\n}\r\nfunction isoDuration2seconds(isoDuration) {\r\n  if (!isoDuration) return NaN;\r\n  const match = isoDuration.match(/PT(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+)S)?/);\r\n  if (!match) return NaN;\r\n  let hours = parseInt(match[1] || \"0\", 10);\r\n  let minutes = parseInt(match[2] || \"0\", 10);\r\n  let seconds = parseInt(match[3] || \"0\", 10);\r\n  return hours * 60 * 60 + minutes * 60 + seconds;\r\n}\r\n\r\nfunction formatDuration(duration, isoFormat = true) {\r\n  let hours;\r\n  let minutes;\r\n  let seconds;\r\n  if (isoFormat) {\r\n    duration = isoDuration2seconds(duration);\r\n  }\r\n  if (!duration) {\r\n    return \"\";\r\n  }\r\n  hours = duration >= 3600 ? Math.floor(duration / 3600) : 0;\r\n  minutes = Math.floor((duration % 3600) / 60);\r\n  seconds = Math.floor(duration % 60);\r\n\r\n  if (hours > 0) {\r\n    return `${hours}:${minutes.toString().padStart(2, \"0\")}:${seconds\r\n      .toString()\r\n      .padStart(2, \"0\")}`;\r\n  } else {\r\n    return `${minutes}:${seconds.toString().padStart(2, \"0\")}`;\r\n  }\r\n}\r\n\r\nfunction calcDue(video) {\r\n  let daysSince = calcDaysSince(video);\r\n  if (daysSince === null) {\r\n    return null;\r\n  }\r\n  let days = rating2days(video.rating ?? DEFAULT_RATING) - daysSince;\r\n  return days;\r\n}\r\nfunction addComputedFieldsPL(playlist, queue) {\r\n  if (Array.isArray(playlist)) {\r\n    return playlist.map((p) => addComputedFieldsPL(p, queue));\r\n  }\r\n  let allChildren = [];\r\n  for (const [idx, uuid] of playlist.videoUuids.entries()) {\r\n    let origVideo = queue.find((v) => v.source == \"youtube\" && v.uuid === uuid);\r\n    if (!origVideo) {\r\n      console.log(\"error\", idx, uuid);\r\n    }\r\n    let video = wrapItem(origVideo, { _track: idx, playlist });\r\n    allChildren.push(video);\r\n  }\r\n  if (!playlist.thumbnailUrl) {\r\n    console.log(\"Warning: no PL URL for\", playlist.title);\r\n    playlist.thumbnailUrl = allChildren[0].yt.snippet.thumbnails.default.url;\r\n  }\r\n  return Object.defineProperties(playlist, {\r\n    _currentTrack: { value: -1, enumerable: false, writable: true },\r\n    _allChildren: { value: allChildren, enumerable: false, writable: true },\r\n    _children: {\r\n      get() {\r\n        const start = this._currentTrack == -1 ? 0 : this._currentTrack;\r\n        return this._allChildren.slice(start);\r\n      },\r\n      enumerable: false,\r\n    },\r\n    _track: {\r\n      value: playlist.videoUuids.length,\r\n      enumerable: false,\r\n      writable: true,\r\n    },\r\n    type: { value: \"playlist\", enumerable: false, writable: true },\r\n    // rating: { value: playlist.rating ?? DEFAULT_RATING, writable: true },\r\n    score: {\r\n      value: scoreItem(playlist),\r\n      writable: true,\r\n      enumerable: false,\r\n    },\r\n    due: {\r\n      value: calcDue(playlist),\r\n      writable: true,\r\n      enumerable: false,\r\n    },\r\n    interval: {\r\n      get() {\r\n        return rating2days(playlist.rating);\r\n      },\r\n      set() {}, // Ignore -- keep tabulator happy\r\n      enumerable: false,\r\n    },\r\n    duration: {\r\n      value: playlist.videoUuids\r\n        .map((uuid) => {\r\n          const video = queue.find((v) => v.uuid === uuid);\r\n          return video?.duration || DEFAULT_VID_LENGTH;\r\n        })\r\n        .reduce((sum, dur) => sum + dur, 0),\r\n      enumerable: false,\r\n      writable: true,\r\n    },\r\n  });\r\n}\r\nfunction addComputedFieldsVideo(video) {\r\n  if (Array.isArray(video)) {\r\n    return video.map((p) => addComputedFieldsVideo(p));\r\n  }\r\n  return Object.defineProperties(video, {\r\n    type: { value: \"video\", enumerable: false, writable: true },\r\n    rating: { value: video.rating ?? DEFAULT_RATING, writable: true },\r\n    title: { value: video.title ?? video.yt.snippet.title, writable: true },\r\n    thumbnailUrl: {\r\n      get() {\r\n        if (this.source === \"youtube\") {\r\n          return `https://i.ytimg.com/vi/${this.foreignKey}/default.jpg`;\r\n        } else if (this.source === \"local\") {\r\n          // Could store a thumbnail path on disk or derive it from the file\r\n          return this.localThumbnailPath || \"\";\r\n        }\r\n        return \"\";\r\n      },\r\n      set() {},\r\n      enumerable: false,\r\n    },\r\n    channelTitle: {\r\n      value: video.yt?.snippet?.videoOwnerChannelTitle || \"\",\r\n      writable: true,\r\n      enumerable: true,\r\n    },\r\n    due: {\r\n      value: calcDue(video),\r\n      writable: true,\r\n      enumerable: false,\r\n    },\r\n    score: {\r\n      value: scoreItem(video),\r\n      writable: true,\r\n      enumerable: false,\r\n    },\r\n    interval: {\r\n      get() {\r\n        return rating2days(video.rating);\r\n      },\r\n      set() {}, // Ignore -- keep tabulator happy\r\n      enumerable: false,\r\n    },\r\n    duration: {\r\n      get() {\r\n        if (video.scrapedDuration) {\r\n          return video.scrapedDuration;\r\n        } else {\r\n          return isoDuration2seconds(video.yt?.contentDetails?.duration);\r\n        }\r\n      },\r\n      set(value) {\r\n        video.scrapedDuration = value;\r\n      }, // Why is tabultor doing this?\r\n      enumerable: false,\r\n    },\r\n  });\r\n}\r\n\r\nfunction wrapItem(video, extras = {}) {\r\n  if (!video) {\r\n    console.log(\"ERROR: undefined input\");\r\n    console.trace();\r\n  }\r\n  if (video.ref) {\r\n    console.log(\"ERROR: Already wrapped?\");\r\n  }\r\n  return new Proxy(\r\n    { ref: video, ...extras },\r\n    {\r\n      get(target, prop, receiver) {\r\n        if (prop in target) return Reflect.get(target, prop, receiver);\r\n        return target.ref[prop];\r\n      },\r\n      set(target, prop, value, receiver) {\r\n        if (prop in target) return Reflect.set(target, prop, value, receiver);\r\n        target.ref[prop] = value;\r\n        return true;\r\n      },\r\n    }\r\n  );\r\n}\r\n\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsMEJBQTBCO0FBQzFCLDBCQUEwQjtBQUMxQix5QkFBeUI7QUFDekI7QUFDQSwrQkFBK0I7QUFDL0IsZ0NBQWdDO0FBQ2hDLDBCQUEwQjtBQUMxQiwrQkFBK0I7QUFDL0IseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsbUJBQW1CO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsS0FBSztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxLQUFLO0FBQzNDO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVyxFQUFFLG1CQUFtQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsS0FBSztBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1Asa0VBQWtFO0FBQ2xFLG1DQUFtQztBQUNuQyxnQkFBZ0IsV0FBVyxFQUFFLG1CQUFtQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLGlDQUFpQyxPQUFPO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AseUJBQXlCO0FBQ3pCLGdDQUFnQztBQUNoQztBQUNBLGtCQUFrQixnQkFBZ0I7QUFDbEMsK0JBQStCO0FBQy9CLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQsS0FBSztBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLE1BQU0sR0FBRyxvQ0FBb0MsR0FBRztBQUM5RDtBQUNBLHdCQUF3QjtBQUN4QixJQUFJO0FBQ0osY0FBYyxRQUFRLEdBQUcsb0NBQW9DO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyx1QkFBdUI7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsOENBQThDO0FBQ25FLG9CQUFvQix1REFBdUQ7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWSxzREFBc0Q7QUFDbEUsaUJBQWlCLDBEQUEwRDtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsY0FBYztBQUNkO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLG1EQUFtRDtBQUMvRCxjQUFjLHVEQUF1RDtBQUNyRSxhQUFhLDhEQUE4RDtBQUMzRTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsZ0JBQWdCO0FBQzNELFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxjQUFjO0FBQ2Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLGNBQWM7QUFDZDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sdUJBQXVCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBUUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWphLXF1ZXVlLy4vc3JjL3V0aWxzLmpzPzNlMzAiXSwic291cmNlc0NvbnRlbnQiOlsibGV0IERFRkFVTFRfUkFUSU5HID0gNy41O1xyXG5sZXQgTUFYX0VSUlMgPSA1OyAvLyBBZnRlciB0aGlzIG1hbnkgZXJyb3JzIHRyZWF0IGl0IGFzIGJhZFxyXG5cclxubGV0IERJVkVSU0lUWV9GQUNUT1IgPSAxMDtcclxubGV0IFNIT1JUX0RFTEFZX0xJTkVBUl9SQVRFID0gMDsgLy8gU2tpcCB0aGUgbGluZWFyIHBhcnRcclxubGV0IExPTkdfREVMQVlfU1RBUlQgPSAwOyAvL1xyXG5sZXQgTE9OR19ERUxBWV9CT05VUyA9IDU7IC8vIEFkZCA1XHJcbmxldCBMT05HX0RFTEFZX1RJTUUgPSAxOyAvLyBldmVyeSAxWCBpbnRlcnZhbHNcclxubGV0IElOSVRfRkFDVE9SID0gMzA7XHJcbmxldCBDT09MRE9XTl9KSVRURVJfU1RBUlQgPSAzOyAvLyBTdWJ0cmFjdCBOIGRheXMgZnJvbSB0aGUgaW50ZXJ2YWxcclxubGV0IENPT0xET1dOX0pJVFRFUl9SQVRFID0gMC4wOyAvLyAoMFggPSBkaXNhYmxlIGZvciBub3cpIEFkZCB1cCB0byBYJSBqaXR0ZXIgdG8gdGhhdCBwYXJ0IG9mIHRoZSBpbnRlcnZhbFxyXG5sZXQgQ09PTERPV05fRkxPT1IgPSAwLjA7IC8vIEdvIGFsbCB0aGUgd2F5IHRvIDAgZm9yIGp1c3QgcGxheWVkIHNvbmdzXHJcbmxldCBDT09MRE9XTl9QT1dFUl9GQUNUT1IgPSAyOyAvLyAxID0gbGluZWFyLCBoaWdoZXIgcG93ZXIgPSBzaGFycGVyIGN1cnZlXHJcbmxldCBSQVRJTkdfRkFDVE9SID0gMC4wOyAvLyAwID0gYWxsIHJhdGluZ3Mgc2FtZS4gMSA9IDEwIHBvaW50cyBwZXIgcmF0aW5nIHBvaW50XHJcbmxldCBEVVBfU0NPUkUgPSAtODtcclxubGV0IEVSUl9TQ09SRSA9IC05O1xyXG5sZXQgREVGQVVMVF9WSURfTEVOR1RIID0gMyAqIDYwO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJhdGluZzJjb2xvcihyYXRpbmcpIHtcclxuICBjb25zdCBjb2xvcnMgPSBbXHJcbiAgICBcImhzbGEoMzQyLCAxMDAlLCAyMCUsIDEuMDApXCIsXHJcbiAgICBcImhzbGEoMzUzLCA3NiUsIDQwJSwgMS4wMClcIixcclxuICAgIFwiaHNsYSg4LCA2MyUsIDU3JSwgMS4wMClcIixcclxuICAgIFwiaHNsYSgxOCwgODQlLCA2OCUsIDEuMDApXCIsXHJcbiAgICAvLyBcImhzbGEoMzIsIDYwJSwgNjglLCAxLjAwKVwiLFxyXG4gICAgLy8gXCJoc2xhKDAsIDAlLCA2NSUsIDEuMDApXCIsXHJcbiAgICBcImhzbGEoMTgwLCA1MCUsIDcwJSwgMS4wMClcIixcclxuICAgIFwiaHNsYSgxODUsIDYzJSwgNjAlLCAxLjAwKVwiLFxyXG4gICAgXCJoc2xhKDE5MCwgNjYlLCA0NyUsIDEuMDApXCIsXHJcbiAgICBcImhzbGEoMTk1LCA3MCUsIDM2JSwgMS4wMClcIixcclxuICAgIFwiaHNsYSgyMDUsIDczJSwgMzAlLCAxLjAwKVwiLFxyXG4gIF07XHJcblxyXG4gIGxldCBjb2xvcm1hcCA9IHt9O1xyXG4gIGZvciAobGV0IGkgPSAwLCByID0gOS4wOyBpIDwgY29sb3JzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBjb2xvcm1hcFtyXSA9IGNvbG9yc1tpXTtcclxuICAgIHIgLT0gMC41O1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IGFsbCByYXRpbmcga2V5cyBhcyBudW1iZXJzXHJcbiAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGNvbG9ybWFwKS5tYXAoTnVtYmVyKTtcclxuXHJcbiAgLy8gRmluZCB0aGUga2V5IHdpdGggbWluaW1hbCBkaXN0YW5jZSB0byByYXRpbmdcclxuICBsZXQgY2xvc2VzdCA9IGtleXNbMF07XHJcbiAgbGV0IG1pbkRpZmYgPSBNYXRoLmFicyhyYXRpbmcgLSBjbG9zZXN0KTtcclxuXHJcbiAgZm9yIChsZXQgayBvZiBrZXlzKSB7XHJcbiAgICBjb25zdCBkaWZmID0gTWF0aC5hYnMocmF0aW5nIC0gayk7XHJcbiAgICBpZiAoZGlmZiA8IG1pbkRpZmYpIHtcclxuICAgICAgbWluRGlmZiA9IGRpZmY7XHJcbiAgICAgIGNsb3Nlc3QgPSBrO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gY29sb3JtYXBbY2xvc2VzdF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByYXRpbmcyZGF5cyhyYXRpbmcpIHtcclxuICBpZiAocmF0aW5nID49IDEwKSByZXR1cm4gMS4wIC8gMjQ7XHJcbiAgaWYgKHJhdGluZyA+PSA5LjUpIHJldHVybiA0LjAgLyAyNDtcclxuICBpZiAocmF0aW5nID49IDkuMCkgcmV0dXJuIDAuNTtcclxuICBpZiAocmF0aW5nID49IDguNSkgcmV0dXJuIDE7XHJcbiAgaWYgKHJhdGluZyA+PSA4LjApIHJldHVybiAyO1xyXG4gIGlmIChyYXRpbmcgPj0gNy41KSByZXR1cm4gMztcclxuICBpZiAocmF0aW5nID49IDcuMCkgcmV0dXJuIDc7XHJcbiAgaWYgKHJhdGluZyA+PSA2LjUpIHJldHVybiAzMDtcclxuICBpZiAocmF0aW5nID49IDYuMCkgcmV0dXJuIDkwO1xyXG4gIGlmIChyYXRpbmcgPj0gNS41KSByZXR1cm4gMzY1O1xyXG4gIHJldHVybiAzNjUgKiAzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmF0aW5nU2NvcmUocmF0aW5nKSB7XHJcbiAgcmV0dXJuIDEwICogKCgxIC0gUkFUSU5HX0ZBQ1RPUikgKiBERUZBVUxUX1JBVElORyArIFJBVElOR19GQUNUT1IgKiByYXRpbmcpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29vbGRvd25GYWN0b3IoZGF5c1NpbmNlLCByYXRpbmcsIG5vaXNlID0gdHJ1ZSwgc2FsdCA9IFwic2FsdFwiKSB7XHJcbiAgaWYgKGRheXNTaW5jZSA9PSBudWxsKSB7XHJcbiAgICByZXR1cm4gSU5JVF9GQUNUT1I7XHJcbiAgfVxyXG4gIGxldCBUID0gcmF0aW5nMmRheXMocmF0aW5nKTtcclxuICBsZXQgaml0dGVyID0gMDtcclxuICBpZiAobm9pc2UpIHtcclxuICAgIC8vIFQxIGlzIHRoZSBpbnRlcnZhbCAoVCkgcmVkdWNlZCBieSBDT09MRE9XTl9KSVRURVJfU1RBUlQgZGF5c1xyXG4gICAgbGV0IFQxID0gVCAtIENPT0xET1dOX0pJVFRFUl9TVEFSVDtcclxuICAgIGlmIChUMSA+IDApIHtcclxuICAgICAgLy8gSWYgYWZ0ZXIgc3VidHJhY3RpbmcgdGhlcmUgaXMgbW9yZSBsZWZ0LCBhcHBseSByYW5kb20gaml0dGVyIHRvIHRoYXQgcGFydCBvZiBpdFxyXG4gICAgICBqaXR0ZXIgPSBUMSAqIGhhc2hSYW5kb20oYCR7c2FsdH1jb29sZG93bkppdHRlcmApICogQ09PTERPV05fSklUVEVSX1JBVEU7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIEFuZCBzdWJ0cmFjdCBqaXR0ZXIgZGF5cywgYnV0IGRvbid0IGFsbG93IGppdHRlciB0byByZWR1Y2UgZGF5c1NpbmNlIGJlbG93IDBcclxuICAvLyBTdWJ0cmFjdGluZyBkYXlzIGZyb20gZGF5c1NpbmNlIG1ha2VzIHRoZSB2aWRlbyBub3QgYmVjb21lIGR1ZSBhcyBxdWlja2x5LlxyXG4gIGRheXNTaW5jZSA9IE1hdGgubWF4KDAsIGRheXNTaW5jZSAtIGppdHRlcik7XHJcbiAgbGV0IHJhdGlvID0gZGF5c1NpbmNlIC8gVDtcclxuICBsZXQgbG9uZ0RlbGF5U3RhcnREYXkgPSBUICsgTE9OR19ERUxBWV9TVEFSVDtcclxuICBsZXQgZGF5c092ZXJkdWUgPSBkYXlzU2luY2UgLSBUO1xyXG4gIGlmIChyYXRpbyA8IDEpIHtcclxuICAgIGNvbnN0IGVhc2VkID0gTWF0aC5wb3cocmF0aW8sIENPT0xET1dOX1BPV0VSX0ZBQ1RPUik7XHJcbiAgICByZXR1cm4gLSgxIC0gQ09PTERPV05fRkxPT1IpICogcmF0aW5nU2NvcmUocmF0aW5nKSAqICgxIC0gZWFzZWQpO1xyXG4gIH0gZWxzZSBpZiAoZGF5c1NpbmNlIDwgbG9uZ0RlbGF5U3RhcnREYXkpIHtcclxuICAgIHJldHVybiBTSE9SVF9ERUxBWV9MSU5FQVJfUkFURSAqIChkYXlzT3ZlcmR1ZSAvIChsb25nRGVsYXlTdGFydERheSAtIFQpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgLy8gNyBkYXlzIG92ZXJkdWU6ICArMUxPTkdfREVMQVlfQk9OVVNcclxuICAgIC8vIDE0IGRheXMgb3ZlcmR1ZTogKzJMT05HX0RFTEFZX0JPTlVTXHJcbiAgICAvLyAyOCBkYXlzIG92ZXJkdWU6ICszTE9OR19ERUxBWV9CT05VU1xyXG4gICAgLy8gNTYgZGF5cyBvdmVyZHVlOiArNExPTkdfREVMQVlfQk9OVVNcclxuICAgIC8vIDM2NSBkYXlzIG92ZXJkdWU6ICsxNCA9IDUuNnggTE9OR19ERUxBWV9CT05VU1xyXG4gICAgbGV0IGxvZzIgPVxyXG4gICAgICBNYXRoLmxvZzFwKChkYXlzU2luY2UgLSBsb25nRGVsYXlTdGFydERheSkgLyAoVCAqIExPTkdfREVMQVlfVElNRSkpIC9cclxuICAgICAgTWF0aC5sb2coMik7XHJcbiAgICByZXR1cm4gU0hPUlRfREVMQVlfTElORUFSX1JBVEUgKyBsb2cyICogTE9OR19ERUxBWV9CT05VUztcclxuICB9XHJcbn1cclxuXHJcbi8vIHNwbGl0IG91dCBzbyB3ZSBjYW4gdGVzdCBlYXNpZXJcclxuZXhwb3J0IGZ1bmN0aW9uIHNjb3JlSGVscGVyKGRheXNTaW5jZSwgcmF0aW5nLCBub2lzZSA9IHRydWUsIHNhbHQgPSBcInNhbHRcIikge1xyXG4gIGxldCBzY29yZSA9IDA7XHJcbiAgLy8gTWl4IHJhdGluZyBhbmQgREVGQVVMVF9SQVRJTkcsIGFuZCBtdWx0aXBseSBieSAxMFxyXG4gIHNjb3JlICs9IHJhdGluZ1Njb3JlKHJhdGluZyk7XHJcbiAgc2NvcmUgKz0gY29vbGRvd25GYWN0b3IoZGF5c1NpbmNlLCByYXRpbmcsIG5vaXNlKTtcclxuICBzY29yZSArPSAhbm9pc2UgPyAwIDogaGFzaFJhbmRvbShgJHtzYWx0fW5vaXNlYCkgKiBESVZFUlNJVFlfRkFDVE9SO1xyXG4gIHJldHVybiBzY29yZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNEYXlzU2luY2UodmlkZW8pIHtcclxuICBpZiAoIXZpZGVvLmxhc3RQbGF5RGF0ZSkge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG4gIGxldCBub3cgPSBEYXRlLm5vdygpO1xyXG4gIGxldCBzYWx0ID0gYCR7dmlkZW8udXVpZH0ke3ZpZGVvLmxhc3RQbGF5RGF0ZX1gO1xyXG4gIGxldCBkYXlzU2luY2UgPSAobm93IC0gdmlkZW8ubGFzdFBsYXlEYXRlKSAvICgyNCAqIDM2MDAgKiAxMDAwKTtcclxuICBpZiAodmlkZW8uZGVsYXkpIHtcclxuICAgIC8vIGlmIGUuZy4gYSBiaWcgcGxheWxpc3QgaXMgYWRkZWQsIHVzZXIgY2xpY2tzIFwiZGVsYXlcIiBhbmQgdGhleSB3aWxsIGJlIHJhbmRvbWl6ZWQgaW50byB0aGUgYmFja2xvZyB1bmlmb3JtbHlcclxuICAgIGRheXNTaW5jZSArPSByYXRpbmcyZGF5cyh2aWRlby5yYXRpbmcpICogaGFzaFJhbmRvbShgJHtzYWx0fWRlbGF5YCk7XHJcbiAgfVxyXG4gIHJldHVybiBkYXlzU2luY2U7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzY29yZUl0ZW0odmlkZW8sIG5vaXNlID0gdHJ1ZSkge1xyXG4gIGlmICh2aWRlby5lcnJDbnQgJiYgdmlkZW8uZXJyQ250ID49IE1BWF9FUlJTKSByZXR1cm4gRVJSX1NDT1JFOyAvLyB0b28gbWFueSBlcnJvcnMsIGRvbid0IHBsYXlcclxuICBpZiAodmlkZW8uZHVwKSByZXR1cm4gRFVQX1NDT1JFOyAvLyBJZ25vcmUgZHVwc1xyXG4gIGxldCBzYWx0ID0gYCR7dmlkZW8udXVpZH0ke3ZpZGVvLmxhc3RQbGF5RGF0ZX1gO1xyXG4gIGlmICghdmlkZW8ucmF0aW5nKSB2aWRlby5yYXRpbmcgPSBERUZBVUxUX1JBVElORztcclxuICBsZXQgZGF5c1NpbmNlID0gY2FsY0RheXNTaW5jZSh2aWRlbyk7XHJcbiAgbGV0IHNjb3JlID0gc2NvcmVIZWxwZXIoZGF5c1NpbmNlLCB2aWRlby5yYXRpbmcsIG5vaXNlLCBzYWx0KTtcclxuICByZXR1cm4gc2NvcmU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzaHVmZmxlQXJyYXkoYXJyYXkpIHtcclxuICBmb3IgKGxldCBpID0gYXJyYXkubGVuZ3RoIC0gMTsgaSA+IDA7IGktLSkge1xyXG4gICAgY29uc3QgaiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChpICsgMSkpO1xyXG4gICAgW2FycmF5W2ldLCBhcnJheVtqXV0gPSBbYXJyYXlbal0sIGFycmF5W2ldXTtcclxuICB9XHJcbiAgcmV0dXJuIGFycmF5O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZm52MWEzMihzdHIpIHtcclxuICBsZXQgaGFzaCA9IDB4ODExYzlkYzU7IC8vIEZOVl9vZmZzZXRfYmFzaXMgZm9yIDMyLWJpdCBGTlYtMWFcclxuICBjb25zdCBGTlZfcHJpbWUgPSAweDAxMDAwMTkzOyAvLyBGTlZfcHJpbWUgZm9yIDMyLWJpdCBGTlYtMWFcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgIGhhc2ggXj0gc3RyLmNoYXJDb2RlQXQoaSk7IC8vIFhPUiB3aXRoIHRoZSBjdXJyZW50IGJ5dGVcclxuICAgIGhhc2ggPSAoaGFzaCAqIEZOVl9wcmltZSkgPj4+IDA7IC8vIE11bHRpcGx5IGJ5IEZOVl9wcmltZSBhbmQgZW5zdXJlIDMyLWJpdCB1bnNpZ25lZCBpbnRlZ2VyXHJcbiAgfVxyXG5cclxuICByZXR1cm4gaGFzaDtcclxufVxyXG5cclxuLy9cclxuLy8gaGFzaFJhbmRvbTpcclxuLy9cclxuLy8gVGhpcyBpcyBpbXBvcnRhbnQgdG8gYXZvaWQgcmVyb2xsaW5nIHRoZSByYW5kb20gbnVtYmVyc1xyXG4vLyBFeGFtcGxlOlxyXG4vL1xyXG4vLyBpZiAodmlkZW8uZGVsYXkpXHJcbi8vICAgZGF5c1NpbmNlICs9IHJhdGluZzJkYXlzKHZpZGVvLnJhdGluZykgKiBoYXNoUmFuZG9tKGAke3NhbHR9ZGVsYXlgKTtcclxuLy9cclxuLy8gU3VwcG9zZSByYXRpbmcyZGF5cygpID0gMzAwLCBhbmQgMTUwIGRheXMgaGF2ZSBwYXNzZWQuXHJcbi8vIElmIHdlIHJlcm9sbCB0aGlzIHBhcnQsIGV2ZXJ5IHZpZGVvIGxpa2UgdGhpcyB3aWxsIGhhdmUgYSA1MCUgY2hhbmNlIHRvIGFjdCBsaWtlIHRoZWlyIGNvb2xkb3duIGlzIG92ZXIuXHJcbi8vIEluc3RlYWQgd2l0aCBoYXNoUmFuZG9tIHdlIGRvbid0IHJlcm9sbCB0aGlzIGV2ZXJ5IHRpbWUuXHJcbi8vXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNoUmFuZG9tKHN0cikge1xyXG4gIHJldHVybiBmbnYxYTMyKHN0cikgLyAweGZmZmZmZmZmO1xyXG59XHJcbmZ1bmN0aW9uIGlzb0R1cmF0aW9uMnNlY29uZHMoaXNvRHVyYXRpb24pIHtcclxuICBpZiAoIWlzb0R1cmF0aW9uKSByZXR1cm4gTmFOO1xyXG4gIGNvbnN0IG1hdGNoID0gaXNvRHVyYXRpb24ubWF0Y2goL1BUKD86KFxcZCspSCk/KD86KFxcZCspTSk/KD86KFxcZCspUyk/Lyk7XHJcbiAgaWYgKCFtYXRjaCkgcmV0dXJuIE5hTjtcclxuICBsZXQgaG91cnMgPSBwYXJzZUludChtYXRjaFsxXSB8fCBcIjBcIiwgMTApO1xyXG4gIGxldCBtaW51dGVzID0gcGFyc2VJbnQobWF0Y2hbMl0gfHwgXCIwXCIsIDEwKTtcclxuICBsZXQgc2Vjb25kcyA9IHBhcnNlSW50KG1hdGNoWzNdIHx8IFwiMFwiLCAxMCk7XHJcbiAgcmV0dXJuIGhvdXJzICogNjAgKiA2MCArIG1pbnV0ZXMgKiA2MCArIHNlY29uZHM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZvcm1hdER1cmF0aW9uKGR1cmF0aW9uLCBpc29Gb3JtYXQgPSB0cnVlKSB7XHJcbiAgbGV0IGhvdXJzO1xyXG4gIGxldCBtaW51dGVzO1xyXG4gIGxldCBzZWNvbmRzO1xyXG4gIGlmIChpc29Gb3JtYXQpIHtcclxuICAgIGR1cmF0aW9uID0gaXNvRHVyYXRpb24yc2Vjb25kcyhkdXJhdGlvbik7XHJcbiAgfVxyXG4gIGlmICghZHVyYXRpb24pIHtcclxuICAgIHJldHVybiBcIuKAlFwiO1xyXG4gIH1cclxuICBob3VycyA9IGR1cmF0aW9uID49IDM2MDAgPyBNYXRoLmZsb29yKGR1cmF0aW9uIC8gMzYwMCkgOiAwO1xyXG4gIG1pbnV0ZXMgPSBNYXRoLmZsb29yKChkdXJhdGlvbiAlIDM2MDApIC8gNjApO1xyXG4gIHNlY29uZHMgPSBNYXRoLmZsb29yKGR1cmF0aW9uICUgNjApO1xyXG5cclxuICBpZiAoaG91cnMgPiAwKSB7XHJcbiAgICByZXR1cm4gYCR7aG91cnN9OiR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX06JHtzZWNvbmRzXHJcbiAgICAgIC50b1N0cmluZygpXHJcbiAgICAgIC5wYWRTdGFydCgyLCBcIjBcIil9YDtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIGAke21pbnV0ZXN9OiR7c2Vjb25kcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX1gO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY0R1ZSh2aWRlbykge1xyXG4gIGxldCBkYXlzU2luY2UgPSBjYWxjRGF5c1NpbmNlKHZpZGVvKTtcclxuICBpZiAoZGF5c1NpbmNlID09PSBudWxsKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgbGV0IGRheXMgPSByYXRpbmcyZGF5cyh2aWRlby5yYXRpbmcgPz8gREVGQVVMVF9SQVRJTkcpIC0gZGF5c1NpbmNlO1xyXG4gIHJldHVybiBkYXlzO1xyXG59XHJcbmZ1bmN0aW9uIGFkZENvbXB1dGVkRmllbGRzUEwocGxheWxpc3QsIHF1ZXVlKSB7XHJcbiAgaWYgKEFycmF5LmlzQXJyYXkocGxheWxpc3QpKSB7XHJcbiAgICByZXR1cm4gcGxheWxpc3QubWFwKChwKSA9PiBhZGRDb21wdXRlZEZpZWxkc1BMKHAsIHF1ZXVlKSk7XHJcbiAgfVxyXG4gIGxldCBhbGxDaGlsZHJlbiA9IFtdO1xyXG4gIGZvciAoY29uc3QgW2lkeCwgdXVpZF0gb2YgcGxheWxpc3QudmlkZW9VdWlkcy5lbnRyaWVzKCkpIHtcclxuICAgIGxldCBvcmlnVmlkZW8gPSBxdWV1ZS5maW5kKCh2KSA9PiB2LnNvdXJjZSA9PSBcInlvdXR1YmVcIiAmJiB2LnV1aWQgPT09IHV1aWQpO1xyXG4gICAgaWYgKCFvcmlnVmlkZW8pIHtcclxuICAgICAgY29uc29sZS5sb2coXCJlcnJvclwiLCBpZHgsIHV1aWQpO1xyXG4gICAgfVxyXG4gICAgbGV0IHZpZGVvID0gd3JhcEl0ZW0ob3JpZ1ZpZGVvLCB7IF90cmFjazogaWR4LCBwbGF5bGlzdCB9KTtcclxuICAgIGFsbENoaWxkcmVuLnB1c2godmlkZW8pO1xyXG4gIH1cclxuICBpZiAoIXBsYXlsaXN0LnRodW1ibmFpbFVybCkge1xyXG4gICAgY29uc29sZS5sb2coXCJXYXJuaW5nOiBubyBQTCBVUkwgZm9yXCIsIHBsYXlsaXN0LnRpdGxlKTtcclxuICAgIHBsYXlsaXN0LnRodW1ibmFpbFVybCA9IGFsbENoaWxkcmVuWzBdLnl0LnNuaXBwZXQudGh1bWJuYWlscy5kZWZhdWx0LnVybDtcclxuICB9XHJcbiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHBsYXlsaXN0LCB7XHJcbiAgICBfY3VycmVudFRyYWNrOiB7IHZhbHVlOiAtMSwgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlIH0sXHJcbiAgICBfYWxsQ2hpbGRyZW46IHsgdmFsdWU6IGFsbENoaWxkcmVuLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUgfSxcclxuICAgIF9jaGlsZHJlbjoge1xyXG4gICAgICBnZXQoKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLl9jdXJyZW50VHJhY2sgPT0gLTEgPyAwIDogdGhpcy5fY3VycmVudFRyYWNrO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hbGxDaGlsZHJlbi5zbGljZShzdGFydCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIF90cmFjazoge1xyXG4gICAgICB2YWx1ZTogcGxheWxpc3QudmlkZW9VdWlkcy5sZW5ndGgsXHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICB0eXBlOiB7IHZhbHVlOiBcInBsYXlsaXN0XCIsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSB9LFxyXG4gICAgLy8gcmF0aW5nOiB7IHZhbHVlOiBwbGF5bGlzdC5yYXRpbmcgPz8gREVGQVVMVF9SQVRJTkcsIHdyaXRhYmxlOiB0cnVlIH0sXHJcbiAgICBzY29yZToge1xyXG4gICAgICB2YWx1ZTogc2NvcmVJdGVtKHBsYXlsaXN0KSxcclxuICAgICAgd3JpdGFibGU6IHRydWUsXHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIGR1ZToge1xyXG4gICAgICB2YWx1ZTogY2FsY0R1ZShwbGF5bGlzdCksXHJcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICBpbnRlcnZhbDoge1xyXG4gICAgICBnZXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHJhdGluZzJkYXlzKHBsYXlsaXN0LnJhdGluZyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldCgpIHt9LCAvLyBJZ25vcmUgLS0ga2VlcCB0YWJ1bGF0b3IgaGFwcHlcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAgZHVyYXRpb246IHtcclxuICAgICAgdmFsdWU6IHBsYXlsaXN0LnZpZGVvVXVpZHNcclxuICAgICAgICAubWFwKCh1dWlkKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCB2aWRlbyA9IHF1ZXVlLmZpbmQoKHYpID0+IHYudXVpZCA9PT0gdXVpZCk7XHJcbiAgICAgICAgICByZXR1cm4gdmlkZW8/LmR1cmF0aW9uIHx8IERFRkFVTFRfVklEX0xFTkdUSDtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5yZWR1Y2UoKHN1bSwgZHVyKSA9PiBzdW0gKyBkdXIsIDApLFxyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgd3JpdGFibGU6IHRydWUsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGFkZENvbXB1dGVkRmllbGRzVmlkZW8odmlkZW8pIHtcclxuICBpZiAoQXJyYXkuaXNBcnJheSh2aWRlbykpIHtcclxuICAgIHJldHVybiB2aWRlby5tYXAoKHApID0+IGFkZENvbXB1dGVkRmllbGRzVmlkZW8ocCkpO1xyXG4gIH1cclxuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModmlkZW8sIHtcclxuICAgIHR5cGU6IHsgdmFsdWU6IFwidmlkZW9cIiwgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlIH0sXHJcbiAgICByYXRpbmc6IHsgdmFsdWU6IHZpZGVvLnJhdGluZyA/PyBERUZBVUxUX1JBVElORywgd3JpdGFibGU6IHRydWUgfSxcclxuICAgIHRpdGxlOiB7IHZhbHVlOiB2aWRlby50aXRsZSA/PyB2aWRlby55dC5zbmlwcGV0LnRpdGxlLCB3cml0YWJsZTogdHJ1ZSB9LFxyXG4gICAgdGh1bWJuYWlsVXJsOiB7XHJcbiAgICAgIGdldCgpIHtcclxuICAgICAgICBpZiAodGhpcy5zb3VyY2UgPT09IFwieW91dHViZVwiKSB7XHJcbiAgICAgICAgICByZXR1cm4gYGh0dHBzOi8vaS55dGltZy5jb20vdmkvJHt0aGlzLmZvcmVpZ25LZXl9L2RlZmF1bHQuanBnYDtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc291cmNlID09PSBcImxvY2FsXCIpIHtcclxuICAgICAgICAgIC8vIENvdWxkIHN0b3JlIGEgdGh1bWJuYWlsIHBhdGggb24gZGlzayBvciBkZXJpdmUgaXQgZnJvbSB0aGUgZmlsZVxyXG4gICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxUaHVtYm5haWxQYXRoIHx8IFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICB9LFxyXG4gICAgICBzZXQoKSB7fSxcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAgY2hhbm5lbFRpdGxlOiB7XHJcbiAgICAgIHZhbHVlOiB2aWRlby55dD8uc25pcHBldD8udmlkZW9Pd25lckNoYW5uZWxUaXRsZSB8fCBcIuKAlFwiLFxyXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBkdWU6IHtcclxuICAgICAgdmFsdWU6IGNhbGNEdWUodmlkZW8pLFxyXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAgc2NvcmU6IHtcclxuICAgICAgdmFsdWU6IHNjb3JlSXRlbSh2aWRlbyksXHJcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICBpbnRlcnZhbDoge1xyXG4gICAgICBnZXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHJhdGluZzJkYXlzKHZpZGVvLnJhdGluZyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldCgpIHt9LCAvLyBJZ25vcmUgLS0ga2VlcCB0YWJ1bGF0b3IgaGFwcHlcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAgZHVyYXRpb246IHtcclxuICAgICAgZ2V0KCkge1xyXG4gICAgICAgIGlmICh2aWRlby5zY3JhcGVkRHVyYXRpb24pIHtcclxuICAgICAgICAgIHJldHVybiB2aWRlby5zY3JhcGVkRHVyYXRpb247XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBpc29EdXJhdGlvbjJzZWNvbmRzKHZpZGVvLnl0Py5jb250ZW50RGV0YWlscz8uZHVyYXRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgc2V0KHZhbHVlKSB7XHJcbiAgICAgICAgdmlkZW8uc2NyYXBlZER1cmF0aW9uID0gdmFsdWU7XHJcbiAgICAgIH0sIC8vIFdoeSBpcyB0YWJ1bHRvciBkb2luZyB0aGlzP1xyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIH0sXHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHdyYXBJdGVtKHZpZGVvLCBleHRyYXMgPSB7fSkge1xyXG4gIGlmICghdmlkZW8pIHtcclxuICAgIGNvbnNvbGUubG9nKFwiRVJST1I6IHVuZGVmaW5lZCBpbnB1dFwiKTtcclxuICAgIGNvbnNvbGUudHJhY2UoKTtcclxuICB9XHJcbiAgaWYgKHZpZGVvLnJlZikge1xyXG4gICAgY29uc29sZS5sb2coXCJFUlJPUjogQWxyZWFkeSB3cmFwcGVkP1wiKTtcclxuICB9XHJcbiAgcmV0dXJuIG5ldyBQcm94eShcclxuICAgIHsgcmVmOiB2aWRlbywgLi4uZXh0cmFzIH0sXHJcbiAgICB7XHJcbiAgICAgIGdldCh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKSB7XHJcbiAgICAgICAgaWYgKHByb3AgaW4gdGFyZ2V0KSByZXR1cm4gUmVmbGVjdC5nZXQodGFyZ2V0LCBwcm9wLCByZWNlaXZlcik7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldC5yZWZbcHJvcF07XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldCh0YXJnZXQsIHByb3AsIHZhbHVlLCByZWNlaXZlcikge1xyXG4gICAgICAgIGlmIChwcm9wIGluIHRhcmdldCkgcmV0dXJuIFJlZmxlY3Quc2V0KHRhcmdldCwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKTtcclxuICAgICAgICB0YXJnZXQucmVmW3Byb3BdID0gdmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0sXHJcbiAgICB9XHJcbiAgKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBpc29EdXJhdGlvbjJzZWNvbmRzLFxyXG4gIGZvcm1hdER1cmF0aW9uLFxyXG4gIGNhbGNEdWUsXHJcbiAgd3JhcEl0ZW0sXHJcbiAgYWRkQ29tcHV0ZWRGaWVsZHNWaWRlbyxcclxuICBhZGRDb21wdXRlZEZpZWxkc1BMLFxyXG59O1xyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/utils.js\n\n}");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		var execOptions = { id: moduleId, module: module, factory: __webpack_modules__[moduleId], require: __webpack_require__ };
/******/ 		__webpack_require__.i.forEach(function(handler) { handler(execOptions); });
/******/ 		module = execOptions.module;
/******/ 		execOptions.factory.call(module.exports, module, module.exports, execOptions.require);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = __webpack_modules__;
/******/ 	
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = __webpack_module_cache__;
/******/ 	
/******/ 	// expose the module execution interceptor
/******/ 	__webpack_require__.i = [];
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/get javascript update chunk filename */
/******/ 	(() => {
/******/ 		// This function allow to reference all chunks
/******/ 		__webpack_require__.hu = (chunkId) => {
/******/ 			// return url for filenames based on template
/******/ 			return "" + chunkId + "." + __webpack_require__.h() + ".hot-update.js";
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/get update manifest filename */
/******/ 	(() => {
/******/ 		__webpack_require__.hmrF = () => ("main_window." + __webpack_require__.h() + ".hot-update.json");
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/getFullHash */
/******/ 	(() => {
/******/ 		__webpack_require__.h = () => ("0cac3014216ab4e60264")
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/load script */
/******/ 	(() => {
/******/ 		var inProgress = {};
/******/ 		var dataWebpackPrefix = "deja-queue:";
/******/ 		// loadScript function to load a script via script tag
/******/ 		__webpack_require__.l = (url, done, key, chunkId) => {
/******/ 			if(inProgress[url]) { inProgress[url].push(done); return; }
/******/ 			var script, needAttach;
/******/ 			if(key !== undefined) {
/******/ 				var scripts = document.getElementsByTagName("script");
/******/ 				for(var i = 0; i < scripts.length; i++) {
/******/ 					var s = scripts[i];
/******/ 					if(s.getAttribute("src") == url || s.getAttribute("data-webpack") == dataWebpackPrefix + key) { script = s; break; }
/******/ 				}
/******/ 			}
/******/ 			if(!script) {
/******/ 				needAttach = true;
/******/ 				script = document.createElement('script');
/******/ 		
/******/ 				script.charset = 'utf-8';
/******/ 				if (__webpack_require__.nc) {
/******/ 					script.setAttribute("nonce", __webpack_require__.nc);
/******/ 				}
/******/ 				script.setAttribute("data-webpack", dataWebpackPrefix + key);
/******/ 		
/******/ 				script.src = url;
/******/ 			}
/******/ 			inProgress[url] = [done];
/******/ 			var onScriptComplete = (prev, event) => {
/******/ 				// avoid mem leaks in IE.
/******/ 				script.onerror = script.onload = null;
/******/ 				clearTimeout(timeout);
/******/ 				var doneFns = inProgress[url];
/******/ 				delete inProgress[url];
/******/ 				script.parentNode && script.parentNode.removeChild(script);
/******/ 				doneFns && doneFns.forEach((fn) => (fn(event)));
/******/ 				if(prev) return prev(event);
/******/ 			}
/******/ 			var timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);
/******/ 			script.onerror = onScriptComplete.bind(null, script.onerror);
/******/ 			script.onload = onScriptComplete.bind(null, script.onload);
/******/ 			needAttach && document.head.appendChild(script);
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hot module replacement */
/******/ 	(() => {
/******/ 		var currentModuleData = {};
/******/ 		var installedModules = __webpack_require__.c;
/******/ 		
/******/ 		// module and require creation
/******/ 		var currentChildModule;
/******/ 		var currentParents = [];
/******/ 		
/******/ 		// status
/******/ 		var registeredStatusHandlers = [];
/******/ 		var currentStatus = "idle";
/******/ 		
/******/ 		// while downloading
/******/ 		var blockingPromises = 0;
/******/ 		var blockingPromisesWaiting = [];
/******/ 		
/******/ 		// The update info
/******/ 		var currentUpdateApplyHandlers;
/******/ 		var queuedInvalidatedModules;
/******/ 		
/******/ 		__webpack_require__.hmrD = currentModuleData;
/******/ 		
/******/ 		__webpack_require__.i.push(function (options) {
/******/ 			var module = options.module;
/******/ 			var require = createRequire(options.require, options.id);
/******/ 			module.hot = createModuleHotObject(options.id, module);
/******/ 			module.parents = currentParents;
/******/ 			module.children = [];
/******/ 			currentParents = [];
/******/ 			options.require = require;
/******/ 		});
/******/ 		
/******/ 		__webpack_require__.hmrC = {};
/******/ 		__webpack_require__.hmrI = {};
/******/ 		
/******/ 		function createRequire(require, moduleId) {
/******/ 			var me = installedModules[moduleId];
/******/ 			if (!me) return require;
/******/ 			var fn = function (request) {
/******/ 				if (me.hot.active) {
/******/ 					if (installedModules[request]) {
/******/ 						var parents = installedModules[request].parents;
/******/ 						if (parents.indexOf(moduleId) === -1) {
/******/ 							parents.push(moduleId);
/******/ 						}
/******/ 					} else {
/******/ 						currentParents = [moduleId];
/******/ 						currentChildModule = request;
/******/ 					}
/******/ 					if (me.children.indexOf(request) === -1) {
/******/ 						me.children.push(request);
/******/ 					}
/******/ 				} else {
/******/ 					console.warn(
/******/ 						"[HMR] unexpected require(" +
/******/ 							request +
/******/ 							") from disposed module " +
/******/ 							moduleId
/******/ 					);
/******/ 					currentParents = [];
/******/ 				}
/******/ 				return require(request);
/******/ 			};
/******/ 			var createPropertyDescriptor = function (name) {
/******/ 				return {
/******/ 					configurable: true,
/******/ 					enumerable: true,
/******/ 					get: function () {
/******/ 						return require[name];
/******/ 					},
/******/ 					set: function (value) {
/******/ 						require[name] = value;
/******/ 					}
/******/ 				};
/******/ 			};
/******/ 			for (var name in require) {
/******/ 				if (Object.prototype.hasOwnProperty.call(require, name) && name !== "e") {
/******/ 					Object.defineProperty(fn, name, createPropertyDescriptor(name));
/******/ 				}
/******/ 			}
/******/ 			fn.e = function (chunkId, fetchPriority) {
/******/ 				return trackBlockingPromise(require.e(chunkId, fetchPriority));
/******/ 			};
/******/ 			return fn;
/******/ 		}
/******/ 		
/******/ 		function createModuleHotObject(moduleId, me) {
/******/ 			var _main = currentChildModule !== moduleId;
/******/ 			var hot = {
/******/ 				// private stuff
/******/ 				_acceptedDependencies: {},
/******/ 				_acceptedErrorHandlers: {},
/******/ 				_declinedDependencies: {},
/******/ 				_selfAccepted: false,
/******/ 				_selfDeclined: false,
/******/ 				_selfInvalidated: false,
/******/ 				_disposeHandlers: [],
/******/ 				_main: _main,
/******/ 				_requireSelf: function () {
/******/ 					currentParents = me.parents.slice();
/******/ 					currentChildModule = _main ? undefined : moduleId;
/******/ 					__webpack_require__(moduleId);
/******/ 				},
/******/ 		
/******/ 				// Module API
/******/ 				active: true,
/******/ 				accept: function (dep, callback, errorHandler) {
/******/ 					if (dep === undefined) hot._selfAccepted = true;
/******/ 					else if (typeof dep === "function") hot._selfAccepted = dep;
/******/ 					else if (typeof dep === "object" && dep !== null) {
/******/ 						for (var i = 0; i < dep.length; i++) {
/******/ 							hot._acceptedDependencies[dep[i]] = callback || function () {};
/******/ 							hot._acceptedErrorHandlers[dep[i]] = errorHandler;
/******/ 						}
/******/ 					} else {
/******/ 						hot._acceptedDependencies[dep] = callback || function () {};
/******/ 						hot._acceptedErrorHandlers[dep] = errorHandler;
/******/ 					}
/******/ 				},
/******/ 				decline: function (dep) {
/******/ 					if (dep === undefined) hot._selfDeclined = true;
/******/ 					else if (typeof dep === "object" && dep !== null)
/******/ 						for (var i = 0; i < dep.length; i++)
/******/ 							hot._declinedDependencies[dep[i]] = true;
/******/ 					else hot._declinedDependencies[dep] = true;
/******/ 				},
/******/ 				dispose: function (callback) {
/******/ 					hot._disposeHandlers.push(callback);
/******/ 				},
/******/ 				addDisposeHandler: function (callback) {
/******/ 					hot._disposeHandlers.push(callback);
/******/ 				},
/******/ 				removeDisposeHandler: function (callback) {
/******/ 					var idx = hot._disposeHandlers.indexOf(callback);
/******/ 					if (idx >= 0) hot._disposeHandlers.splice(idx, 1);
/******/ 				},
/******/ 				invalidate: function () {
/******/ 					this._selfInvalidated = true;
/******/ 					switch (currentStatus) {
/******/ 						case "idle":
/******/ 							currentUpdateApplyHandlers = [];
/******/ 							Object.keys(__webpack_require__.hmrI).forEach(function (key) {
/******/ 								__webpack_require__.hmrI[key](
/******/ 									moduleId,
/******/ 									currentUpdateApplyHandlers
/******/ 								);
/******/ 							});
/******/ 							setStatus("ready");
/******/ 							break;
/******/ 						case "ready":
/******/ 							Object.keys(__webpack_require__.hmrI).forEach(function (key) {
/******/ 								__webpack_require__.hmrI[key](
/******/ 									moduleId,
/******/ 									currentUpdateApplyHandlers
/******/ 								);
/******/ 							});
/******/ 							break;
/******/ 						case "prepare":
/******/ 						case "check":
/******/ 						case "dispose":
/******/ 						case "apply":
/******/ 							(queuedInvalidatedModules = queuedInvalidatedModules || []).push(
/******/ 								moduleId
/******/ 							);
/******/ 							break;
/******/ 						default:
/******/ 							// ignore requests in error states
/******/ 							break;
/******/ 					}
/******/ 				},
/******/ 		
/******/ 				// Management API
/******/ 				check: hotCheck,
/******/ 				apply: hotApply,
/******/ 				status: function (l) {
/******/ 					if (!l) return currentStatus;
/******/ 					registeredStatusHandlers.push(l);
/******/ 				},
/******/ 				addStatusHandler: function (l) {
/******/ 					registeredStatusHandlers.push(l);
/******/ 				},
/******/ 				removeStatusHandler: function (l) {
/******/ 					var idx = registeredStatusHandlers.indexOf(l);
/******/ 					if (idx >= 0) registeredStatusHandlers.splice(idx, 1);
/******/ 				},
/******/ 		
/******/ 				// inherit from previous dispose call
/******/ 				data: currentModuleData[moduleId]
/******/ 			};
/******/ 			currentChildModule = undefined;
/******/ 			return hot;
/******/ 		}
/******/ 		
/******/ 		function setStatus(newStatus) {
/******/ 			currentStatus = newStatus;
/******/ 			var results = [];
/******/ 		
/******/ 			for (var i = 0; i < registeredStatusHandlers.length; i++)
/******/ 				results[i] = registeredStatusHandlers[i].call(null, newStatus);
/******/ 		
/******/ 			return Promise.all(results).then(function () {});
/******/ 		}
/******/ 		
/******/ 		function unblock() {
/******/ 			if (--blockingPromises === 0) {
/******/ 				setStatus("ready").then(function () {
/******/ 					if (blockingPromises === 0) {
/******/ 						var list = blockingPromisesWaiting;
/******/ 						blockingPromisesWaiting = [];
/******/ 						for (var i = 0; i < list.length; i++) {
/******/ 							list[i]();
/******/ 						}
/******/ 					}
/******/ 				});
/******/ 			}
/******/ 		}
/******/ 		
/******/ 		function trackBlockingPromise(promise) {
/******/ 			switch (currentStatus) {
/******/ 				case "ready":
/******/ 					setStatus("prepare");
/******/ 				/* fallthrough */
/******/ 				case "prepare":
/******/ 					blockingPromises++;
/******/ 					promise.then(unblock, unblock);
/******/ 					return promise;
/******/ 				default:
/******/ 					return promise;
/******/ 			}
/******/ 		}
/******/ 		
/******/ 		function waitForBlockingPromises(fn) {
/******/ 			if (blockingPromises === 0) return fn();
/******/ 			return new Promise(function (resolve) {
/******/ 				blockingPromisesWaiting.push(function () {
/******/ 					resolve(fn());
/******/ 				});
/******/ 			});
/******/ 		}
/******/ 		
/******/ 		function hotCheck(applyOnUpdate) {
/******/ 			if (currentStatus !== "idle") {
/******/ 				throw new Error("check() is only allowed in idle status");
/******/ 			}
/******/ 			return setStatus("check")
/******/ 				.then(__webpack_require__.hmrM)
/******/ 				.then(function (update) {
/******/ 					if (!update) {
/******/ 						return setStatus(applyInvalidatedModules() ? "ready" : "idle").then(
/******/ 							function () {
/******/ 								return null;
/******/ 							}
/******/ 						);
/******/ 					}
/******/ 		
/******/ 					return setStatus("prepare").then(function () {
/******/ 						var updatedModules = [];
/******/ 						currentUpdateApplyHandlers = [];
/******/ 		
/******/ 						return Promise.all(
/******/ 							Object.keys(__webpack_require__.hmrC).reduce(function (
/******/ 								promises,
/******/ 								key
/******/ 							) {
/******/ 								__webpack_require__.hmrC[key](
/******/ 									update.c,
/******/ 									update.r,
/******/ 									update.m,
/******/ 									promises,
/******/ 									currentUpdateApplyHandlers,
/******/ 									updatedModules
/******/ 								);
/******/ 								return promises;
/******/ 							}, [])
/******/ 						).then(function () {
/******/ 							return waitForBlockingPromises(function () {
/******/ 								if (applyOnUpdate) {
/******/ 									return internalApply(applyOnUpdate);
/******/ 								}
/******/ 								return setStatus("ready").then(function () {
/******/ 									return updatedModules;
/******/ 								});
/******/ 							});
/******/ 						});
/******/ 					});
/******/ 				});
/******/ 		}
/******/ 		
/******/ 		function hotApply(options) {
/******/ 			if (currentStatus !== "ready") {
/******/ 				return Promise.resolve().then(function () {
/******/ 					throw new Error(
/******/ 						"apply() is only allowed in ready status (state: " +
/******/ 							currentStatus +
/******/ 							")"
/******/ 					);
/******/ 				});
/******/ 			}
/******/ 			return internalApply(options);
/******/ 		}
/******/ 		
/******/ 		function internalApply(options) {
/******/ 			options = options || {};
/******/ 		
/******/ 			applyInvalidatedModules();
/******/ 		
/******/ 			var results = currentUpdateApplyHandlers.map(function (handler) {
/******/ 				return handler(options);
/******/ 			});
/******/ 			currentUpdateApplyHandlers = undefined;
/******/ 		
/******/ 			var errors = results
/******/ 				.map(function (r) {
/******/ 					return r.error;
/******/ 				})
/******/ 				.filter(Boolean);
/******/ 		
/******/ 			if (errors.length > 0) {
/******/ 				return setStatus("abort").then(function () {
/******/ 					throw errors[0];
/******/ 				});
/******/ 			}
/******/ 		
/******/ 			// Now in "dispose" phase
/******/ 			var disposePromise = setStatus("dispose");
/******/ 		
/******/ 			results.forEach(function (result) {
/******/ 				if (result.dispose) result.dispose();
/******/ 			});
/******/ 		
/******/ 			// Now in "apply" phase
/******/ 			var applyPromise = setStatus("apply");
/******/ 		
/******/ 			var error;
/******/ 			var reportError = function (err) {
/******/ 				if (!error) error = err;
/******/ 			};
/******/ 		
/******/ 			var outdatedModules = [];
/******/ 		
/******/ 			var onAccepted = function () {
/******/ 				return Promise.all([disposePromise, applyPromise]).then(function () {
/******/ 					// handle errors in accept handlers and self accepted module load
/******/ 					if (error) {
/******/ 						return setStatus("fail").then(function () {
/******/ 							throw error;
/******/ 						});
/******/ 					}
/******/ 		
/******/ 					if (queuedInvalidatedModules) {
/******/ 						return internalApply(options).then(function (list) {
/******/ 							outdatedModules.forEach(function (moduleId) {
/******/ 								if (list.indexOf(moduleId) < 0) list.push(moduleId);
/******/ 							});
/******/ 							return list;
/******/ 						});
/******/ 					}
/******/ 		
/******/ 					return setStatus("idle").then(function () {
/******/ 						return outdatedModules;
/******/ 					});
/******/ 				});
/******/ 			};
/******/ 		
/******/ 			return Promise.all(
/******/ 				results
/******/ 					.filter(function (result) {
/******/ 						return result.apply;
/******/ 					})
/******/ 					.map(function (result) {
/******/ 						return result.apply(reportError);
/******/ 					})
/******/ 			)
/******/ 				.then(function (applyResults) {
/******/ 					applyResults.forEach(function (modules) {
/******/ 						if (modules) {
/******/ 							for (var i = 0; i < modules.length; i++) {
/******/ 								outdatedModules.push(modules[i]);
/******/ 							}
/******/ 						}
/******/ 					});
/******/ 				})
/******/ 				.then(onAccepted);
/******/ 		}
/******/ 		
/******/ 		function applyInvalidatedModules() {
/******/ 			if (queuedInvalidatedModules) {
/******/ 				if (!currentUpdateApplyHandlers) currentUpdateApplyHandlers = [];
/******/ 				Object.keys(__webpack_require__.hmrI).forEach(function (key) {
/******/ 					queuedInvalidatedModules.forEach(function (moduleId) {
/******/ 						__webpack_require__.hmrI[key](
/******/ 							moduleId,
/******/ 							currentUpdateApplyHandlers
/******/ 						);
/******/ 					});
/******/ 				});
/******/ 				queuedInvalidatedModules = undefined;
/******/ 				return true;
/******/ 			}
/******/ 		}
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/publicPath */
/******/ 	(() => {
/******/ 		__webpack_require__.p = "/";
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/jsonp chunk loading */
/******/ 	(() => {
/******/ 		// no baseURI
/******/ 		
/******/ 		// object to store loaded and loading chunks
/******/ 		// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 		// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded
/******/ 		var installedChunks = __webpack_require__.hmrS_jsonp = __webpack_require__.hmrS_jsonp || {
/******/ 			"main_window": 0
/******/ 		};
/******/ 		
/******/ 		// no chunk on demand loading
/******/ 		
/******/ 		// no prefetching
/******/ 		
/******/ 		// no preloaded
/******/ 		
/******/ 		var currentUpdatedModulesList;
/******/ 		var waitingUpdateResolves = {};
/******/ 		function loadUpdateChunk(chunkId, updatedModulesList) {
/******/ 			currentUpdatedModulesList = updatedModulesList;
/******/ 			return new Promise((resolve, reject) => {
/******/ 				waitingUpdateResolves[chunkId] = resolve;
/******/ 				// start update chunk loading
/******/ 				var url = __webpack_require__.p + __webpack_require__.hu(chunkId);
/******/ 				// create error before stack unwound to get useful stacktrace later
/******/ 				var error = new Error();
/******/ 				var loadingEnded = (event) => {
/******/ 					if(waitingUpdateResolves[chunkId]) {
/******/ 						waitingUpdateResolves[chunkId] = undefined
/******/ 						var errorType = event && (event.type === 'load' ? 'missing' : event.type);
/******/ 						var realSrc = event && event.target && event.target.src;
/******/ 						error.message = 'Loading hot update chunk ' + chunkId + ' failed.\n(' + errorType + ': ' + realSrc + ')';
/******/ 						error.name = 'ChunkLoadError';
/******/ 						error.type = errorType;
/******/ 						error.request = realSrc;
/******/ 						reject(error);
/******/ 					}
/******/ 				};
/******/ 				__webpack_require__.l(url, loadingEnded);
/******/ 			});
/******/ 		}
/******/ 		
/******/ 		self["webpackHotUpdatedeja_queue"] = (chunkId, moreModules, runtime) => {
/******/ 			for(var moduleId in moreModules) {
/******/ 				if(__webpack_require__.o(moreModules, moduleId)) {
/******/ 					currentUpdate[moduleId] = moreModules[moduleId];
/******/ 					if(currentUpdatedModulesList) currentUpdatedModulesList.push(moduleId);
/******/ 				}
/******/ 			}
/******/ 			if(runtime) currentUpdateRuntime.push(runtime);
/******/ 			if(waitingUpdateResolves[chunkId]) {
/******/ 				waitingUpdateResolves[chunkId]();
/******/ 				waitingUpdateResolves[chunkId] = undefined;
/******/ 			}
/******/ 		};
/******/ 		
/******/ 		var currentUpdateChunks;
/******/ 		var currentUpdate;
/******/ 		var currentUpdateRemovedChunks;
/******/ 		var currentUpdateRuntime;
/******/ 		function applyHandler(options) {
/******/ 			if (__webpack_require__.f) delete __webpack_require__.f.jsonpHmr;
/******/ 			currentUpdateChunks = undefined;
/******/ 			function getAffectedModuleEffects(updateModuleId) {
/******/ 				var outdatedModules = [updateModuleId];
/******/ 				var outdatedDependencies = {};
/******/ 		
/******/ 				var queue = outdatedModules.map(function (id) {
/******/ 					return {
/******/ 						chain: [id],
/******/ 						id: id
/******/ 					};
/******/ 				});
/******/ 				while (queue.length > 0) {
/******/ 					var queueItem = queue.pop();
/******/ 					var moduleId = queueItem.id;
/******/ 					var chain = queueItem.chain;
/******/ 					var module = __webpack_require__.c[moduleId];
/******/ 					if (
/******/ 						!module ||
/******/ 						(module.hot._selfAccepted && !module.hot._selfInvalidated)
/******/ 					)
/******/ 						continue;
/******/ 					if (module.hot._selfDeclined) {
/******/ 						return {
/******/ 							type: "self-declined",
/******/ 							chain: chain,
/******/ 							moduleId: moduleId
/******/ 						};
/******/ 					}
/******/ 					if (module.hot._main) {
/******/ 						return {
/******/ 							type: "unaccepted",
/******/ 							chain: chain,
/******/ 							moduleId: moduleId
/******/ 						};
/******/ 					}
/******/ 					for (var i = 0; i < module.parents.length; i++) {
/******/ 						var parentId = module.parents[i];
/******/ 						var parent = __webpack_require__.c[parentId];
/******/ 						if (!parent) continue;
/******/ 						if (parent.hot._declinedDependencies[moduleId]) {
/******/ 							return {
/******/ 								type: "declined",
/******/ 								chain: chain.concat([parentId]),
/******/ 								moduleId: moduleId,
/******/ 								parentId: parentId
/******/ 							};
/******/ 						}
/******/ 						if (outdatedModules.indexOf(parentId) !== -1) continue;
/******/ 						if (parent.hot._acceptedDependencies[moduleId]) {
/******/ 							if (!outdatedDependencies[parentId])
/******/ 								outdatedDependencies[parentId] = [];
/******/ 							addAllToSet(outdatedDependencies[parentId], [moduleId]);
/******/ 							continue;
/******/ 						}
/******/ 						delete outdatedDependencies[parentId];
/******/ 						outdatedModules.push(parentId);
/******/ 						queue.push({
/******/ 							chain: chain.concat([parentId]),
/******/ 							id: parentId
/******/ 						});
/******/ 					}
/******/ 				}
/******/ 		
/******/ 				return {
/******/ 					type: "accepted",
/******/ 					moduleId: updateModuleId,
/******/ 					outdatedModules: outdatedModules,
/******/ 					outdatedDependencies: outdatedDependencies
/******/ 				};
/******/ 			}
/******/ 		
/******/ 			function addAllToSet(a, b) {
/******/ 				for (var i = 0; i < b.length; i++) {
/******/ 					var item = b[i];
/******/ 					if (a.indexOf(item) === -1) a.push(item);
/******/ 				}
/******/ 			}
/******/ 		
/******/ 			// at begin all updates modules are outdated
/******/ 			// the "outdated" status can propagate to parents if they don't accept the children
/******/ 			var outdatedDependencies = {};
/******/ 			var outdatedModules = [];
/******/ 			var appliedUpdate = {};
/******/ 		
/******/ 			var warnUnexpectedRequire = function warnUnexpectedRequire(module) {
/******/ 				console.warn(
/******/ 					"[HMR] unexpected require(" + module.id + ") to disposed module"
/******/ 				);
/******/ 			};
/******/ 		
/******/ 			for (var moduleId in currentUpdate) {
/******/ 				if (__webpack_require__.o(currentUpdate, moduleId)) {
/******/ 					var newModuleFactory = currentUpdate[moduleId];
/******/ 					var result = newModuleFactory
/******/ 						? getAffectedModuleEffects(moduleId)
/******/ 						: {
/******/ 								type: "disposed",
/******/ 								moduleId: moduleId
/******/ 							};
/******/ 					/** @type {Error|false} */
/******/ 					var abortError = false;
/******/ 					var doApply = false;
/******/ 					var doDispose = false;
/******/ 					var chainInfo = "";
/******/ 					if (result.chain) {
/******/ 						chainInfo = "\nUpdate propagation: " + result.chain.join(" -> ");
/******/ 					}
/******/ 					switch (result.type) {
/******/ 						case "self-declined":
/******/ 							if (options.onDeclined) options.onDeclined(result);
/******/ 							if (!options.ignoreDeclined)
/******/ 								abortError = new Error(
/******/ 									"Aborted because of self decline: " +
/******/ 										result.moduleId +
/******/ 										chainInfo
/******/ 								);
/******/ 							break;
/******/ 						case "declined":
/******/ 							if (options.onDeclined) options.onDeclined(result);
/******/ 							if (!options.ignoreDeclined)
/******/ 								abortError = new Error(
/******/ 									"Aborted because of declined dependency: " +
/******/ 										result.moduleId +
/******/ 										" in " +
/******/ 										result.parentId +
/******/ 										chainInfo
/******/ 								);
/******/ 							break;
/******/ 						case "unaccepted":
/******/ 							if (options.onUnaccepted) options.onUnaccepted(result);
/******/ 							if (!options.ignoreUnaccepted)
/******/ 								abortError = new Error(
/******/ 									"Aborted because " + moduleId + " is not accepted" + chainInfo
/******/ 								);
/******/ 							break;
/******/ 						case "accepted":
/******/ 							if (options.onAccepted) options.onAccepted(result);
/******/ 							doApply = true;
/******/ 							break;
/******/ 						case "disposed":
/******/ 							if (options.onDisposed) options.onDisposed(result);
/******/ 							doDispose = true;
/******/ 							break;
/******/ 						default:
/******/ 							throw new Error("Unexception type " + result.type);
/******/ 					}
/******/ 					if (abortError) {
/******/ 						return {
/******/ 							error: abortError
/******/ 						};
/******/ 					}
/******/ 					if (doApply) {
/******/ 						appliedUpdate[moduleId] = newModuleFactory;
/******/ 						addAllToSet(outdatedModules, result.outdatedModules);
/******/ 						for (moduleId in result.outdatedDependencies) {
/******/ 							if (__webpack_require__.o(result.outdatedDependencies, moduleId)) {
/******/ 								if (!outdatedDependencies[moduleId])
/******/ 									outdatedDependencies[moduleId] = [];
/******/ 								addAllToSet(
/******/ 									outdatedDependencies[moduleId],
/******/ 									result.outdatedDependencies[moduleId]
/******/ 								);
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 					if (doDispose) {
/******/ 						addAllToSet(outdatedModules, [result.moduleId]);
/******/ 						appliedUpdate[moduleId] = warnUnexpectedRequire;
/******/ 					}
/******/ 				}
/******/ 			}
/******/ 			currentUpdate = undefined;
/******/ 		
/******/ 			// Store self accepted outdated modules to require them later by the module system
/******/ 			var outdatedSelfAcceptedModules = [];
/******/ 			for (var j = 0; j < outdatedModules.length; j++) {
/******/ 				var outdatedModuleId = outdatedModules[j];
/******/ 				var module = __webpack_require__.c[outdatedModuleId];
/******/ 				if (
/******/ 					module &&
/******/ 					(module.hot._selfAccepted || module.hot._main) &&
/******/ 					// removed self-accepted modules should not be required
/******/ 					appliedUpdate[outdatedModuleId] !== warnUnexpectedRequire &&
/******/ 					// when called invalidate self-accepting is not possible
/******/ 					!module.hot._selfInvalidated
/******/ 				) {
/******/ 					outdatedSelfAcceptedModules.push({
/******/ 						module: outdatedModuleId,
/******/ 						require: module.hot._requireSelf,
/******/ 						errorHandler: module.hot._selfAccepted
/******/ 					});
/******/ 				}
/******/ 			}
/******/ 		
/******/ 			var moduleOutdatedDependencies;
/******/ 		
/******/ 			return {
/******/ 				dispose: function () {
/******/ 					currentUpdateRemovedChunks.forEach(function (chunkId) {
/******/ 						delete installedChunks[chunkId];
/******/ 					});
/******/ 					currentUpdateRemovedChunks = undefined;
/******/ 		
/******/ 					var idx;
/******/ 					var queue = outdatedModules.slice();
/******/ 					while (queue.length > 0) {
/******/ 						var moduleId = queue.pop();
/******/ 						var module = __webpack_require__.c[moduleId];
/******/ 						if (!module) continue;
/******/ 		
/******/ 						var data = {};
/******/ 		
/******/ 						// Call dispose handlers
/******/ 						var disposeHandlers = module.hot._disposeHandlers;
/******/ 						for (j = 0; j < disposeHandlers.length; j++) {
/******/ 							disposeHandlers[j].call(null, data);
/******/ 						}
/******/ 						__webpack_require__.hmrD[moduleId] = data;
/******/ 		
/******/ 						// disable module (this disables requires from this module)
/******/ 						module.hot.active = false;
/******/ 		
/******/ 						// remove module from cache
/******/ 						delete __webpack_require__.c[moduleId];
/******/ 		
/******/ 						// when disposing there is no need to call dispose handler
/******/ 						delete outdatedDependencies[moduleId];
/******/ 		
/******/ 						// remove "parents" references from all children
/******/ 						for (j = 0; j < module.children.length; j++) {
/******/ 							var child = __webpack_require__.c[module.children[j]];
/******/ 							if (!child) continue;
/******/ 							idx = child.parents.indexOf(moduleId);
/******/ 							if (idx >= 0) {
/******/ 								child.parents.splice(idx, 1);
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 		
/******/ 					// remove outdated dependency from module children
/******/ 					var dependency;
/******/ 					for (var outdatedModuleId in outdatedDependencies) {
/******/ 						if (__webpack_require__.o(outdatedDependencies, outdatedModuleId)) {
/******/ 							module = __webpack_require__.c[outdatedModuleId];
/******/ 							if (module) {
/******/ 								moduleOutdatedDependencies =
/******/ 									outdatedDependencies[outdatedModuleId];
/******/ 								for (j = 0; j < moduleOutdatedDependencies.length; j++) {
/******/ 									dependency = moduleOutdatedDependencies[j];
/******/ 									idx = module.children.indexOf(dependency);
/******/ 									if (idx >= 0) module.children.splice(idx, 1);
/******/ 								}
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 				},
/******/ 				apply: function (reportError) {
/******/ 					var acceptPromises = [];
/******/ 					// insert new code
/******/ 					for (var updateModuleId in appliedUpdate) {
/******/ 						if (__webpack_require__.o(appliedUpdate, updateModuleId)) {
/******/ 							__webpack_require__.m[updateModuleId] = appliedUpdate[updateModuleId];
/******/ 						}
/******/ 					}
/******/ 		
/******/ 					// run new runtime modules
/******/ 					for (var i = 0; i < currentUpdateRuntime.length; i++) {
/******/ 						currentUpdateRuntime[i](__webpack_require__);
/******/ 					}
/******/ 		
/******/ 					// call accept handlers
/******/ 					for (var outdatedModuleId in outdatedDependencies) {
/******/ 						if (__webpack_require__.o(outdatedDependencies, outdatedModuleId)) {
/******/ 							var module = __webpack_require__.c[outdatedModuleId];
/******/ 							if (module) {
/******/ 								moduleOutdatedDependencies =
/******/ 									outdatedDependencies[outdatedModuleId];
/******/ 								var callbacks = [];
/******/ 								var errorHandlers = [];
/******/ 								var dependenciesForCallbacks = [];
/******/ 								for (var j = 0; j < moduleOutdatedDependencies.length; j++) {
/******/ 									var dependency = moduleOutdatedDependencies[j];
/******/ 									var acceptCallback =
/******/ 										module.hot._acceptedDependencies[dependency];
/******/ 									var errorHandler =
/******/ 										module.hot._acceptedErrorHandlers[dependency];
/******/ 									if (acceptCallback) {
/******/ 										if (callbacks.indexOf(acceptCallback) !== -1) continue;
/******/ 										callbacks.push(acceptCallback);
/******/ 										errorHandlers.push(errorHandler);
/******/ 										dependenciesForCallbacks.push(dependency);
/******/ 									}
/******/ 								}
/******/ 								for (var k = 0; k < callbacks.length; k++) {
/******/ 									var result;
/******/ 									try {
/******/ 										result = callbacks[k].call(null, moduleOutdatedDependencies);
/******/ 									} catch (err) {
/******/ 										if (typeof errorHandlers[k] === "function") {
/******/ 											try {
/******/ 												errorHandlers[k](err, {
/******/ 													moduleId: outdatedModuleId,
/******/ 													dependencyId: dependenciesForCallbacks[k]
/******/ 												});
/******/ 											} catch (err2) {
/******/ 												if (options.onErrored) {
/******/ 													options.onErrored({
/******/ 														type: "accept-error-handler-errored",
/******/ 														moduleId: outdatedModuleId,
/******/ 														dependencyId: dependenciesForCallbacks[k],
/******/ 														error: err2,
/******/ 														originalError: err
/******/ 													});
/******/ 												}
/******/ 												if (!options.ignoreErrored) {
/******/ 													reportError(err2);
/******/ 													reportError(err);
/******/ 												}
/******/ 											}
/******/ 										} else {
/******/ 											if (options.onErrored) {
/******/ 												options.onErrored({
/******/ 													type: "accept-errored",
/******/ 													moduleId: outdatedModuleId,
/******/ 													dependencyId: dependenciesForCallbacks[k],
/******/ 													error: err
/******/ 												});
/******/ 											}
/******/ 											if (!options.ignoreErrored) {
/******/ 												reportError(err);
/******/ 											}
/******/ 										}
/******/ 									}
/******/ 									if (result && typeof result.then === "function") {
/******/ 										acceptPromises.push(result);
/******/ 									}
/******/ 								}
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 		
/******/ 					var onAccepted = function () {
/******/ 						// Load self accepted modules
/******/ 						for (var o = 0; o < outdatedSelfAcceptedModules.length; o++) {
/******/ 							var item = outdatedSelfAcceptedModules[o];
/******/ 							var moduleId = item.module;
/******/ 							try {
/******/ 								item.require(moduleId);
/******/ 							} catch (err) {
/******/ 								if (typeof item.errorHandler === "function") {
/******/ 									try {
/******/ 										item.errorHandler(err, {
/******/ 											moduleId: moduleId,
/******/ 											module: __webpack_require__.c[moduleId]
/******/ 										});
/******/ 									} catch (err1) {
/******/ 										if (options.onErrored) {
/******/ 											options.onErrored({
/******/ 												type: "self-accept-error-handler-errored",
/******/ 												moduleId: moduleId,
/******/ 												error: err1,
/******/ 												originalError: err
/******/ 											});
/******/ 										}
/******/ 										if (!options.ignoreErrored) {
/******/ 											reportError(err1);
/******/ 											reportError(err);
/******/ 										}
/******/ 									}
/******/ 								} else {
/******/ 									if (options.onErrored) {
/******/ 										options.onErrored({
/******/ 											type: "self-accept-errored",
/******/ 											moduleId: moduleId,
/******/ 											error: err
/******/ 										});
/******/ 									}
/******/ 									if (!options.ignoreErrored) {
/******/ 										reportError(err);
/******/ 									}
/******/ 								}
/******/ 							}
/******/ 						}
/******/ 					};
/******/ 		
/******/ 					return Promise.all(acceptPromises)
/******/ 						.then(onAccepted)
/******/ 						.then(function () {
/******/ 							return outdatedModules;
/******/ 						});
/******/ 				}
/******/ 			};
/******/ 		}
/******/ 		__webpack_require__.hmrI.jsonp = function (moduleId, applyHandlers) {
/******/ 			if (!currentUpdate) {
/******/ 				currentUpdate = {};
/******/ 				currentUpdateRuntime = [];
/******/ 				currentUpdateRemovedChunks = [];
/******/ 				applyHandlers.push(applyHandler);
/******/ 			}
/******/ 			if (!__webpack_require__.o(currentUpdate, moduleId)) {
/******/ 				currentUpdate[moduleId] = __webpack_require__.m[moduleId];
/******/ 			}
/******/ 		};
/******/ 		__webpack_require__.hmrC.jsonp = function (
/******/ 			chunkIds,
/******/ 			removedChunks,
/******/ 			removedModules,
/******/ 			promises,
/******/ 			applyHandlers,
/******/ 			updatedModulesList
/******/ 		) {
/******/ 			applyHandlers.push(applyHandler);
/******/ 			currentUpdateChunks = {};
/******/ 			currentUpdateRemovedChunks = removedChunks;
/******/ 			currentUpdate = removedModules.reduce(function (obj, key) {
/******/ 				obj[key] = false;
/******/ 				return obj;
/******/ 			}, {});
/******/ 			currentUpdateRuntime = [];
/******/ 			chunkIds.forEach(function (chunkId) {
/******/ 				if (
/******/ 					__webpack_require__.o(installedChunks, chunkId) &&
/******/ 					installedChunks[chunkId] !== undefined
/******/ 				) {
/******/ 					promises.push(loadUpdateChunk(chunkId, updatedModulesList));
/******/ 					currentUpdateChunks[chunkId] = true;
/******/ 				} else {
/******/ 					currentUpdateChunks[chunkId] = false;
/******/ 				}
/******/ 			});
/******/ 			if (__webpack_require__.f) {
/******/ 				__webpack_require__.f.jsonpHmr = function (chunkId, promises) {
/******/ 					if (
/******/ 						currentUpdateChunks &&
/******/ 						__webpack_require__.o(currentUpdateChunks, chunkId) &&
/******/ 						!currentUpdateChunks[chunkId]
/******/ 					) {
/******/ 						promises.push(loadUpdateChunk(chunkId));
/******/ 						currentUpdateChunks[chunkId] = true;
/******/ 					}
/******/ 				};
/******/ 			}
/******/ 		};
/******/ 		
/******/ 		__webpack_require__.hmrM = () => {
/******/ 			if (typeof fetch === "undefined") throw new Error("No browser support: need fetch API");
/******/ 			return fetch(__webpack_require__.p + __webpack_require__.hmrF()).then((response) => {
/******/ 				if(response.status === 404) return; // no update available
/******/ 				if(!response.ok) throw new Error("Failed to fetch update manifest " + response.statusText);
/******/ 				return response.json();
/******/ 			});
/******/ 		};
/******/ 		
/******/ 		// no on chunks loaded
/******/ 		
/******/ 		// no jsonp function
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// module cache are used so entry inlining is disabled
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	__webpack_require__("./node_modules/webpack-dev-server/client/index.js?protocol=ws%3A&hostname=0.0.0.0&port=3000&pathname=%2Fws&logging=none&overlay=true&reconnect=10&hot=true&live-reload=true");
/******/ 	__webpack_require__("./node_modules/webpack/hot/dev-server.js");
/******/ 	var __webpack_exports__ = __webpack_require__("./src/options.js");
/******/ 	
/******/ })()
;